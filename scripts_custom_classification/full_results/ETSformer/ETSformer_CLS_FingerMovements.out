Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.803303956985474
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.775282144546509
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.2412569522857666
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.893524408340454
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.819822072982788
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.046625852584839
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 1.025 Vali Acc: 0.510 Test Loss: 1.025 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2274763584136963
Epoch: 7, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3296749591827393
Epoch: 8, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.884 Vali Acc: 0.490 Test Loss: 0.884 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2287607192993164
Epoch: 9, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.838 Vali Acc: 0.560 Test Loss: 0.838 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2150259017944336
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.031 Vali Acc: 0.550 Test Loss: 1.031 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.040849447250366
Epoch: 11, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.044 Vali Acc: 0.510 Test Loss: 1.044 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6680774688720703
Epoch: 12, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8399527072906494
Epoch: 13, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6220481395721436
Epoch: 14, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.986 Vali Acc: 0.520 Test Loss: 0.986 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5404930
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.627296209335327
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.3305442333221436
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.749 Vali Acc: 0.560 Test Loss: 0.749 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.744999647140503
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.501633405685425
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.549316167831421
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.733229398727417
Epoch: 6, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.985 Vali Acc: 0.530 Test Loss: 0.985 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8237767219543457
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.68691349029541
Epoch: 8, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.668769598007202
Epoch: 9, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6908071041107178
Epoch: 10, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.955 Vali Acc: 0.530 Test Loss: 0.955 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.458237409591675
Epoch: 11, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.063 Vali Acc: 0.540 Test Loss: 1.063 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5465595722198486
Epoch: 12, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.921 Vali Acc: 0.540 Test Loss: 0.921 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5404930
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.853047132492065
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.1335067749023438
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
Validation loss decreased (-0.489992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.906601667404175
Epoch: 3, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6267600059509277
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.009838819503784
Epoch: 5, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3816730976104736
Epoch: 6, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.919 Vali Acc: 0.550 Test Loss: 0.919 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.949370861053467
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5981268882751465
Epoch: 8, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.860 Vali Acc: 0.530 Test Loss: 0.860 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.483307123184204
Epoch: 9, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.870 Vali Acc: 0.600 Test Loss: 0.870 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599991).  Saving model ...
Epoch: 10 cost time: 2.6267905235290527
Epoch: 10, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.748643398284912
Epoch: 11, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.121 Vali Acc: 0.530 Test Loss: 1.121 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.421804189682007
Epoch: 12, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.434027671813965
Epoch: 13, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.050 Vali Acc: 0.560 Test Loss: 1.050 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.417546272277832
Epoch: 14, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.084 Vali Acc: 0.570 Test Loss: 1.084 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.329016923904419
Epoch: 15, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.331 Vali Acc: 0.510 Test Loss: 1.331 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6900713443756104
Epoch: 16, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.275 Vali Acc: 0.530 Test Loss: 1.275 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7320523262023926
Epoch: 17, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.191 Vali Acc: 0.580 Test Loss: 1.191 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.117445468902588
Epoch: 18, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1569297313690186
Epoch: 19, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.471 Vali Acc: 0.540 Test Loss: 1.471 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5404930
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.481648921966553
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.0289056301116943
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.235149621963501
Epoch: 3, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.946422815322876
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2430498600006104
Epoch: 5, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2579612731933594
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.922 Vali Acc: 0.570 Test Loss: 0.922 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 2.314797878265381
Epoch: 7, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.772 Vali Acc: 0.580 Test Loss: 0.772 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.3079123497009277
Epoch: 8, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.295422315597534
Epoch: 9, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.770 Vali Acc: 0.610 Test Loss: 0.770 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 10 cost time: 2.1970696449279785
Epoch: 10, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.904 Vali Acc: 0.550 Test Loss: 0.904 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2909817695617676
Epoch: 11, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.266 Vali Acc: 0.530 Test Loss: 1.266 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.812981128692627
Epoch: 12, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.090 Vali Acc: 0.560 Test Loss: 1.090 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3649396896362305
Epoch: 13, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.144 Vali Acc: 0.620 Test Loss: 1.144 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619989).  Saving model ...
Epoch: 14 cost time: 2.3973424434661865
Epoch: 14, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9165964126586914
Epoch: 15, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9370925426483154
Epoch: 16, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6913864612579346
Epoch: 17, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.347 Vali Acc: 0.590 Test Loss: 1.347 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7152645587921143
Epoch: 18, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.385 Vali Acc: 0.540 Test Loss: 1.385 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.629348039627075
Epoch: 19, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0135998725891113
Epoch: 20, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.460 Vali Acc: 0.640 Test Loss: 1.460 Test Acc: 0.640
Validation loss decreased (-0.619989 --> -0.639985).  Saving model ...
Epoch: 21 cost time: 2.697253704071045
Epoch: 21, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.763 Vali Acc: 0.550 Test Loss: 1.763 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3855135440826416
Epoch: 22, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.212 Vali Acc: 0.590 Test Loss: 2.212 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.74092435836792
Epoch: 23, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.801 Vali Acc: 0.510 Test Loss: 1.801 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.826585292816162
Epoch: 24, Steps: 20 | Train Loss: 0.187 Vali Loss: 2.898 Vali Acc: 0.570 Test Loss: 2.898 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.124572277069092
Epoch: 25, Steps: 20 | Train Loss: 0.162 Vali Loss: 2.284 Vali Acc: 0.530 Test Loss: 2.284 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.870495557785034
Epoch: 26, Steps: 20 | Train Loss: 0.083 Vali Loss: 2.092 Vali Acc: 0.570 Test Loss: 2.092 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7204034328460693
Epoch: 27, Steps: 20 | Train Loss: 0.109 Vali Loss: 2.804 Vali Acc: 0.560 Test Loss: 2.804 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5068740844726562
Epoch: 28, Steps: 20 | Train Loss: 0.054 Vali Loss: 2.092 Vali Acc: 0.560 Test Loss: 2.092 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.451918125152588
Epoch: 29, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.450 Vali Acc: 0.590 Test Loss: 2.450 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.659067392349243
Epoch: 30, Steps: 20 | Train Loss: 0.110 Vali Loss: 2.462 Vali Acc: 0.520 Test Loss: 2.462 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5404930
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.018332004547119
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.727871894836426
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.777 Vali Acc: 0.450 Test Loss: 0.777 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.270592212677002
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.825 Vali Acc: 0.520 Test Loss: 0.825 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1362149715423584
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5595312118530273
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8000762462615967
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2122740745544434
Epoch: 7, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.929 Vali Acc: 0.520 Test Loss: 0.929 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.967672348022461
Epoch: 8, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1046648025512695
Epoch: 9, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8567473888397217
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 1.186 Vali Acc: 0.530 Test Loss: 1.186 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4622340202331543
Epoch: 11, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 3307778
model size : 22.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.893588542938232
Epoch: 1, Steps: 20 | Train Loss: 0.759 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.6107070446014404
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.774 Vali Acc: 0.470 Test Loss: 0.774 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.641247510910034
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.656118154525757
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.561875581741333
Epoch: 5, Steps: 20 | Train Loss: 0.600 Vali Loss: 1.050 Vali Acc: 0.530 Test Loss: 1.050 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.587507963180542
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2702176570892334
Epoch: 7, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 8 cost time: 2.313859701156616
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.420003890991211
Epoch: 9, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5074214935302734
Epoch: 10, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.061 Vali Acc: 0.590 Test Loss: 1.061 Test Acc: 0.590
Validation loss decreased (-0.539991 --> -0.589989).  Saving model ...
Epoch: 11 cost time: 2.6877970695495605
Epoch: 11, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.949 Vali Acc: 0.550 Test Loss: 0.949 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3287339210510254
Epoch: 12, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.933 Vali Acc: 0.570 Test Loss: 0.933 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2997353076934814
Epoch: 13, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.386 Vali Acc: 0.500 Test Loss: 1.386 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4692225456237793
Epoch: 14, Steps: 20 | Train Loss: 0.367 Vali Loss: 1.087 Vali Acc: 0.540 Test Loss: 1.087 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5282185077667236
Epoch: 15, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.217 Vali Acc: 0.480 Test Loss: 1.217 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6628212928771973
Epoch: 16, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.297 Vali Acc: 0.540 Test Loss: 1.297 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6183276176452637
Epoch: 17, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.007 Vali Acc: 0.580 Test Loss: 1.007 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.622152805328369
Epoch: 18, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.213 Vali Acc: 0.550 Test Loss: 1.213 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.529040813446045
Epoch: 19, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.075791120529175
Epoch: 20, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.441 Vali Acc: 0.560 Test Loss: 1.441 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3307778
model size : 22.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.4766950607299805
Epoch: 1, Steps: 20 | Train Loss: 0.756 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.4670567512512207
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.542358875274658
Epoch: 3, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.15317964553833
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.9437947273254395
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9338817596435547
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.805 Vali Acc: 0.470 Test Loss: 0.805 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.21067476272583
Epoch: 7, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1387875080108643
Epoch: 8, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.905 Vali Acc: 0.490 Test Loss: 0.905 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3169548511505127
Epoch: 9, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.028 Vali Acc: 0.470 Test Loss: 1.028 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3055756092071533
Epoch: 10, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.106 Vali Acc: 0.570 Test Loss: 1.106 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569989).  Saving model ...
Epoch: 11 cost time: 3.413536310195923
Epoch: 11, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.405968189239502
Epoch: 12, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
Validation loss decreased (-0.569989 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 3.241408348083496
Epoch: 13, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.542 Vali Acc: 0.480 Test Loss: 1.542 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.252749443054199
Epoch: 14, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.182 Vali Acc: 0.530 Test Loss: 1.182 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6469104290008545
Epoch: 15, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5373551845550537
Epoch: 16, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.821420669555664
Epoch: 17, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.5312061309814453
Epoch: 18, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.147 Vali Acc: 0.560 Test Loss: 1.147 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.722052812576294
Epoch: 19, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.232 Vali Acc: 0.570 Test Loss: 1.232 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9909543991088867
Epoch: 20, Steps: 20 | Train Loss: 0.158 Vali Loss: 1.860 Vali Acc: 0.540 Test Loss: 1.860 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5040290355682373
Epoch: 21, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.354 Vali Acc: 0.580 Test Loss: 1.354 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.0136563777923584
Epoch: 22, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.905 Vali Acc: 0.570 Test Loss: 1.905 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3307778
model size : 22.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.013111352920532
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.168487787246704
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.530381202697754
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 3.0781140327453613
Epoch: 4, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.182562828063965
Epoch: 5, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.981 Vali Acc: 0.520 Test Loss: 0.981 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519990).  Saving model ...
Epoch: 6 cost time: 3.944439172744751
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.673081874847412
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.806 Vali Acc: 0.560 Test Loss: 0.806 Test Acc: 0.560
Validation loss decreased (-0.519990 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 3.4120523929595947
Epoch: 8, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4898102283477783
Epoch: 9, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.985 Vali Acc: 0.480 Test Loss: 0.985 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.31050181388855
Epoch: 10, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.920 Vali Acc: 0.620 Test Loss: 0.920 Test Acc: 0.620
Validation loss decreased (-0.559992 --> -0.619991).  Saving model ...
Epoch: 11 cost time: 3.3231422901153564
Epoch: 11, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.045624017715454
Epoch: 12, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.842 Vali Acc: 0.590 Test Loss: 0.842 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7631444931030273
Epoch: 13, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.959953784942627
Epoch: 14, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.144 Vali Acc: 0.540 Test Loss: 1.144 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1020286083221436
Epoch: 15, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.336 Vali Acc: 0.540 Test Loss: 1.336 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3867883682250977
Epoch: 16, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.127 Vali Acc: 0.580 Test Loss: 1.127 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3219568729400635
Epoch: 17, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.068 Vali Acc: 0.610 Test Loss: 1.068 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.038450002670288
Epoch: 18, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.410 Vali Acc: 0.520 Test Loss: 1.410 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.537605047225952
Epoch: 19, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.298 Vali Acc: 0.540 Test Loss: 1.298 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.545872211456299
Epoch: 20, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.911 Vali Acc: 0.540 Test Loss: 1.911 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 3307778
model size : 22.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.013854026794434
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.8380794525146484
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
Validation loss decreased (-0.459992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.8121514320373535
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.137181520462036
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.445981740951538
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 3.3919992446899414
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.972 Vali Acc: 0.530 Test Loss: 0.972 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 7 cost time: 3.2080039978027344
Epoch: 7, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.968 Vali Acc: 0.500 Test Loss: 0.968 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1285276412963867
Epoch: 8, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.985 Vali Acc: 0.510 Test Loss: 0.985 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9182233810424805
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8980674743652344
Epoch: 10, Steps: 20 | Train Loss: 0.680 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5615313053131104
Epoch: 11, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.885 Vali Acc: 0.510 Test Loss: 0.885 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.657099723815918
Epoch: 12, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7974507808685303
Epoch: 13, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.123 Vali Acc: 0.530 Test Loss: 1.123 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.913304328918457
Epoch: 14, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.994 Vali Acc: 0.530 Test Loss: 0.994 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1567318439483643
Epoch: 15, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.966 Vali Acc: 0.540 Test Loss: 0.966 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539990).  Saving model ...
Epoch: 16 cost time: 3.2580182552337646
Epoch: 16, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.267 Vali Acc: 0.560 Test Loss: 1.267 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559987).  Saving model ...
Epoch: 17 cost time: 2.6550960540771484
Epoch: 17, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.129 Vali Acc: 0.520 Test Loss: 1.129 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.623652458190918
Epoch: 18, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.316 Vali Acc: 0.510 Test Loss: 1.316 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.733290433883667
Epoch: 19, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.329 Vali Acc: 0.560 Test Loss: 1.329 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.696371555328369
Epoch: 20, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.251 Vali Acc: 0.570 Test Loss: 1.251 Test Acc: 0.570
Validation loss decreased (-0.559987 --> -0.569987).  Saving model ...
Epoch: 21 cost time: 3.5102224349975586
Epoch: 21, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.447 Vali Acc: 0.600 Test Loss: 1.447 Test Acc: 0.600
Validation loss decreased (-0.569987 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 3.338418483734131
Epoch: 22, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.420 Vali Acc: 0.570 Test Loss: 1.420 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5556890964508057
Epoch: 23, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.402 Vali Acc: 0.620 Test Loss: 1.402 Test Acc: 0.620
Validation loss decreased (-0.599986 --> -0.619986).  Saving model ...
Epoch: 24 cost time: 3.5763492584228516
Epoch: 24, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.652 Vali Acc: 0.600 Test Loss: 1.652 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9820003509521484
Epoch: 25, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.571 Vali Acc: 0.600 Test Loss: 1.571 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8974878787994385
Epoch: 26, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.515 Vali Acc: 0.600 Test Loss: 1.515 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9605019092559814
Epoch: 27, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.749 Vali Acc: 0.570 Test Loss: 1.749 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.04274845123291
Epoch: 28, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.978 Vali Acc: 0.550 Test Loss: 1.978 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.974130153656006
Epoch: 29, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.808 Vali Acc: 0.580 Test Loss: 1.808 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.806386709213257
Epoch: 30, Steps: 20 | Train Loss: 0.088 Vali Loss: 2.291 Vali Acc: 0.550 Test Loss: 2.291 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.4244508743286133
Epoch: 31, Steps: 20 | Train Loss: 0.176 Vali Loss: 2.104 Vali Acc: 0.580 Test Loss: 2.104 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.2123310565948486
Epoch: 32, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.901 Vali Acc: 0.590 Test Loss: 1.901 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.2777771949768066
Epoch: 33, Steps: 20 | Train Loss: 0.108 Vali Loss: 2.053 Vali Acc: 0.560 Test Loss: 2.053 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2259202
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.489191055297852
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.2890796661376953
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.815 Vali Acc: 0.470 Test Loss: 0.815 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2944767475128174
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.295485496520996
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.821 Vali Acc: 0.480 Test Loss: 0.821 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3390119075775146
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.5021440982818604
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.957 Vali Acc: 0.520 Test Loss: 0.957 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1571526527404785
Epoch: 7, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.204784870147705
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0907657146453857
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 1.028 Vali Acc: 0.520 Test Loss: 1.028 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8492283821105957
Epoch: 10, Steps: 20 | Train Loss: 0.703 Vali Loss: 1.012 Vali Acc: 0.540 Test Loss: 1.012 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 11 cost time: 2.9381070137023926
Epoch: 11, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.179379940032959
Epoch: 12, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.974 Vali Acc: 0.510 Test Loss: 0.974 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2686259746551514
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.067 Vali Acc: 0.530 Test Loss: 1.067 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.034475088119507
Epoch: 14, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.933 Vali Acc: 0.570 Test Loss: 0.933 Test Acc: 0.570
Validation loss decreased (-0.539990 --> -0.569991).  Saving model ...
Epoch: 15 cost time: 3.536161422729492
Epoch: 15, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.951 Vali Acc: 0.500 Test Loss: 0.951 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.437159538269043
Epoch: 16, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7155284881591797
Epoch: 17, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.065 Vali Acc: 0.550 Test Loss: 1.065 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7229719161987305
Epoch: 18, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.398 Vali Acc: 0.510 Test Loss: 1.398 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.124162197113037
Epoch: 19, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.135 Vali Acc: 0.560 Test Loss: 1.135 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.443800449371338
Epoch: 20, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.359 Vali Acc: 0.580 Test Loss: 1.359 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579986).  Saving model ...
Epoch: 21 cost time: 3.364734411239624
Epoch: 21, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.629 Vali Acc: 0.570 Test Loss: 1.629 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7259323596954346
Epoch: 22, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.360 Vali Acc: 0.540 Test Loss: 1.360 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.474243402481079
Epoch: 23, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.535 Vali Acc: 0.590 Test Loss: 1.535 Test Acc: 0.590
Validation loss decreased (-0.579986 --> -0.589985).  Saving model ...
Epoch: 24 cost time: 2.8988146781921387
Epoch: 24, Steps: 20 | Train Loss: 0.196 Vali Loss: 2.204 Vali Acc: 0.580 Test Loss: 2.204 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1241040229797363
Epoch: 25, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.649 Vali Acc: 0.540 Test Loss: 1.649 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.087223529815674
Epoch: 26, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.773 Vali Acc: 0.570 Test Loss: 1.773 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9834229946136475
Epoch: 27, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.698 Vali Acc: 0.560 Test Loss: 1.698 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.3622469902038574
Epoch: 28, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.715 Vali Acc: 0.550 Test Loss: 1.715 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3692009449005127
Epoch: 29, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.701 Vali Acc: 0.560 Test Loss: 1.701 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7291688919067383
Epoch: 30, Steps: 20 | Train Loss: 0.131 Vali Loss: 2.308 Vali Acc: 0.560 Test Loss: 2.308 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.701251745223999
Epoch: 31, Steps: 20 | Train Loss: 0.117 Vali Loss: 2.202 Vali Acc: 0.550 Test Loss: 2.202 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.300776243209839
Epoch: 32, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.780 Vali Acc: 0.580 Test Loss: 1.780 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.8573789596557617
Epoch: 33, Steps: 20 | Train Loss: 0.168 Vali Loss: 2.146 Vali Acc: 0.580 Test Loss: 2.146 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2259202
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.88036322593689
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.757 Vali Acc: 0.470 Test Loss: 0.757 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.9717705249786377
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.025995969772339
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.915 Vali Acc: 0.530 Test Loss: 0.915 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 3.527698516845703
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.811 Vali Acc: 0.440 Test Loss: 0.811 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.979495048522949
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1084752082824707
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 3.1818623542785645
Epoch: 7, Steps: 20 | Train Loss: 0.740 Vali Loss: 0.870 Vali Acc: 0.510 Test Loss: 0.870 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7358686923980713
Epoch: 8, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.055581569671631
Epoch: 9, Steps: 20 | Train Loss: 0.622 Vali Loss: 1.023 Vali Acc: 0.530 Test Loss: 1.023 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.017406940460205
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.983023166656494
Epoch: 11, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.845 Vali Acc: 0.520 Test Loss: 0.845 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0372118949890137
Epoch: 12, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.012 Vali Acc: 0.440 Test Loss: 1.012 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.249997138977051
Epoch: 13, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.123 Vali Acc: 0.510 Test Loss: 1.123 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.571805953979492
Epoch: 14, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.933 Vali Acc: 0.570 Test Loss: 0.933 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569991).  Saving model ...
Epoch: 15 cost time: 3.7694714069366455
Epoch: 15, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4503836631774902
Epoch: 16, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.473 Vali Acc: 0.520 Test Loss: 1.473 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.135225772857666
Epoch: 17, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.075 Vali Acc: 0.550 Test Loss: 1.075 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.816038131713867
Epoch: 18, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.381 Vali Acc: 0.540 Test Loss: 1.381 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5185728073120117
Epoch: 19, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.268 Vali Acc: 0.540 Test Loss: 1.268 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8537850379943848
Epoch: 20, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.593 Vali Acc: 0.580 Test Loss: 1.593 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579984).  Saving model ...
Epoch: 21 cost time: 2.668966770172119
Epoch: 21, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.726 Vali Acc: 0.540 Test Loss: 1.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8086113929748535
Epoch: 22, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.267 Vali Acc: 0.570 Test Loss: 1.267 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7197582721710205
Epoch: 23, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.418 Vali Acc: 0.600 Test Loss: 1.418 Test Acc: 0.600
Validation loss decreased (-0.579984 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 3.864157199859619
Epoch: 24, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.676 Vali Acc: 0.620 Test Loss: 1.676 Test Acc: 0.620
Validation loss decreased (-0.599986 --> -0.619983).  Saving model ...
Epoch: 25 cost time: 3.932241201400757
Epoch: 25, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.698 Vali Acc: 0.610 Test Loss: 1.698 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7351553440093994
Epoch: 26, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.567 Vali Acc: 0.630 Test Loss: 1.567 Test Acc: 0.630
Validation loss decreased (-0.619983 --> -0.629984).  Saving model ...
Epoch: 27 cost time: 3.0134239196777344
Epoch: 27, Steps: 20 | Train Loss: 0.139 Vali Loss: 1.790 Vali Acc: 0.540 Test Loss: 1.790 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.957108497619629
Epoch: 28, Steps: 20 | Train Loss: 0.130 Vali Loss: 2.059 Vali Acc: 0.550 Test Loss: 2.059 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9074370861053467
Epoch: 29, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.783 Vali Acc: 0.600 Test Loss: 1.783 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2502405643463135
Epoch: 30, Steps: 20 | Train Loss: 0.118 Vali Loss: 2.425 Vali Acc: 0.570 Test Loss: 2.425 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7586145401000977
Epoch: 31, Steps: 20 | Train Loss: 0.132 Vali Loss: 2.172 Vali Acc: 0.570 Test Loss: 2.172 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.830808639526367
Epoch: 32, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.531 Vali Acc: 0.530 Test Loss: 2.531 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.2117507457733154
Epoch: 33, Steps: 20 | Train Loss: 0.076 Vali Loss: 2.440 Vali Acc: 0.540 Test Loss: 2.440 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.302410125732422
Epoch: 34, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.445 Vali Acc: 0.610 Test Loss: 2.445 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.4420313835144043
Epoch: 35, Steps: 20 | Train Loss: 0.084 Vali Loss: 2.652 Vali Acc: 0.590 Test Loss: 2.652 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.8327009677886963
Epoch: 36, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.620 Vali Acc: 0.580 Test Loss: 2.620 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2259202
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.7946412563323975
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.752 Vali Acc: 0.440 Test Loss: 0.752 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 3.3203508853912354
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.794 Vali Acc: 0.450 Test Loss: 0.794 Test Acc: 0.450
Validation loss decreased (-0.439992 --> -0.449992).  Saving model ...
Epoch: 3 cost time: 3.6016297340393066
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.863 Vali Acc: 0.500 Test Loss: 0.863 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 3.5374622344970703
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 2.828179121017456
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9027464389801025
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.887 Vali Acc: 0.560 Test Loss: 0.887 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 3.0821783542633057
Epoch: 7, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7253925800323486
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.961 Vali Acc: 0.520 Test Loss: 0.961 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9077444076538086
Epoch: 9, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.994 Vali Acc: 0.540 Test Loss: 0.994 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9764769077301025
Epoch: 10, Steps: 20 | Train Loss: 0.609 Vali Loss: 1.100 Vali Acc: 0.480 Test Loss: 1.100 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.389558792114258
Epoch: 11, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5271646976470947
Epoch: 12, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.897 Vali Acc: 0.460 Test Loss: 0.897 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3721067905426025
Epoch: 13, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.033 Vali Acc: 0.510 Test Loss: 1.033 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.753382921218872
Epoch: 14, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.036 Vali Acc: 0.560 Test Loss: 1.036 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6309831142425537
Epoch: 15, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.010 Vali Acc: 0.530 Test Loss: 1.010 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.3910601139068604
Epoch: 16, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2259202
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.896565914154053
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.796454668045044
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.460874557495117
Epoch: 3, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.964 Vali Acc: 0.490 Test Loss: 0.964 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.996929407119751
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.0966665744781494
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.774 Vali Acc: 0.580 Test Loss: 0.774 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 2.7594754695892334
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.027966260910034
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3227005004882812
Epoch: 8, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.900 Vali Acc: 0.550 Test Loss: 0.900 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.866455078125
Epoch: 9, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.037 Vali Acc: 0.490 Test Loss: 1.037 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5140717029571533
Epoch: 10, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.795 Vali Acc: 0.610 Test Loss: 0.795 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 11 cost time: 3.3621082305908203
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.650439977645874
Epoch: 12, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.012 Vali Acc: 0.460 Test Loss: 1.012 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7398693561553955
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.625849485397339
Epoch: 14, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.067490339279175
Epoch: 15, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.559 Vali Acc: 0.550 Test Loss: 1.559 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9737277030944824
Epoch: 16, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.241 Vali Acc: 0.560 Test Loss: 1.241 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.110025405883789
Epoch: 17, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.211 Vali Acc: 0.570 Test Loss: 1.211 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1543006896972656
Epoch: 18, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.209 Vali Acc: 0.530 Test Loss: 1.209 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.446164131164551
Epoch: 19, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.091 Vali Acc: 0.580 Test Loss: 1.091 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1956722736358643
Epoch: 20, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.380 Vali Acc: 0.530 Test Loss: 1.380 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1734914
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.281899929046631
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.811 Vali Acc: 0.470 Test Loss: 0.811 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.452253818511963
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.7077081203460693
Epoch: 3, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7113728523254395
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6459665298461914
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 2.5702786445617676
Epoch: 6, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0836904048919678
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.922 Vali Acc: 0.470 Test Loss: 0.922 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.380164384841919
Epoch: 8, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.945 Vali Acc: 0.540 Test Loss: 0.945 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.509584426879883
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.095 Vali Acc: 0.510 Test Loss: 1.095 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.613354206085205
Epoch: 10, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.830 Vali Acc: 0.580 Test Loss: 0.830 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 3.604539394378662
Epoch: 11, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.986 Vali Acc: 0.480 Test Loss: 0.986 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.856166362762451
Epoch: 12, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.122 Vali Acc: 0.490 Test Loss: 1.122 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9996981620788574
Epoch: 13, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.966 Vali Acc: 0.510 Test Loss: 0.966 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4331696033477783
Epoch: 14, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.701385259628296
Epoch: 15, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.205 Vali Acc: 0.540 Test Loss: 1.205 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7176990509033203
Epoch: 16, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.325 Vali Acc: 0.480 Test Loss: 1.325 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4107248783111572
Epoch: 17, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.219 Vali Acc: 0.480 Test Loss: 1.219 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.445591926574707
Epoch: 18, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.185 Vali Acc: 0.570 Test Loss: 1.185 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.458153486251831
Epoch: 19, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.330 Vali Acc: 0.550 Test Loss: 1.330 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6721413135528564
Epoch: 20, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.488 Vali Acc: 0.510 Test Loss: 1.488 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1734914
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.9136762619018555
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.805 Vali Acc: 0.470 Test Loss: 0.805 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.185774803161621
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 3.0053648948669434
Epoch: 3, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.898 Vali Acc: 0.470 Test Loss: 0.898 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.017951488494873
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.160416841506958
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 3.71730637550354
Epoch: 6, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3825173377990723
Epoch: 7, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.275101900100708
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1625921726226807
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4856674671173096
Epoch: 10, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.778 Vali Acc: 0.590 Test Loss: 0.778 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 3.691361427307129
Epoch: 11, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1889801025390625
Epoch: 12, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9386284351348877
Epoch: 13, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5261893272399902
Epoch: 14, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.347 Vali Acc: 0.550 Test Loss: 1.347 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.164262056350708
Epoch: 15, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.378 Vali Acc: 0.530 Test Loss: 1.378 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3636062145233154
Epoch: 16, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.308 Vali Acc: 0.470 Test Loss: 1.308 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0963008403778076
Epoch: 17, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.355 Vali Acc: 0.510 Test Loss: 1.355 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2287538051605225
Epoch: 18, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.083177089691162
Epoch: 19, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.148 Vali Acc: 0.530 Test Loss: 1.148 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0077080726623535
Epoch: 20, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.476 Vali Acc: 0.470 Test Loss: 1.476 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1734914
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.609325408935547
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.8540990352630615
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.694260358810425
Epoch: 3, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 2.1191983222961426
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
Validation loss decreased (-0.499991 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 3.0698463916778564
Epoch: 5, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4536612033843994
Epoch: 6, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.174016237258911
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0250046253204346
Epoch: 8, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.870 Vali Acc: 0.520 Test Loss: 0.870 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.891141176223755
Epoch: 9, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6624081134796143
Epoch: 10, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.773 Vali Acc: 0.600 Test Loss: 0.773 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 11 cost time: 3.644195795059204
Epoch: 11, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.917 Vali Acc: 0.540 Test Loss: 0.917 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5005218982696533
Epoch: 12, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.956 Vali Acc: 0.480 Test Loss: 0.956 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7129626274108887
Epoch: 13, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3815791606903076
Epoch: 14, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.524935483932495
Epoch: 15, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.297 Vali Acc: 0.560 Test Loss: 1.297 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.873997926712036
Epoch: 16, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.420 Vali Acc: 0.510 Test Loss: 1.420 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5249879360198975
Epoch: 17, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.151 Vali Acc: 0.620 Test Loss: 1.151 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619988).  Saving model ...
Epoch: 18 cost time: 3.370032787322998
Epoch: 18, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.411 Vali Acc: 0.530 Test Loss: 1.411 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0087387561798096
Epoch: 19, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.013824224472046
Epoch: 20, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.123 Vali Acc: 0.550 Test Loss: 1.123 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.904482364654541
Epoch: 21, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.258 Vali Acc: 0.640 Test Loss: 1.258 Test Acc: 0.640
Validation loss decreased (-0.619988 --> -0.639987).  Saving model ...
Epoch: 22 cost time: 3.2379000186920166
Epoch: 22, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.750 Vali Acc: 0.560 Test Loss: 1.750 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2190558910369873
Epoch: 23, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.618 Vali Acc: 0.620 Test Loss: 1.618 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0616793632507324
Epoch: 24, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.608 Vali Acc: 0.580 Test Loss: 1.608 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.843351364135742
Epoch: 25, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.559 Vali Acc: 0.630 Test Loss: 1.559 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.789883613586426
Epoch: 26, Steps: 20 | Train Loss: 0.066 Vali Loss: 2.191 Vali Acc: 0.590 Test Loss: 2.191 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.9617269039154053
Epoch: 27, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.575 Vali Acc: 0.580 Test Loss: 1.575 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2518157958984375
Epoch: 28, Steps: 20 | Train Loss: 0.081 Vali Loss: 2.195 Vali Acc: 0.560 Test Loss: 2.195 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.4530208110809326
Epoch: 29, Steps: 20 | Train Loss: 0.063 Vali Loss: 1.969 Vali Acc: 0.540 Test Loss: 1.969 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.690972328186035
Epoch: 30, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.980 Vali Acc: 0.570 Test Loss: 1.980 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.146179437637329
Epoch: 31, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.300 Vali Acc: 0.560 Test Loss: 2.300 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1734914
model size : 16.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.241448879241943
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.763317584991455
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.4109222888946533
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.838 Vali Acc: 0.550 Test Loss: 0.838 Test Acc: 0.550
Validation loss decreased (-0.509992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 2.780651807785034
Epoch: 4, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9592068195343018
Epoch: 5, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5191991329193115
Epoch: 6, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.344158887863159
Epoch: 7, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.634265899658203
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.107774496078491
Epoch: 9, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.758984088897705
Epoch: 10, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.181 Vali Acc: 0.560 Test Loss: 1.181 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559988).  Saving model ...
Epoch: 11 cost time: 3.058809757232666
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.890 Vali Acc: 0.530 Test Loss: 0.890 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9099462032318115
Epoch: 12, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.921 Vali Acc: 0.540 Test Loss: 0.921 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.171722650527954
Epoch: 13, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.100 Vali Acc: 0.530 Test Loss: 1.100 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.832962989807129
Epoch: 14, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5698421001434326
Epoch: 15, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.091 Vali Acc: 0.560 Test Loss: 1.091 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 3.85050630569458
Epoch: 16, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.100 Vali Acc: 0.490 Test Loss: 1.100 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4003515243530273
Epoch: 17, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.497 Vali Acc: 0.510 Test Loss: 1.497 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.830369710922241
Epoch: 18, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.517 Vali Acc: 0.540 Test Loss: 1.517 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7958900928497314
Epoch: 19, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.483 Vali Acc: 0.530 Test Loss: 1.483 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.852459669113159
Epoch: 20, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.402 Vali Acc: 0.510 Test Loss: 1.402 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8427085876464844
Epoch: 21, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.631 Vali Acc: 0.530 Test Loss: 1.631 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.371791362762451
Epoch: 22, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.676 Vali Acc: 0.520 Test Loss: 1.676 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.2497706413269043
Epoch: 23, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.164 Vali Acc: 0.510 Test Loss: 2.164 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1438519954681396
Epoch: 24, Steps: 20 | Train Loss: 0.243 Vali Loss: 2.020 Vali Acc: 0.550 Test Loss: 2.020 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7329647541046143
Epoch: 25, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.747 Vali Acc: 0.540 Test Loss: 1.747 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1472770
model size : 15.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.690755128860474
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.4812912940979004
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.152261972427368
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.170897960662842
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.753685474395752
Epoch: 5, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.3010287284851074
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.965 Vali Acc: 0.570 Test Loss: 0.965 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569990).  Saving model ...
Epoch: 7 cost time: 3.2800514698028564
Epoch: 7, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4179115295410156
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6653332710266113
Epoch: 9, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6426148414611816
Epoch: 10, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.705601930618286
Epoch: 11, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.949 Vali Acc: 0.550 Test Loss: 0.949 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8371880054473877
Epoch: 12, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.706728458404541
Epoch: 13, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.121 Vali Acc: 0.490 Test Loss: 1.121 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.472416639328003
Epoch: 14, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.285 Vali Acc: 0.460 Test Loss: 1.285 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.746948480606079
Epoch: 15, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.190 Vali Acc: 0.530 Test Loss: 1.190 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.395843267440796
Epoch: 16, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.179 Vali Acc: 0.530 Test Loss: 1.179 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1472770
model size : 15.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.500428915023804
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.385134696960449
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.030460834503174
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 3.5630228519439697
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7271370887756348
Epoch: 5, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 3.623546600341797
Epoch: 6, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.842257499694824
Epoch: 7, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6992762088775635
Epoch: 8, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6312029361724854
Epoch: 9, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.903578519821167
Epoch: 10, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.377185106277466
Epoch: 11, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.942 Vali Acc: 0.520 Test Loss: 0.942 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.614210367202759
Epoch: 12, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.005 Vali Acc: 0.510 Test Loss: 1.005 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8221569061279297
Epoch: 13, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.8051438331604004
Epoch: 14, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.5609147548675537
Epoch: 15, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.042 Vali Acc: 0.540 Test Loss: 1.042 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1472770
model size : 15.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.5912463665008545
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.940810441970825
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.8082759380340576
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.9397034645080566
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 2.845884084701538
Epoch: 5, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.431887149810791
Epoch: 6, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.908 Vali Acc: 0.540 Test Loss: 0.908 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 3.250518798828125
Epoch: 7, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.045269250869751
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 3.593256950378418
Epoch: 9, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 3.3590431213378906
Epoch: 10, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0388174057006836
Epoch: 11, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3262314796447754
Epoch: 12, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.960 Vali Acc: 0.490 Test Loss: 0.960 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.496283531188965
Epoch: 13, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.306 Vali Acc: 0.490 Test Loss: 1.306 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.624732732772827
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4767515659332275
Epoch: 15, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.186 Vali Acc: 0.590 Test Loss: 1.186 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589988).  Saving model ...
Epoch: 16 cost time: 3.316960573196411
Epoch: 16, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.140 Vali Acc: 0.530 Test Loss: 1.140 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2653138637542725
Epoch: 17, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.375 Vali Acc: 0.560 Test Loss: 1.375 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.592989921569824
Epoch: 18, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.511 Vali Acc: 0.540 Test Loss: 1.511 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9227333068847656
Epoch: 19, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.503 Vali Acc: 0.590 Test Loss: 1.503 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.553452491760254
Epoch: 20, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.340 Vali Acc: 0.550 Test Loss: 1.340 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.770418405532837
Epoch: 21, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.548 Vali Acc: 0.530 Test Loss: 1.548 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.291818618774414
Epoch: 22, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.386333465576172
Epoch: 23, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.732 Vali Acc: 0.510 Test Loss: 2.732 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.376213550567627
Epoch: 24, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.646 Vali Acc: 0.550 Test Loss: 1.646 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4034764766693115
Epoch: 25, Steps: 20 | Train Loss: 0.125 Vali Loss: 1.609 Vali Acc: 0.580 Test Loss: 1.609 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1472770
model size : 15.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.523001432418823
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.0098068714141846
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 3.325810670852661
Epoch: 3, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.394782543182373
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.932 Vali Acc: 0.520 Test Loss: 0.932 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519991).  Saving model ...
Epoch: 5 cost time: 3.257990598678589
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.834 Vali Acc: 0.480 Test Loss: 0.834 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1689834594726562
Epoch: 6, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 3.072883367538452
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.858 Vali Acc: 0.430 Test Loss: 0.858 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.983166456222534
Epoch: 8, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.911 Vali Acc: 0.560 Test Loss: 0.911 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 2.838191032409668
Epoch: 9, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.854 Vali Acc: 0.510 Test Loss: 0.854 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6395986080169678
Epoch: 10, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.965 Vali Acc: 0.530 Test Loss: 0.965 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8540475368499756
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.014 Vali Acc: 0.540 Test Loss: 1.014 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8922650814056396
Epoch: 12, Steps: 20 | Train Loss: 0.522 Vali Loss: 1.108 Vali Acc: 0.520 Test Loss: 1.108 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6754629611968994
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.874 Vali Acc: 0.550 Test Loss: 0.874 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9860005378723145
Epoch: 14, Steps: 20 | Train Loss: 0.514 Vali Loss: 1.441 Vali Acc: 0.490 Test Loss: 1.441 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.990697145462036
Epoch: 15, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.140 Vali Acc: 0.480 Test Loss: 1.140 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.92362904548645
Epoch: 16, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1859030723571777
Epoch: 17, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.164 Vali Acc: 0.540 Test Loss: 1.164 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1822426319122314
Epoch: 18, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.521 Vali Acc: 0.530 Test Loss: 1.521 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1341698
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.760548114776611
Epoch: 1, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.805 Vali Acc: 0.470 Test Loss: 0.805 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.1177849769592285
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 3.19323992729187
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6980199813842773
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.961 Vali Acc: 0.480 Test Loss: 0.961 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.606527090072632
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.847 Vali Acc: 0.470 Test Loss: 0.847 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3089869022369385
Epoch: 6, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 3.7714102268218994
Epoch: 7, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.448065757751465
Epoch: 8, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.924 Vali Acc: 0.580 Test Loss: 0.924 Test Acc: 0.580
Validation loss decreased (-0.529991 --> -0.579991).  Saving model ...
Epoch: 9 cost time: 3.3702361583709717
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.483961582183838
Epoch: 10, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.975 Vali Acc: 0.550 Test Loss: 0.975 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.139673233032227
Epoch: 11, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.980 Vali Acc: 0.560 Test Loss: 0.980 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.116513013839722
Epoch: 12, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.970033884048462
Epoch: 13, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2635796070098877
Epoch: 14, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.480 Vali Acc: 0.510 Test Loss: 1.480 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8862252235412598
Epoch: 15, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.054691791534424
Epoch: 16, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.103 Vali Acc: 0.560 Test Loss: 1.103 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.925544261932373
Epoch: 17, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.212 Vali Acc: 0.530 Test Loss: 1.212 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5515313148498535
Epoch: 18, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.329 Vali Acc: 0.530 Test Loss: 1.329 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1341698
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.274142265319824
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.1614298820495605
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.24862003326416
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.978886604309082
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.927 Vali Acc: 0.490 Test Loss: 0.927 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.691497325897217
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.461428642272949
Epoch: 6, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 4.006699562072754
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.895 Vali Acc: 0.540 Test Loss: 0.895 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539991).  Saving model ...
Epoch: 8 cost time: 3.9586374759674072
Epoch: 8, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.698242425918579
Epoch: 9, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.777763843536377
Epoch: 10, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.010 Vali Acc: 0.520 Test Loss: 1.010 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4667677879333496
Epoch: 11, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.989 Vali Acc: 0.550 Test Loss: 0.989 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549990).  Saving model ...
Epoch: 12 cost time: 3.15928316116333
Epoch: 12, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.163 Vali Acc: 0.490 Test Loss: 1.163 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.770641565322876
Epoch: 13, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.877 Vali Acc: 0.570 Test Loss: 0.877 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569991).  Saving model ...
Epoch: 14 cost time: 2.4789743423461914
Epoch: 14, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.415 Vali Acc: 0.540 Test Loss: 1.415 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.744934558868408
Epoch: 15, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.271 Vali Acc: 0.490 Test Loss: 1.271 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9791126251220703
Epoch: 16, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.012 Vali Acc: 0.530 Test Loss: 1.012 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.741764545440674
Epoch: 17, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7025508880615234
Epoch: 18, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.209 Vali Acc: 0.590 Test Loss: 1.209 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589988).  Saving model ...
Epoch: 19 cost time: 3.7258434295654297
Epoch: 19, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4130682945251465
Epoch: 20, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.292701482772827
Epoch: 21, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.936 Vali Acc: 0.540 Test Loss: 1.936 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8207316398620605
Epoch: 22, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.462 Vali Acc: 0.540 Test Loss: 1.462 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.256600856781006
Epoch: 23, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.522 Vali Acc: 0.560 Test Loss: 1.522 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.086774587631226
Epoch: 24, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.417 Vali Acc: 0.610 Test Loss: 1.417 Test Acc: 0.610
Validation loss decreased (-0.589988 --> -0.609986).  Saving model ...
Epoch: 25 cost time: 4.003420352935791
Epoch: 25, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.863 Vali Acc: 0.550 Test Loss: 1.863 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.538933277130127
Epoch: 26, Steps: 20 | Train Loss: 0.341 Vali Loss: 2.664 Vali Acc: 0.550 Test Loss: 2.664 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.627319812774658
Epoch: 27, Steps: 20 | Train Loss: 0.508 Vali Loss: 2.053 Vali Acc: 0.540 Test Loss: 2.053 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6382322311401367
Epoch: 28, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.962 Vali Acc: 0.560 Test Loss: 1.962 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.093612194061279
Epoch: 29, Steps: 20 | Train Loss: 0.107 Vali Loss: 2.087 Vali Acc: 0.570 Test Loss: 2.087 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.413311243057251
Epoch: 30, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.834 Vali Acc: 0.620 Test Loss: 1.834 Test Acc: 0.620
Validation loss decreased (-0.609986 --> -0.619982).  Saving model ...
Epoch: 31 cost time: 3.308241844177246
Epoch: 31, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.275 Vali Acc: 0.520 Test Loss: 2.275 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2648837566375732
Epoch: 32, Steps: 20 | Train Loss: 0.175 Vali Loss: 2.429 Vali Acc: 0.560 Test Loss: 2.429 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.8605360984802246
Epoch: 33, Steps: 20 | Train Loss: 0.109 Vali Loss: 2.307 Vali Acc: 0.540 Test Loss: 2.307 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.685941457748413
Epoch: 34, Steps: 20 | Train Loss: 0.080 Vali Loss: 2.377 Vali Acc: 0.570 Test Loss: 2.377 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0521457195281982
Epoch: 35, Steps: 20 | Train Loss: 0.176 Vali Loss: 2.167 Vali Acc: 0.490 Test Loss: 2.167 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.8973631858825684
Epoch: 36, Steps: 20 | Train Loss: 0.135 Vali Loss: 2.396 Vali Acc: 0.590 Test Loss: 2.396 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0454306602478027
Epoch: 37, Steps: 20 | Train Loss: 0.113 Vali Loss: 2.880 Vali Acc: 0.560 Test Loss: 2.880 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.739384412765503
Epoch: 38, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.918 Vali Acc: 0.590 Test Loss: 1.918 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.806164503097534
Epoch: 39, Steps: 20 | Train Loss: 0.074 Vali Loss: 2.627 Vali Acc: 0.540 Test Loss: 2.627 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.363560676574707
Epoch: 40, Steps: 20 | Train Loss: 0.093 Vali Loss: 2.657 Vali Acc: 0.570 Test Loss: 2.657 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1341698
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.249987840652466
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.225876808166504
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6552484035491943
Epoch: 3, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 3.4990735054016113
Epoch: 4, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.322582721710205
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4016661643981934
Epoch: 6, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.850 Vali Acc: 0.480 Test Loss: 0.850 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6402034759521484
Epoch: 7, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0060231685638428
Epoch: 8, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.136691093444824
Epoch: 9, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1758322715759277
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.970 Vali Acc: 0.530 Test Loss: 0.970 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6152031421661377
Epoch: 11, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.901 Vali Acc: 0.550 Test Loss: 0.901 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3732028007507324
Epoch: 12, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.998 Vali Acc: 0.520 Test Loss: 0.998 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.993655204772949
Epoch: 13, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1341698
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.834707736968994
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.120948553085327
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.473862886428833
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.369516372680664
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.099827527999878
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3279552459716797
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 2.912459373474121
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.276669979095459
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2431464195251465
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.868 Vali Acc: 0.480 Test Loss: 0.868 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.271679401397705
Epoch: 10, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.830 Vali Acc: 0.460 Test Loss: 0.830 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3585150241851807
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.710998773574829
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.818265438079834
Epoch: 13, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.924089193344116
Epoch: 14, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.006 Vali Acc: 0.540 Test Loss: 1.006 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.803483247756958
Epoch: 15, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.791 Vali Acc: 0.600 Test Loss: 0.791 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 16 cost time: 3.35089111328125
Epoch: 16, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.341702461242676
Epoch: 17, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.843 Vali Acc: 0.540 Test Loss: 0.843 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.831390380859375
Epoch: 18, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.904 Vali Acc: 0.540 Test Loss: 0.904 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6392288208007812
Epoch: 19, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.725335121154785
Epoch: 20, Steps: 20 | Train Loss: 0.302 Vali Loss: 0.867 Vali Acc: 0.590 Test Loss: 0.867 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6939938068389893
Epoch: 21, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.183 Vali Acc: 0.590 Test Loss: 1.183 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.3360214233398438
Epoch: 22, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.995 Vali Acc: 0.490 Test Loss: 0.995 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.552447557449341
Epoch: 23, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.039 Vali Acc: 0.490 Test Loss: 1.039 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1862499713897705
Epoch: 24, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.204 Vali Acc: 0.540 Test Loss: 1.204 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0502281188964844
Epoch: 25, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.064 Vali Acc: 0.560 Test Loss: 1.064 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2440450
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.838094472885132
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.8639490604400635
Epoch: 2, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5843915939331055
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4890077114105225
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 2.3672497272491455
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.862 Vali Acc: 0.540 Test Loss: 0.862 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.674720525741577
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.788 Vali Acc: 0.600 Test Loss: 0.788 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 3.0070009231567383
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.619532346725464
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.872 Vali Acc: 0.540 Test Loss: 0.872 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.093496799468994
Epoch: 9, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.733922004699707
Epoch: 10, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.660660743713379
Epoch: 11, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.718035936355591
Epoch: 12, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.883 Vali Acc: 0.560 Test Loss: 0.883 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4326822757720947
Epoch: 13, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.440324544906616
Epoch: 14, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.51485538482666
Epoch: 15, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.845 Vali Acc: 0.620 Test Loss: 0.845 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 16 cost time: 3.223573923110962
Epoch: 16, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.026169538497925
Epoch: 17, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.848 Vali Acc: 0.540 Test Loss: 0.848 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2056705951690674
Epoch: 18, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3349151611328125
Epoch: 19, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.116 Vali Acc: 0.520 Test Loss: 1.116 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.406494379043579
Epoch: 20, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.854 Vali Acc: 0.590 Test Loss: 0.854 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.797229051589966
Epoch: 21, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.172 Vali Acc: 0.620 Test Loss: 1.172 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.103503465652466
Epoch: 22, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.045 Vali Acc: 0.520 Test Loss: 1.045 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.996613025665283
Epoch: 23, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.050 Vali Acc: 0.470 Test Loss: 1.050 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.163503885269165
Epoch: 24, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.408 Vali Acc: 0.560 Test Loss: 1.408 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.314533233642578
Epoch: 25, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.124 Vali Acc: 0.530 Test Loss: 1.124 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2440450
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.69742751121521
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.090686321258545
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7606425285339355
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2293407917022705
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 1.5925014019012451
Epoch: 5, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6072802543640137
Epoch: 6, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.770 Vali Acc: 0.560 Test Loss: 0.770 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7325944900512695
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3167479038238525
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1956310272216797
Epoch: 9, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1532564163208008
Epoch: 10, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0984032154083252
Epoch: 11, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.738 Vali Acc: 0.580 Test Loss: 0.738 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 12 cost time: 1.1981196403503418
Epoch: 12, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.334207534790039
Epoch: 13, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2540574073791504
Epoch: 14, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.097 Vali Acc: 0.570 Test Loss: 1.097 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3923184871673584
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.818 Vali Acc: 0.620 Test Loss: 0.818 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619992).  Saving model ...
Epoch: 16 cost time: 1.2277553081512451
Epoch: 16, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0927696228027344
Epoch: 17, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1314775943756104
Epoch: 18, Steps: 20 | Train Loss: 0.266 Vali Loss: 0.866 Vali Acc: 0.570 Test Loss: 0.866 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.183121681213379
Epoch: 19, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.074 Vali Acc: 0.560 Test Loss: 1.074 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2293331623077393
Epoch: 20, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.032 Vali Acc: 0.660 Test Loss: 1.032 Test Acc: 0.660
Validation loss decreased (-0.619992 --> -0.659990).  Saving model ...
Epoch: 21 cost time: 1.1899404525756836
Epoch: 21, Steps: 20 | Train Loss: 0.213 Vali Loss: 0.998 Vali Acc: 0.590 Test Loss: 0.998 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4670045375823975
Epoch: 22, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.298 Vali Acc: 0.530 Test Loss: 1.298 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0846855640411377
Epoch: 23, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.037 Vali Acc: 0.510 Test Loss: 1.037 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1067399978637695
Epoch: 24, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.430 Vali Acc: 0.490 Test Loss: 1.430 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1735401153564453
Epoch: 25, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.048 Vali Acc: 0.570 Test Loss: 1.048 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0329170227050781
Epoch: 26, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.209 Vali Acc: 0.540 Test Loss: 1.209 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1791040897369385
Epoch: 27, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.187 Vali Acc: 0.570 Test Loss: 1.187 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1709864139556885
Epoch: 28, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.181 Vali Acc: 0.620 Test Loss: 1.181 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0808660984039307
Epoch: 29, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.195 Vali Acc: 0.590 Test Loss: 1.195 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.16853928565979
Epoch: 30, Steps: 20 | Train Loss: 0.112 Vali Loss: 1.437 Vali Acc: 0.610 Test Loss: 1.437 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 2440450
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.016712188720703
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.5958473682403564
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5137379169464111
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0654442310333252
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0174012184143066
Epoch: 5, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9889862537384033
Epoch: 6, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589993).  Saving model ...
Epoch: 7 cost time: 1.5395195484161377
Epoch: 7, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0325658321380615
Epoch: 8, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0911786556243896
Epoch: 9, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.839 Vali Acc: 0.540 Test Loss: 0.839 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1510851383209229
Epoch: 10, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9057962894439697
Epoch: 11, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.726 Vali Acc: 0.620 Test Loss: 0.726 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619993).  Saving model ...
Epoch: 12 cost time: 1.288959264755249
Epoch: 12, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.031 Vali Acc: 0.540 Test Loss: 1.031 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.085148811340332
Epoch: 13, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.794 Vali Acc: 0.590 Test Loss: 0.794 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9227275848388672
Epoch: 14, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.088 Vali Acc: 0.570 Test Loss: 1.088 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2047715187072754
Epoch: 15, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.789 Vali Acc: 0.630 Test Loss: 0.789 Test Acc: 0.630
Validation loss decreased (-0.619993 --> -0.629992).  Saving model ...
Epoch: 16 cost time: 1.1873018741607666
Epoch: 16, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.031 Vali Acc: 0.590 Test Loss: 1.031 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1526298522949219
Epoch: 17, Steps: 20 | Train Loss: 0.256 Vali Loss: 0.988 Vali Acc: 0.590 Test Loss: 0.988 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.409203052520752
Epoch: 18, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.086 Vali Acc: 0.610 Test Loss: 1.086 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5428125858306885
Epoch: 19, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.111 Vali Acc: 0.630 Test Loss: 1.111 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5007030963897705
Epoch: 20, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.048 Vali Acc: 0.620 Test Loss: 1.048 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6451926231384277
Epoch: 21, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.437 Vali Acc: 0.580 Test Loss: 1.437 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.386139154434204
Epoch: 22, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4119353294372559
Epoch: 23, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.551 Vali Acc: 0.620 Test Loss: 1.551 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4628989696502686
Epoch: 24, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.410 Vali Acc: 0.640 Test Loss: 1.410 Test Acc: 0.640
Validation loss decreased (-0.629992 --> -0.639986).  Saving model ...
Epoch: 25 cost time: 1.2175312042236328
Epoch: 25, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9860222339630127
Epoch: 26, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.406 Vali Acc: 0.630 Test Loss: 1.406 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.068802833557129
Epoch: 27, Steps: 20 | Train Loss: 0.051 Vali Loss: 1.751 Vali Acc: 0.600 Test Loss: 1.751 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1420924663543701
Epoch: 28, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.851 Vali Acc: 0.590 Test Loss: 1.851 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.14467453956604
Epoch: 29, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.021 Vali Acc: 0.580 Test Loss: 2.021 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.002366304397583
Epoch: 30, Steps: 20 | Train Loss: 0.045 Vali Loss: 2.030 Vali Acc: 0.590 Test Loss: 2.030 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0358917713165283
Epoch: 31, Steps: 20 | Train Loss: 0.045 Vali Loss: 1.854 Vali Acc: 0.560 Test Loss: 1.854 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0742828845977783
Epoch: 32, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.991 Vali Acc: 0.610 Test Loss: 1.991 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3213791847229004
Epoch: 33, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.764 Vali Acc: 0.610 Test Loss: 1.764 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0730993747711182
Epoch: 34, Steps: 20 | Train Loss: 0.037 Vali Loss: 2.065 Vali Acc: 0.620 Test Loss: 2.065 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 2440450
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.0578789710998535
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.1673498153686523
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.750 Vali Acc: 0.460 Test Loss: 0.750 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.849238634109497
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.791 Vali Acc: 0.450 Test Loss: 0.791 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.793912172317505
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 2.9980006217956543
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 3.2332816123962402
Epoch: 6, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.335859775543213
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9637057781219482
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 3.007667303085327
Epoch: 9, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.894 Vali Acc: 0.540 Test Loss: 0.894 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 10 cost time: 2.7661514282226562
Epoch: 10, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6412527561187744
Epoch: 11, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.917 Vali Acc: 0.540 Test Loss: 0.917 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5103871822357178
Epoch: 12, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7612721920013428
Epoch: 13, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
Validation loss decreased (-0.539991 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 2.968348264694214
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8685123920440674
Epoch: 15, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.802 Vali Acc: 0.580 Test Loss: 0.802 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 2.882678985595703
Epoch: 16, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.820986270904541
Epoch: 17, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0868279933929443
Epoch: 18, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0416600704193115
Epoch: 19, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.053 Vali Acc: 0.530 Test Loss: 1.053 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1728832721710205
Epoch: 20, Steps: 20 | Train Loss: 0.367 Vali Loss: 1.017 Vali Acc: 0.530 Test Loss: 1.017 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.244148015975952
Epoch: 21, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.346 Vali Acc: 0.520 Test Loss: 1.346 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0882198810577393
Epoch: 22, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.150 Vali Acc: 0.530 Test Loss: 1.150 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.739156484603882
Epoch: 23, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.944 Vali Acc: 0.570 Test Loss: 0.944 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.6639931201934814
Epoch: 24, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.085 Vali Acc: 0.580 Test Loss: 1.085 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0219836235046387
Epoch: 25, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.165 Vali Acc: 0.560 Test Loss: 1.165 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1391874
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.385212421417236
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.7195582389831543
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.756 Vali Acc: 0.470 Test Loss: 0.756 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.535595417022705
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.787 Vali Acc: 0.430 Test Loss: 0.787 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.487534523010254
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5048012733459473
Epoch: 5, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.755 Vali Acc: 0.570 Test Loss: 0.755 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 2.851672887802124
Epoch: 6, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.409783124923706
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9252853393554688
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.028372049331665
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8651270866394043
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8112399578094482
Epoch: 11, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.901 Vali Acc: 0.550 Test Loss: 0.901 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.716250419616699
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5199077129364014
Epoch: 13, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.493478775024414
Epoch: 14, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.863 Vali Acc: 0.580 Test Loss: 0.863 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 15 cost time: 2.5993292331695557
Epoch: 15, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8416123390197754
Epoch: 16, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.219128131866455
Epoch: 17, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3628604412078857
Epoch: 18, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.100 Vali Acc: 0.570 Test Loss: 1.100 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4012339115142822
Epoch: 19, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.247528553009033
Epoch: 20, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.044 Vali Acc: 0.530 Test Loss: 1.044 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.368584156036377
Epoch: 21, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.350142478942871
Epoch: 22, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.219 Vali Acc: 0.560 Test Loss: 1.219 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.771796226501465
Epoch: 23, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.022 Vali Acc: 0.570 Test Loss: 1.022 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7799456119537354
Epoch: 24, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.098 Vali Acc: 0.580 Test Loss: 1.098 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1391874
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.228996753692627
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.427689552307129
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.350823163986206
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.783 Vali Acc: 0.420 Test Loss: 0.783 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.611180067062378
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.195591926574707
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.761 Vali Acc: 0.580 Test Loss: 0.761 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 3.4636096954345703
Epoch: 6, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.702741861343384
Epoch: 7, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.555051326751709
Epoch: 8, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7338709831237793
Epoch: 9, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.047056198120117
Epoch: 10, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.186377763748169
Epoch: 11, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.891 Vali Acc: 0.560 Test Loss: 0.891 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.853985071182251
Epoch: 12, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7185068130493164
Epoch: 13, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.794 Vali Acc: 0.590 Test Loss: 0.794 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 14 cost time: 2.574307441711426
Epoch: 14, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.770 Vali Acc: 0.600 Test Loss: 0.770 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 15 cost time: 2.6158018112182617
Epoch: 15, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.827 Vali Acc: 0.590 Test Loss: 0.827 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.697087049484253
Epoch: 16, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3828136920928955
Epoch: 17, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2378334999084473
Epoch: 18, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.261293411254883
Epoch: 19, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2118990421295166
Epoch: 20, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.087 Vali Acc: 0.530 Test Loss: 1.087 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.907937526702881
Epoch: 21, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.147 Vali Acc: 0.540 Test Loss: 1.147 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.137718915939331
Epoch: 22, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.257 Vali Acc: 0.550 Test Loss: 1.257 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3437728881835938
Epoch: 23, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1183412075042725
Epoch: 24, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.156 Vali Acc: 0.590 Test Loss: 1.156 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1391874
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.900944471359253
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.7814550399780273
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 2.969634771347046
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.775 Vali Acc: 0.460 Test Loss: 0.775 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1408960819244385
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7480432987213135
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 3.2287445068359375
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 2.731407880783081
Epoch: 7, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.7474184036254883
Epoch: 8, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 2.9045631885528564
Epoch: 9, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1819186210632324
Epoch: 10, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.860 Vali Acc: 0.550 Test Loss: 0.860 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.386409282684326
Epoch: 11, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.90891170501709
Epoch: 12, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0602121353149414
Epoch: 13, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.780 Vali Acc: 0.610 Test Loss: 0.780 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 14 cost time: 2.5484282970428467
Epoch: 14, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.807 Vali Acc: 0.630 Test Loss: 0.807 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629992).  Saving model ...
Epoch: 15 cost time: 2.8488476276397705
Epoch: 15, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.819 Vali Acc: 0.620 Test Loss: 0.819 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2437968254089355
Epoch: 16, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.024 Vali Acc: 0.580 Test Loss: 1.024 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2981929779052734
Epoch: 17, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0512285232543945
Epoch: 18, Steps: 20 | Train Loss: 0.239 Vali Loss: 0.951 Vali Acc: 0.590 Test Loss: 0.951 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.282928705215454
Epoch: 19, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.040 Vali Acc: 0.590 Test Loss: 1.040 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6470677852630615
Epoch: 20, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4542534351348877
Epoch: 21, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.164 Vali Acc: 0.610 Test Loss: 1.164 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.864144802093506
Epoch: 22, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.431 Vali Acc: 0.570 Test Loss: 1.431 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.835900068283081
Epoch: 23, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.336 Vali Acc: 0.600 Test Loss: 1.336 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.963103771209717
Epoch: 24, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.500 Vali Acc: 0.590 Test Loss: 1.500 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1391874
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.841561555862427
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8929290771484375
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.001983404159546
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.786378860473633
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 2.549938201904297
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4095346927642822
Epoch: 6, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 3.690518379211426
Epoch: 7, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4490482807159424
Epoch: 8, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.554380416870117
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.514937400817871
Epoch: 10, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8342204093933105
Epoch: 11, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 12 cost time: 3.112340211868286
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.870 Vali Acc: 0.540 Test Loss: 0.870 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1495182514190674
Epoch: 13, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 2.5619208812713623
Epoch: 14, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.908 Vali Acc: 0.530 Test Loss: 0.908 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5177347660064697
Epoch: 15, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.904 Vali Acc: 0.500 Test Loss: 0.904 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4972641468048096
Epoch: 16, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.953 Vali Acc: 0.530 Test Loss: 0.953 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.946575880050659
Epoch: 17, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.021 Vali Acc: 0.510 Test Loss: 1.021 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.826827049255371
Epoch: 18, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.540278434753418
Epoch: 19, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.921 Vali Acc: 0.560 Test Loss: 0.921 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3639068603515625
Epoch: 20, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.941 Vali Acc: 0.590 Test Loss: 0.941 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589991).  Saving model ...
Epoch: 21 cost time: 2.4837560653686523
Epoch: 21, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.087 Vali Acc: 0.540 Test Loss: 1.087 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.700096368789673
Epoch: 22, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9624598026275635
Epoch: 23, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.031 Vali Acc: 0.580 Test Loss: 1.031 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.120333433151245
Epoch: 24, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.184 Vali Acc: 0.540 Test Loss: 1.184 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3027501106262207
Epoch: 25, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3804080486297607
Epoch: 26, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.315 Vali Acc: 0.580 Test Loss: 1.315 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.256847620010376
Epoch: 27, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.034 Vali Acc: 0.560 Test Loss: 1.034 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.435149669647217
Epoch: 28, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.0573580265045166
Epoch: 29, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.752 Vali Acc: 0.570 Test Loss: 1.752 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.512852191925049
Epoch: 30, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.453 Vali Acc: 0.610 Test Loss: 1.453 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609985).  Saving model ...
Epoch: 31 cost time: 2.835728406906128
Epoch: 31, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.482 Vali Acc: 0.540 Test Loss: 1.482 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.635317802429199
Epoch: 32, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.516 Vali Acc: 0.590 Test Loss: 1.516 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6271564960479736
Epoch: 33, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.369 Vali Acc: 0.580 Test Loss: 1.369 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.820965051651001
Epoch: 34, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.361 Vali Acc: 0.580 Test Loss: 1.361 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.275432586669922
Epoch: 35, Steps: 20 | Train Loss: 0.135 Vali Loss: 1.448 Vali Acc: 0.600 Test Loss: 1.448 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.148393154144287
Epoch: 36, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.709 Vali Acc: 0.560 Test Loss: 1.709 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.77533221244812
Epoch: 37, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.432 Vali Acc: 0.570 Test Loss: 1.432 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.5645275115966797
Epoch: 38, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.468 Vali Acc: 0.590 Test Loss: 1.468 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.692835569381714
Epoch: 39, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.991 Vali Acc: 0.540 Test Loss: 1.991 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.6255147457122803
Epoch: 40, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.477 Vali Acc: 0.530 Test Loss: 1.477 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 867586
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.835793972015381
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7953288555145264
Epoch: 2, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.039754867553711
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4899487495422363
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 3.2746901512145996
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 3.362523317337036
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.787 Vali Acc: 0.530 Test Loss: 0.787 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 3.089660406112671
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 3.1237456798553467
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.261974573135376
Epoch: 9, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 3.2754290103912354
Epoch: 10, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2675294876098633
Epoch: 11, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.880 Vali Acc: 0.590 Test Loss: 0.880 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589991).  Saving model ...
Epoch: 12 cost time: 3.078443765640259
Epoch: 12, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.835 Vali Acc: 0.560 Test Loss: 0.835 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.988635301589966
Epoch: 13, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.832 Vali Acc: 0.560 Test Loss: 0.832 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5421805381774902
Epoch: 14, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.532226324081421
Epoch: 15, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.498765468597412
Epoch: 16, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.978 Vali Acc: 0.530 Test Loss: 0.978 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3303892612457275
Epoch: 17, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.993 Vali Acc: 0.530 Test Loss: 0.993 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.500676393508911
Epoch: 18, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.992 Vali Acc: 0.550 Test Loss: 0.992 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0089471340179443
Epoch: 19, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.933 Vali Acc: 0.560 Test Loss: 0.933 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0443570613861084
Epoch: 20, Steps: 20 | Train Loss: 0.350 Vali Loss: 0.900 Vali Acc: 0.590 Test Loss: 0.900 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.139714479446411
Epoch: 21, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 867586
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.250604152679443
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.9819462299346924
Epoch: 2, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.842803478240967
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8719406127929688
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6689887046813965
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8167502880096436
Epoch: 6, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4449985027313232
Epoch: 7, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9115426540374756
Epoch: 8, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.3341305255889893
Epoch: 9, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.216411590576172
Epoch: 10, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.921 Vali Acc: 0.530 Test Loss: 0.921 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5775394439697266
Epoch: 11, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 867586
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.835472822189331
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.928677797317505
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.888261556625366
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7886083126068115
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 2.5890605449676514
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9127185344696045
Epoch: 6, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9340083599090576
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.799 Vali Acc: 0.580 Test Loss: 0.799 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 2.820868730545044
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8159689903259277
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.80092716217041
Epoch: 10, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.879 Vali Acc: 0.560 Test Loss: 0.879 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7692348957061768
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.838 Vali Acc: 0.570 Test Loss: 0.838 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.401698350906372
Epoch: 12, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2054460048675537
Epoch: 13, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.206019878387451
Epoch: 14, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.885 Vali Acc: 0.560 Test Loss: 0.885 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.269775629043579
Epoch: 15, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.763 Vali Acc: 0.610 Test Loss: 0.763 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 3.1196815967559814
Epoch: 16, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9935076236724854
Epoch: 17, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3167848587036133
Epoch: 18, Steps: 20 | Train Loss: 0.306 Vali Loss: 0.947 Vali Acc: 0.580 Test Loss: 0.947 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6365506649017334
Epoch: 19, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.994 Vali Acc: 0.650 Test Loss: 0.994 Test Acc: 0.650
Validation loss decreased (-0.609992 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 2.3880300521850586
Epoch: 20, Steps: 20 | Train Loss: 0.231 Vali Loss: 0.873 Vali Acc: 0.600 Test Loss: 0.873 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.663588047027588
Epoch: 21, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.526216745376587
Epoch: 22, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.263 Vali Acc: 0.610 Test Loss: 1.263 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9413163661956787
Epoch: 23, Steps: 20 | Train Loss: 0.239 Vali Loss: 0.991 Vali Acc: 0.610 Test Loss: 0.991 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8890979290008545
Epoch: 24, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.104 Vali Acc: 0.610 Test Loss: 1.104 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.071298837661743
Epoch: 25, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.169 Vali Acc: 0.610 Test Loss: 1.169 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1171505451202393
Epoch: 26, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.421 Vali Acc: 0.570 Test Loss: 1.421 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.0775434970855713
Epoch: 27, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.432 Vali Acc: 0.540 Test Loss: 1.432 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.1102702617645264
Epoch: 28, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.626 Vali Acc: 0.610 Test Loss: 1.626 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.032395601272583
Epoch: 29, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.493 Vali Acc: 0.620 Test Loss: 1.493 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 867586
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.209662914276123
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.0890140533447266
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.592162847518921
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2783126831054688
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6943793296813965
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.4950146675109863
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.960 Vali Acc: 0.510 Test Loss: 0.960 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9849977493286133
Epoch: 7, Steps: 20 | Train Loss: 0.704 Vali Loss: 1.054 Vali Acc: 0.510 Test Loss: 1.054 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0849251747131348
Epoch: 8, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.961726665496826
Epoch: 9, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7215933799743652
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.700777769088745
Epoch: 11, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 2.8284716606140137
Epoch: 12, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9591848850250244
Epoch: 13, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.840 Vali Acc: 0.570 Test Loss: 0.840 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 3.061981678009033
Epoch: 14, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.667166233062744
Epoch: 15, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.889 Vali Acc: 0.600 Test Loss: 0.889 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 2.201664447784424
Epoch: 16, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.000 Vali Acc: 0.530 Test Loss: 1.000 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6378326416015625
Epoch: 17, Steps: 20 | Train Loss: 0.443 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.391343832015991
Epoch: 18, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.974 Vali Acc: 0.510 Test Loss: 0.974 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5480542182922363
Epoch: 19, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.898749828338623
Epoch: 20, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.819031000137329
Epoch: 21, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.007157325744629
Epoch: 22, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.082 Vali Acc: 0.590 Test Loss: 1.082 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.034470796585083
Epoch: 23, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.009 Vali Acc: 0.560 Test Loss: 1.009 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.300161123275757
Epoch: 24, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.101 Vali Acc: 0.570 Test Loss: 1.101 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.720611095428467
Epoch: 25, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 605442
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.757606267929077
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.2687289714813232
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3741447925567627
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1030516624450684
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.768 Vali Acc: 0.460 Test Loss: 0.768 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4185259342193604
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 3.2544753551483154
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1242892742156982
Epoch: 7, Steps: 20 | Train Loss: 0.689 Vali Loss: 1.022 Vali Acc: 0.510 Test Loss: 1.022 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9942257404327393
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.675644636154175
Epoch: 9, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6746842861175537
Epoch: 10, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6063625812530518
Epoch: 11, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8864805698394775
Epoch: 12, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.061124801635742
Epoch: 13, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.848 Vali Acc: 0.560 Test Loss: 0.848 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 2.7145681381225586
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.087 Vali Acc: 0.530 Test Loss: 1.087 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9064126014709473
Epoch: 15, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 16 cost time: 2.820061445236206
Epoch: 16, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3330557346343994
Epoch: 17, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.989 Vali Acc: 0.530 Test Loss: 0.989 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.527845859527588
Epoch: 18, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.928 Vali Acc: 0.540 Test Loss: 0.928 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5682785511016846
Epoch: 19, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.971 Vali Acc: 0.560 Test Loss: 0.971 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5514237880706787
Epoch: 20, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.134 Vali Acc: 0.560 Test Loss: 1.134 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.717381000518799
Epoch: 21, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.088 Vali Acc: 0.530 Test Loss: 1.088 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.9830424785614014
Epoch: 22, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.117 Vali Acc: 0.560 Test Loss: 1.117 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9222493171691895
Epoch: 23, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.982 Vali Acc: 0.570 Test Loss: 0.982 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.0405800342559814
Epoch: 24, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.049 Vali Acc: 0.580 Test Loss: 1.049 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579990).  Saving model ...
Epoch: 25 cost time: 3.068596124649048
Epoch: 25, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.153 Vali Acc: 0.560 Test Loss: 1.153 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.020901918411255
Epoch: 26, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.208 Vali Acc: 0.560 Test Loss: 1.208 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.996997833251953
Epoch: 27, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.436 Vali Acc: 0.540 Test Loss: 1.436 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5586092472076416
Epoch: 28, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.180 Vali Acc: 0.560 Test Loss: 1.180 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.64323091506958
Epoch: 29, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.491 Vali Acc: 0.500 Test Loss: 1.491 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8210036754608154
Epoch: 30, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599988).  Saving model ...
Epoch: 31 cost time: 2.813866138458252
Epoch: 31, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.313 Vali Acc: 0.580 Test Loss: 1.313 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9508399963378906
Epoch: 32, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.8180291652679443
Epoch: 33, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.323 Vali Acc: 0.550 Test Loss: 1.323 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.5244908332824707
Epoch: 34, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.266 Vali Acc: 0.580 Test Loss: 1.266 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.61092209815979
Epoch: 35, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.635439872741699
Epoch: 36, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.710 Vali Acc: 0.620 Test Loss: 1.710 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619983).  Saving model ...
Epoch: 37 cost time: 2.8378329277038574
Epoch: 37, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.648 Vali Acc: 0.580 Test Loss: 1.648 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.663788080215454
Epoch: 38, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.486 Vali Acc: 0.620 Test Loss: 1.486 Test Acc: 0.620
Validation loss decreased (-0.619983 --> -0.619985).  Saving model ...
Epoch: 39 cost time: 2.7043521404266357
Epoch: 39, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.851 Vali Acc: 0.560 Test Loss: 1.851 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0688223838806152
Epoch: 40, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.768 Vali Acc: 0.580 Test Loss: 1.768 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.101400852203369
Epoch: 41, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.727 Vali Acc: 0.570 Test Loss: 1.727 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.038865089416504
Epoch: 42, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.043 Vali Acc: 0.550 Test Loss: 2.043 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.001079797744751
Epoch: 43, Steps: 20 | Train Loss: 0.087 Vali Loss: 1.769 Vali Acc: 0.580 Test Loss: 1.769 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.0598466396331787
Epoch: 44, Steps: 20 | Train Loss: 0.077 Vali Loss: 1.791 Vali Acc: 0.520 Test Loss: 1.791 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.814530372619629
Epoch: 45, Steps: 20 | Train Loss: 0.074 Vali Loss: 2.275 Vali Acc: 0.560 Test Loss: 2.275 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.5954432487487793
Epoch: 46, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.863 Vali Acc: 0.550 Test Loss: 1.863 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.551136016845703
Epoch: 47, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.896 Vali Acc: 0.560 Test Loss: 1.896 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.605587959289551
Epoch: 48, Steps: 20 | Train Loss: 0.051 Vali Loss: 2.324 Vali Acc: 0.570 Test Loss: 2.324 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 605442
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.2173120975494385
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.637634515762329
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5886502265930176
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.018348455429077
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1813089847564697
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 3.095512866973877
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.897 Vali Acc: 0.540 Test Loss: 0.897 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.561800956726074
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 1.002 Vali Acc: 0.510 Test Loss: 1.002 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.692728281021118
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.575932741165161
Epoch: 9, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.487710475921631
Epoch: 10, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3359665870666504
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.267768144607544
Epoch: 12, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8310670852661133
Epoch: 13, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 2.667361259460449
Epoch: 14, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.036 Vali Acc: 0.530 Test Loss: 1.036 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.689276933670044
Epoch: 15, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.879 Vali Acc: 0.570 Test Loss: 0.879 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8559072017669678
Epoch: 16, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7562899589538574
Epoch: 17, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.932 Vali Acc: 0.570 Test Loss: 0.932 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8170690536499023
Epoch: 18, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.983 Vali Acc: 0.510 Test Loss: 0.983 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7244842052459717
Epoch: 19, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.956 Vali Acc: 0.570 Test Loss: 0.956 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5903921127319336
Epoch: 20, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.175 Vali Acc: 0.570 Test Loss: 1.175 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4010367393493652
Epoch: 21, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.014 Vali Acc: 0.560 Test Loss: 1.014 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.920205593109131
Epoch: 22, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.191 Vali Acc: 0.560 Test Loss: 1.191 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0046966075897217
Epoch: 23, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.914 Vali Acc: 0.610 Test Loss: 0.914 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609991).  Saving model ...
Epoch: 24 cost time: 2.7875401973724365
Epoch: 24, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6400227546691895
Epoch: 25, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.131 Vali Acc: 0.580 Test Loss: 1.131 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7239606380462646
Epoch: 26, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.028 Vali Acc: 0.640 Test Loss: 1.028 Test Acc: 0.640
Validation loss decreased (-0.609991 --> -0.639990).  Saving model ...
Epoch: 27 cost time: 2.5195810794830322
Epoch: 27, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.423 Vali Acc: 0.540 Test Loss: 1.423 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1735737323760986
Epoch: 28, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.137 Vali Acc: 0.590 Test Loss: 1.137 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4548754692077637
Epoch: 29, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.388 Vali Acc: 0.580 Test Loss: 1.388 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.171022653579712
Epoch: 30, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.297 Vali Acc: 0.620 Test Loss: 1.297 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.119948148727417
Epoch: 31, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.425 Vali Acc: 0.610 Test Loss: 1.425 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8966474533081055
Epoch: 32, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.449 Vali Acc: 0.600 Test Loss: 1.449 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.5189921855926514
Epoch: 33, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.460 Vali Acc: 0.580 Test Loss: 1.460 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.7670741081237793
Epoch: 34, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.527 Vali Acc: 0.620 Test Loss: 1.527 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.9923593997955322
Epoch: 35, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.565 Vali Acc: 0.610 Test Loss: 1.565 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.7770650386810303
Epoch: 36, Steps: 20 | Train Loss: 0.086 Vali Loss: 1.586 Vali Acc: 0.610 Test Loss: 1.586 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 605442
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.7846839427948
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.6023387908935547
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.578192949295044
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.754673957824707
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.851252794265747
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.3745574951171875
Epoch: 6, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.723297119140625
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.924 Vali Acc: 0.510 Test Loss: 0.924 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.493760347366333
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.730 Vali Acc: 0.580 Test Loss: 0.730 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 9 cost time: 2.7618086338043213
Epoch: 9, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8410563468933105
Epoch: 10, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.823 Vali Acc: 0.550 Test Loss: 0.823 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7113454341888428
Epoch: 11, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.692 Vali Acc: 0.590 Test Loss: 0.692 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 12 cost time: 2.783073663711548
Epoch: 12, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.733 Vali Acc: 0.570 Test Loss: 0.733 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5736961364746094
Epoch: 13, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.746 Vali Acc: 0.600 Test Loss: 0.746 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 14 cost time: 2.308706521987915
Epoch: 14, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8877201080322266
Epoch: 15, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.899 Vali Acc: 0.580 Test Loss: 0.899 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8145627975463867
Epoch: 16, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.944 Vali Acc: 0.560 Test Loss: 0.944 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.35189151763916
Epoch: 17, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.931 Vali Acc: 0.530 Test Loss: 0.931 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3498029708862305
Epoch: 18, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2341673374176025
Epoch: 19, Steps: 20 | Train Loss: 0.272 Vali Loss: 0.922 Vali Acc: 0.600 Test Loss: 0.922 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7086002826690674
Epoch: 20, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.160 Vali Acc: 0.570 Test Loss: 1.160 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0590081214904785
Epoch: 21, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.110 Vali Acc: 0.580 Test Loss: 1.110 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.8662965297698975
Epoch: 22, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7018229961395264
Epoch: 23, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.023 Vali Acc: 0.610 Test Loss: 1.023 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609990).  Saving model ...
Epoch: 24 cost time: 2.836430788040161
Epoch: 24, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.297 Vali Acc: 0.590 Test Loss: 1.297 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.630967617034912
Epoch: 25, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.271 Vali Acc: 0.580 Test Loss: 1.271 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4068284034729004
Epoch: 26, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.319 Vali Acc: 0.580 Test Loss: 1.319 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6616568565368652
Epoch: 27, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.523 Vali Acc: 0.550 Test Loss: 1.523 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.868424415588379
Epoch: 28, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.296 Vali Acc: 0.610 Test Loss: 1.296 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.865375280380249
Epoch: 29, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.579 Vali Acc: 0.600 Test Loss: 1.579 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.603710651397705
Epoch: 30, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.564 Vali Acc: 0.590 Test Loss: 1.564 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.6452322006225586
Epoch: 31, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.471 Vali Acc: 0.570 Test Loss: 1.471 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.8404202461242676
Epoch: 32, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.810 Vali Acc: 0.550 Test Loss: 1.810 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.484320878982544
Epoch: 33, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.704 Vali Acc: 0.600 Test Loss: 1.704 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 605442
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.178563117980957
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.5993640422821045
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9661495685577393
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6848628520965576
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7695395946502686
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.350970506668091
Epoch: 6, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.591986894607544
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0206260681152344
Epoch: 8, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.9540157318115234
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7983272075653076
Epoch: 10, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.637700319290161
Epoch: 11, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8320956230163574
Epoch: 12, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1774933338165283
Epoch: 13, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.878 Vali Acc: 0.570 Test Loss: 0.878 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 14 cost time: 2.861483335494995
Epoch: 14, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.891 Vali Acc: 0.480 Test Loss: 0.891 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1434764862060547
Epoch: 15, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.914 Vali Acc: 0.580 Test Loss: 0.914 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 16 cost time: 3.509401321411133
Epoch: 16, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.904 Vali Acc: 0.590 Test Loss: 0.904 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589991).  Saving model ...
Epoch: 17 cost time: 2.893566846847534
Epoch: 17, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.243394374847412
Epoch: 18, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1295177936553955
Epoch: 19, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.011 Vali Acc: 0.580 Test Loss: 1.011 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3431410789489746
Epoch: 20, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.126 Vali Acc: 0.530 Test Loss: 1.126 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.342226505279541
Epoch: 21, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.913 Vali Acc: 0.610 Test Loss: 0.913 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609991).  Saving model ...
Epoch: 22 cost time: 3.2298667430877686
Epoch: 22, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.006 Vali Acc: 0.480 Test Loss: 1.006 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5324738025665283
Epoch: 23, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.055 Vali Acc: 0.560 Test Loss: 1.055 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.63472056388855
Epoch: 24, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.661461591720581
Epoch: 25, Steps: 20 | Train Loss: 0.299 Vali Loss: 0.985 Vali Acc: 0.570 Test Loss: 0.985 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.761688232421875
Epoch: 26, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.158 Vali Acc: 0.570 Test Loss: 1.158 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6361825466156006
Epoch: 27, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.6166038513183594
Epoch: 28, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.180 Vali Acc: 0.510 Test Loss: 1.180 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4463446140289307
Epoch: 29, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.470 Vali Acc: 0.550 Test Loss: 1.470 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0467917919158936
Epoch: 30, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.118 Vali Acc: 0.570 Test Loss: 1.118 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.6417226791381836
Epoch: 31, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.312 Vali Acc: 0.510 Test Loss: 1.312 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 474370
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.706665754318237
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.7816689014434814
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9144575595855713
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.992469310760498
Epoch: 4, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9405364990234375
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.75256085395813
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.635592460632324
Epoch: 7, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.521123170852661
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.827895164489746
Epoch: 9, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.605466604232788
Epoch: 10, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.863229513168335
Epoch: 11, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.876 Vali Acc: 0.540 Test Loss: 0.876 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 474370
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.252087354660034
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.9153811931610107
Epoch: 2, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.900313138961792
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7501819133758545
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.657093048095703
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.6541192531585693
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.6163313388824463
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7866811752319336
Epoch: 8, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5760622024536133
Epoch: 9, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4507498741149902
Epoch: 10, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.713 Vali Acc: 0.570 Test Loss: 0.713 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 2.849212408065796
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.474120616912842
Epoch: 12, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.508236885070801
Epoch: 13, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4251534938812256
Epoch: 14, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.941 Vali Acc: 0.520 Test Loss: 0.941 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2871692180633545
Epoch: 15, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.895 Vali Acc: 0.540 Test Loss: 0.895 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7037947177886963
Epoch: 16, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8918795585632324
Epoch: 17, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.884 Vali Acc: 0.590 Test Loss: 0.884 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589991).  Saving model ...
Epoch: 18 cost time: 2.5328216552734375
Epoch: 18, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.888 Vali Acc: 0.550 Test Loss: 0.888 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8161118030548096
Epoch: 19, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.837122917175293
Epoch: 20, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.451282024383545
Epoch: 21, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.886 Vali Acc: 0.610 Test Loss: 0.886 Test Acc: 0.610
Validation loss decreased (-0.589991 --> -0.609991).  Saving model ...
Epoch: 22 cost time: 2.602102518081665
Epoch: 22, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8666107654571533
Epoch: 23, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.005 Vali Acc: 0.550 Test Loss: 1.005 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.80979323387146
Epoch: 24, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3525736331939697
Epoch: 25, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6222000122070312
Epoch: 26, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.294 Vali Acc: 0.570 Test Loss: 1.294 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4707701206207275
Epoch: 27, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.076 Vali Acc: 0.610 Test Loss: 1.076 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.34767746925354
Epoch: 28, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.197 Vali Acc: 0.610 Test Loss: 1.197 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7881948947906494
Epoch: 29, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.5880331993103027
Epoch: 30, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.464 Vali Acc: 0.560 Test Loss: 1.464 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.897122621536255
Epoch: 31, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.554 Vali Acc: 0.490 Test Loss: 1.554 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 474370
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.99826979637146
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.966625213623047
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7292683124542236
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6098103523254395
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6810641288757324
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.8218109607696533
Epoch: 6, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8424999713897705
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.432194948196411
Epoch: 8, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4802019596099854
Epoch: 9, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.415119171142578
Epoch: 10, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.693 Vali Acc: 0.600 Test Loss: 0.693 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 2.888023614883423
Epoch: 11, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.987942934036255
Epoch: 12, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0158474445343018
Epoch: 13, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.513371229171753
Epoch: 14, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.695614814758301
Epoch: 15, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7561304569244385
Epoch: 16, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.870 Vali Acc: 0.590 Test Loss: 0.870 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.788766860961914
Epoch: 17, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.907 Vali Acc: 0.570 Test Loss: 0.907 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4120068550109863
Epoch: 18, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.887 Vali Acc: 0.590 Test Loss: 0.887 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.759765386581421
Epoch: 19, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.010 Vali Acc: 0.580 Test Loss: 1.010 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.9886021614074707
Epoch: 20, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.040 Vali Acc: 0.600 Test Loss: 1.040 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 474370
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.055507659912109
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.887505292892456
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.7438340187072754
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 2.532709836959839
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.756 Vali Acc: 0.460 Test Loss: 0.756 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8865671157836914
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.894989490509033
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.810 Vali Acc: 0.510 Test Loss: 0.810 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7320685386657715
Epoch: 7, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.834 Vali Acc: 0.570 Test Loss: 0.834 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 2.7720015048980713
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8702569007873535
Epoch: 9, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1202199459075928
Epoch: 10, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.889 Vali Acc: 0.450 Test Loss: 0.889 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8827526569366455
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.008 Vali Acc: 0.530 Test Loss: 1.008 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4851603507995605
Epoch: 12, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.428633451461792
Epoch: 13, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5929908752441406
Epoch: 14, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6915369033813477
Epoch: 15, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.886 Vali Acc: 0.550 Test Loss: 0.886 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.67092227935791
Epoch: 16, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.006 Vali Acc: 0.560 Test Loss: 1.006 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.676339626312256
Epoch: 17, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.100 Vali Acc: 0.470 Test Loss: 1.100 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 408834
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.521393060684204
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.7026686668395996
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.584691286087036
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.850 Vali Acc: 0.530 Test Loss: 0.850 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 2.9371232986450195
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.945769786834717
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 2.515092372894287
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6241517066955566
Epoch: 7, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.815 Vali Acc: 0.560 Test Loss: 0.815 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.4395952224731445
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4833860397338867
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7611687183380127
Epoch: 10, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.854 Vali Acc: 0.490 Test Loss: 0.854 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.734410047531128
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.995 Vali Acc: 0.550 Test Loss: 0.995 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6280999183654785
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.910090684890747
Epoch: 13, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.956153392791748
Epoch: 14, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7327024936676025
Epoch: 15, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.907 Vali Acc: 0.520 Test Loss: 0.907 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.247699737548828
Epoch: 16, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.987 Vali Acc: 0.580 Test Loss: 0.987 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579990).  Saving model ...
Epoch: 17 cost time: 3.035656690597534
Epoch: 17, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.993 Vali Acc: 0.530 Test Loss: 0.993 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.029982566833496
Epoch: 18, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9958553314208984
Epoch: 19, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.202 Vali Acc: 0.530 Test Loss: 1.202 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8889501094818115
Epoch: 20, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.048 Vali Acc: 0.610 Test Loss: 1.048 Test Acc: 0.610
Validation loss decreased (-0.579990 --> -0.609990).  Saving model ...
Epoch: 21 cost time: 3.1461498737335205
Epoch: 21, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.107 Vali Acc: 0.530 Test Loss: 1.107 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.337610960006714
Epoch: 22, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.062 Vali Acc: 0.550 Test Loss: 1.062 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2388830184936523
Epoch: 23, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.285848379135132
Epoch: 24, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9864342212677
Epoch: 25, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.088 Vali Acc: 0.520 Test Loss: 1.088 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0483250617980957
Epoch: 26, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.009 Vali Acc: 0.510 Test Loss: 1.009 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3716940879821777
Epoch: 27, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.174 Vali Acc: 0.490 Test Loss: 1.174 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9893884658813477
Epoch: 28, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.521 Vali Acc: 0.560 Test Loss: 1.521 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.438990592956543
Epoch: 29, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8896729946136475
Epoch: 30, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.050 Vali Acc: 0.510 Test Loss: 1.050 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 408834
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.111233234405518
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.7792880535125732
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4597718715667725
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5880208015441895
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.7527451515197754
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.5148377418518066
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 2.7672278881073
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8236420154571533
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.531756639480591
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 2.3779635429382324
Epoch: 10, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.877 Vali Acc: 0.490 Test Loss: 0.877 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5968806743621826
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.896 Vali Acc: 0.540 Test Loss: 0.896 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.709152936935425
Epoch: 12, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1261346340179443
Epoch: 13, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6499977111816406
Epoch: 14, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 2.7241268157958984
Epoch: 15, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.931 Vali Acc: 0.560 Test Loss: 0.931 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.97292423248291
Epoch: 16, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.020 Vali Acc: 0.560 Test Loss: 1.020 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.29862117767334
Epoch: 17, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.007 Vali Acc: 0.570 Test Loss: 1.007 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5228984355926514
Epoch: 18, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.986290216445923
Epoch: 19, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.103 Vali Acc: 0.530 Test Loss: 1.103 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9280195236206055
Epoch: 20, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.010 Vali Acc: 0.630 Test Loss: 1.010 Test Acc: 0.630
Validation loss decreased (-0.569992 --> -0.629990).  Saving model ...
Epoch: 21 cost time: 3.1889655590057373
Epoch: 21, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.181 Vali Acc: 0.580 Test Loss: 1.181 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0122268199920654
Epoch: 22, Steps: 20 | Train Loss: 0.252 Vali Loss: 0.970 Vali Acc: 0.540 Test Loss: 0.970 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2618494033813477
Epoch: 23, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9510934352874756
Epoch: 24, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.062 Vali Acc: 0.590 Test Loss: 1.062 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1508395671844482
Epoch: 25, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.482461452484131
Epoch: 26, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.069 Vali Acc: 0.590 Test Loss: 1.069 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.854687213897705
Epoch: 27, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.182 Vali Acc: 0.550 Test Loss: 1.182 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.762791872024536
Epoch: 28, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.274 Vali Acc: 0.570 Test Loss: 1.274 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7864272594451904
Epoch: 29, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.269 Vali Acc: 0.520 Test Loss: 1.269 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0805318355560303
Epoch: 30, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.073 Vali Acc: 0.640 Test Loss: 1.073 Test Acc: 0.640
Validation loss decreased (-0.629990 --> -0.639989).  Saving model ...
Epoch: 31 cost time: 3.465745449066162
Epoch: 31, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.462 Vali Acc: 0.590 Test Loss: 1.462 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0105526447296143
Epoch: 32, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.447 Vali Acc: 0.510 Test Loss: 1.447 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.976702928543091
Epoch: 33, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.379 Vali Acc: 0.600 Test Loss: 1.379 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.95867919921875
Epoch: 34, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.354 Vali Acc: 0.550 Test Loss: 1.354 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.742945671081543
Epoch: 35, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.558 Vali Acc: 0.530 Test Loss: 1.558 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.9624640941619873
Epoch: 36, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.842 Vali Acc: 0.520 Test Loss: 1.842 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.823427438735962
Epoch: 37, Steps: 20 | Train Loss: 0.147 Vali Loss: 2.206 Vali Acc: 0.550 Test Loss: 2.206 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.374971628189087
Epoch: 38, Steps: 20 | Train Loss: 0.135 Vali Loss: 1.853 Vali Acc: 0.580 Test Loss: 1.853 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.4484105110168457
Epoch: 39, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.919 Vali Acc: 0.500 Test Loss: 1.919 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.912472724914551
Epoch: 40, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.686 Vali Acc: 0.570 Test Loss: 1.686 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 408834
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.789679288864136
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.3422069549560547
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1665966510772705
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5054495334625244
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7882840633392334
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.9100940227508545
Epoch: 6, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 2.560849189758301
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.466114044189453
Epoch: 8, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.692 Vali Acc: 0.570 Test Loss: 0.692 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 9 cost time: 2.1071629524230957
Epoch: 9, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.291813850402832
Epoch: 10, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5654854774475098
Epoch: 11, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1555092334747314
Epoch: 12, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6443912982940674
Epoch: 13, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.569762945175171
Epoch: 14, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5524985790252686
Epoch: 15, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.890 Vali Acc: 0.580 Test Loss: 0.890 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 16 cost time: 2.196192979812622
Epoch: 16, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3851099014282227
Epoch: 17, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.909 Vali Acc: 0.620 Test Loss: 0.909 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619991).  Saving model ...
Epoch: 18 cost time: 2.293977737426758
Epoch: 18, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7863340377807617
Epoch: 19, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.789214849472046
Epoch: 20, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.880 Vali Acc: 0.630 Test Loss: 0.880 Test Acc: 0.630
Validation loss decreased (-0.619991 --> -0.629991).  Saving model ...
Epoch: 21 cost time: 2.2881884574890137
Epoch: 21, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.514683246612549
Epoch: 22, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6337149143218994
Epoch: 23, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5069146156311035
Epoch: 24, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.096 Vali Acc: 0.580 Test Loss: 1.096 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4651567935943604
Epoch: 25, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.209 Vali Acc: 0.570 Test Loss: 1.209 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.377786159515381
Epoch: 26, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.004 Vali Acc: 0.560 Test Loss: 1.004 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0372185707092285
Epoch: 27, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.220 Vali Acc: 0.580 Test Loss: 1.220 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.445312976837158
Epoch: 28, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.381 Vali Acc: 0.580 Test Loss: 1.381 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.426509141921997
Epoch: 29, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.327 Vali Acc: 0.530 Test Loss: 1.327 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2394628524780273
Epoch: 30, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 408834
model size : 6.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.059448957443237
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.748 Vali Acc: 0.420 Test Loss: 0.748 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 2.1202380657196045
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
Validation loss decreased (-0.419993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.355987310409546
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.860 Vali Acc: 0.480 Test Loss: 0.860 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3836379051208496
Epoch: 4, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 2.2228450775146484
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6556015014648438
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.258852005004883
Epoch: 7, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.624248743057251
Epoch: 8, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.872 Vali Acc: 0.560 Test Loss: 0.872 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 2.1254448890686035
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 2.2850911617279053
Epoch: 10, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.885 Vali Acc: 0.580 Test Loss: 0.885 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579991).  Saving model ...
Epoch: 11 cost time: 2.4364190101623535
Epoch: 11, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.936 Vali Acc: 0.530 Test Loss: 0.936 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7685298919677734
Epoch: 12, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.823 Vali Acc: 0.570 Test Loss: 0.823 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4546847343444824
Epoch: 13, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.866 Vali Acc: 0.590 Test Loss: 0.866 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589991).  Saving model ...
Epoch: 14 cost time: 2.483039617538452
Epoch: 14, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.362708330154419
Epoch: 15, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.547963857650757
Epoch: 16, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5815649032592773
Epoch: 17, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.017 Vali Acc: 0.510 Test Loss: 1.017 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8706250190734863
Epoch: 18, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.341477870941162
Epoch: 19, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.812 Vali Acc: 0.550 Test Loss: 0.812 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2559657096862793
Epoch: 20, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.915 Vali Acc: 0.560 Test Loss: 0.915 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5333566665649414
Epoch: 21, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.893 Vali Acc: 0.590 Test Loss: 0.893 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.448003053665161
Epoch: 22, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.685976505279541
Epoch: 23, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1154818
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.942889451980591
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.556339740753174
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
Validation loss decreased (-0.439993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.4425160884857178
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.847 Vali Acc: 0.480 Test Loss: 0.847 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6676886081695557
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.303999185562134
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 2.3336050510406494
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6218466758728027
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 2.697594404220581
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 9 cost time: 2.5216293334960938
Epoch: 9, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.337496042251587
Epoch: 10, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.853 Vali Acc: 0.560 Test Loss: 0.853 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 2.5498478412628174
Epoch: 11, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.912 Vali Acc: 0.530 Test Loss: 0.912 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4946396350860596
Epoch: 12, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.826 Vali Acc: 0.600 Test Loss: 0.826 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599992).  Saving model ...
Epoch: 13 cost time: 2.5006611347198486
Epoch: 13, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.840 Vali Acc: 0.570 Test Loss: 0.840 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6246321201324463
Epoch: 14, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.833 Vali Acc: 0.490 Test Loss: 0.833 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.415452718734741
Epoch: 15, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.805 Vali Acc: 0.530 Test Loss: 0.805 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2329421043395996
Epoch: 16, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3872363567352295
Epoch: 17, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.958 Vali Acc: 0.540 Test Loss: 0.958 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9014265537261963
Epoch: 18, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0837790966033936
Epoch: 19, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5564990043640137
Epoch: 20, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.898 Vali Acc: 0.610 Test Loss: 0.898 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609991).  Saving model ...
Epoch: 21 cost time: 2.2467384338378906
Epoch: 21, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.870 Vali Acc: 0.590 Test Loss: 0.870 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.218280076980591
Epoch: 22, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2081310749053955
Epoch: 23, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.935 Vali Acc: 0.560 Test Loss: 0.935 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.730609655380249
Epoch: 24, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.942 Vali Acc: 0.540 Test Loss: 0.942 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8015246391296387
Epoch: 25, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.017 Vali Acc: 0.590 Test Loss: 1.017 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.669572114944458
Epoch: 26, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.982 Vali Acc: 0.530 Test Loss: 0.982 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6933178901672363
Epoch: 27, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.030 Vali Acc: 0.590 Test Loss: 1.030 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.320085287094116
Epoch: 28, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.642975330352783
Epoch: 29, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.028 Vali Acc: 0.590 Test Loss: 1.028 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6579790115356445
Epoch: 30, Steps: 20 | Train Loss: 0.244 Vali Loss: 1.097 Vali Acc: 0.570 Test Loss: 1.097 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1154818
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.8870298862457275
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.8016366958618164
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9322056770324707
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4781620502471924
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.757 Vali Acc: 0.470 Test Loss: 0.757 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8989853858947754
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5139381885528564
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.515437126159668
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7010459899902344
Epoch: 8, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549991).  Saving model ...
Epoch: 9 cost time: 2.89327335357666
Epoch: 9, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 3.128840446472168
Epoch: 10, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 2.8311831951141357
Epoch: 11, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.894 Vali Acc: 0.560 Test Loss: 0.894 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2024950981140137
Epoch: 12, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.845 Vali Acc: 0.580 Test Loss: 0.845 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 3.1307876110076904
Epoch: 13, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.903778314590454
Epoch: 14, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.862 Vali Acc: 0.510 Test Loss: 0.862 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3756649494171143
Epoch: 15, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.974393606185913
Epoch: 16, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.708219289779663
Epoch: 17, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.976 Vali Acc: 0.560 Test Loss: 0.976 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5874271392822266
Epoch: 18, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.915 Vali Acc: 0.480 Test Loss: 0.915 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.54740047454834
Epoch: 19, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.879 Vali Acc: 0.550 Test Loss: 0.879 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6742610931396484
Epoch: 20, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.920 Vali Acc: 0.580 Test Loss: 0.920 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8879928588867188
Epoch: 21, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.020 Vali Acc: 0.540 Test Loss: 1.020 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6340749263763428
Epoch: 22, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.960 Vali Acc: 0.520 Test Loss: 0.960 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1154818
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.47133207321167
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.8023884296417236
Epoch: 2, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 2.673672676086426
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.786 Vali Acc: 0.460 Test Loss: 0.786 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6451425552368164
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 2.7099387645721436
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 2.7202436923980713
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.813803195953369
Epoch: 7, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.729 Vali Acc: 0.550 Test Loss: 0.729 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 2.9734673500061035
Epoch: 8, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9155983924865723
Epoch: 9, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.723881483078003
Epoch: 10, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5293381214141846
Epoch: 11, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.853 Vali Acc: 0.540 Test Loss: 0.853 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8155713081359863
Epoch: 12, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.866 Vali Acc: 0.600 Test Loss: 0.866 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 2.77876615524292
Epoch: 13, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.830 Vali Acc: 0.480 Test Loss: 0.830 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.703087329864502
Epoch: 14, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4793522357940674
Epoch: 15, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.905 Vali Acc: 0.530 Test Loss: 0.905 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6429970264434814
Epoch: 16, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.970 Vali Acc: 0.540 Test Loss: 0.970 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7613039016723633
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.966 Vali Acc: 0.480 Test Loss: 0.966 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7520270347595215
Epoch: 18, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.928 Vali Acc: 0.580 Test Loss: 0.928 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4839401245117188
Epoch: 19, Steps: 20 | Train Loss: 0.329 Vali Loss: 0.934 Vali Acc: 0.520 Test Loss: 0.934 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7290914058685303
Epoch: 20, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.437983512878418
Epoch: 21, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.046 Vali Acc: 0.510 Test Loss: 1.046 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.543998956680298
Epoch: 22, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.032 Vali Acc: 0.620 Test Loss: 1.032 Test Acc: 0.620
Validation loss decreased (-0.599991 --> -0.619990).  Saving model ...
Epoch: 23 cost time: 2.543926954269409
Epoch: 23, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.216 Vali Acc: 0.510 Test Loss: 1.216 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.400580644607544
Epoch: 24, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.126 Vali Acc: 0.510 Test Loss: 1.126 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5631957054138184
Epoch: 25, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.257 Vali Acc: 0.560 Test Loss: 1.257 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6914143562316895
Epoch: 26, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.603 Vali Acc: 0.460 Test Loss: 1.603 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.518366813659668
Epoch: 27, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.468 Vali Acc: 0.540 Test Loss: 1.468 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4296951293945312
Epoch: 28, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.388 Vali Acc: 0.540 Test Loss: 1.388 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3543295860290527
Epoch: 29, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.463 Vali Acc: 0.500 Test Loss: 1.463 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.5116195678710938
Epoch: 30, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.564 Vali Acc: 0.520 Test Loss: 1.564 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.405719518661499
Epoch: 31, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.630 Vali Acc: 0.510 Test Loss: 1.630 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.5160322189331055
Epoch: 32, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.734 Vali Acc: 0.500 Test Loss: 1.734 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1154818
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.228443384170532
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.2094736099243164
Epoch: 2, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.02213191986084
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5422616004943848
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.794 Vali Acc: 0.440 Test Loss: 0.794 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6751186847686768
Epoch: 5, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6418137550354004
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6768107414245605
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8853697776794434
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7153496742248535
Epoch: 9, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.718003988265991
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1319007873535156
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 630530
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.266134023666382
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.714 Vali Acc: 0.560 Test Loss: 0.714 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.540590286254883
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.385495901107788
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.571287155151367
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.797 Vali Acc: 0.450 Test Loss: 0.797 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.51554012298584
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5444862842559814
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7767698764801025
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5079832077026367
Epoch: 8, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.654974937438965
Epoch: 9, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5066487789154053
Epoch: 10, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.535536766052246
Epoch: 11, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 630530
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.58156681060791
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.705 Vali Acc: 0.580 Test Loss: 0.705 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.2773354053497314
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3448867797851562
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3934144973754883
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.451948404312134
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.600053548812866
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5785911083221436
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8641698360443115
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.761030673980713
Epoch: 9, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5706112384796143
Epoch: 10, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6854403018951416
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 630530
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.191879510879517
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.509683132171631
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3460006713867188
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.131010055541992
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.355879068374634
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.315812110900879
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.242077589035034
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5701286792755127
Epoch: 8, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7063660621643066
Epoch: 9, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.684231758117676
Epoch: 10, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9555957317352295
Epoch: 11, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 630530
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.343164920806885
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.7196953296661377
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.751 Vali Acc: 0.440 Test Loss: 0.751 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.446676731109619
Epoch: 3, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.235517740249634
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1782162189483643
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.893 Vali Acc: 0.480 Test Loss: 0.893 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.350912570953369
Epoch: 6, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.793 Vali Acc: 0.470 Test Loss: 0.793 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.526865243911743
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.448542833328247
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 2.4416050910949707
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.842 Vali Acc: 0.510 Test Loss: 0.842 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 10 cost time: 2.3769679069519043
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5499768257141113
Epoch: 11, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 12 cost time: 2.4592411518096924
Epoch: 12, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.664381504058838
Epoch: 13, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6840641498565674
Epoch: 14, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 2.531062364578247
Epoch: 15, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.844676971435547
Epoch: 16, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.775 Vali Acc: 0.580 Test Loss: 0.775 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 17 cost time: 2.7806825637817383
Epoch: 17, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.00699520111084
Epoch: 18, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8233566284179688
Epoch: 19, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.554337739944458
Epoch: 20, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.877 Vali Acc: 0.550 Test Loss: 0.877 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.545107126235962
Epoch: 21, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.578963279724121
Epoch: 22, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.852 Vali Acc: 0.570 Test Loss: 0.852 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.595813751220703
Epoch: 23, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6438353061676025
Epoch: 24, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.844818353652954
Epoch: 25, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.951 Vali Acc: 0.590 Test Loss: 0.951 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 26 cost time: 2.5637638568878174
Epoch: 26, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.857 Vali Acc: 0.570 Test Loss: 0.857 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.815919876098633
Epoch: 27, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.954 Vali Acc: 0.580 Test Loss: 0.954 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1891696453094482
Epoch: 28, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.008 Vali Acc: 0.580 Test Loss: 1.008 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1665337085723877
Epoch: 29, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.033 Vali Acc: 0.510 Test Loss: 1.033 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.035753011703491
Epoch: 30, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.113126754760742
Epoch: 31, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.901 Vali Acc: 0.590 Test Loss: 0.901 Test Acc: 0.590
Validation loss decreased (-0.589990 --> -0.589991).  Saving model ...
Epoch: 32 cost time: 2.9942028522491455
Epoch: 32, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.075 Vali Acc: 0.540 Test Loss: 1.075 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.6545495986938477
Epoch: 33, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.079 Vali Acc: 0.580 Test Loss: 1.079 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.5301895141601562
Epoch: 34, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.8198020458221436
Epoch: 35, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.6814961433410645
Epoch: 36, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599988).  Saving model ...
Epoch: 37 cost time: 2.755476951599121
Epoch: 37, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.646439790725708
Epoch: 38, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.170 Vali Acc: 0.570 Test Loss: 1.170 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.5904018878936768
Epoch: 39, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.300 Vali Acc: 0.530 Test Loss: 1.300 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.630641460418701
Epoch: 40, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.179 Vali Acc: 0.610 Test Loss: 1.179 Test Acc: 0.610
Validation loss decreased (-0.599988 --> -0.609988).  Saving model ...
Epoch: 41 cost time: 2.99049973487854
Epoch: 41, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.226 Vali Acc: 0.570 Test Loss: 1.226 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.7803235054016113
Epoch: 42, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.470 Vali Acc: 0.500 Test Loss: 1.470 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.9091382026672363
Epoch: 43, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.984323263168335
Epoch: 44, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.475 Vali Acc: 0.560 Test Loss: 1.475 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.0978710651397705
Epoch: 45, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.352 Vali Acc: 0.590 Test Loss: 1.352 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.8886964321136475
Epoch: 46, Steps: 20 | Train Loss: 0.127 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.7347211837768555
Epoch: 47, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.422416925430298
Epoch: 48, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.316 Vali Acc: 0.570 Test Loss: 1.316 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.469148635864258
Epoch: 49, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.664 Vali Acc: 0.600 Test Loss: 1.664 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.5358493328094482
Epoch: 50, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.491 Vali Acc: 0.560 Test Loss: 1.491 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 368386
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.572551965713501
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.6102123260498047
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.748 Vali Acc: 0.430 Test Loss: 0.748 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1784231662750244
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 2.404392719268799
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0524749755859375
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.881 Vali Acc: 0.490 Test Loss: 0.881 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.571187973022461
Epoch: 6, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4855000972747803
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 2.3534657955169678
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 2.2137458324432373
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5145938396453857
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2927815914154053
Epoch: 11, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6862270832061768
Epoch: 12, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3719043731689453
Epoch: 13, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.43629789352417
Epoch: 14, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 2.707895278930664
Epoch: 15, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4629180431365967
Epoch: 16, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 17 cost time: 2.45833683013916
Epoch: 17, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7649245262145996
Epoch: 18, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.52150821685791
Epoch: 19, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.819 Vali Acc: 0.590 Test Loss: 0.819 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 20 cost time: 2.482497215270996
Epoch: 20, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.943 Vali Acc: 0.520 Test Loss: 0.943 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.430245876312256
Epoch: 21, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2661123275756836
Epoch: 22, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.011645793914795
Epoch: 23, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.112 Vali Acc: 0.530 Test Loss: 1.112 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3378398418426514
Epoch: 24, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.868 Vali Acc: 0.610 Test Loss: 0.868 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609991).  Saving model ...
Epoch: 25 cost time: 2.571139097213745
Epoch: 25, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.909 Vali Acc: 0.590 Test Loss: 0.909 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.215337038040161
Epoch: 26, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.840 Vali Acc: 0.550 Test Loss: 0.840 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2471654415130615
Epoch: 27, Steps: 20 | Train Loss: 0.327 Vali Loss: 0.929 Vali Acc: 0.570 Test Loss: 0.929 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.335378885269165
Epoch: 28, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.049 Vali Acc: 0.560 Test Loss: 1.049 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3420605659484863
Epoch: 29, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.344261646270752
Epoch: 30, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.289 Vali Acc: 0.540 Test Loss: 1.289 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.36788272857666
Epoch: 31, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.948 Vali Acc: 0.580 Test Loss: 0.948 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.322518825531006
Epoch: 32, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.117 Vali Acc: 0.590 Test Loss: 1.117 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.6017913818359375
Epoch: 33, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.120 Vali Acc: 0.620 Test Loss: 1.120 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619989).  Saving model ...
Epoch: 34 cost time: 2.2713260650634766
Epoch: 34, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.229 Vali Acc: 0.530 Test Loss: 1.229 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5231313705444336
Epoch: 35, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.062 Vali Acc: 0.550 Test Loss: 1.062 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.4752697944641113
Epoch: 36, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.311 Vali Acc: 0.560 Test Loss: 1.311 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.184586763381958
Epoch: 37, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.368 Vali Acc: 0.540 Test Loss: 1.368 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.4260401725769043
Epoch: 38, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.263 Vali Acc: 0.550 Test Loss: 1.263 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.221097707748413
Epoch: 39, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.467 Vali Acc: 0.520 Test Loss: 1.467 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.3772053718566895
Epoch: 40, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.218 Vali Acc: 0.610 Test Loss: 1.218 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.3657565116882324
Epoch: 41, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.441 Vali Acc: 0.580 Test Loss: 1.441 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.5725409984588623
Epoch: 42, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.454 Vali Acc: 0.560 Test Loss: 1.454 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.379164457321167
Epoch: 43, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.390 Vali Acc: 0.560 Test Loss: 1.390 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 368386
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.736421585083008
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.1847753524780273
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.328765630722046
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.438387632369995
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.491830348968506
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.874 Vali Acc: 0.490 Test Loss: 0.874 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.466553211212158
Epoch: 6, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.486790657043457
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5531258583068848
Epoch: 8, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3538167476654053
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.492020606994629
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529991).  Saving model ...
Epoch: 11 cost time: 2.213916301727295
Epoch: 11, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
Validation loss decreased (-0.529991 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 2.4658963680267334
Epoch: 12, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.804 Vali Acc: 0.500 Test Loss: 0.804 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0912303924560547
Epoch: 13, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2758960723876953
Epoch: 14, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.766 Vali Acc: 0.590 Test Loss: 0.766 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 2.208059072494507
Epoch: 15, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.235426425933838
Epoch: 16, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.765 Vali Acc: 0.630 Test Loss: 0.765 Test Acc: 0.630
Validation loss decreased (-0.589992 --> -0.629992).  Saving model ...
Epoch: 17 cost time: 2.3676469326019287
Epoch: 17, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4276986122131348
Epoch: 18, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.348254442214966
Epoch: 19, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.834 Vali Acc: 0.570 Test Loss: 0.834 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5357391834259033
Epoch: 20, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.888 Vali Acc: 0.570 Test Loss: 0.888 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2185893058776855
Epoch: 21, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.861 Vali Acc: 0.580 Test Loss: 0.861 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.28025484085083
Epoch: 22, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.888 Vali Acc: 0.570 Test Loss: 0.888 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.301408529281616
Epoch: 23, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.084 Vali Acc: 0.550 Test Loss: 1.084 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.352877140045166
Epoch: 24, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.907 Vali Acc: 0.620 Test Loss: 0.907 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5344693660736084
Epoch: 25, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1398983001708984
Epoch: 26, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.895 Vali Acc: 0.590 Test Loss: 0.895 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 368386
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.234468460083008
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.3502092361450195
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.3482301235198975
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5178301334381104
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.757 Vali Acc: 0.470 Test Loss: 0.757 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.339747905731201
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3983020782470703
Epoch: 6, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2028088569641113
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.231595516204834
Epoch: 8, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3342642784118652
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6119465827941895
Epoch: 10, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.220700263977051
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 2.4225900173187256
Epoch: 12, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3745503425598145
Epoch: 13, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4430160522460938
Epoch: 14, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.759 Vali Acc: 0.610 Test Loss: 0.759 Test Acc: 0.610
Validation loss decreased (-0.529993 --> -0.609992).  Saving model ...
Epoch: 15 cost time: 2.239733934402466
Epoch: 15, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.147714376449585
Epoch: 16, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.754 Vali Acc: 0.570 Test Loss: 0.754 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1090407371520996
Epoch: 17, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.778 Vali Acc: 0.600 Test Loss: 0.778 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.161381959915161
Epoch: 18, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.830 Vali Acc: 0.560 Test Loss: 0.830 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.32896089553833
Epoch: 19, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.889 Vali Acc: 0.540 Test Loss: 0.889 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.113617420196533
Epoch: 20, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.901 Vali Acc: 0.570 Test Loss: 0.901 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.343099594116211
Epoch: 21, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2062010765075684
Epoch: 22, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.916 Vali Acc: 0.500 Test Loss: 0.916 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.548755645751953
Epoch: 23, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.096 Vali Acc: 0.490 Test Loss: 1.096 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.373655080795288
Epoch: 24, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.136 Vali Acc: 0.530 Test Loss: 1.136 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 368386
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.178399562835693
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.4192779064178467
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.5155627727508545
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.793 Vali Acc: 0.440 Test Loss: 0.793 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6404287815093994
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.252927780151367
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.833 Vali Acc: 0.490 Test Loss: 0.833 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4188153743743896
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.376028060913086
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.52748966217041
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5590946674346924
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5585150718688965
Epoch: 10, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.902 Vali Acc: 0.510 Test Loss: 0.902 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.360746145248413
Epoch: 11, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.825 Vali Acc: 0.490 Test Loss: 0.825 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.399909019470215
Epoch: 12, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 2.2426743507385254
Epoch: 13, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.551955461502075
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5881166458129883
Epoch: 15, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3999950885772705
Epoch: 16, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.876 Vali Acc: 0.470 Test Loss: 0.876 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1677887439727783
Epoch: 17, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.873 Vali Acc: 0.460 Test Loss: 0.873 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.442676067352295
Epoch: 18, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2931573390960693
Epoch: 19, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.912 Vali Acc: 0.490 Test Loss: 0.912 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.119016647338867
Epoch: 20, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.875 Vali Acc: 0.520 Test Loss: 0.875 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3234591484069824
Epoch: 21, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.770 Vali Acc: 0.570 Test Loss: 0.770 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 22 cost time: 2.222337245941162
Epoch: 22, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.524312973022461
Epoch: 23, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1279077529907227
Epoch: 24, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.845 Vali Acc: 0.550 Test Loss: 0.845 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.267385482788086
Epoch: 25, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.907 Vali Acc: 0.540 Test Loss: 0.907 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2426187992095947
Epoch: 26, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.967 Vali Acc: 0.520 Test Loss: 0.967 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.502224922180176
Epoch: 27, Steps: 20 | Train Loss: 0.375 Vali Loss: 0.970 Vali Acc: 0.580 Test Loss: 0.970 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579990).  Saving model ...
Epoch: 28 cost time: 2.6514785289764404
Epoch: 28, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.888 Vali Acc: 0.560 Test Loss: 0.888 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3274128437042236
Epoch: 29, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599990).  Saving model ...
Epoch: 30 cost time: 2.3467648029327393
Epoch: 30, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.290 Vali Acc: 0.520 Test Loss: 1.290 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.121950149536133
Epoch: 31, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.997 Vali Acc: 0.550 Test Loss: 0.997 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.265662908554077
Epoch: 32, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.61527419090271
Epoch: 33, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.117 Vali Acc: 0.530 Test Loss: 1.117 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.4259579181671143
Epoch: 34, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.100 Vali Acc: 0.570 Test Loss: 1.100 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.5645663738250732
Epoch: 35, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.022 Vali Acc: 0.560 Test Loss: 1.022 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.288120985031128
Epoch: 36, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.103 Vali Acc: 0.590 Test Loss: 1.103 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3764703273773193
Epoch: 37, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.112 Vali Acc: 0.570 Test Loss: 1.112 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4236836433410645
Epoch: 38, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.3241682052612305
Epoch: 39, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.223 Vali Acc: 0.560 Test Loss: 1.223 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 237314
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.834056377410889
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.6019232273101807
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.6288959980010986
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.788 Vali Acc: 0.460 Test Loss: 0.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6663498878479004
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.315775156021118
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4562697410583496
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0829241275787354
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.1974880695343018
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5387096405029297
Epoch: 9, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.389754056930542
Epoch: 10, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.874 Vali Acc: 0.540 Test Loss: 0.874 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.432694911956787
Epoch: 11, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2461650371551514
Epoch: 12, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.241650342941284
Epoch: 13, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.913 Vali Acc: 0.520 Test Loss: 0.913 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.438063859939575
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.213791608810425
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.463949203491211
Epoch: 16, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.223144054412842
Epoch: 17, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 237314
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.793128490447998
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.2186028957366943
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2593510150909424
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4311487674713135
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.411318302154541
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.250730514526367
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.197631359100342
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 2.2346603870391846
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.796 Vali Acc: 0.470 Test Loss: 0.796 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.352360248565674
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 2.5327162742614746
Epoch: 10, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.871 Vali Acc: 0.540 Test Loss: 0.871 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.424931764602661
Epoch: 11, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.491887092590332
Epoch: 12, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.495605230331421
Epoch: 13, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1872189044952393
Epoch: 14, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.556502342224121
Epoch: 15, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5332095623016357
Epoch: 16, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 17 cost time: 2.415735960006714
Epoch: 17, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.855 Vali Acc: 0.480 Test Loss: 0.855 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.609163761138916
Epoch: 18, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.891 Vali Acc: 0.510 Test Loss: 0.891 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3078975677490234
Epoch: 19, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.425445556640625
Epoch: 20, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3611862659454346
Epoch: 21, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2975330352783203
Epoch: 22, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2848076820373535
Epoch: 23, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.833 Vali Acc: 0.570 Test Loss: 0.833 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 24 cost time: 2.330626964569092
Epoch: 24, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.914 Vali Acc: 0.580 Test Loss: 0.914 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 25 cost time: 2.319643259048462
Epoch: 25, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.964 Vali Acc: 0.580 Test Loss: 0.964 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3169305324554443
Epoch: 26, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3426568508148193
Epoch: 27, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5499017238616943
Epoch: 28, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.918 Vali Acc: 0.560 Test Loss: 0.918 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5178334712982178
Epoch: 29, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.997 Vali Acc: 0.580 Test Loss: 0.997 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.338563919067383
Epoch: 30, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.4446933269500732
Epoch: 31, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599990).  Saving model ...
Epoch: 32 cost time: 2.478666305541992
Epoch: 32, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.175 Vali Acc: 0.580 Test Loss: 1.175 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.3091654777526855
Epoch: 33, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.223 Vali Acc: 0.570 Test Loss: 1.223 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.276855230331421
Epoch: 34, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.066 Vali Acc: 0.520 Test Loss: 1.066 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.241164207458496
Epoch: 35, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.131 Vali Acc: 0.510 Test Loss: 1.131 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.3321971893310547
Epoch: 36, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.186 Vali Acc: 0.570 Test Loss: 1.186 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0716023445129395
Epoch: 37, Steps: 20 | Train Loss: 0.184 Vali Loss: 1.204 Vali Acc: 0.580 Test Loss: 1.204 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.729043483734131
Epoch: 38, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.243 Vali Acc: 0.580 Test Loss: 1.243 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.8181042671203613
Epoch: 39, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.220 Vali Acc: 0.560 Test Loss: 1.220 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.4119439125061035
Epoch: 40, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.341 Vali Acc: 0.540 Test Loss: 1.341 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.6247236728668213
Epoch: 41, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 237314
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.811602830886841
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.4447662830352783
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.476776361465454
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.676866292953491
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4293370246887207
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.262838840484619
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3124117851257324
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.151797294616699
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.771 Vali Acc: 0.460 Test Loss: 0.771 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.395876169204712
Epoch: 9, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.459240198135376
Epoch: 10, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.821 Vali Acc: 0.590 Test Loss: 0.821 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 2.5168979167938232
Epoch: 11, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8865294456481934
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.721 Vali Acc: 0.580 Test Loss: 0.721 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.751925468444824
Epoch: 13, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0108532905578613
Epoch: 14, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7389960289001465
Epoch: 15, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5874435901641846
Epoch: 16, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.544680595397949
Epoch: 17, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7442526817321777
Epoch: 18, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6000003814697266
Epoch: 19, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.404895305633545
Epoch: 20, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.842 Vali Acc: 0.590 Test Loss: 0.842 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 237314
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.3290746212005615
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 2.4312684535980225
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.450667381286621
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.772 Vali Acc: 0.440 Test Loss: 0.772 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3818905353546143
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.460139036178589
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3711485862731934
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.799 Vali Acc: 0.470 Test Loss: 0.799 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.401191234588623
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5096216201782227
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5159311294555664
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8749654293060303
Epoch: 10, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6757943630218506
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9532055854797363
Epoch: 12, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0058510303497314
Epoch: 13, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.92561674118042
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 171778
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 5.065065383911133
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.5998756885528564
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.086703062057495
Epoch: 3, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.753 Vali Acc: 0.460 Test Loss: 0.753 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.291755199432373
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.346238613128662
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3060410022735596
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4378433227539062
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 2.35278582572937
Epoch: 8, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4548239707946777
Epoch: 9, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5098800659179688
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.268251657485962
Epoch: 11, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2507119178771973
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.144252300262451
Epoch: 13, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 2.157165050506592
Epoch: 14, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 15 cost time: 2.398592472076416
Epoch: 15, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 2.2522165775299072
Epoch: 16, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.672 Vali Acc: 0.610 Test Loss: 0.672 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609993).  Saving model ...
Epoch: 17 cost time: 2.4087271690368652
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4090278148651123
Epoch: 18, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.336482524871826
Epoch: 19, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.784 Vali Acc: 0.580 Test Loss: 0.784 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.333040475845337
Epoch: 20, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.407878875732422
Epoch: 21, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.843 Vali Acc: 0.550 Test Loss: 0.843 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3716976642608643
Epoch: 22, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.857 Vali Acc: 0.580 Test Loss: 0.857 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4213528633117676
Epoch: 23, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.765 Vali Acc: 0.620 Test Loss: 0.765 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619992).  Saving model ...
Epoch: 24 cost time: 2.2118639945983887
Epoch: 24, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.906 Vali Acc: 0.580 Test Loss: 0.906 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5017943382263184
Epoch: 25, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.180957078933716
Epoch: 26, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.037 Vali Acc: 0.570 Test Loss: 1.037 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4243762493133545
Epoch: 27, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.847 Vali Acc: 0.640 Test Loss: 0.847 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639992).  Saving model ...
Epoch: 28 cost time: 2.3091042041778564
Epoch: 28, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.964 Vali Acc: 0.600 Test Loss: 0.964 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3331265449523926
Epoch: 29, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.904 Vali Acc: 0.570 Test Loss: 0.904 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3491268157958984
Epoch: 30, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.222 Vali Acc: 0.560 Test Loss: 1.222 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.510094404220581
Epoch: 31, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3468024730682373
Epoch: 32, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.950 Vali Acc: 0.580 Test Loss: 0.950 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.659649610519409
Epoch: 33, Steps: 20 | Train Loss: 0.249 Vali Loss: 0.993 Vali Acc: 0.540 Test Loss: 0.993 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.617016077041626
Epoch: 34, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.006 Vali Acc: 0.590 Test Loss: 1.006 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.460418462753296
Epoch: 35, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.134 Vali Acc: 0.540 Test Loss: 1.134 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.610290288925171
Epoch: 36, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.182 Vali Acc: 0.570 Test Loss: 1.182 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.4942543506622314
Epoch: 37, Steps: 20 | Train Loss: 0.275 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 171778
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.962330102920532
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.50553560256958
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.621288776397705
Epoch: 3, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.644444465637207
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.7417848110198975
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5377845764160156
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6902692317962646
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.62231707572937
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8468074798583984
Epoch: 9, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6389005184173584
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7721054553985596
Epoch: 11, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.742283582687378
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.770 Vali Acc: 0.570 Test Loss: 0.770 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 13 cost time: 2.469930410385132
Epoch: 13, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.720 Vali Acc: 0.570 Test Loss: 0.720 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 2.532524347305298
Epoch: 14, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.399993658065796
Epoch: 15, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.782 Vali Acc: 0.580 Test Loss: 0.782 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 2.6404595375061035
Epoch: 16, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.683 Vali Acc: 0.560 Test Loss: 0.683 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3596627712249756
Epoch: 17, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.772 Vali Acc: 0.600 Test Loss: 0.772 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 18 cost time: 2.681145191192627
Epoch: 18, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.831 Vali Acc: 0.530 Test Loss: 0.831 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5000967979431152
Epoch: 19, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.939 Vali Acc: 0.530 Test Loss: 0.939 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6284146308898926
Epoch: 20, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2872562408447266
Epoch: 21, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8526055812835693
Epoch: 22, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.817 Vali Acc: 0.630 Test Loss: 0.817 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629992).  Saving model ...
Epoch: 23 cost time: 2.446074962615967
Epoch: 23, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.800 Vali Acc: 0.650 Test Loss: 0.800 Test Acc: 0.650
Validation loss decreased (-0.629992 --> -0.649992).  Saving model ...
Epoch: 24 cost time: 3.0646095275878906
Epoch: 24, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.680911064147949
Epoch: 25, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.910 Vali Acc: 0.590 Test Loss: 0.910 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.491344928741455
Epoch: 26, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.977 Vali Acc: 0.530 Test Loss: 0.977 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.732170343399048
Epoch: 27, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.871 Vali Acc: 0.630 Test Loss: 0.871 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.655247926712036
Epoch: 28, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.962 Vali Acc: 0.600 Test Loss: 0.962 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7548625469207764
Epoch: 29, Steps: 20 | Train Loss: 0.312 Vali Loss: 0.896 Vali Acc: 0.600 Test Loss: 0.896 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.54716420173645
Epoch: 30, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.826720952987671
Epoch: 31, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.7238879203796387
Epoch: 32, Steps: 20 | Train Loss: 0.261 Vali Loss: 0.899 Vali Acc: 0.640 Test Loss: 0.899 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.7911646366119385
Epoch: 33, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.031 Vali Acc: 0.590 Test Loss: 1.031 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 171778
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.306625604629517
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.698 Vali Acc: 0.520 Test Loss: 0.698 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.4492270946502686
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.721 Vali Acc: 0.450 Test Loss: 0.721 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.340050458908081
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.412935256958008
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2060675621032715
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 2.126342535018921
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.219912528991699
Epoch: 7, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3920698165893555
Epoch: 8, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5689609050750732
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3081212043762207
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.339323043823242
Epoch: 11, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.455775737762451
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5720183849334717
Epoch: 13, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2117080688476562
Epoch: 14, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.425339937210083
Epoch: 15, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 171778
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.360169172286987
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.2158076763153076
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3948562145233154
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 2.3575501441955566
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3741989135742188
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.529536008834839
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4631340503692627
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.798 Vali Acc: 0.480 Test Loss: 0.798 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4713406562805176
Epoch: 8, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5189175605773926
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.688750743865967
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.3868160247802734
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3875086307525635
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 13 cost time: 2.3839762210845947
Epoch: 13, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4589295387268066
Epoch: 14, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.45181941986084
Epoch: 15, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.307568311691284
Epoch: 16, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4837486743927
Epoch: 17, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.32243013381958
Epoch: 18, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.905 Vali Acc: 0.530 Test Loss: 0.905 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.197594404220581
Epoch: 19, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.906 Vali Acc: 0.560 Test Loss: 0.906 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.632103443145752
Epoch: 20, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.867 Vali Acc: 0.520 Test Loss: 0.867 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6100592613220215
Epoch: 21, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.904 Vali Acc: 0.490 Test Loss: 0.904 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.373443365097046
Epoch: 22, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 23 cost time: 2.3379101753234863
Epoch: 23, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2293107509613037
Epoch: 24, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.412026882171631
Epoch: 25, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.942 Vali Acc: 0.520 Test Loss: 0.942 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5685417652130127
Epoch: 26, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.45396089553833
Epoch: 27, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.918 Vali Acc: 0.560 Test Loss: 0.918 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.47786808013916
Epoch: 28, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.580876588821411
Epoch: 29, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.024 Vali Acc: 0.610 Test Loss: 1.024 Test Acc: 0.610
Validation loss decreased (-0.569991 --> -0.609990).  Saving model ...
Epoch: 30 cost time: 2.566375255584717
Epoch: 30, Steps: 20 | Train Loss: 0.334 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3467414379119873
Epoch: 31, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.957 Vali Acc: 0.540 Test Loss: 0.957 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.601078748703003
Epoch: 32, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.026 Vali Acc: 0.540 Test Loss: 1.026 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.251281499862671
Epoch: 33, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.173 Vali Acc: 0.590 Test Loss: 1.173 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.738591194152832
Epoch: 34, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.068 Vali Acc: 0.610 Test Loss: 1.068 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.4373557567596436
Epoch: 35, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.4116320610046387
Epoch: 36, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.161 Vali Acc: 0.530 Test Loss: 1.161 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.494166135787964
Epoch: 37, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.218 Vali Acc: 0.530 Test Loss: 1.218 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.547670364379883
Epoch: 38, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.221 Vali Acc: 0.590 Test Loss: 1.221 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.5233967304229736
Epoch: 39, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.240 Vali Acc: 0.560 Test Loss: 1.240 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 139010
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.759437561035156
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.148515462875366
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.296419143676758
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 2.651609182357788
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.569591760635376
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 2.695272922515869
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 2.668092727661133
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6736772060394287
Epoch: 8, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7153148651123047
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.635565996170044
Epoch: 10, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.5303292274475098
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 1.057 Vali Acc: 0.500 Test Loss: 1.057 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4595909118652344
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.774 Vali Acc: 0.580 Test Loss: 0.774 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 13 cost time: 2.2465033531188965
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6546895503997803
Epoch: 14, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.514117479324341
Epoch: 15, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 2.326378583908081
Epoch: 16, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.896 Vali Acc: 0.520 Test Loss: 0.896 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.479736804962158
Epoch: 17, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.834 Vali Acc: 0.540 Test Loss: 0.834 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4707560539245605
Epoch: 18, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.879 Vali Acc: 0.540 Test Loss: 0.879 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4465034008026123
Epoch: 19, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4666502475738525
Epoch: 20, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6189231872558594
Epoch: 21, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.894 Vali Acc: 0.480 Test Loss: 0.894 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.319765567779541
Epoch: 22, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.882 Vali Acc: 0.590 Test Loss: 0.882 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 23 cost time: 2.2418735027313232
Epoch: 23, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.832 Vali Acc: 0.560 Test Loss: 0.832 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5361227989196777
Epoch: 24, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.940 Vali Acc: 0.560 Test Loss: 0.940 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.456955909729004
Epoch: 25, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.784712791442871
Epoch: 26, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.885 Vali Acc: 0.570 Test Loss: 0.885 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.6226677894592285
Epoch: 27, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.902 Vali Acc: 0.570 Test Loss: 0.902 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.570725202560425
Epoch: 28, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.914 Vali Acc: 0.550 Test Loss: 0.914 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.311765670776367
Epoch: 29, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.026 Vali Acc: 0.590 Test Loss: 1.026 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.411421298980713
Epoch: 30, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.3996095657348633
Epoch: 31, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.962 Vali Acc: 0.570 Test Loss: 0.962 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.3667497634887695
Epoch: 32, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 139010
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.371001482009888
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.4864580631256104
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 2.3935928344726562
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 2.2992162704467773
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.805781126022339
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.540738105773926
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4242465496063232
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.766 Vali Acc: 0.560 Test Loss: 0.766 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 2.437619686126709
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.630211591720581
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.429016351699829
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.523811101913452
Epoch: 11, Steps: 20 | Train Loss: 0.643 Vali Loss: 1.028 Vali Acc: 0.490 Test Loss: 1.028 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5833678245544434
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 13 cost time: 2.3746836185455322
Epoch: 13, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.335207939147949
Epoch: 14, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 2.099087715148926
Epoch: 15, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.760 Vali Acc: 0.580 Test Loss: 0.760 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 16 cost time: 2.3560447692871094
Epoch: 16, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.902 Vali Acc: 0.550 Test Loss: 0.902 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.547243595123291
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7080280780792236
Epoch: 18, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.936 Vali Acc: 0.500 Test Loss: 0.936 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.562225103378296
Epoch: 19, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.878 Vali Acc: 0.580 Test Loss: 0.878 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8594841957092285
Epoch: 20, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.890 Vali Acc: 0.520 Test Loss: 0.890 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.495145082473755
Epoch: 21, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.958 Vali Acc: 0.490 Test Loss: 0.958 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.703684091567993
Epoch: 22, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.907 Vali Acc: 0.580 Test Loss: 0.907 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.736212968826294
Epoch: 23, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.866 Vali Acc: 0.540 Test Loss: 0.866 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.671600580215454
Epoch: 24, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.994 Vali Acc: 0.550 Test Loss: 0.994 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.619868516921997
Epoch: 25, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.963 Vali Acc: 0.510 Test Loss: 0.963 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 139010
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.904250383377075
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.712388515472412
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.757 Vali Acc: 0.470 Test Loss: 0.757 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 2.4618148803710938
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (-0.469992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 2.523437261581421
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 2.2837088108062744
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.082763671875
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 7 cost time: 2.3725497722625732
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 2.2002391815185547
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.29091477394104
Epoch: 9, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4761738777160645
Epoch: 10, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.33148193359375
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 1.022 Vali Acc: 0.480 Test Loss: 1.022 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5133261680603027
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.744 Vali Acc: 0.600 Test Loss: 0.744 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599993).  Saving model ...
Epoch: 13 cost time: 2.5397746562957764
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5691380500793457
Epoch: 14, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.740 Vali Acc: 0.600 Test Loss: 0.740 Test Acc: 0.600
Validation loss decreased (-0.599993 --> -0.599993).  Saving model ...
Epoch: 15 cost time: 2.4149250984191895
Epoch: 15, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.745 Vali Acc: 0.590 Test Loss: 0.745 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3387677669525146
Epoch: 16, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.886 Vali Acc: 0.550 Test Loss: 0.886 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.41878342628479
Epoch: 17, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4611117839813232
Epoch: 18, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.906 Vali Acc: 0.530 Test Loss: 0.906 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.291689395904541
Epoch: 19, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.828 Vali Acc: 0.550 Test Loss: 0.828 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.066274881362915
Epoch: 20, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.143340587615967
Epoch: 21, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.993 Vali Acc: 0.500 Test Loss: 0.993 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.261465311050415
Epoch: 22, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.857 Vali Acc: 0.600 Test Loss: 0.857 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.30306077003479
Epoch: 23, Steps: 20 | Train Loss: 0.398 Vali Loss: 0.843 Vali Acc: 0.620 Test Loss: 0.843 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 24 cost time: 2.396322011947632
Epoch: 24, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.925 Vali Acc: 0.620 Test Loss: 0.925 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3507189750671387
Epoch: 25, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4208037853240967
Epoch: 26, Steps: 20 | Train Loss: 0.370 Vali Loss: 0.981 Vali Acc: 0.540 Test Loss: 0.981 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4104912281036377
Epoch: 27, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.484875440597534
Epoch: 28, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.034 Vali Acc: 0.560 Test Loss: 1.034 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.343442440032959
Epoch: 29, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.073 Vali Acc: 0.590 Test Loss: 1.073 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.384965181350708
Epoch: 30, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.081 Vali Acc: 0.550 Test Loss: 1.081 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.3403830528259277
Epoch: 31, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.184 Vali Acc: 0.570 Test Loss: 1.184 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.1713759899139404
Epoch: 32, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.191051721572876
Epoch: 33, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.312 Vali Acc: 0.570 Test Loss: 1.312 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 139010
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.301106691360474
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.708 Vali Acc: 0.470 Test Loss: 0.708 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.0145745277404785
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.722 Vali Acc: 0.450 Test Loss: 0.722 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8486535549163818
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.757704496383667
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8059604167938232
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 6 cost time: 1.9391987323760986
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5958764553070068
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.059861660003662
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 9 cost time: 1.812117338180542
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.909893274307251
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.9284517765045166
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.151381492614746
Epoch: 12, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 1.872793436050415
Epoch: 13, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9540610313415527
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7309350967407227
Epoch: 15, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1773033142089844
Epoch: 16, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.862 Vali Acc: 0.570 Test Loss: 0.862 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 17 cost time: 2.01375412940979
Epoch: 17, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8874659538269043
Epoch: 18, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.000950336456299
Epoch: 19, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7761363983154297
Epoch: 20, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0591156482696533
Epoch: 21, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9123029708862305
Epoch: 22, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589993).  Saving model ...
Epoch: 23 cost time: 2.2527453899383545
Epoch: 23, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2349658012390137
Epoch: 24, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9450812339782715
Epoch: 25, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8171863555908203
Epoch: 26, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0401968955993652
Epoch: 27, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6121764183044434
Epoch: 28, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7729523181915283
Epoch: 29, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.823 Vali Acc: 0.560 Test Loss: 0.823 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9779586791992188
Epoch: 30, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0260043144226074
Epoch: 31, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9126594066619873
Epoch: 32, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.880 Vali Acc: 0.590 Test Loss: 0.880 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 561154
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.282670497894287
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.7480130195617676
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9138038158416748
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8766710758209229
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7707250118255615
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.0282223224639893
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7331767082214355
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.872159719467163
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9406979084014893
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0729098320007324
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 2.267024040222168
Epoch: 11, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9001390933990479
Epoch: 12, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1722567081451416
Epoch: 13, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.842108964920044
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.786 Vali Acc: 0.580 Test Loss: 0.786 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9209637641906738
Epoch: 15, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.129761219024658
Epoch: 16, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1947200298309326
Epoch: 17, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9516465663909912
Epoch: 18, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9498686790466309
Epoch: 19, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8613312244415283
Epoch: 20, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 561154
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9280614852905273
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.685 Vali Acc: 0.530 Test Loss: 0.685 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.6320905685424805
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.700 Vali Acc: 0.540 Test Loss: 0.700 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.9619576930999756
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.943359136581421
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.51230788230896
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.6081559658050537
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.716 Vali Acc: 0.580 Test Loss: 0.716 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 1.8576951026916504
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8134181499481201
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8546717166900635
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8789267539978027
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.751 Vali Acc: 0.590 Test Loss: 0.751 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 1.8984270095825195
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.886354923248291
Epoch: 12, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9550528526306152
Epoch: 13, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7613942623138428
Epoch: 14, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.821143388748169
Epoch: 15, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6728739738464355
Epoch: 16, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.841221809387207
Epoch: 17, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.935842752456665
Epoch: 18, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8961689472198486
Epoch: 19, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8422703742980957
Epoch: 20, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.808 Vali Acc: 0.580 Test Loss: 0.808 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 561154
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.487020254135132
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.673 Vali Acc: 0.580 Test Loss: 0.673 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.0309789180755615
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9514565467834473
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.693 Vali Acc: 0.530 Test Loss: 0.693 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9005041122436523
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8698177337646484
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.742419958114624
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7344639301300049
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7521638870239258
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.716 Vali Acc: 0.440 Test Loss: 0.716 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.767566204071045
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9619817733764648
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8663580417633057
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 561154
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.4112584590911865
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.252153158187866
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.217853546142578
Epoch: 3, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9761371612548828
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8493783473968506
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.150848627090454
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0940184593200684
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0048327445983887
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.770 Vali Acc: 0.470 Test Loss: 0.770 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0658090114593506
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9156930446624756
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9353446960449219
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 12 cost time: 1.6141417026519775
Epoch: 12, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7918460369110107
Epoch: 13, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8161532878875732
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 15 cost time: 1.9381451606750488
Epoch: 15, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.823 Vali Acc: 0.570 Test Loss: 0.823 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 1.9647507667541504
Epoch: 16, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.782 Vali Acc: 0.610 Test Loss: 0.782 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 17 cost time: 1.9299447536468506
Epoch: 17, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.823 Vali Acc: 0.590 Test Loss: 0.823 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7904670238494873
Epoch: 18, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.778 Vali Acc: 0.630 Test Loss: 0.778 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629992).  Saving model ...
Epoch: 19 cost time: 2.257774829864502
Epoch: 19, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.752 Vali Acc: 0.580 Test Loss: 0.752 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.188640594482422
Epoch: 20, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.888 Vali Acc: 0.560 Test Loss: 0.888 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1318657398223877
Epoch: 21, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.867 Vali Acc: 0.600 Test Loss: 0.867 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2725613117218018
Epoch: 22, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.881 Vali Acc: 0.560 Test Loss: 0.881 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0070111751556396
Epoch: 23, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.810 Vali Acc: 0.570 Test Loss: 0.810 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.111769676208496
Epoch: 24, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4653377532958984
Epoch: 25, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.737 Vali Acc: 0.590 Test Loss: 0.737 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8252148628234863
Epoch: 26, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9399197101593018
Epoch: 27, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8467113971710205
Epoch: 28, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 299010
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.869632720947266
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.480 Test Loss: 0.720 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.002847909927368
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.8818693161010742
Epoch: 3, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9290542602539062
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.895169973373413
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.770 Vali Acc: 0.500 Test Loss: 0.770 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8522684574127197
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.8131275177001953
Epoch: 7, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8524017333984375
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.807931661605835
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.780 Vali Acc: 0.490 Test Loss: 0.780 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0269615650177
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.9411311149597168
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1539766788482666
Epoch: 12, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.800487995147705
Epoch: 13, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.066939353942871
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8958823680877686
Epoch: 15, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9787733554840088
Epoch: 16, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.770 Vali Acc: 0.590 Test Loss: 0.770 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 17 cost time: 1.9471795558929443
Epoch: 17, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.799 Vali Acc: 0.590 Test Loss: 0.799 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9738075733184814
Epoch: 18, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.773 Vali Acc: 0.640 Test Loss: 0.773 Test Acc: 0.640
Validation loss decreased (-0.589992 --> -0.639992).  Saving model ...
Epoch: 19 cost time: 2.0704915523529053
Epoch: 19, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.736 Vali Acc: 0.600 Test Loss: 0.736 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0871739387512207
Epoch: 20, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.877 Vali Acc: 0.590 Test Loss: 0.877 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6919729709625244
Epoch: 21, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.839 Vali Acc: 0.610 Test Loss: 0.839 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6900043487548828
Epoch: 22, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6285579204559326
Epoch: 23, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.841416835784912
Epoch: 24, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.774 Vali Acc: 0.570 Test Loss: 0.774 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7812910079956055
Epoch: 25, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.753 Vali Acc: 0.600 Test Loss: 0.753 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8295395374298096
Epoch: 26, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.870194435119629
Epoch: 27, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9386200904846191
Epoch: 28, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 299010
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.389344930648804
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.0981383323669434
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.29211688041687
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.048823833465576
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3064348697662354
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.765 Vali Acc: 0.460 Test Loss: 0.765 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9562432765960693
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.091599941253662
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8005366325378418
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.777 Vali Acc: 0.460 Test Loss: 0.777 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9140536785125732
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.781 Vali Acc: 0.470 Test Loss: 0.781 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7063982486724854
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6522984504699707
Epoch: 11, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 1.870985984802246
Epoch: 12, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8510634899139404
Epoch: 13, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7520654201507568
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 2.035494804382324
Epoch: 15, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 16 cost time: 1.97308349609375
Epoch: 16, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.759 Vali Acc: 0.600 Test Loss: 0.759 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 17 cost time: 1.8676719665527344
Epoch: 17, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.092957019805908
Epoch: 18, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.785 Vali Acc: 0.640 Test Loss: 0.785 Test Acc: 0.640
Validation loss decreased (-0.599992 --> -0.639992).  Saving model ...
Epoch: 19 cost time: 2.109731435775757
Epoch: 19, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.758 Vali Acc: 0.600 Test Loss: 0.758 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9777002334594727
Epoch: 20, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.836 Vali Acc: 0.590 Test Loss: 0.836 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8642568588256836
Epoch: 21, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.835 Vali Acc: 0.580 Test Loss: 0.835 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9228110313415527
Epoch: 22, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.882 Vali Acc: 0.560 Test Loss: 0.882 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.006385564804077
Epoch: 23, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4749770164489746
Epoch: 24, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.238391637802124
Epoch: 25, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9552428722381592
Epoch: 26, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.796 Vali Acc: 0.590 Test Loss: 0.796 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.870255708694458
Epoch: 27, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.304953098297119
Epoch: 28, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 299010
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9572458267211914
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.7495439052581787
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9141473770141602
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6974756717681885
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8135156631469727
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.737809181213379
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8510668277740479
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.563324213027954
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7199795246124268
Epoch: 9, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6241953372955322
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.728 Vali Acc: 0.560 Test Loss: 0.728 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6624057292938232
Epoch: 11, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 299010
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.178437948226929
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.712 Vali Acc: 0.450 Test Loss: 0.712 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.8236172199249268
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (-0.449993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.0248494148254395
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.8524785041809082
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0287511348724365
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9178555011749268
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8840739727020264
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4121475219726562
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9292237758636475
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.816 Vali Acc: 0.490 Test Loss: 0.816 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9574077129364014
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.762178897857666
Epoch: 11, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.867922067642212
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0403223037719727
Epoch: 13, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 167938
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.011651515960693
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.7782106399536133
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.8777124881744385
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.741509199142456
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7671520709991455
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9031445980072021
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7702901363372803
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8534519672393799
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6425495147705078
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9147720336914062
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.6614434719085693
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 1.6577775478363037
Epoch: 12, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.654273271560669
Epoch: 13, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.644662857055664
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5988492965698242
Epoch: 15, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 1.6064579486846924
Epoch: 16, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.748 Vali Acc: 0.630 Test Loss: 0.748 Test Acc: 0.630
Validation loss decreased (-0.589992 --> -0.629993).  Saving model ...
Epoch: 17 cost time: 1.7664580345153809
Epoch: 17, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.723984718322754
Epoch: 18, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7704863548278809
Epoch: 19, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.877129316329956
Epoch: 20, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.808 Vali Acc: 0.590 Test Loss: 0.808 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.668116569519043
Epoch: 21, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.792856216430664
Epoch: 22, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6600258350372314
Epoch: 23, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.756 Vali Acc: 0.610 Test Loss: 0.756 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8636434078216553
Epoch: 24, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.792 Vali Acc: 0.570 Test Loss: 0.792 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6736655235290527
Epoch: 25, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9586153030395508
Epoch: 26, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.814 Vali Acc: 0.580 Test Loss: 0.814 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 167938
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.839928388595581
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8896052837371826
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7795767784118652
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8669469356536865
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.771615743637085
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 2.413132667541504
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9529139995574951
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8690390586853027
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 2.1559979915618896
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1038453578948975
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8447380065917969
Epoch: 11, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8139419555664062
Epoch: 12, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 13 cost time: 1.8435008525848389
Epoch: 13, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.744 Vali Acc: 0.590 Test Loss: 0.744 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 14 cost time: 1.9035470485687256
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.756 Vali Acc: 0.560 Test Loss: 0.756 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0159192085266113
Epoch: 15, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.770 Vali Acc: 0.610 Test Loss: 0.770 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609992).  Saving model ...
Epoch: 16 cost time: 2.080965518951416
Epoch: 16, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.735 Vali Acc: 0.610 Test Loss: 0.735 Test Acc: 0.610
Validation loss decreased (-0.609992 --> -0.609993).  Saving model ...
Epoch: 17 cost time: 2.0465781688690186
Epoch: 17, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8839936256408691
Epoch: 18, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6695404052734375
Epoch: 19, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8241546154022217
Epoch: 20, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.800 Vali Acc: 0.620 Test Loss: 0.800 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619992).  Saving model ...
Epoch: 21 cost time: 1.8866517543792725
Epoch: 21, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.831 Vali Acc: 0.580 Test Loss: 0.831 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9863824844360352
Epoch: 22, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.852 Vali Acc: 0.590 Test Loss: 0.852 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.840480089187622
Epoch: 23, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.734 Vali Acc: 0.590 Test Loss: 0.734 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8363873958587646
Epoch: 24, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.775 Vali Acc: 0.590 Test Loss: 0.775 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0759470462799072
Epoch: 25, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.854705572128296
Epoch: 26, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.733 Vali Acc: 0.620 Test Loss: 0.733 Test Acc: 0.620
Validation loss decreased (-0.619992 --> -0.619993).  Saving model ...
Epoch: 27 cost time: 2.026240110397339
Epoch: 27, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.768 Vali Acc: 0.620 Test Loss: 0.768 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.947819709777832
Epoch: 28, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.818 Vali Acc: 0.570 Test Loss: 0.818 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9868242740631104
Epoch: 29, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.799 Vali Acc: 0.580 Test Loss: 0.799 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0356950759887695
Epoch: 30, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.847 Vali Acc: 0.610 Test Loss: 0.847 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1603822708129883
Epoch: 31, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.828 Vali Acc: 0.590 Test Loss: 0.828 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.3796796798706055
Epoch: 32, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.864 Vali Acc: 0.580 Test Loss: 0.864 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.158252716064453
Epoch: 33, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.1584675312042236
Epoch: 34, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.902 Vali Acc: 0.570 Test Loss: 0.902 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0993428230285645
Epoch: 35, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.836 Vali Acc: 0.560 Test Loss: 0.836 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.988450288772583
Epoch: 36, Steps: 20 | Train Loss: 0.329 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 167938
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.175333499908447
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.6770083904266357
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.5160808563232422
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.6617991924285889
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.7551696300506592
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5249669551849365
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7728147506713867
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 8 cost time: 1.6978788375854492
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8604905605316162
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 1.7214603424072266
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8944685459136963
Epoch: 11, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.9445791244506836
Epoch: 12, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.719 Vali Acc: 0.600 Test Loss: 0.719 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 13 cost time: 1.836090326309204
Epoch: 13, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.735 Vali Acc: 0.610 Test Loss: 0.735 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609993).  Saving model ...
Epoch: 14 cost time: 1.6213054656982422
Epoch: 14, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.731 Vali Acc: 0.590 Test Loss: 0.731 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0021018981933594
Epoch: 15, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.740 Vali Acc: 0.590 Test Loss: 0.740 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7516169548034668
Epoch: 16, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.733 Vali Acc: 0.620 Test Loss: 0.733 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 17 cost time: 1.696772813796997
Epoch: 17, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9382710456848145
Epoch: 18, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1763906478881836
Epoch: 19, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.946516513824463
Epoch: 20, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.828 Vali Acc: 0.580 Test Loss: 0.828 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.715885877609253
Epoch: 21, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.881 Vali Acc: 0.590 Test Loss: 0.881 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.971123456954956
Epoch: 22, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.928 Vali Acc: 0.570 Test Loss: 0.928 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7651567459106445
Epoch: 23, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.809 Vali Acc: 0.580 Test Loss: 0.809 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.740713119506836
Epoch: 24, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.864854097366333
Epoch: 25, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8877737522125244
Epoch: 26, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.872 Vali Acc: 0.610 Test Loss: 0.872 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 167938
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.175966262817383
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.1452620029449463
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0086445808410645
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 2.079188823699951
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.268254041671753
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.099191427230835
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7690181732177734
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8503034114837646
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8634042739868164
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8114070892333984
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 2.0502023696899414
Epoch: 11, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.09682297706604
Epoch: 12, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9812023639678955
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0931646823883057
Epoch: 14, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0316386222839355
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0020508766174316
Epoch: 16, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.792 Vali Acc: 0.580 Test Loss: 0.792 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 17 cost time: 1.9151396751403809
Epoch: 17, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.002295732498169
Epoch: 18, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9503066539764404
Epoch: 19, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0344460010528564
Epoch: 20, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.819 Vali Acc: 0.570 Test Loss: 0.819 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9933898448944092
Epoch: 21, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2502307891845703
Epoch: 22, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1235978603363037
Epoch: 23, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.852 Vali Acc: 0.550 Test Loss: 0.852 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.039332151412964
Epoch: 24, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.816 Vali Acc: 0.570 Test Loss: 0.816 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7906222343444824
Epoch: 25, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.816 Vali Acc: 0.580 Test Loss: 0.816 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8902695178985596
Epoch: 26, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 102402
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.2055418491363525
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.8178107738494873
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.702 Vali Acc: 0.560 Test Loss: 0.702 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.9323797225952148
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9017248153686523
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9348957538604736
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7149910926818848
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7282416820526123
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7736551761627197
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8416855335235596
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9558496475219727
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7416739463806152
Epoch: 11, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0348410606384277
Epoch: 12, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 102402
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.971867084503174
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5381011962890625
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.6077072620391846
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.718 Vali Acc: 0.560 Test Loss: 0.718 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 1.9834725856781006
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8206727504730225
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.727522373199463
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7240831851959229
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.751061201095581
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.791450023651123
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4898390769958496
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.734 Vali Acc: 0.570 Test Loss: 0.734 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.8417294025421143
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.854889154434204
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.811 Vali Acc: 0.550 Test Loss: 0.811 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7442669868469238
Epoch: 13, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.630314588546753
Epoch: 14, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.806 Vali Acc: 0.550 Test Loss: 0.806 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9598033428192139
Epoch: 15, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6835787296295166
Epoch: 16, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7215611934661865
Epoch: 17, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.727874517440796
Epoch: 18, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.593592882156372
Epoch: 19, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6297883987426758
Epoch: 20, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.804 Vali Acc: 0.560 Test Loss: 0.804 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 102402
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.196934938430786
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.713 Vali Acc: 0.490 Test Loss: 0.713 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.835902452468872
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.7743606567382812
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.723 Vali Acc: 0.520 Test Loss: 0.723 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.534423589706421
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0069284439086914
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7631287574768066
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8928792476654053
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.190335750579834
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.790388822555542
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6885721683502197
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7417058944702148
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.773881196975708
Epoch: 12, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 102402
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.767255544662476
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.726 Vali Acc: 0.430 Test Loss: 0.726 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.7902560234069824
Epoch: 2, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.429993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 2.2139036655426025
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.200711488723755
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 2.410550594329834
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.6929206848144531
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.045950174331665
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.019484519958496
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 2.1135430335998535
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.235692262649536
Epoch: 10, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1928811073303223
Epoch: 11, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.002270460128784
Epoch: 12, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0157554149627686
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.092637062072754
Epoch: 14, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 15 cost time: 2.1826772689819336
Epoch: 15, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.785 Vali Acc: 0.570 Test Loss: 0.785 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 2.1225228309631348
Epoch: 16, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 17 cost time: 1.8893182277679443
Epoch: 17, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.086538076400757
Epoch: 18, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1902074813842773
Epoch: 19, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.493433713912964
Epoch: 20, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2509891986846924
Epoch: 21, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.480931520462036
Epoch: 22, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3960800170898438
Epoch: 23, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.815 Vali Acc: 0.580 Test Loss: 0.815 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 24 cost time: 2.029902935028076
Epoch: 24, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.309720277786255
Epoch: 25, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.796 Vali Acc: 0.560 Test Loss: 0.796 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2499406337738037
Epoch: 26, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1446304321289062
Epoch: 27, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.179121255874634
Epoch: 28, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.322683572769165
Epoch: 29, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.871 Vali Acc: 0.570 Test Loss: 0.871 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.2726094722747803
Epoch: 30, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.835 Vali Acc: 0.560 Test Loss: 0.835 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.426630973815918
Epoch: 31, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0971720218658447
Epoch: 32, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0129451751708984
Epoch: 33, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.913 Vali Acc: 0.490 Test Loss: 0.913 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 69634
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.842172384262085
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.719 Vali Acc: 0.450 Test Loss: 0.719 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.8324153423309326
Epoch: 2, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.9164135456085205
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.052678346633911
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.142700672149658
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9813041687011719
Epoch: 6, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9000327587127686
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8634469509124756
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 2.061540365219116
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 2.1212337017059326
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1841211318969727
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.875171422958374
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.140829086303711
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0957016944885254
Epoch: 14, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 15 cost time: 1.903529405593872
Epoch: 15, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.787 Vali Acc: 0.570 Test Loss: 0.787 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 1.906052827835083
Epoch: 16, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.798 Vali Acc: 0.570 Test Loss: 0.798 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8969964981079102
Epoch: 17, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.805 Vali Acc: 0.580 Test Loss: 0.805 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 18 cost time: 1.8040525913238525
Epoch: 18, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6513526439666748
Epoch: 19, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8590028285980225
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6768178939819336
Epoch: 21, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7158029079437256
Epoch: 22, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.852 Vali Acc: 0.540 Test Loss: 0.852 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.806530475616455
Epoch: 23, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1273977756500244
Epoch: 24, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.795 Vali Acc: 0.540 Test Loss: 0.795 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1971395015716553
Epoch: 25, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.131995439529419
Epoch: 26, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2225725650787354
Epoch: 27, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 69634
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.496800899505615
Epoch: 1, Steps: 20 | Train Loss: 0.744 Vali Loss: 0.727 Vali Acc: 0.450 Test Loss: 0.727 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.0744526386260986
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.9014768600463867
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.265868902206421
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.82560396194458
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7886838912963867
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 1.9594354629516602
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 2.147749423980713
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8792672157287598
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 1.666405439376831
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.782 Vali Acc: 0.430 Test Loss: 0.782 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9988367557525635
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8523297309875488
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.786 Vali Acc: 0.530 Test Loss: 0.786 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.863581895828247
Epoch: 13, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7457692623138428
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 1.7763643264770508
Epoch: 15, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9882593154907227
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.778 Vali Acc: 0.580 Test Loss: 0.778 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 17 cost time: 1.7046277523040771
Epoch: 17, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7653203010559082
Epoch: 18, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.761 Vali Acc: 0.560 Test Loss: 0.761 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9736816883087158
Epoch: 19, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9576787948608398
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.024015426635742
Epoch: 21, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.071460008621216
Epoch: 22, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.821 Vali Acc: 0.540 Test Loss: 0.821 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.749157428741455
Epoch: 23, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.151521921157837
Epoch: 24, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.784 Vali Acc: 0.570 Test Loss: 0.784 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0963850021362305
Epoch: 25, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0770251750946045
Epoch: 26, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.818 Vali Acc: 0.560 Test Loss: 0.818 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 69634
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.24739670753479
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.7873787879943848
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.601205825805664
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5474538803100586
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7016170024871826
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6214590072631836
Epoch: 6, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6878583431243896
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.750 Vali Acc: 0.410 Test Loss: 0.750 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6830742359161377
Epoch: 8, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6042184829711914
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.7395811080932617
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.767 Vali Acc: 0.410 Test Loss: 0.767 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5742700099945068
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8299710750579834
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.749 Vali Acc: 0.550 Test Loss: 0.749 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 13 cost time: 1.7245829105377197
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0464584827423096
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9422740936279297
Epoch: 15, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.117757797241211
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6973495483398438
Epoch: 17, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9304094314575195
Epoch: 18, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.022531270980835
Epoch: 19, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1091387271881104
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0564568042755127
Epoch: 21, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6600103378295898
Epoch: 22, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 23 cost time: 1.5480282306671143
Epoch: 23, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.754 Vali Acc: 0.560 Test Loss: 0.754 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8913352489471436
Epoch: 24, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7349417209625244
Epoch: 25, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6260476112365723
Epoch: 26, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8793833255767822
Epoch: 27, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.787 Vali Acc: 0.570 Test Loss: 0.787 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0629611015319824
Epoch: 28, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8776345252990723
Epoch: 29, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7294378280639648
Epoch: 30, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.852637529373169
Epoch: 31, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.753997802734375
Epoch: 32, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 69634
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.133166313171387
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8950953483581543
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.729 Vali Acc: 0.430 Test Loss: 0.729 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.068216323852539
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1282870769500732
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.773 Vali Acc: 0.450 Test Loss: 0.773 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7815887928009033
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 2.0850863456726074
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9113719463348389
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.02482271194458
Epoch: 8, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 1.7871615886688232
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.9629333019256592
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9966096878051758
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.850555419921875
Epoch: 12, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9251854419708252
Epoch: 13, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 1.7736742496490479
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5809578895568848
Epoch: 15, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.828148365020752
Epoch: 16, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.122621774673462
Epoch: 17, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.825 Vali Acc: 0.580 Test Loss: 0.825 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.075939893722534
Epoch: 18, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.844 Vali Acc: 0.560 Test Loss: 0.844 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9211740493774414
Epoch: 19, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.800736665725708
Epoch: 20, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9245388507843018
Epoch: 21, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.869983196258545
Epoch: 22, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8380625247955322
Epoch: 23, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 53250
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.298755645751953
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.6298365592956543
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.734 Vali Acc: 0.450 Test Loss: 0.734 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7846617698669434
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.8351852893829346
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6543076038360596
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 1.6733529567718506
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.7903666496276855
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6542952060699463
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9480443000793457
Epoch: 9, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1683743000030518
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0600123405456543
Epoch: 11, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 12 cost time: 1.694739818572998
Epoch: 12, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.790572166442871
Epoch: 13, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6683859825134277
Epoch: 14, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.049271821975708
Epoch: 15, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.842 Vali Acc: 0.520 Test Loss: 0.842 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8765146732330322
Epoch: 16, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8120410442352295
Epoch: 17, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6964633464813232
Epoch: 18, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.903947114944458
Epoch: 19, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7561142444610596
Epoch: 20, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9159979820251465
Epoch: 21, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 53250
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.954350471496582
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.732 Vali Acc: 0.430 Test Loss: 0.732 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.9762334823608398
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (-0.429993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.0458693504333496
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.899582862854004
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.773 Vali Acc: 0.470 Test Loss: 0.773 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.878462553024292
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9538404941558838
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8996970653533936
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 1.8794567584991455
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.759 Vali Acc: 0.460 Test Loss: 0.759 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3862566947937012
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 1.587848424911499
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7696616649627686
Epoch: 11, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.655674695968628
Epoch: 12, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6467926502227783
Epoch: 13, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.788571834564209
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 1.9455575942993164
Epoch: 15, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8398826122283936
Epoch: 16, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1403956413269043
Epoch: 17, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.274003505706787
Epoch: 18, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8203532695770264
Epoch: 19, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.966510534286499
Epoch: 20, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0078506469726562
Epoch: 21, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.18210506439209
Epoch: 22, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579993).  Saving model ...
Epoch: 23 cost time: 2.0579183101654053
Epoch: 23, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9924423694610596
Epoch: 24, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.766 Vali Acc: 0.570 Test Loss: 0.766 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.125577688217163
Epoch: 25, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.063779354095459
Epoch: 26, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9904954433441162
Epoch: 27, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8876817226409912
Epoch: 28, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.759 Vali Acc: 0.570 Test Loss: 0.759 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8034920692443848
Epoch: 29, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.723 Vali Acc: 0.580 Test Loss: 0.723 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 30 cost time: 1.9470372200012207
Epoch: 30, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.880 Vali Acc: 0.580 Test Loss: 0.880 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9105370044708252
Epoch: 31, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8660831451416016
Epoch: 32, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8903627395629883
Epoch: 33, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.785 Vali Acc: 0.610 Test Loss: 0.785 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 34 cost time: 1.8131592273712158
Epoch: 34, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8622946739196777
Epoch: 35, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.886 Vali Acc: 0.570 Test Loss: 0.886 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8099286556243896
Epoch: 36, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.1008288860321045
Epoch: 37, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.884 Vali Acc: 0.600 Test Loss: 0.884 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9721050262451172
Epoch: 38, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0091874599456787
Epoch: 39, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.863 Vali Acc: 0.580 Test Loss: 0.863 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8537330627441406
Epoch: 40, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.927 Vali Acc: 0.590 Test Loss: 0.927 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8470628261566162
Epoch: 41, Steps: 20 | Train Loss: 0.329 Vali Loss: 0.874 Vali Acc: 0.570 Test Loss: 0.874 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8775513172149658
Epoch: 42, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.954 Vali Acc: 0.560 Test Loss: 0.954 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9071142673492432
Epoch: 43, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.953 Vali Acc: 0.580 Test Loss: 0.953 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 53250
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.282728910446167
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.758307933807373
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.721 Vali Acc: 0.460 Test Loss: 0.721 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8021485805511475
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5973634719848633
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.760 Vali Acc: 0.450 Test Loss: 0.760 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6867620944976807
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7648718357086182
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6276319026947021
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.750 Vali Acc: 0.460 Test Loss: 0.750 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9490716457366943
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6840543746948242
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 10 cost time: 1.6984477043151855
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.8447890281677246
Epoch: 11, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.8049578666687012
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5941975116729736
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9624316692352295
Epoch: 14, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6172983646392822
Epoch: 15, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 16 cost time: 1.9826760292053223
Epoch: 16, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9877464771270752
Epoch: 17, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7701201438903809
Epoch: 18, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.806 Vali Acc: 0.470 Test Loss: 0.806 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8364789485931396
Epoch: 19, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8762717247009277
Epoch: 20, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.909553050994873
Epoch: 21, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.056457757949829
Epoch: 22, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.764204740524292
Epoch: 23, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.546851634979248
Epoch: 24, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.985875129699707
Epoch: 25, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.752 Vali Acc: 0.570 Test Loss: 0.752 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 26 cost time: 1.8044843673706055
Epoch: 26, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.944488525390625
Epoch: 27, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.202831983566284
Epoch: 28, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9218416213989258
Epoch: 29, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.725 Vali Acc: 0.580 Test Loss: 0.725 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579993).  Saving model ...
Epoch: 30 cost time: 2.1002700328826904
Epoch: 30, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9251341819763184
Epoch: 31, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.854 Vali Acc: 0.590 Test Loss: 0.854 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 32 cost time: 1.9797894954681396
Epoch: 32, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.95450758934021
Epoch: 33, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.831 Vali Acc: 0.590 Test Loss: 0.831 Test Acc: 0.590
Validation loss decreased (-0.589991 --> -0.589992).  Saving model ...
Epoch: 34 cost time: 1.6999528408050537
Epoch: 34, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.976 Vali Acc: 0.560 Test Loss: 0.976 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9982352256774902
Epoch: 35, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.897 Vali Acc: 0.560 Test Loss: 0.897 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1347124576568604
Epoch: 36, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.03165602684021
Epoch: 37, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.949 Vali Acc: 0.550 Test Loss: 0.949 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0011563301086426
Epoch: 38, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7957546710968018
Epoch: 39, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.947 Vali Acc: 0.570 Test Loss: 0.947 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.818488359451294
Epoch: 40, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.039 Vali Acc: 0.560 Test Loss: 1.039 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.337675094604492
Epoch: 41, Steps: 20 | Train Loss: 0.288 Vali Loss: 0.964 Vali Acc: 0.580 Test Loss: 0.964 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.9612388610839844
Epoch: 42, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.338045358657837
Epoch: 43, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 53250
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.688216924667358
Epoch: 1, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.87984299659729
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.731 Vali Acc: 0.530 Test Loss: 0.731 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9737472534179688
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9523913860321045
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.009495973587036
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9563162326812744
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9461228847503662
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 2.178593635559082
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7047109603881836
Epoch: 9, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8492071628570557
Epoch: 10, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.336658477783203
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0713119506835938
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6773688793182373
Epoch: 13, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8420124053955078
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8394627571105957
Epoch: 15, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6873152256011963
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8804008960723877
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 276610
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.174050331115723
Epoch: 1, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.9470241069793701
Epoch: 2, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7331571578979492
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7488436698913574
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.789783000946045
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7908332347869873
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.58968186378479
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 8 cost time: 1.6286649703979492
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.763068675994873
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.701744556427002
Epoch: 10, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8161659240722656
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8875353336334229
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8191404342651367
Epoch: 13, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6716246604919434
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.822751522064209
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.726 Vali Acc: 0.550 Test Loss: 0.726 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.693387508392334
Epoch: 16, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9167678356170654
Epoch: 17, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 276610
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9351465702056885
Epoch: 1, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.9204630851745605
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0307106971740723
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.9788146018981934
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 2.089967966079712
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9954092502593994
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 2.0680670738220215
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2512571811676025
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9865405559539795
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1565253734588623
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9200341701507568
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0168185234069824
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.771512746810913
Epoch: 13, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9323687553405762
Epoch: 14, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.742 Vali Acc: 0.550 Test Loss: 0.742 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 15 cost time: 1.615185022354126
Epoch: 15, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 16 cost time: 2.013216257095337
Epoch: 16, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.188621759414673
Epoch: 17, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.785 Vali Acc: 0.580 Test Loss: 0.785 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 18 cost time: 1.6530718803405762
Epoch: 18, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6067819595336914
Epoch: 19, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8824875354766846
Epoch: 20, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6937892436981201
Epoch: 21, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7198290824890137
Epoch: 22, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5632832050323486
Epoch: 23, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.858703851699829
Epoch: 24, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9943718910217285
Epoch: 25, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0497093200683594
Epoch: 26, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.752 Vali Acc: 0.620 Test Loss: 0.752 Test Acc: 0.620
Validation loss decreased (-0.579992 --> -0.619992).  Saving model ...
Epoch: 27 cost time: 2.1319260597229004
Epoch: 27, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8542530536651611
Epoch: 28, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.792644739151001
Epoch: 29, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.794 Vali Acc: 0.590 Test Loss: 0.794 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.190657615661621
Epoch: 30, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1306352615356445
Epoch: 31, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6549279689788818
Epoch: 32, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.737 Vali Acc: 0.600 Test Loss: 0.737 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0403788089752197
Epoch: 33, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.821 Vali Acc: 0.570 Test Loss: 0.821 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.727233648300171
Epoch: 34, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.840 Vali Acc: 0.560 Test Loss: 0.840 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9881622791290283
Epoch: 35, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.818 Vali Acc: 0.600 Test Loss: 0.818 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9107654094696045
Epoch: 36, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.825 Vali Acc: 0.590 Test Loss: 0.825 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 276610
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1569983959198
Epoch: 1, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.705 Vali Acc: 0.480 Test Loss: 0.705 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.8742613792419434
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.013625144958496
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.8552002906799316
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7084119319915771
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.727 Vali Acc: 0.470 Test Loss: 0.727 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5694270133972168
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.5105602741241455
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8062355518341064
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.393357515335083
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5692791938781738
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6245582103729248
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 1.7537033557891846
Epoch: 12, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.864880084991455
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 14 cost time: 1.582777738571167
Epoch: 14, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7168712615966797
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.760481595993042
Epoch: 16, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8250975608825684
Epoch: 17, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.987731695175171
Epoch: 18, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9750158786773682
Epoch: 19, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.746 Vali Acc: 0.590 Test Loss: 0.746 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 20 cost time: 1.885162115097046
Epoch: 20, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.861093282699585
Epoch: 21, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.765 Vali Acc: 0.580 Test Loss: 0.765 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8981428146362305
Epoch: 22, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.690821886062622
Epoch: 23, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.741 Vali Acc: 0.610 Test Loss: 0.741 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 24 cost time: 1.9363048076629639
Epoch: 24, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.755 Vali Acc: 0.550 Test Loss: 0.755 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6720664501190186
Epoch: 25, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.782 Vali Acc: 0.570 Test Loss: 0.782 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6587634086608887
Epoch: 26, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.801 Vali Acc: 0.600 Test Loss: 0.801 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.564107894897461
Epoch: 27, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.765 Vali Acc: 0.620 Test Loss: 0.765 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619992).  Saving model ...
Epoch: 28 cost time: 1.5331594944000244
Epoch: 28, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.726 Vali Acc: 0.630 Test Loss: 0.726 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629993).  Saving model ...
Epoch: 29 cost time: 1.823430061340332
Epoch: 29, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.805 Vali Acc: 0.590 Test Loss: 0.805 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5236480236053467
Epoch: 30, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5684597492218018
Epoch: 31, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.867 Vali Acc: 0.580 Test Loss: 0.867 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7515859603881836
Epoch: 32, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.929 Vali Acc: 0.580 Test Loss: 0.929 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6200954914093018
Epoch: 33, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.951 Vali Acc: 0.590 Test Loss: 0.951 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.619497537612915
Epoch: 34, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.967 Vali Acc: 0.590 Test Loss: 0.967 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0584158897399902
Epoch: 35, Steps: 20 | Train Loss: 0.374 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9144606590270996
Epoch: 36, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.010751962661743
Epoch: 37, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.884 Vali Acc: 0.590 Test Loss: 0.884 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8789207935333252
Epoch: 38, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.872 Vali Acc: 0.640 Test Loss: 0.872 Test Acc: 0.640
Validation loss decreased (-0.629993 --> -0.639991).  Saving model ...
Epoch: 39 cost time: 1.5672454833984375
Epoch: 39, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.982 Vali Acc: 0.590 Test Loss: 0.982 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8597595691680908
Epoch: 40, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7710473537445068
Epoch: 41, Steps: 20 | Train Loss: 0.286 Vali Loss: 0.935 Vali Acc: 0.580 Test Loss: 0.935 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7584035396575928
Epoch: 42, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.940 Vali Acc: 0.560 Test Loss: 0.940 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4691298007965088
Epoch: 43, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.036 Vali Acc: 0.590 Test Loss: 1.036 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.9325909614562988
Epoch: 44, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0889461040496826
Epoch: 45, Steps: 20 | Train Loss: 0.278 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7128686904907227
Epoch: 46, Steps: 20 | Train Loss: 0.295 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.845423698425293
Epoch: 47, Steps: 20 | Train Loss: 0.258 Vali Loss: 0.945 Vali Acc: 0.630 Test Loss: 0.945 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.5662765502929688
Epoch: 48, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.061 Vali Acc: 0.630 Test Loss: 1.061 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 276610
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.837362766265869
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.7780036926269531
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.714 Vali Acc: 0.460 Test Loss: 0.714 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0541555881500244
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7669310569763184
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7163722515106201
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.6113495826721191
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8753514289855957
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7927398681640625
Epoch: 8, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8858869075775146
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 1.710979700088501
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7446849346160889
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8113739490509033
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6681122779846191
Epoch: 13, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6103038787841797
Epoch: 14, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.625579833984375
Epoch: 15, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 16 cost time: 1.6462574005126953
Epoch: 16, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.758535623550415
Epoch: 17, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.978705883026123
Epoch: 18, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0187997817993164
Epoch: 19, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.696101427078247
Epoch: 20, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.735 Vali Acc: 0.520 Test Loss: 0.735 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5171008110046387
Epoch: 21, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5673480033874512
Epoch: 22, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 23 cost time: 1.6794757843017578
Epoch: 23, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6880035400390625
Epoch: 24, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.584054946899414
Epoch: 25, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.764770269393921
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.687007188796997
Epoch: 27, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5726613998413086
Epoch: 28, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5780808925628662
Epoch: 29, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.735 Vali Acc: 0.510 Test Loss: 0.735 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.689739465713501
Epoch: 30, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6981189250946045
Epoch: 31, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7014923095703125
Epoch: 32, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 145538
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.273787260055542
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.716 Vali Acc: 0.440 Test Loss: 0.716 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.9095344543457031
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 1.8283090591430664
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.740 Vali Acc: 0.440 Test Loss: 0.740 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6706626415252686
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6275231838226318
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7784228324890137
Epoch: 6, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7586619853973389
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.752 Vali Acc: 0.450 Test Loss: 0.752 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8578081130981445
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.756 Vali Acc: 0.470 Test Loss: 0.756 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8579776287078857
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 10 cost time: 1.867518424987793
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.738 Vali Acc: 0.530 Test Loss: 0.738 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 11 cost time: 1.827329397201538
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.747 Vali Acc: 0.550 Test Loss: 0.747 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.6238529682159424
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.068782091140747
Epoch: 13, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0367469787597656
Epoch: 14, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.752 Vali Acc: 0.530 Test Loss: 0.752 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9015071392059326
Epoch: 15, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7184431552886963
Epoch: 16, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.593332052230835
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7570276260375977
Epoch: 18, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5711073875427246
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0905301570892334
Epoch: 20, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0239415168762207
Epoch: 21, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 22 cost time: 1.7746317386627197
Epoch: 22, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.726 Vali Acc: 0.570 Test Loss: 0.726 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569993).  Saving model ...
Epoch: 23 cost time: 1.974130630493164
Epoch: 23, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7070550918579102
Epoch: 24, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5861270427703857
Epoch: 25, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6391873359680176
Epoch: 26, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8625314235687256
Epoch: 27, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9591867923736572
Epoch: 28, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.81343674659729
Epoch: 29, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.709 Vali Acc: 0.550 Test Loss: 0.709 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7646484375
Epoch: 30, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8218715190887451
Epoch: 31, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.728 Vali Acc: 0.560 Test Loss: 0.728 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7662715911865234
Epoch: 32, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 145538
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.145718574523926
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.712 Vali Acc: 0.440 Test Loss: 0.712 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.7728686332702637
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.720 Vali Acc: 0.440 Test Loss: 0.720 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.670950174331665
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.737 Vali Acc: 0.440 Test Loss: 0.737 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8039755821228027
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 1.6667728424072266
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.757 Vali Acc: 0.460 Test Loss: 0.757 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0570032596588135
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.756 Vali Acc: 0.450 Test Loss: 0.756 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.127415180206299
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.752 Vali Acc: 0.430 Test Loss: 0.752 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9234004020690918
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 9 cost time: 1.6708569526672363
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8479986190795898
Epoch: 10, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 11 cost time: 2.036763906478882
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0203990936279297
Epoch: 12, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0514705181121826
Epoch: 13, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9261415004730225
Epoch: 14, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.137223720550537
Epoch: 15, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.00610089302063
Epoch: 16, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 17 cost time: 1.6589677333831787
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 18 cost time: 1.9123256206512451
Epoch: 18, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9682316780090332
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.742 Vali Acc: 0.570 Test Loss: 0.742 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 20 cost time: 1.7949872016906738
Epoch: 20, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.654918909072876
Epoch: 21, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.764 Vali Acc: 0.600 Test Loss: 0.764 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 22 cost time: 1.815333366394043
Epoch: 22, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7986667156219482
Epoch: 23, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5816888809204102
Epoch: 24, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1350576877593994
Epoch: 25, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8359155654907227
Epoch: 26, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6266074180603027
Epoch: 27, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7270398139953613
Epoch: 28, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.808 Vali Acc: 0.560 Test Loss: 0.808 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5825541019439697
Epoch: 29, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5033750534057617
Epoch: 30, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6594061851501465
Epoch: 31, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 145538
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9145047664642334
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.715 Vali Acc: 0.430 Test Loss: 0.715 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.867645502090454
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
Validation loss decreased (-0.429993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.8033998012542725
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 1.638014316558838
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.731 Vali Acc: 0.440 Test Loss: 0.731 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6702075004577637
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.744 Vali Acc: 0.440 Test Loss: 0.744 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.85398268699646
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9469184875488281
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.746 Vali Acc: 0.400 Test Loss: 0.746 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.950881004333496
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8887088298797607
Epoch: 9, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 10 cost time: 1.553584337234497
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 11 cost time: 1.6892220973968506
Epoch: 11, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5831191539764404
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.831725835800171
Epoch: 13, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6668789386749268
Epoch: 14, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8099913597106934
Epoch: 15, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8086705207824707
Epoch: 16, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.709 Vali Acc: 0.530 Test Loss: 0.709 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 17 cost time: 1.6454222202301025
Epoch: 17, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.545069932937622
Epoch: 18, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 19 cost time: 1.5987935066223145
Epoch: 19, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.741 Vali Acc: 0.580 Test Loss: 0.741 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 20 cost time: 1.6070592403411865
Epoch: 20, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6461842060089111
Epoch: 21, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.756 Vali Acc: 0.580 Test Loss: 0.756 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8232660293579102
Epoch: 22, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.710 Vali Acc: 0.570 Test Loss: 0.710 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.932636022567749
Epoch: 23, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.725 Vali Acc: 0.590 Test Loss: 0.725 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 24 cost time: 1.824073314666748
Epoch: 24, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7322134971618652
Epoch: 25, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.753 Vali Acc: 0.590 Test Loss: 0.753 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7191081047058105
Epoch: 26, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5759434700012207
Epoch: 27, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.772 Vali Acc: 0.580 Test Loss: 0.772 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9252593517303467
Epoch: 28, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.847 Vali Acc: 0.550 Test Loss: 0.847 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8037724494934082
Epoch: 29, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.781 Vali Acc: 0.590 Test Loss: 0.781 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6649537086486816
Epoch: 30, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.832 Vali Acc: 0.580 Test Loss: 0.832 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5478572845458984
Epoch: 31, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.868 Vali Acc: 0.610 Test Loss: 0.868 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609991).  Saving model ...
Epoch: 32 cost time: 1.5080649852752686
Epoch: 32, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.662506341934204
Epoch: 33, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.856 Vali Acc: 0.600 Test Loss: 0.856 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5365257263183594
Epoch: 34, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.844 Vali Acc: 0.580 Test Loss: 0.844 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4797537326812744
Epoch: 35, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.821 Vali Acc: 0.620 Test Loss: 0.821 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619992).  Saving model ...
Epoch: 36 cost time: 1.4004647731781006
Epoch: 36, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.918 Vali Acc: 0.600 Test Loss: 0.918 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5945923328399658
Epoch: 37, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.883 Vali Acc: 0.590 Test Loss: 0.883 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5596721172332764
Epoch: 38, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.895 Vali Acc: 0.560 Test Loss: 0.895 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5370745658874512
Epoch: 39, Steps: 20 | Train Loss: 0.391 Vali Loss: 0.830 Vali Acc: 0.630 Test Loss: 0.830 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629992).  Saving model ...
Epoch: 40 cost time: 1.6335058212280273
Epoch: 40, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.899 Vali Acc: 0.550 Test Loss: 0.899 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.533557415008545
Epoch: 41, Steps: 20 | Train Loss: 0.337 Vali Loss: 0.848 Vali Acc: 0.560 Test Loss: 0.848 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6982572078704834
Epoch: 42, Steps: 20 | Train Loss: 0.304 Vali Loss: 0.897 Vali Acc: 0.580 Test Loss: 0.897 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6435680389404297
Epoch: 43, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.002 Vali Acc: 0.570 Test Loss: 1.002 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8849802017211914
Epoch: 44, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.977 Vali Acc: 0.580 Test Loss: 0.977 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9853730201721191
Epoch: 45, Steps: 20 | Train Loss: 0.285 Vali Loss: 0.980 Vali Acc: 0.550 Test Loss: 0.980 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7460353374481201
Epoch: 46, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.8008735179901123
Epoch: 47, Steps: 20 | Train Loss: 0.280 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.7602462768554688
Epoch: 48, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.042 Vali Acc: 0.560 Test Loss: 1.042 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6871144771575928
Epoch: 49, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.082 Vali Acc: 0.580 Test Loss: 1.082 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 145538
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8770711421966553
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.7566149234771729
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.700 Vali Acc: 0.520 Test Loss: 0.700 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.553046703338623
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.711 Vali Acc: 0.510 Test Loss: 0.711 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4442322254180908
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7394733428955078
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4648356437683105
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5325393676757812
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7954866886138916
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7718868255615234
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.627007007598877
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6183295249938965
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 80002
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.9477598667144775
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.710 Vali Acc: 0.490 Test Loss: 0.710 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.731832504272461
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.713 Vali Acc: 0.480 Test Loss: 0.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6964704990386963
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.633211612701416
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.734 Vali Acc: 0.460 Test Loss: 0.734 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7367360591888428
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.76914644241333
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5789449214935303
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6370511054992676
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7334742546081543
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 10 cost time: 1.5647175312042236
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5933759212493896
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.7752001285552979
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 13 cost time: 1.6580486297607422
Epoch: 13, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 14 cost time: 1.7084903717041016
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.607365608215332
Epoch: 15, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.648197889328003
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.737 Vali Acc: 0.550 Test Loss: 0.737 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 17 cost time: 1.5795817375183105
Epoch: 17, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 18 cost time: 1.5782158374786377
Epoch: 18, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.60740327835083
Epoch: 19, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.641780138015747
Epoch: 20, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7437481880187988
Epoch: 21, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.578862190246582
Epoch: 22, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5971770286560059
Epoch: 23, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5984487533569336
Epoch: 24, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6340441703796387
Epoch: 25, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6018421649932861
Epoch: 26, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 27 cost time: 1.61517333984375
Epoch: 27, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7415378093719482
Epoch: 28, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6783723831176758
Epoch: 29, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7679555416107178
Epoch: 30, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6181766986846924
Epoch: 31, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.733 Vali Acc: 0.570 Test Loss: 0.733 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.921795129776001
Epoch: 32, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.845212459564209
Epoch: 33, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.753 Vali Acc: 0.580 Test Loss: 0.753 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7036795616149902
Epoch: 34, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.726 Vali Acc: 0.580 Test Loss: 0.726 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6891932487487793
Epoch: 35, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5715968608856201
Epoch: 36, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 80002
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.1215808391571045
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.4552621841430664
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.719 Vali Acc: 0.460 Test Loss: 0.719 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5930569171905518
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6394762992858887
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 1.5877110958099365
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.743 Vali Acc: 0.430 Test Loss: 0.743 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6003704071044922
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 7 cost time: 1.7381713390350342
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.746 Vali Acc: 0.410 Test Loss: 0.746 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8180463314056396
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.746 Vali Acc: 0.450 Test Loss: 0.746 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5850532054901123
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7213613986968994
Epoch: 10, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.807875394821167
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.686427116394043
Epoch: 12, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 13 cost time: 1.7051351070404053
Epoch: 13, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7448747158050537
Epoch: 14, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.745 Vali Acc: 0.530 Test Loss: 0.745 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 15 cost time: 1.6350383758544922
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6685636043548584
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8952486515045166
Epoch: 17, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0237810611724854
Epoch: 18, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6422178745269775
Epoch: 19, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 20 cost time: 1.4682319164276123
Epoch: 20, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5524849891662598
Epoch: 21, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5527434349060059
Epoch: 22, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 23 cost time: 1.453429937362671
Epoch: 23, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5801100730895996
Epoch: 24, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6240108013153076
Epoch: 25, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6911952495574951
Epoch: 26, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.765 Vali Acc: 0.560 Test Loss: 0.765 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 27 cost time: 1.6583151817321777
Epoch: 27, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.720670461654663
Epoch: 28, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6453146934509277
Epoch: 29, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.618340253829956
Epoch: 30, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9272267818450928
Epoch: 31, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.821528434753418
Epoch: 32, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6310012340545654
Epoch: 33, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7289268970489502
Epoch: 34, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7425758838653564
Epoch: 35, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6693029403686523
Epoch: 36, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 80002
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.173774480819702
Epoch: 1, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.715 Vali Acc: 0.460 Test Loss: 0.715 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.6611874103546143
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.718 Vali Acc: 0.450 Test Loss: 0.718 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.926429033279419
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 1.6987831592559814
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.57975172996521
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.70924711227417
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.117612838745117
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7119357585906982
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.732 Vali Acc: 0.450 Test Loss: 0.732 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9997739791870117
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 10 cost time: 1.7707481384277344
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.725 Vali Acc: 0.540 Test Loss: 0.725 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.7493910789489746
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5233302116394043
Epoch: 12, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.016364812850952
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.676985740661621
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 15 cost time: 1.6554150581359863
Epoch: 15, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7372996807098389
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.701 Vali Acc: 0.600 Test Loss: 0.701 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 17 cost time: 1.5168697834014893
Epoch: 17, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8489575386047363
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.697 Vali Acc: 0.550 Test Loss: 0.697 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8892998695373535
Epoch: 19, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.701 Vali Acc: 0.570 Test Loss: 0.701 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7529709339141846
Epoch: 20, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.768 Vali Acc: 0.580 Test Loss: 0.768 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9245593547821045
Epoch: 21, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8989403247833252
Epoch: 22, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8561310768127441
Epoch: 23, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.703 Vali Acc: 0.600 Test Loss: 0.703 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9221398830413818
Epoch: 24, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.723 Vali Acc: 0.580 Test Loss: 0.723 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9395146369934082
Epoch: 25, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.700 Vali Acc: 0.620 Test Loss: 0.700 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619993).  Saving model ...
Epoch: 26 cost time: 1.8404090404510498
Epoch: 26, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.667 Vali Acc: 0.590 Test Loss: 0.667 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7284071445465088
Epoch: 27, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.706 Vali Acc: 0.580 Test Loss: 0.706 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7426095008850098
Epoch: 28, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.669 Vali Acc: 0.570 Test Loss: 0.669 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7694642543792725
Epoch: 29, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8312492370605469
Epoch: 30, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.710 Vali Acc: 0.570 Test Loss: 0.710 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.679717779159546
Epoch: 31, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.705 Vali Acc: 0.580 Test Loss: 0.705 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8592736721038818
Epoch: 32, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8128864765167236
Epoch: 33, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.721 Vali Acc: 0.600 Test Loss: 0.721 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9721767902374268
Epoch: 34, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.735 Vali Acc: 0.600 Test Loss: 0.735 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6127235889434814
Epoch: 35, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.707 Vali Acc: 0.610 Test Loss: 0.707 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 80002
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8697290420532227
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.6958935260772705
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.774890661239624
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.021270275115967
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.603381633758545
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.723 Vali Acc: 0.560 Test Loss: 0.723 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 1.9293699264526367
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8223886489868164
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0694003105163574
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.729 Vali Acc: 0.530 Test Loss: 0.729 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7325198650360107
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.727 Vali Acc: 0.540 Test Loss: 0.727 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8623461723327637
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8877649307250977
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.965735673904419
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1241140365600586
Epoch: 13, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 14 cost time: 1.6455023288726807
Epoch: 14, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.728 Vali Acc: 0.590 Test Loss: 0.728 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 15 cost time: 1.9851112365722656
Epoch: 15, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.730 Vali Acc: 0.580 Test Loss: 0.730 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7146186828613281
Epoch: 16, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.701 Vali Acc: 0.580 Test Loss: 0.701 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5439956188201904
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7919056415557861
Epoch: 18, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.554497480392456
Epoch: 19, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6429815292358398
Epoch: 20, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8951234817504883
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.710 Vali Acc: 0.580 Test Loss: 0.710 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7468018531799316
Epoch: 22, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6395180225372314
Epoch: 23, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.687 Vali Acc: 0.530 Test Loss: 0.687 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.841841459274292
Epoch: 24, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 47234
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 4.266785621643066
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.711 Vali Acc: 0.530 Test Loss: 0.711 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.6948297023773193
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.770787239074707
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.594261646270752
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6541032791137695
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.702768087387085
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6121740341186523
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.838015079498291
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7926974296569824
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6090004444122314
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6175665855407715
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5705280303955078
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 47234
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.503725290298462
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.5169663429260254
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.718 Vali Acc: 0.510 Test Loss: 0.718 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.7281410694122314
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6406104564666748
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6207575798034668
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 1.4672882556915283
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6082305908203125
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.675790548324585
Epoch: 8, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4733362197875977
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5741677284240723
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5202059745788574
Epoch: 11, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.470494031906128
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5920257568359375
Epoch: 13, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.739271879196167
Epoch: 14, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.472782850265503
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 47234
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4684154987335205
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.707 Vali Acc: 0.530 Test Loss: 0.707 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.5347092151641846
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7079870700836182
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.646989107131958
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6856389045715332
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5844438076019287
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5490939617156982
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4227848052978516
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5096509456634521
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4765992164611816
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6868793964385986
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 47234
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7385125160217285
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.5700411796569824
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.718 Vali Acc: 0.440 Test Loss: 0.718 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.356217622756958
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.727 Vali Acc: 0.420 Test Loss: 0.727 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3612959384918213
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.736 Vali Acc: 0.460 Test Loss: 0.736 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5818758010864258
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4680006504058838
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.741 Vali Acc: 0.470 Test Loss: 0.741 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.532651662826538
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5386972427368164
Epoch: 8, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5513832569122314
Epoch: 9, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3226909637451172
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.635418176651001
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 30850
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6765658855438232
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.4967041015625
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.706 Vali Acc: 0.480 Test Loss: 0.706 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.35270094871521
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.716 Vali Acc: 0.470 Test Loss: 0.716 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.604621171951294
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6336963176727295
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5180420875549316
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5390570163726807
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7103486061096191
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.730 Vali Acc: 0.440 Test Loss: 0.730 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6068620681762695
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.731 Vali Acc: 0.440 Test Loss: 0.731 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5954911708831787
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.592524528503418
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 30850
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.912014961242676
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.530 Test Loss: 0.696 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.695577621459961
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5848243236541748
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.681762933731079
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.843231439590454
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.733 Vali Acc: 0.450 Test Loss: 0.733 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7471411228179932
Epoch: 6, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6762967109680176
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.616875410079956
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.576981782913208
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.734 Vali Acc: 0.460 Test Loss: 0.734 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6080975532531738
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5372037887573242
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 30850
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.507028102874756
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5544323921203613
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.711 Vali Acc: 0.450 Test Loss: 0.711 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5793063640594482
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.718 Vali Acc: 0.460 Test Loss: 0.718 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5239975452423096
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.724 Vali Acc: 0.450 Test Loss: 0.724 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.528773307800293
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.579918622970581
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6989772319793701
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.739 Vali Acc: 0.450 Test Loss: 0.739 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6900620460510254
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.733 Vali Acc: 0.430 Test Loss: 0.733 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4783103466033936
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.741 Vali Acc: 0.440 Test Loss: 0.741 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.488865613937378
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.727 Vali Acc: 0.430 Test Loss: 0.727 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.542668342590332
Epoch: 11, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 30850
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.930173397064209
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.637300729751587
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.716 Vali Acc: 0.460 Test Loss: 0.716 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5633494853973389
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.601660966873169
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.734 Vali Acc: 0.490 Test Loss: 0.734 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5753684043884277
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6549131870269775
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 1.6616296768188477
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5953633785247803
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6385266780853271
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5660738945007324
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.738 Vali Acc: 0.560 Test Loss: 0.738 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5503227710723877
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5272576808929443
Epoch: 12, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5939106941223145
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.747 Vali Acc: 0.580 Test Loss: 0.747 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 14 cost time: 1.7272732257843018
Epoch: 14, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5601518154144287
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4522483348846436
Epoch: 16, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6357388496398926
Epoch: 17, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5858144760131836
Epoch: 18, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.738 Vali Acc: 0.590 Test Loss: 0.738 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 19 cost time: 1.6009914875030518
Epoch: 19, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8111464977264404
Epoch: 20, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5862739086151123
Epoch: 21, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599993).  Saving model ...
Epoch: 22 cost time: 1.7481675148010254
Epoch: 22, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6025514602661133
Epoch: 23, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.766 Vali Acc: 0.590 Test Loss: 0.766 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4890496730804443
Epoch: 24, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6532084941864014
Epoch: 25, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.749 Vali Acc: 0.580 Test Loss: 0.749 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.438941478729248
Epoch: 26, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5964386463165283
Epoch: 27, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6410086154937744
Epoch: 28, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7381606101989746
Epoch: 29, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6460201740264893
Epoch: 30, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.767 Vali Acc: 0.580 Test Loss: 0.767 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6652426719665527
Epoch: 31, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22658
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.395601987838745
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.713 Vali Acc: 0.510 Test Loss: 0.713 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.487518072128296
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.646754264831543
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4757168292999268
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7256741523742676
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5647518634796143
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5008652210235596
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5320134162902832
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.738 Vali Acc: 0.430 Test Loss: 0.738 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6100821495056152
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7930169105529785
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 11 cost time: 1.4617068767547607
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 1.570277214050293
Epoch: 12, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4902949333190918
Epoch: 13, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.69130539894104
Epoch: 14, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4846389293670654
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5869345664978027
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 17 cost time: 1.6073081493377686
Epoch: 17, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5164430141448975
Epoch: 18, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 19 cost time: 1.5253705978393555
Epoch: 19, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4549460411071777
Epoch: 20, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4544003009796143
Epoch: 21, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.744 Vali Acc: 0.600 Test Loss: 0.744 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 22 cost time: 1.4832053184509277
Epoch: 22, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7599282264709473
Epoch: 23, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.757 Vali Acc: 0.600 Test Loss: 0.757 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6127293109893799
Epoch: 24, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5589947700500488
Epoch: 25, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.587310552597046
Epoch: 26, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6253769397735596
Epoch: 27, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5993468761444092
Epoch: 28, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6976287364959717
Epoch: 29, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.726 Vali Acc: 0.560 Test Loss: 0.726 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6228282451629639
Epoch: 30, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7487599849700928
Epoch: 31, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.750 Vali Acc: 0.600 Test Loss: 0.750 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 22658
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.939532995223999
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.4450950622558594
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.727 Vali Acc: 0.410 Test Loss: 0.727 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.612231731414795
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.736 Vali Acc: 0.470 Test Loss: 0.736 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4975595474243164
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.748 Vali Acc: 0.460 Test Loss: 0.748 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.640059232711792
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 1.7256417274475098
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.6662356853485107
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5285365581512451
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.761284351348877
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7816588878631592
Epoch: 10, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 11 cost time: 1.706719160079956
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 12 cost time: 1.7326068878173828
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8922944068908691
Epoch: 13, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 14 cost time: 1.5568184852600098
Epoch: 14, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4641389846801758
Epoch: 15, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4457314014434814
Epoch: 16, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529993).  Saving model ...
Epoch: 17 cost time: 1.4576315879821777
Epoch: 17, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3696463108062744
Epoch: 18, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5554163455963135
Epoch: 19, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.406095027923584
Epoch: 20, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5654220581054688
Epoch: 21, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.772 Vali Acc: 0.560 Test Loss: 0.772 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 22 cost time: 1.5239336490631104
Epoch: 22, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6356801986694336
Epoch: 23, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6456670761108398
Epoch: 24, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.721933126449585
Epoch: 25, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.641252040863037
Epoch: 26, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.485300064086914
Epoch: 27, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.521984338760376
Epoch: 28, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4777717590332031
Epoch: 29, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.482511281967163
Epoch: 30, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7251346111297607
Epoch: 31, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.775 Vali Acc: 0.580 Test Loss: 0.775 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 32 cost time: 1.635270357131958
Epoch: 32, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5421288013458252
Epoch: 33, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.814 Vali Acc: 0.580 Test Loss: 0.814 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7451622486114502
Epoch: 34, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.765 Vali Acc: 0.580 Test Loss: 0.765 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 35 cost time: 1.6741986274719238
Epoch: 35, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.774 Vali Acc: 0.570 Test Loss: 0.774 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5578157901763916
Epoch: 36, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.537229299545288
Epoch: 37, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.794 Vali Acc: 0.570 Test Loss: 0.794 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5147473812103271
Epoch: 38, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4833033084869385
Epoch: 39, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.804 Vali Acc: 0.550 Test Loss: 0.804 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.509371280670166
Epoch: 40, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.787 Vali Acc: 0.570 Test Loss: 0.787 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.618797779083252
Epoch: 41, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.796 Vali Acc: 0.590 Test Loss: 0.796 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 42 cost time: 1.4535152912139893
Epoch: 42, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.806 Vali Acc: 0.580 Test Loss: 0.806 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6379835605621338
Epoch: 43, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.824 Vali Acc: 0.550 Test Loss: 0.824 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5082457065582275
Epoch: 44, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.814 Vali Acc: 0.580 Test Loss: 0.814 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5802812576293945
Epoch: 45, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4870798587799072
Epoch: 46, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5556881427764893
Epoch: 47, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.5755524635314941
Epoch: 48, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.517596960067749
Epoch: 49, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.589118480682373
Epoch: 50, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.858 Vali Acc: 0.570 Test Loss: 0.858 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.5443570613861084
Epoch: 51, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 22658
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.788516044616699
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.707 Vali Acc: 0.440 Test Loss: 0.707 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.566251516342163
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.711 Vali Acc: 0.420 Test Loss: 0.711 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3619515895843506
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.720 Vali Acc: 0.440 Test Loss: 0.720 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6016476154327393
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.729 Vali Acc: 0.420 Test Loss: 0.729 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5095713138580322
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.727 Vali Acc: 0.430 Test Loss: 0.727 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8072569370269775
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449993).  Saving model ...
Epoch: 7 cost time: 1.558814287185669
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.729 Vali Acc: 0.440 Test Loss: 0.729 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6154932975769043
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.726 Vali Acc: 0.440 Test Loss: 0.726 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5896668434143066
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459993).  Saving model ...
Epoch: 10 cost time: 1.8041646480560303
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.726 Vali Acc: 0.470 Test Loss: 0.726 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 11 cost time: 1.555677890777588
Epoch: 11, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.707 Vali Acc: 0.510 Test Loss: 0.707 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 12 cost time: 1.587480068206787
Epoch: 12, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7217345237731934
Epoch: 13, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 14 cost time: 1.64778470993042
Epoch: 14, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7147822380065918
Epoch: 15, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.558588981628418
Epoch: 16, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.711 Vali Acc: 0.480 Test Loss: 0.711 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5243597030639648
Epoch: 17, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 18 cost time: 1.4127819538116455
Epoch: 18, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
Validation loss decreased (-0.549993 --> -0.549993).  Saving model ...
Epoch: 19 cost time: 1.6757988929748535
Epoch: 19, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7360594272613525
Epoch: 20, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.728 Vali Acc: 0.560 Test Loss: 0.728 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 21 cost time: 1.6143043041229248
Epoch: 21, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (-0.559993 --> -0.559993).  Saving model ...
Epoch: 22 cost time: 1.7077906131744385
Epoch: 22, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.697 Vali Acc: 0.580 Test Loss: 0.697 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 23 cost time: 1.5830798149108887
Epoch: 23, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6254878044128418
Epoch: 24, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.708 Vali Acc: 0.610 Test Loss: 0.708 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609993).  Saving model ...
Epoch: 25 cost time: 1.647275447845459
Epoch: 25, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7005658149719238
Epoch: 26, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6750264167785645
Epoch: 27, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.599419355392456
Epoch: 28, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6134469509124756
Epoch: 29, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6394298076629639
Epoch: 30, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6425178050994873
Epoch: 31, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5891618728637695
Epoch: 32, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.739 Vali Acc: 0.560 Test Loss: 0.739 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6293694972991943
Epoch: 33, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7400281429290771
Epoch: 34, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.728 Vali Acc: 0.580 Test Loss: 0.728 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22658
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3774573802948
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.2402801513671875
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4302127361297607
Epoch: 3, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.2458126544952393
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3311426639556885
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1474390029907227
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.968 Vali Acc: 0.480 Test Loss: 0.968 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.576434850692749
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.026 Vali Acc: 0.530 Test Loss: 1.026 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.553659200668335
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4878838062286377
Epoch: 9, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4586853981018066
Epoch: 10, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.991 Vali Acc: 0.540 Test Loss: 0.991 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5931479930877686
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.010 Vali Acc: 0.550 Test Loss: 1.010 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 12 cost time: 1.5250437259674072
Epoch: 12, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.284 Vali Acc: 0.490 Test Loss: 1.284 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.556325912475586
Epoch: 13, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.045 Vali Acc: 0.540 Test Loss: 1.045 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4429311752319336
Epoch: 14, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.940 Vali Acc: 0.470 Test Loss: 0.940 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5024232864379883
Epoch: 15, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5358777046203613
Epoch: 16, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.112 Vali Acc: 0.560 Test Loss: 1.112 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.5755908489227295
Epoch: 17, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.090 Vali Acc: 0.530 Test Loss: 1.090 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4406342506408691
Epoch: 18, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.249 Vali Acc: 0.590 Test Loss: 1.249 Test Acc: 0.590
Validation loss decreased (-0.559989 --> -0.589988).  Saving model ...
Epoch: 19 cost time: 1.466191053390503
Epoch: 19, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.424 Vali Acc: 0.510 Test Loss: 1.424 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4766838550567627
Epoch: 20, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.329 Vali Acc: 0.560 Test Loss: 1.329 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.28867506980896
Epoch: 21, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.159 Vali Acc: 0.570 Test Loss: 1.159 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4816820621490479
Epoch: 22, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.304 Vali Acc: 0.520 Test Loss: 1.304 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.473001480102539
Epoch: 23, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (-0.589988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 1.505894660949707
Epoch: 24, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.331 Vali Acc: 0.590 Test Loss: 1.331 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.286555290222168
Epoch: 25, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4826993942260742
Epoch: 26, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.433 Vali Acc: 0.610 Test Loss: 1.433 Test Acc: 0.610
Validation loss decreased (-0.599988 --> -0.609986).  Saving model ...
Epoch: 27 cost time: 1.4957988262176514
Epoch: 27, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.445 Vali Acc: 0.510 Test Loss: 1.445 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4620418548583984
Epoch: 28, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.488 Vali Acc: 0.550 Test Loss: 1.488 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.696570873260498
Epoch: 29, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.634 Vali Acc: 0.570 Test Loss: 1.634 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6616108417510986
Epoch: 30, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.655 Vali Acc: 0.590 Test Loss: 1.655 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4969778060913086
Epoch: 31, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.759 Vali Acc: 0.530 Test Loss: 1.759 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5037009716033936
Epoch: 32, Steps: 20 | Train Loss: 0.100 Vali Loss: 2.004 Vali Acc: 0.520 Test Loss: 2.004 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3962163925170898
Epoch: 33, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.913 Vali Acc: 0.550 Test Loss: 1.913 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5671534538269043
Epoch: 34, Steps: 20 | Train Loss: 0.080 Vali Loss: 2.446 Vali Acc: 0.490 Test Loss: 2.446 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4577505588531494
Epoch: 35, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.280 Vali Acc: 0.580 Test Loss: 2.280 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5002005100250244
Epoch: 36, Steps: 20 | Train Loss: 0.178 Vali Loss: 2.678 Vali Acc: 0.520 Test Loss: 2.678 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2750594
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5379207134246826
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.3827557563781738
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.4279823303222656
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.458442211151123
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4682166576385498
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3363795280456543
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.961 Vali Acc: 0.490 Test Loss: 0.961 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4694266319274902
Epoch: 7, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.006 Vali Acc: 0.520 Test Loss: 1.006 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2406671047210693
Epoch: 8, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.055 Vali Acc: 0.510 Test Loss: 1.055 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3362219333648682
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.861 Vali Acc: 0.540 Test Loss: 0.861 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 10 cost time: 1.5181057453155518
Epoch: 10, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.991 Vali Acc: 0.540 Test Loss: 0.991 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.511375904083252
Epoch: 11, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.970 Vali Acc: 0.560 Test Loss: 0.970 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 1.3488657474517822
Epoch: 12, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.274 Vali Acc: 0.480 Test Loss: 1.274 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4295740127563477
Epoch: 13, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.090 Vali Acc: 0.550 Test Loss: 1.090 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6014814376831055
Epoch: 14, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.51822829246521
Epoch: 15, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.085 Vali Acc: 0.470 Test Loss: 1.085 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.396040916442871
Epoch: 16, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.149 Vali Acc: 0.530 Test Loss: 1.149 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4336905479431152
Epoch: 17, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.008 Vali Acc: 0.530 Test Loss: 1.008 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4469411373138428
Epoch: 18, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.062 Vali Acc: 0.570 Test Loss: 1.062 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569989).  Saving model ...
Epoch: 19 cost time: 1.519545316696167
Epoch: 19, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.280 Vali Acc: 0.550 Test Loss: 1.280 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5118119716644287
Epoch: 20, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5319128036499023
Epoch: 21, Steps: 20 | Train Loss: 0.288 Vali Loss: 1.153 Vali Acc: 0.540 Test Loss: 1.153 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3035221099853516
Epoch: 22, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.283 Vali Acc: 0.580 Test Loss: 1.283 Test Acc: 0.580
Validation loss decreased (-0.569989 --> -0.579987).  Saving model ...
Epoch: 23 cost time: 1.6234326362609863
Epoch: 23, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.339 Vali Acc: 0.550 Test Loss: 1.339 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.468083381652832
Epoch: 24, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.506 Vali Acc: 0.510 Test Loss: 1.506 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3229453563690186
Epoch: 25, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.703 Vali Acc: 0.540 Test Loss: 1.703 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.509490966796875
Epoch: 26, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.394 Vali Acc: 0.590 Test Loss: 1.394 Test Acc: 0.590
Validation loss decreased (-0.579987 --> -0.589986).  Saving model ...
Epoch: 27 cost time: 1.4468438625335693
Epoch: 27, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.382 Vali Acc: 0.540 Test Loss: 1.382 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3936920166015625
Epoch: 28, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.776 Vali Acc: 0.560 Test Loss: 1.776 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.524543046951294
Epoch: 29, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.866 Vali Acc: 0.560 Test Loss: 1.866 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5214893817901611
Epoch: 30, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.824 Vali Acc: 0.540 Test Loss: 1.824 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4739172458648682
Epoch: 31, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.988 Vali Acc: 0.560 Test Loss: 1.988 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.326314926147461
Epoch: 32, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.945 Vali Acc: 0.530 Test Loss: 1.945 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4269235134124756
Epoch: 33, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.885 Vali Acc: 0.610 Test Loss: 1.885 Test Acc: 0.610
Validation loss decreased (-0.589986 --> -0.609981).  Saving model ...
Epoch: 34 cost time: 1.611983299255371
Epoch: 34, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.660 Vali Acc: 0.550 Test Loss: 2.660 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4386749267578125
Epoch: 35, Steps: 20 | Train Loss: 0.087 Vali Loss: 2.163 Vali Acc: 0.590 Test Loss: 2.163 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.399125337600708
Epoch: 36, Steps: 20 | Train Loss: 0.082 Vali Loss: 2.128 Vali Acc: 0.570 Test Loss: 2.128 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.375824213027954
Epoch: 37, Steps: 20 | Train Loss: 0.186 Vali Loss: 2.160 Vali Acc: 0.550 Test Loss: 2.160 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.493995189666748
Epoch: 38, Steps: 20 | Train Loss: 0.066 Vali Loss: 2.404 Vali Acc: 0.540 Test Loss: 2.404 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3988232612609863
Epoch: 39, Steps: 20 | Train Loss: 0.094 Vali Loss: 2.648 Vali Acc: 0.520 Test Loss: 2.648 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4943692684173584
Epoch: 40, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.322 Vali Acc: 0.570 Test Loss: 2.322 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5474352836608887
Epoch: 41, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.499 Vali Acc: 0.520 Test Loss: 2.499 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.465080976486206
Epoch: 42, Steps: 20 | Train Loss: 0.037 Vali Loss: 2.314 Vali Acc: 0.620 Test Loss: 2.314 Test Acc: 0.620
Validation loss decreased (-0.609981 --> -0.619977).  Saving model ...
Epoch: 43 cost time: 1.5846118927001953
Epoch: 43, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.490 Vali Acc: 0.560 Test Loss: 2.490 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4867451190948486
Epoch: 44, Steps: 20 | Train Loss: 0.061 Vali Loss: 3.169 Vali Acc: 0.540 Test Loss: 3.169 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3858768939971924
Epoch: 45, Steps: 20 | Train Loss: 0.067 Vali Loss: 2.776 Vali Acc: 0.540 Test Loss: 2.776 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4074060916900635
Epoch: 46, Steps: 20 | Train Loss: 0.039 Vali Loss: 2.716 Vali Acc: 0.530 Test Loss: 2.716 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5273480415344238
Epoch: 47, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.771 Vali Acc: 0.590 Test Loss: 2.771 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3913300037384033
Epoch: 48, Steps: 20 | Train Loss: 0.025 Vali Loss: 2.954 Vali Acc: 0.580 Test Loss: 2.954 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3465580940246582
Epoch: 49, Steps: 20 | Train Loss: 0.134 Vali Loss: 3.440 Vali Acc: 0.540 Test Loss: 3.440 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.5675313472747803
Epoch: 50, Steps: 20 | Train Loss: 0.143 Vali Loss: 3.345 Vali Acc: 0.510 Test Loss: 3.345 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.4837315082550049
Epoch: 51, Steps: 20 | Train Loss: 0.120 Vali Loss: 2.939 Vali Acc: 0.620 Test Loss: 2.939 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.4478554725646973
Epoch: 52, Steps: 20 | Train Loss: 0.073 Vali Loss: 3.742 Vali Acc: 0.520 Test Loss: 3.742 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2750594
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6249501705169678
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.2985272407531738
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.3855605125427246
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.399562120437622
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.347135305404663
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.2871673107147217
Epoch: 6, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.356462001800537
Epoch: 7, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.347498893737793
Epoch: 8, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.977 Vali Acc: 0.520 Test Loss: 0.977 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3520588874816895
Epoch: 9, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2779433727264404
Epoch: 10, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.999 Vali Acc: 0.490 Test Loss: 0.999 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4463744163513184
Epoch: 11, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.975 Vali Acc: 0.560 Test Loss: 0.975 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 1.3358385562896729
Epoch: 12, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.519859790802002
Epoch: 13, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.803 Vali Acc: 0.610 Test Loss: 0.803 Test Acc: 0.610
Validation loss decreased (-0.559990 --> -0.609992).  Saving model ...
Epoch: 14 cost time: 1.2081074714660645
Epoch: 14, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.016 Vali Acc: 0.520 Test Loss: 1.016 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3694121837615967
Epoch: 15, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.086 Vali Acc: 0.520 Test Loss: 1.086 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.383676290512085
Epoch: 16, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.126 Vali Acc: 0.540 Test Loss: 1.126 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4223947525024414
Epoch: 17, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.028 Vali Acc: 0.510 Test Loss: 1.028 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.449713945388794
Epoch: 18, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.050 Vali Acc: 0.590 Test Loss: 1.050 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5000057220458984
Epoch: 19, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.405 Vali Acc: 0.490 Test Loss: 1.405 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4284493923187256
Epoch: 20, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2807729244232178
Epoch: 21, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.224 Vali Acc: 0.610 Test Loss: 1.224 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4222259521484375
Epoch: 22, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.480 Vali Acc: 0.570 Test Loss: 1.480 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5297484397888184
Epoch: 23, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.354 Vali Acc: 0.540 Test Loss: 1.354 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2750594
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5898098945617676
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.5378139019012451
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5059330463409424
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.3778738975524902
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 1.530240535736084
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4350075721740723
Epoch: 6, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5805339813232422
Epoch: 7, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5681676864624023
Epoch: 8, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.934 Vali Acc: 0.520 Test Loss: 0.934 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5363047122955322
Epoch: 9, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.902 Vali Acc: 0.540 Test Loss: 0.902 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4748332500457764
Epoch: 10, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6257238388061523
Epoch: 11, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.001 Vali Acc: 0.560 Test Loss: 1.001 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 1.426990032196045
Epoch: 12, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5044634342193604
Epoch: 13, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.835 Vali Acc: 0.530 Test Loss: 0.835 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6756620407104492
Epoch: 14, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.021 Vali Acc: 0.530 Test Loss: 1.021 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4132463932037354
Epoch: 15, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.209 Vali Acc: 0.530 Test Loss: 1.209 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4833812713623047
Epoch: 16, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.970 Vali Acc: 0.590 Test Loss: 0.970 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589990).  Saving model ...
Epoch: 17 cost time: 1.2936785221099854
Epoch: 17, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.054 Vali Acc: 0.520 Test Loss: 1.054 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.412194013595581
Epoch: 18, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.096 Vali Acc: 0.610 Test Loss: 1.096 Test Acc: 0.610
Validation loss decreased (-0.589990 --> -0.609989).  Saving model ...
Epoch: 19 cost time: 1.1529641151428223
Epoch: 19, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.219 Vali Acc: 0.540 Test Loss: 1.219 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2356834411621094
Epoch: 20, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.248 Vali Acc: 0.570 Test Loss: 1.248 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.19712233543396
Epoch: 21, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.079 Vali Acc: 0.620 Test Loss: 1.079 Test Acc: 0.620
Validation loss decreased (-0.609989 --> -0.619989).  Saving model ...
Epoch: 22 cost time: 1.3364992141723633
Epoch: 22, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.693 Vali Acc: 0.510 Test Loss: 1.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5151147842407227
Epoch: 23, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.198 Vali Acc: 0.590 Test Loss: 1.198 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3869545459747314
Epoch: 24, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.253 Vali Acc: 0.580 Test Loss: 1.253 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5624229907989502
Epoch: 25, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.525 Vali Acc: 0.530 Test Loss: 1.525 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4952740669250488
Epoch: 26, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.519 Vali Acc: 0.580 Test Loss: 1.519 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6016786098480225
Epoch: 27, Steps: 20 | Train Loss: 0.132 Vali Loss: 1.525 Vali Acc: 0.540 Test Loss: 1.525 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.623793601989746
Epoch: 28, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.967 Vali Acc: 0.560 Test Loss: 1.967 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5223839282989502
Epoch: 29, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.786 Vali Acc: 0.600 Test Loss: 1.786 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4786863327026367
Epoch: 30, Steps: 20 | Train Loss: 0.160 Vali Loss: 2.113 Vali Acc: 0.570 Test Loss: 2.113 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.468712568283081
Epoch: 31, Steps: 20 | Train Loss: 0.147 Vali Loss: 2.123 Vali Acc: 0.560 Test Loss: 2.123 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2750594
model size : 20.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.522554874420166
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.511366844177246
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.6085495948791504
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.552278995513916
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.878 Vali Acc: 0.490 Test Loss: 0.878 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.624236822128296
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.391378402709961
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 1.022 Vali Acc: 0.470 Test Loss: 1.022 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.566042423248291
Epoch: 7, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4581727981567383
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4551241397857666
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3723175525665283
Epoch: 10, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.984 Vali Acc: 0.480 Test Loss: 0.984 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3002574443817139
Epoch: 11, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4165353775024414
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1702018
model size : 16.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3423655033111572
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.266108751296997
Epoch: 2, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.463468074798584
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.52717924118042
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.832 Vali Acc: 0.440 Test Loss: 0.832 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5355145931243896
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4599826335906982
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 1.050 Vali Acc: 0.480 Test Loss: 1.050 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6298551559448242
Epoch: 7, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.891 Vali Acc: 0.520 Test Loss: 0.891 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3981990814208984
Epoch: 8, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.835 Vali Acc: 0.440 Test Loss: 0.835 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.406923532485962
Epoch: 9, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.557708501815796
Epoch: 10, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.960 Vali Acc: 0.470 Test Loss: 0.960 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.274087905883789
Epoch: 11, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1702018
model size : 16.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.784841537475586
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.4179959297180176
Epoch: 2, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.550851821899414
Epoch: 3, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5343847274780273
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.822 Vali Acc: 0.450 Test Loss: 0.822 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4795708656311035
Epoch: 5, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.5907137393951416
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.016 Vali Acc: 0.500 Test Loss: 1.016 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5072252750396729
Epoch: 7, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.53273606300354
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.824 Vali Acc: 0.470 Test Loss: 0.824 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2544224262237549
Epoch: 9, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.34572434425354
Epoch: 10, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.966 Vali Acc: 0.460 Test Loss: 0.966 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2764577865600586
Epoch: 11, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.895 Vali Acc: 0.540 Test Loss: 0.895 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2963013648986816
Epoch: 12, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.940 Vali Acc: 0.510 Test Loss: 0.940 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.387449026107788
Epoch: 13, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.987 Vali Acc: 0.500 Test Loss: 0.987 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3417730331420898
Epoch: 14, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.988 Vali Acc: 0.550 Test Loss: 0.988 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2763597965240479
Epoch: 15, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.258 Vali Acc: 0.510 Test Loss: 1.258 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1702018
model size : 16.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2463083267211914
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.4296514987945557
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4043660163879395
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.362666130065918
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3438026905059814
Epoch: 5, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.518343210220337
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.867 Vali Acc: 0.450 Test Loss: 0.867 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5257184505462646
Epoch: 7, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.393263816833496
Epoch: 8, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4032211303710938
Epoch: 9, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.432511329650879
Epoch: 10, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.970 Vali Acc: 0.480 Test Loss: 0.970 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4918797016143799
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.872 Vali Acc: 0.510 Test Loss: 0.872 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4901199340820312
Epoch: 12, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.920 Vali Acc: 0.540 Test Loss: 0.920 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.343421459197998
Epoch: 13, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.907 Vali Acc: 0.460 Test Loss: 0.907 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5230653285980225
Epoch: 14, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.989 Vali Acc: 0.590 Test Loss: 0.989 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589990).  Saving model ...
Epoch: 15 cost time: 1.6523258686065674
Epoch: 15, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.079 Vali Acc: 0.520 Test Loss: 1.079 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4097061157226562
Epoch: 16, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.152 Vali Acc: 0.540 Test Loss: 1.152 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4115962982177734
Epoch: 17, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.098 Vali Acc: 0.560 Test Loss: 1.098 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.373795747756958
Epoch: 18, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.187 Vali Acc: 0.530 Test Loss: 1.187 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2804086208343506
Epoch: 19, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.353 Vali Acc: 0.580 Test Loss: 1.353 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4377529621124268
Epoch: 20, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2588989734649658
Epoch: 21, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.365 Vali Acc: 0.520 Test Loss: 1.365 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.410938024520874
Epoch: 22, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3954403400421143
Epoch: 23, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.645 Vali Acc: 0.580 Test Loss: 1.645 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4498436450958252
Epoch: 24, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.771 Vali Acc: 0.530 Test Loss: 1.771 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1702018
model size : 16.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2659311294555664
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.758 Vali Acc: 0.530 Test Loss: 0.758 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 1.4752631187438965
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.463435173034668
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5035805702209473
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.464235544204712
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.463895320892334
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4658198356628418
Epoch: 7, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.906 Vali Acc: 0.570 Test Loss: 0.906 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 1.434499979019165
Epoch: 8, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3759241104125977
Epoch: 9, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4735164642333984
Epoch: 10, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.897 Vali Acc: 0.510 Test Loss: 0.897 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5819196701049805
Epoch: 11, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.887 Vali Acc: 0.470 Test Loss: 0.887 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5407366752624512
Epoch: 12, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.105 Vali Acc: 0.530 Test Loss: 1.105 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.285444974899292
Epoch: 13, Steps: 20 | Train Loss: 0.521 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4314026832580566
Epoch: 14, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.975 Vali Acc: 0.480 Test Loss: 0.975 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4525890350341797
Epoch: 15, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2501587867736816
Epoch: 16, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.984 Vali Acc: 0.570 Test Loss: 0.984 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4689466953277588
Epoch: 17, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.766 Vali Acc: 0.540 Test Loss: 1.766 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1177730
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.417701005935669
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 1.433302402496338
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3700757026672363
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3743350505828857
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4341320991516113
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.812 Vali Acc: 0.490 Test Loss: 0.812 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.383690357208252
Epoch: 6, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3906283378601074
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.395796537399292
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4725613594055176
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2545208930969238
Epoch: 10, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4807462692260742
Epoch: 11, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.071 Vali Acc: 0.460 Test Loss: 1.071 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1177730
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1580660343170166
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.310713768005371
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 1.5258119106292725
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.491814374923706
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5275416374206543
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.335353136062622
Epoch: 6, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.764 Vali Acc: 0.570 Test Loss: 0.764 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.3947734832763672
Epoch: 7, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.877 Vali Acc: 0.500 Test Loss: 0.877 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3779006004333496
Epoch: 8, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.026 Vali Acc: 0.520 Test Loss: 1.026 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.354717493057251
Epoch: 9, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.777 Vali Acc: 0.580 Test Loss: 0.777 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 1.237337350845337
Epoch: 10, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3967258930206299
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3857097625732422
Epoch: 12, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.156 Vali Acc: 0.540 Test Loss: 1.156 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4485156536102295
Epoch: 13, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.047 Vali Acc: 0.550 Test Loss: 1.047 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3465235233306885
Epoch: 14, Steps: 20 | Train Loss: 0.381 Vali Loss: 0.990 Vali Acc: 0.480 Test Loss: 0.990 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3171749114990234
Epoch: 15, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.948 Vali Acc: 0.590 Test Loss: 0.948 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 16 cost time: 1.3892831802368164
Epoch: 16, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3021125793457031
Epoch: 17, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.604 Vali Acc: 0.550 Test Loss: 1.604 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4376912117004395
Epoch: 18, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.107 Vali Acc: 0.620 Test Loss: 1.107 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619989).  Saving model ...
Epoch: 19 cost time: 1.4125592708587646
Epoch: 19, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.413 Vali Acc: 0.510 Test Loss: 1.413 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5425376892089844
Epoch: 20, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4463896751403809
Epoch: 21, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.354 Vali Acc: 0.490 Test Loss: 1.354 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4400994777679443
Epoch: 22, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.526 Vali Acc: 0.540 Test Loss: 1.526 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4672863483428955
Epoch: 23, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.382 Vali Acc: 0.560 Test Loss: 1.382 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.413466453552246
Epoch: 24, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.613 Vali Acc: 0.560 Test Loss: 1.613 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2836554050445557
Epoch: 25, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.520 Vali Acc: 0.580 Test Loss: 1.520 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4269464015960693
Epoch: 26, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.983 Vali Acc: 0.570 Test Loss: 1.983 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.533390760421753
Epoch: 27, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.715 Vali Acc: 0.580 Test Loss: 1.715 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3863351345062256
Epoch: 28, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1177730
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6070845127105713
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.758 Vali Acc: 0.490 Test Loss: 0.758 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.3965041637420654
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
Validation loss decreased (-0.489992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.3183281421661377
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 1.2600224018096924
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4496104717254639
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5086779594421387
Epoch: 6, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 1.4235191345214844
Epoch: 7, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.814 Vali Acc: 0.570 Test Loss: 0.814 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 8 cost time: 1.3996336460113525
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.943 Vali Acc: 0.530 Test Loss: 0.943 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2512524127960205
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.2875142097473145
Epoch: 10, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.883 Vali Acc: 0.540 Test Loss: 0.883 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4711804389953613
Epoch: 11, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.814 Vali Acc: 0.490 Test Loss: 0.814 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3434038162231445
Epoch: 12, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.433344841003418
Epoch: 13, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.913 Vali Acc: 0.580 Test Loss: 0.913 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 14 cost time: 1.2986786365509033
Epoch: 14, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3860032558441162
Epoch: 15, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.938 Vali Acc: 0.570 Test Loss: 0.938 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3749845027923584
Epoch: 16, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.014 Vali Acc: 0.560 Test Loss: 1.014 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2053275108337402
Epoch: 17, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.467 Vali Acc: 0.570 Test Loss: 1.467 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2819719314575195
Epoch: 18, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.167 Vali Acc: 0.570 Test Loss: 1.167 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4830043315887451
Epoch: 19, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.476 Vali Acc: 0.520 Test Loss: 1.476 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5990784168243408
Epoch: 20, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.269 Vali Acc: 0.570 Test Loss: 1.269 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4283132553100586
Epoch: 21, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.183 Vali Acc: 0.610 Test Loss: 1.183 Test Acc: 0.610
Validation loss decreased (-0.579991 --> -0.609988).  Saving model ...
Epoch: 22 cost time: 1.3782072067260742
Epoch: 22, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.344 Vali Acc: 0.510 Test Loss: 1.344 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3208770751953125
Epoch: 23, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.280 Vali Acc: 0.580 Test Loss: 1.280 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3612139225006104
Epoch: 24, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.531 Vali Acc: 0.570 Test Loss: 1.531 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3617093563079834
Epoch: 25, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.540 Vali Acc: 0.570 Test Loss: 1.540 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2937750816345215
Epoch: 26, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.651 Vali Acc: 0.560 Test Loss: 1.651 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.39024019241333
Epoch: 27, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.634 Vali Acc: 0.560 Test Loss: 1.634 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4518721103668213
Epoch: 28, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.679 Vali Acc: 0.530 Test Loss: 1.679 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4708833694458008
Epoch: 29, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.853 Vali Acc: 0.540 Test Loss: 1.853 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.439246654510498
Epoch: 30, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.747 Vali Acc: 0.560 Test Loss: 1.747 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3729960918426514
Epoch: 31, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.859 Vali Acc: 0.520 Test Loss: 1.859 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1177730
model size : 14.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1971209049224854
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.396376132965088
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.5430278778076172
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4621562957763672
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5231177806854248
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 1.502692461013794
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.925 Vali Acc: 0.500 Test Loss: 0.925 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5771121978759766
Epoch: 7, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5409014225006104
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.940 Vali Acc: 0.500 Test Loss: 0.940 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4651236534118652
Epoch: 9, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5038044452667236
Epoch: 10, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4094798564910889
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.744 Vali Acc: 0.490 Test Loss: 1.744 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4089279174804688
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5539264678955078
Epoch: 13, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4750959873199463
Epoch: 14, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.985 Vali Acc: 0.520 Test Loss: 0.985 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3348455429077148
Epoch: 15, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.938 Vali Acc: 0.530 Test Loss: 0.938 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 915586
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.451951503753662
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 1.5480115413665771
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.785 Vali Acc: 0.440 Test Loss: 0.785 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.595580816268921
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.569453239440918
Epoch: 4, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.785 Vali Acc: 0.460 Test Loss: 0.785 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6366102695465088
Epoch: 5, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.859 Vali Acc: 0.580 Test Loss: 0.859 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 1.5397472381591797
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 1.018 Vali Acc: 0.490 Test Loss: 1.018 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5626249313354492
Epoch: 7, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.794 Vali Acc: 0.560 Test Loss: 0.794 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.445016622543335
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.921 Vali Acc: 0.530 Test Loss: 0.921 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5858814716339111
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.880 Vali Acc: 0.510 Test Loss: 0.880 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.465942621231079
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.476396083831787
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4537687301635742
Epoch: 12, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.926 Vali Acc: 0.550 Test Loss: 0.926 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4235944747924805
Epoch: 13, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.916 Vali Acc: 0.550 Test Loss: 0.916 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.631873369216919
Epoch: 14, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.990 Vali Acc: 0.510 Test Loss: 0.990 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3789491653442383
Epoch: 15, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 915586
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6797261238098145
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4450650215148926
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.3470702171325684
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.774 Vali Acc: 0.430 Test Loss: 0.774 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.369654893875122
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4148025512695312
Epoch: 5, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 1.4393892288208008
Epoch: 6, Steps: 20 | Train Loss: 0.631 Vali Loss: 1.011 Vali Acc: 0.460 Test Loss: 1.011 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.478703260421753
Epoch: 7, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.4262139797210693
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4856984615325928
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.920 Vali Acc: 0.490 Test Loss: 0.920 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5025608539581299
Epoch: 10, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.884 Vali Acc: 0.520 Test Loss: 0.884 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.410653829574585
Epoch: 11, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.475 Vali Acc: 0.480 Test Loss: 1.475 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4336376190185547
Epoch: 12, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4229342937469482
Epoch: 13, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.921 Vali Acc: 0.540 Test Loss: 0.921 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4418962001800537
Epoch: 14, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4391684532165527
Epoch: 15, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6891441345214844
Epoch: 16, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.483 Vali Acc: 0.480 Test Loss: 1.483 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4659414291381836
Epoch: 17, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 915586
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4563639163970947
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 1.3911256790161133
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.776 Vali Acc: 0.480 Test Loss: 0.776 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 1.5992887020111084
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.760 Vali Acc: 0.420 Test Loss: 0.760 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.443645715713501
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4574298858642578
Epoch: 5, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
Validation loss decreased (-0.479992 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 1.5809977054595947
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.882 Vali Acc: 0.470 Test Loss: 0.882 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5181024074554443
Epoch: 7, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5998122692108154
Epoch: 8, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.841 Vali Acc: 0.510 Test Loss: 0.841 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4864473342895508
Epoch: 9, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.986 Vali Acc: 0.520 Test Loss: 0.986 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3678760528564453
Epoch: 10, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6538312435150146
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.105 Vali Acc: 0.480 Test Loss: 1.105 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4909329414367676
Epoch: 12, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5169336795806885
Epoch: 13, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.838 Vali Acc: 0.590 Test Loss: 0.838 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 14 cost time: 1.4953083992004395
Epoch: 14, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.026 Vali Acc: 0.510 Test Loss: 1.026 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5495705604553223
Epoch: 15, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.917 Vali Acc: 0.590 Test Loss: 0.917 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5049383640289307
Epoch: 16, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3354918956756592
Epoch: 17, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.088 Vali Acc: 0.530 Test Loss: 1.088 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.370534896850586
Epoch: 18, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.217 Vali Acc: 0.550 Test Loss: 1.217 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4679882526397705
Epoch: 19, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4190983772277832
Epoch: 20, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.099 Vali Acc: 0.570 Test Loss: 1.099 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4387390613555908
Epoch: 21, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.141 Vali Acc: 0.560 Test Loss: 1.141 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5246069431304932
Epoch: 22, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.494 Vali Acc: 0.560 Test Loss: 1.494 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3688945770263672
Epoch: 23, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.355 Vali Acc: 0.540 Test Loss: 1.355 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 915586
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.69366455078125
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 1.4044618606567383
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.790 Vali Acc: 0.470 Test Loss: 0.790 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.486738920211792
Epoch: 3, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.830 Vali Acc: 0.560 Test Loss: 0.830 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 1.4414410591125488
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3587138652801514
Epoch: 5, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.862 Vali Acc: 0.520 Test Loss: 0.862 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5634639263153076
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.797 Vali Acc: 0.470 Test Loss: 0.797 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4604027271270752
Epoch: 7, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.032 Vali Acc: 0.560 Test Loss: 1.032 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5115435123443604
Epoch: 8, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4139959812164307
Epoch: 9, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.964 Vali Acc: 0.490 Test Loss: 0.964 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5227859020233154
Epoch: 10, Steps: 20 | Train Loss: 0.667 Vali Loss: 1.290 Vali Acc: 0.520 Test Loss: 1.290 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4715452194213867
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5688483715057373
Epoch: 12, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.963 Vali Acc: 0.520 Test Loss: 0.963 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4204821586608887
Epoch: 13, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 784514
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5258255004882812
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.3600046634674072
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.777 Vali Acc: 0.470 Test Loss: 0.777 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3094606399536133
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.5614075660705566
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5178029537200928
Epoch: 5, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 1.5285670757293701
Epoch: 6, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4207885265350342
Epoch: 7, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.956 Vali Acc: 0.560 Test Loss: 0.956 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.523674726486206
Epoch: 8, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.888 Vali Acc: 0.460 Test Loss: 0.888 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.402167797088623
Epoch: 9, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4292597770690918
Epoch: 10, Steps: 20 | Train Loss: 0.667 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4731733798980713
Epoch: 11, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 1.434281587600708
Epoch: 12, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.977 Vali Acc: 0.460 Test Loss: 0.977 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.378126859664917
Epoch: 13, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.005 Vali Acc: 0.470 Test Loss: 1.005 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4733803272247314
Epoch: 14, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4154338836669922
Epoch: 15, Steps: 20 | Train Loss: 0.512 Vali Loss: 1.183 Vali Acc: 0.530 Test Loss: 1.183 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.432316780090332
Epoch: 16, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.010 Vali Acc: 0.470 Test Loss: 1.010 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2493624687194824
Epoch: 17, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5557019710540771
Epoch: 18, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.997 Vali Acc: 0.570 Test Loss: 0.997 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 19 cost time: 1.3758013248443604
Epoch: 19, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3129961490631104
Epoch: 20, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6579973697662354
Epoch: 21, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.541 Vali Acc: 0.510 Test Loss: 1.541 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4155559539794922
Epoch: 22, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.369762659072876
Epoch: 23, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.343 Vali Acc: 0.490 Test Loss: 1.343 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4813413619995117
Epoch: 24, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.633 Vali Acc: 0.550 Test Loss: 1.633 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.509904384613037
Epoch: 25, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.431 Vali Acc: 0.530 Test Loss: 1.431 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4957282543182373
Epoch: 26, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.515 Vali Acc: 0.550 Test Loss: 1.515 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.499340295791626
Epoch: 27, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.489 Vali Acc: 0.540 Test Loss: 1.489 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5527915954589844
Epoch: 28, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.906 Vali Acc: 0.520 Test Loss: 1.906 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 784514
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.514923572540283
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.764 Vali Acc: 0.430 Test Loss: 0.764 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 1.3919627666473389
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
Validation loss decreased (-0.429992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.3407831192016602
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 1.4375436305999756
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.870 Vali Acc: 0.510 Test Loss: 0.870 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2958745956420898
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 6 cost time: 1.3939504623413086
Epoch: 6, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2163395881652832
Epoch: 7, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.984 Vali Acc: 0.550 Test Loss: 0.984 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 1.326188325881958
Epoch: 8, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.859 Vali Acc: 0.540 Test Loss: 0.859 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3587818145751953
Epoch: 9, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.965 Vali Acc: 0.510 Test Loss: 0.965 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5668892860412598
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.155 Vali Acc: 0.530 Test Loss: 1.155 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7065987586975098
Epoch: 11, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.833 Vali Acc: 0.580 Test Loss: 0.833 Test Acc: 0.580
Validation loss decreased (-0.549990 --> -0.579992).  Saving model ...
Epoch: 12 cost time: 1.5331249237060547
Epoch: 12, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.303 Vali Acc: 0.530 Test Loss: 1.303 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4982390403747559
Epoch: 13, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5334510803222656
Epoch: 14, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.210 Vali Acc: 0.510 Test Loss: 1.210 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.507960557937622
Epoch: 15, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.054 Vali Acc: 0.530 Test Loss: 1.054 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4919281005859375
Epoch: 16, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.494060754776001
Epoch: 17, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.193 Vali Acc: 0.540 Test Loss: 1.193 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4515843391418457
Epoch: 18, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.097 Vali Acc: 0.590 Test Loss: 1.097 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589989).  Saving model ...
Epoch: 19 cost time: 1.4983301162719727
Epoch: 19, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.466 Vali Acc: 0.530 Test Loss: 1.466 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4512042999267578
Epoch: 20, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.348 Vali Acc: 0.550 Test Loss: 1.348 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5256247520446777
Epoch: 21, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.572 Vali Acc: 0.540 Test Loss: 1.572 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4801959991455078
Epoch: 22, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.358 Vali Acc: 0.510 Test Loss: 1.358 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5679397583007812
Epoch: 23, Steps: 20 | Train Loss: 0.188 Vali Loss: 1.214 Vali Acc: 0.530 Test Loss: 1.214 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.445563554763794
Epoch: 24, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4522249698638916
Epoch: 25, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.664 Vali Acc: 0.560 Test Loss: 1.664 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5013768672943115
Epoch: 26, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.766 Vali Acc: 0.580 Test Loss: 1.766 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5935449600219727
Epoch: 27, Steps: 20 | Train Loss: 0.112 Vali Loss: 1.629 Vali Acc: 0.580 Test Loss: 1.629 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.47068190574646
Epoch: 28, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.767 Vali Acc: 0.530 Test Loss: 1.767 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 784514
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9996373653411865
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 1.209289312362671
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3446757793426514
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
Validation loss decreased (-0.459992 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.4996907711029053
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.390833854675293
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4280998706817627
Epoch: 6, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6110560894012451
Epoch: 7, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.952 Vali Acc: 0.510 Test Loss: 0.952 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3066651821136475
Epoch: 8, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5016708374023438
Epoch: 9, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.903 Vali Acc: 0.520 Test Loss: 0.903 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.62178373336792
Epoch: 10, Steps: 20 | Train Loss: 0.601 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.332869529724121
Epoch: 11, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.736 Vali Acc: 0.640 Test Loss: 0.736 Test Acc: 0.640
Validation loss decreased (-0.549993 --> -0.639993).  Saving model ...
Epoch: 12 cost time: 1.4582555294036865
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.150 Vali Acc: 0.550 Test Loss: 1.150 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.456768274307251
Epoch: 13, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4370636940002441
Epoch: 14, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4684960842132568
Epoch: 15, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5483887195587158
Epoch: 16, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4966590404510498
Epoch: 17, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.086 Vali Acc: 0.550 Test Loss: 1.086 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6383056640625
Epoch: 18, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.099 Vali Acc: 0.590 Test Loss: 1.099 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4775159358978271
Epoch: 19, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.483 Vali Acc: 0.530 Test Loss: 1.483 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4854037761688232
Epoch: 20, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.150 Vali Acc: 0.570 Test Loss: 1.150 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5225627422332764
Epoch: 21, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.533 Vali Acc: 0.580 Test Loss: 1.533 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 784514
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2981297969818115
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.3954286575317383
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.4934039115905762
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3719079494476318
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 1.4929323196411133
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.624283790588379
Epoch: 6, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7887940406799316
Epoch: 7, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.66229248046875
Epoch: 8, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.970 Vali Acc: 0.480 Test Loss: 0.970 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6833231449127197
Epoch: 9, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.920 Vali Acc: 0.520 Test Loss: 0.920 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5292785167694092
Epoch: 10, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.882 Vali Acc: 0.480 Test Loss: 0.882 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4822323322296143
Epoch: 11, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.903 Vali Acc: 0.430 Test Loss: 0.903 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.720076084136963
Epoch: 12, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6265692710876465
Epoch: 13, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5694653987884521
Epoch: 14, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.928 Vali Acc: 0.480 Test Loss: 0.928 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 718978
model size : 12.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8459017276763916
Epoch: 1, Steps: 20 | Train Loss: 0.751 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5481512546539307
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.5376355648040771
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5609502792358398
Epoch: 4, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 1.3697359561920166
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5298032760620117
Epoch: 6, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3561255931854248
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.564056158065796
Epoch: 8, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4081377983093262
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.48734450340271
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4856147766113281
Epoch: 11, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.883 Vali Acc: 0.440 Test Loss: 0.883 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4699742794036865
Epoch: 12, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.012 Vali Acc: 0.530 Test Loss: 1.012 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4905741214752197
Epoch: 13, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.009 Vali Acc: 0.550 Test Loss: 1.009 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 14 cost time: 1.6217198371887207
Epoch: 14, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.952 Vali Acc: 0.520 Test Loss: 0.952 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5851800441741943
Epoch: 15, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.988 Vali Acc: 0.540 Test Loss: 0.988 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6273624897003174
Epoch: 16, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.063 Vali Acc: 0.560 Test Loss: 1.063 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.4624261856079102
Epoch: 17, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.249 Vali Acc: 0.510 Test Loss: 1.249 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4523632526397705
Epoch: 18, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3348400592803955
Epoch: 19, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.328 Vali Acc: 0.570 Test Loss: 1.328 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569987).  Saving model ...
Epoch: 20 cost time: 1.4898343086242676
Epoch: 20, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.207 Vali Acc: 0.490 Test Loss: 1.207 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4500505924224854
Epoch: 21, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.394 Vali Acc: 0.530 Test Loss: 1.394 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.497513771057129
Epoch: 22, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.902 Vali Acc: 0.480 Test Loss: 1.902 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.649646282196045
Epoch: 23, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.469 Vali Acc: 0.550 Test Loss: 1.469 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6985204219818115
Epoch: 24, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.614 Vali Acc: 0.560 Test Loss: 1.614 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.45387601852417
Epoch: 25, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.429198980331421
Epoch: 26, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.539 Vali Acc: 0.550 Test Loss: 1.539 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5169999599456787
Epoch: 27, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.699 Vali Acc: 0.580 Test Loss: 1.699 Test Acc: 0.580
Validation loss decreased (-0.569987 --> -0.579983).  Saving model ...
Epoch: 28 cost time: 1.3546178340911865
Epoch: 28, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.559 Vali Acc: 0.560 Test Loss: 1.559 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3854072093963623
Epoch: 29, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.975 Vali Acc: 0.530 Test Loss: 1.975 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3790559768676758
Epoch: 30, Steps: 20 | Train Loss: 0.095 Vali Loss: 1.822 Vali Acc: 0.500 Test Loss: 1.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4811673164367676
Epoch: 31, Steps: 20 | Train Loss: 0.091 Vali Loss: 2.209 Vali Acc: 0.540 Test Loss: 2.209 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.401233434677124
Epoch: 32, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.896 Vali Acc: 0.540 Test Loss: 1.896 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4320487976074219
Epoch: 33, Steps: 20 | Train Loss: 0.098 Vali Loss: 2.038 Vali Acc: 0.540 Test Loss: 2.038 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4531702995300293
Epoch: 34, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.154 Vali Acc: 0.560 Test Loss: 2.154 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5509364604949951
Epoch: 35, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.319 Vali Acc: 0.590 Test Loss: 2.319 Test Acc: 0.590
Validation loss decreased (-0.579983 --> -0.589977).  Saving model ...
Epoch: 36 cost time: 1.5352773666381836
Epoch: 36, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.106 Vali Acc: 0.530 Test Loss: 2.106 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4473302364349365
Epoch: 37, Steps: 20 | Train Loss: 0.071 Vali Loss: 2.436 Vali Acc: 0.510 Test Loss: 2.436 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.624525547027588
Epoch: 38, Steps: 20 | Train Loss: 0.063 Vali Loss: 2.306 Vali Acc: 0.530 Test Loss: 2.306 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6661114692687988
Epoch: 39, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.445 Vali Acc: 0.510 Test Loss: 2.445 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8057563304901123
Epoch: 40, Steps: 20 | Train Loss: 0.040 Vali Loss: 2.113 Vali Acc: 0.590 Test Loss: 2.113 Test Acc: 0.590
Validation loss decreased (-0.589977 --> -0.589979).  Saving model ...
Epoch: 41 cost time: 1.4750864505767822
Epoch: 41, Steps: 20 | Train Loss: 0.048 Vali Loss: 2.786 Vali Acc: 0.530 Test Loss: 2.786 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4197094440460205
Epoch: 42, Steps: 20 | Train Loss: 0.076 Vali Loss: 3.247 Vali Acc: 0.560 Test Loss: 3.247 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6008784770965576
Epoch: 43, Steps: 20 | Train Loss: 0.130 Vali Loss: 2.626 Vali Acc: 0.560 Test Loss: 2.626 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.471449613571167
Epoch: 44, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.431 Vali Acc: 0.570 Test Loss: 2.431 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5924606323242188
Epoch: 45, Steps: 20 | Train Loss: 0.099 Vali Loss: 2.665 Vali Acc: 0.510 Test Loss: 2.665 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5857901573181152
Epoch: 46, Steps: 20 | Train Loss: 0.103 Vali Loss: 2.613 Vali Acc: 0.550 Test Loss: 2.613 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.5952823162078857
Epoch: 47, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.657 Vali Acc: 0.620 Test Loss: 2.657 Test Acc: 0.620
Validation loss decreased (-0.589979 --> -0.619973).  Saving model ...
Epoch: 48 cost time: 1.6151368618011475
Epoch: 48, Steps: 20 | Train Loss: 0.080 Vali Loss: 3.108 Vali Acc: 0.500 Test Loss: 3.108 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.561291217803955
Epoch: 49, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.734 Vali Acc: 0.580 Test Loss: 2.734 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.5848515033721924
Epoch: 50, Steps: 20 | Train Loss: 0.075 Vali Loss: 2.833 Vali Acc: 0.570 Test Loss: 2.833 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5152175426483154
Epoch: 51, Steps: 20 | Train Loss: 0.069 Vali Loss: 2.887 Vali Acc: 0.540 Test Loss: 2.887 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.4506022930145264
Epoch: 52, Steps: 20 | Train Loss: 0.046 Vali Loss: 2.957 Vali Acc: 0.540 Test Loss: 2.957 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3998303413391113
Epoch: 53, Steps: 20 | Train Loss: 0.049 Vali Loss: 2.913 Vali Acc: 0.540 Test Loss: 2.913 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.462949514389038
Epoch: 54, Steps: 20 | Train Loss: 0.021 Vali Loss: 2.937 Vali Acc: 0.580 Test Loss: 2.937 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.4642999172210693
Epoch: 55, Steps: 20 | Train Loss: 0.046 Vali Loss: 3.145 Vali Acc: 0.570 Test Loss: 3.145 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.5361108779907227
Epoch: 56, Steps: 20 | Train Loss: 0.056 Vali Loss: 3.695 Vali Acc: 0.550 Test Loss: 3.695 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.483393669128418
Epoch: 57, Steps: 20 | Train Loss: 0.029 Vali Loss: 3.559 Vali Acc: 0.560 Test Loss: 3.559 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 718978
model size : 12.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5436694622039795
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4747259616851807
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4299805164337158
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.850 Vali Acc: 0.430 Test Loss: 0.850 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6918227672576904
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 1.4687201976776123
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.383671522140503
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4827158451080322
Epoch: 7, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5183281898498535
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.970 Vali Acc: 0.490 Test Loss: 0.970 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5510964393615723
Epoch: 9, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4370813369750977
Epoch: 10, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5231661796569824
Epoch: 11, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5278205871582031
Epoch: 12, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.999 Vali Acc: 0.530 Test Loss: 0.999 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3883228302001953
Epoch: 13, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.4400296211242676
Epoch: 14, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.017 Vali Acc: 0.480 Test Loss: 1.017 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.291968584060669
Epoch: 15, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.025 Vali Acc: 0.560 Test Loss: 1.025 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3078584671020508
Epoch: 16, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2358450889587402
Epoch: 17, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2662572860717773
Epoch: 18, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.173 Vali Acc: 0.570 Test Loss: 1.173 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.231661081314087
Epoch: 19, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.113 Vali Acc: 0.550 Test Loss: 1.113 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4021565914154053
Epoch: 20, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.363 Vali Acc: 0.550 Test Loss: 1.363 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3753361701965332
Epoch: 21, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3760902881622314
Epoch: 22, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.937 Vali Acc: 0.540 Test Loss: 1.937 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4413597583770752
Epoch: 23, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.403 Vali Acc: 0.560 Test Loss: 1.403 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 718978
model size : 12.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.649486541748047
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.1686601638793945
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2733054161071777
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.852 Vali Acc: 0.430 Test Loss: 0.852 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4061341285705566
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.2629244327545166
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3060593605041504
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2899534702301025
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.3743295669555664
Epoch: 8, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.952 Vali Acc: 0.470 Test Loss: 0.952 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4424571990966797
Epoch: 9, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.883 Vali Acc: 0.520 Test Loss: 0.883 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.356154203414917
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.812 Vali Acc: 0.570 Test Loss: 0.812 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 1.321288824081421
Epoch: 11, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.842 Vali Acc: 0.520 Test Loss: 0.842 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4724907875061035
Epoch: 12, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7411932945251465
Epoch: 13, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.894 Vali Acc: 0.580 Test Loss: 0.894 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 14 cost time: 1.4563837051391602
Epoch: 14, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.966 Vali Acc: 0.510 Test Loss: 0.966 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5167262554168701
Epoch: 15, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.016 Vali Acc: 0.530 Test Loss: 1.016 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4290778636932373
Epoch: 16, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.261 Vali Acc: 0.560 Test Loss: 1.261 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2528538703918457
Epoch: 17, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.179 Vali Acc: 0.570 Test Loss: 1.179 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.192903757095337
Epoch: 18, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.404 Vali Acc: 0.520 Test Loss: 1.404 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2366266250610352
Epoch: 19, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.144 Vali Acc: 0.520 Test Loss: 1.144 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.319664478302002
Epoch: 20, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.084 Vali Acc: 0.620 Test Loss: 1.084 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619989).  Saving model ...
Epoch: 21 cost time: 1.244889736175537
Epoch: 21, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3285331726074219
Epoch: 22, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.535 Vali Acc: 0.540 Test Loss: 1.535 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3644728660583496
Epoch: 23, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.383 Vali Acc: 0.590 Test Loss: 1.383 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.417694091796875
Epoch: 24, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5890777111053467
Epoch: 25, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.525 Vali Acc: 0.620 Test Loss: 1.525 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.418433666229248
Epoch: 26, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.905 Vali Acc: 0.570 Test Loss: 1.905 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4537720680236816
Epoch: 27, Steps: 20 | Train Loss: 0.135 Vali Loss: 1.599 Vali Acc: 0.630 Test Loss: 1.599 Test Acc: 0.630
Validation loss decreased (-0.619989 --> -0.629984).  Saving model ...
Epoch: 28 cost time: 1.4070160388946533
Epoch: 28, Steps: 20 | Train Loss: 0.197 Vali Loss: 2.100 Vali Acc: 0.510 Test Loss: 2.100 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.509037733078003
Epoch: 29, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.596 Vali Acc: 0.600 Test Loss: 1.596 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3341443538665771
Epoch: 30, Steps: 20 | Train Loss: 0.090 Vali Loss: 2.034 Vali Acc: 0.550 Test Loss: 2.034 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3852958679199219
Epoch: 31, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.973 Vali Acc: 0.580 Test Loss: 1.973 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.383237600326538
Epoch: 32, Steps: 20 | Train Loss: 0.169 Vali Loss: 2.594 Vali Acc: 0.550 Test Loss: 2.594 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3118348121643066
Epoch: 33, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.922 Vali Acc: 0.590 Test Loss: 1.922 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5877234935760498
Epoch: 34, Steps: 20 | Train Loss: 0.048 Vali Loss: 2.122 Vali Acc: 0.550 Test Loss: 2.122 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.482466697692871
Epoch: 35, Steps: 20 | Train Loss: 0.058 Vali Loss: 2.552 Vali Acc: 0.570 Test Loss: 2.552 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4187707901000977
Epoch: 36, Steps: 20 | Train Loss: 0.063 Vali Loss: 2.065 Vali Acc: 0.640 Test Loss: 2.065 Test Acc: 0.640
Validation loss decreased (-0.629984 --> -0.639979).  Saving model ...
Epoch: 37 cost time: 1.4268372058868408
Epoch: 37, Steps: 20 | Train Loss: 0.085 Vali Loss: 2.362 Vali Acc: 0.620 Test Loss: 2.362 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4388680458068848
Epoch: 38, Steps: 20 | Train Loss: 0.079 Vali Loss: 2.578 Vali Acc: 0.540 Test Loss: 2.578 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.374230146408081
Epoch: 39, Steps: 20 | Train Loss: 0.083 Vali Loss: 2.450 Vali Acc: 0.580 Test Loss: 2.450 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4811222553253174
Epoch: 40, Steps: 20 | Train Loss: 0.035 Vali Loss: 2.314 Vali Acc: 0.570 Test Loss: 2.314 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.421764612197876
Epoch: 41, Steps: 20 | Train Loss: 0.048 Vali Loss: 2.215 Vali Acc: 0.590 Test Loss: 2.215 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3605151176452637
Epoch: 42, Steps: 20 | Train Loss: 0.024 Vali Loss: 2.220 Vali Acc: 0.590 Test Loss: 2.220 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4265296459197998
Epoch: 43, Steps: 20 | Train Loss: 0.035 Vali Loss: 2.618 Vali Acc: 0.540 Test Loss: 2.618 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2209815979003906
Epoch: 44, Steps: 20 | Train Loss: 0.028 Vali Loss: 2.322 Vali Acc: 0.570 Test Loss: 2.322 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3030200004577637
Epoch: 45, Steps: 20 | Train Loss: 0.022 Vali Loss: 2.564 Vali Acc: 0.550 Test Loss: 2.564 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2105119228363037
Epoch: 46, Steps: 20 | Train Loss: 0.071 Vali Loss: 2.557 Vali Acc: 0.570 Test Loss: 2.557 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 718978
model size : 12.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.132207155227661
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3144564628601074
Epoch: 2, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.798 Vali Acc: 0.460 Test Loss: 0.798 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.350541591644287
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.5485594272613525
Epoch: 4, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4749133586883545
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4099886417388916
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2662925720214844
Epoch: 7, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.821 Vali Acc: 0.520 Test Loss: 0.821 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3635601997375488
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.358304500579834
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4197630882263184
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 1.1962933540344238
Epoch: 11, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.896 Vali Acc: 0.530 Test Loss: 0.896 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2361717224121094
Epoch: 12, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3055784702301025
Epoch: 13, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.933 Vali Acc: 0.480 Test Loss: 0.933 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3162508010864258
Epoch: 14, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.011 Vali Acc: 0.550 Test Loss: 1.011 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.370436191558838
Epoch: 15, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.315843105316162
Epoch: 16, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2771759033203125
Epoch: 17, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.901 Vali Acc: 0.520 Test Loss: 0.901 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6069562435150146
Epoch: 18, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.917 Vali Acc: 0.520 Test Loss: 0.917 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3761100769042969
Epoch: 19, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2614250183105469
Epoch: 20, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.061 Vali Acc: 0.570 Test Loss: 1.061 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1244290
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0871403217315674
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.1808784008026123
Epoch: 2, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2559523582458496
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.735 Vali Acc: 0.540 Test Loss: 0.735 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.2358670234680176
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2803282737731934
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2629125118255615
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.188581943511963
Epoch: 7, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2998244762420654
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.310990333557129
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2728166580200195
Epoch: 10, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.2740604877471924
Epoch: 11, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.894 Vali Acc: 0.530 Test Loss: 0.894 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3026220798492432
Epoch: 12, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.296766996383667
Epoch: 13, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.920 Vali Acc: 0.480 Test Loss: 0.920 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.471459150314331
Epoch: 14, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2594211101531982
Epoch: 15, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3521156311035156
Epoch: 16, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.963 Vali Acc: 0.490 Test Loss: 0.963 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2326271533966064
Epoch: 17, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.897 Vali Acc: 0.540 Test Loss: 0.897 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4196100234985352
Epoch: 18, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.904 Vali Acc: 0.530 Test Loss: 0.904 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.424971103668213
Epoch: 19, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.376197099685669
Epoch: 20, Steps: 20 | Train Loss: 0.364 Vali Loss: 0.951 Vali Acc: 0.560 Test Loss: 0.951 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1244290
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6277756690979004
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.707 Vali Acc: 0.540 Test Loss: 0.707 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.390892505645752
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.777 Vali Acc: 0.480 Test Loss: 0.777 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6541855335235596
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.476644515991211
Epoch: 4, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4938991069793701
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4009051322937012
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4525046348571777
Epoch: 7, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2442126274108887
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5839366912841797
Epoch: 9, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5234549045562744
Epoch: 10, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.741 Vali Acc: 0.610 Test Loss: 0.741 Test Acc: 0.610
Validation loss decreased (-0.539993 --> -0.609993).  Saving model ...
Epoch: 11 cost time: 1.3264050483703613
Epoch: 11, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.835 Vali Acc: 0.550 Test Loss: 0.835 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.31304931640625
Epoch: 12, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.728 Vali Acc: 0.560 Test Loss: 0.728 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3180294036865234
Epoch: 13, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.869 Vali Acc: 0.480 Test Loss: 0.869 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.303299903869629
Epoch: 14, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2524871826171875
Epoch: 15, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3706278800964355
Epoch: 16, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.956 Vali Acc: 0.540 Test Loss: 0.956 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2654545307159424
Epoch: 17, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.860 Vali Acc: 0.570 Test Loss: 0.860 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1292078495025635
Epoch: 18, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.831 Vali Acc: 0.610 Test Loss: 0.831 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3038766384124756
Epoch: 19, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.423508882522583
Epoch: 20, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.955 Vali Acc: 0.560 Test Loss: 0.955 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1244290
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.6287155151367188
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5574324131011963
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.405097246170044
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.441843032836914
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.4963877201080322
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5346546173095703
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4302713871002197
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3608496189117432
Epoch: 8, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2913272380828857
Epoch: 9, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5146865844726562
Epoch: 10, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.699 Vali Acc: 0.600 Test Loss: 0.699 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 11 cost time: 1.6205525398254395
Epoch: 11, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.520106554031372
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.715 Vali Acc: 0.580 Test Loss: 0.715 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3921163082122803
Epoch: 13, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.870 Vali Acc: 0.510 Test Loss: 0.870 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4596245288848877
Epoch: 14, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.024 Vali Acc: 0.550 Test Loss: 1.024 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2878749370574951
Epoch: 15, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4151334762573242
Epoch: 16, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.960 Vali Acc: 0.470 Test Loss: 0.960 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5032904148101807
Epoch: 17, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.909 Vali Acc: 0.570 Test Loss: 0.909 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.339453935623169
Epoch: 18, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4251341819763184
Epoch: 19, Steps: 20 | Train Loss: 0.383 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2633776664733887
Epoch: 20, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.943 Vali Acc: 0.570 Test Loss: 0.943 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1244290
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7227721214294434
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.4432880878448486
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.789 Vali Acc: 0.470 Test Loss: 0.789 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6591923236846924
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 1.411693811416626
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.422668218612671
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.782 Vali Acc: 0.560 Test Loss: 0.782 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 1.4243407249450684
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5938365459442139
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.480299472808838
Epoch: 8, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.765845775604248
Epoch: 9, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.779475212097168
Epoch: 10, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6240637302398682
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.808 Vali Acc: 0.490 Test Loss: 0.808 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.666147232055664
Epoch: 12, Steps: 20 | Train Loss: 0.619 Vali Loss: 1.291 Vali Acc: 0.490 Test Loss: 1.291 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6692981719970703
Epoch: 13, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4801526069641113
Epoch: 14, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5548620223999023
Epoch: 15, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.925 Vali Acc: 0.470 Test Loss: 0.925 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 720002
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3349881172180176
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.3050880432128906
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.787 Vali Acc: 0.480 Test Loss: 0.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3092217445373535
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5589988231658936
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.4313299655914307
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.770 Vali Acc: 0.560 Test Loss: 0.770 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 1.2937369346618652
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3439364433288574
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.808 Vali Acc: 0.460 Test Loss: 0.808 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4695470333099365
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.304128646850586
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.403517246246338
Epoch: 10, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4107859134674072
Epoch: 11, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4755034446716309
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.452181339263916
Epoch: 13, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.356295108795166
Epoch: 14, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4003784656524658
Epoch: 15, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.886 Vali Acc: 0.480 Test Loss: 0.886 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 720002
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3839633464813232
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.302426815032959
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3228263854980469
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3639400005340576
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2807717323303223
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 1.4148058891296387
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.776 Vali Acc: 0.570 Test Loss: 0.776 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 1.2538292407989502
Epoch: 7, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3668692111968994
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.460655689239502
Epoch: 9, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4303309917449951
Epoch: 10, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.376814365386963
Epoch: 11, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4639818668365479
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4867241382598877
Epoch: 13, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3377630710601807
Epoch: 14, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.395662784576416
Epoch: 15, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.881 Vali Acc: 0.540 Test Loss: 0.881 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.360865831375122
Epoch: 16, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 720002
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8992719650268555
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.739 Vali Acc: 0.460 Test Loss: 0.739 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.41288161277771
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.338573932647705
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.744 Vali Acc: 0.430 Test Loss: 0.744 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3269577026367188
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.335022211074829
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.2690930366516113
Epoch: 6, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.790 Vali Acc: 0.480 Test Loss: 0.790 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.451932430267334
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.770 Vali Acc: 0.450 Test Loss: 0.770 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3538832664489746
Epoch: 8, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.776 Vali Acc: 0.490 Test Loss: 0.776 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3547370433807373
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.3865745067596436
Epoch: 10, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.817 Vali Acc: 0.470 Test Loss: 0.817 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3550608158111572
Epoch: 11, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.814 Vali Acc: 0.460 Test Loss: 0.814 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3553569316864014
Epoch: 12, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4258897304534912
Epoch: 13, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2820441722869873
Epoch: 14, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4173321723937988
Epoch: 15, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.927 Vali Acc: 0.570 Test Loss: 0.927 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 16 cost time: 1.414959192276001
Epoch: 16, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.875 Vali Acc: 0.510 Test Loss: 0.875 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.335613489151001
Epoch: 17, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4981226921081543
Epoch: 18, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.284292459487915
Epoch: 19, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.956 Vali Acc: 0.520 Test Loss: 0.956 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2843875885009766
Epoch: 20, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.051 Vali Acc: 0.540 Test Loss: 1.051 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3833248615264893
Epoch: 21, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.953 Vali Acc: 0.570 Test Loss: 0.953 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4020373821258545
Epoch: 22, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3392481803894043
Epoch: 23, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.081 Vali Acc: 0.580 Test Loss: 1.081 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579989).  Saving model ...
Epoch: 24 cost time: 1.3391826152801514
Epoch: 24, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.044 Vali Acc: 0.530 Test Loss: 1.044 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.38370680809021
Epoch: 25, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.127 Vali Acc: 0.530 Test Loss: 1.127 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3263895511627197
Epoch: 26, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.181 Vali Acc: 0.510 Test Loss: 1.181 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4905180931091309
Epoch: 27, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.713 Vali Acc: 0.540 Test Loss: 1.713 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.442734718322754
Epoch: 28, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.236 Vali Acc: 0.510 Test Loss: 1.236 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3764386177062988
Epoch: 29, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3689355850219727
Epoch: 30, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.489 Vali Acc: 0.550 Test Loss: 1.489 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3970577716827393
Epoch: 31, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.421 Vali Acc: 0.590 Test Loss: 1.421 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589986).  Saving model ...
Epoch: 32 cost time: 1.4720573425292969
Epoch: 32, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.464 Vali Acc: 0.570 Test Loss: 1.464 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3906900882720947
Epoch: 33, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.372 Vali Acc: 0.560 Test Loss: 1.372 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3002324104309082
Epoch: 34, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.353 Vali Acc: 0.590 Test Loss: 1.353 Test Acc: 0.590
Validation loss decreased (-0.589986 --> -0.589986).  Saving model ...
Epoch: 35 cost time: 1.3971970081329346
Epoch: 35, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.488 Vali Acc: 0.570 Test Loss: 1.488 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4640986919403076
Epoch: 36, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.860 Vali Acc: 0.600 Test Loss: 1.860 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599981).  Saving model ...
Epoch: 37 cost time: 1.2629165649414062
Epoch: 37, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.685 Vali Acc: 0.530 Test Loss: 1.685 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3736157417297363
Epoch: 38, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.696 Vali Acc: 0.560 Test Loss: 1.696 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3419139385223389
Epoch: 39, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.696 Vali Acc: 0.580 Test Loss: 1.696 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2818398475646973
Epoch: 40, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.806 Vali Acc: 0.590 Test Loss: 1.806 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2600598335266113
Epoch: 41, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.936 Vali Acc: 0.560 Test Loss: 1.936 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.304821491241455
Epoch: 42, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.824 Vali Acc: 0.580 Test Loss: 1.824 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3745167255401611
Epoch: 43, Steps: 20 | Train Loss: 0.083 Vali Loss: 2.019 Vali Acc: 0.570 Test Loss: 2.019 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4859468936920166
Epoch: 44, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.929 Vali Acc: 0.530 Test Loss: 1.929 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.317241907119751
Epoch: 45, Steps: 20 | Train Loss: 0.108 Vali Loss: 2.118 Vali Acc: 0.530 Test Loss: 2.118 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2916994094848633
Epoch: 46, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.997 Vali Acc: 0.570 Test Loss: 1.997 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 720002
model size : 7.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.8996355533599854
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.707 Vali Acc: 0.600 Test Loss: 0.707 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 1.3976657390594482
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5594427585601807
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.788 Vali Acc: 0.510 Test Loss: 0.788 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4524219036102295
Epoch: 4, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4471709728240967
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3961920738220215
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.37664794921875
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.423110008239746
Epoch: 8, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.828 Vali Acc: 0.510 Test Loss: 0.828 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.471235990524292
Epoch: 9, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4795482158660889
Epoch: 10, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.885 Vali Acc: 0.520 Test Loss: 0.885 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7780380249023438
Epoch: 11, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 457858
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3236472606658936
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.4061765670776367
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3773846626281738
Epoch: 3, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.447636365890503
Epoch: 4, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.358849287033081
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5735108852386475
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4600296020507812
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3046777248382568
Epoch: 8, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.835 Vali Acc: 0.470 Test Loss: 0.835 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3162329196929932
Epoch: 9, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3873600959777832
Epoch: 10, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2221944332122803
Epoch: 11, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 457858
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.40537428855896
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.3519859313964844
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4044651985168457
Epoch: 3, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2794790267944336
Epoch: 4, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.235534429550171
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3384060859680176
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2669916152954102
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.733 Vali Acc: 0.560 Test Loss: 0.733 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4143438339233398
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.817 Vali Acc: 0.490 Test Loss: 0.817 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.220184564590454
Epoch: 9, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2919108867645264
Epoch: 10, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2558536529541016
Epoch: 11, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 457858
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.400486707687378
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.1914949417114258
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.488983392715454
Epoch: 3, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.3680329322814941
Epoch: 4, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3201370239257812
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.3974480628967285
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.712 Vali Acc: 0.460 Test Loss: 0.712 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2385637760162354
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3107306957244873
Epoch: 8, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3269758224487305
Epoch: 9, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3224170207977295
Epoch: 10, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.850 Vali Acc: 0.490 Test Loss: 0.850 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4147274494171143
Epoch: 11, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 12 cost time: 1.3775434494018555
Epoch: 12, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4691896438598633
Epoch: 13, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.406486988067627
Epoch: 14, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.219571828842163
Epoch: 15, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2922556400299072
Epoch: 16, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.300875186920166
Epoch: 17, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1747229099273682
Epoch: 18, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.274404525756836
Epoch: 19, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539991).  Saving model ...
Epoch: 20 cost time: 1.3178627490997314
Epoch: 20, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569992).  Saving model ...
Epoch: 21 cost time: 1.1935250759124756
Epoch: 21, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.128 Vali Acc: 0.580 Test Loss: 1.128 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579989).  Saving model ...
Epoch: 22 cost time: 1.2259411811828613
Epoch: 22, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.879 Vali Acc: 0.600 Test Loss: 0.879 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599991).  Saving model ...
Epoch: 23 cost time: 1.217710256576538
Epoch: 23, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.044 Vali Acc: 0.500 Test Loss: 1.044 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4991695880889893
Epoch: 24, Steps: 20 | Train Loss: 0.306 Vali Loss: 0.965 Vali Acc: 0.550 Test Loss: 0.965 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3056755065917969
Epoch: 25, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.258 Vali Acc: 0.560 Test Loss: 1.258 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3461740016937256
Epoch: 26, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.155 Vali Acc: 0.550 Test Loss: 1.155 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3024144172668457
Epoch: 27, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.043 Vali Acc: 0.560 Test Loss: 1.043 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3239412307739258
Epoch: 28, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.013 Vali Acc: 0.530 Test Loss: 1.013 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.458448886871338
Epoch: 29, Steps: 20 | Train Loss: 0.274 Vali Loss: 1.056 Vali Acc: 0.570 Test Loss: 1.056 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3595190048217773
Epoch: 30, Steps: 20 | Train Loss: 0.218 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4040265083312988
Epoch: 31, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3736302852630615
Epoch: 32, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.337 Vali Acc: 0.600 Test Loss: 1.337 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 457858
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.700206756591797
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3655176162719727
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4638309478759766
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.764 Vali Acc: 0.420 Test Loss: 0.764 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5111088752746582
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.052 Vali Acc: 0.480 Test Loss: 1.052 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4242057800292969
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.34513521194458
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4231116771697998
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 1.2105121612548828
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2794265747070312
Epoch: 9, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.870 Vali Acc: 0.460 Test Loss: 0.870 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3066890239715576
Epoch: 10, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.868 Vali Acc: 0.550 Test Loss: 0.868 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 1.4460630416870117
Epoch: 11, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.47857666015625
Epoch: 12, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3382842540740967
Epoch: 13, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4526143074035645
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3134806156158447
Epoch: 15, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.457404375076294
Epoch: 16, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.992 Vali Acc: 0.540 Test Loss: 0.992 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3232908248901367
Epoch: 17, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.000 Vali Acc: 0.480 Test Loss: 1.000 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5104095935821533
Epoch: 18, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4670214653015137
Epoch: 19, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3547255992889404
Epoch: 20, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.069 Vali Acc: 0.530 Test Loss: 1.069 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 326786
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.7330963611602783
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.4624669551849365
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5975725650787354
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5114059448242188
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 1.029 Vali Acc: 0.480 Test Loss: 1.029 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4412736892700195
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.3749189376831055
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.832 Vali Acc: 0.460 Test Loss: 0.832 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4857971668243408
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.2490816116333008
Epoch: 8, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 1.268876552581787
Epoch: 9, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.427008867263794
Epoch: 10, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.859 Vali Acc: 0.540 Test Loss: 0.859 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3509352207183838
Epoch: 11, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3582890033721924
Epoch: 12, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 1.3607585430145264
Epoch: 13, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.380924940109253
Epoch: 14, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 15 cost time: 1.6499850749969482
Epoch: 15, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3971846103668213
Epoch: 16, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.031 Vali Acc: 0.550 Test Loss: 1.031 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3819324970245361
Epoch: 17, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.983 Vali Acc: 0.470 Test Loss: 0.983 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4710257053375244
Epoch: 18, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.109 Vali Acc: 0.550 Test Loss: 1.109 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6718454360961914
Epoch: 19, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.113 Vali Acc: 0.570 Test Loss: 1.113 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569989).  Saving model ...
Epoch: 20 cost time: 1.4949839115142822
Epoch: 20, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.090 Vali Acc: 0.510 Test Loss: 1.090 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5085828304290771
Epoch: 21, Steps: 20 | Train Loss: 0.357 Vali Loss: 0.866 Vali Acc: 0.560 Test Loss: 0.866 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.649857997894287
Epoch: 22, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.649848222732544
Epoch: 23, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
Validation loss decreased (-0.569989 --> -0.569991).  Saving model ...
Epoch: 24 cost time: 1.3611280918121338
Epoch: 24, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.094 Vali Acc: 0.480 Test Loss: 1.094 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4377949237823486
Epoch: 25, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.056 Vali Acc: 0.480 Test Loss: 1.056 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.550229787826538
Epoch: 26, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.177 Vali Acc: 0.510 Test Loss: 1.177 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4602665901184082
Epoch: 27, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.037 Vali Acc: 0.590 Test Loss: 1.037 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589990).  Saving model ...
Epoch: 28 cost time: 1.3362581729888916
Epoch: 28, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.067 Vali Acc: 0.550 Test Loss: 1.067 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.579988718032837
Epoch: 29, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5097715854644775
Epoch: 30, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.247 Vali Acc: 0.540 Test Loss: 1.247 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3582689762115479
Epoch: 31, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4715523719787598
Epoch: 32, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.175 Vali Acc: 0.550 Test Loss: 1.175 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.354875087738037
Epoch: 33, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.159 Vali Acc: 0.570 Test Loss: 1.159 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4296543598175049
Epoch: 34, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.430 Vali Acc: 0.530 Test Loss: 1.430 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4372670650482178
Epoch: 35, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.413 Vali Acc: 0.530 Test Loss: 1.413 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4383211135864258
Epoch: 36, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.405 Vali Acc: 0.490 Test Loss: 1.405 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4869930744171143
Epoch: 37, Steps: 20 | Train Loss: 0.158 Vali Loss: 1.196 Vali Acc: 0.570 Test Loss: 1.196 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 326786
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.751999616622925
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.4993741512298584
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5898749828338623
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4779138565063477
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 1.006 Vali Acc: 0.490 Test Loss: 1.006 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489990).  Saving model ...
Epoch: 5 cost time: 1.3922629356384277
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
Validation loss decreased (-0.489990 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 1.3064236640930176
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2804350852966309
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.4203691482543945
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.4132320880889893
Epoch: 9, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3546977043151855
Epoch: 10, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.820 Vali Acc: 0.560 Test Loss: 0.820 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.4088966846466064
Epoch: 11, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5641043186187744
Epoch: 12, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3313522338867188
Epoch: 13, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3354465961456299
Epoch: 14, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.19942045211792
Epoch: 15, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 16 cost time: 1.2657277584075928
Epoch: 16, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.066 Vali Acc: 0.580 Test Loss: 1.066 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579989).  Saving model ...
Epoch: 17 cost time: 1.3390469551086426
Epoch: 17, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.919 Vali Acc: 0.550 Test Loss: 0.919 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2644023895263672
Epoch: 18, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.474787950515747
Epoch: 19, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.855 Vali Acc: 0.590 Test Loss: 0.855 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 1.3736822605133057
Epoch: 20, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3262770175933838
Epoch: 21, Steps: 20 | Train Loss: 0.388 Vali Loss: 0.873 Vali Acc: 0.590 Test Loss: 0.873 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.682671070098877
Epoch: 22, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.123 Vali Acc: 0.560 Test Loss: 1.123 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.593919277191162
Epoch: 23, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.912 Vali Acc: 0.530 Test Loss: 0.912 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5896916389465332
Epoch: 24, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.043 Vali Acc: 0.490 Test Loss: 1.043 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5946228504180908
Epoch: 25, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5317046642303467
Epoch: 26, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.119 Vali Acc: 0.490 Test Loss: 1.119 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.619812250137329
Epoch: 27, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.084 Vali Acc: 0.540 Test Loss: 1.084 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.431771993637085
Epoch: 28, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.020 Vali Acc: 0.560 Test Loss: 1.020 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.543489933013916
Epoch: 29, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.344 Vali Acc: 0.510 Test Loss: 1.344 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 326786
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.363387107849121
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3029100894927979
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.3609404563903809
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.745 Vali Acc: 0.440 Test Loss: 0.745 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2256379127502441
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.957 Vali Acc: 0.490 Test Loss: 0.957 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.424548625946045
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2580764293670654
Epoch: 6, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.349567174911499
Epoch: 7, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 8 cost time: 1.2911181449890137
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3302333354949951
Epoch: 9, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.3626530170440674
Epoch: 10, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.3246076107025146
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.162552833557129
Epoch: 12, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.328528881072998
Epoch: 13, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.196742057800293
Epoch: 14, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.936 Vali Acc: 0.480 Test Loss: 0.936 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1577346324920654
Epoch: 15, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.867 Vali Acc: 0.570 Test Loss: 0.867 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569991).  Saving model ...
Epoch: 16 cost time: 1.4432251453399658
Epoch: 16, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.953 Vali Acc: 0.530 Test Loss: 0.953 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3608481884002686
Epoch: 17, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3560831546783447
Epoch: 18, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.941 Vali Acc: 0.530 Test Loss: 0.941 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.317199468612671
Epoch: 19, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.056 Vali Acc: 0.490 Test Loss: 1.056 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3181912899017334
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.944 Vali Acc: 0.490 Test Loss: 0.944 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4047632217407227
Epoch: 21, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3134989738464355
Epoch: 22, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3906636238098145
Epoch: 23, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.000 Vali Acc: 0.560 Test Loss: 1.000 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.377945899963379
Epoch: 24, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.079 Vali Acc: 0.560 Test Loss: 1.079 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.32749342918396
Epoch: 25, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.050 Vali Acc: 0.510 Test Loss: 1.050 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 326786
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.353031635284424
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.2733972072601318
Epoch: 2, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.3277766704559326
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3157432079315186
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.885 Vali Acc: 0.490 Test Loss: 0.885 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3959600925445557
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.3798127174377441
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.3094732761383057
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3541290760040283
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 1.207984209060669
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.832 Vali Acc: 0.520 Test Loss: 0.832 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3508999347686768
Epoch: 10, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.237213373184204
Epoch: 11, Steps: 20 | Train Loss: 0.580 Vali Loss: 1.146 Vali Acc: 0.510 Test Loss: 1.146 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1931605339050293
Epoch: 12, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.890 Vali Acc: 0.490 Test Loss: 0.890 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2135000228881836
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.906 Vali Acc: 0.540 Test Loss: 0.906 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539991).  Saving model ...
Epoch: 14 cost time: 1.291621446609497
Epoch: 14, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.882 Vali Acc: 0.520 Test Loss: 0.882 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3662824630737305
Epoch: 15, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.113 Vali Acc: 0.510 Test Loss: 1.113 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3208975791931152
Epoch: 16, Steps: 20 | Train Loss: 0.509 Vali Loss: 1.021 Vali Acc: 0.490 Test Loss: 1.021 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3122940063476562
Epoch: 17, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.909 Vali Acc: 0.580 Test Loss: 0.909 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579991).  Saving model ...
Epoch: 18 cost time: 1.4822137355804443
Epoch: 18, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.249 Vali Acc: 0.520 Test Loss: 1.249 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3608107566833496
Epoch: 19, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.977 Vali Acc: 0.480 Test Loss: 0.977 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4286854267120361
Epoch: 20, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.851 Vali Acc: 0.510 Test Loss: 0.851 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.381263017654419
Epoch: 21, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.862 Vali Acc: 0.520 Test Loss: 0.862 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4381251335144043
Epoch: 22, Steps: 20 | Train Loss: 0.340 Vali Loss: 0.908 Vali Acc: 0.520 Test Loss: 0.908 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2950868606567383
Epoch: 23, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.909 Vali Acc: 0.510 Test Loss: 0.909 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2620697021484375
Epoch: 24, Steps: 20 | Train Loss: 0.338 Vali Loss: 0.977 Vali Acc: 0.530 Test Loss: 0.977 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3725783824920654
Epoch: 25, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.077 Vali Acc: 0.530 Test Loss: 1.077 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2732734680175781
Epoch: 26, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3740715980529785
Epoch: 27, Steps: 20 | Train Loss: 0.284 Vali Loss: 0.917 Vali Acc: 0.540 Test Loss: 0.917 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 261250
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.36124849319458
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 1.347895622253418
Epoch: 2, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.755 Vali Acc: 0.430 Test Loss: 0.755 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2707059383392334
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.776 Vali Acc: 0.440 Test Loss: 0.776 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3397877216339111
Epoch: 4, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 5 cost time: 1.2544941902160645
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.2130916118621826
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.2830348014831543
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.774 Vali Acc: 0.480 Test Loss: 0.774 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3512890338897705
Epoch: 8, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4403724670410156
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3488399982452393
Epoch: 10, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.3248541355133057
Epoch: 11, Steps: 20 | Train Loss: 0.567 Vali Loss: 1.148 Vali Acc: 0.530 Test Loss: 1.148 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2675604820251465
Epoch: 12, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3272383213043213
Epoch: 13, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.912 Vali Acc: 0.530 Test Loss: 0.912 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2357981204986572
Epoch: 14, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1896278858184814
Epoch: 15, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2554142475128174
Epoch: 16, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3623003959655762
Epoch: 17, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.879 Vali Acc: 0.580 Test Loss: 0.879 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579991).  Saving model ...
Epoch: 18 cost time: 1.2744760513305664
Epoch: 18, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3385801315307617
Epoch: 19, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.943 Vali Acc: 0.510 Test Loss: 0.943 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2189173698425293
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.838 Vali Acc: 0.580 Test Loss: 0.838 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579992).  Saving model ...
Epoch: 21 cost time: 1.3049900531768799
Epoch: 21, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.849 Vali Acc: 0.560 Test Loss: 0.849 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2882258892059326
Epoch: 22, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.883 Vali Acc: 0.550 Test Loss: 0.883 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2501778602600098
Epoch: 23, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.861 Vali Acc: 0.510 Test Loss: 0.861 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4232823848724365
Epoch: 24, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.997 Vali Acc: 0.590 Test Loss: 0.997 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 25 cost time: 1.3415493965148926
Epoch: 25, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.115 Vali Acc: 0.570 Test Loss: 1.115 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.530630111694336
Epoch: 26, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.007 Vali Acc: 0.560 Test Loss: 1.007 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.344179630279541
Epoch: 27, Steps: 20 | Train Loss: 0.266 Vali Loss: 0.929 Vali Acc: 0.600 Test Loss: 0.929 Test Acc: 0.600
Validation loss decreased (-0.589990 --> -0.599991).  Saving model ...
Epoch: 28 cost time: 1.4246394634246826
Epoch: 28, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.287175178527832
Epoch: 29, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.410897970199585
Epoch: 30, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2984960079193115
Epoch: 31, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.536 Vali Acc: 0.520 Test Loss: 1.536 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4069437980651855
Epoch: 32, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.367070198059082
Epoch: 33, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.388 Vali Acc: 0.560 Test Loss: 1.388 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3716089725494385
Epoch: 34, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.551 Vali Acc: 0.620 Test Loss: 1.551 Test Acc: 0.620
Validation loss decreased (-0.599991 --> -0.619984).  Saving model ...
Epoch: 35 cost time: 1.2463886737823486
Epoch: 35, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.424 Vali Acc: 0.540 Test Loss: 1.424 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4658334255218506
Epoch: 36, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3277900218963623
Epoch: 37, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.385 Vali Acc: 0.550 Test Loss: 1.385 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1208162307739258
Epoch: 38, Steps: 20 | Train Loss: 0.118 Vali Loss: 1.400 Vali Acc: 0.510 Test Loss: 1.400 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3340048789978027
Epoch: 39, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.503 Vali Acc: 0.510 Test Loss: 1.503 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2662172317504883
Epoch: 40, Steps: 20 | Train Loss: 0.184 Vali Loss: 1.879 Vali Acc: 0.580 Test Loss: 1.879 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.391155481338501
Epoch: 41, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.591 Vali Acc: 0.540 Test Loss: 1.591 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3261220455169678
Epoch: 42, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.604 Vali Acc: 0.520 Test Loss: 1.604 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3130719661712646
Epoch: 43, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.527 Vali Acc: 0.530 Test Loss: 1.527 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2263641357421875
Epoch: 44, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.783 Vali Acc: 0.590 Test Loss: 1.783 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 261250
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4805169105529785
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4423651695251465
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.512840747833252
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.763 Vali Acc: 0.450 Test Loss: 0.763 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6661865711212158
Epoch: 4, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.384521245956421
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.3777744770050049
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.5081980228424072
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 1.4864449501037598
Epoch: 8, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 9 cost time: 1.4912235736846924
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.567068338394165
Epoch: 10, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3679416179656982
Epoch: 11, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.150 Vali Acc: 0.510 Test Loss: 1.150 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6530985832214355
Epoch: 12, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3543627262115479
Epoch: 13, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2017123699188232
Epoch: 14, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 1.4284684658050537
Epoch: 15, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.084 Vali Acc: 0.530 Test Loss: 1.084 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5167524814605713
Epoch: 16, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.922 Vali Acc: 0.580 Test Loss: 0.922 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3034846782684326
Epoch: 17, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.832 Vali Acc: 0.620 Test Loss: 0.832 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 18 cost time: 1.553649663925171
Epoch: 18, Steps: 20 | Train Loss: 0.450 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3239867687225342
Epoch: 19, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.361825704574585
Epoch: 20, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.819 Vali Acc: 0.610 Test Loss: 0.819 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2858965396881104
Epoch: 21, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2615559101104736
Epoch: 22, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.819 Vali Acc: 0.570 Test Loss: 0.819 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3406872749328613
Epoch: 23, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3556549549102783
Epoch: 24, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.927 Vali Acc: 0.590 Test Loss: 0.927 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.350982427597046
Epoch: 25, Steps: 20 | Train Loss: 0.248 Vali Loss: 0.991 Vali Acc: 0.540 Test Loss: 0.991 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.397686243057251
Epoch: 26, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.051 Vali Acc: 0.540 Test Loss: 1.051 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3835370540618896
Epoch: 27, Steps: 20 | Train Loss: 0.260 Vali Loss: 0.931 Vali Acc: 0.610 Test Loss: 0.931 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 261250
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.139270782470703
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.379624366760254
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.415480375289917
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5443053245544434
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4760377407073975
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4637534618377686
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 7 cost time: 1.3748602867126465
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5055150985717773
Epoch: 8, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 9 cost time: 1.5852594375610352
Epoch: 9, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3654017448425293
Epoch: 10, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 11 cost time: 1.4502298831939697
Epoch: 11, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.066 Vali Acc: 0.490 Test Loss: 1.066 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2991156578063965
Epoch: 12, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.833 Vali Acc: 0.470 Test Loss: 0.833 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.320667028427124
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2608880996704102
Epoch: 14, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3253779411315918
Epoch: 15, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.235863447189331
Epoch: 16, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.002 Vali Acc: 0.510 Test Loss: 1.002 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3734359741210938
Epoch: 17, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.806 Vali Acc: 0.600 Test Loss: 0.806 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 18 cost time: 1.2506606578826904
Epoch: 18, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.154 Vali Acc: 0.530 Test Loss: 1.154 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3440327644348145
Epoch: 19, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.886 Vali Acc: 0.500 Test Loss: 0.886 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.391369104385376
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.832 Vali Acc: 0.620 Test Loss: 0.832 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 21 cost time: 1.4166958332061768
Epoch: 21, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.819 Vali Acc: 0.590 Test Loss: 0.819 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.425884485244751
Epoch: 22, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.865 Vali Acc: 0.540 Test Loss: 0.865 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.544813871383667
Epoch: 23, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.851 Vali Acc: 0.640 Test Loss: 0.851 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639991).  Saving model ...
Epoch: 24 cost time: 1.4181513786315918
Epoch: 24, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.034 Vali Acc: 0.540 Test Loss: 1.034 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.280414342880249
Epoch: 25, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.029 Vali Acc: 0.630 Test Loss: 1.029 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5395221710205078
Epoch: 26, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.077 Vali Acc: 0.540 Test Loss: 1.077 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.364079475402832
Epoch: 27, Steps: 20 | Train Loss: 0.218 Vali Loss: 0.959 Vali Acc: 0.600 Test Loss: 0.959 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5439705848693848
Epoch: 28, Steps: 20 | Train Loss: 0.224 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.317718267440796
Epoch: 29, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.357555627822876
Epoch: 30, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4290354251861572
Epoch: 31, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.328 Vali Acc: 0.590 Test Loss: 1.328 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4724748134613037
Epoch: 32, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.286 Vali Acc: 0.580 Test Loss: 1.286 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.556823968887329
Epoch: 33, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.639 Vali Acc: 0.550 Test Loss: 1.639 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 261250
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9906153678894043
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.2785561084747314
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.2049071788787842
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.189793586730957
Epoch: 4, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.118384599685669
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.870 Vali Acc: 0.520 Test Loss: 0.870 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.18855881690979
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.171731948852539
Epoch: 7, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.849 Vali Acc: 0.540 Test Loss: 0.849 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.3420701026916504
Epoch: 8, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3306183815002441
Epoch: 9, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.833 Vali Acc: 0.490 Test Loss: 0.833 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1939167976379395
Epoch: 10, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.804 Vali Acc: 0.550 Test Loss: 0.804 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.3720533847808838
Epoch: 11, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3213059902191162
Epoch: 12, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 13 cost time: 1.3311915397644043
Epoch: 13, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.923 Vali Acc: 0.570 Test Loss: 0.923 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 14 cost time: 1.4511592388153076
Epoch: 14, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.429112195968628
Epoch: 15, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.912 Vali Acc: 0.520 Test Loss: 0.912 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3952751159667969
Epoch: 16, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.916 Vali Acc: 0.590 Test Loss: 0.916 Test Acc: 0.590
Validation loss decreased (-0.569991 --> -0.589991).  Saving model ...
Epoch: 17 cost time: 1.451158046722412
Epoch: 17, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3734192848205566
Epoch: 18, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.959 Vali Acc: 0.490 Test Loss: 0.959 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2318189144134521
Epoch: 19, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.848 Vali Acc: 0.550 Test Loss: 0.848 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1769318580627441
Epoch: 20, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.046 Vali Acc: 0.540 Test Loss: 1.046 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2994616031646729
Epoch: 21, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.220470905303955
Epoch: 22, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.017 Vali Acc: 0.520 Test Loss: 1.017 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.243905782699585
Epoch: 23, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.085 Vali Acc: 0.490 Test Loss: 1.085 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3042640686035156
Epoch: 24, Steps: 20 | Train Loss: 0.369 Vali Loss: 1.017 Vali Acc: 0.570 Test Loss: 1.017 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2779226303100586
Epoch: 25, Steps: 20 | Train Loss: 0.333 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.371044397354126
Epoch: 26, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.155 Vali Acc: 0.510 Test Loss: 1.155 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 228482
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1758859157562256
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.3006651401519775
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.2410171031951904
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 1.2521779537200928
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.2804384231567383
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.885 Vali Acc: 0.510 Test Loss: 0.885 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.363823413848877
Epoch: 6, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.299140453338623
Epoch: 7, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.830 Vali Acc: 0.540 Test Loss: 0.830 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.2432260513305664
Epoch: 8, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2643275260925293
Epoch: 9, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.826 Vali Acc: 0.530 Test Loss: 0.826 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2546110153198242
Epoch: 10, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3665308952331543
Epoch: 11, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3251094818115234
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 13 cost time: 1.2710902690887451
Epoch: 13, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.881 Vali Acc: 0.540 Test Loss: 0.881 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2072947025299072
Epoch: 14, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.844 Vali Acc: 0.520 Test Loss: 0.844 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.280168056488037
Epoch: 15, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2499303817749023
Epoch: 16, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.932 Vali Acc: 0.590 Test Loss: 0.932 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589991).  Saving model ...
Epoch: 17 cost time: 1.2629389762878418
Epoch: 17, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3109307289123535
Epoch: 18, Steps: 20 | Train Loss: 0.421 Vali Loss: 0.961 Vali Acc: 0.460 Test Loss: 0.961 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3466100692749023
Epoch: 19, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3558762073516846
Epoch: 20, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.975 Vali Acc: 0.540 Test Loss: 0.975 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3716628551483154
Epoch: 21, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.918 Vali Acc: 0.550 Test Loss: 0.918 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2996470928192139
Epoch: 22, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.028 Vali Acc: 0.520 Test Loss: 1.028 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3682043552398682
Epoch: 23, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.981 Vali Acc: 0.530 Test Loss: 0.981 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3807563781738281
Epoch: 24, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.056 Vali Acc: 0.550 Test Loss: 1.056 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.304305076599121
Epoch: 25, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.966 Vali Acc: 0.510 Test Loss: 0.966 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3304681777954102
Epoch: 26, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 228482
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.005960702896118
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.369554042816162
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.768 Vali Acc: 0.470 Test Loss: 0.768 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1419272422790527
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2179269790649414
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2383830547332764
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.875 Vali Acc: 0.490 Test Loss: 0.875 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4729561805725098
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.310915470123291
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.2092666625976562
Epoch: 8, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3936660289764404
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3804192543029785
Epoch: 10, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.758 Vali Acc: 0.470 Test Loss: 0.758 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.344444990158081
Epoch: 11, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 12 cost time: 1.3273439407348633
Epoch: 12, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.825 Vali Acc: 0.540 Test Loss: 0.825 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.322291612625122
Epoch: 13, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.876 Vali Acc: 0.560 Test Loss: 0.876 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 14 cost time: 1.3985214233398438
Epoch: 14, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3812613487243652
Epoch: 15, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3488664627075195
Epoch: 16, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.932 Vali Acc: 0.540 Test Loss: 0.932 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3516316413879395
Epoch: 17, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.755 Vali Acc: 0.580 Test Loss: 0.755 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579992).  Saving model ...
Epoch: 18 cost time: 1.3014955520629883
Epoch: 18, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.311830759048462
Epoch: 19, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2442874908447266
Epoch: 20, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.927 Vali Acc: 0.600 Test Loss: 0.927 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 21 cost time: 1.3457655906677246
Epoch: 21, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2968261241912842
Epoch: 22, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.061 Vali Acc: 0.580 Test Loss: 1.061 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2706098556518555
Epoch: 23, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.919 Vali Acc: 0.580 Test Loss: 0.919 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.21877121925354
Epoch: 24, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3620085716247559
Epoch: 25, Steps: 20 | Train Loss: 0.265 Vali Loss: 0.904 Vali Acc: 0.590 Test Loss: 0.904 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2639856338500977
Epoch: 26, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.060 Vali Acc: 0.580 Test Loss: 1.060 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.196375846862793
Epoch: 27, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2913389205932617
Epoch: 28, Steps: 20 | Train Loss: 0.210 Vali Loss: 1.039 Vali Acc: 0.570 Test Loss: 1.039 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2524662017822266
Epoch: 29, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.127 Vali Acc: 0.590 Test Loss: 1.127 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3543164730072021
Epoch: 30, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 228482
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.175534963607788
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.3829281330108643
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.4916369915008545
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4346826076507568
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.743 Vali Acc: 0.520 Test Loss: 0.743 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.4787101745605469
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.218212366104126
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.3801617622375488
Epoch: 7, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3877968788146973
Epoch: 8, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4464244842529297
Epoch: 9, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.783 Vali Acc: 0.440 Test Loss: 0.783 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2871639728546143
Epoch: 10, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.803 Vali Acc: 0.450 Test Loss: 0.803 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3541429042816162
Epoch: 11, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 1.2289040088653564
Epoch: 12, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.861 Vali Acc: 0.490 Test Loss: 0.861 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3429956436157227
Epoch: 13, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.868 Vali Acc: 0.550 Test Loss: 0.868 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2691471576690674
Epoch: 14, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2539243698120117
Epoch: 15, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1822383403778076
Epoch: 16, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 17 cost time: 1.2192060947418213
Epoch: 17, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.456430196762085
Epoch: 18, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.924 Vali Acc: 0.530 Test Loss: 0.924 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.536217451095581
Epoch: 19, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2919037342071533
Epoch: 20, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.030 Vali Acc: 0.560 Test Loss: 1.030 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4606153964996338
Epoch: 21, Steps: 20 | Train Loss: 0.339 Vali Loss: 0.839 Vali Acc: 0.600 Test Loss: 0.839 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599992).  Saving model ...
Epoch: 22 cost time: 1.3463821411132812
Epoch: 22, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.027 Vali Acc: 0.540 Test Loss: 1.027 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3747098445892334
Epoch: 23, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.051 Vali Acc: 0.530 Test Loss: 1.051 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1839580535888672
Epoch: 24, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.391289234161377
Epoch: 25, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4384212493896484
Epoch: 26, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.416275978088379
Epoch: 27, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4886672496795654
Epoch: 28, Steps: 20 | Train Loss: 0.264 Vali Loss: 1.250 Vali Acc: 0.580 Test Loss: 1.250 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4035749435424805
Epoch: 29, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.377 Vali Acc: 0.560 Test Loss: 1.377 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.40189528465271
Epoch: 30, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.334 Vali Acc: 0.560 Test Loss: 1.334 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3624613285064697
Epoch: 31, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 228482
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.105955123901367
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.709 Vali Acc: 0.540 Test Loss: 0.709 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.18037748336792
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3872618675231934
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4836556911468506
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2979955673217773
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1685452461242676
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.740 Vali Acc: 0.570 Test Loss: 0.740 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 1.2545485496520996
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.251241683959961
Epoch: 8, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.815 Vali Acc: 0.550 Test Loss: 0.815 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1716790199279785
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2429723739624023
Epoch: 10, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2374887466430664
Epoch: 11, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.804 Vali Acc: 0.530 Test Loss: 0.804 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.164447546005249
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.218672513961792
Epoch: 13, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.957 Vali Acc: 0.550 Test Loss: 0.957 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2783722877502441
Epoch: 14, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3088469505310059
Epoch: 15, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3055105209350586
Epoch: 16, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.915 Vali Acc: 0.560 Test Loss: 0.915 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 589442
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2648699283599854
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.228332281112671
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3297886848449707
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1513264179229736
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2492012977600098
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1907522678375244
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.737 Vali Acc: 0.570 Test Loss: 0.737 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 1.3106648921966553
Epoch: 7, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2311522960662842
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1963541507720947
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2653391361236572
Epoch: 10, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.271235704421997
Epoch: 11, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3056650161743164
Epoch: 12, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.762 Vali Acc: 0.560 Test Loss: 0.762 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1990759372711182
Epoch: 13, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.894 Vali Acc: 0.560 Test Loss: 0.894 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1938774585723877
Epoch: 14, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.197045087814331
Epoch: 15, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2176685333251953
Epoch: 16, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.874 Vali Acc: 0.570 Test Loss: 0.874 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 589442
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2361347675323486
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.3769845962524414
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.236985445022583
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5918951034545898
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.753 Vali Acc: 0.450 Test Loss: 0.753 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4928295612335205
Epoch: 5, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4664883613586426
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 1.514784574508667
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.524766206741333
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3860859870910645
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5078160762786865
Epoch: 10, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.746 Vali Acc: 0.540 Test Loss: 0.746 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 11 cost time: 1.6409919261932373
Epoch: 11, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4092066287994385
Epoch: 12, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.780 Vali Acc: 0.490 Test Loss: 0.780 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5866050720214844
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.903 Vali Acc: 0.520 Test Loss: 0.903 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4059269428253174
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.781 Vali Acc: 0.550 Test Loss: 0.781 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 15 cost time: 1.2913644313812256
Epoch: 15, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3545114994049072
Epoch: 16, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.861 Vali Acc: 0.560 Test Loss: 0.861 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 17 cost time: 1.4012210369110107
Epoch: 17, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2550568580627441
Epoch: 18, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5346293449401855
Epoch: 19, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.416532278060913
Epoch: 20, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4366576671600342
Epoch: 21, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.819 Vali Acc: 0.520 Test Loss: 0.819 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3783457279205322
Epoch: 22, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.371934413909912
Epoch: 23, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2874419689178467
Epoch: 24, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.900 Vali Acc: 0.550 Test Loss: 0.900 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2814581394195557
Epoch: 25, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2243895530700684
Epoch: 26, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 589442
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9933550357818604
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2214360237121582
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4250054359436035
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.121182918548584
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.738 Vali Acc: 0.490 Test Loss: 0.738 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.183173656463623
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 1.196425437927246
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 7 cost time: 1.3991508483886719
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2906556129455566
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.2375843524932861
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.310293436050415
Epoch: 10, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2958471775054932
Epoch: 11, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2943291664123535
Epoch: 12, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1131267547607422
Epoch: 13, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 14 cost time: 1.1636734008789062
Epoch: 14, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.137519121170044
Epoch: 15, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.790 Vali Acc: 0.480 Test Loss: 0.790 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1325464248657227
Epoch: 16, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.860 Vali Acc: 0.480 Test Loss: 0.860 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1691207885742188
Epoch: 17, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.826 Vali Acc: 0.470 Test Loss: 0.826 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2049338817596436
Epoch: 18, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1824913024902344
Epoch: 19, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.23199462890625
Epoch: 20, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3143393993377686
Epoch: 21, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2433035373687744
Epoch: 22, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2984800338745117
Epoch: 23, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 589442
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.5219805240631104
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.36808180809021
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 1.2766249179840088
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3184468746185303
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.760 Vali Acc: 0.480 Test Loss: 0.760 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3712761402130127
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.256303310394287
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3085129261016846
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.299527645111084
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.726 Vali Acc: 0.540 Test Loss: 0.726 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.2488844394683838
Epoch: 9, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.333956241607666
Epoch: 10, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2182750701904297
Epoch: 11, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.796 Vali Acc: 0.460 Test Loss: 0.796 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.414618730545044
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1984519958496094
Epoch: 13, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1345469951629639
Epoch: 14, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2351868152618408
Epoch: 15, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.767 Vali Acc: 0.540 Test Loss: 0.767 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3175106048583984
Epoch: 16, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 1.16048002243042
Epoch: 17, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2662718296051025
Epoch: 18, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2932651042938232
Epoch: 19, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1898293495178223
Epoch: 20, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1964962482452393
Epoch: 21, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.795 Vali Acc: 0.540 Test Loss: 0.795 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3025827407836914
Epoch: 22, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1650638580322266
Epoch: 23, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.938 Vali Acc: 0.580 Test Loss: 0.938 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 24 cost time: 1.3050320148468018
Epoch: 24, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.836 Vali Acc: 0.550 Test Loss: 0.836 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3826584815979004
Epoch: 25, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4166147708892822
Epoch: 26, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4542014598846436
Epoch: 27, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2549312114715576
Epoch: 28, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.889 Vali Acc: 0.570 Test Loss: 0.889 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2632644176483154
Epoch: 29, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.902 Vali Acc: 0.540 Test Loss: 0.902 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1858594417572021
Epoch: 30, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.887 Vali Acc: 0.530 Test Loss: 0.887 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2034602165222168
Epoch: 31, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.028 Vali Acc: 0.540 Test Loss: 1.028 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2972803115844727
Epoch: 32, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.134 Vali Acc: 0.530 Test Loss: 1.134 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3464229106903076
Epoch: 33, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.945 Vali Acc: 0.470 Test Loss: 0.945 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 327298
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3506901264190674
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.721 Vali Acc: 0.430 Test Loss: 0.721 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.3045547008514404
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.429993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.3303554058074951
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 1.2359769344329834
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2859187126159668
Epoch: 5, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.171678066253662
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0845136642456055
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.176318645477295
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2120826244354248
Epoch: 9, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 1.2796659469604492
Epoch: 10, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.739 Vali Acc: 0.570 Test Loss: 0.739 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 11 cost time: 1.1752045154571533
Epoch: 11, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1989812850952148
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1587250232696533
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.41683030128479
Epoch: 14, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.783 Vali Acc: 0.490 Test Loss: 0.783 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2324423789978027
Epoch: 15, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2429170608520508
Epoch: 16, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.314655065536499
Epoch: 17, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2936127185821533
Epoch: 18, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2870473861694336
Epoch: 19, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.38006591796875
Epoch: 20, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 327298
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.137310266494751
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.713 Vali Acc: 0.430 Test Loss: 0.713 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.3957164287567139
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (-0.429993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.2027370929718018
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.757 Vali Acc: 0.530 Test Loss: 0.757 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2167518138885498
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.208904504776001
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.29097580909729
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.307677984237671
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2808489799499512
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 9 cost time: 1.2977681159973145
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.756 Vali Acc: 0.530 Test Loss: 0.756 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.233337163925171
Epoch: 10, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.2694244384765625
Epoch: 11, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.787 Vali Acc: 0.460 Test Loss: 0.787 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2436604499816895
Epoch: 12, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2855849266052246
Epoch: 13, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2323291301727295
Epoch: 14, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3075354099273682
Epoch: 15, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3060176372528076
Epoch: 16, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3545804023742676
Epoch: 17, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3703958988189697
Epoch: 18, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.809 Vali Acc: 0.530 Test Loss: 0.809 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2458868026733398
Epoch: 19, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.297698974609375
Epoch: 20, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.860 Vali Acc: 0.450 Test Loss: 0.860 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 327298
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4003591537475586
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.719 Vali Acc: 0.480 Test Loss: 0.719 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.3257465362548828
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.265653371810913
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3015615940093994
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.3062307834625244
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.177870273590088
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.352043867111206
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2060322761535645
Epoch: 8, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3355751037597656
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.205470323562622
Epoch: 10, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.325258731842041
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.802 Vali Acc: 0.450 Test Loss: 0.802 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.169670820236206
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.232478380203247
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.831 Vali Acc: 0.460 Test Loss: 0.831 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2343380451202393
Epoch: 14, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.829 Vali Acc: 0.470 Test Loss: 0.829 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 327298
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.4924657344818115
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.724 Vali Acc: 0.460 Test Loss: 0.724 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.261655569076538
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 1.1682612895965576
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2665379047393799
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2447774410247803
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.773 Vali Acc: 0.460 Test Loss: 0.773 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2931632995605469
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 1.2744016647338867
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.2482225894927979
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0839521884918213
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2259595394134521
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 1.3489246368408203
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.212843418121338
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.825 Vali Acc: 0.550 Test Loss: 0.825 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.376267671585083
Epoch: 13, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.983 Vali Acc: 0.490 Test Loss: 0.983 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3141274452209473
Epoch: 14, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.819 Vali Acc: 0.570 Test Loss: 0.819 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 1.2636818885803223
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.870 Vali Acc: 0.550 Test Loss: 0.870 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4067268371582031
Epoch: 16, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2593889236450195
Epoch: 17, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.804 Vali Acc: 0.480 Test Loss: 0.804 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2495989799499512
Epoch: 18, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.133798599243164
Epoch: 19, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3332362174987793
Epoch: 20, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.875 Vali Acc: 0.540 Test Loss: 0.875 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2577192783355713
Epoch: 21, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1407344341278076
Epoch: 22, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.208740472793579
Epoch: 23, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2199256420135498
Epoch: 24, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.840 Vali Acc: 0.530 Test Loss: 0.840 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 196226
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.154115676879883
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.730 Vali Acc: 0.410 Test Loss: 0.730 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 1.3319003582000732
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
Validation loss decreased (-0.409993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 1.272477626800537
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.770 Vali Acc: 0.430 Test Loss: 0.770 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4909532070159912
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3919811248779297
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.412240982055664
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.2319200038909912
Epoch: 7, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4719576835632324
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.382467269897461
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.792 Vali Acc: 0.470 Test Loss: 0.792 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4072973728179932
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3445992469787598
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 12 cost time: 1.3232669830322266
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4380507469177246
Epoch: 13, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3840878009796143
Epoch: 14, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4907941818237305
Epoch: 15, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.874 Vali Acc: 0.560 Test Loss: 0.874 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 16 cost time: 1.32444429397583
Epoch: 16, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3928112983703613
Epoch: 17, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.368852138519287
Epoch: 18, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1854541301727295
Epoch: 19, Steps: 20 | Train Loss: 0.497 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4063458442687988
Epoch: 20, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.264770746231079
Epoch: 21, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.221379280090332
Epoch: 22, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0934386253356934
Epoch: 23, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1388604640960693
Epoch: 24, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.124692440032959
Epoch: 25, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.829 Vali Acc: 0.510 Test Loss: 0.829 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 196226
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.102119207382202
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.2341880798339844
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2888703346252441
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2443671226501465
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
Validation loss decreased (-0.459993 --> -0.489992).  Saving model ...
Epoch: 5 cost time: 1.2927780151367188
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2759730815887451
Epoch: 6, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.2303214073181152
Epoch: 7, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0931034088134766
Epoch: 8, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.823 Vali Acc: 0.480 Test Loss: 0.823 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.214444637298584
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.787 Vali Acc: 0.450 Test Loss: 0.787 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2440636157989502
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.779 Vali Acc: 0.510 Test Loss: 0.779 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1913917064666748
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 12 cost time: 1.276291847229004
Epoch: 12, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2394130229949951
Epoch: 13, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3312716484069824
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2130751609802246
Epoch: 15, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.884 Vali Acc: 0.530 Test Loss: 0.884 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2134292125701904
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 17 cost time: 1.2093286514282227
Epoch: 17, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3175289630889893
Epoch: 18, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.948 Vali Acc: 0.530 Test Loss: 0.948 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2257893085479736
Epoch: 19, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.286870002746582
Epoch: 20, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.241741418838501
Epoch: 21, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.895 Vali Acc: 0.530 Test Loss: 0.895 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.204209804534912
Epoch: 22, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1399664878845215
Epoch: 23, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1545639038085938
Epoch: 24, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1450414657592773
Epoch: 25, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1576335430145264
Epoch: 26, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.963 Vali Acc: 0.490 Test Loss: 0.963 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 196226
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.996013879776001
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.717 Vali Acc: 0.430 Test Loss: 0.717 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 1.1521530151367188
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.767 Vali Acc: 0.440 Test Loss: 0.767 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439992).  Saving model ...
Epoch: 3 cost time: 1.171736240386963
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
Validation loss decreased (-0.439992 --> -0.449993).  Saving model ...
Epoch: 4 cost time: 1.2430734634399414
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
Validation loss decreased (-0.449993 --> -0.459992).  Saving model ...
Epoch: 5 cost time: 1.25319504737854
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
Validation loss decreased (-0.459992 --> -0.479992).  Saving model ...
Epoch: 6 cost time: 1.3040623664855957
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 7 cost time: 1.1717584133148193
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 1.395559310913086
Epoch: 8, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.799 Vali Acc: 0.510 Test Loss: 0.799 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2605483531951904
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.307119607925415
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.769 Vali Acc: 0.440 Test Loss: 0.769 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2883825302124023
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.739 Vali Acc: 0.520 Test Loss: 0.739 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 12 cost time: 1.1282188892364502
Epoch: 12, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.824 Vali Acc: 0.460 Test Loss: 0.824 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3856196403503418
Epoch: 13, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549991).  Saving model ...
Epoch: 14 cost time: 1.2587168216705322
Epoch: 14, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.815 Vali Acc: 0.500 Test Loss: 0.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2335364818572998
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.871 Vali Acc: 0.510 Test Loss: 0.871 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3230984210968018
Epoch: 16, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.808 Vali Acc: 0.510 Test Loss: 0.808 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3187296390533447
Epoch: 17, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.357652187347412
Epoch: 18, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.956 Vali Acc: 0.520 Test Loss: 0.956 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5121848583221436
Epoch: 19, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4113848209381104
Epoch: 20, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3804550170898438
Epoch: 21, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.423304796218872
Epoch: 22, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3790788650512695
Epoch: 23, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.822 Vali Acc: 0.510 Test Loss: 0.822 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 196226
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9493138790130615
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1186437606811523
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.755 Vali Acc: 0.450 Test Loss: 0.755 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2128479480743408
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.768 Vali Acc: 0.430 Test Loss: 0.768 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.05574369430542
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1318998336791992
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2988958358764648
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.1737358570098877
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.2626209259033203
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2720675468444824
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.807 Vali Acc: 0.560 Test Loss: 0.807 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.270183801651001
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2400412559509277
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.834 Vali Acc: 0.500 Test Loss: 0.834 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2534565925598145
Epoch: 12, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1437809467315674
Epoch: 13, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.158545732498169
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.833 Vali Acc: 0.540 Test Loss: 0.833 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1704449653625488
Epoch: 15, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2913055419921875
Epoch: 16, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.754 Vali Acc: 0.530 Test Loss: 0.754 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1263365745544434
Epoch: 17, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1457769870758057
Epoch: 18, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 19 cost time: 1.255241870880127
Epoch: 19, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 20 cost time: 1.1094343662261963
Epoch: 20, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1748762130737305
Epoch: 21, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0695033073425293
Epoch: 22, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.891 Vali Acc: 0.490 Test Loss: 0.891 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1688258647918701
Epoch: 23, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0947661399841309
Epoch: 24, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.015 Vali Acc: 0.580 Test Loss: 1.015 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2735023498535156
Epoch: 25, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.959 Vali Acc: 0.550 Test Loss: 0.959 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1314897537231445
Epoch: 26, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1450939178466797
Epoch: 27, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.903 Vali Acc: 0.520 Test Loss: 0.903 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1751163005828857
Epoch: 28, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1510028839111328
Epoch: 29, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.897 Vali Acc: 0.550 Test Loss: 0.897 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 130690
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2666878700256348
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.1934916973114014
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4202170372009277
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.761 Vali Acc: 0.450 Test Loss: 0.761 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3363838195800781
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3621442317962646
Epoch: 5, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3743352890014648
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 1.3740742206573486
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 1.404857873916626
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.860 Vali Acc: 0.520 Test Loss: 0.860 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3196890354156494
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.2571711540222168
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2987644672393799
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1592559814453125
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3700475692749023
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2976696491241455
Epoch: 14, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.403491735458374
Epoch: 15, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1445999145507812
Epoch: 16, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2909317016601562
Epoch: 17, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2403805255889893
Epoch: 18, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 19 cost time: 1.2865509986877441
Epoch: 19, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.773 Vali Acc: 0.570 Test Loss: 0.773 Test Acc: 0.570
Validation loss decreased (-0.569992 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 1.272751808166504
Epoch: 20, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.949 Vali Acc: 0.560 Test Loss: 0.949 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3115382194519043
Epoch: 21, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3136684894561768
Epoch: 22, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3844232559204102
Epoch: 23, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.424912929534912
Epoch: 24, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.013 Vali Acc: 0.580 Test Loss: 1.013 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579990).  Saving model ...
Epoch: 25 cost time: 1.2804968357086182
Epoch: 25, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.967 Vali Acc: 0.520 Test Loss: 0.967 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.367598533630371
Epoch: 26, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.887 Vali Acc: 0.520 Test Loss: 0.887 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.421790361404419
Epoch: 27, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4009227752685547
Epoch: 28, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.268716812133789
Epoch: 29, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.844 Vali Acc: 0.560 Test Loss: 0.844 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1950271129608154
Epoch: 30, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3187732696533203
Epoch: 31, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.945 Vali Acc: 0.530 Test Loss: 0.945 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.173274278640747
Epoch: 32, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.000 Vali Acc: 0.540 Test Loss: 1.000 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1677093505859375
Epoch: 33, Steps: 20 | Train Loss: 0.324 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2549631595611572
Epoch: 34, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 130690
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.995612144470215
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.691 Vali Acc: 0.560 Test Loss: 0.691 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.0224823951721191
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.735 Vali Acc: 0.430 Test Loss: 0.735 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0326240062713623
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.751 Vali Acc: 0.480 Test Loss: 0.751 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9888689517974854
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9690263271331787
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1548924446105957
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0691659450531006
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1094403266906738
Epoch: 8, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0958261489868164
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0361649990081787
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1162166595458984
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 130690
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0068862438201904
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.1480002403259277
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.734 Vali Acc: 0.480 Test Loss: 0.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.09621000289917
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1503636837005615
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.293274164199829
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.758 Vali Acc: 0.490 Test Loss: 0.758 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.146604061126709
Epoch: 6, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1147010326385498
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.1671419143676758
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.288905382156372
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0848441123962402
Epoch: 10, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1603403091430664
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.833 Vali Acc: 0.460 Test Loss: 0.833 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.233677864074707
Epoch: 12, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.163801908493042
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.789 Vali Acc: 0.580 Test Loss: 0.789 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 1.124514102935791
Epoch: 14, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2286779880523682
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0995421409606934
Epoch: 16, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.741 Vali Acc: 0.560 Test Loss: 0.741 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2992537021636963
Epoch: 17, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3665120601654053
Epoch: 18, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.221588134765625
Epoch: 19, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3439383506774902
Epoch: 20, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3743226528167725
Epoch: 21, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.793 Vali Acc: 0.510 Test Loss: 0.793 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2598261833190918
Epoch: 22, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.892 Vali Acc: 0.470 Test Loss: 0.892 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.296992301940918
Epoch: 23, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 130690
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.3687546253204346
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4012682437896729
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4504578113555908
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 1.428541660308838
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2504615783691406
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.765 Vali Acc: 0.450 Test Loss: 0.765 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2101733684539795
Epoch: 6, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.194854974746704
Epoch: 7, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1974129676818848
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2248446941375732
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 1.2371599674224854
Epoch: 10, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.838 Vali Acc: 0.560 Test Loss: 0.838 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2392148971557617
Epoch: 11, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 1.2669682502746582
Epoch: 12, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.141218662261963
Epoch: 13, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1715731620788574
Epoch: 14, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1459629535675049
Epoch: 15, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2711989879608154
Epoch: 16, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.159534215927124
Epoch: 17, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2487900257110596
Epoch: 18, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2564339637756348
Epoch: 19, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.883 Vali Acc: 0.560 Test Loss: 0.883 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2886579036712646
Epoch: 20, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2942683696746826
Epoch: 21, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.871 Vali Acc: 0.560 Test Loss: 0.871 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 97922
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2386763095855713
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 1.2041029930114746
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.2076632976531982
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.791 Vali Acc: 0.480 Test Loss: 0.791 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2058448791503906
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2563650608062744
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.209198236465454
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 1.0804061889648438
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1923182010650635
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1540164947509766
Epoch: 9, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.1437480449676514
Epoch: 10, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.824 Vali Acc: 0.600 Test Loss: 0.824 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599992).  Saving model ...
Epoch: 11 cost time: 1.250016689300537
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.824 Vali Acc: 0.560 Test Loss: 0.824 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1725749969482422
Epoch: 12, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.035050392150879
Epoch: 13, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.137521505355835
Epoch: 14, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2461018562316895
Epoch: 15, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0294756889343262
Epoch: 16, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0388638973236084
Epoch: 17, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.793 Vali Acc: 0.550 Test Loss: 0.793 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1508901119232178
Epoch: 18, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.823 Vali Acc: 0.580 Test Loss: 0.823 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1170527935028076
Epoch: 19, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.896 Vali Acc: 0.590 Test Loss: 0.896 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.292083501815796
Epoch: 20, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.907 Vali Acc: 0.450 Test Loss: 0.907 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 97922
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.205782413482666
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.1898131370544434
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.2718923091888428
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.252986192703247
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.775 Vali Acc: 0.490 Test Loss: 0.775 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2718183994293213
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.757 Vali Acc: 0.480 Test Loss: 0.757 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3876729011535645
Epoch: 6, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4484930038452148
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2860019207000732
Epoch: 8, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.745 Vali Acc: 0.490 Test Loss: 0.745 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.275529146194458
Epoch: 9, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2117927074432373
Epoch: 10, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 11 cost time: 1.1105594635009766
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1907737255096436
Epoch: 12, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.245797872543335
Epoch: 13, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.1397655010223389
Epoch: 14, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1374540328979492
Epoch: 15, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2299649715423584
Epoch: 16, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 17 cost time: 1.1521060466766357
Epoch: 17, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2544496059417725
Epoch: 18, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 19 cost time: 1.257366418838501
Epoch: 19, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.898 Vali Acc: 0.520 Test Loss: 0.898 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3808014392852783
Epoch: 20, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.888 Vali Acc: 0.460 Test Loss: 0.888 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2895543575286865
Epoch: 21, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3085055351257324
Epoch: 22, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3170459270477295
Epoch: 23, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3132669925689697
Epoch: 24, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.938 Vali Acc: 0.540 Test Loss: 0.938 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2656166553497314
Epoch: 25, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2757320404052734
Epoch: 26, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.908 Vali Acc: 0.540 Test Loss: 0.908 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2341454029083252
Epoch: 27, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2083520889282227
Epoch: 28, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.980 Vali Acc: 0.540 Test Loss: 0.980 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 97922
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.777750015258789
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 0.9600887298583984
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8826909065246582
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0150041580200195
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.767 Vali Acc: 0.470 Test Loss: 0.767 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9696493148803711
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1796376705169678
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.769 Vali Acc: 0.480 Test Loss: 0.769 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2635107040405273
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499993).  Saving model ...
Epoch: 8 cost time: 1.1936664581298828
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1773831844329834
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2079191207885742
Epoch: 10, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.827 Vali Acc: 0.530 Test Loss: 0.827 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529992).  Saving model ...
Epoch: 11 cost time: 1.1711854934692383
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.129181146621704
Epoch: 12, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.170403003692627
Epoch: 13, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 14 cost time: 1.1467976570129395
Epoch: 14, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1007091999053955
Epoch: 15, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.850 Vali Acc: 0.490 Test Loss: 0.850 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.126990556716919
Epoch: 16, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2236952781677246
Epoch: 17, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.137817621231079
Epoch: 18, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1861045360565186
Epoch: 19, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 1.2871384620666504
Epoch: 20, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.917 Vali Acc: 0.460 Test Loss: 0.917 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1525287628173828
Epoch: 21, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1306102275848389
Epoch: 22, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.865 Vali Acc: 0.560 Test Loss: 0.865 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2343077659606934
Epoch: 23, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1194040775299072
Epoch: 24, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.112574815750122
Epoch: 25, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.935 Vali Acc: 0.540 Test Loss: 0.935 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.130866289138794
Epoch: 26, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1248672008514404
Epoch: 27, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.12559175491333
Epoch: 28, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.949 Vali Acc: 0.580 Test Loss: 0.949 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579991).  Saving model ...
Epoch: 29 cost time: 1.1724681854248047
Epoch: 29, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.967 Vali Acc: 0.560 Test Loss: 0.967 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1212642192840576
Epoch: 30, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.961 Vali Acc: 0.520 Test Loss: 0.961 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.170330286026001
Epoch: 31, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.963 Vali Acc: 0.560 Test Loss: 0.963 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0648469924926758
Epoch: 32, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.200 Vali Acc: 0.530 Test Loss: 1.200 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2646312713623047
Epoch: 33, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.999 Vali Acc: 0.570 Test Loss: 0.999 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1961228847503662
Epoch: 34, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.281 Vali Acc: 0.540 Test Loss: 1.281 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1582167148590088
Epoch: 35, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1216297149658203
Epoch: 36, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2254769802093506
Epoch: 37, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.154 Vali Acc: 0.530 Test Loss: 1.154 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.231034278869629
Epoch: 38, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.129 Vali Acc: 0.550 Test Loss: 1.129 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 97922
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2222962379455566
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.2768728733062744
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 1.234494686126709
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.0421142578125
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2228882312774658
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1762564182281494
Epoch: 6, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1288907527923584
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1888747215270996
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1450884342193604
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2162129878997803
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.184349775314331
Epoch: 11, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2818737030029297
Epoch: 12, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.839 Vali Acc: 0.530 Test Loss: 0.839 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1431553363800049
Epoch: 13, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 81538
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2145066261291504
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.721 Vali Acc: 0.470 Test Loss: 0.721 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.1417245864868164
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 1.1405367851257324
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.734 Vali Acc: 0.510 Test Loss: 0.734 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.2130560874938965
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1737151145935059
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1604418754577637
Epoch: 6, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 1.1479759216308594
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2602300643920898
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2351486682891846
Epoch: 9, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 1.0897104740142822
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.769 Vali Acc: 0.450 Test Loss: 0.769 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2303354740142822
Epoch: 11, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2629454135894775
Epoch: 12, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2371017932891846
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1529943943023682
Epoch: 14, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1431841850280762
Epoch: 15, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0966770648956299
Epoch: 16, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0846383571624756
Epoch: 17, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.084160327911377
Epoch: 18, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0946104526519775
Epoch: 19, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 81538
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0803918838500977
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.1371760368347168
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.1347205638885498
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.731 Vali Acc: 0.510 Test Loss: 0.731 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1627087593078613
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2941038608551025
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.19366455078125
Epoch: 6, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2627549171447754
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1322505474090576
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2209386825561523
Epoch: 9, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 1.1202127933502197
Epoch: 10, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1908540725708008
Epoch: 11, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1929490566253662
Epoch: 12, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1208529472351074
Epoch: 13, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.179394006729126
Epoch: 14, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1923329830169678
Epoch: 15, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.115466594696045
Epoch: 16, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.821 Vali Acc: 0.550 Test Loss: 0.821 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2518224716186523
Epoch: 17, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1618151664733887
Epoch: 18, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.777 Vali Acc: 0.540 Test Loss: 0.777 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1855108737945557
Epoch: 19, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 81538
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9890613555908203
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.136767864227295
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1943368911743164
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1486999988555908
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.10146164894104
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.243823528289795
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1983482837677002
Epoch: 7, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1986474990844727
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3420062065124512
Epoch: 9, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.731 Vali Acc: 0.560 Test Loss: 0.731 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 10 cost time: 1.294273853302002
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2844429016113281
Epoch: 11, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3167822360992432
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.314589023590088
Epoch: 13, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3113369941711426
Epoch: 14, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1376049518585205
Epoch: 15, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3378944396972656
Epoch: 16, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4287517070770264
Epoch: 17, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2541484832763672
Epoch: 18, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.783 Vali Acc: 0.540 Test Loss: 0.783 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4109184741973877
Epoch: 19, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 81538
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.73504376411438
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.031033992767334
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.063114881515503
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.014117956161499
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.760 Vali Acc: 0.520 Test Loss: 0.760 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 1.0265681743621826
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.770 Vali Acc: 0.480 Test Loss: 0.770 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1224980354309082
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0922412872314453
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0391452312469482
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 1.145383596420288
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1497890949249268
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1856164932250977
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0496690273284912
Epoch: 12, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.05910325050354
Epoch: 13, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.185410499572754
Epoch: 14, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0433242321014404
Epoch: 15, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.01149320602417
Epoch: 16, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0700795650482178
Epoch: 17, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0231287479400635
Epoch: 18, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 19 cost time: 1.0676109790802002
Epoch: 19, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 20 cost time: 1.051360845565796
Epoch: 20, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0268917083740234
Epoch: 21, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0684947967529297
Epoch: 22, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.828 Vali Acc: 0.490 Test Loss: 0.828 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0730867385864258
Epoch: 23, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.800 Vali Acc: 0.480 Test Loss: 0.800 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0042243003845215
Epoch: 24, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0012216567993164
Epoch: 25, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0126681327819824
Epoch: 26, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0329396724700928
Epoch: 27, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1276826858520508
Epoch: 28, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2105507850646973
Epoch: 29, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 286594
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8171794414520264
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.718 Vali Acc: 0.470 Test Loss: 0.718 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.0761218070983887
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.732 Vali Acc: 0.460 Test Loss: 0.732 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.013059139251709
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.746 Vali Acc: 0.430 Test Loss: 0.746 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.06351900100708
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 1.2087218761444092
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.771 Vali Acc: 0.480 Test Loss: 0.771 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1345641613006592
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0099973678588867
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1782119274139404
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2849559783935547
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.006547212600708
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.762 Vali Acc: 0.460 Test Loss: 0.762 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0449151992797852
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9593358039855957
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.759 Vali Acc: 0.520 Test Loss: 0.759 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 1.059237003326416
Epoch: 13, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.777 Vali Acc: 0.490 Test Loss: 0.777 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0586533546447754
Epoch: 14, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1159329414367676
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1060748100280762
Epoch: 16, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0819947719573975
Epoch: 17, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.055523157119751
Epoch: 18, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 19 cost time: 1.0353989601135254
Epoch: 19, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.081221580505371
Epoch: 20, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1551949977874756
Epoch: 21, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.121830940246582
Epoch: 22, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1217522621154785
Epoch: 23, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.765 Vali Acc: 0.530 Test Loss: 0.765 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0602171421051025
Epoch: 24, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.008927583694458
Epoch: 25, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.008364200592041
Epoch: 26, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9997353553771973
Epoch: 27, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.816 Vali Acc: 0.530 Test Loss: 0.816 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9856574535369873
Epoch: 28, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 29 cost time: 1.062302589416504
Epoch: 29, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9998650550842285
Epoch: 30, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.788 Vali Acc: 0.580 Test Loss: 0.788 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579992).  Saving model ...
Epoch: 31 cost time: 1.019108533859253
Epoch: 31, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 32 cost time: 1.105041265487671
Epoch: 32, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0746464729309082
Epoch: 33, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1225087642669678
Epoch: 34, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.902 Vali Acc: 0.580 Test Loss: 0.902 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.081007957458496
Epoch: 35, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.873 Vali Acc: 0.550 Test Loss: 0.873 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.050917625427246
Epoch: 36, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.817 Vali Acc: 0.600 Test Loss: 0.817 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 37 cost time: 1.0641250610351562
Epoch: 37, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0378093719482422
Epoch: 38, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.846 Vali Acc: 0.570 Test Loss: 0.846 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0942161083221436
Epoch: 39, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.835 Vali Acc: 0.570 Test Loss: 0.835 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0346143245697021
Epoch: 40, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9829213619232178
Epoch: 41, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.889 Vali Acc: 0.610 Test Loss: 0.889 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609991).  Saving model ...
Epoch: 42 cost time: 1.007859706878662
Epoch: 42, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0174295902252197
Epoch: 43, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.891 Vali Acc: 0.580 Test Loss: 0.891 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9952454566955566
Epoch: 44, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.804 Vali Acc: 0.600 Test Loss: 0.804 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0388741493225098
Epoch: 45, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.035 Vali Acc: 0.520 Test Loss: 1.035 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0009615421295166
Epoch: 46, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0541706085205078
Epoch: 47, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.017 Vali Acc: 0.570 Test Loss: 1.017 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0401887893676758
Epoch: 48, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.009 Vali Acc: 0.570 Test Loss: 1.009 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1744394302368164
Epoch: 49, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.980 Vali Acc: 0.510 Test Loss: 0.980 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.063361644744873
Epoch: 50, Steps: 20 | Train Loss: 0.305 Vali Loss: 0.978 Vali Acc: 0.550 Test Loss: 0.978 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0307385921478271
Epoch: 51, Steps: 20 | Train Loss: 0.307 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 286594
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.688775062561035
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.040945053100586
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.726 Vali Acc: 0.530 Test Loss: 0.726 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.0294010639190674
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.056445598602295
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0644140243530273
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.754 Vali Acc: 0.460 Test Loss: 0.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0456821918487549
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.039832592010498
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.194674015045166
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1327996253967285
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1147966384887695
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.008167028427124
Epoch: 11, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0778367519378662
Epoch: 12, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 286594
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.943946123123169
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.0879409313201904
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.1563148498535156
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1769778728485107
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.1531908512115479
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0418341159820557
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.098806381225586
Epoch: 7, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 1.0726399421691895
Epoch: 8, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1723384857177734
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.744 Vali Acc: 0.440 Test Loss: 0.744 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0441420078277588
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0908198356628418
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0908331871032715
Epoch: 12, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0321555137634277
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0433986186981201
Epoch: 14, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1099975109100342
Epoch: 15, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 16 cost time: 1.0215260982513428
Epoch: 16, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.743 Vali Acc: 0.570 Test Loss: 0.743 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 1.11568021774292
Epoch: 17, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0393099784851074
Epoch: 18, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2379682064056396
Epoch: 19, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.713 Vali Acc: 0.580 Test Loss: 0.713 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 20 cost time: 1.1463193893432617
Epoch: 20, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.102670669555664
Epoch: 21, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1318936347961426
Epoch: 22, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0136725902557373
Epoch: 23, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0383665561676025
Epoch: 24, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1030817031860352
Epoch: 25, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1186432838439941
Epoch: 26, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0502128601074219
Epoch: 27, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2658195495605469
Epoch: 28, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.816 Vali Acc: 0.550 Test Loss: 0.816 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1243987083435059
Epoch: 29, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.822 Vali Acc: 0.520 Test Loss: 0.822 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 286594
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8464930057525635
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1087543964385986
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.165217399597168
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.066453456878662
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.061845302581787
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0927951335906982
Epoch: 6, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.115746021270752
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2026755809783936
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0551502704620361
Epoch: 9, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.053124189376831
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9805197715759277
Epoch: 11, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0060412883758545
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.015516996383667
Epoch: 13, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 155522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0121285915374756
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.696 Vali Acc: 0.480 Test Loss: 0.696 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.1055707931518555
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 1.0634996891021729
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0841736793518066
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.751 Vali Acc: 0.520 Test Loss: 0.751 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9878537654876709
Epoch: 5, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0112075805664062
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0079331398010254
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.049288272857666
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.736 Vali Acc: 0.480 Test Loss: 0.736 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9873430728912354
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9095213413238525
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9551188945770264
Epoch: 11, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.947460412979126
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 155522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8016343116760254
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.000520944595337
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.714 Vali Acc: 0.580 Test Loss: 0.714 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 0.9640727043151855
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.046196460723877
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.749 Vali Acc: 0.460 Test Loss: 0.749 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.012383222579956
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.020507574081421
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1470134258270264
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0565390586853027
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.730 Vali Acc: 0.460 Test Loss: 0.730 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.132129430770874
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.043306827545166
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.100801706314087
Epoch: 11, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.004525899887085
Epoch: 12, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.785 Vali Acc: 0.520 Test Loss: 0.785 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 155522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7595574855804443
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.692 Vali Acc: 0.510 Test Loss: 0.692 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 0.9063739776611328
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 0.985144853591919
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.719 Vali Acc: 0.470 Test Loss: 0.719 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9704587459564209
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.732 Vali Acc: 0.490 Test Loss: 0.732 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9554693698883057
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0607738494873047
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0156826972961426
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0551080703735352
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.713 Vali Acc: 0.440 Test Loss: 0.713 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0618383884429932
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.033982515335083
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.078113317489624
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9761369228363037
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 155522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8561437129974365
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9902558326721191
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.0194618701934814
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 1.013657808303833
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0902340412139893
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.755 Vali Acc: 0.570 Test Loss: 0.755 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 1.0942304134368896
Epoch: 6, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9731593132019043
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0502896308898926
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0985808372497559
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0173521041870117
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0693230628967285
Epoch: 11, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.015150547027588
Epoch: 12, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0798585414886475
Epoch: 13, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1679208278656006
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0363421440124512
Epoch: 15, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 89986
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.756052017211914
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.720 Vali Acc: 0.430 Test Loss: 0.720 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 0.9176912307739258
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
Validation loss decreased (-0.429993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 0.9949188232421875
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 0.9762375354766846
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9334259033203125
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9584081172943115
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9865391254425049
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9512820243835449
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9358515739440918
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9958646297454834
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9762935638427734
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.02876877784729
Epoch: 12, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9771506786346436
Epoch: 13, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 89986
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.950373649597168
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.720 Vali Acc: 0.490 Test Loss: 0.720 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9436092376708984
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 1.0926706790924072
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 1.1559224128723145
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.0999822616577148
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.744 Vali Acc: 0.550 Test Loss: 0.744 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0322282314300537
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1106455326080322
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.758 Vali Acc: 0.510 Test Loss: 0.758 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1041934490203857
Epoch: 8, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.782 Vali Acc: 0.480 Test Loss: 0.782 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.077406644821167
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1291091442108154
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0184288024902344
Epoch: 11, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0876922607421875
Epoch: 12, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9860408306121826
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0370123386383057
Epoch: 14, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 89986
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8615188598632812
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 0.9218330383300781
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
Validation loss decreased (-0.509993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 1.1488828659057617
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.714 Vali Acc: 0.540 Test Loss: 0.714 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0177526473999023
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9986732006072998
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0419909954071045
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9966013431549072
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0239126682281494
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0341711044311523
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0953385829925537
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0699419975280762
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.134866714477539
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 89986
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9189372062683105
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.704 Vali Acc: 0.540 Test Loss: 0.704 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.0789215564727783
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0397415161132812
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1068260669708252
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0178349018096924
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1059634685516357
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.772 Vali Acc: 0.460 Test Loss: 0.772 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.038646936416626
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.765 Vali Acc: 0.450 Test Loss: 0.765 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0280966758728027
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.764 Vali Acc: 0.490 Test Loss: 0.764 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.057034969329834
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0992517471313477
Epoch: 10, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.756 Vali Acc: 0.510 Test Loss: 0.756 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0487067699432373
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 57218
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.835562229156494
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.9903793334960938
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0210323333740234
Epoch: 3, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0541496276855469
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.757 Vali Acc: 0.450 Test Loss: 0.757 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0416176319122314
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.746 Vali Acc: 0.460 Test Loss: 0.746 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1213908195495605
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0111033916473389
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1141119003295898
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 9 cost time: 1.0183255672454834
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 10 cost time: 1.108973503112793
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0373115539550781
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0145790576934814
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0908076763153076
Epoch: 13, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0102171897888184
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 15 cost time: 1.1218795776367188
Epoch: 15, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.148557424545288
Epoch: 16, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0623915195465088
Epoch: 17, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 18 cost time: 1.0189094543457031
Epoch: 18, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0501391887664795
Epoch: 19, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1233232021331787
Epoch: 20, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.773 Vali Acc: 0.490 Test Loss: 0.773 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0572450160980225
Epoch: 21, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.853 Vali Acc: 0.560 Test Loss: 0.853 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 22 cost time: 1.0124506950378418
Epoch: 22, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569992).  Saving model ...
Epoch: 23 cost time: 1.0818281173706055
Epoch: 23, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0198004245758057
Epoch: 24, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.797 Vali Acc: 0.490 Test Loss: 0.797 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0068800449371338
Epoch: 25, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0997421741485596
Epoch: 26, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0767426490783691
Epoch: 27, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.820 Vali Acc: 0.490 Test Loss: 0.820 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9965736865997314
Epoch: 28, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0042603015899658
Epoch: 29, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.030165195465088
Epoch: 30, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.807 Vali Acc: 0.540 Test Loss: 0.807 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0639314651489258
Epoch: 31, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0934138298034668
Epoch: 32, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.855 Vali Acc: 0.540 Test Loss: 0.855 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 57218
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.804490804672241
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.699 Vali Acc: 0.560 Test Loss: 0.699 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.0964491367340088
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0418939590454102
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.727 Vali Acc: 0.550 Test Loss: 0.727 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0829377174377441
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0747041702270508
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0700318813323975
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.755 Vali Acc: 0.480 Test Loss: 0.755 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.034559965133667
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.101289987564087
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0852537155151367
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.057483434677124
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9839165210723877
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 57218
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8292343616485596
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9401686191558838
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.708 Vali Acc: 0.510 Test Loss: 0.708 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.067708969116211
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.078869104385376
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0917954444885254
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9465858936309814
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0028841495513916
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 0.9887843132019043
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0396902561187744
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0384933948516846
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.166102409362793
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1029458045959473
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0479459762573242
Epoch: 13, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.715 Vali Acc: 0.540 Test Loss: 0.715 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 14 cost time: 1.1093440055847168
Epoch: 14, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.726 Vali Acc: 0.580 Test Loss: 0.726 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579993).  Saving model ...
Epoch: 15 cost time: 1.1425776481628418
Epoch: 15, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.719 Vali Acc: 0.530 Test Loss: 0.719 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0472197532653809
Epoch: 16, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1601464748382568
Epoch: 17, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0173149108886719
Epoch: 18, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9712538719177246
Epoch: 19, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 20 cost time: 0.9894504547119141
Epoch: 20, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0241293907165527
Epoch: 21, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0324621200561523
Epoch: 22, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0397663116455078
Epoch: 23, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.726 Vali Acc: 0.580 Test Loss: 0.726 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9424822330474854
Epoch: 24, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.761 Vali Acc: 0.530 Test Loss: 0.761 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0275390148162842
Epoch: 25, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9881126880645752
Epoch: 26, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.758 Vali Acc: 0.600 Test Loss: 0.758 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 27 cost time: 0.9931323528289795
Epoch: 27, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9512603282928467
Epoch: 28, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.755 Vali Acc: 0.580 Test Loss: 0.755 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.106762170791626
Epoch: 29, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9916255474090576
Epoch: 30, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0414493083953857
Epoch: 31, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.793 Vali Acc: 0.580 Test Loss: 0.793 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.095611572265625
Epoch: 32, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0670206546783447
Epoch: 33, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.827 Vali Acc: 0.550 Test Loss: 0.827 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.017479658126831
Epoch: 34, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.823 Vali Acc: 0.620 Test Loss: 0.823 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 35 cost time: 1.0172457695007324
Epoch: 35, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.834 Vali Acc: 0.600 Test Loss: 0.834 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1168467998504639
Epoch: 36, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0657188892364502
Epoch: 37, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.889 Vali Acc: 0.590 Test Loss: 0.889 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3604655265808105
Epoch: 38, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.822 Vali Acc: 0.610 Test Loss: 0.822 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0416288375854492
Epoch: 39, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0959115028381348
Epoch: 40, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.923 Vali Acc: 0.580 Test Loss: 0.923 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0265812873840332
Epoch: 41, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1748645305633545
Epoch: 42, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.960 Vali Acc: 0.590 Test Loss: 0.960 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1173028945922852
Epoch: 43, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.939 Vali Acc: 0.530 Test Loss: 0.939 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0845673084259033
Epoch: 44, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.978 Vali Acc: 0.630 Test Loss: 0.978 Test Acc: 0.630
Validation loss decreased (-0.619992 --> -0.629990).  Saving model ...
Epoch: 45 cost time: 1.1347296237945557
Epoch: 45, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0091273784637451
Epoch: 46, Steps: 20 | Train Loss: 0.344 Vali Loss: 0.978 Vali Acc: 0.620 Test Loss: 0.978 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1229989528656006
Epoch: 47, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.914 Vali Acc: 0.630 Test Loss: 0.914 Test Acc: 0.630
Validation loss decreased (-0.629990 --> -0.629991).  Saving model ...
Epoch: 48 cost time: 0.9594721794128418
Epoch: 48, Steps: 20 | Train Loss: 0.297 Vali Loss: 0.947 Vali Acc: 0.610 Test Loss: 0.947 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0456905364990234
Epoch: 49, Steps: 20 | Train Loss: 0.307 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.013552188873291
Epoch: 50, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.036 Vali Acc: 0.580 Test Loss: 1.036 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.187018632888794
Epoch: 51, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.035 Vali Acc: 0.590 Test Loss: 1.035 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0942904949188232
Epoch: 52, Steps: 20 | Train Loss: 0.251 Vali Loss: 0.968 Vali Acc: 0.610 Test Loss: 0.968 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9975192546844482
Epoch: 53, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1161670684814453
Epoch: 54, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.086 Vali Acc: 0.560 Test Loss: 1.086 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1554903984069824
Epoch: 55, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.118 Vali Acc: 0.580 Test Loss: 1.118 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1188263893127441
Epoch: 56, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.063 Vali Acc: 0.620 Test Loss: 1.063 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1776375770568848
Epoch: 57, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.079 Vali Acc: 0.590 Test Loss: 1.079 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 57218
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9145915508270264
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.006681203842163
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
Validation loss decreased (-0.449993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 0.9943747520446777
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9649991989135742
Epoch: 4, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9993515014648438
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9707651138305664
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0522465705871582
Epoch: 7, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9977188110351562
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.026252031326294
Epoch: 9, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9525082111358643
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0551486015319824
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0041875839233398
Epoch: 12, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 40834
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.935572624206543
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.0595619678497314
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.153395414352417
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0355403423309326
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0853636264801025
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 1.0449910163879395
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.067566156387329
Epoch: 7, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.060652732849121
Epoch: 8, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0702741146087646
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0297009944915771
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0806095600128174
Epoch: 11, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1708719730377197
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.947319746017456
Epoch: 13, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.864 Vali Acc: 0.560 Test Loss: 0.864 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 14 cost time: 0.9774243831634521
Epoch: 14, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559992).  Saving model ...
Epoch: 15 cost time: 0.9257111549377441
Epoch: 15, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.841 Vali Acc: 0.470 Test Loss: 0.841 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9118649959564209
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.978888988494873
Epoch: 17, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9673051834106445
Epoch: 18, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 19 cost time: 1.1020328998565674
Epoch: 19, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.068315029144287
Epoch: 20, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0609655380249023
Epoch: 21, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1061286926269531
Epoch: 22, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9873406887054443
Epoch: 23, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9627926349639893
Epoch: 24, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1018269062042236
Epoch: 25, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9703531265258789
Epoch: 26, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559993).  Saving model ...
Epoch: 27 cost time: 1.049924612045288
Epoch: 27, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.140512466430664
Epoch: 28, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0243947505950928
Epoch: 29, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.879 Vali Acc: 0.530 Test Loss: 0.879 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.05291748046875
Epoch: 30, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.797 Vali Acc: 0.520 Test Loss: 0.797 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0919008255004883
Epoch: 31, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.024374008178711
Epoch: 32, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1077094078063965
Epoch: 33, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.783 Vali Acc: 0.560 Test Loss: 0.783 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0779907703399658
Epoch: 34, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0762972831726074
Epoch: 35, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.823 Vali Acc: 0.540 Test Loss: 0.823 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.099595308303833
Epoch: 36, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 40834
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8938982486724854
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.698 Vali Acc: 0.540 Test Loss: 0.698 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 1.0418639183044434
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0403475761413574
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.732 Vali Acc: 0.570 Test Loss: 0.732 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.0470952987670898
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.04569411277771
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0221316814422607
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0675129890441895
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.735 Vali Acc: 0.550 Test Loss: 0.735 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0458621978759766
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0090851783752441
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.737 Vali Acc: 0.470 Test Loss: 0.737 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9453327655792236
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9833717346191406
Epoch: 11, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.755 Vali Acc: 0.470 Test Loss: 0.755 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.049971580505371
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0130634307861328
Epoch: 13, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 40834
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.147583484649658
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.0739691257476807
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.710 Vali Acc: 0.470 Test Loss: 0.710 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0337185859680176
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0230591297149658
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 5 cost time: 1.0974595546722412
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0151782035827637
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0952203273773193
Epoch: 7, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0236265659332275
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 9 cost time: 1.091219186782837
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0590019226074219
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.020003080368042
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1058945655822754
Epoch: 12, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0960302352905273
Epoch: 13, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.794 Vali Acc: 0.540 Test Loss: 0.794 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.0785636901855469
Epoch: 14, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 15 cost time: 1.0464208126068115
Epoch: 15, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.067014455795288
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1275074481964111
Epoch: 17, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0026171207427979
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0037100315093994
Epoch: 19, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.016733169555664
Epoch: 20, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 21 cost time: 1.1015369892120361
Epoch: 21, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.083672046661377
Epoch: 22, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.731 Vali Acc: 0.540 Test Loss: 0.731 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0148646831512451
Epoch: 23, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1117291450500488
Epoch: 24, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1358568668365479
Epoch: 25, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1059699058532715
Epoch: 26, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0111925601959229
Epoch: 27, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0750675201416016
Epoch: 28, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.168086051940918
Epoch: 29, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.847 Vali Acc: 0.560 Test Loss: 0.847 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1524553298950195
Epoch: 30, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 31 cost time: 1.0487680435180664
Epoch: 31, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0155694484710693
Epoch: 32, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.876 Vali Acc: 0.570 Test Loss: 0.876 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.188528299331665
Epoch: 33, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2011373043060303
Epoch: 34, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0747206211090088
Epoch: 35, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.797 Vali Acc: 0.530 Test Loss: 0.797 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0758874416351318
Epoch: 36, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.886 Vali Acc: 0.540 Test Loss: 0.886 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0962376594543457
Epoch: 37, Steps: 20 | Train Loss: 0.416 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1440606117248535
Epoch: 38, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.824 Vali Acc: 0.580 Test Loss: 0.824 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 39 cost time: 1.145658254623413
Epoch: 39, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.881 Vali Acc: 0.510 Test Loss: 0.881 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.060154676437378
Epoch: 40, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.864 Vali Acc: 0.580 Test Loss: 0.864 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1434969902038574
Epoch: 41, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.098017930984497
Epoch: 42, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.865 Vali Acc: 0.590 Test Loss: 0.865 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 43 cost time: 1.056525468826294
Epoch: 43, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.991 Vali Acc: 0.570 Test Loss: 0.991 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1038689613342285
Epoch: 44, Steps: 20 | Train Loss: 0.330 Vali Loss: 0.905 Vali Acc: 0.580 Test Loss: 0.905 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.943429708480835
Epoch: 45, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599990).  Saving model ...
Epoch: 46 cost time: 1.0460312366485596
Epoch: 46, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.009 Vali Acc: 0.570 Test Loss: 1.009 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0479485988616943
Epoch: 47, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.060 Vali Acc: 0.560 Test Loss: 1.060 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9981920719146729
Epoch: 48, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.061 Vali Acc: 0.570 Test Loss: 1.061 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9535443782806396
Epoch: 49, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.995586633682251
Epoch: 50, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.031 Vali Acc: 0.540 Test Loss: 1.031 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9927284717559814
Epoch: 51, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.148 Vali Acc: 0.530 Test Loss: 1.148 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9708952903747559
Epoch: 52, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0086729526519775
Epoch: 53, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.158 Vali Acc: 0.560 Test Loss: 1.158 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1046242713928223
Epoch: 54, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.172 Vali Acc: 0.550 Test Loss: 1.172 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9252688884735107
Epoch: 55, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 40834
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8033156394958496
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.719 Vali Acc: 0.490 Test Loss: 0.719 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9269118309020996
Epoch: 2, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0023772716522217
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 0.9531042575836182
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9350242614746094
Epoch: 5, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.763 Vali Acc: 0.520 Test Loss: 0.763 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 6 cost time: 1.0445044040679932
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9935171604156494
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.804 Vali Acc: 0.450 Test Loss: 0.804 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9357998371124268
Epoch: 8, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0206117630004883
Epoch: 9, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0967686176300049
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0141844749450684
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1825838088989258
Epoch: 12, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.794 Vali Acc: 0.480 Test Loss: 0.794 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0336804389953613
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.20371413230896
Epoch: 14, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.798 Vali Acc: 0.490 Test Loss: 0.798 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0000698566436768
Epoch: 15, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.799 Vali Acc: 0.470 Test Loss: 0.799 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 32642
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1010582447052
Epoch: 1, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.700 Vali Acc: 0.530 Test Loss: 0.700 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 1.1879944801330566
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2449569702148438
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2055940628051758
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.188685417175293
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.088270664215088
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.765 Vali Acc: 0.510 Test Loss: 0.765 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1648509502410889
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1049222946166992
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1857752799987793
Epoch: 9, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.076395034790039
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.765 Vali Acc: 0.490 Test Loss: 0.765 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1417737007141113
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 32642
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0044333934783936
Epoch: 1, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 1.0039265155792236
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9680092334747314
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.726 Vali Acc: 0.510 Test Loss: 0.726 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.964465856552124
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.0596349239349365
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0612282752990723
Epoch: 6, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0713074207305908
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1816234588623047
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.003340721130371
Epoch: 9, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.767 Vali Acc: 0.430 Test Loss: 0.767 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.068603515625
Epoch: 10, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.771 Vali Acc: 0.490 Test Loss: 0.771 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9687557220458984
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9361248016357422
Epoch: 12, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.766 Vali Acc: 0.490 Test Loss: 0.766 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0380120277404785
Epoch: 13, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0892813205718994
Epoch: 14, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.766 Vali Acc: 0.470 Test Loss: 0.766 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 32642
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8137879371643066
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.9923171997070312
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.702 Vali Acc: 0.520 Test Loss: 0.702 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9357478618621826
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9448239803314209
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.715 Vali Acc: 0.510 Test Loss: 0.715 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.969841480255127
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.728 Vali Acc: 0.530 Test Loss: 0.728 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8817691802978516
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8913805484771729
Epoch: 7, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.961754560470581
Epoch: 8, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.728 Vali Acc: 0.510 Test Loss: 0.728 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0924687385559082
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0423917770385742
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9995191097259521
Epoch: 11, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 32642
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8948585987091064
Epoch: 1, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.0111744403839111
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0631482601165771
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 1.2025351524353027
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.748 Vali Acc: 0.440 Test Loss: 0.748 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9790418148040771
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.763 Vali Acc: 0.430 Test Loss: 0.763 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2351405620574951
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.767 Vali Acc: 0.440 Test Loss: 0.767 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9881260395050049
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.768 Vali Acc: 0.450 Test Loss: 0.768 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.077651023864746
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.765 Vali Acc: 0.470 Test Loss: 0.765 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9867656230926514
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.769 Vali Acc: 0.420 Test Loss: 0.769 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9835619926452637
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.769 Vali Acc: 0.440 Test Loss: 0.769 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0757200717926025
Epoch: 11, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.761 Vali Acc: 0.470 Test Loss: 0.761 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0331454277038574
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.047292947769165
Epoch: 13, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 14 cost time: 1.010770320892334
Epoch: 14, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.788 Vali Acc: 0.460 Test Loss: 0.788 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9510467052459717
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9886441230773926
Epoch: 16, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9979419708251953
Epoch: 17, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 18 cost time: 0.9740750789642334
Epoch: 18, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9521365165710449
Epoch: 19, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1584970951080322
Epoch: 20, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9882411956787109
Epoch: 21, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.006291151046753
Epoch: 22, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0781714916229248
Epoch: 23, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.211282730102539
Epoch: 24, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1122844219207764
Epoch: 25, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1690847873687744
Epoch: 26, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.041379451751709
Epoch: 27, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 141314
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0505356788635254
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 0.967214822769165
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.727 Vali Acc: 0.510 Test Loss: 0.727 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 0.997779369354248
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9659326076507568
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9893512725830078
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9764058589935303
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.759 Vali Acc: 0.470 Test Loss: 0.759 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0174915790557861
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1107757091522217
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.099437952041626
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.762 Vali Acc: 0.470 Test Loss: 0.762 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0469059944152832
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0309441089630127
Epoch: 11, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0957019329071045
Epoch: 12, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 13 cost time: 0.9627466201782227
Epoch: 13, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0455338954925537
Epoch: 14, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0241975784301758
Epoch: 15, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1611425876617432
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1802892684936523
Epoch: 17, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 18 cost time: 1.0835165977478027
Epoch: 18, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9737646579742432
Epoch: 19, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 20 cost time: 1.0271317958831787
Epoch: 20, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0015466213226318
Epoch: 21, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0395102500915527
Epoch: 22, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.093888759613037
Epoch: 23, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1127572059631348
Epoch: 24, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1559700965881348
Epoch: 25, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.776 Vali Acc: 0.520 Test Loss: 0.776 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0906274318695068
Epoch: 26, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0427403450012207
Epoch: 27, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0570738315582275
Epoch: 28, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.005492925643921
Epoch: 29, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 141314
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.790430784225464
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.9573383331298828
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 0.9559347629547119
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0489673614501953
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0834696292877197
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0133697986602783
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.08542799949646
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.767 Vali Acc: 0.450 Test Loss: 0.767 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3278954029083252
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2458572387695312
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.776 Vali Acc: 0.470 Test Loss: 0.776 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9958107471466064
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.054264783859253
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9952681064605713
Epoch: 12, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.762 Vali Acc: 0.480 Test Loss: 0.762 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 141314
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.135605573654175
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 1.1038522720336914
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
Validation loss decreased (-0.489993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 1.0949032306671143
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.095682144165039
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9449241161346436
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1049580574035645
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0477211475372314
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.036133050918579
Epoch: 8, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0630452632904053
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.746 Vali Acc: 0.440 Test Loss: 0.746 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0488216876983643
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.103346824645996
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.737 Vali Acc: 0.430 Test Loss: 0.737 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1157209873199463
Epoch: 12, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.740 Vali Acc: 0.420 Test Loss: 0.740 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 141314
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.2863738536834717
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.693 Vali Acc: 0.470 Test Loss: 0.693 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.1751980781555176
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.702 Vali Acc: 0.430 Test Loss: 0.702 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.097015142440796
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.711 Vali Acc: 0.430 Test Loss: 0.711 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1172800064086914
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1901702880859375
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0564451217651367
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1782817840576172
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0977671146392822
Epoch: 8, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0654065608978271
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.749 Vali Acc: 0.450 Test Loss: 0.749 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1280577182769775
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1305530071258545
Epoch: 11, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.736 Vali Acc: 0.440 Test Loss: 0.736 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.47
model parameter : 75778
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7928295135498047
Epoch: 1, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.683 Vali Acc: 0.520 Test Loss: 0.683 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9263949394226074
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.691 Vali Acc: 0.480 Test Loss: 0.691 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9489257335662842
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9592297077178955
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.064821481704712
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0575292110443115
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.720 Vali Acc: 0.460 Test Loss: 0.720 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0971901416778564
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.726 Vali Acc: 0.450 Test Loss: 0.726 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0791215896606445
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.091031789779663
Epoch: 9, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1015279293060303
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.731 Vali Acc: 0.450 Test Loss: 0.731 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0941176414489746
Epoch: 11, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.724 Vali Acc: 0.470 Test Loss: 0.724 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 75778
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.169917583465576
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.700 Vali Acc: 0.490 Test Loss: 0.700 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 0.9854426383972168
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.705 Vali Acc: 0.460 Test Loss: 0.705 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1261417865753174
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.714 Vali Acc: 0.420 Test Loss: 0.714 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0891914367675781
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.738 Vali Acc: 0.420 Test Loss: 0.738 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0608885288238525
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.736 Vali Acc: 0.430 Test Loss: 0.736 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0901298522949219
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.735 Vali Acc: 0.450 Test Loss: 0.735 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9908769130706787
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.742 Vali Acc: 0.440 Test Loss: 0.742 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0611515045166016
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.750 Vali Acc: 0.440 Test Loss: 0.750 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9457790851593018
Epoch: 9, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1327271461486816
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1177573204040527
Epoch: 11, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 75778
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.1498444080352783
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.699 Vali Acc: 0.470 Test Loss: 0.699 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.0983378887176514
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0009453296661377
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.712 Vali Acc: 0.510 Test Loss: 0.712 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 1.1175181865692139
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0583853721618652
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0102972984313965
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1265692710876465
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.731 Vali Acc: 0.470 Test Loss: 0.731 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1330037117004395
Epoch: 8, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1653130054473877
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1374139785766602
Epoch: 10, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.740 Vali Acc: 0.420 Test Loss: 0.740 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1508686542510986
Epoch: 11, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.163924217224121
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.746 Vali Acc: 0.410 Test Loss: 0.746 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1534485816955566
Epoch: 13, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 75778
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.726996898651123
Epoch: 1, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.723 Vali Acc: 0.480 Test Loss: 0.723 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 1.119516372680664
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.059438943862915
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.746 Vali Acc: 0.490 Test Loss: 0.746 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.062727928161621
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.747 Vali Acc: 0.460 Test Loss: 0.747 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1016206741333008
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1570613384246826
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1069426536560059
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.765 Vali Acc: 0.450 Test Loss: 0.765 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.114699125289917
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0801358222961426
Epoch: 9, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0673143863677979
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1148536205291748
Epoch: 11, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0718488693237305
Epoch: 12, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 43010
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.840407609939575
Epoch: 1, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.709 Vali Acc: 0.520 Test Loss: 0.709 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.0673832893371582
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.716 Vali Acc: 0.550 Test Loss: 0.716 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.0061218738555908
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9613959789276123
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9187285900115967
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9916520118713379
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.730 Vali Acc: 0.540 Test Loss: 0.730 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9817030429840088
Epoch: 7, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9630095958709717
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1187186241149902
Epoch: 9, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0476481914520264
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9910917282104492
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0372629165649414
Epoch: 12, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.731 Vali Acc: 0.520 Test Loss: 0.731 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 43010
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.9308431148529053
Epoch: 1, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.700 Vali Acc: 0.570 Test Loss: 0.700 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 0.9710464477539062
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0172419548034668
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0398943424224854
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.020308494567871
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0955076217651367
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0528616905212402
Epoch: 7, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1262030601501465
Epoch: 8, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0350959300994873
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9753968715667725
Epoch: 10, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0016283988952637
Epoch: 11, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 43010
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.644798755645752
Epoch: 1, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 1.0173003673553467
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0610864162445068
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.710 Vali Acc: 0.540 Test Loss: 0.710 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0782628059387207
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1225776672363281
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0637857913970947
Epoch: 6, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0919687747955322
Epoch: 7, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1263794898986816
Epoch: 8, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0398879051208496
Epoch: 9, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0907318592071533
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0557341575622559
Epoch: 11, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.725 Vali Acc: 0.560 Test Loss: 0.725 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 43010
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.0637528896331787
Epoch: 1, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.0980052947998047
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.154017686843872
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.723 Vali Acc: 0.490 Test Loss: 0.723 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1360290050506592
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.450 Test Loss: 0.737 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.044813871383667
Epoch: 5, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.752 Vali Acc: 0.440 Test Loss: 0.752 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0637092590332031
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0383667945861816
Epoch: 7, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1386616230010986
Epoch: 8, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.769 Vali Acc: 0.440 Test Loss: 0.769 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0906651020050049
Epoch: 9, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0746831893920898
Epoch: 10, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9435997009277344
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 26626
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7686166763305664
Epoch: 1, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.709 Vali Acc: 0.440 Test Loss: 0.709 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 1.0246145725250244
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.006272554397583
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0810048580169678
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0585346221923828
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.749 Vali Acc: 0.450 Test Loss: 0.749 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1619625091552734
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.743 Vali Acc: 0.470 Test Loss: 0.743 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1159446239471436
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.05324125289917
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0763776302337646
Epoch: 9, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1200573444366455
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.775 Vali Acc: 0.420 Test Loss: 0.775 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.01242995262146
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0522162914276123
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.772 Vali Acc: 0.460 Test Loss: 0.772 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 26626
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.018630027770996
Epoch: 1, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.703 Vali Acc: 0.520 Test Loss: 0.703 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9798107147216797
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9969394207000732
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0886545181274414
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 1.1188316345214844
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0578339099884033
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0254590511322021
Epoch: 7, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0981090068817139
Epoch: 8, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.039299488067627
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0652103424072266
Epoch: 10, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9107072353363037
Epoch: 11, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0271377563476562
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0467181205749512
Epoch: 13, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0728371143341064
Epoch: 14, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.750 Vali Acc: 0.530 Test Loss: 0.750 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0410077571868896
Epoch: 15, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9975855350494385
Epoch: 16, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 17 cost time: 1.1443779468536377
Epoch: 17, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.817 Vali Acc: 0.490 Test Loss: 0.817 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1601855754852295
Epoch: 18, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.769 Vali Acc: 0.550 Test Loss: 0.769 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.119023084640503
Epoch: 19, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.795 Vali Acc: 0.490 Test Loss: 0.795 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1861422061920166
Epoch: 20, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.066236972808838
Epoch: 21, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.800 Vali Acc: 0.520 Test Loss: 0.800 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1958718299865723
Epoch: 22, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0241882801055908
Epoch: 23, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.809 Vali Acc: 0.540 Test Loss: 0.809 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0069255828857422
Epoch: 24, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1367955207824707
Epoch: 25, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.772 Vali Acc: 0.570 Test Loss: 0.772 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 26 cost time: 1.1212599277496338
Epoch: 26, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.040534257888794
Epoch: 27, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0705480575561523
Epoch: 28, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1988914012908936
Epoch: 29, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1252849102020264
Epoch: 30, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1150012016296387
Epoch: 31, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.850 Vali Acc: 0.530 Test Loss: 0.850 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0528430938720703
Epoch: 32, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0536606311798096
Epoch: 33, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.032897710800171
Epoch: 34, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0397133827209473
Epoch: 35, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 26626
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.915562152862549
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9672646522521973
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9700973033905029
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 0.9697904586791992
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.719 Vali Acc: 0.510 Test Loss: 0.719 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0113306045532227
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0583033561706543
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.732 Vali Acc: 0.420 Test Loss: 0.732 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0191426277160645
Epoch: 7, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.737 Vali Acc: 0.420 Test Loss: 0.737 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0305864810943604
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1734216213226318
Epoch: 9, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.751 Vali Acc: 0.430 Test Loss: 0.751 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0711166858673096
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0759553909301758
Epoch: 11, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.755 Vali Acc: 0.420 Test Loss: 0.755 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1142947673797607
Epoch: 12, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.756 Vali Acc: 0.440 Test Loss: 0.756 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1363027095794678
Epoch: 13, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.761 Vali Acc: 0.450 Test Loss: 0.761 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 26626
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.7326300144195557
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.729 Vali Acc: 0.460 Test Loss: 0.729 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 1.054288625717163
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
Validation loss decreased (-0.459993 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 1.0759174823760986
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.738 Vali Acc: 0.470 Test Loss: 0.738 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 0.9719281196594238
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.744 Vali Acc: 0.420 Test Loss: 0.744 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0195088386535645
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.756 Vali Acc: 0.430 Test Loss: 0.756 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.148212194442749
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 7 cost time: 0.9625229835510254
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.758 Vali Acc: 0.450 Test Loss: 0.758 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9866945743560791
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.758 Vali Acc: 0.440 Test Loss: 0.758 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.051347017288208
Epoch: 9, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.775 Vali Acc: 0.430 Test Loss: 0.775 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0524253845214844
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 11 cost time: 1.1795005798339844
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1146085262298584
Epoch: 12, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 13 cost time: 1.0859935283660889
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 1.0130517482757568
Epoch: 14, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.089714527130127
Epoch: 15, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1357402801513672
Epoch: 16, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.064406156539917
Epoch: 17, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.08237624168396
Epoch: 18, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9427876472473145
Epoch: 19, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0137176513671875
Epoch: 20, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0293402671813965
Epoch: 21, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0075523853302002
Epoch: 22, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0604968070983887
Epoch: 23, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 18434
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.729740858078003
Epoch: 1, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.725 Vali Acc: 0.420 Test Loss: 0.725 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 0.9861998558044434
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
Validation loss decreased (-0.419993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 0.9603056907653809
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0687241554260254
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9942009449005127
Epoch: 5, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.028942584991455
Epoch: 6, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0842885971069336
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.754 Vali Acc: 0.470 Test Loss: 0.754 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0421769618988037
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0742912292480469
Epoch: 9, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.764 Vali Acc: 0.470 Test Loss: 0.764 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0705182552337646
Epoch: 10, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 1.047924280166626
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0755927562713623
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.739 Vali Acc: 0.550 Test Loss: 0.739 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549993).  Saving model ...
Epoch: 13 cost time: 1.0583252906799316
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0534579753875732
Epoch: 14, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0360422134399414
Epoch: 15, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0694057941436768
Epoch: 16, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9387941360473633
Epoch: 17, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.753 Vali Acc: 0.560 Test Loss: 0.753 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 18 cost time: 0.995429277420044
Epoch: 18, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.772 Vali Acc: 0.530 Test Loss: 0.772 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0761680603027344
Epoch: 19, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0719916820526123
Epoch: 20, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.035942554473877
Epoch: 21, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.034209966659546
Epoch: 22, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0551443099975586
Epoch: 23, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0562491416931152
Epoch: 24, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.765 Vali Acc: 0.480 Test Loss: 0.765 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0676558017730713
Epoch: 25, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1356139183044434
Epoch: 26, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.077836513519287
Epoch: 27, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 18434
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.937392234802246
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.460 Test Loss: 0.722 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 0.9876375198364258
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9966111183166504
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.734 Vali Acc: 0.460 Test Loss: 0.734 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0225534439086914
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
Validation loss decreased (-0.459993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 1.040457010269165
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1007959842681885
Epoch: 6, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0025334358215332
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0828819274902344
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9679286479949951
Epoch: 9, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.769 Vali Acc: 0.470 Test Loss: 0.769 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0539276599884033
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.760 Vali Acc: 0.510 Test Loss: 0.760 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0465364456176758
Epoch: 11, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.982656717300415
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0868630409240723
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0601298809051514
Epoch: 14, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 18434
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.902897596359253
Epoch: 1, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 0.9372363090515137
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.710 Vali Acc: 0.480 Test Loss: 0.710 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0153913497924805
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9206445217132568
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9628324508666992
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9749042987823486
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0377459526062012
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0732898712158203
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9514057636260986
Epoch: 9, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0100877285003662
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.067763328552246
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 18434
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.00290846824646
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.180281162261963
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.079578161239624
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1057078838348389
Epoch: 4, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 1.0374221801757812
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.733 Vali Acc: 0.460 Test Loss: 0.733 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0906472206115723
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1150307655334473
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.744 Vali Acc: 0.490 Test Loss: 0.744 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.089918851852417
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.063899040222168
Epoch: 9, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0694096088409424
Epoch: 10, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.758 Vali Acc: 0.430 Test Loss: 0.758 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0537800788879395
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.035158634185791
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.092599868774414
Epoch: 13, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1209805011749268
Epoch: 14, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.746 Vali Acc: 0.470 Test Loss: 0.746 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 14338
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.870844602584839
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.701 Vali Acc: 0.450 Test Loss: 0.701 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.0472805500030518
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 1.0551660060882568
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9567768573760986
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.722 Vali Acc: 0.490 Test Loss: 0.722 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.066793441772461
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.728 Vali Acc: 0.480 Test Loss: 0.728 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0173261165618896
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 1.0186984539031982
Epoch: 7, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.460 Test Loss: 0.735 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9740886688232422
Epoch: 8, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.741 Vali Acc: 0.450 Test Loss: 0.741 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.01934814453125
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.033609390258789
Epoch: 10, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.749 Vali Acc: 0.480 Test Loss: 0.749 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.055879831314087
Epoch: 11, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 12 cost time: 1.0002350807189941
Epoch: 12, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0276777744293213
Epoch: 13, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 14 cost time: 0.9727728366851807
Epoch: 14, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.089900016784668
Epoch: 15, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.735 Vali Acc: 0.470 Test Loss: 0.735 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.040527582168579
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0644330978393555
Epoch: 17, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.776 Vali Acc: 0.460 Test Loss: 0.776 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0515108108520508
Epoch: 18, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 19 cost time: 1.090278148651123
Epoch: 19, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0613903999328613
Epoch: 20, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1000604629516602
Epoch: 21, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0225203037261963
Epoch: 22, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0823917388916016
Epoch: 23, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.735 Vali Acc: 0.490 Test Loss: 0.735 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.071842908859253
Epoch: 24, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.016519546508789
Epoch: 25, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 26 cost time: 1.0453176498413086
Epoch: 26, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0719695091247559
Epoch: 27, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559993).  Saving model ...
Epoch: 28 cost time: 1.0342602729797363
Epoch: 28, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0469114780426025
Epoch: 29, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.006232500076294
Epoch: 30, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.763 Vali Acc: 0.570 Test Loss: 0.763 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 31 cost time: 1.0313186645507812
Epoch: 31, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.755 Vali Acc: 0.510 Test Loss: 0.755 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0102767944335938
Epoch: 32, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0238597393035889
Epoch: 33, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0005688667297363
Epoch: 34, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0125458240509033
Epoch: 35, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0457141399383545
Epoch: 36, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0255742073059082
Epoch: 37, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0387554168701172
Epoch: 38, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0130033493041992
Epoch: 39, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.784 Vali Acc: 0.520 Test Loss: 0.784 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9073991775512695
Epoch: 40, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 14338
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 2.8197579383850098
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.706 Vali Acc: 0.470 Test Loss: 0.706 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 1.1092734336853027
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 1.145937204360962
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8546938896179199
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.724 Vali Acc: 0.490 Test Loss: 0.724 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0412418842315674
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.733 Vali Acc: 0.490 Test Loss: 0.733 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0364441871643066
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0510640144348145
Epoch: 7, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.739 Vali Acc: 0.470 Test Loss: 0.739 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9844505786895752
Epoch: 8, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1005287170410156
Epoch: 9, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0001354217529297
Epoch: 10, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.753 Vali Acc: 0.510 Test Loss: 0.753 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9568326473236084
Epoch: 11, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.726 Vali Acc: 0.490 Test Loss: 0.726 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9108133316040039
Epoch: 12, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 14338
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
>>>>>>>start training : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 3.184300184249878
Epoch: 1, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.0963542461395264
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2115800380706787
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2081387042999268
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0513181686401367
Epoch: 5, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3016035556793213
Epoch: 6, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.737 Vali Acc: 0.480 Test Loss: 0.737 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.08223295211792
Epoch: 7, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.739 Vali Acc: 0.510 Test Loss: 0.739 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.169396162033081
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.161057710647583
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.740 Vali Acc: 0.430 Test Loss: 0.740 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.173213243484497
Epoch: 10, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.749 Vali Acc: 0.430 Test Loss: 0.749 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2027053833007812
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.736 Vali Acc: 0.490 Test Loss: 0.736 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_ETSformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 14338
model size : 0.68MB
