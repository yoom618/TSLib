Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 12.410029411315918
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.636 Vali Acc: 0.853 Test Loss: 0.636 Test Acc: 0.853
Validation loss decreased (inf --> -0.853236).  Saving model ...
Epoch: 2 cost time: 7.906692028045654
Epoch: 2, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.696 Vali Acc: 0.826 Test Loss: 0.696 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.732259511947632
Epoch: 3, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.052 Vali Acc: 0.823 Test Loss: 1.052 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.794351577758789
Epoch: 4, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.286 Vali Acc: 0.805 Test Loss: 1.286 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.289546251296997
Epoch: 5, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.478 Vali Acc: 0.805 Test Loss: 1.478 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.961791276931763
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 2.430 Vali Acc: 0.724 Test Loss: 2.430 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.241482257843018
Epoch: 7, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.514 Vali Acc: 0.833 Test Loss: 1.514 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.46356749534607
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.864 Vali Acc: 0.819 Test Loss: 1.864 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.06886339187622
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 2.242 Vali Acc: 0.792 Test Loss: 2.242 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.193880796432495
Epoch: 10, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.642 Vali Acc: 0.843 Test Loss: 1.642 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.754909038543701
Epoch: 11, Steps: 17 | Train Loss: 0.237 Vali Loss: 2.051 Vali Acc: 0.850 Test Loss: 2.051 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 6192210
model size : 33.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.508013010025024
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (inf --> -0.849823).  Saving model ...
Epoch: 2 cost time: 9.566094636917114
Epoch: 2, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.597 Vali Acc: 0.840 Test Loss: 0.597 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.510501384735107
Epoch: 3, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.824 Vali Acc: 0.703 Test Loss: 1.824 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.886561155319214
Epoch: 4, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.534 Vali Acc: 0.802 Test Loss: 1.534 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.327913761138916
Epoch: 5, Steps: 17 | Train Loss: 0.538 Vali Loss: 2.217 Vali Acc: 0.778 Test Loss: 2.217 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.483918905258179
Epoch: 6, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.944 Vali Acc: 0.816 Test Loss: 0.944 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.024797677993774
Epoch: 7, Steps: 17 | Train Loss: 0.461 Vali Loss: 1.121 Vali Acc: 0.860 Test Loss: 1.121 Test Acc: 0.860
Validation loss decreased (-0.849823 --> -0.860057).  Saving model ...
Epoch: 8 cost time: 8.859376430511475
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 2.322 Vali Acc: 0.785 Test Loss: 2.322 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.369029998779297
Epoch: 9, Steps: 17 | Train Loss: 2.256 Vali Loss: 6.199 Vali Acc: 0.642 Test Loss: 6.199 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.664769411087036
Epoch: 10, Steps: 17 | Train Loss: 1.571 Vali Loss: 4.507 Vali Acc: 0.802 Test Loss: 4.507 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.04539680480957
Epoch: 11, Steps: 17 | Train Loss: 1.476 Vali Loss: 4.773 Vali Acc: 0.840 Test Loss: 4.773 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.590523958206177
Epoch: 12, Steps: 17 | Train Loss: 0.515 Vali Loss: 4.266 Vali Acc: 0.768 Test Loss: 4.266 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.015803813934326
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 3.080 Vali Acc: 0.840 Test Loss: 3.080 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.173025131225586
Epoch: 14, Steps: 17 | Train Loss: 0.278 Vali Loss: 2.191 Vali Acc: 0.870 Test Loss: 2.191 Test Acc: 0.870
Validation loss decreased (-0.860057 --> -0.870285).  Saving model ...
Epoch: 15 cost time: 8.986272811889648
Epoch: 15, Steps: 17 | Train Loss: 0.348 Vali Loss: 3.150 Vali Acc: 0.809 Test Loss: 3.150 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.912186622619629
Epoch: 16, Steps: 17 | Train Loss: 0.386 Vali Loss: 3.377 Vali Acc: 0.812 Test Loss: 3.377 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.208373785018921
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 3.977 Vali Acc: 0.795 Test Loss: 3.977 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.264457941055298
Epoch: 18, Steps: 17 | Train Loss: 0.091 Vali Loss: 3.093 Vali Acc: 0.915 Test Loss: 3.093 Test Acc: 0.915
Validation loss decreased (-0.870285 --> -0.914645).  Saving model ...
Epoch: 19 cost time: 9.36541485786438
Epoch: 19, Steps: 17 | Train Loss: 0.156 Vali Loss: 5.784 Vali Acc: 0.823 Test Loss: 5.784 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.437658786773682
Epoch: 20, Steps: 17 | Train Loss: 0.168 Vali Loss: 5.139 Vali Acc: 0.785 Test Loss: 5.139 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.158468246459961
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.619 Vali Acc: 0.898 Test Loss: 2.619 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.247012615203857
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 4.960 Vali Acc: 0.805 Test Loss: 4.960 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.481561183929443
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.449 Vali Acc: 0.785 Test Loss: 5.449 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.990204334259033
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 5.877 Vali Acc: 0.778 Test Loss: 5.877 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.408920049667358
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 5.915 Vali Acc: 0.768 Test Loss: 5.915 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.118159532546997
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 4.662 Vali Acc: 0.829 Test Loss: 4.662 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.183487176895142
Epoch: 27, Steps: 17 | Train Loss: 0.096 Vali Loss: 5.971 Vali Acc: 0.846 Test Loss: 5.971 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.309346675872803
Epoch: 28, Steps: 17 | Train Loss: 0.147 Vali Loss: 4.171 Vali Acc: 0.850 Test Loss: 4.171 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 6192210
model size : 33.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.993936538696289
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
Validation loss decreased (inf --> -0.853236).  Saving model ...
Epoch: 2 cost time: 8.361103534698486
Epoch: 2, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.648 Vali Acc: 0.860 Test Loss: 0.648 Test Acc: 0.860
Validation loss decreased (-0.853236 --> -0.860062).  Saving model ...
Epoch: 3 cost time: 8.939133644104004
Epoch: 3, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.866 Vali Acc: 0.601 Test Loss: 2.866 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.283859491348267
Epoch: 4, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.581 Vali Acc: 0.891 Test Loss: 0.581 Test Acc: 0.891
Validation loss decreased (-0.860062 --> -0.890779).  Saving model ...
Epoch: 5 cost time: 7.092010021209717
Epoch: 5, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.713 Vali Acc: 0.846 Test Loss: 0.713 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.772299528121948
Epoch: 6, Steps: 17 | Train Loss: 0.318 Vali Loss: 3.022 Vali Acc: 0.666 Test Loss: 3.022 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.36957859992981
Epoch: 7, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.971 Vali Acc: 0.843 Test Loss: 0.971 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.414602518081665
Epoch: 8, Steps: 17 | Train Loss: 0.345 Vali Loss: 1.490 Vali Acc: 0.850 Test Loss: 1.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.810429573059082
Epoch: 9, Steps: 17 | Train Loss: 0.388 Vali Loss: 2.703 Vali Acc: 0.754 Test Loss: 2.703 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.043783187866211
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.288 Vali Acc: 0.836 Test Loss: 2.288 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.402591228485107
Epoch: 11, Steps: 17 | Train Loss: 0.420 Vali Loss: 4.361 Vali Acc: 0.734 Test Loss: 4.361 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.093255519866943
Epoch: 12, Steps: 17 | Train Loss: 0.237 Vali Loss: 3.505 Vali Acc: 0.812 Test Loss: 3.505 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.567917346954346
Epoch: 13, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.979 Vali Acc: 0.833 Test Loss: 1.979 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.806049346923828
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 3.725 Vali Acc: 0.741 Test Loss: 3.725 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 6192210
model size : 33.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.393577575683594
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.604 Vali Acc: 0.860 Test Loss: 0.604 Test Acc: 0.860
Validation loss decreased (inf --> -0.860062).  Saving model ...
Epoch: 2 cost time: 7.5901758670806885
Epoch: 2, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.865 Vali Acc: 0.778 Test Loss: 0.865 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.338295221328735
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.874 Vali Acc: 0.788 Test Loss: 0.874 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.740239858627319
Epoch: 4, Steps: 17 | Train Loss: 1.096 Vali Loss: 0.917 Vali Acc: 0.802 Test Loss: 0.917 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.764881134033203
Epoch: 5, Steps: 17 | Train Loss: 1.117 Vali Loss: 0.799 Vali Acc: 0.826 Test Loss: 0.799 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.752083778381348
Epoch: 6, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.810 Vali Acc: 0.686 Test Loss: 1.810 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.178719758987427
Epoch: 7, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.058 Vali Acc: 0.741 Test Loss: 2.058 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.089911937713623
Epoch: 8, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.065 Vali Acc: 0.805 Test Loss: 2.065 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.879762887954712
Epoch: 9, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.807 Vali Acc: 0.901 Test Loss: 0.807 Test Acc: 0.901
Validation loss decreased (-0.860062 --> -0.901016).  Saving model ...
Epoch: 10 cost time: 6.93527626991272
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.042 Vali Acc: 0.877 Test Loss: 1.042 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.543441534042358
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.001 Vali Acc: 0.850 Test Loss: 2.001 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.417396306991577
Epoch: 12, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.550 Vali Acc: 0.870 Test Loss: 1.550 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.080366849899292
Epoch: 13, Steps: 17 | Train Loss: 0.181 Vali Loss: 3.325 Vali Acc: 0.765 Test Loss: 3.325 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.19099497795105
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.269 Vali Acc: 0.843 Test Loss: 2.269 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.539120197296143
Epoch: 15, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.572 Vali Acc: 0.788 Test Loss: 3.572 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.105474233627319
Epoch: 16, Steps: 17 | Train Loss: 0.546 Vali Loss: 5.958 Vali Acc: 0.775 Test Loss: 5.958 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.411850452423096
Epoch: 17, Steps: 17 | Train Loss: 0.681 Vali Loss: 5.620 Vali Acc: 0.741 Test Loss: 5.620 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.030416011810303
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.799 Vali Acc: 0.829 Test Loss: 2.799 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.05387020111084
Epoch: 19, Steps: 17 | Train Loss: 0.818 Vali Loss: 4.024 Vali Acc: 0.799 Test Loss: 4.024 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 6192210
model size : 33.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.461998224258423
Epoch: 1, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.653 Vali Acc: 0.645 Test Loss: 2.653 Test Acc: 0.645
Validation loss decreased (inf --> -0.645025).  Saving model ...
Epoch: 2 cost time: 6.896514415740967
Epoch: 2, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.276 Vali Acc: 0.836 Test Loss: 1.276 Test Acc: 0.836
Validation loss decreased (-0.645025 --> -0.836165).  Saving model ...
Epoch: 3 cost time: 9.143731355667114
Epoch: 3, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.745 Vali Acc: 0.877 Test Loss: 0.745 Test Acc: 0.877
Validation loss decreased (-0.836165 --> -0.877126).  Saving model ...
Epoch: 4 cost time: 9.376240730285645
Epoch: 4, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.823 Vali Acc: 0.853 Test Loss: 0.823 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.765369653701782
Epoch: 5, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.048 Vali Acc: 0.853 Test Loss: 1.048 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.967902898788452
Epoch: 6, Steps: 17 | Train Loss: 0.431 Vali Loss: 1.481 Vali Acc: 0.816 Test Loss: 1.481 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.701016902923584
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.891 Vali Acc: 0.771 Test Loss: 1.891 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.550644636154175
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.383 Vali Acc: 0.795 Test Loss: 1.383 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.975722551345825
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.393 Vali Acc: 0.853 Test Loss: 1.393 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.651805400848389
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 3.085 Vali Acc: 0.765 Test Loss: 3.085 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.820977687835693
Epoch: 11, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.454 Vali Acc: 0.908 Test Loss: 1.454 Test Acc: 0.908
Validation loss decreased (-0.877126 --> -0.907835).  Saving model ...
Epoch: 12 cost time: 8.846213579177856
Epoch: 12, Steps: 17 | Train Loss: 0.451 Vali Loss: 3.340 Vali Acc: 0.802 Test Loss: 3.340 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.77774429321289
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.470 Vali Acc: 0.898 Test Loss: 1.470 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.336103200912476
Epoch: 14, Steps: 17 | Train Loss: 0.129 Vali Loss: 4.053 Vali Acc: 0.768 Test Loss: 4.053 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.463276863098145
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 3.127 Vali Acc: 0.792 Test Loss: 3.127 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.33614468574524
Epoch: 16, Steps: 17 | Train Loss: 0.418 Vali Loss: 3.840 Vali Acc: 0.836 Test Loss: 3.840 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.636034727096558
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.755 Vali Acc: 0.867 Test Loss: 2.755 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.78557014465332
Epoch: 18, Steps: 17 | Train Loss: 0.289 Vali Loss: 3.146 Vali Acc: 0.857 Test Loss: 3.146 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.790618181228638
Epoch: 19, Steps: 17 | Train Loss: 0.182 Vali Loss: 4.874 Vali Acc: 0.795 Test Loss: 4.874 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.358960390090942
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 4.570 Vali Acc: 0.833 Test Loss: 4.570 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.635177850723267
Epoch: 21, Steps: 17 | Train Loss: 0.181 Vali Loss: 5.105 Vali Acc: 0.840 Test Loss: 5.105 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 4095058
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.93814206123352
Epoch: 1, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.641 Vali Acc: 0.642 Test Loss: 2.641 Test Acc: 0.642
Validation loss decreased (inf --> -0.641612).  Saving model ...
Epoch: 2 cost time: 9.553643941879272
Epoch: 2, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.124 Vali Acc: 0.850 Test Loss: 1.124 Test Acc: 0.850
Validation loss decreased (-0.641612 --> -0.849818).  Saving model ...
Epoch: 3 cost time: 8.460680961608887
Epoch: 3, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.988 Vali Acc: 0.853 Test Loss: 0.988 Test Acc: 0.853
Validation loss decreased (-0.849818 --> -0.853232).  Saving model ...
Epoch: 4 cost time: 7.749245882034302
Epoch: 4, Steps: 17 | Train Loss: 0.542 Vali Loss: 1.732 Vali Acc: 0.741 Test Loss: 1.732 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.137496709823608
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 1.712 Vali Acc: 0.768 Test Loss: 1.712 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.994071245193481
Epoch: 6, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.203 Vali Acc: 0.823 Test Loss: 1.203 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.04491901397705
Epoch: 7, Steps: 17 | Train Loss: 0.508 Vali Loss: 1.331 Vali Acc: 0.901 Test Loss: 1.331 Test Acc: 0.901
Validation loss decreased (-0.853232 --> -0.901011).  Saving model ...
Epoch: 8 cost time: 8.083075284957886
Epoch: 8, Steps: 17 | Train Loss: 0.784 Vali Loss: 3.951 Vali Acc: 0.683 Test Loss: 3.951 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.485133409500122
Epoch: 9, Steps: 17 | Train Loss: 0.423 Vali Loss: 3.695 Vali Acc: 0.703 Test Loss: 3.695 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.471645832061768
Epoch: 10, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.061 Vali Acc: 0.826 Test Loss: 2.061 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.168400526046753
Epoch: 11, Steps: 17 | Train Loss: 0.367 Vali Loss: 3.887 Vali Acc: 0.785 Test Loss: 3.887 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.897553205490112
Epoch: 12, Steps: 17 | Train Loss: 0.585 Vali Loss: 3.647 Vali Acc: 0.792 Test Loss: 3.647 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.785382032394409
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 3.522 Vali Acc: 0.836 Test Loss: 3.522 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.158357381820679
Epoch: 14, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.913 Vali Acc: 0.884 Test Loss: 1.913 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.14095950126648
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.842 Vali Acc: 0.826 Test Loss: 2.842 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.68287205696106
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.711 Vali Acc: 0.853 Test Loss: 2.711 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.111249446868896
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.549 Vali Acc: 0.853 Test Loss: 3.549 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 4095058
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.389828443527222
Epoch: 1, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.829 Vali Acc: 0.625 Test Loss: 2.829 Test Acc: 0.625
Validation loss decreased (inf --> -0.624545).  Saving model ...
Epoch: 2 cost time: 8.377360820770264
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.160 Vali Acc: 0.850 Test Loss: 1.160 Test Acc: 0.850
Validation loss decreased (-0.624545 --> -0.849818).  Saving model ...
Epoch: 3 cost time: 7.5354297161102295
Epoch: 3, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.651008605957031
Epoch: 4, Steps: 17 | Train Loss: 0.490 Vali Loss: 1.077 Vali Acc: 0.771 Test Loss: 1.077 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.784456729888916
Epoch: 5, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.876 Vali Acc: 0.836 Test Loss: 0.876 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.537118196487427
Epoch: 6, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.628 Vali Acc: 0.775 Test Loss: 1.628 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.650627374649048
Epoch: 7, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.071 Vali Acc: 0.782 Test Loss: 1.071 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.826683282852173
Epoch: 8, Steps: 17 | Train Loss: 0.666 Vali Loss: 1.464 Vali Acc: 0.785 Test Loss: 1.464 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.6017985343933105
Epoch: 9, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.557 Vali Acc: 0.802 Test Loss: 1.557 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.2995829582214355
Epoch: 10, Steps: 17 | Train Loss: 0.505 Vali Loss: 3.282 Vali Acc: 0.744 Test Loss: 3.282 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.9237587451934814
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.139 Vali Acc: 0.894 Test Loss: 1.139 Test Acc: 0.894
Validation loss decreased (-0.849818 --> -0.894187).  Saving model ...
Epoch: 12 cost time: 8.106000185012817
Epoch: 12, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.554 Vali Acc: 0.802 Test Loss: 2.554 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.961655616760254
Epoch: 13, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.010 Vali Acc: 0.874 Test Loss: 2.010 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.3473615646362305
Epoch: 14, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.983 Vali Acc: 0.901 Test Loss: 1.983 Test Acc: 0.901
Validation loss decreased (-0.894187 --> -0.901004).  Saving model ...
Epoch: 15 cost time: 7.360474109649658
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.571 Vali Acc: 0.884 Test Loss: 1.571 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.098799705505371
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.215 Vali Acc: 0.846 Test Loss: 2.215 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.346143960952759
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.980 Vali Acc: 0.877 Test Loss: 2.980 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.7007832527160645
Epoch: 18, Steps: 17 | Train Loss: 0.505 Vali Loss: 4.940 Vali Acc: 0.768 Test Loss: 4.940 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.152293682098389
Epoch: 19, Steps: 17 | Train Loss: 0.350 Vali Loss: 4.421 Vali Acc: 0.840 Test Loss: 4.421 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.432947874069214
Epoch: 20, Steps: 17 | Train Loss: 0.346 Vali Loss: 2.384 Vali Acc: 0.870 Test Loss: 2.384 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.742908716201782
Epoch: 21, Steps: 17 | Train Loss: 0.228 Vali Loss: 3.539 Vali Acc: 0.846 Test Loss: 3.539 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.767240762710571
Epoch: 22, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.236 Vali Acc: 0.860 Test Loss: 3.236 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.064951658248901
Epoch: 23, Steps: 17 | Train Loss: 0.169 Vali Loss: 3.263 Vali Acc: 0.867 Test Loss: 3.263 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.0978639125823975
Epoch: 24, Steps: 17 | Train Loss: 0.167 Vali Loss: 7.827 Vali Acc: 0.744 Test Loss: 7.827 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 4095058
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.518791198730469
Epoch: 1, Steps: 17 | Train Loss: 0.980 Vali Loss: 2.795 Vali Acc: 0.601 Test Loss: 2.795 Test Acc: 0.601
Validation loss decreased (inf --> -0.600655).  Saving model ...
Epoch: 2 cost time: 7.857819557189941
Epoch: 2, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.305 Vali Acc: 0.840 Test Loss: 1.305 Test Acc: 0.840
Validation loss decreased (-0.600655 --> -0.839577).  Saving model ...
Epoch: 3 cost time: 7.724734306335449
Epoch: 3, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.6835949420928955
Epoch: 4, Steps: 17 | Train Loss: 0.994 Vali Loss: 0.650 Vali Acc: 0.881 Test Loss: 0.650 Test Acc: 0.881
Validation loss decreased (-0.839577 --> -0.880540).  Saving model ...
Epoch: 5 cost time: 7.22020411491394
Epoch: 5, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.735 Vali Acc: 0.689 Test Loss: 1.735 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.113865852355957
Epoch: 6, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.195 Vali Acc: 0.816 Test Loss: 1.195 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.814213514328003
Epoch: 7, Steps: 17 | Train Loss: 0.668 Vali Loss: 1.530 Vali Acc: 0.758 Test Loss: 1.530 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.049919366836548
Epoch: 8, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.321 Vali Acc: 0.751 Test Loss: 2.321 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.71620774269104
Epoch: 9, Steps: 17 | Train Loss: 1.059 Vali Loss: 4.981 Vali Acc: 0.584 Test Loss: 4.981 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.922860622406006
Epoch: 10, Steps: 17 | Train Loss: 0.225 Vali Loss: 3.735 Vali Acc: 0.747 Test Loss: 3.735 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.35950493812561
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.500 Vali Acc: 0.884 Test Loss: 1.500 Test Acc: 0.884
Validation loss decreased (-0.880540 --> -0.883944).  Saving model ...
Epoch: 12 cost time: 7.54349422454834
Epoch: 12, Steps: 17 | Train Loss: 0.227 Vali Loss: 2.259 Vali Acc: 0.809 Test Loss: 2.259 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.915027856826782
Epoch: 13, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.476 Vali Acc: 0.850 Test Loss: 1.476 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.963691473007202
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.978 Vali Acc: 0.785 Test Loss: 2.978 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.554642200469971
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.353 Vali Acc: 0.870 Test Loss: 1.353 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.045007705688477
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.109 Vali Acc: 0.812 Test Loss: 3.109 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.677826404571533
Epoch: 17, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.711 Vali Acc: 0.840 Test Loss: 2.711 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.472820043563843
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 3.515 Vali Acc: 0.809 Test Loss: 3.515 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.231858730316162
Epoch: 19, Steps: 17 | Train Loss: 0.290 Vali Loss: 4.221 Vali Acc: 0.765 Test Loss: 4.221 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.000304460525513
Epoch: 20, Steps: 17 | Train Loss: 0.126 Vali Loss: 5.478 Vali Acc: 0.727 Test Loss: 5.478 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.627841949462891
Epoch: 21, Steps: 17 | Train Loss: 0.132 Vali Loss: 3.171 Vali Acc: 0.853 Test Loss: 3.171 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 4095058
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.407532453536987
Epoch: 1, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.705 Vali Acc: 0.785 Test Loss: 0.705 Test Acc: 0.785
Validation loss decreased (inf --> -0.784976).  Saving model ...
Epoch: 2 cost time: 8.395839214324951
Epoch: 2, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.831 Vali Acc: 0.737 Test Loss: 0.831 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.3523828983306885
Epoch: 3, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.842 Vali Acc: 0.857 Test Loss: 0.842 Test Acc: 0.857
Validation loss decreased (-0.784976 --> -0.856647).  Saving model ...
Epoch: 4 cost time: 8.219767570495605
Epoch: 4, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.143 Vali Acc: 0.867 Test Loss: 1.143 Test Acc: 0.867
Validation loss decreased (-0.856647 --> -0.866883).  Saving model ...
Epoch: 5 cost time: 9.180977582931519
Epoch: 5, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.969 Vali Acc: 0.874 Test Loss: 0.969 Test Acc: 0.874
Validation loss decreased (-0.866883 --> -0.873710).  Saving model ...
Epoch: 6 cost time: 8.85378360748291
Epoch: 6, Steps: 17 | Train Loss: 0.649 Vali Loss: 2.123 Vali Acc: 0.826 Test Loss: 2.123 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.481875896453857
Epoch: 7, Steps: 17 | Train Loss: 0.462 Vali Loss: 2.105 Vali Acc: 0.785 Test Loss: 2.105 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.604280710220337
Epoch: 8, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.242 Vali Acc: 0.846 Test Loss: 1.242 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.290143013000488
Epoch: 9, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.164 Vali Acc: 0.881 Test Loss: 1.164 Test Acc: 0.881
Validation loss decreased (-0.873710 --> -0.880534).  Saving model ...
Epoch: 10 cost time: 8.364292860031128
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.602 Vali Acc: 0.850 Test Loss: 2.602 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.166520357131958
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 2.424 Vali Acc: 0.819 Test Loss: 2.424 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.811825513839722
Epoch: 12, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.978 Vali Acc: 0.829 Test Loss: 1.978 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.22311782836914
Epoch: 13, Steps: 17 | Train Loss: 0.285 Vali Loss: 3.437 Vali Acc: 0.829 Test Loss: 3.437 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.48599648475647
Epoch: 14, Steps: 17 | Train Loss: 0.511 Vali Loss: 3.897 Vali Acc: 0.775 Test Loss: 3.897 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.102941989898682
Epoch: 15, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.554 Vali Acc: 0.840 Test Loss: 2.554 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.6571626663208
Epoch: 16, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.634 Vali Acc: 0.874 Test Loss: 2.634 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.697680711746216
Epoch: 17, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.577 Vali Acc: 0.860 Test Loss: 2.577 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.708182334899902
Epoch: 18, Steps: 17 | Train Loss: 0.333 Vali Loss: 5.342 Vali Acc: 0.833 Test Loss: 5.342 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.654072761535645
Epoch: 19, Steps: 17 | Train Loss: 0.576 Vali Loss: 2.409 Vali Acc: 0.887 Test Loss: 2.409 Test Acc: 0.887
Validation loss decreased (-0.880534 --> -0.887348).  Saving model ...
Epoch: 20 cost time: 8.978721380233765
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.273 Vali Acc: 0.898 Test Loss: 2.273 Test Acc: 0.898
Validation loss decreased (-0.887348 --> -0.897588).  Saving model ...
Epoch: 21 cost time: 8.970031976699829
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.390 Vali Acc: 0.860 Test Loss: 3.390 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.237039566040039
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.461 Vali Acc: 0.836 Test Loss: 3.461 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.323358058929443
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.515 Vali Acc: 0.850 Test Loss: 3.515 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.482356786727905
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.836 Test Loss: 3.497 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.051441431045532
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.787 Vali Acc: 0.891 Test Loss: 3.787 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.162446022033691
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.934 Vali Acc: 0.863 Test Loss: 2.934 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.998629808425903
Epoch: 27, Steps: 17 | Train Loss: 0.060 Vali Loss: 3.489 Vali Acc: 0.857 Test Loss: 3.489 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.212441205978394
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 6.052 Vali Acc: 0.771 Test Loss: 6.052 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.890859127044678
Epoch: 29, Steps: 17 | Train Loss: 0.176 Vali Loss: 3.368 Vali Acc: 0.887 Test Loss: 3.368 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 7.187900066375732
Epoch: 30, Steps: 17 | Train Loss: 0.543 Vali Loss: 7.102 Vali Acc: 0.805 Test Loss: 7.102 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 3046482
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.952041625976562
Epoch: 1, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.768 Vali Acc: 0.768 Test Loss: 0.768 Test Acc: 0.768
Validation loss decreased (inf --> -0.767910).  Saving model ...
Epoch: 2 cost time: 7.334746360778809
Epoch: 2, Steps: 17 | Train Loss: 0.643 Vali Loss: 1.615 Vali Acc: 0.669 Test Loss: 1.615 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.17215633392334
Epoch: 3, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.156 Vali Acc: 0.696 Test Loss: 2.156 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.498634338378906
Epoch: 4, Steps: 17 | Train Loss: 1.131 Vali Loss: 2.964 Vali Acc: 0.700 Test Loss: 2.964 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.117897510528564
Epoch: 5, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.017 Vali Acc: 0.853 Test Loss: 1.017 Test Acc: 0.853
Validation loss decreased (-0.767910 --> -0.853232).  Saving model ...
Epoch: 6 cost time: 7.803133964538574
Epoch: 6, Steps: 17 | Train Loss: 0.727 Vali Loss: 2.223 Vali Acc: 0.802 Test Loss: 2.223 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.905982494354248
Epoch: 7, Steps: 17 | Train Loss: 0.490 Vali Loss: 2.284 Vali Acc: 0.843 Test Loss: 2.284 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.970021963119507
Epoch: 8, Steps: 17 | Train Loss: 0.721 Vali Loss: 2.603 Vali Acc: 0.768 Test Loss: 2.603 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.705519437789917
Epoch: 9, Steps: 17 | Train Loss: 0.247 Vali Loss: 2.359 Vali Acc: 0.836 Test Loss: 2.359 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.839974880218506
Epoch: 10, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.977 Vali Acc: 0.809 Test Loss: 1.977 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.646953582763672
Epoch: 11, Steps: 17 | Train Loss: 0.555 Vali Loss: 3.305 Vali Acc: 0.741 Test Loss: 3.305 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.572760343551636
Epoch: 12, Steps: 17 | Train Loss: 0.430 Vali Loss: 2.485 Vali Acc: 0.802 Test Loss: 2.485 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.9191412925720215
Epoch: 13, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.704 Vali Acc: 0.843 Test Loss: 1.704 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.856380462646484
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.657 Vali Acc: 0.887 Test Loss: 1.657 Test Acc: 0.887
Validation loss decreased (-0.853232 --> -0.887355).  Saving model ...
Epoch: 15 cost time: 7.724891185760498
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 2.411 Vali Acc: 0.823 Test Loss: 2.411 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.799756050109863
Epoch: 16, Steps: 17 | Train Loss: 0.441 Vali Loss: 4.795 Vali Acc: 0.771 Test Loss: 4.795 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.294206619262695
Epoch: 17, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.616 Vali Acc: 0.867 Test Loss: 2.616 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.937620639801025
Epoch: 18, Steps: 17 | Train Loss: 0.057 Vali Loss: 4.910 Vali Acc: 0.778 Test Loss: 4.910 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.665834188461304
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.218 Vali Acc: 0.877 Test Loss: 2.218 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.072838068008423
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.696 Vali Acc: 0.863 Test Loss: 2.696 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.982299089431763
Epoch: 21, Steps: 17 | Train Loss: 0.109 Vali Loss: 2.863 Vali Acc: 0.812 Test Loss: 2.863 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.016387462615967
Epoch: 22, Steps: 17 | Train Loss: 0.189 Vali Loss: 2.556 Vali Acc: 0.884 Test Loss: 2.556 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.427939414978027
Epoch: 23, Steps: 17 | Train Loss: 0.615 Vali Loss: 3.529 Vali Acc: 0.846 Test Loss: 3.529 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.565699100494385
Epoch: 24, Steps: 17 | Train Loss: 0.141 Vali Loss: 4.478 Vali Acc: 0.805 Test Loss: 4.478 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 3046482
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.086430072784424
Epoch: 1, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.849 Vali Acc: 0.737 Test Loss: 0.849 Test Acc: 0.737
Validation loss decreased (inf --> -0.737193).  Saving model ...
Epoch: 2 cost time: 7.6383445262908936
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
Validation loss decreased (-0.737193 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 7.527025461196899
Epoch: 3, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.687 Vali Acc: 0.877 Test Loss: 0.687 Test Acc: 0.877
Validation loss decreased (-0.832760 --> -0.877126).  Saving model ...
Epoch: 4 cost time: 6.738695383071899
Epoch: 4, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.206 Vali Acc: 0.775 Test Loss: 1.206 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.42811393737793
Epoch: 5, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.638 Vali Acc: 0.870 Test Loss: 0.638 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.328677654266357
Epoch: 6, Steps: 17 | Train Loss: 0.445 Vali Loss: 1.350 Vali Acc: 0.754 Test Loss: 1.350 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.758364915847778
Epoch: 7, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.872 Vali Acc: 0.724 Test Loss: 1.872 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.913310289382935
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.047 Vali Acc: 0.823 Test Loss: 1.047 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.465435266494751
Epoch: 9, Steps: 17 | Train Loss: 0.348 Vali Loss: 1.025 Vali Acc: 0.816 Test Loss: 1.025 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.606152534484863
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 2.509 Vali Acc: 0.857 Test Loss: 2.509 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.543188095092773
Epoch: 11, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.384 Vali Acc: 0.754 Test Loss: 2.384 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.919963359832764
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 2.306 Vali Acc: 0.778 Test Loss: 2.306 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.791100740432739
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 2.788 Vali Acc: 0.846 Test Loss: 2.788 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 3046482
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.653369903564453
Epoch: 1, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.998 Vali Acc: 0.713 Test Loss: 0.998 Test Acc: 0.713
Validation loss decreased (inf --> -0.713301).  Saving model ...
Epoch: 2 cost time: 5.22908616065979
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.761 Vali Acc: 0.737 Test Loss: 0.761 Test Acc: 0.737
Validation loss decreased (-0.713301 --> -0.737194).  Saving model ...
Epoch: 3 cost time: 6.638388395309448
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.400 Vali Acc: 0.874 Test Loss: 0.400 Test Acc: 0.874
Validation loss decreased (-0.737194 --> -0.873716).  Saving model ...
Epoch: 4 cost time: 7.178905248641968
Epoch: 4, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.643 Vali Acc: 0.771 Test Loss: 0.643 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.923017501831055
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.702 Vali Acc: 0.836 Test Loss: 0.702 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.337544918060303
Epoch: 6, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.494 Vali Acc: 0.734 Test Loss: 1.494 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.009053707122803
Epoch: 7, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.077 Vali Acc: 0.809 Test Loss: 2.077 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.8693766593933105
Epoch: 8, Steps: 17 | Train Loss: 0.514 Vali Loss: 5.010 Vali Acc: 0.611 Test Loss: 5.010 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.922573804855347
Epoch: 9, Steps: 17 | Train Loss: 1.431 Vali Loss: 2.063 Vali Acc: 0.846 Test Loss: 2.063 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.080551624298096
Epoch: 10, Steps: 17 | Train Loss: 1.201 Vali Loss: 4.080 Vali Acc: 0.706 Test Loss: 4.080 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.962716341018677
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 2.111 Vali Acc: 0.816 Test Loss: 2.111 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.490262746810913
Epoch: 12, Steps: 17 | Train Loss: 0.400 Vali Loss: 1.130 Vali Acc: 0.887 Test Loss: 1.130 Test Acc: 0.887
Validation loss decreased (-0.873716 --> -0.887361).  Saving model ...
Epoch: 13 cost time: 6.394909381866455
Epoch: 13, Steps: 17 | Train Loss: 0.218 Vali Loss: 2.020 Vali Acc: 0.829 Test Loss: 2.020 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.0290772914886475
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.551 Vali Acc: 0.863 Test Loss: 1.551 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.866110324859619
Epoch: 15, Steps: 17 | Train Loss: 0.169 Vali Loss: 2.827 Vali Acc: 0.826 Test Loss: 2.827 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.388936519622803
Epoch: 16, Steps: 17 | Train Loss: 0.426 Vali Loss: 4.741 Vali Acc: 0.754 Test Loss: 4.741 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.14980149269104
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.621 Vali Acc: 0.904 Test Loss: 1.621 Test Acc: 0.904
Validation loss decreased (-0.887361 --> -0.904421).  Saving model ...
Epoch: 18 cost time: 6.425090551376343
Epoch: 18, Steps: 17 | Train Loss: 0.315 Vali Loss: 2.626 Vali Acc: 0.853 Test Loss: 2.626 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.270579099655151
Epoch: 19, Steps: 17 | Train Loss: 0.426 Vali Loss: 4.282 Vali Acc: 0.799 Test Loss: 4.282 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.44002366065979
Epoch: 20, Steps: 17 | Train Loss: 0.203 Vali Loss: 4.262 Vali Acc: 0.819 Test Loss: 4.262 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.563422441482544
Epoch: 21, Steps: 17 | Train Loss: 0.181 Vali Loss: 3.422 Vali Acc: 0.846 Test Loss: 3.422 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.43099308013916
Epoch: 22, Steps: 17 | Train Loss: 0.377 Vali Loss: 3.761 Vali Acc: 0.857 Test Loss: 3.761 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.4869654178619385
Epoch: 23, Steps: 17 | Train Loss: 0.115 Vali Loss: 4.502 Vali Acc: 0.819 Test Loss: 4.502 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.842322587966919
Epoch: 24, Steps: 17 | Train Loss: 0.036 Vali Loss: 5.415 Vali Acc: 0.823 Test Loss: 5.415 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.581140518188477
Epoch: 25, Steps: 17 | Train Loss: 0.137 Vali Loss: 3.419 Vali Acc: 0.867 Test Loss: 3.419 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.5591139793396
Epoch: 26, Steps: 17 | Train Loss: 0.044 Vali Loss: 5.324 Vali Acc: 0.823 Test Loss: 5.324 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.678474426269531
Epoch: 27, Steps: 17 | Train Loss: 0.237 Vali Loss: 7.016 Vali Acc: 0.788 Test Loss: 7.016 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 3046482
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 11.517074584960938
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.442 Vali Acc: 0.863 Test Loss: 0.442 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 9.341282367706299
Epoch: 2, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.854 Vali Acc: 0.765 Test Loss: 0.854 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.233933687210083
Epoch: 3, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.234 Vali Acc: 0.802 Test Loss: 1.234 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.256110906600952
Epoch: 4, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.915 Vali Acc: 0.867 Test Loss: 0.915 Test Acc: 0.867
Validation loss decreased (-0.863477 --> -0.866885).  Saving model ...
Epoch: 5 cost time: 8.64456844329834
Epoch: 5, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.544 Vali Acc: 0.788 Test Loss: 1.544 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.37345814704895
Epoch: 6, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.493 Vali Acc: 0.696 Test Loss: 2.493 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.135137319564819
Epoch: 7, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.060 Vali Acc: 0.874 Test Loss: 1.060 Test Acc: 0.874
Validation loss decreased (-0.866885 --> -0.873710).  Saving model ...
Epoch: 8 cost time: 7.292324542999268
Epoch: 8, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.076 Vali Acc: 0.881 Test Loss: 1.076 Test Acc: 0.881
Validation loss decreased (-0.873710 --> -0.880535).  Saving model ...
Epoch: 9 cost time: 7.437429666519165
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.609 Vali Acc: 0.833 Test Loss: 1.609 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.923993349075317
Epoch: 10, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.734 Vali Acc: 0.863 Test Loss: 1.734 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.950570344924927
Epoch: 11, Steps: 17 | Train Loss: 0.369 Vali Loss: 4.176 Vali Acc: 0.744 Test Loss: 4.176 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.51049280166626
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.342 Vali Acc: 0.894 Test Loss: 1.342 Test Acc: 0.894
Validation loss decreased (-0.880535 --> -0.894185).  Saving model ...
Epoch: 13 cost time: 7.4361302852630615
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 2.386 Vali Acc: 0.853 Test Loss: 2.386 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.774704217910767
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 3.259 Vali Acc: 0.812 Test Loss: 3.259 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.6421799659729
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.194 Vali Acc: 0.836 Test Loss: 2.194 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.4583070278167725
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 3.709 Vali Acc: 0.816 Test Loss: 3.709 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.817573070526123
Epoch: 17, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.863 Vali Acc: 0.881 Test Loss: 1.863 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.835829257965088
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.529 Vali Acc: 0.850 Test Loss: 2.529 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.95352578163147
Epoch: 19, Steps: 17 | Train Loss: 0.071 Vali Loss: 3.511 Vali Acc: 0.809 Test Loss: 3.511 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.65627670288086
Epoch: 20, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.913 Vali Acc: 0.863 Test Loss: 1.913 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.356027126312256
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.712 Vali Acc: 0.819 Test Loss: 3.712 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.264896392822266
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 3.281 Vali Acc: 0.823 Test Loss: 3.281 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 2522194
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.5867760181427
Epoch: 1, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 7.049353837966919
Epoch: 2, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.965 Vali Acc: 0.751 Test Loss: 0.965 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.642784357070923
Epoch: 3, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.586 Vali Acc: 0.717 Test Loss: 1.586 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.864219427108765
Epoch: 4, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.970 Vali Acc: 0.853 Test Loss: 0.970 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.367648601531982
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.679 Vali Acc: 0.884 Test Loss: 0.679 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883952).  Saving model ...
Epoch: 6 cost time: 7.717326402664185
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.751 Vali Acc: 0.761 Test Loss: 1.751 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.309196710586548
Epoch: 7, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.219 Vali Acc: 0.836 Test Loss: 1.219 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.7414422035217285
Epoch: 8, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.751 Vali Acc: 0.911 Test Loss: 0.751 Test Acc: 0.911
Validation loss decreased (-0.883952 --> -0.911255).  Saving model ...
Epoch: 9 cost time: 7.701238632202148
Epoch: 9, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.062 Vali Acc: 0.853 Test Loss: 1.062 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.471654891967773
Epoch: 10, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.537 Vali Acc: 0.833 Test Loss: 1.537 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.717112064361572
Epoch: 11, Steps: 17 | Train Loss: 0.544 Vali Loss: 2.520 Vali Acc: 0.826 Test Loss: 2.520 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.195706844329834
Epoch: 12, Steps: 17 | Train Loss: 0.689 Vali Loss: 4.558 Vali Acc: 0.799 Test Loss: 4.558 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.693084001541138
Epoch: 13, Steps: 17 | Train Loss: 0.928 Vali Loss: 3.163 Vali Acc: 0.816 Test Loss: 3.163 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.9956066608428955
Epoch: 14, Steps: 17 | Train Loss: 0.267 Vali Loss: 2.448 Vali Acc: 0.823 Test Loss: 2.448 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.793799161911011
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 3.322 Vali Acc: 0.836 Test Loss: 3.322 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.319787502288818
Epoch: 16, Steps: 17 | Train Loss: 0.281 Vali Loss: 2.535 Vali Acc: 0.840 Test Loss: 2.535 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.7730395793914795
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 2.380 Vali Acc: 0.870 Test Loss: 2.380 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.817699670791626
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.155 Vali Acc: 0.840 Test Loss: 3.155 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 2522194
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.997955799102783
Epoch: 1, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 7.599648475646973
Epoch: 2, Steps: 17 | Train Loss: 0.510 Vali Loss: 1.374 Vali Acc: 0.666 Test Loss: 1.374 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.801162242889404
Epoch: 3, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.209 Vali Acc: 0.577 Test Loss: 3.209 Test Acc: 0.577
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.270420551300049
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.510 Vali Acc: 0.915 Test Loss: 0.510 Test Acc: 0.915
Validation loss decreased (-0.883955 --> -0.914671).  Saving model ...
Epoch: 5 cost time: 6.011213064193726
Epoch: 5, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.574 Vali Acc: 0.843 Test Loss: 0.574 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.294636487960815
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 2.010 Vali Acc: 0.785 Test Loss: 2.010 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.591556072235107
Epoch: 7, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.289 Vali Acc: 0.785 Test Loss: 1.289 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.476853370666504
Epoch: 8, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.287 Vali Acc: 0.846 Test Loss: 1.287 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.584975242614746
Epoch: 9, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.045 Vali Acc: 0.850 Test Loss: 1.045 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.870516300201416
Epoch: 10, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.174 Vali Acc: 0.881 Test Loss: 1.174 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.136643171310425
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.507 Vali Acc: 0.836 Test Loss: 1.507 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.968820095062256
Epoch: 12, Steps: 17 | Train Loss: 0.585 Vali Loss: 3.507 Vali Acc: 0.805 Test Loss: 3.507 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.231493711471558
Epoch: 13, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.346 Vali Acc: 0.833 Test Loss: 2.346 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.299510955810547
Epoch: 14, Steps: 17 | Train Loss: 0.143 Vali Loss: 2.662 Vali Acc: 0.785 Test Loss: 2.662 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 2522194
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.081252574920654
Epoch: 1, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 3.2246615886688232
Epoch: 2, Steps: 17 | Train Loss: 0.503 Vali Loss: 1.761 Vali Acc: 0.601 Test Loss: 1.761 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2939839363098145
Epoch: 3, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.133579969406128
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.628 Vali Acc: 0.891 Test Loss: 0.628 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1899328231811523
Epoch: 5, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.682 Vali Acc: 0.741 Test Loss: 1.682 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.13204288482666
Epoch: 6, Steps: 17 | Train Loss: 0.886 Vali Loss: 2.668 Vali Acc: 0.727 Test Loss: 2.668 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2879180908203125
Epoch: 7, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.500 Vali Acc: 0.891 Test Loss: 0.500 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.3925492763519287
Epoch: 8, Steps: 17 | Train Loss: 0.360 Vali Loss: 1.687 Vali Acc: 0.857 Test Loss: 1.687 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5421769618988037
Epoch: 9, Steps: 17 | Train Loss: 0.482 Vali Loss: 2.988 Vali Acc: 0.669 Test Loss: 2.988 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3782031536102295
Epoch: 10, Steps: 17 | Train Loss: 0.670 Vali Loss: 1.738 Vali Acc: 0.836 Test Loss: 1.738 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.536315441131592
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.163 Vali Acc: 0.884 Test Loss: 1.163 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 2522194
model size : 19.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.363330364227295
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 1.319 Vali Acc: 0.686 Test Loss: 1.319 Test Acc: 0.686
Validation loss decreased (inf --> -0.685994).  Saving model ...
Epoch: 2 cost time: 8.023512125015259
Epoch: 2, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.244 Vali Acc: 0.788 Test Loss: 1.244 Test Acc: 0.788
Validation loss decreased (-0.685994 --> -0.788383).  Saving model ...
Epoch: 3 cost time: 8.342278242111206
Epoch: 3, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.796 Vali Acc: 0.799 Test Loss: 0.796 Test Acc: 0.799
Validation loss decreased (-0.788383 --> -0.798627).  Saving model ...
Epoch: 4 cost time: 8.892507553100586
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.551 Vali Acc: 0.635 Test Loss: 2.551 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.597590923309326
Epoch: 5, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.083 Vali Acc: 0.823 Test Loss: 1.083 Test Acc: 0.823
Validation loss decreased (-0.798627 --> -0.822515).  Saving model ...
Epoch: 6 cost time: 8.282875299453735
Epoch: 6, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.729 Vali Acc: 0.891 Test Loss: 0.729 Test Acc: 0.891
Validation loss decreased (-0.822515 --> -0.890778).  Saving model ...
Epoch: 7 cost time: 8.747627258300781
Epoch: 7, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.473 Vali Acc: 0.846 Test Loss: 1.473 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.376368761062622
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 3.092 Vali Acc: 0.669 Test Loss: 3.092 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.918729543685913
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.820 Vali Acc: 0.812 Test Loss: 1.820 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.039037227630615
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.291 Vali Acc: 0.901 Test Loss: 1.291 Test Acc: 0.901
Validation loss decreased (-0.890778 --> -0.901011).  Saving model ...
Epoch: 11 cost time: 7.1009767055511475
Epoch: 11, Steps: 17 | Train Loss: 0.507 Vali Loss: 3.399 Vali Acc: 0.829 Test Loss: 3.399 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.386576890945435
Epoch: 12, Steps: 17 | Train Loss: 0.297 Vali Loss: 1.963 Vali Acc: 0.870 Test Loss: 1.963 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.919938087463379
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.261 Vali Acc: 0.901 Test Loss: 1.261 Test Acc: 0.901
Validation loss decreased (-0.901011 --> -0.901011).  Saving model ...
Epoch: 14 cost time: 8.25409197807312
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 4.294 Vali Acc: 0.768 Test Loss: 4.294 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.19879150390625
Epoch: 15, Steps: 17 | Train Loss: 0.411 Vali Loss: 2.080 Vali Acc: 0.874 Test Loss: 2.080 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.79743504524231
Epoch: 16, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.422 Vali Acc: 0.874 Test Loss: 2.422 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.039347887039185
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 2.558 Vali Acc: 0.833 Test Loss: 2.558 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.851209402084351
Epoch: 18, Steps: 17 | Train Loss: 0.544 Vali Loss: 3.108 Vali Acc: 0.860 Test Loss: 3.108 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.335422277450562
Epoch: 19, Steps: 17 | Train Loss: 1.268 Vali Loss: 6.439 Vali Acc: 0.802 Test Loss: 6.439 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.075298547744751
Epoch: 20, Steps: 17 | Train Loss: 0.185 Vali Loss: 3.694 Vali Acc: 0.833 Test Loss: 3.694 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.552382707595825
Epoch: 21, Steps: 17 | Train Loss: 0.147 Vali Loss: 7.416 Vali Acc: 0.799 Test Loss: 7.416 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.693182468414307
Epoch: 22, Steps: 17 | Train Loss: 0.736 Vali Loss: 3.343 Vali Acc: 0.870 Test Loss: 3.343 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.915160179138184
Epoch: 23, Steps: 17 | Train Loss: 0.376 Vali Loss: 3.813 Vali Acc: 0.853 Test Loss: 3.813 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 2260050
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.290894031524658
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.142 Vali Acc: 0.727 Test Loss: 1.142 Test Acc: 0.727
Validation loss decreased (inf --> -0.726951).  Saving model ...
Epoch: 2 cost time: 7.30979061126709
Epoch: 2, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.392 Vali Acc: 0.751 Test Loss: 1.392 Test Acc: 0.751
Validation loss decreased (-0.726951 --> -0.750839).  Saving model ...
Epoch: 3 cost time: 7.136350870132446
Epoch: 3, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.751 Vali Acc: 0.795 Test Loss: 0.751 Test Acc: 0.795
Validation loss decreased (-0.750839 --> -0.795214).  Saving model ...
Epoch: 4 cost time: 7.258707046508789
Epoch: 4, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.619 Vali Acc: 0.655 Test Loss: 2.619 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.502635478973389
Epoch: 5, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.331 Vali Acc: 0.833 Test Loss: 2.331 Test Acc: 0.833
Validation loss decreased (-0.795214 --> -0.832741).  Saving model ...
Epoch: 6 cost time: 7.061938524246216
Epoch: 6, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.054 Vali Acc: 0.853 Test Loss: 1.054 Test Acc: 0.853
Validation loss decreased (-0.832741 --> -0.853232).  Saving model ...
Epoch: 7 cost time: 7.527661561965942
Epoch: 7, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.155 Vali Acc: 0.867 Test Loss: 1.155 Test Acc: 0.867
Validation loss decreased (-0.853232 --> -0.866883).  Saving model ...
Epoch: 8 cost time: 7.462499618530273
Epoch: 8, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.996 Vali Acc: 0.802 Test Loss: 1.996 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.11908221244812
Epoch: 9, Steps: 17 | Train Loss: 0.317 Vali Loss: 4.118 Vali Acc: 0.710 Test Loss: 4.118 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.460439682006836
Epoch: 10, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.163 Vali Acc: 0.884 Test Loss: 1.163 Test Acc: 0.884
Validation loss decreased (-0.866883 --> -0.883947).  Saving model ...
Epoch: 11 cost time: 7.999894857406616
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.174 Vali Acc: 0.829 Test Loss: 2.174 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.813823699951172
Epoch: 12, Steps: 17 | Train Loss: 1.435 Vali Loss: 4.411 Vali Acc: 0.741 Test Loss: 4.411 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.335670232772827
Epoch: 13, Steps: 17 | Train Loss: 0.541 Vali Loss: 2.110 Vali Acc: 0.894 Test Loss: 2.110 Test Acc: 0.894
Validation loss decreased (-0.883947 --> -0.894177).  Saving model ...
Epoch: 14 cost time: 7.051386117935181
Epoch: 14, Steps: 17 | Train Loss: 0.292 Vali Loss: 4.154 Vali Acc: 0.765 Test Loss: 4.154 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.142053604125977
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.104 Vali Acc: 0.857 Test Loss: 2.104 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.168492317199707
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.140 Vali Acc: 0.816 Test Loss: 3.140 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.929251194000244
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 3.003 Vali Acc: 0.812 Test Loss: 3.003 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.922245979309082
Epoch: 18, Steps: 17 | Train Loss: 0.529 Vali Loss: 4.813 Vali Acc: 0.812 Test Loss: 4.813 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.462905406951904
Epoch: 19, Steps: 17 | Train Loss: 0.524 Vali Loss: 2.048 Vali Acc: 0.887 Test Loss: 2.048 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.3843395709991455
Epoch: 20, Steps: 17 | Train Loss: 0.156 Vali Loss: 3.722 Vali Acc: 0.836 Test Loss: 3.722 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.176497936248779
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 3.047 Vali Acc: 0.840 Test Loss: 3.047 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.601105690002441
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.345 Vali Acc: 0.874 Test Loss: 2.345 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.46998405456543
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.938 Vali Acc: 0.843 Test Loss: 2.938 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 2260050
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.806044101715088
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.891 Vali Acc: 0.761 Test Loss: 0.891 Test Acc: 0.761
Validation loss decreased (inf --> -0.761083).  Saving model ...
Epoch: 2 cost time: 7.0850889682769775
Epoch: 2, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.468 Vali Acc: 0.734 Test Loss: 1.468 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.769433259963989
Epoch: 3, Steps: 17 | Train Loss: 0.799 Vali Loss: 1.467 Vali Acc: 0.669 Test Loss: 1.467 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.881532192230225
Epoch: 4, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.179 Vali Acc: 0.853 Test Loss: 1.179 Test Acc: 0.853
Validation loss decreased (-0.761083 --> -0.853231).  Saving model ...
Epoch: 5 cost time: 6.384465217590332
Epoch: 5, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.287 Vali Acc: 0.734 Test Loss: 1.287 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.603205442428589
Epoch: 6, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.915 Vali Acc: 0.761 Test Loss: 1.915 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.593937397003174
Epoch: 7, Steps: 17 | Train Loss: 0.638 Vali Loss: 2.384 Vali Acc: 0.734 Test Loss: 2.384 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.9594316482543945
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 2.824 Vali Acc: 0.754 Test Loss: 2.824 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.63142728805542
Epoch: 9, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.779 Vali Acc: 0.819 Test Loss: 2.779 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.30408501625061
Epoch: 10, Steps: 17 | Train Loss: 0.786 Vali Loss: 5.156 Vali Acc: 0.635 Test Loss: 5.156 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.877714157104492
Epoch: 11, Steps: 17 | Train Loss: 1.328 Vali Loss: 3.036 Vali Acc: 0.850 Test Loss: 3.036 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.082456827163696
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 2.016 Vali Acc: 0.846 Test Loss: 2.016 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.712946653366089
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 2.779 Vali Acc: 0.771 Test Loss: 2.779 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.984086275100708
Epoch: 14, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.746 Vali Acc: 0.863 Test Loss: 1.746 Test Acc: 0.863
Validation loss decreased (-0.853231 --> -0.863464).  Saving model ...
Epoch: 15 cost time: 6.991546392440796
Epoch: 15, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.415 Vali Acc: 0.904 Test Loss: 1.415 Test Acc: 0.904
Validation loss decreased (-0.863464 --> -0.904423).  Saving model ...
Epoch: 16 cost time: 6.733361482620239
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.174 Vali Acc: 0.812 Test Loss: 3.174 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.581843376159668
Epoch: 17, Steps: 17 | Train Loss: 0.305 Vali Loss: 1.758 Vali Acc: 0.867 Test Loss: 1.758 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.811647415161133
Epoch: 18, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.485 Vali Acc: 0.867 Test Loss: 2.485 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.404253244400024
Epoch: 19, Steps: 17 | Train Loss: 0.189 Vali Loss: 3.125 Vali Acc: 0.836 Test Loss: 3.125 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.1212379932403564
Epoch: 20, Steps: 17 | Train Loss: 0.221 Vali Loss: 3.616 Vali Acc: 0.826 Test Loss: 3.616 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.266856670379639
Epoch: 21, Steps: 17 | Train Loss: 0.149 Vali Loss: 5.256 Vali Acc: 0.819 Test Loss: 5.256 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.289189100265503
Epoch: 22, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.333 Vali Acc: 0.911 Test Loss: 2.333 Test Acc: 0.911
Validation loss decreased (-0.904423 --> -0.911239).  Saving model ...
Epoch: 23 cost time: 6.105561971664429
Epoch: 23, Steps: 17 | Train Loss: 0.569 Vali Loss: 6.432 Vali Acc: 0.768 Test Loss: 6.432 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.950896501541138
Epoch: 24, Steps: 17 | Train Loss: 0.160 Vali Loss: 3.529 Vali Acc: 0.836 Test Loss: 3.529 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.627061128616333
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 5.150 Vali Acc: 0.802 Test Loss: 5.150 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.362795352935791
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 6.187 Vali Acc: 0.812 Test Loss: 6.187 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.333272457122803
Epoch: 27, Steps: 17 | Train Loss: 0.383 Vali Loss: 4.900 Vali Acc: 0.819 Test Loss: 4.900 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.5163774490356445
Epoch: 28, Steps: 17 | Train Loss: 0.110 Vali Loss: 6.578 Vali Acc: 0.799 Test Loss: 6.578 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.439092397689819
Epoch: 29, Steps: 17 | Train Loss: 0.418 Vali Loss: 6.366 Vali Acc: 0.802 Test Loss: 6.366 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.918263912200928
Epoch: 30, Steps: 17 | Train Loss: 0.200 Vali Loss: 5.781 Vali Acc: 0.788 Test Loss: 5.781 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.355137586593628
Epoch: 31, Steps: 17 | Train Loss: 0.228 Vali Loss: 4.103 Vali Acc: 0.870 Test Loss: 4.103 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.861199617385864
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 6.196 Vali Acc: 0.809 Test Loss: 6.196 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 2260050
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.7373223304748535
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.579 Vali Acc: 0.799 Test Loss: 0.579 Test Acc: 0.799
Validation loss decreased (inf --> -0.798629).  Saving model ...
Epoch: 2 cost time: 5.785663366317749
Epoch: 2, Steps: 17 | Train Loss: 0.829 Vali Loss: 0.757 Vali Acc: 0.788 Test Loss: 0.757 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.099728345870972
Epoch: 3, Steps: 17 | Train Loss: 0.571 Vali Loss: 2.221 Vali Acc: 0.594 Test Loss: 2.221 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.460821866989136
Epoch: 4, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.635 Vali Acc: 0.751 Test Loss: 1.635 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.775535583496094
Epoch: 5, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.103 Vali Acc: 0.720 Test Loss: 1.103 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.507205963134766
Epoch: 6, Steps: 17 | Train Loss: 0.736 Vali Loss: 1.110 Vali Acc: 0.833 Test Loss: 1.110 Test Acc: 0.833
Validation loss decreased (-0.798629 --> -0.832753).  Saving model ...
Epoch: 7 cost time: 5.500107288360596
Epoch: 7, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.568 Vali Acc: 0.799 Test Loss: 1.568 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.572012662887573
Epoch: 8, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.065 Vali Acc: 0.843 Test Loss: 1.065 Test Acc: 0.843
Validation loss decreased (-0.832753 --> -0.842993).  Saving model ...
Epoch: 9 cost time: 6.930108308792114
Epoch: 9, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.463 Vali Acc: 0.802 Test Loss: 1.463 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.8209381103515625
Epoch: 10, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.554 Vali Acc: 0.792 Test Loss: 1.554 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.593542814254761
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.957 Vali Acc: 0.802 Test Loss: 1.957 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.704355478286743
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 2.824 Vali Acc: 0.730 Test Loss: 2.824 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.70720362663269
Epoch: 13, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.425 Vali Acc: 0.816 Test Loss: 2.425 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.125502347946167
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.913 Vali Acc: 0.792 Test Loss: 2.913 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.601017475128174
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.311 Vali Acc: 0.918 Test Loss: 1.311 Test Acc: 0.918
Validation loss decreased (-0.842993 --> -0.918076).  Saving model ...
Epoch: 16 cost time: 5.885962247848511
Epoch: 16, Steps: 17 | Train Loss: 0.221 Vali Loss: 4.776 Vali Acc: 0.744 Test Loss: 4.776 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.378924369812012
Epoch: 17, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.615 Vali Acc: 0.788 Test Loss: 3.615 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.745434999465942
Epoch: 18, Steps: 17 | Train Loss: 0.093 Vali Loss: 5.024 Vali Acc: 0.758 Test Loss: 5.024 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.436864614486694
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 2.568 Vali Acc: 0.836 Test Loss: 2.568 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.810088396072388
Epoch: 20, Steps: 17 | Train Loss: 0.308 Vali Loss: 7.161 Vali Acc: 0.754 Test Loss: 7.161 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.727741718292236
Epoch: 21, Steps: 17 | Train Loss: 0.662 Vali Loss: 2.848 Vali Acc: 0.846 Test Loss: 2.848 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.944517135620117
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 5.356 Vali Acc: 0.778 Test Loss: 5.356 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.529608488082886
Epoch: 23, Steps: 17 | Train Loss: 0.053 Vali Loss: 5.103 Vali Acc: 0.778 Test Loss: 5.103 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.634976625442505
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.709 Vali Acc: 0.870 Test Loss: 2.709 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.7341625690460205
Epoch: 25, Steps: 17 | Train Loss: 0.056 Vali Loss: 3.957 Vali Acc: 0.816 Test Loss: 3.957 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 2260050
model size : 18.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 10.76940131187439
Epoch: 1, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
Validation loss decreased (inf --> -0.812279).  Saving model ...
Epoch: 2 cost time: 8.289739608764648
Epoch: 2, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.191 Vali Acc: 0.696 Test Loss: 1.191 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.074542284011841
Epoch: 3, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.023 Vali Acc: 0.652 Test Loss: 2.023 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.77893853187561
Epoch: 4, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.126 Vali Acc: 0.782 Test Loss: 1.126 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.484095335006714
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.990 Vali Acc: 0.805 Test Loss: 0.990 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.05549693107605
Epoch: 6, Steps: 17 | Train Loss: 0.759 Vali Loss: 3.330 Vali Acc: 0.775 Test Loss: 3.330 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.689387798309326
Epoch: 7, Steps: 17 | Train Loss: 2.793 Vali Loss: 2.445 Vali Acc: 0.833 Test Loss: 2.445 Test Acc: 0.833
Validation loss decreased (-0.812279 --> -0.832740).  Saving model ...
Epoch: 8 cost time: 7.525790452957153
Epoch: 8, Steps: 17 | Train Loss: 0.995 Vali Loss: 2.605 Vali Acc: 0.785 Test Loss: 2.605 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.731414556503296
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.572 Vali Acc: 0.863 Test Loss: 1.572 Test Acc: 0.863
Validation loss decreased (-0.832740 --> -0.863466).  Saving model ...
Epoch: 10 cost time: 7.467074155807495
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.869 Vali Acc: 0.754 Test Loss: 2.869 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.506018161773682
Epoch: 11, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.325 Vali Acc: 0.884 Test Loss: 1.325 Test Acc: 0.884
Validation loss decreased (-0.863466 --> -0.883946).  Saving model ...
Epoch: 12 cost time: 7.872082233428955
Epoch: 12, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.647 Vali Acc: 0.867 Test Loss: 1.647 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.752734422683716
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.786 Vali Acc: 0.863 Test Loss: 1.786 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.662605047225952
Epoch: 14, Steps: 17 | Train Loss: 0.363 Vali Loss: 3.191 Vali Acc: 0.840 Test Loss: 3.191 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.3735857009887695
Epoch: 15, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.902 Vali Acc: 0.816 Test Loss: 2.902 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.14647912979126
Epoch: 16, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.906 Vali Acc: 0.877 Test Loss: 1.906 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.336052179336548
Epoch: 17, Steps: 17 | Train Loss: 0.178 Vali Loss: 2.773 Vali Acc: 0.846 Test Loss: 2.773 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.900068759918213
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 2.271 Vali Acc: 0.846 Test Loss: 2.271 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.646293878555298
Epoch: 19, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.563 Vali Acc: 0.860 Test Loss: 2.563 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.474652528762817
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 3.062 Vali Acc: 0.829 Test Loss: 3.062 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.369880437850952
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 4.282 Vali Acc: 0.805 Test Loss: 4.282 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 2128978
model size : 17.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 8.888159990310669
Epoch: 1, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.717 Vali Acc: 0.805 Test Loss: 0.717 Test Acc: 0.805
Validation loss decreased (inf --> -0.805454).  Saving model ...
Epoch: 2 cost time: 6.778301954269409
Epoch: 2, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.908 Vali Acc: 0.741 Test Loss: 0.908 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.936768531799316
Epoch: 3, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.594 Vali Acc: 0.604 Test Loss: 2.594 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.469798803329468
Epoch: 4, Steps: 17 | Train Loss: 0.690 Vali Loss: 3.343 Vali Acc: 0.666 Test Loss: 3.343 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.224719285964966
Epoch: 5, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.871 Vali Acc: 0.891 Test Loss: 0.871 Test Acc: 0.891
Validation loss decreased (-0.805454 --> -0.890776).  Saving model ...
Epoch: 6 cost time: 6.840630054473877
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 1.188 Vali Acc: 0.778 Test Loss: 1.188 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.412496566772461
Epoch: 7, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.406 Vali Acc: 0.724 Test Loss: 2.406 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.0821614265441895
Epoch: 8, Steps: 17 | Train Loss: 1.072 Vali Loss: 3.383 Vali Acc: 0.788 Test Loss: 3.383 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.929993391036987
Epoch: 9, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.157 Vali Acc: 0.915 Test Loss: 1.157 Test Acc: 0.915
Validation loss decreased (-0.890776 --> -0.914664).  Saving model ...
Epoch: 10 cost time: 7.330905914306641
Epoch: 10, Steps: 17 | Train Loss: 0.777 Vali Loss: 7.606 Vali Acc: 0.662 Test Loss: 7.606 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.098944425582886
Epoch: 11, Steps: 17 | Train Loss: 2.470 Vali Loss: 4.338 Vali Acc: 0.771 Test Loss: 4.338 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.775355339050293
Epoch: 12, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.944 Vali Acc: 0.867 Test Loss: 1.944 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.165076732635498
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 3.146 Vali Acc: 0.765 Test Loss: 3.146 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.186404228210449
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.105 Vali Acc: 0.843 Test Loss: 2.105 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.955319166183472
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 3.475 Vali Acc: 0.809 Test Loss: 3.475 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.574688673019409
Epoch: 16, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.890 Vali Acc: 0.833 Test Loss: 2.890 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.148082971572876
Epoch: 17, Steps: 17 | Train Loss: 0.310 Vali Loss: 2.776 Vali Acc: 0.823 Test Loss: 2.776 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.103579044342041
Epoch: 18, Steps: 17 | Train Loss: 0.496 Vali Loss: 4.010 Vali Acc: 0.833 Test Loss: 4.010 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.056889772415161
Epoch: 19, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.887 Vali Acc: 0.863 Test Loss: 2.887 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 2128978
model size : 17.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 9.77962327003479
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.635 Vali Acc: 0.823 Test Loss: 0.635 Test Acc: 0.823
Validation loss decreased (inf --> -0.822519).  Saving model ...
Epoch: 2 cost time: 6.758526086807251
Epoch: 2, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.778125524520874
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.502 Vali Acc: 0.843 Test Loss: 0.502 Test Acc: 0.843
Validation loss decreased (-0.822519 --> -0.842998).  Saving model ...
Epoch: 4 cost time: 6.7096171379089355
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 1.351 Vali Acc: 0.812 Test Loss: 1.351 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.908729314804077
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 1.696 Vali Acc: 0.724 Test Loss: 1.696 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.775886058807373
Epoch: 6, Steps: 17 | Train Loss: 0.427 Vali Loss: 1.998 Vali Acc: 0.662 Test Loss: 1.998 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.284159898757935
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 1.960 Vali Acc: 0.792 Test Loss: 1.960 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.3785786628723145
Epoch: 8, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.518 Vali Acc: 0.785 Test Loss: 1.518 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.899363994598389
Epoch: 9, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.579 Vali Acc: 0.805 Test Loss: 1.579 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.406975030899048
Epoch: 10, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.071 Vali Acc: 0.857 Test Loss: 1.071 Test Acc: 0.857
Validation loss decreased (-0.842998 --> -0.856645).  Saving model ...
Epoch: 11 cost time: 6.352092742919922
Epoch: 11, Steps: 17 | Train Loss: 0.312 Vali Loss: 2.642 Vali Acc: 0.785 Test Loss: 2.642 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.991308212280273
Epoch: 12, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.411 Vali Acc: 0.867 Test Loss: 1.411 Test Acc: 0.867
Validation loss decreased (-0.856645 --> -0.866880).  Saving model ...
Epoch: 13 cost time: 6.811938285827637
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.104 Vali Acc: 0.894 Test Loss: 1.104 Test Acc: 0.894
Validation loss decreased (-0.866880 --> -0.894187).  Saving model ...
Epoch: 14 cost time: 5.977057218551636
Epoch: 14, Steps: 17 | Train Loss: 0.165 Vali Loss: 2.356 Vali Acc: 0.771 Test Loss: 2.356 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.707892656326294
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.808 Vali Acc: 0.836 Test Loss: 2.808 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.482173681259155
Epoch: 16, Steps: 17 | Train Loss: 0.468 Vali Loss: 4.452 Vali Acc: 0.744 Test Loss: 4.452 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.191625356674194
Epoch: 17, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.670 Vali Acc: 0.860 Test Loss: 2.670 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.283261775970459
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 3.493 Vali Acc: 0.802 Test Loss: 3.493 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.360994815826416
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.330 Vali Acc: 0.870 Test Loss: 2.330 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.406703948974609
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.383 Vali Acc: 0.870 Test Loss: 2.383 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.280431509017944
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 4.188 Vali Acc: 0.823 Test Loss: 4.188 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.476531744003296
Epoch: 22, Steps: 17 | Train Loss: 0.362 Vali Loss: 4.840 Vali Acc: 0.788 Test Loss: 4.840 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.552696466445923
Epoch: 23, Steps: 17 | Train Loss: 0.171 Vali Loss: 3.329 Vali Acc: 0.857 Test Loss: 3.329 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 2128978
model size : 17.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.4801344871521
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.889 Vali Acc: 0.744 Test Loss: 0.889 Test Acc: 0.744
Validation loss decreased (inf --> -0.744018).  Saving model ...
Epoch: 2 cost time: 5.964900493621826
Epoch: 2, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.956 Vali Acc: 0.720 Test Loss: 0.956 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0116472244262695
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.564 Vali Acc: 0.836 Test Loss: 0.564 Test Acc: 0.836
Validation loss decreased (-0.744018 --> -0.836172).  Saving model ...
Epoch: 4 cost time: 5.700131893157959
Epoch: 4, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.586 Vali Acc: 0.795 Test Loss: 1.586 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.728440999984741
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.596 Vali Acc: 0.676 Test Loss: 1.596 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.978906631469727
Epoch: 6, Steps: 17 | Train Loss: 0.352 Vali Loss: 2.905 Vali Acc: 0.580 Test Loss: 2.905 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.506504058837891
Epoch: 7, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.054 Vali Acc: 0.823 Test Loss: 1.054 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.013044357299805
Epoch: 8, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.754 Vali Acc: 0.853 Test Loss: 0.754 Test Acc: 0.853
Validation loss decreased (-0.836172 --> -0.853235).  Saving model ...
Epoch: 9 cost time: 5.815445899963379
Epoch: 9, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.981 Vali Acc: 0.744 Test Loss: 1.981 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.2589805126190186
Epoch: 10, Steps: 17 | Train Loss: 0.546 Vali Loss: 1.627 Vali Acc: 0.812 Test Loss: 1.627 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.148586988449097
Epoch: 11, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.124 Vali Acc: 0.799 Test Loss: 2.124 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.526135683059692
Epoch: 12, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.953 Vali Acc: 0.768 Test Loss: 2.953 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.955137491226196
Epoch: 13, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.175 Vali Acc: 0.778 Test Loss: 2.175 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.022406816482544
Epoch: 14, Steps: 17 | Train Loss: 0.693 Vali Loss: 3.036 Vali Acc: 0.795 Test Loss: 3.036 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.85176944732666
Epoch: 15, Steps: 17 | Train Loss: 0.272 Vali Loss: 4.143 Vali Acc: 0.775 Test Loss: 4.143 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.565137624740601
Epoch: 16, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.677 Vali Acc: 0.771 Test Loss: 2.677 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.702405691146851
Epoch: 17, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.251 Vali Acc: 0.802 Test Loss: 3.251 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.793520450592041
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 4.181 Vali Acc: 0.775 Test Loss: 4.181 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 2128978
model size : 17.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.4607343673706055
Epoch: 1, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.611 Vali Acc: 0.840 Test Loss: 0.611 Test Acc: 0.840
Validation loss decreased (inf --> -0.839584).  Saving model ...
Epoch: 2 cost time: 5.221871614456177
Epoch: 2, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.897 Vali Acc: 0.724 Test Loss: 0.897 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.373477935791016
Epoch: 3, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.896 Vali Acc: 0.727 Test Loss: 0.896 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.01939058303833
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 1.479 Vali Acc: 0.686 Test Loss: 1.479 Test Acc: 0.686
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.069668292999268
Epoch: 5, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
Validation loss decreased (-0.839584 --> -0.880541).  Saving model ...
Epoch: 6 cost time: 5.397439956665039
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.851 Vali Acc: 0.823 Test Loss: 0.851 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.8333823680877686
Epoch: 7, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.404 Vali Acc: 0.765 Test Loss: 1.404 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.715578556060791
Epoch: 8, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.106 Vali Acc: 0.833 Test Loss: 1.106 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.322224140167236
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.537 Vali Acc: 0.829 Test Loss: 1.537 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.445862054824829
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.887 Vali Acc: 0.761 Test Loss: 1.887 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.151103734970093
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.372 Vali Acc: 0.836 Test Loss: 1.372 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.259774446487427
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.514 Vali Acc: 0.819 Test Loss: 1.514 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.981943130493164
Epoch: 13, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.600 Vali Acc: 0.836 Test Loss: 1.600 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.385228395462036
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.515 Vali Acc: 0.840 Test Loss: 1.515 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.056443214416504
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.862 Vali Acc: 0.795 Test Loss: 1.862 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 2834002
model size : 15.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.410034656524658
Epoch: 1, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.599 Vali Acc: 0.840 Test Loss: 0.599 Test Acc: 0.840
Validation loss decreased (inf --> -0.839584).  Saving model ...
Epoch: 2 cost time: 5.031871318817139
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.527 Vali Acc: 0.802 Test Loss: 0.527 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.793698310852051
Epoch: 3, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.750 Vali Acc: 0.751 Test Loss: 0.750 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.873208999633789
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.181 Vali Acc: 0.706 Test Loss: 1.181 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.617764949798584
Epoch: 5, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.543 Vali Acc: 0.877 Test Loss: 0.543 Test Acc: 0.877
Validation loss decreased (-0.839584 --> -0.877128).  Saving model ...
Epoch: 6 cost time: 5.702594041824341
Epoch: 6, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.556 Vali Acc: 0.860 Test Loss: 0.556 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2881810665130615
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.546 Vali Acc: 0.717 Test Loss: 1.546 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.378188133239746
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.660 Vali Acc: 0.898 Test Loss: 0.660 Test Acc: 0.898
Validation loss decreased (-0.877128 --> -0.897604).  Saving model ...
Epoch: 9 cost time: 5.114865303039551
Epoch: 9, Steps: 17 | Train Loss: 0.363 Vali Loss: 3.408 Vali Acc: 0.703 Test Loss: 3.408 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.161440134048462
Epoch: 10, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.931 Vali Acc: 0.863 Test Loss: 1.931 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.173651695251465
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.515 Vali Acc: 0.809 Test Loss: 1.515 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.509233236312866
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.561 Vali Acc: 0.826 Test Loss: 1.561 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.34843635559082
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.782 Vali Acc: 0.788 Test Loss: 1.782 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.709575891494751
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.480 Vali Acc: 0.850 Test Loss: 1.480 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.6243109703063965
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.331 Vali Acc: 0.867 Test Loss: 1.331 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.704079627990723
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.587 Vali Acc: 0.812 Test Loss: 1.587 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.884709596633911
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.765 Vali Acc: 0.850 Test Loss: 1.765 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.384563207626343
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.740 Vali Acc: 0.853 Test Loss: 1.740 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 2834002
model size : 15.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.220230340957642
Epoch: 1, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.634 Vali Acc: 0.829 Test Loss: 0.634 Test Acc: 0.829
Validation loss decreased (inf --> -0.829345).  Saving model ...
Epoch: 2 cost time: 4.65137243270874
Epoch: 2, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.425 Vali Acc: 0.853 Test Loss: 0.425 Test Acc: 0.853
Validation loss decreased (-0.829345 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 4.217778921127319
Epoch: 3, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
Validation loss decreased (-0.853238 --> -0.890781).  Saving model ...
Epoch: 4 cost time: 4.621555805206299
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.148 Vali Acc: 0.686 Test Loss: 1.148 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.741318464279175
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.680 Vali Acc: 0.829 Test Loss: 0.680 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.702540159225464
Epoch: 6, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.669 Vali Acc: 0.836 Test Loss: 0.669 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5361950397491455
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.178 Vali Acc: 0.730 Test Loss: 1.178 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.278098821640015
Epoch: 8, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.774 Vali Acc: 0.812 Test Loss: 0.774 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.819575548171997
Epoch: 9, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.096 Vali Acc: 0.799 Test Loss: 1.096 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.6780781745910645
Epoch: 10, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.998 Vali Acc: 0.898 Test Loss: 0.998 Test Acc: 0.898
Validation loss decreased (-0.890781 --> -0.897601).  Saving model ...
Epoch: 11 cost time: 5.008843421936035
Epoch: 11, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.420 Vali Acc: 0.812 Test Loss: 1.420 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.751013278961182
Epoch: 12, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.872 Vali Acc: 0.863 Test Loss: 0.872 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.653405666351318
Epoch: 13, Steps: 17 | Train Loss: 0.653 Vali Loss: 3.916 Vali Acc: 0.717 Test Loss: 3.916 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.892021894454956
Epoch: 14, Steps: 17 | Train Loss: 0.376 Vali Loss: 1.314 Vali Acc: 0.836 Test Loss: 1.314 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.009098052978516
Epoch: 15, Steps: 17 | Train Loss: 0.260 Vali Loss: 2.278 Vali Acc: 0.792 Test Loss: 2.278 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.532644271850586
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.558 Vali Acc: 0.819 Test Loss: 1.558 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.300396203994751
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.844 Vali Acc: 0.809 Test Loss: 2.844 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.9109203815460205
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 2.153 Vali Acc: 0.853 Test Loss: 2.153 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.864809513092041
Epoch: 19, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.395 Vali Acc: 0.788 Test Loss: 2.395 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.8607189655303955
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.785 Vali Acc: 0.843 Test Loss: 1.785 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 2834002
model size : 15.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.682044267654419
Epoch: 1, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.660 Vali Acc: 0.819 Test Loss: 0.660 Test Acc: 0.819
Validation loss decreased (inf --> -0.819106).  Saving model ...
Epoch: 2 cost time: 4.344473361968994
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.403 Vali Acc: 0.840 Test Loss: 0.403 Test Acc: 0.840
Validation loss decreased (-0.819106 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 4.470570087432861
Epoch: 3, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.065 Vali Acc: 0.672 Test Loss: 1.065 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.186002492904663
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.268 Vali Acc: 0.655 Test Loss: 1.268 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.407485723495483
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.147 Vali Acc: 0.727 Test Loss: 1.147 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.499711990356445
Epoch: 6, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
Validation loss decreased (-0.839586 --> -0.870302).  Saving model ...
Epoch: 7 cost time: 4.35516095161438
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.947 Vali Acc: 0.788 Test Loss: 0.947 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.423477649688721
Epoch: 8, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.320 Vali Acc: 0.717 Test Loss: 1.320 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.434515476226807
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.388 Vali Acc: 0.741 Test Loss: 1.388 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.596540451049805
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.802 Vali Acc: 0.836 Test Loss: 0.802 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.318004608154297
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.685 Vali Acc: 0.884 Test Loss: 0.685 Test Acc: 0.884
Validation loss decreased (-0.870302 --> -0.883952).  Saving model ...
Epoch: 12 cost time: 4.119457483291626
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.459 Vali Acc: 0.765 Test Loss: 1.459 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.442429780960083
Epoch: 13, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.929 Vali Acc: 0.894 Test Loss: 0.929 Test Acc: 0.894
Validation loss decreased (-0.883952 --> -0.894189).  Saving model ...
Epoch: 14 cost time: 4.398352861404419
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.211 Vali Acc: 0.853 Test Loss: 1.211 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.6750664710998535
Epoch: 15, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.980 Vali Acc: 0.795 Test Loss: 1.980 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.6997926235198975
Epoch: 16, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.487 Vali Acc: 0.843 Test Loss: 1.487 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.176314115524292
Epoch: 17, Steps: 17 | Train Loss: 0.211 Vali Loss: 2.081 Vali Acc: 0.771 Test Loss: 2.081 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.1345298290252686
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.236 Vali Acc: 0.874 Test Loss: 1.236 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.342739820480347
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.743 Vali Acc: 0.819 Test Loss: 1.743 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.884035348892212
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.149 Vali Acc: 0.891 Test Loss: 1.149 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9269137382507324
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.859 Vali Acc: 0.802 Test Loss: 2.859 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.483340740203857
Epoch: 22, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.427 Vali Acc: 0.863 Test Loss: 1.427 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.467673301696777
Epoch: 23, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.680 Vali Acc: 0.799 Test Loss: 2.680 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 2834002
model size : 15.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.6231067180633545
Epoch: 1, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 4.75151801109314
Epoch: 2, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.16800332069397
Epoch: 3, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.002 Vali Acc: 0.713 Test Loss: 1.002 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.26592493057251
Epoch: 4, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.398 Vali Acc: 0.884 Test Loss: 0.398 Test Acc: 0.884
Validation loss decreased (-0.808869 --> -0.883955).  Saving model ...
Epoch: 5 cost time: 4.429144620895386
Epoch: 5, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.472 Vali Acc: 0.758 Test Loss: 1.472 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.635836362838745
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.515 Vali Acc: 0.887 Test Loss: 0.515 Test Acc: 0.887
Validation loss decreased (-0.883955 --> -0.887367).  Saving model ...
Epoch: 7 cost time: 5.2054455280303955
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.702 Vali Acc: 0.836 Test Loss: 0.702 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.967506647109985
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 2.458 Vali Acc: 0.652 Test Loss: 2.458 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.950828552246094
Epoch: 9, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.394 Vali Acc: 0.860 Test Loss: 1.394 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.310672760009766
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.791 Vali Acc: 0.802 Test Loss: 1.791 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.135067939758301
Epoch: 11, Steps: 17 | Train Loss: 0.481 Vali Loss: 1.341 Vali Acc: 0.836 Test Loss: 1.341 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.356388568878174
Epoch: 12, Steps: 17 | Train Loss: 0.329 Vali Loss: 1.522 Vali Acc: 0.809 Test Loss: 1.522 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.7122557163238525
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.108 Vali Acc: 0.874 Test Loss: 1.108 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.88686466217041
Epoch: 14, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.524 Vali Acc: 0.829 Test Loss: 1.524 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.070966005325317
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.503 Vali Acc: 0.836 Test Loss: 1.503 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.363169431686401
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.317 Vali Acc: 0.836 Test Loss: 1.317 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1785426
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.2309160232543945
Epoch: 1, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 4.739358901977539
Epoch: 2, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.857 Vali Acc: 0.768 Test Loss: 0.857 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.679870843887329
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.927 Vali Acc: 0.727 Test Loss: 0.927 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.594141960144043
Epoch: 4, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
Validation loss decreased (-0.832760 --> -0.866891).  Saving model ...
Epoch: 5 cost time: 4.743490695953369
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.449 Vali Acc: 0.857 Test Loss: 0.449 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.854339361190796
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.303 Vali Acc: 0.730 Test Loss: 1.303 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.339120149612427
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.903 Vali Acc: 0.853 Test Loss: 0.903 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.68912672996521
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.120 Vali Acc: 0.775 Test Loss: 1.120 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.5373194217681885
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.315 Vali Acc: 0.870 Test Loss: 1.315 Test Acc: 0.870
Validation loss decreased (-0.866891 --> -0.870294).  Saving model ...
Epoch: 10 cost time: 4.590892553329468
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 2.435 Vali Acc: 0.734 Test Loss: 2.435 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.59718656539917
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.850 Vali Acc: 0.894 Test Loss: 0.850 Test Acc: 0.894
Validation loss decreased (-0.870294 --> -0.894189).  Saving model ...
Epoch: 12 cost time: 5.050761699676514
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.355 Vali Acc: 0.823 Test Loss: 1.355 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.802129507064819
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.297 Vali Acc: 0.850 Test Loss: 1.297 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.4129273891448975
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.485 Vali Acc: 0.857 Test Loss: 1.485 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.5220091342926025
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.460 Vali Acc: 0.812 Test Loss: 1.460 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.54952073097229
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.809 Vali Acc: 0.857 Test Loss: 1.809 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.736136198043823
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.729 Vali Acc: 0.833 Test Loss: 1.729 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.083293676376343
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.880 Vali Acc: 0.809 Test Loss: 1.880 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.889837026596069
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.595 Vali Acc: 0.809 Test Loss: 1.595 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.492483377456665
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.669 Vali Acc: 0.860 Test Loss: 1.669 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.68939995765686
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.049 Vali Acc: 0.860 Test Loss: 2.049 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 1785426
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.135683298110962
Epoch: 1, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 4.366853475570679
Epoch: 2, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.714 Vali Acc: 0.785 Test Loss: 0.714 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.954989194869995
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 1.055 Vali Acc: 0.679 Test Loss: 1.055 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.177445650100708
Epoch: 4, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.366 Vali Acc: 0.843 Test Loss: 0.366 Test Acc: 0.843
Validation loss decreased (-0.815695 --> -0.843000).  Saving model ...
Epoch: 5 cost time: 4.335643768310547
Epoch: 5, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
Validation loss decreased (-0.843000 --> -0.894194).  Saving model ...
Epoch: 6 cost time: 4.458398103713989
Epoch: 6, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
Validation loss decreased (-0.894194 --> -0.911258).  Saving model ...
Epoch: 7 cost time: 4.281774044036865
Epoch: 7, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.256 Vali Acc: 0.771 Test Loss: 1.256 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.614989280700684
Epoch: 8, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.998 Vali Acc: 0.785 Test Loss: 0.998 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.44192361831665
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.244 Vali Acc: 0.850 Test Loss: 1.244 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.669337511062622
Epoch: 10, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.634 Vali Acc: 0.771 Test Loss: 1.634 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.203700304031372
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.320 Vali Acc: 0.863 Test Loss: 1.320 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.3945701122283936
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.311 Vali Acc: 0.826 Test Loss: 1.311 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.2091639041900635
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.367 Vali Acc: 0.833 Test Loss: 1.367 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.1781227588653564
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.881 Vali Acc: 0.802 Test Loss: 1.881 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.478257894515991
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.401 Vali Acc: 0.812 Test Loss: 1.401 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.546952962875366
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.714 Vali Acc: 0.744 Test Loss: 2.714 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 1785426
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.545153379440308
Epoch: 1, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.427 Vali Acc: 0.857 Test Loss: 0.427 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 3.8380846977233887
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.778 Vali Acc: 0.720 Test Loss: 0.778 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.889733076095581
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.920 Vali Acc: 0.666 Test Loss: 0.920 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.738008499145508
Epoch: 4, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.100 Vali Acc: 0.635 Test Loss: 1.100 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.97296404838562
Epoch: 5, Steps: 17 | Train Loss: 1.015 Vali Loss: 0.807 Vali Acc: 0.833 Test Loss: 0.807 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.331238031387329
Epoch: 6, Steps: 17 | Train Loss: 0.458 Vali Loss: 2.430 Vali Acc: 0.614 Test Loss: 2.430 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.097159385681152
Epoch: 7, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.818 Vali Acc: 0.857 Test Loss: 0.818 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9493043422698975
Epoch: 8, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.623 Vali Acc: 0.884 Test Loss: 0.623 Test Acc: 0.884
Validation loss decreased (-0.856651 --> -0.883953).  Saving model ...
Epoch: 9 cost time: 3.907015562057495
Epoch: 9, Steps: 17 | Train Loss: 0.411 Vali Loss: 1.172 Vali Acc: 0.805 Test Loss: 1.172 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.982252359390259
Epoch: 10, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.982 Vali Acc: 0.758 Test Loss: 1.982 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6034348011016846
Epoch: 11, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.225 Vali Acc: 0.829 Test Loss: 1.225 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.713824510574341
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.067 Vali Acc: 0.840 Test Loss: 1.067 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.3341803550720215
Epoch: 13, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.578 Vali Acc: 0.887 Test Loss: 0.578 Test Acc: 0.887
Validation loss decreased (-0.883953 --> -0.887366).  Saving model ...
Epoch: 14 cost time: 4.042848825454712
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.383 Vali Acc: 0.809 Test Loss: 1.383 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.312422513961792
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.864 Vali Acc: 0.891 Test Loss: 0.864 Test Acc: 0.891
Validation loss decreased (-0.887366 --> -0.890776).  Saving model ...
Epoch: 16 cost time: 3.713193893432617
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.913 Vali Acc: 0.860 Test Loss: 0.913 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.779855728149414
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.428 Vali Acc: 0.805 Test Loss: 1.428 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7986552715301514
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.199 Vali Acc: 0.857 Test Loss: 1.199 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.129790306091309
Epoch: 19, Steps: 17 | Train Loss: 0.221 Vali Loss: 2.308 Vali Acc: 0.785 Test Loss: 2.308 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.205441236495972
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.110 Vali Acc: 0.881 Test Loss: 1.110 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8132317066192627
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.488 Vali Acc: 0.846 Test Loss: 1.488 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.797760009765625
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.104 Vali Acc: 0.826 Test Loss: 2.104 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.992471218109131
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.699 Vali Acc: 0.881 Test Loss: 1.699 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.888803720474243
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 2.407 Vali Acc: 0.795 Test Loss: 2.407 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7678301334381104
Epoch: 25, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.285 Vali Acc: 0.816 Test Loss: 2.285 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 1785426
model size : 11.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.107769966125488
Epoch: 1, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.836 Vali Acc: 0.703 Test Loss: 0.836 Test Acc: 0.703
Validation loss decreased (inf --> -0.703063).  Saving model ...
Epoch: 2 cost time: 4.4830756187438965
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.416 Vali Acc: 0.901 Test Loss: 0.416 Test Acc: 0.901
Validation loss decreased (-0.703063 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 4.200188636779785
Epoch: 3, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.621 Vali Acc: 0.785 Test Loss: 0.621 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8004841804504395
Epoch: 4, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.876 Vali Acc: 0.805 Test Loss: 0.876 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.602524995803833
Epoch: 5, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.673 Vali Acc: 0.826 Test Loss: 0.673 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.352281332015991
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.827 Vali Acc: 0.809 Test Loss: 0.827 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.184014797210693
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.8594701290130615
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.222 Vali Acc: 0.785 Test Loss: 1.222 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.716169357299805
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.364 Vali Acc: 0.836 Test Loss: 1.364 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.910097122192383
Epoch: 10, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.801 Vali Acc: 0.850 Test Loss: 0.801 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.610828399658203
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.306 Vali Acc: 0.823 Test Loss: 1.306 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.79486870765686
Epoch: 12, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.746 Vali Acc: 0.819 Test Loss: 1.746 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 1261138
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.125675439834595
Epoch: 1, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.824 Vali Acc: 0.706 Test Loss: 0.824 Test Acc: 0.706
Validation loss decreased (inf --> -0.706476).  Saving model ...
Epoch: 2 cost time: 4.127141237258911
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.384 Vali Acc: 0.908 Test Loss: 0.384 Test Acc: 0.908
Validation loss decreased (-0.706476 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 4.159607887268066
Epoch: 3, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.603 Vali Acc: 0.802 Test Loss: 0.603 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.231896162033081
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.620 Vali Acc: 0.860 Test Loss: 0.620 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.560050964355469
Epoch: 5, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.4307286739349365
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.113 Vali Acc: 0.720 Test Loss: 1.113 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.593729019165039
Epoch: 7, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.795 Vali Acc: 0.829 Test Loss: 0.795 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.156040906906128
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.470 Vali Acc: 0.894 Test Loss: 0.470 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.901031732559204
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.953 Vali Acc: 0.843 Test Loss: 0.953 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.081753253936768
Epoch: 10, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.629 Vali Acc: 0.874 Test Loss: 0.629 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.1417529582977295
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.151 Vali Acc: 0.795 Test Loss: 1.151 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.1701390743255615
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.066 Vali Acc: 0.846 Test Loss: 1.066 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 1261138
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.21958327293396
Epoch: 1, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.822 Vali Acc: 0.710 Test Loss: 0.822 Test Acc: 0.710
Validation loss decreased (inf --> -0.709889).  Saving model ...
Epoch: 2 cost time: 4.043576240539551
Epoch: 2, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
Validation loss decreased (-0.709889 --> -0.877128).  Saving model ...
Epoch: 3 cost time: 4.185624837875366
Epoch: 3, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.774646043777466
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.422 Vali Acc: 0.874 Test Loss: 0.422 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7969000339508057
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7994632720947266
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.673 Vali Acc: 0.788 Test Loss: 0.673 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.0187506675720215
Epoch: 7, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.592 Vali Acc: 0.860 Test Loss: 0.592 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8033697605133057
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.234 Vali Acc: 0.785 Test Loss: 1.234 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.124542236328125
Epoch: 9, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.480 Vali Acc: 0.805 Test Loss: 1.480 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.419158458709717
Epoch: 10, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.969 Vali Acc: 0.741 Test Loss: 1.969 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.205705165863037
Epoch: 11, Steps: 17 | Train Loss: 0.662 Vali Loss: 1.407 Vali Acc: 0.850 Test Loss: 1.407 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.426450967788696
Epoch: 12, Steps: 17 | Train Loss: 0.208 Vali Loss: 1.624 Vali Acc: 0.795 Test Loss: 1.624 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 1261138
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.367826700210571
Epoch: 1, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.692 Vali Acc: 0.754 Test Loss: 0.692 Test Acc: 0.754
Validation loss decreased (inf --> -0.754259).  Saving model ...
Epoch: 2 cost time: 3.820742607116699
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.557 Vali Acc: 0.823 Test Loss: 0.557 Test Acc: 0.823
Validation loss decreased (-0.754259 --> -0.822520).  Saving model ...
Epoch: 3 cost time: 3.83303165435791
Epoch: 3, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
Validation loss decreased (-0.822520 --> -0.832760).  Saving model ...
Epoch: 4 cost time: 3.537257432937622
Epoch: 4, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.497 Vali Acc: 0.860 Test Loss: 0.497 Test Acc: 0.860
Validation loss decreased (-0.832760 --> -0.860063).  Saving model ...
Epoch: 5 cost time: 3.7085020542144775
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.929029703140259
Epoch: 6, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.385 Vali Acc: 0.689 Test Loss: 1.385 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6838746070861816
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.353 Vali Acc: 0.881 Test Loss: 0.353 Test Acc: 0.881
Validation loss decreased (-0.860063 --> -0.880543).  Saving model ...
Epoch: 8 cost time: 3.7220146656036377
Epoch: 8, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9203107357025146
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 1.404 Vali Acc: 0.724 Test Loss: 1.404 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.896782875061035
Epoch: 10, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.868 Vali Acc: 0.860 Test Loss: 0.868 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.676923990249634
Epoch: 11, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.831 Vali Acc: 0.826 Test Loss: 0.831 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.612534523010254
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.894 Vali Acc: 0.792 Test Loss: 0.894 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6482510566711426
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.399 Vali Acc: 0.826 Test Loss: 1.399 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6107423305511475
Epoch: 14, Steps: 17 | Train Loss: 0.157 Vali Loss: 2.468 Vali Acc: 0.717 Test Loss: 2.468 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.856858491897583
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.206 Vali Acc: 0.850 Test Loss: 1.206 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9839582443237305
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.777 Vali Acc: 0.884 Test Loss: 0.777 Test Acc: 0.884
Validation loss decreased (-0.880543 --> -0.883951).  Saving model ...
Epoch: 17 cost time: 3.9186415672302246
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.745 Vali Acc: 0.782 Test Loss: 1.745 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.434751272201538
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.080 Vali Acc: 0.881 Test Loss: 1.080 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4528348445892334
Epoch: 19, Steps: 17 | Train Loss: 0.252 Vali Loss: 2.404 Vali Acc: 0.771 Test Loss: 2.404 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7465531826019287
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.444 Vali Acc: 0.870 Test Loss: 1.444 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7060980796813965
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.345 Vali Acc: 0.805 Test Loss: 2.345 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6742358207702637
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.837 Vali Acc: 0.846 Test Loss: 1.837 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8757970333099365
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.826 Vali Acc: 0.857 Test Loss: 1.826 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.055379152297974
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.890 Vali Acc: 0.840 Test Loss: 1.890 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.758049726486206
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.840 Test Loss: 2.378 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.5164544582366943
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.735 Vali Acc: 0.860 Test Loss: 1.735 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 1261138
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.964343070983887
Epoch: 1, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.448 Vali Acc: 0.846 Test Loss: 0.448 Test Acc: 0.846
Validation loss decreased (inf --> -0.846412).  Saving model ...
Epoch: 2 cost time: 4.913670778274536
Epoch: 2, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.433 Vali Acc: 0.805 Test Loss: 0.433 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.04660439491272
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.998 Vali Acc: 0.785 Test Loss: 0.998 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.958768367767334
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.567 Vali Acc: 0.843 Test Loss: 0.567 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9538636207580566
Epoch: 5, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.669 Vali Acc: 0.833 Test Loss: 0.669 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.013797044754028
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.585 Vali Acc: 0.877 Test Loss: 0.585 Test Acc: 0.877
Validation loss decreased (-0.846412 --> -0.877127).  Saving model ...
Epoch: 7 cost time: 4.359975576400757
Epoch: 7, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.009 Vali Acc: 0.666 Test Loss: 2.009 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.654774188995361
Epoch: 8, Steps: 17 | Train Loss: 0.642 Vali Loss: 1.512 Vali Acc: 0.812 Test Loss: 1.512 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.953160762786865
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.046 Vali Acc: 0.840 Test Loss: 1.046 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.79217004776001
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.901 Vali Acc: 0.840 Test Loss: 0.901 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.366837978363037
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.039 Vali Acc: 0.823 Test Loss: 1.039 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.257168769836426
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.277 Vali Acc: 0.795 Test Loss: 2.277 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.746744632720947
Epoch: 13, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.746 Vali Acc: 0.799 Test Loss: 1.746 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.365448951721191
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.970 Vali Acc: 0.901 Test Loss: 0.970 Test Acc: 0.901
Validation loss decreased (-0.877127 --> -0.901014).  Saving model ...
Epoch: 15 cost time: 4.796296119689941
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.693 Vali Acc: 0.826 Test Loss: 1.693 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.8546388149261475
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.546 Vali Acc: 0.853 Test Loss: 1.546 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.710647821426392
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.525 Vali Acc: 0.840 Test Loss: 1.525 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.692244052886963
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.242 Vali Acc: 0.853 Test Loss: 1.242 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.54817533493042
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.881 Test Loss: 1.190 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.325951099395752
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.441 Vali Acc: 0.843 Test Loss: 1.441 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.660825729370117
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.489 Vali Acc: 0.836 Test Loss: 1.489 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.614614486694336
Epoch: 22, Steps: 17 | Train Loss: 0.180 Vali Loss: 2.136 Vali Acc: 0.812 Test Loss: 2.136 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.542971134185791
Epoch: 23, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.224 Vali Acc: 0.833 Test Loss: 2.224 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.41982102394104
Epoch: 24, Steps: 17 | Train Loss: 0.177 Vali Loss: 2.797 Vali Acc: 0.765 Test Loss: 2.797 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 998994
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.212802886962891
Epoch: 1, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 4.383990049362183
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (-0.849825 --> -0.890782).  Saving model ...
Epoch: 3 cost time: 4.504457235336304
Epoch: 3, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.972 Vali Acc: 0.758 Test Loss: 0.972 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.322568893432617
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.256804466247559
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.830 Vali Acc: 0.765 Test Loss: 0.830 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.199533462524414
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.528 Vali Acc: 0.846 Test Loss: 0.528 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.912438154220581
Epoch: 7, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.962 Vali Acc: 0.795 Test Loss: 0.962 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.345613718032837
Epoch: 8, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.069 Vali Acc: 0.765 Test Loss: 1.069 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.171176910400391
Epoch: 9, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.504 Vali Acc: 0.904 Test Loss: 0.504 Test Acc: 0.904
Validation loss decreased (-0.890782 --> -0.904432).  Saving model ...
Epoch: 10 cost time: 4.204189777374268
Epoch: 10, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.827 Vali Acc: 0.771 Test Loss: 1.827 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.062922954559326
Epoch: 11, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.952 Vali Acc: 0.860 Test Loss: 0.952 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.05545973777771
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.315 Vali Acc: 0.833 Test Loss: 1.315 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8854057788848877
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.003 Vali Acc: 0.870 Test Loss: 1.003 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.032938241958618
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.048 Vali Acc: 0.860 Test Loss: 1.048 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.221414804458618
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.114 Vali Acc: 0.843 Test Loss: 1.114 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.141907691955566
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.165 Vali Acc: 0.734 Test Loss: 2.165 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.570457220077515
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.825 Vali Acc: 0.853 Test Loss: 1.825 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.0651960372924805
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.485 Vali Acc: 0.836 Test Loss: 1.485 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.206772327423096
Epoch: 19, Steps: 17 | Train Loss: 0.097 Vali Loss: 2.007 Vali Acc: 0.826 Test Loss: 2.007 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 998994
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.4538726806640625
Epoch: 1, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 4.0292088985443115
Epoch: 2, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
Validation loss decreased (-0.853238 --> -0.894195).  Saving model ...
Epoch: 3 cost time: 4.163989305496216
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.345 Vali Acc: 0.679 Test Loss: 1.345 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7559139728546143
Epoch: 4, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.468 Vali Acc: 0.863 Test Loss: 0.468 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.114842891693115
Epoch: 5, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.065 Vali Acc: 0.683 Test Loss: 1.065 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.904207468032837
Epoch: 6, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.753 Vali Acc: 0.860 Test Loss: 0.753 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8090851306915283
Epoch: 7, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.584 Vali Acc: 0.672 Test Loss: 2.584 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.190009355545044
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 1.226 Vali Acc: 0.765 Test Loss: 1.226 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.972728729248047
Epoch: 9, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.846 Vali Acc: 0.853 Test Loss: 0.846 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9779670238494873
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.801 Vali Acc: 0.829 Test Loss: 0.801 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7603161334991455
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.572 Vali Acc: 0.717 Test Loss: 1.572 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7092907428741455
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 1.533 Vali Acc: 0.826 Test Loss: 1.533 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 998994
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.724271535873413
Epoch: 1, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.437 Vali Acc: 0.857 Test Loss: 0.437 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 3.4008352756500244
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
Validation loss decreased (-0.856651 --> -0.873717).  Saving model ...
Epoch: 3 cost time: 3.661191940307617
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.029 Vali Acc: 0.713 Test Loss: 1.029 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2318522930145264
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.613 Vali Acc: 0.799 Test Loss: 0.613 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2385594844818115
Epoch: 5, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.267 Vali Acc: 0.635 Test Loss: 1.267 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4168405532836914
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.805 Vali Acc: 0.771 Test Loss: 0.805 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.413278102874756
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.236 Vali Acc: 0.679 Test Loss: 1.236 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3737881183624268
Epoch: 8, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.973 Vali Acc: 0.771 Test Loss: 0.973 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4997339248657227
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.537 Vali Acc: 0.669 Test Loss: 1.537 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.471160650253296
Epoch: 10, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.989 Vali Acc: 0.799 Test Loss: 0.989 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.487774133682251
Epoch: 11, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.715 Vali Acc: 0.765 Test Loss: 1.715 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.4230732917785645
Epoch: 12, Steps: 17 | Train Loss: 0.630 Vali Loss: 2.430 Vali Acc: 0.771 Test Loss: 2.430 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 998994
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.079559803009033
Epoch: 1, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 4.908182859420776
Epoch: 2, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.086861848831177
Epoch: 3, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.711 Vali Acc: 0.792 Test Loss: 0.711 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.0454933643341064
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.692 Vali Acc: 0.768 Test Loss: 0.692 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.998545169830322
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.503 Vali Acc: 0.857 Test Loss: 0.503 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856650).  Saving model ...
Epoch: 6 cost time: 4.724855661392212
Epoch: 6, Steps: 17 | Train Loss: 0.518 Vali Loss: 2.303 Vali Acc: 0.638 Test Loss: 2.303 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.829434394836426
Epoch: 7, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.625 Vali Acc: 0.870 Test Loss: 0.625 Test Acc: 0.870
Validation loss decreased (-0.856650 --> -0.870301).  Saving model ...
Epoch: 8 cost time: 4.803043842315674
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.727 Vali Acc: 0.853 Test Loss: 0.727 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.131383419036865
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.921 Vali Acc: 0.816 Test Loss: 0.921 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.979545831680298
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.016 Vali Acc: 0.795 Test Loss: 1.016 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.676042556762695
Epoch: 11, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.820 Vali Acc: 0.840 Test Loss: 0.820 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.34889030456543
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.303 Vali Acc: 0.843 Test Loss: 1.303 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.884510517120361
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.814 Vali Acc: 0.874 Test Loss: 0.814 Test Acc: 0.874
Validation loss decreased (-0.870301 --> -0.873712).  Saving model ...
Epoch: 14 cost time: 4.860112905502319
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.616 Vali Acc: 0.782 Test Loss: 1.616 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.17415976524353
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.453 Vali Acc: 0.826 Test Loss: 1.453 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.0115296840667725
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.707 Vali Acc: 0.836 Test Loss: 1.707 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.629876613616943
Epoch: 17, Steps: 17 | Train Loss: 0.285 Vali Loss: 1.245 Vali Acc: 0.891 Test Loss: 1.245 Test Acc: 0.891
Validation loss decreased (-0.873712 --> -0.890773).  Saving model ...
Epoch: 18 cost time: 4.335676193237305
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.467 Vali Acc: 0.836 Test Loss: 1.467 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.6068503856658936
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.208 Vali Acc: 0.857 Test Loss: 1.208 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.68682599067688
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.580 Vali Acc: 0.823 Test Loss: 1.580 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.958958864212036
Epoch: 21, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.631 Vali Acc: 0.836 Test Loss: 1.631 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.609692573547363
Epoch: 22, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.748 Vali Acc: 0.846 Test Loss: 1.748 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.140275716781616
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.126 Vali Acc: 0.857 Test Loss: 2.126 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.96826958656311
Epoch: 24, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.407 Vali Acc: 0.788 Test Loss: 2.407 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.872035264968872
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.316 Vali Acc: 0.863 Test Loss: 1.316 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.14541220664978
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.092 Vali Acc: 0.802 Test Loss: 2.092 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.583824157714844
Epoch: 27, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.231 Vali Acc: 0.860 Test Loss: 2.231 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 867922
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.176622629165649
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (inf --> -0.849824).  Saving model ...
Epoch: 2 cost time: 4.659031867980957
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.491290330886841
Epoch: 3, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.758 Vali Acc: 0.768 Test Loss: 0.758 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.616786956787109
Epoch: 4, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.876898288726807
Epoch: 5, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.410 Vali Acc: 0.884 Test Loss: 0.410 Test Acc: 0.884
Validation loss decreased (-0.849824 --> -0.883955).  Saving model ...
Epoch: 6 cost time: 4.950279474258423
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.470 Vali Acc: 0.689 Test Loss: 1.470 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.3239946365356445
Epoch: 7, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.311 Vali Acc: 0.758 Test Loss: 1.311 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.307309627532959
Epoch: 8, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.604 Vali Acc: 0.911 Test Loss: 0.604 Test Acc: 0.911
Validation loss decreased (-0.883955 --> -0.911257).  Saving model ...
Epoch: 9 cost time: 4.178429365158081
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.928 Vali Acc: 0.833 Test Loss: 0.928 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.1066412925720215
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.579 Vali Acc: 0.922 Test Loss: 0.579 Test Acc: 0.922
Validation loss decreased (-0.911257 --> -0.921496).  Saving model ...
Epoch: 11 cost time: 4.512739658355713
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.729 Vali Acc: 0.908 Test Loss: 0.729 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.546011686325073
Epoch: 12, Steps: 17 | Train Loss: 0.364 Vali Loss: 4.045 Vali Acc: 0.645 Test Loss: 4.045 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.105064630508423
Epoch: 13, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.106 Vali Acc: 0.857 Test Loss: 1.106 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.558369398117065
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.077 Vali Acc: 0.857 Test Loss: 1.077 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.633452892303467
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.109 Vali Acc: 0.846 Test Loss: 1.109 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.637756109237671
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.916 Vali Acc: 0.891 Test Loss: 0.916 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.6593053340911865
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.908 Test Loss: 0.841 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.775815486907959
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.863 Test Loss: 1.367 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.627569913864136
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.283 Vali Acc: 0.829 Test Loss: 1.283 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.503392696380615
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.963 Vali Acc: 0.775 Test Loss: 1.963 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 867922
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.810537815093994
Epoch: 1, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.509 Vali Acc: 0.843 Test Loss: 0.509 Test Acc: 0.843
Validation loss decreased (inf --> -0.842998).  Saving model ...
Epoch: 2 cost time: 4.3795695304870605
Epoch: 2, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.464 Vali Acc: 0.826 Test Loss: 0.464 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.649333715438843
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.710 Vali Acc: 0.765 Test Loss: 0.710 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.131760358810425
Epoch: 4, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.613 Vali Acc: 0.601 Test Loss: 1.613 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.791975736618042
Epoch: 5, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
Validation loss decreased (-0.842998 --> -0.870303).  Saving model ...
Epoch: 6 cost time: 4.0467259883880615
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.740 Vali Acc: 0.792 Test Loss: 0.740 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.450056314468384
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.255 Vali Acc: 0.724 Test Loss: 1.255 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.55066180229187
Epoch: 8, Steps: 17 | Train Loss: 0.354 Vali Loss: 1.006 Vali Acc: 0.823 Test Loss: 1.006 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.315568923950195
Epoch: 9, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.963 Vali Acc: 0.785 Test Loss: 0.963 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7167344093322754
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.129 Vali Acc: 0.816 Test Loss: 1.129 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5603625774383545
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.818 Vali Acc: 0.874 Test Loss: 0.818 Test Acc: 0.874
Validation loss decreased (-0.870303 --> -0.873712).  Saving model ...
Epoch: 12 cost time: 3.7789194583892822
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.818 Vali Acc: 0.884 Test Loss: 0.818 Test Acc: 0.884
Validation loss decreased (-0.873712 --> -0.883951).  Saving model ...
Epoch: 13 cost time: 4.406177759170532
Epoch: 13, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.899 Vali Acc: 0.863 Test Loss: 0.899 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.436171054840088
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.781 Vali Acc: 0.870 Test Loss: 0.781 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.007401704788208
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.887 Vali Acc: 0.870 Test Loss: 0.887 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.903421640396118
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.172 Vali Acc: 0.816 Test Loss: 2.172 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.028877258300781
Epoch: 17, Steps: 17 | Train Loss: 0.532 Vali Loss: 3.009 Vali Acc: 0.727 Test Loss: 3.009 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.213003158569336
Epoch: 18, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.293 Vali Acc: 0.904 Test Loss: 1.293 Test Acc: 0.904
Validation loss decreased (-0.883951 --> -0.904424).  Saving model ...
Epoch: 19 cost time: 4.329071044921875
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.899 Vali Acc: 0.782 Test Loss: 1.899 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.050872325897217
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.483 Vali Acc: 0.826 Test Loss: 1.483 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.3746724128723145
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.011 Vali Acc: 0.823 Test Loss: 2.011 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.265906572341919
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.538 Vali Acc: 0.833 Test Loss: 1.538 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.156006574630737
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.254 Vali Acc: 0.884 Test Loss: 1.254 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9335503578186035
Epoch: 24, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.705 Vali Acc: 0.863 Test Loss: 1.705 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8146486282348633
Epoch: 25, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.539 Vali Acc: 0.870 Test Loss: 1.539 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.672533988952637
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 2.441 Vali Acc: 0.836 Test Loss: 2.441 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.7619733810424805
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.406 Vali Acc: 0.911 Test Loss: 1.406 Test Acc: 0.911
Validation loss decreased (-0.904424 --> -0.911249).  Saving model ...
Epoch: 28 cost time: 4.094009160995483
Epoch: 28, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.520 Vali Acc: 0.823 Test Loss: 2.520 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.224841833114624
Epoch: 29, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.809 Vali Acc: 0.846 Test Loss: 1.809 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.060739517211914
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.877 Test Loss: 1.985 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.127806186676025
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.631 Vali Acc: 0.846 Test Loss: 2.631 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.304595232009888
Epoch: 32, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.820 Vali Acc: 0.867 Test Loss: 2.820 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.478841781616211
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.194 Vali Acc: 0.846 Test Loss: 3.194 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.611194610595703
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.902 Vali Acc: 0.833 Test Loss: 2.902 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.200258731842041
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.957 Vali Acc: 0.812 Test Loss: 3.957 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.085949182510376
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.594 Vali Acc: 0.782 Test Loss: 3.594 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.194140195846558
Epoch: 37, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.433 Vali Acc: 0.809 Test Loss: 3.433 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 867922
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.492149591445923
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 3.4894766807556152
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.390 Vali Acc: 0.853 Test Loss: 0.390 Test Acc: 0.853
Validation loss decreased (-0.853238 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 3.7300782203674316
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.615 Vali Acc: 0.741 Test Loss: 0.615 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4257214069366455
Epoch: 4, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.297 Vali Acc: 0.904 Test Loss: 0.297 Test Acc: 0.904
Validation loss decreased (-0.853238 --> -0.904434).  Saving model ...
Epoch: 5 cost time: 3.3358571529388428
Epoch: 5, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.314 Vali Acc: 0.901 Test Loss: 0.314 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.945558786392212
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.681 Vali Acc: 0.785 Test Loss: 0.681 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.563053607940674
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.592 Vali Acc: 0.792 Test Loss: 0.592 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.391925096511841
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.507 Vali Acc: 0.884 Test Loss: 0.507 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.151249408721924
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.365074634552002
Epoch: 10, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.779 Vali Acc: 0.802 Test Loss: 0.779 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8367063999176025
Epoch: 11, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.124 Vali Acc: 0.812 Test Loss: 1.124 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.709505319595337
Epoch: 12, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.804 Vali Acc: 0.744 Test Loss: 1.804 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.5916037559509277
Epoch: 13, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.211 Vali Acc: 0.816 Test Loss: 1.211 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.940919876098633
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.875 Vali Acc: 0.881 Test Loss: 0.875 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 867922
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.975346088409424
Epoch: 1, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (inf --> -0.832759).  Saving model ...
Epoch: 2 cost time: 4.555315256118774
Epoch: 2, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
Validation loss decreased (-0.832759 --> -0.853237).  Saving model ...
Epoch: 3 cost time: 4.894195556640625
Epoch: 3, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.153 Vali Acc: 0.751 Test Loss: 1.153 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.378953695297241
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.748 Vali Acc: 0.833 Test Loss: 0.748 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.258964776992798
Epoch: 5, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.410 Vali Acc: 0.720 Test Loss: 1.410 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.082817077636719
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.6027374267578125
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.549 Vali Acc: 0.713 Test Loss: 1.549 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.539433002471924
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.549 Vali Acc: 0.877 Test Loss: 0.549 Test Acc: 0.877
Validation loss decreased (-0.853237 --> -0.877128).  Saving model ...
Epoch: 9 cost time: 4.851138353347778
Epoch: 9, Steps: 17 | Train Loss: 0.423 Vali Loss: 1.075 Vali Acc: 0.816 Test Loss: 1.075 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.969659090042114
Epoch: 10, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.948 Vali Acc: 0.853 Test Loss: 0.948 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.777062892913818
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.84012246131897
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.303 Vali Acc: 0.819 Test Loss: 1.303 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.578465938568115
Epoch: 13, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.129 Vali Acc: 0.843 Test Loss: 1.129 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.512389421463013
Epoch: 14, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.275 Vali Acc: 0.833 Test Loss: 1.275 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.567267179489136
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.289 Vali Acc: 0.863 Test Loss: 1.289 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.475442886352539
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.709 Vali Acc: 0.809 Test Loss: 1.709 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.768075704574585
Epoch: 17, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.326 Vali Acc: 0.829 Test Loss: 1.326 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.070558547973633
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.281 Vali Acc: 0.867 Test Loss: 1.281 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 802386
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.304739713668823
Epoch: 1, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.539 Vali Acc: 0.843 Test Loss: 0.539 Test Acc: 0.843
Validation loss decreased (inf --> -0.842998).  Saving model ...
Epoch: 2 cost time: 3.998579740524292
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4914305210113525
Epoch: 3, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.437577962875366
Epoch: 4, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.572 Vali Acc: 0.843 Test Loss: 0.572 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.043805122375488
Epoch: 5, Steps: 17 | Train Loss: 0.446 Vali Loss: 2.840 Vali Acc: 0.611 Test Loss: 2.840 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.222420692443848
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.671 Vali Acc: 0.863 Test Loss: 0.671 Test Acc: 0.863
Validation loss decreased (-0.842998 --> -0.863475).  Saving model ...
Epoch: 7 cost time: 4.669841051101685
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.417 Vali Acc: 0.700 Test Loss: 1.417 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3281402587890625
Epoch: 8, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.489805459976196
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.928 Vali Acc: 0.836 Test Loss: 0.928 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.412934303283691
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.951 Vali Acc: 0.795 Test Loss: 0.951 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.442562103271484
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.943 Vali Acc: 0.853 Test Loss: 0.943 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.472088813781738
Epoch: 12, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.031 Vali Acc: 0.761 Test Loss: 2.031 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.140251636505127
Epoch: 13, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.046 Vali Acc: 0.836 Test Loss: 1.046 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.788529634475708
Epoch: 14, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.643 Vali Acc: 0.782 Test Loss: 1.643 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.299668788909912
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.196 Vali Acc: 0.894 Test Loss: 1.196 Test Acc: 0.894
Validation loss decreased (-0.863475 --> -0.894186).  Saving model ...
Epoch: 16 cost time: 4.485364198684692
Epoch: 16, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.822 Vali Acc: 0.795 Test Loss: 1.822 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.507856369018555
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.201 Vali Acc: 0.809 Test Loss: 2.201 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.406841039657593
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.969 Vali Acc: 0.884 Test Loss: 0.969 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.410881519317627
Epoch: 19, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.223 Vali Acc: 0.785 Test Loss: 2.223 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.308817386627197
Epoch: 20, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.699 Vali Acc: 0.819 Test Loss: 1.699 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.450809001922607
Epoch: 21, Steps: 17 | Train Loss: 0.203 Vali Loss: 2.663 Vali Acc: 0.812 Test Loss: 2.663 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.367321729660034
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.846 Vali Acc: 0.850 Test Loss: 1.846 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.527285814285278
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.932 Vali Acc: 0.836 Test Loss: 1.932 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.28544807434082
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.909 Vali Acc: 0.833 Test Loss: 1.909 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.259199380874634
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.290 Vali Acc: 0.840 Test Loss: 2.290 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 802386
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.992847442626953
Epoch: 1, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
Validation loss decreased (inf --> -0.853237).  Saving model ...
Epoch: 2 cost time: 3.918318271636963
Epoch: 2, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.664 Vali Acc: 0.823 Test Loss: 0.664 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.217788457870483
Epoch: 3, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.998 Vali Acc: 0.597 Test Loss: 1.998 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9291107654571533
Epoch: 4, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
Validation loss decreased (-0.853237 --> -0.866890).  Saving model ...
Epoch: 5 cost time: 3.651937246322632
Epoch: 5, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.020 Vali Acc: 0.771 Test Loss: 1.020 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.47767972946167
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.718708038330078
Epoch: 7, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.830 Vali Acc: 0.819 Test Loss: 0.830 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.98313570022583
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.656 Vali Acc: 0.846 Test Loss: 0.656 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.308416366577148
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.499 Vali Acc: 0.904 Test Loss: 0.499 Test Acc: 0.904
Validation loss decreased (-0.866890 --> -0.904432).  Saving model ...
Epoch: 10 cost time: 4.156743764877319
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.881 Vali Acc: 0.863 Test Loss: 0.881 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.350646495819092
Epoch: 11, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.763 Vali Acc: 0.792 Test Loss: 1.763 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7092301845550537
Epoch: 12, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.779 Vali Acc: 0.809 Test Loss: 1.779 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.861316204071045
Epoch: 13, Steps: 17 | Train Loss: 0.300 Vali Loss: 1.582 Vali Acc: 0.758 Test Loss: 1.582 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.58739972114563
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.180 Vali Acc: 0.829 Test Loss: 1.180 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8914475440979004
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.955 Vali Acc: 0.898 Test Loss: 0.955 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7791976928710938
Epoch: 16, Steps: 17 | Train Loss: 0.225 Vali Loss: 3.904 Vali Acc: 0.720 Test Loss: 3.904 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7909109592437744
Epoch: 17, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.891 Vali Acc: 0.826 Test Loss: 1.891 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4863648414611816
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.822 Vali Acc: 0.823 Test Loss: 1.822 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8102595806121826
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.034 Vali Acc: 0.799 Test Loss: 2.034 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 802386
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.682699203491211
Epoch: 1, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (inf --> -0.853237).  Saving model ...
Epoch: 2 cost time: 3.313462734222412
Epoch: 2, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.699 Vali Acc: 0.812 Test Loss: 0.699 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4267172813415527
Epoch: 3, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5569210052490234
Epoch: 4, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.803 Vali Acc: 0.741 Test Loss: 0.803 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.480849266052246
Epoch: 5, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.399 Vali Acc: 0.734 Test Loss: 1.399 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5628178119659424
Epoch: 6, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.105 Vali Acc: 0.642 Test Loss: 2.105 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4028782844543457
Epoch: 7, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.728 Vali Acc: 0.802 Test Loss: 0.728 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8243765830993652
Epoch: 8, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.544 Vali Acc: 0.829 Test Loss: 0.544 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.02967643737793
Epoch: 9, Steps: 17 | Train Loss: 0.454 Vali Loss: 1.427 Vali Acc: 0.706 Test Loss: 1.427 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9546620845794678
Epoch: 10, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.897 Vali Acc: 0.812 Test Loss: 0.897 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.288398027420044
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 1.319 Vali Acc: 0.788 Test Loss: 1.319 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 802386
model size : 7.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.749136447906494
Epoch: 1, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 3.76798415184021
Epoch: 2, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
Validation loss decreased (-0.832760 --> -0.849825).  Saving model ...
Epoch: 3 cost time: 3.565047264099121
Epoch: 3, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.786 Vali Acc: 0.734 Test Loss: 0.786 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.438124179840088
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8729500770568848
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.647 Vali Acc: 0.785 Test Loss: 0.647 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8630616664886475
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.546 Vali Acc: 0.860 Test Loss: 0.546 Test Acc: 0.860
Validation loss decreased (-0.849825 --> -0.860063).  Saving model ...
Epoch: 7 cost time: 4.152439117431641
Epoch: 7, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.857930898666382
Epoch: 8, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.473 Vali Acc: 0.761 Test Loss: 1.473 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8236899375915527
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.723 Vali Acc: 0.816 Test Loss: 0.723 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.939007520675659
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.887 Vali Acc: 0.805 Test Loss: 0.887 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.692472219467163
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.749 Vali Acc: 0.860 Test Loss: 0.749 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8807928562164307
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.602 Vali Acc: 0.846 Test Loss: 0.602 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.822125196456909
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.868959903717041
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.707 Vali Acc: 0.863 Test Loss: 0.707 Test Acc: 0.863
Validation loss decreased (-0.860063 --> -0.863474).  Saving model ...
Epoch: 15 cost time: 4.175069093704224
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.845 Vali Acc: 0.853 Test Loss: 0.845 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.006642580032349
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.949 Vali Acc: 0.853 Test Loss: 0.949 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.803272008895874
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.799 Vali Acc: 0.826 Test Loss: 0.799 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6038613319396973
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.916 Vali Acc: 0.853 Test Loss: 0.916 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6622397899627686
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.504 Vali Acc: 0.823 Test Loss: 1.504 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6220054626464844
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.166 Vali Acc: 0.870 Test Loss: 1.166 Test Acc: 0.870
Validation loss decreased (-0.863474 --> -0.870296).  Saving model ...
Epoch: 21 cost time: 3.4839024543762207
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.598 Vali Acc: 0.823 Test Loss: 1.598 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8499996662139893
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.480 Vali Acc: 0.826 Test Loss: 1.480 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.434230804443359
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.549 Vali Acc: 0.836 Test Loss: 1.549 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.0640363693237305
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.444 Vali Acc: 0.833 Test Loss: 1.444 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9366753101348877
Epoch: 25, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.185 Vali Acc: 0.857 Test Loss: 1.185 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.740293502807617
Epoch: 26, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.757 Vali Acc: 0.802 Test Loss: 2.757 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.786116361618042
Epoch: 27, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.623 Vali Acc: 0.857 Test Loss: 1.623 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.6334855556488037
Epoch: 28, Steps: 17 | Train Loss: 0.158 Vali Loss: 2.144 Vali Acc: 0.826 Test Loss: 2.144 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.274213075637817
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.860 Test Loss: 1.621 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.126255750656128
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.484 Vali Acc: 0.857 Test Loss: 1.484 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 1351506
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.629543781280518
Epoch: 1, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 3.3457531929016113
Epoch: 2, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2790048122406006
Epoch: 3, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.574 Vali Acc: 0.795 Test Loss: 0.574 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.024064302444458
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.627 Vali Acc: 0.846 Test Loss: 0.627 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846410).  Saving model ...
Epoch: 5 cost time: 3.061905860900879
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.877 Vali Acc: 0.724 Test Loss: 0.877 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1492462158203125
Epoch: 6, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.782 Vali Acc: 0.809 Test Loss: 0.782 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3994128704071045
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.731 Vali Acc: 0.836 Test Loss: 0.731 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6537811756134033
Epoch: 8, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.560 Vali Acc: 0.823 Test Loss: 0.560 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6843767166137695
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.704 Vali Acc: 0.853 Test Loss: 0.704 Test Acc: 0.853
Validation loss decreased (-0.846410 --> -0.853235).  Saving model ...
Epoch: 10 cost time: 3.3198554515838623
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.862 Vali Acc: 0.833 Test Loss: 0.862 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2216837406158447
Epoch: 11, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.001 Vali Acc: 0.802 Test Loss: 1.001 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.119946002960205
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4779562950134277
Epoch: 13, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.119 Vali Acc: 0.816 Test Loss: 1.119 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7332465648651123
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.843 Vali Acc: 0.874 Test Loss: 0.843 Test Acc: 0.874
Validation loss decreased (-0.853235 --> -0.873712).  Saving model ...
Epoch: 15 cost time: 3.6034555435180664
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.307 Vali Acc: 0.802 Test Loss: 1.307 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3640689849853516
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.044 Vali Acc: 0.870 Test Loss: 1.044 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5526745319366455
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.228 Vali Acc: 0.816 Test Loss: 1.228 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.750429630279541
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.254 Vali Acc: 0.823 Test Loss: 1.254 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.752558946609497
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.885 Vali Acc: 0.898 Test Loss: 0.885 Test Acc: 0.898
Validation loss decreased (-0.873712 --> -0.897602).  Saving model ...
Epoch: 20 cost time: 3.658872365951538
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.083 Vali Acc: 0.843 Test Loss: 1.083 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.467153310775757
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.439892530441284
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.966 Vali Acc: 0.884 Test Loss: 0.966 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.597038745880127
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.366 Vali Acc: 0.809 Test Loss: 1.366 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.5997982025146484
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.190 Vali Acc: 0.843 Test Loss: 1.190 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6382813453674316
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.277 Vali Acc: 0.860 Test Loss: 1.277 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.942228078842163
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.284 Vali Acc: 0.870 Test Loss: 1.284 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.767508029937744
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.694 Vali Acc: 0.860 Test Loss: 1.694 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.685101270675659
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.455 Vali Acc: 0.782 Test Loss: 2.455 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5177359580993652
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.410 Vali Acc: 0.863 Test Loss: 1.410 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 1351506
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.156933546066284
Epoch: 1, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 3.223778247833252
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.515 Vali Acc: 0.795 Test Loss: 0.515 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.433159589767456
Epoch: 3, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.318563222885132
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.483 Vali Acc: 0.846 Test Loss: 0.483 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846412).  Saving model ...
Epoch: 5 cost time: 3.328397512435913
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.807 Vali Acc: 0.744 Test Loss: 0.807 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1177690029144287
Epoch: 6, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.846412 --> -0.849824).  Saving model ...
Epoch: 7 cost time: 3.2258143424987793
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.461 Vali Acc: 0.881 Test Loss: 0.461 Test Acc: 0.881
Validation loss decreased (-0.849824 --> -0.880541).  Saving model ...
Epoch: 8 cost time: 3.367354393005371
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.493 Vali Acc: 0.901 Test Loss: 0.493 Test Acc: 0.901
Validation loss decreased (-0.880541 --> -0.901019).  Saving model ...
Epoch: 9 cost time: 3.2226815223693848
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 1.059 Vali Acc: 0.758 Test Loss: 1.059 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.132200241088867
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.029 Vali Acc: 0.768 Test Loss: 1.029 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.453570604324341
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.721 Vali Acc: 0.887 Test Loss: 0.721 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4097440242767334
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.214 Vali Acc: 0.775 Test Loss: 1.214 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6348257064819336
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.893 Vali Acc: 0.850 Test Loss: 0.893 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3505754470825195
Epoch: 14, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.350 Vali Acc: 0.805 Test Loss: 1.350 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1247849464416504
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.922 Vali Acc: 0.829 Test Loss: 0.922 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.325960397720337
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.291 Vali Acc: 0.860 Test Loss: 1.291 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.347036838531494
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.794 Vali Acc: 0.703 Test Loss: 2.794 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.312321662902832
Epoch: 18, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.510 Vali Acc: 0.826 Test Loss: 1.510 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 1351506
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.1967127323150635
Epoch: 1, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 2.9313671588897705
Epoch: 2, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.472 Vali Acc: 0.812 Test Loss: 0.472 Test Acc: 0.812
Validation loss decreased (-0.808869 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 2.864177942276001
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.002 Vali Acc: 0.669 Test Loss: 1.002 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9972646236419678
Epoch: 4, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.322 Vali Acc: 0.898 Test Loss: 0.322 Test Acc: 0.898
Validation loss decreased (-0.812282 --> -0.897608).  Saving model ...
Epoch: 5 cost time: 2.9985783100128174
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.756699323654175
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.042 Vali Acc: 0.751 Test Loss: 1.042 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7227017879486084
Epoch: 7, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.733 Vali Acc: 0.799 Test Loss: 0.733 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8376710414886475
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.486 Vali Acc: 0.857 Test Loss: 0.486 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.936566114425659
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.881 Vali Acc: 0.761 Test Loss: 0.881 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.91207218170166
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.802 Vali Acc: 0.836 Test Loss: 0.802 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.06634259223938
Epoch: 11, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.668 Vali Acc: 0.860 Test Loss: 0.668 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0782856941223145
Epoch: 12, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.353 Vali Acc: 0.778 Test Loss: 1.353 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.930431604385376
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.081 Vali Acc: 0.765 Test Loss: 1.081 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.892509937286377
Epoch: 14, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.725 Vali Acc: 0.860 Test Loss: 0.725 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 1351506
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.2963547706604
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.421 Vali Acc: 0.857 Test Loss: 0.421 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 3.5437912940979004
Epoch: 2, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5968637466430664
Epoch: 3, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.708 Vali Acc: 0.727 Test Loss: 0.708 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3332929611206055
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.641 Vali Acc: 0.751 Test Loss: 0.641 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4058070182800293
Epoch: 5, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.531 Vali Acc: 0.846 Test Loss: 0.531 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2808640003204346
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.707 Vali Acc: 0.826 Test Loss: 0.707 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.646594285964966
Epoch: 7, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.803 Vali Acc: 0.812 Test Loss: 0.803 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5035078525543213
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.736 Vali Acc: 0.785 Test Loss: 0.736 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.540332794189453
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.838 Vali Acc: 0.799 Test Loss: 0.838 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5020110607147217
Epoch: 10, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.862 Vali Acc: 0.833 Test Loss: 0.862 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5668528079986572
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 827218
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.681747674942017
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 3.349863290786743
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0559446811676025
Epoch: 3, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8826522827148438
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.476 Vali Acc: 0.802 Test Loss: 0.476 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.108945369720459
Epoch: 5, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
Validation loss decreased (-0.849825 --> -0.866890).  Saving model ...
Epoch: 6 cost time: 3.0886876583099365
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.497 Vali Acc: 0.823 Test Loss: 0.497 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4530248641967773
Epoch: 7, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.778 Vali Acc: 0.829 Test Loss: 0.778 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5094029903411865
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.852 Vali Acc: 0.778 Test Loss: 0.852 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1628260612487793
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.889 Vali Acc: 0.840 Test Loss: 0.889 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9491255283355713
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.350 Vali Acc: 0.778 Test Loss: 1.350 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0817270278930664
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.810 Vali Acc: 0.843 Test Loss: 0.810 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.931924819946289
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.819 Vali Acc: 0.846 Test Loss: 0.819 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3874151706695557
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.655 Vali Acc: 0.853 Test Loss: 0.655 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1942877769470215
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.956 Vali Acc: 0.833 Test Loss: 0.956 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6746320724487305
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.202 Vali Acc: 0.826 Test Loss: 1.202 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 827218
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.724211931228638
Epoch: 1, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.432 Vali Acc: 0.853 Test Loss: 0.432 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 2.9594483375549316
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8570127487182617
Epoch: 3, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8359413146972656
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
Validation loss decreased (-0.853238 --> -0.890782).  Saving model ...
Epoch: 5 cost time: 2.8338935375213623
Epoch: 5, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.422 Vali Acc: 0.860 Test Loss: 0.422 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7283575534820557
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.617 Vali Acc: 0.819 Test Loss: 0.617 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0223827362060547
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.112 Vali Acc: 0.747 Test Loss: 1.112 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1546614170074463
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.199129819869995
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.809 Vali Acc: 0.805 Test Loss: 0.809 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.407766342163086
Epoch: 10, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.025 Vali Acc: 0.819 Test Loss: 1.025 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9033825397491455
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.894 Vali Acc: 0.788 Test Loss: 0.894 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.907785177230835
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.334 Vali Acc: 0.792 Test Loss: 1.334 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.669670820236206
Epoch: 13, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.958 Vali Acc: 0.836 Test Loss: 0.958 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.56563401222229
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.096 Vali Acc: 0.823 Test Loss: 1.096 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 827218
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.961261749267578
Epoch: 1, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 2.9342105388641357
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.842 Vali Acc: 0.734 Test Loss: 0.842 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8373589515686035
Epoch: 3, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.724 Vali Acc: 0.720 Test Loss: 0.724 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5733249187469482
Epoch: 4, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.367 Vali Acc: 0.881 Test Loss: 0.367 Test Acc: 0.881
Validation loss decreased (-0.836173 --> -0.880542).  Saving model ...
Epoch: 5 cost time: 2.8699841499328613
Epoch: 5, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.639 Vali Acc: 0.775 Test Loss: 0.639 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.750885009765625
Epoch: 6, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.612 Vali Acc: 0.799 Test Loss: 0.612 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.747213125228882
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.267 Vali Acc: 0.720 Test Loss: 1.267 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.617140293121338
Epoch: 8, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.747 Vali Acc: 0.758 Test Loss: 0.747 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5762040615081787
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.625 Vali Acc: 0.823 Test Loss: 0.625 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6039397716522217
Epoch: 10, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.019 Vali Acc: 0.751 Test Loss: 1.019 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6539220809936523
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.806 Vali Acc: 0.768 Test Loss: 0.806 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7553553581237793
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.715 Vali Acc: 0.833 Test Loss: 0.715 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.832993507385254
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.921 Vali Acc: 0.833 Test Loss: 0.921 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.640272378921509
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.823 Vali Acc: 0.819 Test Loss: 0.823 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 827218
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.080219745635986
Epoch: 1, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 3.0460386276245117
Epoch: 2, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836172).  Saving model ...
Epoch: 3 cost time: 3.0989959239959717
Epoch: 3, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.519 Vali Acc: 0.788 Test Loss: 0.519 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3838534355163574
Epoch: 4, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.625 Vali Acc: 0.747 Test Loss: 0.625 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4626195430755615
Epoch: 5, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.640 Vali Acc: 0.785 Test Loss: 0.640 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.406562328338623
Epoch: 6, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.800 Vali Acc: 0.788 Test Loss: 0.800 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0014824867248535
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.789 Vali Acc: 0.795 Test Loss: 0.789 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0275769233703613
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.009 Vali Acc: 0.833 Test Loss: 1.009 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.130260467529297
Epoch: 9, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2246527671813965
Epoch: 10, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.686 Vali Acc: 0.826 Test Loss: 0.686 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0533928871154785
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.14414119720459
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.770 Vali Acc: 0.836 Test Loss: 0.770 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 565074
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.69952392578125
Epoch: 1, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 3.032599925994873
Epoch: 2, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.426 Vali Acc: 0.860 Test Loss: 0.426 Test Acc: 0.860
Validation loss decreased (-0.832760 --> -0.860064).  Saving model ...
Epoch: 3 cost time: 3.098454475402832
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.609 Vali Acc: 0.754 Test Loss: 0.609 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.835484504699707
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.508 Vali Acc: 0.788 Test Loss: 0.508 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.845679998397827
Epoch: 5, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3025431632995605
Epoch: 6, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.791 Vali Acc: 0.747 Test Loss: 0.791 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.122807025909424
Epoch: 7, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.534 Vali Acc: 0.843 Test Loss: 0.534 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.218461036682129
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.911 Vali Acc: 0.788 Test Loss: 0.911 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0731465816497803
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
Validation loss decreased (-0.860064 --> -0.863477).  Saving model ...
Epoch: 10 cost time: 2.9910082817077637
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.927492380142212
Epoch: 11, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.235 Vali Acc: 0.724 Test Loss: 1.235 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.14168119430542
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.771 Vali Acc: 0.840 Test Loss: 0.771 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.946103811264038
Epoch: 13, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.915 Vali Acc: 0.826 Test Loss: 0.915 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0790631771087646
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.850 Vali Acc: 0.843 Test Loss: 0.850 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.963837146759033
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.876 Vali Acc: 0.860 Test Loss: 0.876 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7465145587921143
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.805 Vali Acc: 0.870 Test Loss: 0.805 Test Acc: 0.870
Validation loss decreased (-0.863477 --> -0.870299).  Saving model ...
Epoch: 17 cost time: 3.31305193901062
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.088 Vali Acc: 0.833 Test Loss: 1.088 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2493772506713867
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.964 Vali Acc: 0.819 Test Loss: 0.964 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.296926736831665
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.210 Vali Acc: 0.833 Test Loss: 1.210 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.027299642562866
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.052 Vali Acc: 0.809 Test Loss: 1.052 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8728835582733154
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.357 Vali Acc: 0.799 Test Loss: 1.357 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.848417043685913
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.850 Vali Acc: 0.863 Test Loss: 0.850 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.126039505004883
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.256 Vali Acc: 0.826 Test Loss: 1.256 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.789942979812622
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.873 Vali Acc: 0.904 Test Loss: 0.873 Test Acc: 0.904
Validation loss decreased (-0.870299 --> -0.904428).  Saving model ...
Epoch: 25 cost time: 2.529589891433716
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.408 Vali Acc: 0.829 Test Loss: 1.408 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9722743034362793
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.898 Test Loss: 0.862 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.791510820388794
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.407 Vali Acc: 0.805 Test Loss: 1.407 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9214751720428467
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.168 Vali Acc: 0.846 Test Loss: 1.168 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9563703536987305
Epoch: 29, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.277 Vali Acc: 0.860 Test Loss: 1.277 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.0704269409179688
Epoch: 30, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.193 Vali Acc: 0.850 Test Loss: 1.193 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.142451763153076
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.365 Vali Acc: 0.860 Test Loss: 1.365 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.0006041526794434
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.057 Vali Acc: 0.894 Test Loss: 1.057 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.1507394313812256
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.425 Vali Acc: 0.846 Test Loss: 1.425 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.241518497467041
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.435 Vali Acc: 0.850 Test Loss: 1.435 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 565074
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.647109270095825
Epoch: 1, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
Validation loss decreased (inf --> -0.819107).  Saving model ...
Epoch: 2 cost time: 2.888700246810913
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
Validation loss decreased (-0.819107 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 2.836409330368042
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.463 Vali Acc: 0.819 Test Loss: 0.463 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.879629135131836
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.966304302215576
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.533 Vali Acc: 0.795 Test Loss: 0.533 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7753303050994873
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.852 Vali Acc: 0.805 Test Loss: 0.852 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8250088691711426
Epoch: 7, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.888625144958496
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.642 Vali Acc: 0.823 Test Loss: 0.642 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9875130653381348
Epoch: 9, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
Validation loss decreased (-0.866890 --> -0.904431).  Saving model ...
Epoch: 10 cost time: 2.924731492996216
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.583 Vali Acc: 0.877 Test Loss: 0.583 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.864549160003662
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7599854469299316
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.656 Vali Acc: 0.846 Test Loss: 0.656 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.845720052719116
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.769 Vali Acc: 0.819 Test Loss: 0.769 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.621849298477173
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.628 Vali Acc: 0.863 Test Loss: 0.628 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5737318992614746
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.805 Vali Acc: 0.874 Test Loss: 0.805 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.661616325378418
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.182 Vali Acc: 0.799 Test Loss: 1.182 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.95389986038208
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.860 Test Loss: 0.691 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0133719444274902
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.149 Vali Acc: 0.792 Test Loss: 1.149 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.979398727416992
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.996 Vali Acc: 0.823 Test Loss: 0.996 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 565074
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.221570014953613
Epoch: 1, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.568 Vali Acc: 0.782 Test Loss: 0.568 Test Acc: 0.782
Validation loss decreased (inf --> -0.781564).  Saving model ...
Epoch: 2 cost time: 2.4508934020996094
Epoch: 2, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.781564 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 2.3742785453796387
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.403 Vali Acc: 0.829 Test Loss: 0.403 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829348).  Saving model ...
Epoch: 4 cost time: 2.3152949810028076
Epoch: 4, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.446 Vali Acc: 0.809 Test Loss: 0.446 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6084322929382324
Epoch: 5, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.829348 --> -0.849826).  Saving model ...
Epoch: 6 cost time: 2.4074957370758057
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.076 Vali Acc: 0.703 Test Loss: 1.076 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.675941228866577
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.233 Vali Acc: 0.679 Test Loss: 1.233 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.591022253036499
Epoch: 8, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.523 Vali Acc: 0.857 Test Loss: 0.523 Test Acc: 0.857
Validation loss decreased (-0.849826 --> -0.856650).  Saving model ...
Epoch: 9 cost time: 2.2329976558685303
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.412 Vali Acc: 0.891 Test Loss: 0.412 Test Acc: 0.891
Validation loss decreased (-0.856650 --> -0.890781).  Saving model ...
Epoch: 10 cost time: 2.471083641052246
Epoch: 10, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4891812801361084
Epoch: 11, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.034 Vali Acc: 0.727 Test Loss: 1.034 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6352946758270264
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.662 Vali Acc: 0.785 Test Loss: 0.662 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6343398094177246
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.669 Vali Acc: 0.812 Test Loss: 0.669 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7486021518707275
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.012 Vali Acc: 0.758 Test Loss: 1.012 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.790360927581787
Epoch: 15, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.713 Vali Acc: 0.840 Test Loss: 0.713 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.1015961170196533
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.268 Vali Acc: 0.816 Test Loss: 1.268 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.327638626098633
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 2.360 Vali Acc: 0.717 Test Loss: 2.360 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1728343963623047
Epoch: 18, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.869 Vali Acc: 0.884 Test Loss: 0.869 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9413533210754395
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.965 Vali Acc: 0.754 Test Loss: 1.965 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 565074
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.6151111125946045
Epoch: 1, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 3.3743896484375
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.815695 --> -0.870303).  Saving model ...
Epoch: 3 cost time: 3.4945223331451416
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.397 Vali Acc: 0.642 Test Loss: 1.397 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8674426078796387
Epoch: 4, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.461 Vali Acc: 0.843 Test Loss: 0.461 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.680126190185547
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7229743003845215
Epoch: 6, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.619 Vali Acc: 0.778 Test Loss: 0.619 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9283626079559326
Epoch: 7, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.291508913040161
Epoch: 8, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.499 Vali Acc: 0.874 Test Loss: 0.499 Test Acc: 0.874
Validation loss decreased (-0.870303 --> -0.873715).  Saving model ...
Epoch: 9 cost time: 2.9873733520507812
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.844 Vali Acc: 0.782 Test Loss: 0.844 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.971018075942993
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.611537218093872
Epoch: 11, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.613 Vali Acc: 0.881 Test Loss: 0.613 Test Acc: 0.881
Validation loss decreased (-0.873715 --> -0.880540).  Saving model ...
Epoch: 12 cost time: 3.575387477874756
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.940 Vali Acc: 0.785 Test Loss: 0.940 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.141005754470825
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.992 Vali Acc: 0.836 Test Loss: 0.992 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3839638233184814
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.911 Vali Acc: 0.836 Test Loss: 0.911 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0760648250579834
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.793 Vali Acc: 0.857 Test Loss: 0.793 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.192927122116089
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.894 Vali Acc: 0.833 Test Loss: 0.894 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.8609302043914795
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.836 Vali Acc: 0.826 Test Loss: 0.836 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2435202598571777
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.846 Test Loss: 1.042 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5383570194244385
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.778 Vali Acc: 0.863 Test Loss: 0.778 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.938680648803711
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.255 Vali Acc: 0.836 Test Loss: 1.255 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.682797431945801
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.989 Vali Acc: 0.874 Test Loss: 0.989 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 434002
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.477276802062988
Epoch: 1, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 3.3810536861419678
Epoch: 2, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.426 Vali Acc: 0.881 Test Loss: 0.426 Test Acc: 0.881
Validation loss decreased (-0.808869 --> -0.880542).  Saving model ...
Epoch: 3 cost time: 3.59623122215271
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.213 Vali Acc: 0.669 Test Loss: 1.213 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.355281352996826
Epoch: 4, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.475 Vali Acc: 0.846 Test Loss: 0.475 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.114997386932373
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.459 Vali Acc: 0.860 Test Loss: 0.459 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7782013416290283
Epoch: 6, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3350439071655273
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.888 Vali Acc: 0.782 Test Loss: 0.888 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1736583709716797
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.323195219039917
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.636 Vali Acc: 0.843 Test Loss: 0.636 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.025449275970459
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.595 Vali Acc: 0.846 Test Loss: 0.595 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.2354178428649902
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.313890218734741
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.819 Vali Acc: 0.819 Test Loss: 0.819 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 434002
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.618985891342163
Epoch: 1, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.502 Vali Acc: 0.823 Test Loss: 0.502 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.9328160285949707
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.822521 --> -0.870303).  Saving model ...
Epoch: 3 cost time: 2.953134536743164
Epoch: 3, Steps: 17 | Train Loss: 0.431 Vali Loss: 1.217 Vali Acc: 0.635 Test Loss: 1.217 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9210805892944336
Epoch: 4, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3667569160461426
Epoch: 5, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.410407066345215
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.265547275543213
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.910644769668579
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.590 Vali Acc: 0.870 Test Loss: 0.590 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.051316499710083
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.577 Vali Acc: 0.823 Test Loss: 0.577 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.073584794998169
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.731 Vali Acc: 0.829 Test Loss: 0.731 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.014387607574463
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.700 Vali Acc: 0.833 Test Loss: 0.700 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.90213942527771
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 434002
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.477484941482544
Epoch: 1, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.524 Vali Acc: 0.788 Test Loss: 0.524 Test Acc: 0.788
Validation loss decreased (inf --> -0.788391).  Saving model ...
Epoch: 2 cost time: 2.7334320545196533
Epoch: 2, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
Validation loss decreased (-0.788391 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 2.761998414993286
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.151 Vali Acc: 0.631 Test Loss: 1.151 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.735165596008301
Epoch: 4, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.581 Vali Acc: 0.795 Test Loss: 0.581 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6754589080810547
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.865340232849121
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.418 Vali Acc: 0.843 Test Loss: 0.418 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0083534717559814
Epoch: 7, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.748 Vali Acc: 0.785 Test Loss: 0.748 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.930994987487793
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.738 Vali Acc: 0.812 Test Loss: 0.738 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7626261711120605
Epoch: 9, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.9999923706054688
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.354 Vali Acc: 0.741 Test Loss: 1.354 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8914661407470703
Epoch: 11, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.768 Vali Acc: 0.823 Test Loss: 0.768 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8540308475494385
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.685 Vali Acc: 0.788 Test Loss: 0.685 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 434002
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.287732362747192
Epoch: 1, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.524 Vali Acc: 0.799 Test Loss: 0.524 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 3.2895290851593018
Epoch: 2, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.526 Vali Acc: 0.785 Test Loss: 0.526 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.585306167602539
Epoch: 3, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.627 Vali Acc: 0.747 Test Loss: 0.627 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5971713066101074
Epoch: 4, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
Validation loss decreased (-0.798630 --> -0.870304).  Saving model ...
Epoch: 5 cost time: 3.5520381927490234
Epoch: 5, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.850536584854126
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.832 Vali Acc: 0.689 Test Loss: 0.832 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1305055618286133
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.003 Vali Acc: 0.720 Test Loss: 1.003 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0329980850219727
Epoch: 8, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.682 Vali Acc: 0.846 Test Loss: 0.682 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9112560749053955
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.645 Vali Acc: 0.823 Test Loss: 0.645 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.393880605697632
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.921 Vali Acc: 0.802 Test Loss: 0.921 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2703731060028076
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.028 Vali Acc: 0.826 Test Loss: 1.028 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.632863998413086
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.4978127479553223
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.234450101852417
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.848 Vali Acc: 0.782 Test Loss: 1.848 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 368466
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.307599782943726
Epoch: 1, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.507 Vali Acc: 0.795 Test Loss: 0.507 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 3.3554656505584717
Epoch: 2, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.537 Vali Acc: 0.805 Test Loss: 0.537 Test Acc: 0.805
Validation loss decreased (-0.795217 --> -0.805455).  Saving model ...
Epoch: 3 cost time: 3.183270215988159
Epoch: 3, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.705 Vali Acc: 0.700 Test Loss: 0.705 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4005935192108154
Epoch: 4, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.300 Vali Acc: 0.904 Test Loss: 0.300 Test Acc: 0.904
Validation loss decreased (-0.805455 --> -0.904434).  Saving model ...
Epoch: 5 cost time: 3.258166551589966
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.123 Vali Acc: 0.655 Test Loss: 1.123 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.525507688522339
Epoch: 6, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.452220916748047
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.464 Vali Acc: 0.857 Test Loss: 0.464 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0697500705718994
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.081 Vali Acc: 0.734 Test Loss: 1.081 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8076648712158203
Epoch: 9, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.762 Vali Acc: 0.812 Test Loss: 0.762 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1253442764282227
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.785 Vali Acc: 0.829 Test Loss: 0.785 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1690142154693604
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2956535816192627
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.802 Vali Acc: 0.840 Test Loss: 0.802 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.496269702911377
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.4676458835601807
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.829 Vali Acc: 0.850 Test Loss: 0.829 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 368466
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.100344896316528
Epoch: 1, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.499 Vali Acc: 0.812 Test Loss: 0.499 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 2.8307876586914062
Epoch: 2, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.539 Vali Acc: 0.802 Test Loss: 0.539 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.17559814453125
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.478 Vali Acc: 0.812 Test Loss: 0.478 Test Acc: 0.812
Validation loss decreased (-0.812282 --> -0.812282).  Saving model ...
Epoch: 4 cost time: 2.758193016052246
Epoch: 4, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.388 Vali Acc: 0.826 Test Loss: 0.388 Test Acc: 0.826
Validation loss decreased (-0.812282 --> -0.825935).  Saving model ...
Epoch: 5 cost time: 2.401216983795166
Epoch: 5, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
Validation loss decreased (-0.825935 --> -0.832759).  Saving model ...
Epoch: 6 cost time: 3.123607873916626
Epoch: 6, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.840 Vali Acc: 0.788 Test Loss: 0.840 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9818198680877686
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.511 Vali Acc: 0.887 Test Loss: 0.511 Test Acc: 0.887
Validation loss decreased (-0.832759 --> -0.887367).  Saving model ...
Epoch: 8 cost time: 2.8748862743377686
Epoch: 8, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.582 Vali Acc: 0.846 Test Loss: 0.582 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.310424566268921
Epoch: 9, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.867 Vali Acc: 0.778 Test Loss: 0.867 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9107820987701416
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0428621768951416
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.949 Vali Acc: 0.840 Test Loss: 0.949 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.037691354751587
Epoch: 12, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.128 Vali Acc: 0.788 Test Loss: 1.128 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0360429286956787
Epoch: 13, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.653 Vali Acc: 0.857 Test Loss: 0.653 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2680795192718506
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.296 Vali Acc: 0.744 Test Loss: 1.296 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.6349246501922607
Epoch: 15, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.487 Vali Acc: 0.751 Test Loss: 1.487 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.440215587615967
Epoch: 16, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.369 Vali Acc: 0.853 Test Loss: 1.369 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1139259338378906
Epoch: 17, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.953 Vali Acc: 0.710 Test Loss: 1.953 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 368466
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.836249113082886
Epoch: 1, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 2.7172281742095947
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.650 Vali Acc: 0.744 Test Loss: 0.650 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.760258197784424
Epoch: 3, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.796 Vali Acc: 0.713 Test Loss: 0.796 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.682907819747925
Epoch: 4, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.450 Vali Acc: 0.788 Test Loss: 0.450 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7470569610595703
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9630911350250244
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.010 Vali Acc: 0.734 Test Loss: 1.010 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8889734745025635
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (-0.819108 --> -0.894194).  Saving model ...
Epoch: 8 cost time: 2.8269853591918945
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.440 Vali Acc: 0.843 Test Loss: 0.440 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.673818826675415
Epoch: 9, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.163 Vali Acc: 0.635 Test Loss: 1.163 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5916030406951904
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.790031909942627
Epoch: 11, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.694 Vali Acc: 0.846 Test Loss: 0.694 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.232642650604248
Epoch: 12, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.435 Vali Acc: 0.751 Test Loss: 1.435 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8913087844848633
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.745 Vali Acc: 0.785 Test Loss: 0.745 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.865661382675171
Epoch: 14, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.774 Vali Acc: 0.823 Test Loss: 0.774 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.919027090072632
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.330 Vali Acc: 0.713 Test Loss: 1.330 Test Acc: 0.713
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.889335870742798
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.639 Vali Acc: 0.843 Test Loss: 0.639 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6764094829559326
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.850 Vali Acc: 0.785 Test Loss: 0.850 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 368466
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.629063844680786
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.445 Vali Acc: 0.860 Test Loss: 0.445 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 3.086214303970337
Epoch: 2, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.522977113723755
Epoch: 3, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.500 Vali Acc: 0.795 Test Loss: 0.500 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3535232543945312
Epoch: 4, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.515 Vali Acc: 0.792 Test Loss: 0.515 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.76969838142395
Epoch: 5, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.977 Vali Acc: 0.686 Test Loss: 0.977 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4791383743286133
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.882 Vali Acc: 0.799 Test Loss: 0.882 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5825276374816895
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.187 Vali Acc: 0.689 Test Loss: 1.187 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.129631519317627
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.529 Vali Acc: 0.853 Test Loss: 0.529 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.4026176929473877
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.201 Vali Acc: 0.737 Test Loss: 1.201 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.326578378677368
Epoch: 10, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.860 Vali Acc: 0.836 Test Loss: 0.860 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1735105514526367
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.652 Vali Acc: 0.846 Test Loss: 0.652 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 335698
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.4776222705841064
Epoch: 1, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.463 Vali Acc: 0.857 Test Loss: 0.463 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 3.595229387283325
Epoch: 2, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.484 Vali Acc: 0.816 Test Loss: 0.484 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3452274799346924
Epoch: 3, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.464 Vali Acc: 0.829 Test Loss: 0.464 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1472115516662598
Epoch: 4, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.466 Vali Acc: 0.826 Test Loss: 0.466 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.875113010406494
Epoch: 5, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.508 Vali Acc: 0.823 Test Loss: 0.508 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.108757495880127
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.562 Vali Acc: 0.843 Test Loss: 0.562 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.313554286956787
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.883 Vali Acc: 0.782 Test Loss: 0.883 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.719799280166626
Epoch: 8, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.828946352005005
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.696 Vali Acc: 0.785 Test Loss: 0.696 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3875136375427246
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.595 Vali Acc: 0.802 Test Loss: 0.595 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.316310405731201
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.101 Vali Acc: 0.771 Test Loss: 1.101 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 335698
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.241626739501953
Epoch: 1, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.467 Vali Acc: 0.860 Test Loss: 0.467 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 3.1384406089782715
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2203404903411865
Epoch: 3, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2462453842163086
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.430 Vali Acc: 0.840 Test Loss: 0.430 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.064237117767334
Epoch: 5, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.397 Vali Acc: 0.638 Test Loss: 1.397 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2523770332336426
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
Validation loss decreased (-0.860064 --> -0.883955).  Saving model ...
Epoch: 7 cost time: 2.881143093109131
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3477840423583984
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.096 Vali Acc: 0.768 Test Loss: 1.096 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2570183277130127
Epoch: 9, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.506 Vali Acc: 0.693 Test Loss: 1.506 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.343196392059326
Epoch: 10, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.923 Vali Acc: 0.823 Test Loss: 0.923 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0694432258605957
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.643 Vali Acc: 0.829 Test Loss: 0.643 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1668717861175537
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.468 Vali Acc: 0.737 Test Loss: 1.468 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2224810123443604
Epoch: 13, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.433 Vali Acc: 0.741 Test Loss: 1.433 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.4455761909484863
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.132 Vali Acc: 0.809 Test Loss: 1.132 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.599726438522339
Epoch: 15, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.670 Vali Acc: 0.884 Test Loss: 0.670 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.652317762374878
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.956 Vali Acc: 0.805 Test Loss: 0.956 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 335698
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.989960432052612
Epoch: 1, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.489 Vali Acc: 0.823 Test Loss: 0.489 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.5016584396362305
Epoch: 2, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.603 Vali Acc: 0.771 Test Loss: 0.603 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4598565101623535
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.522 Vali Acc: 0.785 Test Loss: 0.522 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.580092430114746
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.542 Vali Acc: 0.778 Test Loss: 0.542 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.752399206161499
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.850 Vali Acc: 0.689 Test Loss: 0.850 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7890090942382812
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8531370162963867
Epoch: 7, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.672 Vali Acc: 0.805 Test Loss: 0.672 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8994460105895996
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.632 Vali Acc: 0.799 Test Loss: 0.632 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.744166851043701
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.549 Vali Acc: 0.823 Test Loss: 0.549 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.598936080932617
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825934).  Saving model ...
Epoch: 11 cost time: 2.5832107067108154
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.584 Vali Acc: 0.877 Test Loss: 0.584 Test Acc: 0.877
Validation loss decreased (-0.825934 --> -0.877127).  Saving model ...
Epoch: 12 cost time: 2.665947675704956
Epoch: 12, Steps: 17 | Train Loss: 0.357 Vali Loss: 2.249 Vali Acc: 0.614 Test Loss: 2.249 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.877535343170166
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.740 Vali Acc: 0.836 Test Loss: 0.740 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7343993186950684
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.559 Vali Acc: 0.727 Test Loss: 1.559 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.86685848236084
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.607 Vali Acc: 0.884 Test Loss: 0.607 Test Acc: 0.884
Validation loss decreased (-0.877127 --> -0.883953).  Saving model ...
Epoch: 16 cost time: 3.008915424346924
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.641 Vali Acc: 0.843 Test Loss: 0.641 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8332817554473877
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.874 Vali Acc: 0.843 Test Loss: 0.874 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.733311653137207
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.115 Vali Acc: 0.795 Test Loss: 1.115 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7129383087158203
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.913 Vali Acc: 0.785 Test Loss: 0.913 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7716495990753174
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.881 Test Loss: 0.618 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7909786701202393
Epoch: 21, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.011 Vali Acc: 0.836 Test Loss: 1.011 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8878798484802246
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.879 Vali Acc: 0.870 Test Loss: 0.879 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.345130443572998
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.581 Vali Acc: 0.894 Test Loss: 0.581 Test Acc: 0.894
Validation loss decreased (-0.883953 --> -0.894192).  Saving model ...
Epoch: 24 cost time: 2.5904619693756104
Epoch: 24, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.438 Vali Acc: 0.823 Test Loss: 1.438 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5673725605010986
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.886 Vali Acc: 0.894 Test Loss: 0.886 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.534276008605957
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.904 Test Loss: 0.818 Test Acc: 0.904
Validation loss decreased (-0.894192 --> -0.904429).  Saving model ...
Epoch: 27 cost time: 2.863905906677246
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.843 Test Loss: 1.219 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7664694786071777
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.046 Vali Acc: 0.863 Test Loss: 1.046 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7678017616271973
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.881 Test Loss: 0.973 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.8961966037750244
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.874 Test Loss: 0.955 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.607140064239502
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.994 Vali Acc: 0.846 Test Loss: 0.994 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8856325149536133
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.272 Vali Acc: 0.833 Test Loss: 1.272 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.9059393405914307
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.562 Vali Acc: 0.823 Test Loss: 1.562 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.9313361644744873
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.427 Vali Acc: 0.853 Test Loss: 1.427 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.8578248023986816
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.271 Vali Acc: 0.840 Test Loss: 1.271 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.064835786819458
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.381 Vali Acc: 0.829 Test Loss: 1.381 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 335698
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.861173152923584
Epoch: 1, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.417 Vali Acc: 0.819 Test Loss: 0.417 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 3.0258870124816895
Epoch: 2, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6910645961761475
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.501 Vali Acc: 0.843 Test Loss: 0.501 Test Acc: 0.843
Validation loss decreased (-0.819108 --> -0.842998).  Saving model ...
Epoch: 4 cost time: 3.0803792476654053
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.156987428665161
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.686 Vali Acc: 0.758 Test Loss: 0.686 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0651626586914062
Epoch: 6, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.569 Vali Acc: 0.765 Test Loss: 0.569 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1362802982330322
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.433 Vali Acc: 0.857 Test Loss: 0.433 Test Acc: 0.857
Validation loss decreased (-0.842998 --> -0.856651).  Saving model ...
Epoch: 8 cost time: 3.0309152603149414
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.582 Vali Acc: 0.785 Test Loss: 0.582 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0662736892700195
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.354 Vali Acc: 0.881 Test Loss: 0.354 Test Acc: 0.881
Validation loss decreased (-0.856651 --> -0.880543).  Saving model ...
Epoch: 10 cost time: 3.1430752277374268
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2392520904541016
Epoch: 11, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.642 Vali Acc: 0.836 Test Loss: 0.642 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.56467342376709
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.672 Vali Acc: 0.792 Test Loss: 0.672 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.804028034210205
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.619 Vali Acc: 0.863 Test Loss: 0.619 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2587027549743652
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.364629030227661
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4944069385528564
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.547 Vali Acc: 0.860 Test Loss: 0.547 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.352409601211548
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.001476287841797
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0760715007781982
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.836 Test Loss: 0.746 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 659410
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.045521974563599
Epoch: 1, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.431 Vali Acc: 0.829 Test Loss: 0.431 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.9057109355926514
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.821 Vali Acc: 0.768 Test Loss: 0.821 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.632671356201172
Epoch: 3, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.562 Vali Acc: 0.843 Test Loss: 0.562 Test Acc: 0.843
Validation loss decreased (-0.829347 --> -0.842998).  Saving model ...
Epoch: 4 cost time: 3.016012191772461
Epoch: 4, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9594154357910156
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.565 Vali Acc: 0.778 Test Loss: 0.565 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.733617067337036
Epoch: 6, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5647289752960205
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
Validation loss decreased (-0.842998 --> -0.877129).  Saving model ...
Epoch: 8 cost time: 3.011612892150879
Epoch: 8, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.602 Vali Acc: 0.768 Test Loss: 0.602 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.808779716491699
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.357 Vali Acc: 0.887 Test Loss: 0.357 Test Acc: 0.887
Validation loss decreased (-0.877129 --> -0.887368).  Saving model ...
Epoch: 10 cost time: 2.7844655513763428
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.626534938812256
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.062 Vali Acc: 0.812 Test Loss: 1.062 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.069204807281494
Epoch: 12, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.682 Vali Acc: 0.802 Test Loss: 0.682 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0287458896636963
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.857 Test Loss: 0.569 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0641801357269287
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.39422869682312
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.738 Vali Acc: 0.843 Test Loss: 0.738 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.242079973220825
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.544 Vali Acc: 0.846 Test Loss: 0.544 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1095480918884277
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.711 Vali Acc: 0.843 Test Loss: 0.711 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.927851676940918
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.887 Test Loss: 0.550 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.4566516876220703
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.686 Vali Acc: 0.843 Test Loss: 0.686 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 659410
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.39463472366333
Epoch: 1, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.434 Vali Acc: 0.829 Test Loss: 0.434 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.8136985301971436
Epoch: 2, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.966607093811035
Epoch: 3, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
Validation loss decreased (-0.829347 --> -0.853237).  Saving model ...
Epoch: 4 cost time: 2.573620319366455
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5093393325805664
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.582 Vali Acc: 0.771 Test Loss: 0.582 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.573042631149292
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.590 Vali Acc: 0.768 Test Loss: 0.590 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4356353282928467
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.442 Vali Acc: 0.874 Test Loss: 0.442 Test Acc: 0.874
Validation loss decreased (-0.853237 --> -0.873716).  Saving model ...
Epoch: 8 cost time: 2.6987662315368652
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.650 Vali Acc: 0.758 Test Loss: 0.650 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.400245428085327
Epoch: 9, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.385 Vali Acc: 0.898 Test Loss: 0.385 Test Acc: 0.898
Validation loss decreased (-0.873716 --> -0.897607).  Saving model ...
Epoch: 10 cost time: 2.8528056144714355
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.915520191192627
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.692 Vali Acc: 0.792 Test Loss: 0.692 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.556347370147705
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.425 Vali Acc: 0.867 Test Loss: 0.425 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3566765785217285
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.649 Vali Acc: 0.829 Test Loss: 0.649 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6586883068084717
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.493 Vali Acc: 0.884 Test Loss: 0.493 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8964967727661133
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9042294025421143
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.623 Vali Acc: 0.884 Test Loss: 0.623 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.827413558959961
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6610538959503174
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.676 Vali Acc: 0.843 Test Loss: 0.676 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0193536281585693
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.702 Vali Acc: 0.840 Test Loss: 0.702 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 659410
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.418492794036865
Epoch: 1, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.443 Vali Acc: 0.816 Test Loss: 0.443 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 2.7539658546447754
Epoch: 2, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2345213890075684
Epoch: 3, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.489 Vali Acc: 0.826 Test Loss: 0.489 Test Acc: 0.826
Validation loss decreased (-0.815695 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 2.1941399574279785
Epoch: 4, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.450319766998291
Epoch: 5, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.495 Vali Acc: 0.799 Test Loss: 0.495 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.560929298400879
Epoch: 6, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.789435863494873
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.344 Vali Acc: 0.863 Test Loss: 0.344 Test Acc: 0.863
Validation loss decreased (-0.825934 --> -0.863478).  Saving model ...
Epoch: 8 cost time: 2.681995153427124
Epoch: 8, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7237679958343506
Epoch: 9, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
Validation loss decreased (-0.863478 --> -0.870303).  Saving model ...
Epoch: 10 cost time: 2.6159589290618896
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.381 Vali Acc: 0.846 Test Loss: 0.381 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3506484031677246
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3684160709381104
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.664 Vali Acc: 0.799 Test Loss: 0.664 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6054184436798096
Epoch: 13, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.785 Vali Acc: 0.782 Test Loss: 0.785 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4122869968414307
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.730 Vali Acc: 0.778 Test Loss: 0.730 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.587906837463379
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.604 Vali Acc: 0.840 Test Loss: 0.604 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.567735433578491
Epoch: 16, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.746 Vali Acc: 0.812 Test Loss: 0.746 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.812772750854492
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.478 Vali Acc: 0.860 Test Loss: 0.478 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6348190307617188
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.687023878097534
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.633 Vali Acc: 0.823 Test Loss: 0.633 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 659410
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.816175222396851
Epoch: 1, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 2.596419095993042
Epoch: 2, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.547 Vali Acc: 0.799 Test Loss: 0.547 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1859242916107178
Epoch: 3, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.489 Vali Acc: 0.795 Test Loss: 0.489 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.489171028137207
Epoch: 4, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.788123846054077
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.353 Vali Acc: 0.860 Test Loss: 0.353 Test Acc: 0.860
Validation loss decreased (-0.832760 --> -0.860065).  Saving model ...
Epoch: 6 cost time: 2.8739607334136963
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.656 Vali Acc: 0.761 Test Loss: 0.656 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.757167339324951
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.746 Vali Acc: 0.751 Test Loss: 0.746 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.952583074569702
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.838 Vali Acc: 0.747 Test Loss: 0.838 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4111483097076416
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4325129985809326
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.726 Vali Acc: 0.840 Test Loss: 0.726 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.554277181625366
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7324979305267334
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5385258197784424
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.578428268432617
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.821 Vali Acc: 0.826 Test Loss: 0.821 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.011059522628784
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 397266
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.888983964920044
Epoch: 1, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.425 Vali Acc: 0.840 Test Loss: 0.425 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 2.783275604248047
Epoch: 2, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.550 Vali Acc: 0.802 Test Loss: 0.550 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.870509147644043
Epoch: 3, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.504 Vali Acc: 0.785 Test Loss: 0.504 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5737156867980957
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.500 Vali Acc: 0.795 Test Loss: 0.500 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.502794027328491
Epoch: 5, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
Validation loss decreased (-0.839586 --> -0.894195).  Saving model ...
Epoch: 6 cost time: 2.2736175060272217
Epoch: 6, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.860 Vali Acc: 0.700 Test Loss: 0.860 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.634949207305908
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.555 Vali Acc: 0.792 Test Loss: 0.555 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1500470638275146
Epoch: 8, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.818265438079834
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.781442165374756
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.553 Vali Acc: 0.846 Test Loss: 0.553 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5606930255889893
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7414016723632812
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.692 Vali Acc: 0.802 Test Loss: 0.692 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4186224937438965
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.453 Vali Acc: 0.874 Test Loss: 0.453 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.750093936920166
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.066 Vali Acc: 0.799 Test Loss: 1.066 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7381720542907715
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.477 Vali Acc: 0.898 Test Loss: 0.477 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897606).  Saving model ...
Epoch: 16 cost time: 2.605395555496216
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.095726251602173
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.573 Vali Acc: 0.860 Test Loss: 0.573 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7362687587738037
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.839 Vali Acc: 0.843 Test Loss: 0.839 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6654410362243652
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.881 Test Loss: 0.600 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.591123104095459
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.973 Vali Acc: 0.826 Test Loss: 0.973 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.512333393096924
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7226054668426514
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.863 Test Loss: 0.765 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6844780445098877
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.667 Vali Acc: 0.853 Test Loss: 0.667 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.760673999786377
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.712 Vali Acc: 0.836 Test Loss: 0.712 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7500150203704834
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.891 Test Loss: 0.601 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 397266
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.861034870147705
Epoch: 1, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.423 Vali Acc: 0.840 Test Loss: 0.423 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 2.51767897605896
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.556 Vali Acc: 0.805 Test Loss: 0.556 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5302937030792236
Epoch: 3, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.428 Vali Acc: 0.816 Test Loss: 0.428 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4883549213409424
Epoch: 4, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.587 Vali Acc: 0.765 Test Loss: 0.587 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.420801877975464
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.839586 --> -0.839587).  Saving model ...
Epoch: 6 cost time: 2.506178140640259
Epoch: 6, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3257956504821777
Epoch: 7, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5994114875793457
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.365 Vali Acc: 0.881 Test Loss: 0.365 Test Acc: 0.881
Validation loss decreased (-0.839587 --> -0.880542).  Saving model ...
Epoch: 9 cost time: 2.5143423080444336
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.512 Vali Acc: 0.795 Test Loss: 0.512 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.680966377258301
Epoch: 10, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.617 Vali Acc: 0.846 Test Loss: 0.617 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5260372161865234
Epoch: 11, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1058695316314697
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.778 Vali Acc: 0.792 Test Loss: 0.778 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.143705129623413
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.445 Vali Acc: 0.860 Test Loss: 0.445 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3827145099639893
Epoch: 14, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.291 Vali Acc: 0.734 Test Loss: 1.291 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2974259853363037
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.671 Vali Acc: 0.823 Test Loss: 0.671 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3974967002868652
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.863 Test Loss: 0.546 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.371312141418457
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.564859390258789
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.791 Vali Acc: 0.853 Test Loss: 0.791 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 397266
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.867370128631592
Epoch: 1, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.423 Vali Acc: 0.823 Test Loss: 0.423 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.092475652694702
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.521 Vali Acc: 0.792 Test Loss: 0.521 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1850132942199707
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2776596546173096
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2499146461486816
Epoch: 5, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.347 Vali Acc: 0.846 Test Loss: 0.347 Test Acc: 0.846
Validation loss decreased (-0.822521 --> -0.846413).  Saving model ...
Epoch: 6 cost time: 2.146444797515869
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.790 Vali Acc: 0.696 Test Loss: 0.790 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.191462993621826
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.652 Vali Acc: 0.771 Test Loss: 0.652 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3926870822906494
Epoch: 8, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.389 Vali Acc: 0.860 Test Loss: 0.389 Test Acc: 0.860
Validation loss decreased (-0.846413 --> -0.860064).  Saving model ...
Epoch: 9 cost time: 2.4008076190948486
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.565 Vali Acc: 0.771 Test Loss: 0.565 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3288047313690186
Epoch: 10, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.040874719619751
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.446 Vali Acc: 0.843 Test Loss: 0.446 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0636353492736816
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.045 Vali Acc: 0.724 Test Loss: 1.045 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4547641277313232
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.521 Vali Acc: 0.840 Test Loss: 0.521 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5965824127197266
Epoch: 14, Steps: 17 | Train Loss: 0.314 Vali Loss: 1.543 Vali Acc: 0.683 Test Loss: 1.543 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2542126178741455
Epoch: 15, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.584 Vali Acc: 0.836 Test Loss: 0.584 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.352933168411255
Epoch: 16, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3990478515625
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4428117275238037
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.767 Vali Acc: 0.805 Test Loss: 0.767 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 397266
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.491698503494263
Epoch: 1, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
Validation loss decreased (inf --> -0.849826).  Saving model ...
Epoch: 2 cost time: 2.9750895500183105
Epoch: 2, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.827094316482544
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.533 Vali Acc: 0.782 Test Loss: 0.533 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0011215209960938
Epoch: 4, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.413 Vali Acc: 0.829 Test Loss: 0.413 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.639859676361084
Epoch: 5, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.610 Vali Acc: 0.768 Test Loss: 0.610 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4150078296661377
Epoch: 6, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.375 Vali Acc: 0.860 Test Loss: 0.375 Test Acc: 0.860
Validation loss decreased (-0.849826 --> -0.860065).  Saving model ...
Epoch: 7 cost time: 2.4350666999816895
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.538 Vali Acc: 0.802 Test Loss: 0.538 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.336677312850952
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5227441787719727
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.457 Vali Acc: 0.853 Test Loss: 0.457 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.55649995803833
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.762 Vali Acc: 0.771 Test Loss: 0.762 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.765015125274658
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.539 Vali Acc: 0.863 Test Loss: 0.539 Test Acc: 0.863
Validation loss decreased (-0.860065 --> -0.863476).  Saving model ...
Epoch: 12 cost time: 2.7363693714141846
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.719 Vali Acc: 0.805 Test Loss: 0.719 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.865712881088257
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.740 Vali Acc: 0.788 Test Loss: 0.740 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.375349283218384
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.866 Vali Acc: 0.812 Test Loss: 0.866 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.37395977973938
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6994173526763916
Epoch: 16, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.670 Vali Acc: 0.833 Test Loss: 0.670 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.724931240081787
Epoch: 17, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.612 Vali Acc: 0.863 Test Loss: 0.612 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5171687602996826
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.986 Vali Acc: 0.788 Test Loss: 0.986 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6423587799072266
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.672 Vali Acc: 0.843 Test Loss: 0.672 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1660854816436768
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.688 Vali Acc: 0.840 Test Loss: 0.688 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.700230598449707
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.978 Vali Acc: 0.843 Test Loss: 0.978 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 266194
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.504244089126587
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (inf --> -0.866890).  Saving model ...
Epoch: 2 cost time: 2.376660108566284
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3357672691345215
Epoch: 3, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3338770866394043
Epoch: 4, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.412 Vali Acc: 0.812 Test Loss: 0.412 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.390476703643799
Epoch: 5, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.400751829147339
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.370 Vali Acc: 0.846 Test Loss: 0.370 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7708170413970947
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6742076873779297
Epoch: 8, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.689476251602173
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.493 Vali Acc: 0.843 Test Loss: 0.493 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.62776780128479
Epoch: 10, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.906 Vali Acc: 0.737 Test Loss: 0.906 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.431218147277832
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.629 Vali Acc: 0.857 Test Loss: 0.629 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 266194
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.181578159332275
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.379 Vali Acc: 0.853 Test Loss: 0.379 Test Acc: 0.853
Validation loss decreased (inf --> -0.853239).  Saving model ...
Epoch: 2 cost time: 2.077181816101074
Epoch: 2, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.531 Vali Acc: 0.823 Test Loss: 0.531 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7151663303375244
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.499 Vali Acc: 0.771 Test Loss: 0.499 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3596246242523193
Epoch: 4, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.399 Vali Acc: 0.819 Test Loss: 0.399 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6547136306762695
Epoch: 5, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4499576091766357
Epoch: 6, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (-0.853239 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 2.2926523685455322
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.555 Vali Acc: 0.802 Test Loss: 0.555 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.440091133117676
Epoch: 8, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.488 Vali Acc: 0.829 Test Loss: 0.488 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.459306478500366
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.33324933052063
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.553 Vali Acc: 0.836 Test Loss: 0.553 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.234241247177124
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.446 Vali Acc: 0.843 Test Loss: 0.446 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.513355016708374
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.851 Vali Acc: 0.765 Test Loss: 0.851 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.29569935798645
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.460 Vali Acc: 0.881 Test Loss: 0.460 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3646228313446045
Epoch: 14, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.835 Vali Acc: 0.799 Test Loss: 0.835 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4859907627105713
Epoch: 15, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.358787775039673
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.961 Vali Acc: 0.805 Test Loss: 0.961 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 266194
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.532024383544922
Epoch: 1, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 2.1763765811920166
Epoch: 2, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2995710372924805
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1239819526672363
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.419 Vali Acc: 0.829 Test Loss: 0.419 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1930887699127197
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.691 Vali Acc: 0.724 Test Loss: 0.691 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2930259704589844
Epoch: 6, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.335 Vali Acc: 0.877 Test Loss: 0.335 Test Acc: 0.877
Validation loss decreased (-0.849825 --> -0.877130).  Saving model ...
Epoch: 7 cost time: 2.0111584663391113
Epoch: 7, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.916 Vali Acc: 0.693 Test Loss: 0.916 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.182109832763672
Epoch: 8, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.552 Vali Acc: 0.823 Test Loss: 0.552 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2262868881225586
Epoch: 9, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.535 Vali Acc: 0.799 Test Loss: 0.535 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9364421367645264
Epoch: 10, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.32045841217041
Epoch: 11, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.159285068511963
Epoch: 12, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.182 Vali Acc: 0.706 Test Loss: 1.182 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0626609325408936
Epoch: 13, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.689 Vali Acc: 0.812 Test Loss: 0.689 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.407071352005005
Epoch: 14, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.088 Vali Acc: 0.741 Test Loss: 1.088 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2817370891571045
Epoch: 15, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.268251419067383
Epoch: 16, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 266194
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.275525808334351
Epoch: 1, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.494 Vali Acc: 0.788 Test Loss: 0.494 Test Acc: 0.788
Validation loss decreased (inf --> -0.788391).  Saving model ...
Epoch: 2 cost time: 2.3560426235198975
Epoch: 2, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.788391 --> -0.849825).  Saving model ...
Epoch: 3 cost time: 2.1609644889831543
Epoch: 3, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.422 Vali Acc: 0.829 Test Loss: 0.422 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3103461265563965
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.461 Vali Acc: 0.829 Test Loss: 0.461 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.715376853942871
Epoch: 5, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.438 Vali Acc: 0.846 Test Loss: 0.438 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.50704026222229
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.540 Vali Acc: 0.802 Test Loss: 0.540 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7429115772247314
Epoch: 7, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.437 Vali Acc: 0.853 Test Loss: 0.437 Test Acc: 0.853
Validation loss decreased (-0.849825 --> -0.853238).  Saving model ...
Epoch: 8 cost time: 2.4101719856262207
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4171335697174072
Epoch: 9, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.809 Vali Acc: 0.737 Test Loss: 0.809 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3990743160247803
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.430 Vali Acc: 0.867 Test Loss: 0.430 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866890).  Saving model ...
Epoch: 11 cost time: 2.457773208618164
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.690 Vali Acc: 0.795 Test Loss: 0.690 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.331793785095215
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.579 Vali Acc: 0.840 Test Loss: 0.579 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3682408332824707
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.135427474975586
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.628 Vali Acc: 0.829 Test Loss: 0.628 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.309870719909668
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.645 Vali Acc: 0.823 Test Loss: 0.645 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.755126476287842
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.735053300857544
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.592 Vali Acc: 0.846 Test Loss: 0.592 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.872295618057251
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6071581840515137
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.471489906311035
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 200658
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.2383692264556885
Epoch: 1, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 2.4009389877319336
Epoch: 2, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.410 Vali Acc: 0.853 Test Loss: 0.410 Test Acc: 0.853
Validation loss decreased (-0.808869 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 2.387244939804077
Epoch: 3, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.408 Vali Acc: 0.829 Test Loss: 0.408 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5649666786193848
Epoch: 4, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.410 Vali Acc: 0.826 Test Loss: 0.410 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.118816375732422
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.481 Vali Acc: 0.802 Test Loss: 0.481 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2938554286956787
Epoch: 6, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2612128257751465
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.288736581802368
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.444 Vali Acc: 0.840 Test Loss: 0.444 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.417952299118042
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.650 Vali Acc: 0.795 Test Loss: 0.650 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.366793632507324
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.403 Vali Acc: 0.860 Test Loss: 0.403 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860064).  Saving model ...
Epoch: 11 cost time: 2.639038562774658
Epoch: 11, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.954 Vali Acc: 0.792 Test Loss: 0.954 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2993454933166504
Epoch: 12, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.640 Vali Acc: 0.816 Test Loss: 0.640 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.277597665786743
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.494 Vali Acc: 0.857 Test Loss: 0.494 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7713849544525146
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.561 Vali Acc: 0.836 Test Loss: 0.561 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7549753189086914
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.505 Vali Acc: 0.874 Test Loss: 0.505 Test Acc: 0.874
Validation loss decreased (-0.860064 --> -0.873715).  Saving model ...
Epoch: 16 cost time: 2.6817564964294434
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.768 Vali Acc: 0.826 Test Loss: 0.768 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6404128074645996
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.829 Test Loss: 0.590 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6878437995910645
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.945 Vali Acc: 0.833 Test Loss: 0.945 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6843273639678955
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.101 Vali Acc: 0.754 Test Loss: 1.101 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9585988521575928
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.924 Vali Acc: 0.850 Test Loss: 0.924 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.914015293121338
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.975 Vali Acc: 0.833 Test Loss: 0.975 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8783507347106934
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.535 Vali Acc: 0.881 Test Loss: 0.535 Test Acc: 0.881
Validation loss decreased (-0.873715 --> -0.880541).  Saving model ...
Epoch: 23 cost time: 2.837867021560669
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.058 Vali Acc: 0.812 Test Loss: 1.058 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5867764949798584
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.884 Test Loss: 0.800 Test Acc: 0.884
Validation loss decreased (-0.880541 --> -0.883951).  Saving model ...
Epoch: 25 cost time: 2.487251043319702
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.836 Vali Acc: 0.853 Test Loss: 0.836 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.573444366455078
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.802 Vali Acc: 0.833 Test Loss: 0.802 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.81482195854187
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.924 Vali Acc: 0.881 Test Loss: 0.924 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9274280071258545
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.061 Vali Acc: 0.819 Test Loss: 1.061 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9789695739746094
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.027 Vali Acc: 0.840 Test Loss: 1.027 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.980776786804199
Epoch: 30, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.827 Vali Acc: 0.860 Test Loss: 0.827 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7227683067321777
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.956 Vali Acc: 0.843 Test Loss: 0.956 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.476177215576172
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.853 Test Loss: 1.033 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.668055295944214
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.881 Test Loss: 0.810 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.7610278129577637
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.884 Test Loss: 0.794 Test Acc: 0.884
Validation loss decreased (-0.883951 --> -0.883951).  Saving model ...
Epoch: 35 cost time: 2.610239267349243
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.853 Test Loss: 0.985 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.470043420791626
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.874 Test Loss: 0.903 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.1887407302856445
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.870 Test Loss: 0.827 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.7466819286346436
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.835 Vali Acc: 0.857 Test Loss: 0.835 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.8751182556152344
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.843 Test Loss: 0.858 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.7333149909973145
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.999 Vali Acc: 0.863 Test Loss: 0.999 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.667154312133789
Epoch: 41, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.017 Vali Acc: 0.846 Test Loss: 1.017 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.737901449203491
Epoch: 42, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.996 Vali Acc: 0.850 Test Loss: 0.996 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.616671323776245
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.200 Vali Acc: 0.853 Test Loss: 1.200 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.486320972442627
Epoch: 44, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.360 Vali Acc: 0.857 Test Loss: 1.360 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 200658
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.55234956741333
Epoch: 1, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.468 Vali Acc: 0.802 Test Loss: 0.468 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 2.3162057399749756
Epoch: 2, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.408 Vali Acc: 0.857 Test Loss: 0.408 Test Acc: 0.857
Validation loss decreased (-0.802043 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 2.1035850048065186
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0349106788635254
Epoch: 4, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.397 Vali Acc: 0.816 Test Loss: 0.397 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.192340850830078
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.477 Vali Acc: 0.799 Test Loss: 0.477 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0354199409484863
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.368 Vali Acc: 0.874 Test Loss: 0.368 Test Acc: 0.874
Validation loss decreased (-0.856651 --> -0.873716).  Saving model ...
Epoch: 7 cost time: 2.2123115062713623
Epoch: 7, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.124526262283325
Epoch: 8, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1932806968688965
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2763640880584717
Epoch: 10, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.041412353515625
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.669 Vali Acc: 0.823 Test Loss: 0.669 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0246074199676514
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.615 Vali Acc: 0.802 Test Loss: 0.615 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.302340030670166
Epoch: 13, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.451 Vali Acc: 0.874 Test Loss: 0.451 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1460959911346436
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.640 Vali Acc: 0.785 Test Loss: 0.640 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.087080240249634
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1935386657714844
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 200658
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.984550952911377
Epoch: 1, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.483 Vali Acc: 0.788 Test Loss: 0.483 Test Acc: 0.788
Validation loss decreased (inf --> -0.788391).  Saving model ...
Epoch: 2 cost time: 2.106111526489258
Epoch: 2, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.407 Vali Acc: 0.840 Test Loss: 0.407 Test Acc: 0.840
Validation loss decreased (-0.788391 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.3414502143859863
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9958562850952148
Epoch: 4, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0156354904174805
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.403 Vali Acc: 0.836 Test Loss: 0.403 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1165668964385986
Epoch: 6, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.475 Vali Acc: 0.812 Test Loss: 0.475 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9972031116485596
Epoch: 7, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.496 Vali Acc: 0.823 Test Loss: 0.496 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.316096544265747
Epoch: 8, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.605 Vali Acc: 0.765 Test Loss: 0.605 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.309706687927246
Epoch: 9, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.192 Vali Acc: 0.642 Test Loss: 1.192 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.008171558380127
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
Validation loss decreased (-0.839586 --> -0.877129).  Saving model ...
Epoch: 11 cost time: 2.2054245471954346
Epoch: 11, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2051784992218018
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.786 Vali Acc: 0.730 Test Loss: 0.786 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1049835681915283
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.985764980316162
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.584 Vali Acc: 0.792 Test Loss: 0.584 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.115211248397827
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.439 Vali Acc: 0.860 Test Loss: 0.439 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0937716960906982
Epoch: 16, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.653 Vali Acc: 0.782 Test Loss: 0.653 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2934491634368896
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3377206325531006
Epoch: 18, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1733949184417725
Epoch: 19, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.609 Vali Acc: 0.795 Test Loss: 0.609 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2245211601257324
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 200658
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.374633312225342
Epoch: 1, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.2396130561828613
Epoch: 2, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.396 Vali Acc: 0.836 Test Loss: 0.396 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 2.579256057739258
Epoch: 3, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8682303428649902
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.737 Vali Acc: 0.706 Test Loss: 0.737 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.727522611618042
Epoch: 5, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.409 Vali Acc: 0.863 Test Loss: 0.409 Test Acc: 0.863
Validation loss decreased (-0.836174 --> -0.863477).  Saving model ...
Epoch: 6 cost time: 2.642160177230835
Epoch: 6, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0676870346069336
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.390 Vali Acc: 0.853 Test Loss: 0.390 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1083719730377197
Epoch: 8, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.855 Vali Acc: 0.788 Test Loss: 0.855 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0660152435302734
Epoch: 9, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.472 Vali Acc: 0.846 Test Loss: 0.472 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3561105728149414
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.646 Vali Acc: 0.795 Test Loss: 0.646 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.47391414642334
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.605 Vali Acc: 0.802 Test Loss: 0.605 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.422731399536133
Epoch: 12, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.533006191253662
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.741 Vali Acc: 0.792 Test Loss: 0.741 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5684335231781006
Epoch: 14, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.573 Vali Acc: 0.840 Test Loss: 0.573 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.653714418411255
Epoch: 15, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 167890
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.290905952453613
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.2977535724639893
Epoch: 2, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.825934 --> -0.849825).  Saving model ...
Epoch: 3 cost time: 2.3673532009124756
Epoch: 3, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.566 Vali Acc: 0.768 Test Loss: 0.566 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4865729808807373
Epoch: 4, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.787 Vali Acc: 0.693 Test Loss: 0.787 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.616274833679199
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
Validation loss decreased (-0.849825 --> -0.866890).  Saving model ...
Epoch: 6 cost time: 2.4512040615081787
Epoch: 6, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.674 Vali Acc: 0.744 Test Loss: 0.674 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.304917573928833
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.380 Vali Acc: 0.853 Test Loss: 0.380 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3317840099334717
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.883 Vali Acc: 0.782 Test Loss: 0.883 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4095473289489746
Epoch: 9, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.456615447998047
Epoch: 10, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2831871509552
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.348453998565674
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4331202507019043
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.572 Vali Acc: 0.836 Test Loss: 0.572 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3083462715148926
Epoch: 14, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5891506671905518
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 167890
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.434518814086914
Epoch: 1, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 2.0018980503082275
Epoch: 2, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.395 Vali Acc: 0.846 Test Loss: 0.395 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 3 cost time: 2.142958641052246
Epoch: 3, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.547 Vali Acc: 0.782 Test Loss: 0.547 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2182273864746094
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.881 Vali Acc: 0.666 Test Loss: 0.881 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.150347948074341
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.394 Vali Acc: 0.860 Test Loss: 0.394 Test Acc: 0.860
Validation loss decreased (-0.846412 --> -0.860064).  Saving model ...
Epoch: 6 cost time: 1.9061343669891357
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1138594150543213
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.319 Vali Acc: 0.898 Test Loss: 0.319 Test Acc: 0.898
Validation loss decreased (-0.860064 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 2.0454845428466797
Epoch: 8, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.758 Vali Acc: 0.758 Test Loss: 0.758 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.973841667175293
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.060445547103882
Epoch: 10, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0121588706970215
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.459 Vali Acc: 0.846 Test Loss: 0.459 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.196857213973999
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.290773391723633
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2604949474334717
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.230924606323242
Epoch: 15, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2725489139556885
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.843 Vali Acc: 0.799 Test Loss: 0.843 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.131455659866333
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.780 Vali Acc: 0.816 Test Loss: 0.780 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 167890
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.229691505432129
Epoch: 1, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.192290782928467
Epoch: 2, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 1.9422295093536377
Epoch: 3, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.524 Vali Acc: 0.778 Test Loss: 0.524 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1527774333953857
Epoch: 4, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.904 Vali Acc: 0.659 Test Loss: 0.904 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2163290977478027
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0723135471343994
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.828 Vali Acc: 0.683 Test Loss: 0.828 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1265857219696045
Epoch: 7, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.394 Vali Acc: 0.819 Test Loss: 0.394 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1198432445526123
Epoch: 8, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.777 Vali Acc: 0.737 Test Loss: 0.777 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0672171115875244
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.532 Vali Acc: 0.778 Test Loss: 0.532 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.938096284866333
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
Validation loss decreased (-0.836174 --> -0.877130).  Saving model ...
Epoch: 11 cost time: 1.9564099311828613
Epoch: 11, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.492 Vali Acc: 0.823 Test Loss: 0.492 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.033720016479492
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.494 Vali Acc: 0.823 Test Loss: 0.494 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.106062173843384
Epoch: 13, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.581 Vali Acc: 0.792 Test Loss: 0.581 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0676157474517822
Epoch: 14, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.140209436416626
Epoch: 15, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.004136562347412
Epoch: 16, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.505 Vali Acc: 0.840 Test Loss: 0.505 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.025146961212158
Epoch: 17, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.941 Vali Acc: 0.771 Test Loss: 0.941 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8153166770935059
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.390 Vali Acc: 0.887 Test Loss: 0.390 Test Acc: 0.887
Validation loss decreased (-0.877130 --> -0.887368).  Saving model ...
Epoch: 19 cost time: 2.1021430492401123
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.908 Vali Acc: 0.747 Test Loss: 0.908 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.275240421295166
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.432 Vali Acc: 0.887 Test Loss: 0.432 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.295048713684082
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.571 Vali Acc: 0.823 Test Loss: 0.571 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3472516536712646
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.554 Vali Acc: 0.829 Test Loss: 0.554 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.311492681503296
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.860 Test Loss: 0.539 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3333420753479004
Epoch: 24, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.188 Vali Acc: 0.768 Test Loss: 1.188 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2146878242492676
Epoch: 25, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2437946796417236
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.027 Vali Acc: 0.782 Test Loss: 1.027 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.142756223678589
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.989 Vali Acc: 0.795 Test Loss: 0.989 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.402333974838257
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.747 Vali Acc: 0.836 Test Loss: 0.747 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 167890
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.74848484992981
Epoch: 1, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.419 Vali Acc: 0.802 Test Loss: 0.419 Test Acc: 0.802
Validation loss decreased (inf --> -0.802044).  Saving model ...
Epoch: 2 cost time: 2.338982343673706
Epoch: 2, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.802044 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 2.36879563331604
Epoch: 3, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 4 cost time: 2.4100985527038574
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.550 Vali Acc: 0.843 Test Loss: 0.550 Test Acc: 0.843
Validation loss decreased (-0.832760 --> -0.842998).  Saving model ...
Epoch: 5 cost time: 2.4069435596466064
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.200690746307373
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3160524368286133
Epoch: 7, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4580814838409424
Epoch: 8, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.842998 --> -0.849825).  Saving model ...
Epoch: 9 cost time: 2.4747321605682373
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.686 Vali Acc: 0.792 Test Loss: 0.686 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6303441524505615
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.563 Vali Acc: 0.823 Test Loss: 0.563 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.575993776321411
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4638726711273193
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.586 Vali Acc: 0.829 Test Loss: 0.586 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4062204360961914
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.633 Vali Acc: 0.812 Test Loss: 0.633 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0111284255981445
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
Validation loss decreased (-0.849825 --> -0.890780).  Saving model ...
Epoch: 15 cost time: 2.3433969020843506
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.024 Vali Acc: 0.724 Test Loss: 1.024 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.341681957244873
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.596 Vali Acc: 0.846 Test Loss: 0.596 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7382028102874756
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.594977378845215
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.650308847427368
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.721 Vali Acc: 0.860 Test Loss: 0.721 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5904793739318848
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.751 Vali Acc: 0.840 Test Loss: 0.751 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2389042377471924
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.154008626937866
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.748 Vali Acc: 0.836 Test Loss: 0.748 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1435368061065674
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.767 Vali Acc: 0.867 Test Loss: 0.767 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.629631757736206
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.869 Vali Acc: 0.843 Test Loss: 0.869 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 151506
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.703807353973389
Epoch: 1, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.410 Vali Acc: 0.826 Test Loss: 0.410 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.4508957862854004
Epoch: 2, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 2.305574417114258
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.414 Vali Acc: 0.846 Test Loss: 0.414 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 2.4675166606903076
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.517 Vali Acc: 0.846 Test Loss: 0.517 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2697744369506836
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.456 Vali Acc: 0.836 Test Loss: 0.456 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.308162212371826
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3683340549468994
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.692 Vali Acc: 0.795 Test Loss: 0.692 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3067286014556885
Epoch: 8, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.461 Vali Acc: 0.877 Test Loss: 0.461 Test Acc: 0.877
Validation loss decreased (-0.846412 --> -0.877128).  Saving model ...
Epoch: 9 cost time: 2.4871344566345215
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.442856550216675
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.573 Vali Acc: 0.853 Test Loss: 0.573 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.463925838470459
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2709298133850098
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0849902629852295
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.826 Vali Acc: 0.754 Test Loss: 0.826 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.049163818359375
Epoch: 14, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.830 Vali Acc: 0.747 Test Loss: 0.830 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.258330821990967
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1423866748809814
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.516 Vali Acc: 0.857 Test Loss: 0.516 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4047510623931885
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5472798347473145
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 151506
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.932919502258301
Epoch: 1, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.398 Vali Acc: 0.823 Test Loss: 0.398 Test Acc: 0.823
Validation loss decreased (inf --> -0.822522).  Saving model ...
Epoch: 2 cost time: 1.9610681533813477
Epoch: 2, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.822522 --> -0.849825).  Saving model ...
Epoch: 3 cost time: 1.9567925930023193
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.396 Vali Acc: 0.846 Test Loss: 0.396 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.997774600982666
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.467 Vali Acc: 0.857 Test Loss: 0.467 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856651).  Saving model ...
Epoch: 5 cost time: 1.935689926147461
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.409 Vali Acc: 0.846 Test Loss: 0.409 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.096501350402832
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9271507263183594
Epoch: 7, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.852 Vali Acc: 0.727 Test Loss: 0.852 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.076511859893799
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.369 Vali Acc: 0.853 Test Loss: 0.369 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1413815021514893
Epoch: 9, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.466 Vali Acc: 0.823 Test Loss: 0.466 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8559517860412598
Epoch: 10, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.371 Vali Acc: 0.881 Test Loss: 0.371 Test Acc: 0.881
Validation loss decreased (-0.856651 --> -0.880542).  Saving model ...
Epoch: 11 cost time: 1.7536063194274902
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1269378662109375
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.405 Vali Acc: 0.887 Test Loss: 0.405 Test Acc: 0.887
Validation loss decreased (-0.880542 --> -0.887368).  Saving model ...
Epoch: 13 cost time: 2.1058661937713623
Epoch: 13, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0034356117248535
Epoch: 14, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0414342880249023
Epoch: 15, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.901 Vali Acc: 0.785 Test Loss: 0.901 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8283486366271973
Epoch: 16, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.456 Vali Acc: 0.857 Test Loss: 0.456 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.041005849838257
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8538997173309326
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.645 Vali Acc: 0.829 Test Loss: 0.645 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0602595806121826
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9359040260314941
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.530 Vali Acc: 0.710 Test Loss: 1.530 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1460659503936768
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.645 Vali Acc: 0.853 Test Loss: 0.645 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1979305744171143
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.560 Vali Acc: 0.840 Test Loss: 0.560 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 151506
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8307151794433594
Epoch: 1, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
Validation loss decreased (inf --> -0.829348).  Saving model ...
Epoch: 2 cost time: 2.0264697074890137
Epoch: 2, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9670207500457764
Epoch: 3, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.460 Vali Acc: 0.805 Test Loss: 0.460 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0285263061523438
Epoch: 4, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.484 Vali Acc: 0.840 Test Loss: 0.484 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839586).  Saving model ...
Epoch: 5 cost time: 1.9604771137237549
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3529562950134277
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.796 Vali Acc: 0.693 Test Loss: 0.796 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.241516590118408
Epoch: 7, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.870 Vali Acc: 0.754 Test Loss: 0.870 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.231966495513916
Epoch: 8, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.326026678085327
Epoch: 9, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.400 Vali Acc: 0.860 Test Loss: 0.400 Test Acc: 0.860
Validation loss decreased (-0.839586 --> -0.860064).  Saving model ...
Epoch: 10 cost time: 2.146904468536377
Epoch: 10, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.620 Vali Acc: 0.788 Test Loss: 0.620 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.087702751159668
Epoch: 11, Steps: 17 | Train Loss: 0.413 Vali Loss: 1.691 Vali Acc: 0.580 Test Loss: 1.691 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2880420684814453
Epoch: 12, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.290252447128296
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.640 Vali Acc: 0.771 Test Loss: 0.640 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.103708505630493
Epoch: 14, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.033 Vali Acc: 0.635 Test Loss: 1.033 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3445937633514404
Epoch: 15, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.978 Vali Acc: 0.724 Test Loss: 0.978 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1911380290985107
Epoch: 16, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.098144769668579
Epoch: 17, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1667532920837402
Epoch: 18, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.851 Vali Acc: 0.754 Test Loss: 0.851 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2388789653778076
Epoch: 19, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 151506
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.294938087463379
Epoch: 1, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.420 Vali Acc: 0.823 Test Loss: 0.420 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.1362602710723877
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.416 Vali Acc: 0.840 Test Loss: 0.416 Test Acc: 0.840
Validation loss decreased (-0.822521 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.3578202724456787
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.575 Vali Acc: 0.795 Test Loss: 0.575 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.158862590789795
Epoch: 4, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.387 Vali Acc: 0.863 Test Loss: 0.387 Test Acc: 0.863
Validation loss decreased (-0.839586 --> -0.863477).  Saving model ...
Epoch: 5 cost time: 2.332447052001953
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.445 Vali Acc: 0.812 Test Loss: 0.445 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2142112255096436
Epoch: 6, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1660053730010986
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.455 Vali Acc: 0.829 Test Loss: 0.455 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.237323522567749
Epoch: 8, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
Validation loss decreased (-0.863477 --> -0.866890).  Saving model ...
Epoch: 9 cost time: 2.166602373123169
Epoch: 9, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5081305503845215
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.415 Vali Acc: 0.843 Test Loss: 0.415 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3728702068328857
Epoch: 11, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.475 Vali Acc: 0.846 Test Loss: 0.475 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3104312419891357
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.394 Vali Acc: 0.881 Test Loss: 0.394 Test Acc: 0.881
Validation loss decreased (-0.866890 --> -0.880542).  Saving model ...
Epoch: 13 cost time: 2.279480457305908
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.531 Vali Acc: 0.840 Test Loss: 0.531 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1089563369750977
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0024168491363525
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.494 Vali Acc: 0.860 Test Loss: 0.494 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0031228065490723
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2292850017547607
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1871142387390137
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.422 Vali Acc: 0.874 Test Loss: 0.422 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.324831247329712
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.136502742767334
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.615 Vali Acc: 0.870 Test Loss: 0.615 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.224905490875244
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2691898345947266
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 325650
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8307437896728516
Epoch: 1, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.423 Vali Acc: 0.829 Test Loss: 0.423 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.0144574642181396
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
Validation loss decreased (-0.829347 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.8696143627166748
Epoch: 3, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.566 Vali Acc: 0.802 Test Loss: 0.566 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.134809732437134
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
Validation loss decreased (-0.836173 --> -0.849826).  Saving model ...
Epoch: 5 cost time: 2.262995958328247
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.457 Vali Acc: 0.785 Test Loss: 0.457 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3407039642333984
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.468 Vali Acc: 0.799 Test Loss: 0.468 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.237593412399292
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.443 Vali Acc: 0.805 Test Loss: 0.443 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.283176898956299
Epoch: 8, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
Validation loss decreased (-0.849826 --> -0.894195).  Saving model ...
Epoch: 9 cost time: 2.1756296157836914
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1873292922973633
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.453 Vali Acc: 0.846 Test Loss: 0.453 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.272627592086792
Epoch: 11, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.21193265914917
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.397 Vali Acc: 0.867 Test Loss: 0.397 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.423865795135498
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3922359943389893
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.331434488296509
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.584 Vali Acc: 0.829 Test Loss: 0.584 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.259591817855835
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2764573097229004
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.664 Vali Acc: 0.836 Test Loss: 0.664 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1802265644073486
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.572 Vali Acc: 0.860 Test Loss: 0.572 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 325650
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.777815103530884
Epoch: 1, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.416 Vali Acc: 0.836 Test Loss: 0.416 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 2.3693695068359375
Epoch: 2, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.405 Vali Acc: 0.846 Test Loss: 0.405 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846412).  Saving model ...
Epoch: 3 cost time: 2.340327024459839
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.562 Vali Acc: 0.795 Test Loss: 0.562 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0986521244049072
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
Validation loss decreased (-0.846412 --> -0.873717).  Saving model ...
Epoch: 5 cost time: 1.9313154220581055
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.442 Vali Acc: 0.805 Test Loss: 0.442 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9929931163787842
Epoch: 6, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.498 Vali Acc: 0.747 Test Loss: 0.498 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0470526218414307
Epoch: 7, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.423 Vali Acc: 0.829 Test Loss: 0.423 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.255923271179199
Epoch: 8, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.330 Vali Acc: 0.898 Test Loss: 0.330 Test Acc: 0.898
Validation loss decreased (-0.873717 --> -0.897608).  Saving model ...
Epoch: 9 cost time: 2.0956881046295166
Epoch: 9, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.525 Vali Acc: 0.840 Test Loss: 0.525 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4448928833007812
Epoch: 10, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.435 Vali Acc: 0.846 Test Loss: 0.435 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1943602561950684
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.250026226043701
Epoch: 12, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0163142681121826
Epoch: 13, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.555 Vali Acc: 0.836 Test Loss: 0.555 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.110257625579834
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.480 Vali Acc: 0.860 Test Loss: 0.480 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.232241153717041
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.529 Vali Acc: 0.846 Test Loss: 0.529 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.092662811279297
Epoch: 16, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1851024627685547
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.081780433654785
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.682 Vali Acc: 0.857 Test Loss: 0.682 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 325650
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.171317100524902
Epoch: 1, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.443 Vali Acc: 0.809 Test Loss: 0.443 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.9662132263183594
Epoch: 2, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.396 Vali Acc: 0.843 Test Loss: 0.396 Test Acc: 0.843
Validation loss decreased (-0.808869 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 1.8991217613220215
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.597 Vali Acc: 0.782 Test Loss: 0.597 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9285600185394287
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.371 Vali Acc: 0.860 Test Loss: 0.371 Test Acc: 0.860
Validation loss decreased (-0.842999 --> -0.860065).  Saving model ...
Epoch: 5 cost time: 1.867271900177002
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8215947151184082
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.020059823989868
Epoch: 7, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9574391841888428
Epoch: 8, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.344 Vali Acc: 0.853 Test Loss: 0.344 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.068690538406372
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7992103099822998
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9818992614746094
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9330828189849854
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.553 Vali Acc: 0.785 Test Loss: 0.553 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9027042388916016
Epoch: 13, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0063822269439697
Epoch: 14, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 325650
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.181512117385864
Epoch: 1, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.9508488178253174
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.433 Vali Acc: 0.809 Test Loss: 0.433 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0019569396972656
Epoch: 3, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.465 Vali Acc: 0.788 Test Loss: 0.465 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8738861083984375
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
Validation loss decreased (-0.812282 --> -0.822522).  Saving model ...
Epoch: 5 cost time: 2.0466108322143555
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.478 Vali Acc: 0.802 Test Loss: 0.478 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9745166301727295
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
Validation loss decreased (-0.822522 --> -0.836173).  Saving model ...
Epoch: 7 cost time: 1.9046201705932617
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.886239767074585
Epoch: 8, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.836173 --> -0.870304).  Saving model ...
Epoch: 9 cost time: 1.979210376739502
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.216613531112671
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.474 Vali Acc: 0.836 Test Loss: 0.474 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.139404773712158
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.417 Vali Acc: 0.853 Test Loss: 0.417 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9868083000183105
Epoch: 12, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.151298761367798
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.442 Vali Acc: 0.829 Test Loss: 0.442 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9229025840759277
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8704040050506592
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.885777473449707
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.677 Vali Acc: 0.836 Test Loss: 0.677 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9058868885040283
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.577 Vali Acc: 0.840 Test Loss: 0.577 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7940659523010254
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.637 Vali Acc: 0.857 Test Loss: 0.637 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 194578
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.815629482269287
Epoch: 1, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.427 Vali Acc: 0.819 Test Loss: 0.427 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 1.8273711204528809
Epoch: 2, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.441 Vali Acc: 0.823 Test Loss: 0.441 Test Acc: 0.823
Validation loss decreased (-0.819108 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.7384192943572998
Epoch: 3, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.470 Vali Acc: 0.775 Test Loss: 0.470 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8059062957763672
Epoch: 4, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.411 Vali Acc: 0.823 Test Loss: 0.411 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.6845629215240479
Epoch: 5, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7676153182983398
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.406 Vali Acc: 0.812 Test Loss: 0.406 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0983328819274902
Epoch: 7, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.585 Vali Acc: 0.802 Test Loss: 0.585 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0266168117523193
Epoch: 8, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
Validation loss decreased (-0.822521 --> -0.883956).  Saving model ...
Epoch: 9 cost time: 2.128056764602661
Epoch: 9, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8875129222869873
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.464 Vali Acc: 0.843 Test Loss: 0.464 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.23663330078125
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1816656589508057
Epoch: 12, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0920958518981934
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0203964710235596
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0114593505859375
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1761865615844727
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.097398519515991
Epoch: 17, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.548 Vali Acc: 0.843 Test Loss: 0.548 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1389687061309814
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.783 Vali Acc: 0.829 Test Loss: 0.783 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 194578
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.169315338134766
Epoch: 1, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.9174115657806396
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.9561243057250977
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.441 Vali Acc: 0.785 Test Loss: 0.441 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0475590229034424
Epoch: 4, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.969355821609497
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.428 Vali Acc: 0.843 Test Loss: 0.428 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.842999).  Saving model ...
Epoch: 6 cost time: 2.045400619506836
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.399 Vali Acc: 0.812 Test Loss: 0.399 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.101536989212036
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.842999 --> -0.849825).  Saving model ...
Epoch: 8 cost time: 1.89707612991333
Epoch: 8, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
Validation loss decreased (-0.849825 --> -0.877129).  Saving model ...
Epoch: 9 cost time: 1.9162046909332275
Epoch: 9, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.388 Vali Acc: 0.867 Test Loss: 0.388 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8452446460723877
Epoch: 10, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.482 Vali Acc: 0.846 Test Loss: 0.482 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8487753868103027
Epoch: 11, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8268964290618896
Epoch: 12, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7198162078857422
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8555974960327148
Epoch: 14, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0416455268859863
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.515 Vali Acc: 0.836 Test Loss: 0.515 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6873188018798828
Epoch: 16, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.502 Vali Acc: 0.863 Test Loss: 0.502 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.724879503250122
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.783 Vali Acc: 0.823 Test Loss: 0.783 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0335135459899902
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.541 Vali Acc: 0.857 Test Loss: 0.541 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 194578
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.593424081802368
Epoch: 1, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 2.002768039703369
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.417 Vali Acc: 0.829 Test Loss: 0.417 Test Acc: 0.829
Validation loss decreased (-0.808869 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 1.7632863521575928
Epoch: 3, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
Validation loss decreased (-0.829347 --> -0.829348).  Saving model ...
Epoch: 4 cost time: 1.7341959476470947
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.397 Vali Acc: 0.829 Test Loss: 0.397 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9420819282531738
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.387 Vali Acc: 0.819 Test Loss: 0.387 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.954606533050537
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.459 Vali Acc: 0.799 Test Loss: 0.459 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8752682209014893
Epoch: 7, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.369 Vali Acc: 0.857 Test Loss: 0.369 Test Acc: 0.857
Validation loss decreased (-0.829348 --> -0.856652).  Saving model ...
Epoch: 8 cost time: 1.9565410614013672
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.355 Vali Acc: 0.853 Test Loss: 0.355 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9248056411743164
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9039156436920166
Epoch: 10, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.484 Vali Acc: 0.812 Test Loss: 0.484 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.949373722076416
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.396 Vali Acc: 0.874 Test Loss: 0.396 Test Acc: 0.874
Validation loss decreased (-0.856652 --> -0.873716).  Saving model ...
Epoch: 12 cost time: 1.757277488708496
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7440526485443115
Epoch: 13, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.524 Vali Acc: 0.799 Test Loss: 0.524 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8097071647644043
Epoch: 14, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9918501377105713
Epoch: 15, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9926583766937256
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.542 Vali Acc: 0.805 Test Loss: 0.542 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7521049976348877
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.507 Vali Acc: 0.840 Test Loss: 0.507 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7725677490234375
Epoch: 18, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.733 Vali Acc: 0.782 Test Loss: 0.733 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.578603982925415
Epoch: 19, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.561 Vali Acc: 0.802 Test Loss: 0.561 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7200472354888916
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.419360876083374
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.870 Vali Acc: 0.768 Test Loss: 0.870 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 194578
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9521257877349854
Epoch: 1, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.462 Vali Acc: 0.799 Test Loss: 0.462 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.7629611492156982
Epoch: 2, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
Validation loss decreased (-0.798630 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.837348461151123
Epoch: 3, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.425 Vali Acc: 0.843 Test Loss: 0.425 Test Acc: 0.843
Validation loss decreased (-0.812282 --> -0.842999).  Saving model ...
Epoch: 4 cost time: 1.776628017425537
Epoch: 4, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7722551822662354
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.456 Vali Acc: 0.805 Test Loss: 0.456 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6272666454315186
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.361 Vali Acc: 0.857 Test Loss: 0.361 Test Acc: 0.857
Validation loss decreased (-0.842999 --> -0.856652).  Saving model ...
Epoch: 7 cost time: 1.8431007862091064
Epoch: 7, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.394 Vali Acc: 0.857 Test Loss: 0.394 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9047136306762695
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.379 Vali Acc: 0.860 Test Loss: 0.379 Test Acc: 0.860
Validation loss decreased (-0.856652 --> -0.860064).  Saving model ...
Epoch: 9 cost time: 1.8994107246398926
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.486 Vali Acc: 0.792 Test Loss: 0.486 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7724943161010742
Epoch: 10, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.885434865951538
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.608 Vali Acc: 0.785 Test Loss: 0.608 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8038725852966309
Epoch: 12, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.759026050567627
Epoch: 13, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.441 Vali Acc: 0.863 Test Loss: 0.441 Test Acc: 0.863
Validation loss decreased (-0.860064 --> -0.863477).  Saving model ...
Epoch: 14 cost time: 1.7847018241882324
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.857 Test Loss: 0.480 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.849672794342041
Epoch: 15, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
Validation loss decreased (-0.863477 --> -0.866890).  Saving model ...
Epoch: 16 cost time: 1.7943222522735596
Epoch: 16, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.533 Vali Acc: 0.846 Test Loss: 0.533 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7138464450836182
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.762300968170166
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8024632930755615
Epoch: 19, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.510 Vali Acc: 0.840 Test Loss: 0.510 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8642914295196533
Epoch: 20, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.525 Vali Acc: 0.857 Test Loss: 0.525 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7934894561767578
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.623 Vali Acc: 0.836 Test Loss: 0.623 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7701056003570557
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8591248989105225
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.758 Vali Acc: 0.843 Test Loss: 0.758 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8946623802185059
Epoch: 24, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.613 Vali Acc: 0.863 Test Loss: 0.613 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.821981430053711
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.661 Vali Acc: 0.836 Test Loss: 0.661 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 129042
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9271743297576904
Epoch: 1, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.463 Vali Acc: 0.792 Test Loss: 0.463 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.6916084289550781
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.791804 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.8086557388305664
Epoch: 3, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.421 Vali Acc: 0.846 Test Loss: 0.421 Test Acc: 0.846
Validation loss decreased (-0.808869 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 1.886023759841919
Epoch: 4, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.384 Vali Acc: 0.846 Test Loss: 0.384 Test Acc: 0.846
Validation loss decreased (-0.846412 --> -0.846413).  Saving model ...
Epoch: 5 cost time: 1.7778236865997314
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.86216402053833
Epoch: 6, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.347 Vali Acc: 0.867 Test Loss: 0.347 Test Acc: 0.867
Validation loss decreased (-0.846413 --> -0.866891).  Saving model ...
Epoch: 7 cost time: 1.842952013015747
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.357 Vali Acc: 0.874 Test Loss: 0.357 Test Acc: 0.874
Validation loss decreased (-0.866891 --> -0.873717).  Saving model ...
Epoch: 8 cost time: 1.923192024230957
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.398 Vali Acc: 0.853 Test Loss: 0.398 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.952876091003418
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.418 Vali Acc: 0.819 Test Loss: 0.418 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9638876914978027
Epoch: 10, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8560519218444824
Epoch: 11, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.505 Vali Acc: 0.816 Test Loss: 0.505 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7210180759429932
Epoch: 12, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.424 Vali Acc: 0.860 Test Loss: 0.424 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.724196434020996
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.755964994430542
Epoch: 14, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.471 Vali Acc: 0.860 Test Loss: 0.471 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8538413047790527
Epoch: 15, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.411 Vali Acc: 0.887 Test Loss: 0.411 Test Acc: 0.887
Validation loss decreased (-0.873717 --> -0.887368).  Saving model ...
Epoch: 16 cost time: 1.7049603462219238
Epoch: 16, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.513 Vali Acc: 0.823 Test Loss: 0.513 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9462597370147705
Epoch: 17, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8548851013183594
Epoch: 18, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9824779033660889
Epoch: 19, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.536 Vali Acc: 0.843 Test Loss: 0.536 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8207380771636963
Epoch: 20, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.539 Vali Acc: 0.874 Test Loss: 0.539 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8569097518920898
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.650 Vali Acc: 0.826 Test Loss: 0.650 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9774713516235352
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.006027936935425
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.815 Vali Acc: 0.836 Test Loss: 0.815 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.008864641189575
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.904 Test Loss: 0.466 Test Acc: 0.904
Validation loss decreased (-0.887368 --> -0.904432).  Saving model ...
Epoch: 25 cost time: 1.8983640670776367
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.704 Vali Acc: 0.819 Test Loss: 0.704 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9989373683929443
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.627 Vali Acc: 0.863 Test Loss: 0.627 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.12843656539917
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.646 Vali Acc: 0.857 Test Loss: 0.646 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0550477504730225
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.604 Vali Acc: 0.870 Test Loss: 0.604 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.115816116333008
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.820 Vali Acc: 0.840 Test Loss: 0.820 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0289125442504883
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.752 Vali Acc: 0.853 Test Loss: 0.752 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.0682079792022705
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.761 Vali Acc: 0.857 Test Loss: 0.761 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9641799926757812
Epoch: 32, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.677 Vali Acc: 0.867 Test Loss: 0.677 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9584946632385254
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.884 Test Loss: 0.617 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9627487659454346
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.881 Test Loss: 0.643 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 129042
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8343873023986816
Epoch: 1, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.8695416450500488
Epoch: 2, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
Validation loss decreased (-0.808869 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.731560468673706
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.416 Vali Acc: 0.853 Test Loss: 0.416 Test Acc: 0.853
Validation loss decreased (-0.812282 --> -0.853238).  Saving model ...
Epoch: 4 cost time: 1.8010635375976562
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.378 Vali Acc: 0.857 Test Loss: 0.378 Test Acc: 0.857
Validation loss decreased (-0.853238 --> -0.856652).  Saving model ...
Epoch: 5 cost time: 1.6734733581542969
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.470 Vali Acc: 0.788 Test Loss: 0.470 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8894925117492676
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
Validation loss decreased (-0.856652 --> -0.870304).  Saving model ...
Epoch: 7 cost time: 1.9663670063018799
Epoch: 7, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.383 Vali Acc: 0.860 Test Loss: 0.383 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.882946252822876
Epoch: 8, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7376735210418701
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.363 Vali Acc: 0.881 Test Loss: 0.363 Test Acc: 0.881
Validation loss decreased (-0.870304 --> -0.880542).  Saving model ...
Epoch: 10 cost time: 1.8110730648040771
Epoch: 10, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6110539436340332
Epoch: 11, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.825148105621338
Epoch: 12, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.386 Vali Acc: 0.901 Test Loss: 0.386 Test Acc: 0.901
Validation loss decreased (-0.880542 --> -0.901020).  Saving model ...
Epoch: 13 cost time: 1.7208335399627686
Epoch: 13, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.906588077545166
Epoch: 14, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.560 Vali Acc: 0.829 Test Loss: 0.560 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.800049066543579
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8708171844482422
Epoch: 16, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9218089580535889
Epoch: 17, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7757833003997803
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.836 Test Loss: 0.550 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7544467449188232
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7899584770202637
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.476 Vali Acc: 0.894 Test Loss: 0.476 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7580468654632568
Epoch: 21, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.596 Vali Acc: 0.840 Test Loss: 0.596 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9420733451843262
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.751 Vali Acc: 0.833 Test Loss: 0.751 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 129042
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6698620319366455
Epoch: 1, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.481 Vali Acc: 0.778 Test Loss: 0.481 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 1.8938689231872559
Epoch: 2, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
Validation loss decreased (-0.778152 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 1.7598063945770264
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.388 Vali Acc: 0.853 Test Loss: 0.388 Test Acc: 0.853
Validation loss decreased (-0.805456 --> -0.853238).  Saving model ...
Epoch: 4 cost time: 1.8563644886016846
Epoch: 4, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.359 Vali Acc: 0.853 Test Loss: 0.359 Test Acc: 0.853
Validation loss decreased (-0.853238 --> -0.853239).  Saving model ...
Epoch: 5 cost time: 1.771155595779419
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.454 Vali Acc: 0.785 Test Loss: 0.454 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7053892612457275
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.431 Vali Acc: 0.802 Test Loss: 0.431 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.89839506149292
Epoch: 7, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.429 Vali Acc: 0.819 Test Loss: 0.429 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6728551387786865
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7887272834777832
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7559874057769775
Epoch: 10, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.357 Vali Acc: 0.857 Test Loss: 0.357 Test Acc: 0.857
Validation loss decreased (-0.853239 --> -0.856652).  Saving model ...
Epoch: 11 cost time: 1.8607642650604248
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8319077491760254
Epoch: 12, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8183541297912598
Epoch: 13, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.513 Vali Acc: 0.823 Test Loss: 0.513 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7101032733917236
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.472 Vali Acc: 0.823 Test Loss: 0.472 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.576214075088501
Epoch: 15, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.456 Vali Acc: 0.829 Test Loss: 0.456 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.840151071548462
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.754 Vali Acc: 0.768 Test Loss: 0.754 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0075011253356934
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.444 Vali Acc: 0.836 Test Loss: 0.444 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9133358001708984
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.573 Vali Acc: 0.799 Test Loss: 0.573 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8096628189086914
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.893 Vali Acc: 0.747 Test Loss: 0.893 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8438560962677002
Epoch: 20, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.497 Vali Acc: 0.843 Test Loss: 0.497 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 129042
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.065959215164185
Epoch: 1, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.467 Vali Acc: 0.765 Test Loss: 0.467 Test Acc: 0.765
Validation loss decreased (inf --> -0.764500).  Saving model ...
Epoch: 2 cost time: 1.7561657428741455
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.432 Vali Acc: 0.819 Test Loss: 0.432 Test Acc: 0.819
Validation loss decreased (-0.764500 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.889836311340332
Epoch: 3, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
Validation loss decreased (-0.819108 --> -0.870304).  Saving model ...
Epoch: 4 cost time: 1.8007919788360596
Epoch: 4, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7839992046356201
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8578965663909912
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9308483600616455
Epoch: 7, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.992436170578003
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7858076095581055
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.527 Vali Acc: 0.802 Test Loss: 0.527 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8902785778045654
Epoch: 10, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
Validation loss decreased (-0.870304 --> -0.890781).  Saving model ...
Epoch: 11 cost time: 1.9208853244781494
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.426 Vali Acc: 0.857 Test Loss: 0.426 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8647851943969727
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.423 Vali Acc: 0.853 Test Loss: 0.423 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7333917617797852
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8984355926513672
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8546648025512695
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.498 Vali Acc: 0.877 Test Loss: 0.498 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8795371055603027
Epoch: 16, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.743 Vali Acc: 0.846 Test Loss: 0.743 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9852511882781982
Epoch: 17, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.490 Vali Acc: 0.857 Test Loss: 0.490 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.916499137878418
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.587 Vali Acc: 0.857 Test Loss: 0.587 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.896329402923584
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.519 Vali Acc: 0.867 Test Loss: 0.519 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1303670406341553
Epoch: 20, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.572 Vali Acc: 0.846 Test Loss: 0.572 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 96274
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.883302927017212
Epoch: 1, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.473 Vali Acc: 0.747 Test Loss: 0.473 Test Acc: 0.747
Validation loss decreased (inf --> -0.747436).  Saving model ...
Epoch: 2 cost time: 1.885526180267334
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.434 Vali Acc: 0.823 Test Loss: 0.434 Test Acc: 0.823
Validation loss decreased (-0.747436 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.6589295864105225
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.341 Vali Acc: 0.874 Test Loss: 0.341 Test Acc: 0.874
Validation loss decreased (-0.822521 --> -0.873717).  Saving model ...
Epoch: 4 cost time: 1.8080947399139404
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.534 Vali Acc: 0.758 Test Loss: 0.534 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7539262771606445
Epoch: 5, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.440 Vali Acc: 0.799 Test Loss: 0.440 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9540772438049316
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.421 Vali Acc: 0.829 Test Loss: 0.421 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8684873580932617
Epoch: 7, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.378 Vali Acc: 0.843 Test Loss: 0.378 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8098130226135254
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7641866207122803
Epoch: 9, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.546 Vali Acc: 0.795 Test Loss: 0.546 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9746568202972412
Epoch: 10, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8531997203826904
Epoch: 11, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.426 Vali Acc: 0.829 Test Loss: 0.426 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8750495910644531
Epoch: 12, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.388 Vali Acc: 0.846 Test Loss: 0.388 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7685940265655518
Epoch: 13, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 96274
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7363462448120117
Epoch: 1, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.465 Vali Acc: 0.768 Test Loss: 0.465 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.6765751838684082
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.767913 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.6297390460968018
Epoch: 3, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.335 Vali Acc: 0.863 Test Loss: 0.335 Test Acc: 0.863
Validation loss decreased (-0.832760 --> -0.863478).  Saving model ...
Epoch: 4 cost time: 1.7116777896881104
Epoch: 4, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.489 Vali Acc: 0.771 Test Loss: 0.489 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.718947172164917
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.409 Vali Acc: 0.826 Test Loss: 0.409 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7702507972717285
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.390 Vali Acc: 0.853 Test Loss: 0.390 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8330724239349365
Epoch: 7, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9671597480773926
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.464 Vali Acc: 0.782 Test Loss: 0.464 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8887569904327393
Epoch: 9, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.527 Vali Acc: 0.778 Test Loss: 0.527 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6897304058074951
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
Validation loss decreased (-0.863478 --> -0.870303).  Saving model ...
Epoch: 11 cost time: 1.5880231857299805
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.525 Vali Acc: 0.805 Test Loss: 0.525 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6642084121704102
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
Validation loss decreased (-0.870303 --> -0.890782).  Saving model ...
Epoch: 13 cost time: 1.563497543334961
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.375 Vali Acc: 0.874 Test Loss: 0.375 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6974470615386963
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.505 Vali Acc: 0.805 Test Loss: 0.505 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8192822933197021
Epoch: 15, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.389 Vali Acc: 0.874 Test Loss: 0.389 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8846030235290527
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.524 Vali Acc: 0.860 Test Loss: 0.524 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5698623657226562
Epoch: 17, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.399 Vali Acc: 0.863 Test Loss: 0.399 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7110414505004883
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.660975456237793
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.692 Vali Acc: 0.802 Test Loss: 0.692 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6987674236297607
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.438 Vali Acc: 0.881 Test Loss: 0.438 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7854750156402588
Epoch: 21, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6767017841339111
Epoch: 22, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.538 Vali Acc: 0.860 Test Loss: 0.538 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 96274
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.099428415298462
Epoch: 1, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.494 Vali Acc: 0.768 Test Loss: 0.494 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.4766807556152344
Epoch: 2, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
Validation loss decreased (-0.767913 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.8018467426300049
Epoch: 3, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
Validation loss decreased (-0.822521 --> -0.866891).  Saving model ...
Epoch: 4 cost time: 1.7533328533172607
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.577 Vali Acc: 0.758 Test Loss: 0.577 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7599976062774658
Epoch: 5, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.486 Vali Acc: 0.765 Test Loss: 0.486 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.708219051361084
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.424 Vali Acc: 0.819 Test Loss: 0.424 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.695225715637207
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.355 Vali Acc: 0.843 Test Loss: 0.355 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7052867412567139
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.436 Vali Acc: 0.819 Test Loss: 0.436 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.738431692123413
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7639641761779785
Epoch: 10, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.327 Vali Acc: 0.874 Test Loss: 0.327 Test Acc: 0.874
Validation loss decreased (-0.866891 --> -0.873717).  Saving model ...
Epoch: 11 cost time: 1.6587934494018555
Epoch: 11, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.507 Vali Acc: 0.782 Test Loss: 0.507 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7436728477478027
Epoch: 12, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.348 Vali Acc: 0.860 Test Loss: 0.348 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8051261901855469
Epoch: 13, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8059887886047363
Epoch: 14, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6722147464752197
Epoch: 15, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6453666687011719
Epoch: 16, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.71415114402771
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6848225593566895
Epoch: 18, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.414 Vali Acc: 0.881 Test Loss: 0.414 Test Acc: 0.881
Validation loss decreased (-0.873717 --> -0.880542).  Saving model ...
Epoch: 19 cost time: 1.6405413150787354
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.569 Vali Acc: 0.799 Test Loss: 0.569 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6300039291381836
Epoch: 20, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.445 Vali Acc: 0.881 Test Loss: 0.445 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6546945571899414
Epoch: 21, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8453383445739746
Epoch: 22, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.508 Vali Acc: 0.826 Test Loss: 0.508 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8419389724731445
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5424120426177979
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.722703218460083
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.437 Vali Acc: 0.863 Test Loss: 0.437 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.76253080368042
Epoch: 26, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8661789894104004
Epoch: 27, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.653 Vali Acc: 0.836 Test Loss: 0.653 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6456105709075928
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 96274
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.675422430038452
Epoch: 1, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 1.6979131698608398
Epoch: 2, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.450 Vali Acc: 0.846 Test Loss: 0.450 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846412).  Saving model ...
Epoch: 3 cost time: 1.670804738998413
Epoch: 3, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6697814464569092
Epoch: 4, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.715986967086792
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
Validation loss decreased (-0.846412 --> -0.866891).  Saving model ...
Epoch: 6 cost time: 1.8403069972991943
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.508 Vali Acc: 0.823 Test Loss: 0.508 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6226482391357422
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.429 Vali Acc: 0.846 Test Loss: 0.429 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6773393154144287
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.404 Vali Acc: 0.840 Test Loss: 0.404 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8708748817443848
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7755157947540283
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6495769023895264
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7105159759521484
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6634929180145264
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7373549938201904
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.445 Vali Acc: 0.860 Test Loss: 0.445 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7828969955444336
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.638 Vali Acc: 0.823 Test Loss: 0.638 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 79890
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7623825073242188
Epoch: 1, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.413 Vali Acc: 0.853 Test Loss: 0.413 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 1.5511939525604248
Epoch: 2, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.449 Vali Acc: 0.836 Test Loss: 0.449 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6638753414154053
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.433 Vali Acc: 0.846 Test Loss: 0.433 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6735186576843262
Epoch: 4, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8630969524383545
Epoch: 5, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866891).  Saving model ...
Epoch: 6 cost time: 1.8597767353057861
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5856287479400635
Epoch: 7, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.428 Vali Acc: 0.857 Test Loss: 0.428 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7804756164550781
Epoch: 8, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.394 Vali Acc: 0.860 Test Loss: 0.394 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.841878890991211
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.402 Vali Acc: 0.853 Test Loss: 0.402 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9452283382415771
Epoch: 10, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5936200618743896
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.552 Vali Acc: 0.795 Test Loss: 0.552 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8084514141082764
Epoch: 12, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.429 Vali Acc: 0.860 Test Loss: 0.429 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7792763710021973
Epoch: 13, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8020071983337402
Epoch: 14, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
Validation loss decreased (-0.866891 --> -0.870303).  Saving model ...
Epoch: 15 cost time: 1.7492399215698242
Epoch: 15, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.488 Vali Acc: 0.843 Test Loss: 0.488 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.515988826751709
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.511 Vali Acc: 0.840 Test Loss: 0.511 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7545013427734375
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.431 Vali Acc: 0.894 Test Loss: 0.431 Test Acc: 0.894
Validation loss decreased (-0.870303 --> -0.894194).  Saving model ...
Epoch: 18 cost time: 1.907712459564209
Epoch: 18, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8566579818725586
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7316474914550781
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7570550441741943
Epoch: 21, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7283391952514648
Epoch: 22, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.670 Vali Acc: 0.853 Test Loss: 0.670 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7145068645477295
Epoch: 23, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.714 Vali Acc: 0.826 Test Loss: 0.714 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.91593337059021
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.561 Vali Acc: 0.881 Test Loss: 0.561 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6549484729766846
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.683 Vali Acc: 0.840 Test Loss: 0.683 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7210700511932373
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6383781433105469
Epoch: 27, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.982 Vali Acc: 0.805 Test Loss: 0.982 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 79890
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6758315563201904
Epoch: 1, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.398 Vali Acc: 0.860 Test Loss: 0.398 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 1.6919145584106445
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.429 Vali Acc: 0.840 Test Loss: 0.429 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4437572956085205
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.421 Vali Acc: 0.843 Test Loss: 0.421 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.717911720275879
Epoch: 4, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.393 Vali Acc: 0.836 Test Loss: 0.393 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7434718608856201
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
Validation loss decreased (-0.860064 --> -0.877130).  Saving model ...
Epoch: 6 cost time: 1.8302946090698242
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6239283084869385
Epoch: 7, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.430 Vali Acc: 0.843 Test Loss: 0.430 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.693713903427124
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
Validation loss decreased (-0.877130 --> -0.883956).  Saving model ...
Epoch: 9 cost time: 1.693129539489746
Epoch: 9, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.404 Vali Acc: 0.857 Test Loss: 0.404 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6447668075561523
Epoch: 10, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6896674633026123
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.496 Vali Acc: 0.795 Test Loss: 0.496 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8050343990325928
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.401 Vali Acc: 0.887 Test Loss: 0.401 Test Acc: 0.887
Validation loss decreased (-0.883956 --> -0.887368).  Saving model ...
Epoch: 13 cost time: 1.7348558902740479
Epoch: 13, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8048851490020752
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.783757209777832
Epoch: 15, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.426 Vali Acc: 0.887 Test Loss: 0.426 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6999685764312744
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.726 Vali Acc: 0.768 Test Loss: 0.726 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6930880546569824
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.405 Vali Acc: 0.887 Test Loss: 0.405 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8360569477081299
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4877352714538574
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.750596284866333
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.781562328338623
Epoch: 21, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.724 Vali Acc: 0.809 Test Loss: 0.724 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.98984694480896
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.552 Vali Acc: 0.891 Test Loss: 0.552 Test Acc: 0.891
Validation loss decreased (-0.887368 --> -0.890779).  Saving model ...
Epoch: 23 cost time: 1.7375664710998535
Epoch: 23, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.937 Vali Acc: 0.771 Test Loss: 0.937 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.737990379333496
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.556 Vali Acc: 0.877 Test Loss: 0.556 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8555641174316406
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8888030052185059
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.667 Vali Acc: 0.870 Test Loss: 0.667 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8368432521820068
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.635 Vali Acc: 0.857 Test Loss: 0.635 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9609582424163818
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.686 Vali Acc: 0.819 Test Loss: 0.686 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9937896728515625
Epoch: 29, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.898 Vali Acc: 0.799 Test Loss: 0.898 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.90617036819458
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.730 Vali Acc: 0.853 Test Loss: 0.730 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9720268249511719
Epoch: 31, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.844 Vali Acc: 0.809 Test Loss: 0.844 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8521950244903564
Epoch: 32, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.834 Vali Acc: 0.853 Test Loss: 0.834 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 79890
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.838163137435913
Epoch: 1, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 1.755561113357544
Epoch: 2, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.393 Vali Acc: 0.829 Test Loss: 0.393 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 3 cost time: 1.7391955852508545
Epoch: 3, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7224833965301514
Epoch: 4, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
Validation loss decreased (-0.829348 --> -0.870304).  Saving model ...
Epoch: 5 cost time: 1.6990385055541992
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.323 Vali Acc: 0.874 Test Loss: 0.323 Test Acc: 0.874
Validation loss decreased (-0.870304 --> -0.873717).  Saving model ...
Epoch: 6 cost time: 1.7733209133148193
Epoch: 6, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.511 Vali Acc: 0.778 Test Loss: 0.511 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7598018646240234
Epoch: 7, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.432 Vali Acc: 0.809 Test Loss: 0.432 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6761865615844727
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.343 Vali Acc: 0.860 Test Loss: 0.343 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8390107154846191
Epoch: 9, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.410 Vali Acc: 0.826 Test Loss: 0.410 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7438673973083496
Epoch: 10, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7021152973175049
Epoch: 11, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6620573997497559
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.289 Vali Acc: 0.887 Test Loss: 0.289 Test Acc: 0.887
Validation loss decreased (-0.873717 --> -0.887369).  Saving model ...
Epoch: 13 cost time: 1.8389689922332764
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.591 Vali Acc: 0.805 Test Loss: 0.591 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.721855878829956
Epoch: 14, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7164483070373535
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.416 Vali Acc: 0.846 Test Loss: 0.416 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8147292137145996
Epoch: 16, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.736 Vali Acc: 0.765 Test Loss: 0.736 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7192819118499756
Epoch: 17, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6674792766571045
Epoch: 18, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7352333068847656
Epoch: 19, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.381 Vali Acc: 0.860 Test Loss: 0.381 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6969337463378906
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.425 Vali Acc: 0.874 Test Loss: 0.425 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.669999122619629
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.478 Vali Acc: 0.840 Test Loss: 0.478 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7368512153625488
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.493 Vali Acc: 0.829 Test Loss: 0.493 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 79890
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6399948596954346
Epoch: 1, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.7298369407653809
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8026094436645508
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7310435771942139
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.407 Vali Acc: 0.860 Test Loss: 0.407 Test Acc: 0.860
Validation loss decreased (-0.829347 --> -0.860064).  Saving model ...
Epoch: 5 cost time: 1.7691864967346191
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6697757244110107
Epoch: 6, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7036430835723877
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.495 Vali Acc: 0.823 Test Loss: 0.495 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6364355087280273
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.703429937362671
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.558 Vali Acc: 0.778 Test Loss: 0.558 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8141629695892334
Epoch: 10, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.403 Vali Acc: 0.857 Test Loss: 0.403 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5465419292449951
Epoch: 11, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3948030471801758
Epoch: 12, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5993220806121826
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4250094890594482
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 71698
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6549580097198486
Epoch: 1, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.414 Vali Acc: 0.823 Test Loss: 0.414 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.6180651187896729
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.822521 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.6928126811981201
Epoch: 3, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8589296340942383
Epoch: 4, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
Validation loss decreased (-0.832760 --> -0.870303).  Saving model ...
Epoch: 5 cost time: 1.7412159442901611
Epoch: 5, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.562 Vali Acc: 0.799 Test Loss: 0.562 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9237737655639648
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.496 Vali Acc: 0.802 Test Loss: 0.496 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8824958801269531
Epoch: 7, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8109424114227295
Epoch: 8, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.363 Vali Acc: 0.846 Test Loss: 0.363 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8121724128723145
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.460 Vali Acc: 0.799 Test Loss: 0.460 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9002304077148438
Epoch: 10, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5816636085510254
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.679 Vali Acc: 0.799 Test Loss: 0.679 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7590842247009277
Epoch: 12, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.408 Vali Acc: 0.894 Test Loss: 0.408 Test Acc: 0.894
Validation loss decreased (-0.870303 --> -0.894194).  Saving model ...
Epoch: 13 cost time: 1.8152797222137451
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.506 Vali Acc: 0.802 Test Loss: 0.506 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8813388347625732
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.432 Vali Acc: 0.881 Test Loss: 0.432 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.846245527267456
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.518 Vali Acc: 0.840 Test Loss: 0.518 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7947046756744385
Epoch: 16, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.542 Vali Acc: 0.805 Test Loss: 0.542 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8406939506530762
Epoch: 17, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.413 Vali Acc: 0.887 Test Loss: 0.413 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9664461612701416
Epoch: 18, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.490 Vali Acc: 0.846 Test Loss: 0.490 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7910444736480713
Epoch: 19, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9285459518432617
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.826 Vali Acc: 0.802 Test Loss: 0.826 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8869693279266357
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.625 Vali Acc: 0.863 Test Loss: 0.625 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6449646949768066
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 71698
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6867012977600098
Epoch: 1, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.415 Vali Acc: 0.826 Test Loss: 0.415 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 1.941819429397583
Epoch: 2, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.403 Vali Acc: 0.840 Test Loss: 0.403 Test Acc: 0.840
Validation loss decreased (-0.825934 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 1.763110637664795
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.832115888595581
Epoch: 4, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.386 Vali Acc: 0.863 Test Loss: 0.386 Test Acc: 0.863
Validation loss decreased (-0.839586 --> -0.863477).  Saving model ...
Epoch: 5 cost time: 1.6970386505126953
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.561 Vali Acc: 0.788 Test Loss: 0.561 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8976011276245117
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8208818435668945
Epoch: 7, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.868934154510498
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.346 Vali Acc: 0.870 Test Loss: 0.346 Test Acc: 0.870
Validation loss decreased (-0.863477 --> -0.870304).  Saving model ...
Epoch: 9 cost time: 1.8198611736297607
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.473 Vali Acc: 0.788 Test Loss: 0.473 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6557540893554688
Epoch: 10, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.333 Vali Acc: 0.898 Test Loss: 0.333 Test Acc: 0.898
Validation loss decreased (-0.870304 --> -0.897608).  Saving model ...
Epoch: 11 cost time: 1.8211336135864258
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8350605964660645
Epoch: 12, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.335 Vali Acc: 0.887 Test Loss: 0.335 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7335567474365234
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.445 Vali Acc: 0.836 Test Loss: 0.445 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.522723913192749
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0841269493103027
Epoch: 15, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.543 Vali Acc: 0.843 Test Loss: 0.543 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7887296676635742
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6883344650268555
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0324313640594482
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.511 Vali Acc: 0.846 Test Loss: 0.511 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.811788558959961
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8238577842712402
Epoch: 20, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 71698
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.608450412750244
Epoch: 1, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.457 Vali Acc: 0.792 Test Loss: 0.457 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.6586894989013672
Epoch: 2, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.369 Vali Acc: 0.860 Test Loss: 0.369 Test Acc: 0.860
Validation loss decreased (-0.791804 --> -0.860065).  Saving model ...
Epoch: 3 cost time: 1.6846234798431396
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.391 Vali Acc: 0.853 Test Loss: 0.391 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8363866806030273
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.69822359085083
Epoch: 5, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5943503379821777
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5321919918060303
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.476 Vali Acc: 0.792 Test Loss: 0.476 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6373233795166016
Epoch: 8, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.759758710861206
Epoch: 9, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.472 Vali Acc: 0.792 Test Loss: 0.472 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7393088340759277
Epoch: 10, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.279 Vali Acc: 0.898 Test Loss: 0.279 Test Acc: 0.898
Validation loss decreased (-0.860065 --> -0.897608).  Saving model ...
Epoch: 11 cost time: 1.9425506591796875
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.494 Vali Acc: 0.802 Test Loss: 0.494 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6686391830444336
Epoch: 12, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.315 Vali Acc: 0.881 Test Loss: 0.315 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6175804138183594
Epoch: 13, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7377336025238037
Epoch: 14, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6761705875396729
Epoch: 15, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.402 Vali Acc: 0.819 Test Loss: 0.402 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7293157577514648
Epoch: 16, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6385366916656494
Epoch: 17, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.336 Vali Acc: 0.881 Test Loss: 0.336 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.793060541152954
Epoch: 18, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7472374439239502
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.445 Vali Acc: 0.805 Test Loss: 0.445 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7956502437591553
Epoch: 20, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.523 Vali Acc: 0.823 Test Loss: 0.523 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 71698
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.977558612823486
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.730 Vali Acc: 0.860 Test Loss: 0.730 Test Acc: 0.860
Validation loss decreased (inf --> -0.860061).  Saving model ...
Epoch: 2 cost time: 3.9955272674560547
Epoch: 2, Steps: 17 | Train Loss: 1.251 Vali Loss: 2.594 Vali Acc: 0.672 Test Loss: 2.594 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.172429323196411
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.572 Vali Acc: 0.894 Test Loss: 0.572 Test Acc: 0.894
Validation loss decreased (-0.860061 --> -0.894192).  Saving model ...
Epoch: 4 cost time: 3.9668426513671875
Epoch: 4, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.247 Vali Acc: 0.706 Test Loss: 2.247 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9164230823516846
Epoch: 5, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.683 Vali Acc: 0.846 Test Loss: 0.683 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9463629722595215
Epoch: 6, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.101 Vali Acc: 0.792 Test Loss: 2.101 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.890517473220825
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 2.854 Vali Acc: 0.659 Test Loss: 2.854 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.817718029022217
Epoch: 8, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.693 Vali Acc: 0.850 Test Loss: 1.693 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8259875774383545
Epoch: 9, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.492 Vali Acc: 0.833 Test Loss: 1.492 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.130301475524902
Epoch: 10, Steps: 17 | Train Loss: 0.984 Vali Loss: 4.381 Vali Acc: 0.802 Test Loss: 4.381 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.109273910522461
Epoch: 11, Steps: 17 | Train Loss: 1.847 Vali Loss: 3.442 Vali Acc: 0.747 Test Loss: 3.442 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7661988735198975
Epoch: 12, Steps: 17 | Train Loss: 0.625 Vali Loss: 2.577 Vali Acc: 0.819 Test Loss: 2.577 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.699746608734131
Epoch: 13, Steps: 17 | Train Loss: 0.347 Vali Loss: 4.142 Vali Acc: 0.792 Test Loss: 4.142 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 3560490
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.968895673751831
Epoch: 1, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (inf --> -0.849822).  Saving model ...
Epoch: 2 cost time: 3.669328212738037
Epoch: 2, Steps: 17 | Train Loss: 1.248 Vali Loss: 2.850 Vali Acc: 0.642 Test Loss: 2.850 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8027141094207764
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.603 Vali Acc: 0.887 Test Loss: 0.603 Test Acc: 0.887
Validation loss decreased (-0.849822 --> -0.887366).  Saving model ...
Epoch: 4 cost time: 3.777440071105957
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.576 Vali Acc: 0.840 Test Loss: 0.576 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.629770278930664
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.865 Vali Acc: 0.857 Test Loss: 0.865 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9668893814086914
Epoch: 6, Steps: 17 | Train Loss: 0.557 Vali Loss: 1.353 Vali Acc: 0.826 Test Loss: 1.353 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.648871421813965
Epoch: 7, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.435 Vali Acc: 0.713 Test Loss: 2.435 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4670302867889404
Epoch: 8, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.979 Vali Acc: 0.870 Test Loss: 1.979 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.720606565475464
Epoch: 9, Steps: 17 | Train Loss: 0.621 Vali Loss: 2.576 Vali Acc: 0.730 Test Loss: 2.576 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.9010367393493652
Epoch: 10, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.762 Vali Acc: 0.768 Test Loss: 2.762 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.7285284996032715
Epoch: 11, Steps: 17 | Train Loss: 0.679 Vali Loss: 3.723 Vali Acc: 0.744 Test Loss: 3.723 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7092056274414062
Epoch: 12, Steps: 17 | Train Loss: 0.282 Vali Loss: 7.932 Vali Acc: 0.601 Test Loss: 7.932 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.740621566772461
Epoch: 13, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.940 Vali Acc: 0.860 Test Loss: 1.940 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 3560490
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.929260492324829
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.838 Vali Acc: 0.833 Test Loss: 0.838 Test Acc: 0.833
Validation loss decreased (inf --> -0.832756).  Saving model ...
Epoch: 2 cost time: 3.134881019592285
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 3.818 Vali Acc: 0.563 Test Loss: 3.818 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.324195623397827
Epoch: 3, Steps: 17 | Train Loss: 1.230 Vali Loss: 0.611 Vali Acc: 0.846 Test Loss: 0.611 Test Acc: 0.846
Validation loss decreased (-0.832756 --> -0.846410).  Saving model ...
Epoch: 4 cost time: 3.193380832672119
Epoch: 4, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.556 Vali Acc: 0.662 Test Loss: 2.556 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.029897689819336
Epoch: 5, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.724 Vali Acc: 0.881 Test Loss: 0.724 Test Acc: 0.881
Validation loss decreased (-0.846410 --> -0.880539).  Saving model ...
Epoch: 6 cost time: 2.9142589569091797
Epoch: 6, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.316 Vali Acc: 0.812 Test Loss: 1.316 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6065878868103027
Epoch: 7, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.457 Vali Acc: 0.823 Test Loss: 1.457 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4267654418945312
Epoch: 8, Steps: 17 | Train Loss: 1.299 Vali Loss: 2.006 Vali Acc: 0.788 Test Loss: 2.006 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.826885461807251
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 1.312 Vali Acc: 0.795 Test Loss: 1.312 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.681657314300537
Epoch: 10, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.615 Vali Acc: 0.853 Test Loss: 1.615 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3789775371551514
Epoch: 11, Steps: 17 | Train Loss: 0.292 Vali Loss: 4.328 Vali Acc: 0.720 Test Loss: 4.328 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4049253463745117
Epoch: 12, Steps: 17 | Train Loss: 0.399 Vali Loss: 2.936 Vali Acc: 0.765 Test Loss: 2.936 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3670260906219482
Epoch: 13, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.077 Vali Acc: 0.805 Test Loss: 2.077 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5183377265930176
Epoch: 14, Steps: 17 | Train Loss: 0.987 Vali Loss: 3.664 Vali Acc: 0.829 Test Loss: 3.664 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.8998959064483643
Epoch: 15, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.377 Vali Acc: 0.829 Test Loss: 2.377 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 3560490
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0184853076934814
Epoch: 1, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.815 Vali Acc: 0.826 Test Loss: 0.815 Test Acc: 0.826
Validation loss decreased (inf --> -0.825930).  Saving model ...
Epoch: 2 cost time: 3.355058193206787
Epoch: 2, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.985 Vali Acc: 0.655 Test Loss: 1.985 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4125168323516846
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.266 Vali Acc: 0.812 Test Loss: 1.266 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4123265743255615
Epoch: 4, Steps: 17 | Train Loss: 1.668 Vali Loss: 1.735 Vali Acc: 0.706 Test Loss: 1.735 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.400367498397827
Epoch: 5, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.347 Vali Acc: 0.713 Test Loss: 1.347 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.206144332885742
Epoch: 6, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.930 Vali Acc: 0.724 Test Loss: 1.930 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8829379081726074
Epoch: 7, Steps: 17 | Train Loss: 0.757 Vali Loss: 3.343 Vali Acc: 0.608 Test Loss: 3.343 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.109581232070923
Epoch: 8, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.301 Vali Acc: 0.754 Test Loss: 1.301 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.97237229347229
Epoch: 9, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.864 Vali Acc: 0.867 Test Loss: 0.864 Test Acc: 0.867
Validation loss decreased (-0.825930 --> -0.866886).  Saving model ...
Epoch: 10 cost time: 3.030582904815674
Epoch: 10, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.795 Vali Acc: 0.836 Test Loss: 1.795 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.040565252304077
Epoch: 11, Steps: 17 | Train Loss: 0.542 Vali Loss: 6.835 Vali Acc: 0.604 Test Loss: 6.835 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.379852533340454
Epoch: 12, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.231 Vali Acc: 0.891 Test Loss: 1.231 Test Acc: 0.891
Validation loss decreased (-0.866886 --> -0.890773).  Saving model ...
Epoch: 13 cost time: 3.2590062618255615
Epoch: 13, Steps: 17 | Train Loss: 0.397 Vali Loss: 3.505 Vali Acc: 0.754 Test Loss: 3.505 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.131723642349243
Epoch: 14, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.958 Vali Acc: 0.819 Test Loss: 2.958 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.079087018966675
Epoch: 15, Steps: 17 | Train Loss: 0.640 Vali Loss: 3.924 Vali Acc: 0.761 Test Loss: 3.924 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.938469886779785
Epoch: 16, Steps: 17 | Train Loss: 0.265 Vali Loss: 4.776 Vali Acc: 0.751 Test Loss: 4.776 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1429824829101562
Epoch: 17, Steps: 17 | Train Loss: 0.241 Vali Loss: 4.196 Vali Acc: 0.788 Test Loss: 4.196 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.40411114692688
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 4.057 Vali Acc: 0.788 Test Loss: 4.057 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.472527503967285
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 3.785 Vali Acc: 0.812 Test Loss: 3.785 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1704018115997314
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.566 Vali Acc: 0.812 Test Loss: 3.566 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.200587272644043
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 4.863 Vali Acc: 0.771 Test Loss: 4.863 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.043710231781006
Epoch: 22, Steps: 17 | Train Loss: 0.503 Vali Loss: 7.921 Vali Acc: 0.765 Test Loss: 7.921 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 3560490
model size : 23.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.658276796340942
Epoch: 1, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.152 Vali Acc: 0.747 Test Loss: 1.152 Test Acc: 0.747
Validation loss decreased (inf --> -0.747429).  Saving model ...
Epoch: 2 cost time: 3.6562740802764893
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.857 Vali Acc: 0.816 Test Loss: 0.857 Test Acc: 0.816
Validation loss decreased (-0.747429 --> -0.815691).  Saving model ...
Epoch: 3 cost time: 3.838870048522949
Epoch: 3, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.554 Vali Acc: 0.700 Test Loss: 1.554 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.819690704345703
Epoch: 4, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.096 Vali Acc: 0.843 Test Loss: 1.096 Test Acc: 0.843
Validation loss decreased (-0.815691 --> -0.842992).  Saving model ...
Epoch: 5 cost time: 3.7767062187194824
Epoch: 5, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.200 Vali Acc: 0.754 Test Loss: 2.200 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.406684637069702
Epoch: 6, Steps: 17 | Train Loss: 1.383 Vali Loss: 4.213 Vali Acc: 0.693 Test Loss: 4.213 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7882893085479736
Epoch: 7, Steps: 17 | Train Loss: 2.436 Vali Loss: 6.748 Vali Acc: 0.628 Test Loss: 6.748 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9369699954986572
Epoch: 8, Steps: 17 | Train Loss: 1.952 Vali Loss: 2.657 Vali Acc: 0.799 Test Loss: 2.657 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.036683559417725
Epoch: 9, Steps: 17 | Train Loss: 1.239 Vali Loss: 8.261 Vali Acc: 0.604 Test Loss: 8.261 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.7464120388031006
Epoch: 10, Steps: 17 | Train Loss: 1.848 Vali Loss: 2.200 Vali Acc: 0.877 Test Loss: 2.200 Test Acc: 0.877
Validation loss decreased (-0.842992 --> -0.877111).  Saving model ...
Epoch: 11 cost time: 3.4350719451904297
Epoch: 11, Steps: 17 | Train Loss: 0.572 Vali Loss: 3.343 Vali Acc: 0.734 Test Loss: 3.343 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4193732738494873
Epoch: 12, Steps: 17 | Train Loss: 0.852 Vali Loss: 3.130 Vali Acc: 0.823 Test Loss: 3.130 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5662312507629395
Epoch: 13, Steps: 17 | Train Loss: 0.919 Vali Loss: 4.416 Vali Acc: 0.706 Test Loss: 4.416 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.952587604522705
Epoch: 14, Steps: 17 | Train Loss: 0.927 Vali Loss: 4.690 Vali Acc: 0.857 Test Loss: 4.690 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9291486740112305
Epoch: 15, Steps: 17 | Train Loss: 0.276 Vali Loss: 2.451 Vali Acc: 0.860 Test Loss: 2.451 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9568631649017334
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 3.032 Vali Acc: 0.863 Test Loss: 3.032 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.6850500106811523
Epoch: 17, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.987 Vali Acc: 0.819 Test Loss: 2.987 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.719144821166992
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 5.079 Vali Acc: 0.761 Test Loss: 5.079 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8866283893585205
Epoch: 19, Steps: 17 | Train Loss: 0.280 Vali Loss: 4.475 Vali Acc: 0.792 Test Loss: 4.475 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9861958026885986
Epoch: 20, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.108 Vali Acc: 0.860 Test Loss: 4.108 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 2511914
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.555671691894531
Epoch: 1, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.146 Vali Acc: 0.741 Test Loss: 1.146 Test Acc: 0.741
Validation loss decreased (inf --> -0.740603).  Saving model ...
Epoch: 2 cost time: 3.6575064659118652
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.489 Vali Acc: 0.846 Test Loss: 0.489 Test Acc: 0.846
Validation loss decreased (-0.740603 --> -0.846411).  Saving model ...
Epoch: 3 cost time: 3.6548473834991455
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.589 Vali Acc: 0.621 Test Loss: 1.589 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.62690806388855
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.177 Vali Acc: 0.867 Test Loss: 1.177 Test Acc: 0.867
Validation loss decreased (-0.846411 --> -0.866882).  Saving model ...
Epoch: 5 cost time: 3.8231618404388428
Epoch: 5, Steps: 17 | Train Loss: 1.765 Vali Loss: 2.222 Vali Acc: 0.696 Test Loss: 2.222 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.782130002975464
Epoch: 6, Steps: 17 | Train Loss: 1.932 Vali Loss: 2.394 Vali Acc: 0.792 Test Loss: 2.394 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8762192726135254
Epoch: 7, Steps: 17 | Train Loss: 0.928 Vali Loss: 3.379 Vali Acc: 0.659 Test Loss: 3.379 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7195019721984863
Epoch: 8, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.558 Vali Acc: 0.836 Test Loss: 1.558 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.61187481880188
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 4.955 Vali Acc: 0.590 Test Loss: 4.955 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.379235029220581
Epoch: 10, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.558 Vali Acc: 0.850 Test Loss: 1.558 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.3239634037017822
Epoch: 11, Steps: 17 | Train Loss: 0.423 Vali Loss: 3.846 Vali Acc: 0.700 Test Loss: 3.846 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8268074989318848
Epoch: 12, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.249 Vali Acc: 0.795 Test Loss: 3.249 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.693108558654785
Epoch: 13, Steps: 17 | Train Loss: 1.547 Vali Loss: 5.346 Vali Acc: 0.696 Test Loss: 5.346 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7093489170074463
Epoch: 14, Steps: 17 | Train Loss: 1.714 Vali Loss: 6.727 Vali Acc: 0.809 Test Loss: 6.727 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 2511914
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.2053632736206055
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.990 Vali Acc: 0.754 Test Loss: 0.990 Test Acc: 0.754
Validation loss decreased (inf --> -0.754256).  Saving model ...
Epoch: 2 cost time: 3.330440044403076
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.392 Vali Acc: 0.894 Test Loss: 0.392 Test Acc: 0.894
Validation loss decreased (-0.754256 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 3.2126643657684326
Epoch: 3, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.507 Vali Acc: 0.594 Test Loss: 2.507 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2339231967926025
Epoch: 4, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.713 Vali Acc: 0.840 Test Loss: 0.713 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9238128662109375
Epoch: 5, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.639 Vali Acc: 0.761 Test Loss: 1.639 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3957359790802
Epoch: 6, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.738 Vali Acc: 0.751 Test Loss: 1.738 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.254826784133911
Epoch: 7, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.119 Vali Acc: 0.788 Test Loss: 1.119 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.28926682472229
Epoch: 8, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.874 Vali Acc: 0.846 Test Loss: 1.874 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2296199798583984
Epoch: 9, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.394 Vali Acc: 0.730 Test Loss: 2.394 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3909027576446533
Epoch: 10, Steps: 17 | Train Loss: 0.426 Vali Loss: 1.490 Vali Acc: 0.887 Test Loss: 1.490 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.482832193374634
Epoch: 11, Steps: 17 | Train Loss: 1.690 Vali Loss: 3.256 Vali Acc: 0.703 Test Loss: 3.256 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5944275856018066
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 3.001 Vali Acc: 0.717 Test Loss: 3.001 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 2511914
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.762776613235474
Epoch: 1, Steps: 17 | Train Loss: 0.615 Vali Loss: 1.073 Vali Acc: 0.768 Test Loss: 1.073 Test Acc: 0.768
Validation loss decreased (inf --> -0.767907).  Saving model ...
Epoch: 2 cost time: 3.247541666030884
Epoch: 2, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.716 Vali Acc: 0.754 Test Loss: 0.716 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3194069862365723
Epoch: 3, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.700 Vali Acc: 0.768 Test Loss: 0.700 Test Acc: 0.768
Validation loss decreased (-0.767907 --> -0.767911).  Saving model ...
Epoch: 4 cost time: 3.063063144683838
Epoch: 4, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.066 Vali Acc: 0.860 Test Loss: 1.066 Test Acc: 0.860
Validation loss decreased (-0.767911 --> -0.860058).  Saving model ...
Epoch: 5 cost time: 2.8775813579559326
Epoch: 5, Steps: 17 | Train Loss: 1.633 Vali Loss: 4.097 Vali Acc: 0.618 Test Loss: 4.097 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9378600120544434
Epoch: 6, Steps: 17 | Train Loss: 1.623 Vali Loss: 3.159 Vali Acc: 0.659 Test Loss: 3.159 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.900819778442383
Epoch: 7, Steps: 17 | Train Loss: 1.008 Vali Loss: 3.176 Vali Acc: 0.584 Test Loss: 3.176 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0343217849731445
Epoch: 8, Steps: 17 | Train Loss: 0.939 Vali Loss: 5.542 Vali Acc: 0.662 Test Loss: 5.542 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0015618801116943
Epoch: 9, Steps: 17 | Train Loss: 1.319 Vali Loss: 0.688 Vali Acc: 0.887 Test Loss: 0.688 Test Acc: 0.887
Validation loss decreased (-0.860058 --> -0.887365).  Saving model ...
Epoch: 10 cost time: 3.0407297611236572
Epoch: 10, Steps: 17 | Train Loss: 0.799 Vali Loss: 1.558 Vali Acc: 0.785 Test Loss: 1.558 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0083460807800293
Epoch: 11, Steps: 17 | Train Loss: 0.347 Vali Loss: 2.082 Vali Acc: 0.846 Test Loss: 2.082 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1816937923431396
Epoch: 12, Steps: 17 | Train Loss: 1.072 Vali Loss: 3.220 Vali Acc: 0.754 Test Loss: 3.220 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.039890766143799
Epoch: 13, Steps: 17 | Train Loss: 1.438 Vali Loss: 2.617 Vali Acc: 0.816 Test Loss: 2.617 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0681216716766357
Epoch: 14, Steps: 17 | Train Loss: 1.042 Vali Loss: 5.148 Vali Acc: 0.771 Test Loss: 5.148 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.796887159347534
Epoch: 15, Steps: 17 | Train Loss: 0.818 Vali Loss: 4.094 Vali Acc: 0.754 Test Loss: 4.094 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.87125301361084
Epoch: 16, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.781 Vali Acc: 0.833 Test Loss: 2.781 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.862905740737915
Epoch: 17, Steps: 17 | Train Loss: 0.146 Vali Loss: 4.896 Vali Acc: 0.768 Test Loss: 4.896 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2279257774353027
Epoch: 18, Steps: 17 | Train Loss: 1.005 Vali Loss: 4.076 Vali Acc: 0.816 Test Loss: 4.076 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.285895347595215
Epoch: 19, Steps: 17 | Train Loss: 0.342 Vali Loss: 5.483 Vali Acc: 0.765 Test Loss: 5.483 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 2511914
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.382399082183838
Epoch: 1, Steps: 17 | Train Loss: 0.565 Vali Loss: 1.032 Vali Acc: 0.751 Test Loss: 1.032 Test Acc: 0.751
Validation loss decreased (inf --> -0.750843).  Saving model ...
Epoch: 2 cost time: 3.7258050441741943
Epoch: 2, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
Validation loss decreased (-0.750843 --> -0.815693).  Saving model ...
Epoch: 3 cost time: 4.03892707824707
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 1.142 Vali Acc: 0.846 Test Loss: 1.142 Test Acc: 0.846
Validation loss decreased (-0.815693 --> -0.846405).  Saving model ...
Epoch: 4 cost time: 4.141325950622559
Epoch: 4, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.225 Vali Acc: 0.778 Test Loss: 1.225 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.90590500831604
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.800 Vali Acc: 0.826 Test Loss: 0.800 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.779803991317749
Epoch: 6, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.513 Vali Acc: 0.778 Test Loss: 2.513 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.672785758972168
Epoch: 7, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.045 Vali Acc: 0.836 Test Loss: 2.045 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.838660955429077
Epoch: 8, Steps: 17 | Train Loss: 0.485 Vali Loss: 4.353 Vali Acc: 0.676 Test Loss: 4.353 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8246612548828125
Epoch: 9, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.850 Vali Acc: 0.765 Test Loss: 2.850 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.901211977005005
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.783 Vali Acc: 0.799 Test Loss: 1.783 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6719119548797607
Epoch: 11, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.488 Vali Acc: 0.904 Test Loss: 1.488 Test Acc: 0.904
Validation loss decreased (-0.846405 --> -0.904422).  Saving model ...
Epoch: 12 cost time: 3.678528070449829
Epoch: 12, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.273 Vali Acc: 0.836 Test Loss: 2.273 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5087890625
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 2.515 Vali Acc: 0.812 Test Loss: 2.515 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6560399532318115
Epoch: 14, Steps: 17 | Train Loss: 0.547 Vali Loss: 4.335 Vali Acc: 0.782 Test Loss: 4.335 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3914008140563965
Epoch: 15, Steps: 17 | Train Loss: 0.436 Vali Loss: 3.437 Vali Acc: 0.805 Test Loss: 3.437 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6441173553466797
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 3.173 Vali Acc: 0.805 Test Loss: 3.173 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.8364837169647217
Epoch: 17, Steps: 17 | Train Loss: 0.470 Vali Loss: 5.412 Vali Acc: 0.758 Test Loss: 5.412 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.032757997512817
Epoch: 18, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.809 Vali Acc: 0.901 Test Loss: 2.809 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7608227729797363
Epoch: 19, Steps: 17 | Train Loss: 0.310 Vali Loss: 6.987 Vali Acc: 0.761 Test Loss: 6.987 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3848814964294434
Epoch: 20, Steps: 17 | Train Loss: 0.321 Vali Loss: 5.875 Vali Acc: 0.788 Test Loss: 5.875 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.568516969680786
Epoch: 21, Steps: 17 | Train Loss: 0.171 Vali Loss: 4.899 Vali Acc: 0.829 Test Loss: 4.899 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 1987626
model size : 17.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.729640007019043
Epoch: 1, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.044 Vali Acc: 0.734 Test Loss: 1.044 Test Acc: 0.734
Validation loss decreased (inf --> -0.733778).  Saving model ...
Epoch: 2 cost time: 3.604168653488159
Epoch: 2, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.657 Vali Acc: 0.819 Test Loss: 0.657 Test Acc: 0.819
Validation loss decreased (-0.733778 --> -0.819106).  Saving model ...
Epoch: 3 cost time: 3.3297157287597656
Epoch: 3, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.836 Vali Acc: 0.816 Test Loss: 0.836 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.399270534515381
Epoch: 4, Steps: 17 | Train Loss: 0.398 Vali Loss: 1.867 Vali Acc: 0.638 Test Loss: 1.867 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.508115768432617
Epoch: 5, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.623 Vali Acc: 0.747 Test Loss: 1.623 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.618149757385254
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 0.944 Vali Acc: 0.853 Test Loss: 0.944 Test Acc: 0.853
Validation loss decreased (-0.819106 --> -0.853233).  Saving model ...
Epoch: 7 cost time: 3.523340940475464
Epoch: 7, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.419 Vali Acc: 0.799 Test Loss: 1.419 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2242088317871094
Epoch: 8, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.108 Vali Acc: 0.829 Test Loss: 2.108 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8937559127807617
Epoch: 9, Steps: 17 | Train Loss: 0.577 Vali Loss: 5.198 Vali Acc: 0.556 Test Loss: 5.198 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.183795690536499
Epoch: 10, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.606 Vali Acc: 0.840 Test Loss: 1.606 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8630435466766357
Epoch: 11, Steps: 17 | Train Loss: 1.027 Vali Loss: 3.694 Vali Acc: 0.785 Test Loss: 3.694 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.565946578979492
Epoch: 12, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.489 Vali Acc: 0.857 Test Loss: 2.489 Test Acc: 0.857
Validation loss decreased (-0.853233 --> -0.856630).  Saving model ...
Epoch: 13 cost time: 3.2611536979675293
Epoch: 13, Steps: 17 | Train Loss: 1.054 Vali Loss: 4.774 Vali Acc: 0.727 Test Loss: 4.774 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2981107234954834
Epoch: 14, Steps: 17 | Train Loss: 0.430 Vali Loss: 2.009 Vali Acc: 0.829 Test Loss: 2.009 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6993653774261475
Epoch: 15, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.621 Vali Acc: 0.867 Test Loss: 2.621 Test Acc: 0.867
Validation loss decreased (-0.856630 --> -0.866868).  Saving model ...
Epoch: 16 cost time: 3.690098285675049
Epoch: 16, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.601 Vali Acc: 0.860 Test Loss: 2.601 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.73713755607605
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.508 Vali Acc: 0.840 Test Loss: 2.508 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4637653827667236
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 4.358 Vali Acc: 0.802 Test Loss: 4.358 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5620923042297363
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.062 Vali Acc: 0.884 Test Loss: 2.062 Test Acc: 0.884
Validation loss decreased (-0.866868 --> -0.883938).  Saving model ...
Epoch: 20 cost time: 3.4753706455230713
Epoch: 20, Steps: 17 | Train Loss: 0.233 Vali Loss: 4.384 Vali Acc: 0.816 Test Loss: 4.384 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.484980344772339
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.198 Vali Acc: 0.904 Test Loss: 2.198 Test Acc: 0.904
Validation loss decreased (-0.883938 --> -0.904415).  Saving model ...
Epoch: 22 cost time: 3.6304681301116943
Epoch: 22, Steps: 17 | Train Loss: 0.158 Vali Loss: 6.596 Vali Acc: 0.761 Test Loss: 6.596 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.660937547683716
Epoch: 23, Steps: 17 | Train Loss: 0.439 Vali Loss: 3.395 Vali Acc: 0.850 Test Loss: 3.395 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5995676517486572
Epoch: 24, Steps: 17 | Train Loss: 0.351 Vali Loss: 3.264 Vali Acc: 0.857 Test Loss: 3.264 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6528725624084473
Epoch: 25, Steps: 17 | Train Loss: 0.090 Vali Loss: 3.019 Vali Acc: 0.867 Test Loss: 3.019 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.71177077293396
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 7.104 Vali Acc: 0.799 Test Loss: 7.104 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.501432180404663
Epoch: 27, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.690 Vali Acc: 0.863 Test Loss: 3.690 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.4819581508636475
Epoch: 28, Steps: 17 | Train Loss: 0.286 Vali Loss: 4.653 Vali Acc: 0.846 Test Loss: 4.653 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.415925979614258
Epoch: 29, Steps: 17 | Train Loss: 0.312 Vali Loss: 8.477 Vali Acc: 0.788 Test Loss: 8.477 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.604846715927124
Epoch: 30, Steps: 17 | Train Loss: 1.964 Vali Loss: 5.850 Vali Acc: 0.840 Test Loss: 5.850 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.652430295944214
Epoch: 31, Steps: 17 | Train Loss: 0.457 Vali Loss: 6.738 Vali Acc: 0.819 Test Loss: 6.738 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 1987626
model size : 17.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.981100082397461
Epoch: 1, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.889 Vali Acc: 0.788 Test Loss: 0.889 Test Acc: 0.788
Validation loss decreased (inf --> -0.788387).  Saving model ...
Epoch: 2 cost time: 3.078747510910034
Epoch: 2, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
Validation loss decreased (-0.788387 --> -0.870302).  Saving model ...
Epoch: 3 cost time: 3.2264018058776855
Epoch: 3, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.917 Vali Acc: 0.843 Test Loss: 0.917 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4951164722442627
Epoch: 4, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.731 Vali Acc: 0.652 Test Loss: 1.731 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.354416608810425
Epoch: 5, Steps: 17 | Train Loss: 0.637 Vali Loss: 1.780 Vali Acc: 0.775 Test Loss: 1.780 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.95172381401062
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.880 Vali Acc: 0.850 Test Loss: 0.880 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.891925096511841
Epoch: 7, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8150079250335693
Epoch: 8, Steps: 17 | Train Loss: 0.813 Vali Loss: 1.924 Vali Acc: 0.792 Test Loss: 1.924 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0563533306121826
Epoch: 9, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.530 Vali Acc: 0.679 Test Loss: 2.530 Test Acc: 0.679
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3289968967437744
Epoch: 10, Steps: 17 | Train Loss: 0.308 Vali Loss: 3.881 Vali Acc: 0.631 Test Loss: 3.881 Test Acc: 0.631
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1270501613616943
Epoch: 11, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.420 Vali Acc: 0.857 Test Loss: 1.420 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1515135765075684
Epoch: 12, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.995 Vali Acc: 0.840 Test Loss: 0.995 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 1987626
model size : 17.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.941072702407837
Epoch: 1, Steps: 17 | Train Loss: 0.587 Vali Loss: 1.022 Vali Acc: 0.741 Test Loss: 1.022 Test Acc: 0.741
Validation loss decreased (inf --> -0.740604).  Saving model ...
Epoch: 2 cost time: 2.7432637214660645
Epoch: 2, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.760 Vali Acc: 0.782 Test Loss: 0.760 Test Acc: 0.782
Validation loss decreased (-0.740604 --> -0.781562).  Saving model ...
Epoch: 3 cost time: 3.0064778327941895
Epoch: 3, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.879 Vali Acc: 0.826 Test Loss: 0.879 Test Acc: 0.826
Validation loss decreased (-0.781562 --> -0.825930).  Saving model ...
Epoch: 4 cost time: 2.9161643981933594
Epoch: 4, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.841 Vali Acc: 0.587 Test Loss: 1.841 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.184732437133789
Epoch: 5, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
Validation loss decreased (-0.825930 --> -0.870302).  Saving model ...
Epoch: 6 cost time: 3.1590356826782227
Epoch: 6, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.828 Vali Acc: 0.860 Test Loss: 0.828 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.087127923965454
Epoch: 7, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.786 Vali Acc: 0.867 Test Loss: 0.786 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9488673210144043
Epoch: 8, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.798 Vali Acc: 0.887 Test Loss: 0.798 Test Acc: 0.887
Validation loss decreased (-0.870302 --> -0.887364).  Saving model ...
Epoch: 9 cost time: 2.92702054977417
Epoch: 9, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.222 Vali Acc: 0.730 Test Loss: 2.222 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1528091430664062
Epoch: 10, Steps: 17 | Train Loss: 0.465 Vali Loss: 2.867 Vali Acc: 0.700 Test Loss: 2.867 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3319754600524902
Epoch: 11, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.950 Vali Acc: 0.863 Test Loss: 0.950 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2658259868621826
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.438 Vali Acc: 0.857 Test Loss: 1.438 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1085264682769775
Epoch: 13, Steps: 17 | Train Loss: 0.292 Vali Loss: 2.663 Vali Acc: 0.734 Test Loss: 2.663 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9782538414001465
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.976 Vali Acc: 0.833 Test Loss: 1.976 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9802722930908203
Epoch: 15, Steps: 17 | Train Loss: 0.335 Vali Loss: 2.528 Vali Acc: 0.795 Test Loss: 2.528 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.963425397872925
Epoch: 16, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.564 Vali Acc: 0.867 Test Loss: 1.564 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.225008487701416
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 4.291 Vali Acc: 0.799 Test Loss: 4.291 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.9977779388427734
Epoch: 18, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.669 Vali Acc: 0.833 Test Loss: 2.669 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1987626
model size : 17.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.029230356216431
Epoch: 1, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.704 Vali Acc: 0.836 Test Loss: 0.704 Test Acc: 0.836
Validation loss decreased (inf --> -0.836170).  Saving model ...
Epoch: 2 cost time: 3.534337043762207
Epoch: 2, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.374 Vali Acc: 0.713 Test Loss: 1.374 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.136758327484131
Epoch: 3, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.387 Vali Acc: 0.816 Test Loss: 1.387 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.926138162612915
Epoch: 4, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
Validation loss decreased (-0.836170 --> -0.863474).  Saving model ...
Epoch: 5 cost time: 3.263528347015381
Epoch: 5, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.656 Vali Acc: 0.761 Test Loss: 1.656 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.66359806060791
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.673 Vali Acc: 0.720 Test Loss: 2.673 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.903841733932495
Epoch: 7, Steps: 17 | Train Loss: 0.624 Vali Loss: 4.236 Vali Acc: 0.659 Test Loss: 4.236 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8239309787750244
Epoch: 8, Steps: 17 | Train Loss: 1.992 Vali Loss: 2.215 Vali Acc: 0.843 Test Loss: 2.215 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9100077152252197
Epoch: 9, Steps: 17 | Train Loss: 0.715 Vali Loss: 5.634 Vali Acc: 0.645 Test Loss: 5.634 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9306271076202393
Epoch: 10, Steps: 17 | Train Loss: 0.548 Vali Loss: 1.497 Vali Acc: 0.881 Test Loss: 1.497 Test Acc: 0.881
Validation loss decreased (-0.863474 --> -0.880531).  Saving model ...
Epoch: 11 cost time: 3.7173399925231934
Epoch: 11, Steps: 17 | Train Loss: 0.260 Vali Loss: 1.951 Vali Acc: 0.785 Test Loss: 1.951 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.951108694076538
Epoch: 12, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.399 Vali Acc: 0.874 Test Loss: 1.399 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9026479721069336
Epoch: 13, Steps: 17 | Train Loss: 0.415 Vali Loss: 3.044 Vali Acc: 0.792 Test Loss: 3.044 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7109949588775635
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.141 Vali Acc: 0.816 Test Loss: 2.141 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8854944705963135
Epoch: 15, Steps: 17 | Train Loss: 1.208 Vali Loss: 4.279 Vali Acc: 0.816 Test Loss: 4.279 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8343489170074463
Epoch: 16, Steps: 17 | Train Loss: 0.697 Vali Loss: 4.356 Vali Acc: 0.765 Test Loss: 4.356 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.080613136291504
Epoch: 17, Steps: 17 | Train Loss: 0.582 Vali Loss: 4.113 Vali Acc: 0.850 Test Loss: 4.113 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9347519874572754
Epoch: 18, Steps: 17 | Train Loss: 0.261 Vali Loss: 4.547 Vali Acc: 0.775 Test Loss: 4.547 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7073724269866943
Epoch: 19, Steps: 17 | Train Loss: 0.421 Vali Loss: 4.016 Vali Acc: 0.785 Test Loss: 4.016 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.370371103286743
Epoch: 20, Steps: 17 | Train Loss: 0.231 Vali Loss: 2.633 Vali Acc: 0.884 Test Loss: 2.633 Test Acc: 0.884
Validation loss decreased (-0.880531 --> -0.883933).  Saving model ...
Epoch: 21 cost time: 3.3407859802246094
Epoch: 21, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.360 Vali Acc: 0.850 Test Loss: 3.360 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8145976066589355
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 4.602 Vali Acc: 0.819 Test Loss: 4.602 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.034364938735962
Epoch: 23, Steps: 17 | Train Loss: 0.461 Vali Loss: 5.448 Vali Acc: 0.799 Test Loss: 5.448 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.479168653488159
Epoch: 24, Steps: 17 | Train Loss: 0.410 Vali Loss: 10.297 Vali Acc: 0.782 Test Loss: 10.297 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3669087886810303
Epoch: 25, Steps: 17 | Train Loss: 0.527 Vali Loss: 6.220 Vali Acc: 0.826 Test Loss: 6.220 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.5936179161071777
Epoch: 26, Steps: 17 | Train Loss: 0.056 Vali Loss: 6.129 Vali Acc: 0.860 Test Loss: 6.129 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.569838285446167
Epoch: 27, Steps: 17 | Train Loss: 0.143 Vali Loss: 4.895 Vali Acc: 0.846 Test Loss: 4.895 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.7395224571228027
Epoch: 28, Steps: 17 | Train Loss: 0.177 Vali Loss: 4.500 Vali Acc: 0.853 Test Loss: 4.500 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.6258654594421387
Epoch: 29, Steps: 17 | Train Loss: 0.082 Vali Loss: 4.175 Vali Acc: 0.877 Test Loss: 4.175 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.603300094604492
Epoch: 30, Steps: 17 | Train Loss: 0.163 Vali Loss: 6.660 Vali Acc: 0.850 Test Loss: 6.660 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 1725482
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.343768358230591
Epoch: 1, Steps: 17 | Train Loss: 0.820 Vali Loss: 0.750 Vali Acc: 0.829 Test Loss: 0.750 Test Acc: 0.829
Validation loss decreased (inf --> -0.829344).  Saving model ...
Epoch: 2 cost time: 3.5043811798095703
Epoch: 2, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.566 Vali Acc: 0.676 Test Loss: 1.566 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6153624057769775
Epoch: 3, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.512 Vali Acc: 0.761 Test Loss: 1.512 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.584533214569092
Epoch: 4, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.606 Vali Acc: 0.877 Test Loss: 0.606 Test Acc: 0.877
Validation loss decreased (-0.829344 --> -0.877127).  Saving model ...
Epoch: 5 cost time: 3.468461275100708
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.891 Vali Acc: 0.853 Test Loss: 0.891 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4102156162261963
Epoch: 6, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.062 Vali Acc: 0.812 Test Loss: 2.062 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5507731437683105
Epoch: 7, Steps: 17 | Train Loss: 0.675 Vali Loss: 3.510 Vali Acc: 0.679 Test Loss: 3.510 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.615804672241211
Epoch: 8, Steps: 17 | Train Loss: 1.581 Vali Loss: 2.240 Vali Acc: 0.843 Test Loss: 2.240 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.7207624912261963
Epoch: 9, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.106 Vali Acc: 0.771 Test Loss: 2.106 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6885030269622803
Epoch: 10, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.667 Vali Acc: 0.881 Test Loss: 1.667 Test Acc: 0.881
Validation loss decreased (-0.877127 --> -0.880529).  Saving model ...
Epoch: 11 cost time: 3.5816879272460938
Epoch: 11, Steps: 17 | Train Loss: 0.472 Vali Loss: 2.656 Vali Acc: 0.768 Test Loss: 2.656 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.534963607788086
Epoch: 12, Steps: 17 | Train Loss: 0.652 Vali Loss: 3.462 Vali Acc: 0.747 Test Loss: 3.462 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.506572723388672
Epoch: 13, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.671 Vali Acc: 0.846 Test Loss: 1.671 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6917901039123535
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 3.381 Vali Acc: 0.829 Test Loss: 3.381 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.795494318008423
Epoch: 15, Steps: 17 | Train Loss: 0.915 Vali Loss: 3.246 Vali Acc: 0.829 Test Loss: 3.246 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.681791305541992
Epoch: 16, Steps: 17 | Train Loss: 0.320 Vali Loss: 2.810 Vali Acc: 0.829 Test Loss: 2.810 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1908552646636963
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 2.161 Vali Acc: 0.857 Test Loss: 2.161 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6167356967926025
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 3.874 Vali Acc: 0.826 Test Loss: 3.874 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7309021949768066
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.052 Vali Acc: 0.785 Test Loss: 4.052 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7981324195861816
Epoch: 20, Steps: 17 | Train Loss: 0.189 Vali Loss: 2.877 Vali Acc: 0.850 Test Loss: 2.877 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 1725482
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.343001127243042
Epoch: 1, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.832 Vali Acc: 0.802 Test Loss: 0.832 Test Acc: 0.802
Validation loss decreased (inf --> -0.802039).  Saving model ...
Epoch: 2 cost time: 3.3826534748077393
Epoch: 2, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.802039 --> -0.870302).  Saving model ...
Epoch: 3 cost time: 3.4105782508850098
Epoch: 3, Steps: 17 | Train Loss: 0.607 Vali Loss: 1.643 Vali Acc: 0.703 Test Loss: 1.643 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1200807094573975
Epoch: 4, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.127 Vali Acc: 0.754 Test Loss: 1.127 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3344361782073975
Epoch: 5, Steps: 17 | Train Loss: 0.548 Vali Loss: 2.396 Vali Acc: 0.662 Test Loss: 2.396 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.40571928024292
Epoch: 6, Steps: 17 | Train Loss: 1.899 Vali Loss: 2.654 Vali Acc: 0.730 Test Loss: 2.654 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.4842278957366943
Epoch: 7, Steps: 17 | Train Loss: 1.079 Vali Loss: 3.053 Vali Acc: 0.642 Test Loss: 3.053 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.117737293243408
Epoch: 8, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.399 Vali Acc: 0.826 Test Loss: 1.399 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.104527473449707
Epoch: 9, Steps: 17 | Train Loss: 0.302 Vali Loss: 2.445 Vali Acc: 0.703 Test Loss: 2.445 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1437079906463623
Epoch: 10, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.569 Vali Acc: 0.771 Test Loss: 1.569 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1380865573883057
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 2.937 Vali Acc: 0.758 Test Loss: 2.937 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.198850393295288
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.113 Vali Acc: 0.887 Test Loss: 1.113 Test Acc: 0.887
Validation loss decreased (-0.870302 --> -0.887361).  Saving model ...
Epoch: 13 cost time: 3.2220895290374756
Epoch: 13, Steps: 17 | Train Loss: 0.267 Vali Loss: 4.988 Vali Acc: 0.669 Test Loss: 4.988 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0674190521240234
Epoch: 14, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.625 Vali Acc: 0.799 Test Loss: 2.625 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9320125579833984
Epoch: 15, Steps: 17 | Train Loss: 1.151 Vali Loss: 4.274 Vali Acc: 0.782 Test Loss: 4.274 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1020126342773438
Epoch: 16, Steps: 17 | Train Loss: 0.805 Vali Loss: 3.794 Vali Acc: 0.795 Test Loss: 3.794 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0287182331085205
Epoch: 17, Steps: 17 | Train Loss: 0.292 Vali Loss: 2.779 Vali Acc: 0.850 Test Loss: 2.779 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7682340145111084
Epoch: 18, Steps: 17 | Train Loss: 0.191 Vali Loss: 4.388 Vali Acc: 0.775 Test Loss: 4.388 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2670609951019287
Epoch: 19, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.376 Vali Acc: 0.836 Test Loss: 2.376 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.163850784301758
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 5.222 Vali Acc: 0.761 Test Loss: 5.222 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1524720191955566
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 3.702 Vali Acc: 0.819 Test Loss: 3.702 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1802256107330322
Epoch: 22, Steps: 17 | Train Loss: 0.187 Vali Loss: 5.132 Vali Acc: 0.802 Test Loss: 5.132 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1725482
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.505763292312622
Epoch: 1, Steps: 17 | Train Loss: 0.780 Vali Loss: 1.024 Vali Acc: 0.765 Test Loss: 1.024 Test Acc: 0.765
Validation loss decreased (inf --> -0.764495).  Saving model ...
Epoch: 2 cost time: 2.9329519271850586
Epoch: 2, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.432 Vali Acc: 0.843 Test Loss: 0.432 Test Acc: 0.843
Validation loss decreased (-0.764495 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 2.7331149578094482
Epoch: 3, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.477 Vali Acc: 0.874 Test Loss: 0.477 Test Acc: 0.874
Validation loss decreased (-0.842999 --> -0.873715).  Saving model ...
Epoch: 4 cost time: 2.759373903274536
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.614 Vali Acc: 0.618 Test Loss: 1.614 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6292192935943604
Epoch: 5, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.796 Vali Acc: 0.863 Test Loss: 0.796 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.766249418258667
Epoch: 6, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.333 Vali Acc: 0.826 Test Loss: 1.333 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6896231174468994
Epoch: 7, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.425 Vali Acc: 0.686 Test Loss: 2.425 Test Acc: 0.686
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.982072591781616
Epoch: 8, Steps: 17 | Train Loss: 0.816 Vali Loss: 2.018 Vali Acc: 0.737 Test Loss: 2.018 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.131925106048584
Epoch: 9, Steps: 17 | Train Loss: 0.917 Vali Loss: 2.479 Vali Acc: 0.765 Test Loss: 2.479 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.038179397583008
Epoch: 10, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.757 Vali Acc: 0.809 Test Loss: 1.757 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8210670948028564
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 1.844 Vali Acc: 0.812 Test Loss: 1.844 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.877046585083008
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.034 Vali Acc: 0.867 Test Loss: 1.034 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.978086471557617
Epoch: 13, Steps: 17 | Train Loss: 0.367 Vali Loss: 4.657 Vali Acc: 0.713 Test Loss: 4.657 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 1725482
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.646642208099365
Epoch: 1, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.418 Vali Acc: 0.727 Test Loss: 1.418 Test Acc: 0.727
Validation loss decreased (inf --> -0.726948).  Saving model ...
Epoch: 2 cost time: 3.31870436668396
Epoch: 2, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.123 Vali Acc: 0.826 Test Loss: 1.123 Test Acc: 0.826
Validation loss decreased (-0.726948 --> -0.825927).  Saving model ...
Epoch: 3 cost time: 3.8042361736297607
Epoch: 3, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.574 Vali Acc: 0.881 Test Loss: 0.574 Test Acc: 0.881
Validation loss decreased (-0.825927 --> -0.880540).  Saving model ...
Epoch: 4 cost time: 3.57887601852417
Epoch: 4, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.812 Vali Acc: 0.765 Test Loss: 1.812 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5712621212005615
Epoch: 5, Steps: 17 | Train Loss: 0.538 Vali Loss: 2.571 Vali Acc: 0.696 Test Loss: 2.571 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7224693298339844
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.829 Vali Acc: 0.713 Test Loss: 1.829 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.753178358078003
Epoch: 7, Steps: 17 | Train Loss: 0.990 Vali Loss: 3.089 Vali Acc: 0.655 Test Loss: 3.089 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.738072633743286
Epoch: 8, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.011 Vali Acc: 0.829 Test Loss: 2.011 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.642552614212036
Epoch: 9, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.364 Vali Acc: 0.843 Test Loss: 1.364 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4789183139801025
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.772 Vali Acc: 0.805 Test Loss: 2.772 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.447909355163574
Epoch: 11, Steps: 17 | Train Loss: 1.283 Vali Loss: 3.555 Vali Acc: 0.706 Test Loss: 3.555 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7084760665893555
Epoch: 12, Steps: 17 | Train Loss: 0.448 Vali Loss: 3.581 Vali Acc: 0.765 Test Loss: 3.581 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8098819255828857
Epoch: 13, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.574 Vali Acc: 0.734 Test Loss: 3.574 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 1594410
model size : 15.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.029294490814209
Epoch: 1, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.425 Vali Acc: 0.730 Test Loss: 1.425 Test Acc: 0.730
Validation loss decreased (inf --> -0.730361).  Saving model ...
Epoch: 2 cost time: 3.126513719558716
Epoch: 2, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.225 Vali Acc: 0.823 Test Loss: 1.225 Test Acc: 0.823
Validation loss decreased (-0.730361 --> -0.822513).  Saving model ...
Epoch: 3 cost time: 3.4707629680633545
Epoch: 3, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.083 Vali Acc: 0.823 Test Loss: 1.083 Test Acc: 0.823
Validation loss decreased (-0.822513 --> -0.822515).  Saving model ...
Epoch: 4 cost time: 3.396636486053467
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 2.979 Vali Acc: 0.631 Test Loss: 2.979 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3875811100006104
Epoch: 5, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.861 Vali Acc: 0.717 Test Loss: 1.861 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.182335615158081
Epoch: 6, Steps: 17 | Train Loss: 0.883 Vali Loss: 2.267 Vali Acc: 0.788 Test Loss: 2.267 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.250580310821533
Epoch: 7, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.289 Vali Acc: 0.812 Test Loss: 1.289 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2746517658233643
Epoch: 8, Steps: 17 | Train Loss: 0.705 Vali Loss: 2.083 Vali Acc: 0.771 Test Loss: 2.083 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2059381008148193
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.252 Vali Acc: 0.823 Test Loss: 1.252 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1908199787139893
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.900 Vali Acc: 0.775 Test Loss: 1.900 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.82159686088562
Epoch: 11, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.586 Vali Acc: 0.799 Test Loss: 1.586 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7366297245025635
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 2.923 Vali Acc: 0.805 Test Loss: 2.923 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.895183563232422
Epoch: 13, Steps: 17 | Train Loss: 0.255 Vali Loss: 2.464 Vali Acc: 0.826 Test Loss: 2.464 Test Acc: 0.826
Validation loss decreased (-0.822515 --> -0.825914).  Saving model ...
Epoch: 14 cost time: 3.4729175567626953
Epoch: 14, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.344 Vali Acc: 0.877 Test Loss: 2.344 Test Acc: 0.877
Validation loss decreased (-0.825914 --> -0.877110).  Saving model ...
Epoch: 15 cost time: 3.511080503463745
Epoch: 15, Steps: 17 | Train Loss: 0.293 Vali Loss: 5.086 Vali Acc: 0.696 Test Loss: 5.086 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.141606330871582
Epoch: 16, Steps: 17 | Train Loss: 0.172 Vali Loss: 2.315 Vali Acc: 0.809 Test Loss: 2.315 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1910057067871094
Epoch: 17, Steps: 17 | Train Loss: 0.122 Vali Loss: 3.257 Vali Acc: 0.840 Test Loss: 3.257 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0967462062835693
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 4.700 Vali Acc: 0.799 Test Loss: 4.700 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.331336259841919
Epoch: 19, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.197 Vali Acc: 0.870 Test Loss: 2.197 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5882954597473145
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 3.819 Vali Acc: 0.792 Test Loss: 3.819 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3869500160217285
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 6.499 Vali Acc: 0.778 Test Loss: 6.499 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1166694164276123
Epoch: 22, Steps: 17 | Train Loss: 1.071 Vali Loss: 5.522 Vali Acc: 0.816 Test Loss: 5.522 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.452643394470215
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 5.047 Vali Acc: 0.788 Test Loss: 5.047 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.749131679534912
Epoch: 24, Steps: 17 | Train Loss: 0.511 Vali Loss: 4.109 Vali Acc: 0.881 Test Loss: 4.109 Test Acc: 0.881
Validation loss decreased (-0.877110 --> -0.880505).  Saving model ...
Epoch: 25 cost time: 3.654285192489624
Epoch: 25, Steps: 17 | Train Loss: 0.321 Vali Loss: 9.265 Vali Acc: 0.775 Test Loss: 9.265 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9919979572296143
Epoch: 26, Steps: 17 | Train Loss: 0.126 Vali Loss: 4.067 Vali Acc: 0.884 Test Loss: 4.067 Test Acc: 0.884
Validation loss decreased (-0.880505 --> -0.883918).  Saving model ...
Epoch: 27 cost time: 2.978213310241699
Epoch: 27, Steps: 17 | Train Loss: 0.245 Vali Loss: 5.736 Vali Acc: 0.819 Test Loss: 5.736 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.898120641708374
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 6.106 Vali Acc: 0.816 Test Loss: 6.106 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.427726984024048
Epoch: 29, Steps: 17 | Train Loss: 0.111 Vali Loss: 4.378 Vali Acc: 0.867 Test Loss: 4.378 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1257247924804688
Epoch: 30, Steps: 17 | Train Loss: 0.085 Vali Loss: 4.290 Vali Acc: 0.843 Test Loss: 4.290 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.3945388793945312
Epoch: 31, Steps: 17 | Train Loss: 0.405 Vali Loss: 3.652 Vali Acc: 0.891 Test Loss: 3.652 Test Acc: 0.891
Validation loss decreased (-0.883918 --> -0.890748).  Saving model ...
Epoch: 32 cost time: 3.3184123039245605
Epoch: 32, Steps: 17 | Train Loss: 0.339 Vali Loss: 5.257 Vali Acc: 0.863 Test Loss: 5.257 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6729390621185303
Epoch: 33, Steps: 17 | Train Loss: 0.179 Vali Loss: 9.027 Vali Acc: 0.816 Test Loss: 9.027 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.552579641342163
Epoch: 34, Steps: 17 | Train Loss: 0.255 Vali Loss: 7.394 Vali Acc: 0.843 Test Loss: 7.394 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.3032753467559814
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 12.227 Vali Acc: 0.768 Test Loss: 12.227 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.456946849822998
Epoch: 36, Steps: 17 | Train Loss: 0.356 Vali Loss: 5.818 Vali Acc: 0.857 Test Loss: 5.818 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.5863893032073975
Epoch: 37, Steps: 17 | Train Loss: 0.172 Vali Loss: 5.815 Vali Acc: 0.860 Test Loss: 5.815 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7016985416412354
Epoch: 38, Steps: 17 | Train Loss: 0.247 Vali Loss: 7.848 Vali Acc: 0.823 Test Loss: 7.848 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.737764358520508
Epoch: 39, Steps: 17 | Train Loss: 0.138 Vali Loss: 6.643 Vali Acc: 0.850 Test Loss: 6.643 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.3430585861206055
Epoch: 40, Steps: 17 | Train Loss: 0.659 Vali Loss: 9.276 Vali Acc: 0.833 Test Loss: 9.276 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.240858554840088
Epoch: 41, Steps: 17 | Train Loss: 0.433 Vali Loss: 8.172 Vali Acc: 0.867 Test Loss: 8.172 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 1594410
model size : 15.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.861063480377197
Epoch: 1, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.402 Vali Acc: 0.706 Test Loss: 1.402 Test Acc: 0.706
Validation loss decreased (inf --> -0.706471).  Saving model ...
Epoch: 2 cost time: 3.016220808029175
Epoch: 2, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.737 Vali Acc: 0.741 Test Loss: 1.737 Test Acc: 0.741
Validation loss decreased (-0.706471 --> -0.740597).  Saving model ...
Epoch: 3 cost time: 2.928952932357788
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 0.884 Vali Acc: 0.836 Test Loss: 0.884 Test Acc: 0.836
Validation loss decreased (-0.740597 --> -0.836169).  Saving model ...
Epoch: 4 cost time: 2.788118600845337
Epoch: 4, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8407323360443115
Epoch: 5, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.034 Vali Acc: 0.775 Test Loss: 1.034 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.895663022994995
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.692 Vali Acc: 0.857 Test Loss: 0.692 Test Acc: 0.857
Validation loss decreased (-0.836169 --> -0.856648).  Saving model ...
Epoch: 7 cost time: 3.2317700386047363
Epoch: 7, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.343 Vali Acc: 0.792 Test Loss: 1.343 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0215985774993896
Epoch: 8, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.502 Vali Acc: 0.761 Test Loss: 2.502 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8007495403289795
Epoch: 9, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.477 Vali Acc: 0.846 Test Loss: 1.477 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.133622169494629
Epoch: 10, Steps: 17 | Train Loss: 1.866 Vali Loss: 4.590 Vali Acc: 0.655 Test Loss: 4.590 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1098086833953857
Epoch: 11, Steps: 17 | Train Loss: 0.852 Vali Loss: 2.154 Vali Acc: 0.768 Test Loss: 2.154 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.069627285003662
Epoch: 12, Steps: 17 | Train Loss: 0.455 Vali Loss: 3.800 Vali Acc: 0.765 Test Loss: 3.800 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.142930746078491
Epoch: 13, Steps: 17 | Train Loss: 0.286 Vali Loss: 2.563 Vali Acc: 0.805 Test Loss: 2.563 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2276761531829834
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 3.504 Vali Acc: 0.768 Test Loss: 3.504 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.248145341873169
Epoch: 15, Steps: 17 | Train Loss: 0.197 Vali Loss: 3.223 Vali Acc: 0.836 Test Loss: 3.223 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1821818351745605
Epoch: 16, Steps: 17 | Train Loss: 0.347 Vali Loss: 8.423 Vali Acc: 0.628 Test Loss: 8.423 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 1594410
model size : 15.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.565875768661499
Epoch: 1, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.181 Vali Acc: 0.724 Test Loss: 1.181 Test Acc: 0.724
Validation loss decreased (inf --> -0.723538).  Saving model ...
Epoch: 2 cost time: 2.9481356143951416
Epoch: 2, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.166 Vali Acc: 0.805 Test Loss: 1.166 Test Acc: 0.805
Validation loss decreased (-0.723538 --> -0.805449).  Saving model ...
Epoch: 3 cost time: 3.0533907413482666
Epoch: 3, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.466 Vali Acc: 0.706 Test Loss: 1.466 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8601906299591064
Epoch: 4, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.024 Vali Acc: 0.741 Test Loss: 1.024 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.751319408416748
Epoch: 5, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.769 Vali Acc: 0.805 Test Loss: 0.769 Test Acc: 0.805
Validation loss decreased (-0.805449 --> -0.805453).  Saving model ...
Epoch: 6 cost time: 2.6415464878082275
Epoch: 6, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.640 Vali Acc: 0.884 Test Loss: 0.640 Test Acc: 0.884
Validation loss decreased (-0.805453 --> -0.883953).  Saving model ...
Epoch: 7 cost time: 2.8246870040893555
Epoch: 7, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.184 Vali Acc: 0.840 Test Loss: 1.184 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7699177265167236
Epoch: 8, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.463 Vali Acc: 0.696 Test Loss: 2.463 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0547356605529785
Epoch: 9, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.065 Vali Acc: 0.771 Test Loss: 1.065 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0158987045288086
Epoch: 10, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.900 Vali Acc: 0.693 Test Loss: 2.900 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.682997465133667
Epoch: 11, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.243 Vali Acc: 0.874 Test Loss: 1.243 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4489259719848633
Epoch: 12, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.328 Vali Acc: 0.867 Test Loss: 1.328 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6160073280334473
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 2.199 Vali Acc: 0.795 Test Loss: 2.199 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.853609323501587
Epoch: 14, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.716 Vali Acc: 0.812 Test Loss: 2.716 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.79103946685791
Epoch: 15, Steps: 17 | Train Loss: 0.459 Vali Loss: 3.662 Vali Acc: 0.768 Test Loss: 3.662 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.010676383972168
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.905 Vali Acc: 0.850 Test Loss: 1.905 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 1594410
model size : 15.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.442134618759155
Epoch: 1, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.960 Vali Acc: 0.758 Test Loss: 0.960 Test Acc: 0.758
Validation loss decreased (inf --> -0.757670).  Saving model ...
Epoch: 2 cost time: 3.6892998218536377
Epoch: 2, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.788 Vali Acc: 0.546 Test Loss: 2.788 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4628453254699707
Epoch: 3, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.787 Vali Acc: 0.840 Test Loss: 1.787 Test Acc: 0.840
Validation loss decreased (-0.757670 --> -0.839573).  Saving model ...
Epoch: 4 cost time: 3.6329708099365234
Epoch: 4, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.747 Vali Acc: 0.860 Test Loss: 0.747 Test Acc: 0.860
Validation loss decreased (-0.839573 --> -0.860061).  Saving model ...
Epoch: 5 cost time: 3.6932480335235596
Epoch: 5, Steps: 17 | Train Loss: 0.655 Vali Loss: 2.129 Vali Acc: 0.754 Test Loss: 2.129 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4340155124664307
Epoch: 6, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.051 Vali Acc: 0.819 Test Loss: 1.051 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6401255130767822
Epoch: 7, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.504 Vali Acc: 0.836 Test Loss: 1.504 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3878448009490967
Epoch: 8, Steps: 17 | Train Loss: 0.669 Vali Loss: 1.313 Vali Acc: 0.812 Test Loss: 1.313 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.355926990509033
Epoch: 9, Steps: 17 | Train Loss: 0.535 Vali Loss: 2.436 Vali Acc: 0.765 Test Loss: 2.436 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.574284791946411
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.414 Vali Acc: 0.884 Test Loss: 1.414 Test Acc: 0.884
Validation loss decreased (-0.860061 --> -0.883945).  Saving model ...
Epoch: 11 cost time: 3.619640350341797
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.721 Vali Acc: 0.809 Test Loss: 1.721 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6770386695861816
Epoch: 12, Steps: 17 | Train Loss: 0.172 Vali Loss: 2.251 Vali Acc: 0.829 Test Loss: 2.251 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3619096279144287
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.333 Vali Acc: 0.778 Test Loss: 2.333 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.34985613822937
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 3.191 Vali Acc: 0.761 Test Loss: 3.191 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.364332675933838
Epoch: 15, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.422 Vali Acc: 0.816 Test Loss: 2.422 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6005048751831055
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.765 Vali Acc: 0.860 Test Loss: 1.765 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.6159510612487793
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 2.256 Vali Acc: 0.850 Test Loss: 2.256 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4247055053710938
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 3.428 Vali Acc: 0.853 Test Loss: 3.428 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2607154846191406
Epoch: 19, Steps: 17 | Train Loss: 0.214 Vali Loss: 2.187 Vali Acc: 0.850 Test Loss: 2.187 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4751720428466797
Epoch: 20, Steps: 17 | Train Loss: 0.783 Vali Loss: 5.897 Vali Acc: 0.741 Test Loss: 5.897 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 1528874
model size : 15.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.05720067024231
Epoch: 1, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.872 Vali Acc: 0.768 Test Loss: 0.872 Test Acc: 0.768
Validation loss decreased (inf --> -0.767909).  Saving model ...
Epoch: 2 cost time: 3.1175739765167236
Epoch: 2, Steps: 17 | Train Loss: 0.774 Vali Loss: 3.599 Vali Acc: 0.529 Test Loss: 3.599 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.001329183578491
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.124 Vali Acc: 0.788 Test Loss: 1.124 Test Acc: 0.788
Validation loss decreased (-0.767909 --> -0.788385).  Saving model ...
Epoch: 4 cost time: 3.233962059020996
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.907 Vali Acc: 0.788 Test Loss: 0.907 Test Acc: 0.788
Validation loss decreased (-0.788385 --> -0.788387).  Saving model ...
Epoch: 5 cost time: 3.28944993019104
Epoch: 5, Steps: 17 | Train Loss: 0.684 Vali Loss: 2.143 Vali Acc: 0.720 Test Loss: 2.143 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1303954124450684
Epoch: 6, Steps: 17 | Train Loss: 0.472 Vali Loss: 3.152 Vali Acc: 0.648 Test Loss: 3.152 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.341823101043701
Epoch: 7, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.443 Vali Acc: 0.792 Test Loss: 1.443 Test Acc: 0.792
Validation loss decreased (-0.788387 --> -0.791794).  Saving model ...
Epoch: 8 cost time: 3.4210963249206543
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.317 Vali Acc: 0.778 Test Loss: 1.317 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3697094917297363
Epoch: 9, Steps: 17 | Train Loss: 0.382 Vali Loss: 2.302 Vali Acc: 0.802 Test Loss: 2.302 Test Acc: 0.802
Validation loss decreased (-0.791794 --> -0.802025).  Saving model ...
Epoch: 10 cost time: 3.458984375
Epoch: 10, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.387 Vali Acc: 0.887 Test Loss: 1.387 Test Acc: 0.887
Validation loss decreased (-0.802025 --> -0.887358).  Saving model ...
Epoch: 11 cost time: 3.22196364402771
Epoch: 11, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.926 Vali Acc: 0.805 Test Loss: 1.926 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.190284490585327
Epoch: 12, Steps: 17 | Train Loss: 0.237 Vali Loss: 2.364 Vali Acc: 0.850 Test Loss: 2.364 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5514609813690186
Epoch: 13, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.409 Vali Acc: 0.826 Test Loss: 1.409 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5357306003570557
Epoch: 14, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.513 Vali Acc: 0.809 Test Loss: 3.513 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5795059204101562
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.865 Vali Acc: 0.850 Test Loss: 1.865 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3421919345855713
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.784 Vali Acc: 0.863 Test Loss: 1.784 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.341761350631714
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.303 Vali Acc: 0.823 Test Loss: 2.303 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3315720558166504
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 4.883 Vali Acc: 0.805 Test Loss: 4.883 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.434021234512329
Epoch: 19, Steps: 17 | Train Loss: 0.431 Vali Loss: 3.495 Vali Acc: 0.846 Test Loss: 3.495 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.439821243286133
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.272 Vali Acc: 0.857 Test Loss: 2.272 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1528874
model size : 15.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.687907457351685
Epoch: 1, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
Validation loss decreased (inf --> -0.819105).  Saving model ...
Epoch: 2 cost time: 3.1064581871032715
Epoch: 2, Steps: 17 | Train Loss: 0.740 Vali Loss: 3.054 Vali Acc: 0.536 Test Loss: 3.054 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9447243213653564
Epoch: 3, Steps: 17 | Train Loss: 1.995 Vali Loss: 1.681 Vali Acc: 0.812 Test Loss: 1.681 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.195918560028076
Epoch: 4, Steps: 17 | Train Loss: 0.999 Vali Loss: 0.586 Vali Acc: 0.874 Test Loss: 0.586 Test Acc: 0.874
Validation loss decreased (-0.819105 --> -0.873714).  Saving model ...
Epoch: 5 cost time: 3.1793692111968994
Epoch: 5, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.886 Vali Acc: 0.758 Test Loss: 1.886 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7698822021484375
Epoch: 6, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.723 Vali Acc: 0.857 Test Loss: 0.723 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8620500564575195
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 3.675 Vali Acc: 0.621 Test Loss: 3.675 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.938962936401367
Epoch: 8, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.913 Vali Acc: 0.904 Test Loss: 0.913 Test Acc: 0.904
Validation loss decreased (-0.873714 --> -0.904428).  Saving model ...
Epoch: 9 cost time: 3.3281729221343994
Epoch: 9, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.689 Vali Acc: 0.846 Test Loss: 1.689 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.096447229385376
Epoch: 10, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.775 Vali Acc: 0.843 Test Loss: 1.775 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.226414442062378
Epoch: 11, Steps: 17 | Train Loss: 0.352 Vali Loss: 1.791 Vali Acc: 0.853 Test Loss: 1.791 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6383488178253174
Epoch: 12, Steps: 17 | Train Loss: 0.485 Vali Loss: 1.390 Vali Acc: 0.887 Test Loss: 1.390 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8226051330566406
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.430 Vali Acc: 0.710 Test Loss: 3.430 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.008133888244629
Epoch: 14, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.698 Vali Acc: 0.843 Test Loss: 1.698 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0608022212982178
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.561 Vali Acc: 0.870 Test Loss: 1.561 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.03403902053833
Epoch: 16, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.529 Vali Acc: 0.840 Test Loss: 1.529 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.216233730316162
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 3.763 Vali Acc: 0.741 Test Loss: 3.763 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1881918907165527
Epoch: 18, Steps: 17 | Train Loss: 0.256 Vali Loss: 3.079 Vali Acc: 0.812 Test Loss: 3.079 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 1528874
model size : 15.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.763599872589111
Epoch: 1, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.833 Vali Acc: 0.802 Test Loss: 0.833 Test Acc: 0.802
Validation loss decreased (inf --> -0.802039).  Saving model ...
Epoch: 2 cost time: 2.783669948577881
Epoch: 2, Steps: 17 | Train Loss: 0.673 Vali Loss: 1.615 Vali Acc: 0.608 Test Loss: 1.615 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6961746215820312
Epoch: 3, Steps: 17 | Train Loss: 1.016 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
Validation loss decreased (-0.802039 --> -0.819105).  Saving model ...
Epoch: 4 cost time: 2.4833405017852783
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.436699151992798
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 2.149 Vali Acc: 0.679 Test Loss: 2.149 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.483924388885498
Epoch: 6, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
Validation loss decreased (-0.819105 --> -0.877128).  Saving model ...
Epoch: 7 cost time: 2.8838586807250977
Epoch: 7, Steps: 17 | Train Loss: 0.970 Vali Loss: 4.233 Vali Acc: 0.628 Test Loss: 4.233 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.871087074279785
Epoch: 8, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.550 Vali Acc: 0.730 Test Loss: 1.550 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7057948112487793
Epoch: 9, Steps: 17 | Train Loss: 0.659 Vali Loss: 3.914 Vali Acc: 0.666 Test Loss: 3.914 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.67201828956604
Epoch: 10, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.030 Vali Acc: 0.887 Test Loss: 1.030 Test Acc: 0.887
Validation loss decreased (-0.877128 --> -0.887362).  Saving model ...
Epoch: 11 cost time: 2.567504644393921
Epoch: 11, Steps: 17 | Train Loss: 0.377 Vali Loss: 3.166 Vali Acc: 0.693 Test Loss: 3.166 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.661332607269287
Epoch: 12, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.093 Vali Acc: 0.867 Test Loss: 1.093 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9988675117492676
Epoch: 13, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.496 Vali Acc: 0.805 Test Loss: 2.496 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0371761322021484
Epoch: 14, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.195 Vali Acc: 0.860 Test Loss: 2.195 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9266550540924072
Epoch: 15, Steps: 17 | Train Loss: 0.809 Vali Loss: 5.706 Vali Acc: 0.771 Test Loss: 5.706 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.855107307434082
Epoch: 16, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.070 Vali Acc: 0.877 Test Loss: 2.070 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9488539695739746
Epoch: 17, Steps: 17 | Train Loss: 0.327 Vali Loss: 4.633 Vali Acc: 0.761 Test Loss: 4.633 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.056326389312744
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.449 Vali Acc: 0.860 Test Loss: 2.449 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.01271915435791
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.840 Vali Acc: 0.840 Test Loss: 2.840 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1292290687561035
Epoch: 20, Steps: 17 | Train Loss: 0.485 Vali Loss: 4.370 Vali Acc: 0.812 Test Loss: 4.370 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1528874
model size : 15.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.306736469268799
Epoch: 1, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.545 Vali Acc: 0.846 Test Loss: 0.545 Test Acc: 0.846
Validation loss decreased (inf --> -0.846411).  Saving model ...
Epoch: 2 cost time: 2.462900400161743
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.715 Vali Acc: 0.625 Test Loss: 1.715 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4881114959716797
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.597 Vali Acc: 0.836 Test Loss: 0.597 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.405823230743408
Epoch: 4, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.441 Vali Acc: 0.846 Test Loss: 0.441 Test Acc: 0.846
Validation loss decreased (-0.846411 --> -0.846412).  Saving model ...
Epoch: 5 cost time: 2.4122252464294434
Epoch: 5, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.846412 --> -0.866888).  Saving model ...
Epoch: 6 cost time: 2.6565206050872803
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.503 Vali Acc: 0.590 Test Loss: 2.503 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6152184009552
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.300 Vali Acc: 0.833 Test Loss: 1.300 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5985209941864014
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.828 Vali Acc: 0.843 Test Loss: 0.828 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.594531536102295
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.357 Vali Acc: 0.737 Test Loss: 2.357 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4595212936401367
Epoch: 10, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.110 Vali Acc: 0.775 Test Loss: 1.110 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3437373638153076
Epoch: 11, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.627 Vali Acc: 0.717 Test Loss: 1.627 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.417837381362915
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 2.251 Vali Acc: 0.696 Test Loss: 2.251 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.577378511428833
Epoch: 13, Steps: 17 | Train Loss: 0.462 Vali Loss: 1.042 Vali Acc: 0.843 Test Loss: 1.042 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4380810260772705
Epoch: 14, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.624 Vali Acc: 0.874 Test Loss: 0.624 Test Acc: 0.874
Validation loss decreased (-0.866888 --> -0.873714).  Saving model ...
Epoch: 15 cost time: 2.4709205627441406
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.232 Vali Acc: 0.833 Test Loss: 1.232 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4233810901641846
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.161 Vali Acc: 0.853 Test Loss: 1.161 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.310121536254883
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.506 Vali Acc: 0.829 Test Loss: 1.506 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2336108684539795
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.140 Vali Acc: 0.850 Test Loss: 1.140 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5991146564483643
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.523 Vali Acc: 0.829 Test Loss: 1.523 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6065962314605713
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.555 Vali Acc: 0.795 Test Loss: 2.555 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.521589994430542
Epoch: 21, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.513 Vali Acc: 0.826 Test Loss: 1.513 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4814696311950684
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.591 Vali Acc: 0.819 Test Loss: 1.591 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.384507656097412
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.216 Vali Acc: 0.792 Test Loss: 2.216 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3468120098114014
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.156 Vali Acc: 0.809 Test Loss: 2.156 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 1649194
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.304366588592529
Epoch: 1, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.573 Vali Acc: 0.836 Test Loss: 0.573 Test Acc: 0.836
Validation loss decreased (inf --> -0.836172).  Saving model ...
Epoch: 2 cost time: 2.108083963394165
Epoch: 2, Steps: 17 | Train Loss: 0.618 Vali Loss: 1.603 Vali Acc: 0.638 Test Loss: 1.603 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.272644281387329
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.591 Vali Acc: 0.843 Test Loss: 0.591 Test Acc: 0.843
Validation loss decreased (-0.836172 --> -0.842998).  Saving model ...
Epoch: 4 cost time: 2.2508740425109863
Epoch: 4, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3811774253845215
Epoch: 5, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.724 Vali Acc: 0.655 Test Loss: 1.724 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2097904682159424
Epoch: 6, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.072 Vali Acc: 0.805 Test Loss: 1.072 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3811886310577393
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.754 Vali Acc: 0.782 Test Loss: 0.754 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2932844161987305
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.317 Vali Acc: 0.816 Test Loss: 1.317 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.301679849624634
Epoch: 9, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.853 Vali Acc: 0.799 Test Loss: 0.853 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1466829776763916
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.140 Vali Acc: 0.775 Test Loss: 1.140 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3140342235565186
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.368 Vali Acc: 0.809 Test Loss: 1.368 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.292374610900879
Epoch: 12, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.388 Vali Acc: 0.683 Test Loss: 2.388 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3188235759735107
Epoch: 13, Steps: 17 | Train Loss: 0.300 Vali Loss: 1.271 Vali Acc: 0.782 Test Loss: 1.271 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 1649194
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.870272636413574
Epoch: 1, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
Validation loss decreased (inf --> -0.825933).  Saving model ...
Epoch: 2 cost time: 2.143106698989868
Epoch: 2, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.815 Vali Acc: 0.625 Test Loss: 1.815 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1981561183929443
Epoch: 3, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.096 Vali Acc: 0.724 Test Loss: 1.096 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.054443836212158
Epoch: 4, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.686 Vali Acc: 0.826 Test Loss: 0.686 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0982749462127686
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 1.285 Vali Acc: 0.642 Test Loss: 1.285 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.208763360977173
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.531 Vali Acc: 0.621 Test Loss: 1.531 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2533202171325684
Epoch: 7, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.914 Vali Acc: 0.741 Test Loss: 0.914 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2831833362579346
Epoch: 8, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.772 Vali Acc: 0.689 Test Loss: 1.772 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9368414878845215
Epoch: 9, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.249 Vali Acc: 0.771 Test Loss: 1.249 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2146475315093994
Epoch: 10, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.420 Vali Acc: 0.713 Test Loss: 2.420 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.096615791320801
Epoch: 11, Steps: 17 | Train Loss: 1.040 Vali Loss: 2.709 Vali Acc: 0.696 Test Loss: 2.709 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 1649194
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.1267712116241455
Epoch: 1, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
Validation loss decreased (inf --> -0.815694).  Saving model ...
Epoch: 2 cost time: 2.2506792545318604
Epoch: 2, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.602 Vali Acc: 0.662 Test Loss: 1.602 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.000685453414917
Epoch: 3, Steps: 17 | Train Loss: 0.833 Vali Loss: 0.514 Vali Acc: 0.857 Test Loss: 0.514 Test Acc: 0.857
Validation loss decreased (-0.815694 --> -0.856650).  Saving model ...
Epoch: 4 cost time: 1.9684691429138184
Epoch: 4, Steps: 17 | Train Loss: 0.757 Vali Loss: 1.364 Vali Acc: 0.676 Test Loss: 1.364 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9246540069580078
Epoch: 5, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.078 Vali Acc: 0.652 Test Loss: 2.078 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8955605030059814
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.128 Vali Acc: 0.679 Test Loss: 1.128 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8745460510253906
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.964 Vali Acc: 0.816 Test Loss: 0.964 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0179355144500732
Epoch: 8, Steps: 17 | Train Loss: 0.409 Vali Loss: 1.519 Vali Acc: 0.618 Test Loss: 1.519 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1385724544525146
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.820 Vali Acc: 0.829 Test Loss: 0.820 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.11798095703125
Epoch: 10, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.612 Vali Acc: 0.536 Test Loss: 2.612 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.091876268386841
Epoch: 11, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.746 Vali Acc: 0.751 Test Loss: 1.746 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9875726699829102
Epoch: 12, Steps: 17 | Train Loss: 0.576 Vali Loss: 3.035 Vali Acc: 0.614 Test Loss: 3.035 Test Acc: 0.614
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.947106122970581
Epoch: 13, Steps: 17 | Train Loss: 0.428 Vali Loss: 1.388 Vali Acc: 0.768 Test Loss: 1.388 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 1649194
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.23097562789917
Epoch: 1, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.481 Vali Acc: 0.840 Test Loss: 0.481 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 2.2705605030059814
Epoch: 2, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3515586853027344
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 1.214 Vali Acc: 0.747 Test Loss: 1.214 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.193056583404541
Epoch: 4, Steps: 17 | Train Loss: 1.041 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2023534774780273
Epoch: 5, Steps: 17 | Train Loss: 0.389 Vali Loss: 1.465 Vali Acc: 0.611 Test Loss: 1.465 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0664563179016113
Epoch: 6, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.757 Vali Acc: 0.887 Test Loss: 0.757 Test Acc: 0.887
Validation loss decreased (-0.839586 --> -0.887364).  Saving model ...
Epoch: 7 cost time: 1.9903204441070557
Epoch: 7, Steps: 17 | Train Loss: 0.432 Vali Loss: 1.044 Vali Acc: 0.867 Test Loss: 1.044 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9952764511108398
Epoch: 8, Steps: 17 | Train Loss: 0.389 Vali Loss: 2.705 Vali Acc: 0.631 Test Loss: 2.705 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1277079582214355
Epoch: 9, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.823 Vali Acc: 0.724 Test Loss: 1.823 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.190062999725342
Epoch: 10, Steps: 17 | Train Loss: 0.309 Vali Loss: 2.270 Vali Acc: 0.700 Test Loss: 2.270 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.347280263900757
Epoch: 11, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.878 Vali Acc: 0.846 Test Loss: 0.878 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.395780086517334
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.136 Vali Acc: 0.809 Test Loss: 1.136 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2522168159484863
Epoch: 13, Steps: 17 | Train Loss: 0.316 Vali Loss: 2.364 Vali Acc: 0.792 Test Loss: 2.364 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4382917881011963
Epoch: 14, Steps: 17 | Train Loss: 0.316 Vali Loss: 3.072 Vali Acc: 0.686 Test Loss: 3.072 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5312328338623047
Epoch: 15, Steps: 17 | Train Loss: 0.627 Vali Loss: 1.626 Vali Acc: 0.860 Test Loss: 1.626 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.596599817276001
Epoch: 16, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.905 Vali Acc: 0.737 Test Loss: 2.905 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 1124906
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9342024326324463
Epoch: 1, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 2.15838623046875
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.688 Vali Acc: 0.812 Test Loss: 0.688 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.262986421585083
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.863 Vali Acc: 0.754 Test Loss: 0.863 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.337141275405884
Epoch: 4, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.737 Vali Acc: 0.785 Test Loss: 0.737 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4451708793640137
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2994117736816406
Epoch: 6, Steps: 17 | Train Loss: 0.667 Vali Loss: 1.170 Vali Acc: 0.717 Test Loss: 1.170 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.327967643737793
Epoch: 7, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.364 Vali Acc: 0.717 Test Loss: 1.364 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2299110889434814
Epoch: 8, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.566 Vali Acc: 0.693 Test Loss: 1.566 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.235921859741211
Epoch: 9, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.857 Vali Acc: 0.894 Test Loss: 0.857 Test Acc: 0.894
Validation loss decreased (-0.819108 --> -0.894189).  Saving model ...
Epoch: 10 cost time: 2.3989880084991455
Epoch: 10, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.684 Vali Acc: 0.874 Test Loss: 0.684 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.391594648361206
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.686 Vali Acc: 0.853 Test Loss: 0.686 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3526694774627686
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.901 Vali Acc: 0.860 Test Loss: 0.901 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.430668354034424
Epoch: 13, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.475 Vali Acc: 0.765 Test Loss: 1.475 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1662516593933105
Epoch: 14, Steps: 17 | Train Loss: 0.458 Vali Loss: 2.187 Vali Acc: 0.730 Test Loss: 2.187 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1772048473358154
Epoch: 15, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.415 Vali Acc: 0.860 Test Loss: 1.415 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2131855487823486
Epoch: 16, Steps: 17 | Train Loss: 0.593 Vali Loss: 2.856 Vali Acc: 0.761 Test Loss: 2.856 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0287022590637207
Epoch: 17, Steps: 17 | Train Loss: 0.467 Vali Loss: 3.593 Vali Acc: 0.771 Test Loss: 3.593 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.417897939682007
Epoch: 18, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.265 Vali Acc: 0.853 Test Loss: 1.265 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.384535551071167
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.256 Vali Acc: 0.782 Test Loss: 2.256 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 1124906
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9397501945495605
Epoch: 1, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.559 Vali Acc: 0.792 Test Loss: 0.559 Test Acc: 0.792
Validation loss decreased (inf --> -0.791803).  Saving model ...
Epoch: 2 cost time: 1.9713847637176514
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.791803 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 2.067844867706299
Epoch: 3, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.487 Vali Acc: 0.836 Test Loss: 0.487 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 4 cost time: 1.9464898109436035
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.009733200073242
Epoch: 5, Steps: 17 | Train Loss: 0.313 Vali Loss: 1.346 Vali Acc: 0.614 Test Loss: 1.346 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0259408950805664
Epoch: 6, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.572 Vali Acc: 0.857 Test Loss: 0.572 Test Acc: 0.857
Validation loss decreased (-0.836173 --> -0.856650).  Saving model ...
Epoch: 7 cost time: 2.1703882217407227
Epoch: 7, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.286 Vali Acc: 0.754 Test Loss: 1.286 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0029337406158447
Epoch: 8, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.209 Vali Acc: 0.823 Test Loss: 1.209 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.118131399154663
Epoch: 9, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.952 Vali Acc: 0.860 Test Loss: 0.952 Test Acc: 0.860
Validation loss decreased (-0.856650 --> -0.860059).  Saving model ...
Epoch: 10 cost time: 1.9736781120300293
Epoch: 10, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.061772108078003
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.842 Vali Acc: 0.846 Test Loss: 0.842 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9916801452636719
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.645 Vali Acc: 0.863 Test Loss: 0.645 Test Acc: 0.863
Validation loss decreased (-0.860059 --> -0.863475).  Saving model ...
Epoch: 13 cost time: 1.9930474758148193
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.065 Vali Acc: 0.850 Test Loss: 1.065 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2140862941741943
Epoch: 14, Steps: 17 | Train Loss: 0.327 Vali Loss: 3.873 Vali Acc: 0.655 Test Loss: 3.873 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1394379138946533
Epoch: 15, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.889 Vali Acc: 0.884 Test Loss: 0.889 Test Acc: 0.884
Validation loss decreased (-0.863475 --> -0.883950).  Saving model ...
Epoch: 16 cost time: 2.1863880157470703
Epoch: 16, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.485 Vali Acc: 0.819 Test Loss: 1.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8992493152618408
Epoch: 17, Steps: 17 | Train Loss: 0.363 Vali Loss: 3.153 Vali Acc: 0.679 Test Loss: 3.153 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.010591745376587
Epoch: 18, Steps: 17 | Train Loss: 0.169 Vali Loss: 1.341 Vali Acc: 0.846 Test Loss: 1.341 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8890173435211182
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.806 Vali Acc: 0.823 Test Loss: 1.806 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9815402030944824
Epoch: 20, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.125 Vali Acc: 0.785 Test Loss: 2.125 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0136260986328125
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.631 Vali Acc: 0.823 Test Loss: 1.631 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.038881540298462
Epoch: 22, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.634 Vali Acc: 0.816 Test Loss: 1.634 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0348446369171143
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.711 Vali Acc: 0.836 Test Loss: 1.711 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7809264659881592
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.197 Vali Acc: 0.840 Test Loss: 2.197 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.942173957824707
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.055 Vali Acc: 0.843 Test Loss: 2.055 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 1124906
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.824748992919922
Epoch: 1, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.545 Vali Acc: 0.788 Test Loss: 0.545 Test Acc: 0.788
Validation loss decreased (inf --> -0.788390).  Saving model ...
Epoch: 2 cost time: 1.8196334838867188
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.523 Vali Acc: 0.823 Test Loss: 0.523 Test Acc: 0.823
Validation loss decreased (-0.788390 --> -0.822520).  Saving model ...
Epoch: 3 cost time: 1.745443344116211
Epoch: 3, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.822520 --> -0.849826).  Saving model ...
Epoch: 4 cost time: 1.712230920791626
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.825857162475586
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 2.366 Vali Acc: 0.567 Test Loss: 2.366 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7185695171356201
Epoch: 6, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.505 Vali Acc: 0.857 Test Loss: 0.505 Test Acc: 0.857
Validation loss decreased (-0.849826 --> -0.856650).  Saving model ...
Epoch: 7 cost time: 1.720536231994629
Epoch: 7, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.598 Vali Acc: 0.843 Test Loss: 0.598 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0367283821105957
Epoch: 8, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0979325771331787
Epoch: 9, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9583392143249512
Epoch: 10, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.784 Vali Acc: 0.819 Test Loss: 0.784 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9441907405853271
Epoch: 11, Steps: 17 | Train Loss: 0.343 Vali Loss: 1.287 Vali Acc: 0.785 Test Loss: 1.287 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.947744369506836
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.618 Vali Acc: 0.840 Test Loss: 0.618 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9359707832336426
Epoch: 13, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.531 Vali Acc: 0.775 Test Loss: 1.531 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9614520072937012
Epoch: 14, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.997 Vali Acc: 0.836 Test Loss: 0.997 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.093886137008667
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.909 Vali Acc: 0.758 Test Loss: 1.909 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.153347969055176
Epoch: 16, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.550 Vali Acc: 0.829 Test Loss: 1.550 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 1124906
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.269852876663208
Epoch: 1, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.577 Vali Acc: 0.843 Test Loss: 0.577 Test Acc: 0.843
Validation loss decreased (inf --> -0.842998).  Saving model ...
Epoch: 2 cost time: 2.263982057571411
Epoch: 2, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3668620586395264
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 1.082 Vali Acc: 0.676 Test Loss: 1.082 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.365917682647705
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.427 Vali Acc: 0.689 Test Loss: 1.427 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.36318302154541
Epoch: 5, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.940 Vali Acc: 0.727 Test Loss: 0.940 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1655941009521484
Epoch: 6, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.878 Vali Acc: 0.771 Test Loss: 0.878 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3937811851501465
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.713 Vali Acc: 0.819 Test Loss: 0.713 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.302063465118408
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.803 Vali Acc: 0.809 Test Loss: 0.803 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4625661373138428
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.120 Vali Acc: 0.850 Test Loss: 1.120 Test Acc: 0.850
Validation loss decreased (-0.842998 --> -0.849818).  Saving model ...
Epoch: 10 cost time: 2.303598165512085
Epoch: 10, Steps: 17 | Train Loss: 0.384 Vali Loss: 1.045 Vali Acc: 0.778 Test Loss: 1.045 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.346498489379883
Epoch: 11, Steps: 17 | Train Loss: 0.285 Vali Loss: 1.501 Vali Acc: 0.840 Test Loss: 1.501 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.12143874168396
Epoch: 12, Steps: 17 | Train Loss: 0.262 Vali Loss: 2.284 Vali Acc: 0.747 Test Loss: 2.284 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2399890422821045
Epoch: 13, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.074 Vali Acc: 0.829 Test Loss: 1.074 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.146967649459839
Epoch: 14, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.506 Vali Acc: 0.775 Test Loss: 2.506 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.240269422531128
Epoch: 15, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.324 Vali Acc: 0.867 Test Loss: 1.324 Test Acc: 0.867
Validation loss decreased (-0.849818 --> -0.866881).  Saving model ...
Epoch: 16 cost time: 2.4016025066375732
Epoch: 16, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.098 Vali Acc: 0.867 Test Loss: 1.098 Test Acc: 0.867
Validation loss decreased (-0.866881 --> -0.866883).  Saving model ...
Epoch: 17 cost time: 2.370086669921875
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.180 Vali Acc: 0.850 Test Loss: 1.180 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.418839454650879
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.805 Vali Acc: 0.802 Test Loss: 1.805 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1629652976989746
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.392 Vali Acc: 0.840 Test Loss: 1.392 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0888772010803223
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.355 Vali Acc: 0.843 Test Loss: 1.355 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0463950634002686
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.978 Vali Acc: 0.805 Test Loss: 1.978 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2175841331481934
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.476 Vali Acc: 0.843 Test Loss: 1.476 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3195648193359375
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.795 Test Loss: 1.979 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4673659801483154
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.262 Vali Acc: 0.863 Test Loss: 1.262 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.469573974609375
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.873 Vali Acc: 0.829 Test Loss: 1.873 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3434972763061523
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.438 Vali Acc: 0.853 Test Loss: 1.438 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 862762
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.084380865097046
Epoch: 1, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.596 Vali Acc: 0.843 Test Loss: 0.596 Test Acc: 0.843
Validation loss decreased (inf --> -0.842997).  Saving model ...
Epoch: 2 cost time: 2.2418477535247803
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.186464548110962
Epoch: 3, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.541 Vali Acc: 0.805 Test Loss: 0.541 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.264190912246704
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.533 Vali Acc: 0.652 Test Loss: 1.533 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2218081951141357
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.014 Vali Acc: 0.758 Test Loss: 1.014 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2775843143463135
Epoch: 6, Steps: 17 | Train Loss: 0.472 Vali Loss: 1.496 Vali Acc: 0.700 Test Loss: 1.496 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.17433500289917
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.880 Vali Acc: 0.840 Test Loss: 0.880 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2094836235046387
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.651 Vali Acc: 0.857 Test Loss: 0.651 Test Acc: 0.857
Validation loss decreased (-0.842997 --> -0.856649).  Saving model ...
Epoch: 9 cost time: 2.266486644744873
Epoch: 9, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.785 Vali Acc: 0.846 Test Loss: 0.785 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2251996994018555
Epoch: 10, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.613 Vali Acc: 0.870 Test Loss: 0.613 Test Acc: 0.870
Validation loss decreased (-0.856649 --> -0.870301).  Saving model ...
Epoch: 11 cost time: 1.8445007801055908
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.349 Vali Acc: 0.788 Test Loss: 1.349 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1203248500823975
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 2.557 Vali Acc: 0.703 Test Loss: 2.557 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3046023845672607
Epoch: 13, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.924 Vali Acc: 0.758 Test Loss: 1.924 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4243037700653076
Epoch: 14, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.723 Vali Acc: 0.846 Test Loss: 0.723 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3903045654296875
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.870 Vali Acc: 0.840 Test Loss: 0.870 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.149897813796997
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.535 Vali Acc: 0.771 Test Loss: 1.535 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0673093795776367
Epoch: 17, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.170 Vali Acc: 0.877 Test Loss: 1.170 Test Acc: 0.877
Validation loss decreased (-0.870301 --> -0.877121).  Saving model ...
Epoch: 18 cost time: 1.926422119140625
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.546 Vali Acc: 0.823 Test Loss: 1.546 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1280486583709717
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.911 Vali Acc: 0.823 Test Loss: 1.911 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2501065731048584
Epoch: 20, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.788 Vali Acc: 0.747 Test Loss: 2.788 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4733731746673584
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.820 Vali Acc: 0.816 Test Loss: 1.820 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.441345691680908
Epoch: 22, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.009 Vali Acc: 0.812 Test Loss: 2.009 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.455951452255249
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.898 Vali Acc: 0.863 Test Loss: 1.898 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2015602588653564
Epoch: 24, Steps: 17 | Train Loss: 0.441 Vali Loss: 4.247 Vali Acc: 0.765 Test Loss: 4.247 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.370291233062744
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.342 Vali Acc: 0.826 Test Loss: 2.342 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3250277042388916
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.228 Vali Acc: 0.853 Test Loss: 2.228 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.245903730392456
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.696 Vali Acc: 0.799 Test Loss: 2.696 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 862762
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.013036489486694
Epoch: 1, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.588 Vali Acc: 0.840 Test Loss: 0.588 Test Acc: 0.840
Validation loss decreased (inf --> -0.839585).  Saving model ...
Epoch: 2 cost time: 2.196729898452759
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.645 Vali Acc: 0.785 Test Loss: 0.645 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.998918056488037
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.529 Vali Acc: 0.795 Test Loss: 0.529 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1327784061431885
Epoch: 4, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.025160789489746
Epoch: 5, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0881705284118652
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.289 Vali Acc: 0.614 Test Loss: 1.289 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1209163665771484
Epoch: 7, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1565027236938477
Epoch: 8, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.453 Vali Acc: 0.717 Test Loss: 1.453 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0585227012634277
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.704 Vali Acc: 0.836 Test Loss: 0.704 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1498262882232666
Epoch: 10, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.762 Vali Acc: 0.840 Test Loss: 0.762 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.249755382537842
Epoch: 11, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.754 Vali Acc: 0.829 Test Loss: 0.754 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 862762
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.579240322113037
Epoch: 1, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (inf --> -0.774738).  Saving model ...
Epoch: 2 cost time: 1.6951572895050049
Epoch: 2, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.774738 --> -0.778150).  Saving model ...
Epoch: 3 cost time: 1.899005651473999
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.624 Vali Acc: 0.710 Test Loss: 0.624 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9024510383605957
Epoch: 4, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.778150 --> -0.819107).  Saving model ...
Epoch: 5 cost time: 1.8735630512237549
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.832 Vali Acc: 0.706 Test Loss: 0.832 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.84708571434021
Epoch: 6, Steps: 17 | Train Loss: 0.625 Vali Loss: 1.466 Vali Acc: 0.662 Test Loss: 1.466 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7186496257781982
Epoch: 7, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.179 Vali Acc: 0.829 Test Loss: 1.179 Test Acc: 0.829
Validation loss decreased (-0.819107 --> -0.829340).  Saving model ...
Epoch: 8 cost time: 1.6889548301696777
Epoch: 8, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.786 Vali Acc: 0.819 Test Loss: 0.786 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7869203090667725
Epoch: 9, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
Validation loss decreased (-0.829340 --> -0.849822).  Saving model ...
Epoch: 10 cost time: 1.8048968315124512
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.030 Vali Acc: 0.631 Test Loss: 2.030 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7585301399230957
Epoch: 11, Steps: 17 | Train Loss: 1.232 Vali Loss: 3.593 Vali Acc: 0.659 Test Loss: 3.593 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8254010677337646
Epoch: 12, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.664 Vali Acc: 0.863 Test Loss: 0.664 Test Acc: 0.863
Validation loss decreased (-0.849822 --> -0.863475).  Saving model ...
Epoch: 13 cost time: 1.9498703479766846
Epoch: 13, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.674 Vali Acc: 0.751 Test Loss: 1.674 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9133126735687256
Epoch: 14, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.945 Vali Acc: 0.683 Test Loss: 2.945 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9035027027130127
Epoch: 15, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.944 Vali Acc: 0.870 Test Loss: 0.944 Test Acc: 0.870
Validation loss decreased (-0.863475 --> -0.870298).  Saving model ...
Epoch: 16 cost time: 1.8618993759155273
Epoch: 16, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.210 Vali Acc: 0.846 Test Loss: 1.210 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7877740859985352
Epoch: 17, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.390 Vali Acc: 0.829 Test Loss: 1.390 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7921645641326904
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.344 Vali Acc: 0.846 Test Loss: 1.344 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6583781242370605
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.888 Vali Acc: 0.758 Test Loss: 2.888 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7764027118682861
Epoch: 20, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.723 Vali Acc: 0.805 Test Loss: 1.723 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.909024953842163
Epoch: 21, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.867 Vali Acc: 0.775 Test Loss: 2.867 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.940415382385254
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.767 Vali Acc: 0.823 Test Loss: 1.767 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9760053157806396
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.973 Vali Acc: 0.809 Test Loss: 1.973 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9571406841278076
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.287 Vali Acc: 0.805 Test Loss: 2.287 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8924314975738525
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.964 Vali Acc: 0.805 Test Loss: 1.964 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 862762
model size : 8.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.468892812728882
Epoch: 1, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
Validation loss decreased (inf --> -0.767912).  Saving model ...
Epoch: 2 cost time: 2.3122828006744385
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.460 Vali Acc: 0.826 Test Loss: 0.460 Test Acc: 0.826
Validation loss decreased (-0.767912 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 2.338683605194092
Epoch: 3, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.947 Vali Acc: 0.795 Test Loss: 0.947 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.353943347930908
Epoch: 4, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.683 Vali Acc: 0.836 Test Loss: 0.683 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836171).  Saving model ...
Epoch: 5 cost time: 2.3469183444976807
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.595 Vali Acc: 0.874 Test Loss: 0.595 Test Acc: 0.874
Validation loss decreased (-0.836171 --> -0.873714).  Saving model ...
Epoch: 6 cost time: 2.4390923976898193
Epoch: 6, Steps: 17 | Train Loss: 0.503 Vali Loss: 1.087 Vali Acc: 0.771 Test Loss: 1.087 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.420206069946289
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.065 Vali Acc: 0.782 Test Loss: 1.065 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1705234050750732
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.156 Vali Acc: 0.778 Test Loss: 1.156 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.181893825531006
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.628 Vali Acc: 0.768 Test Loss: 1.628 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.218717575073242
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.767 Vali Acc: 0.846 Test Loss: 0.767 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2064874172210693
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.959 Vali Acc: 0.737 Test Loss: 1.959 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.536421298980713
Epoch: 12, Steps: 17 | Train Loss: 0.448 Vali Loss: 3.639 Vali Acc: 0.635 Test Loss: 3.639 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5260252952575684
Epoch: 13, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.224 Vali Acc: 0.853 Test Loss: 1.224 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5449461936950684
Epoch: 14, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.025 Vali Acc: 0.754 Test Loss: 2.025 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.09907603263855
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.292 Vali Acc: 0.857 Test Loss: 1.292 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 731690
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.049844741821289
Epoch: 1, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.578 Vali Acc: 0.765 Test Loss: 0.578 Test Acc: 0.765
Validation loss decreased (inf --> -0.764499).  Saving model ...
Epoch: 2 cost time: 2.322592258453369
Epoch: 2, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.488 Vali Acc: 0.805 Test Loss: 0.488 Test Acc: 0.805
Validation loss decreased (-0.764499 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.3229777812957764
Epoch: 3, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.057 Vali Acc: 0.751 Test Loss: 1.057 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2548904418945312
Epoch: 4, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.805456 --> -0.849823).  Saving model ...
Epoch: 5 cost time: 2.2999749183654785
Epoch: 5, Steps: 17 | Train Loss: 0.627 Vali Loss: 1.117 Vali Acc: 0.792 Test Loss: 1.117 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1593878269195557
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.362 Vali Acc: 0.693 Test Loss: 1.362 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2355539798736572
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.972 Vali Acc: 0.802 Test Loss: 0.972 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.209477186203003
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 1.066 Vali Acc: 0.788 Test Loss: 1.066 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2133681774139404
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.618 Vali Acc: 0.857 Test Loss: 0.618 Test Acc: 0.857
Validation loss decreased (-0.849823 --> -0.856649).  Saving model ...
Epoch: 10 cost time: 2.155771017074585
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.908 Vali Acc: 0.805 Test Loss: 0.908 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.02258038520813
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.669 Vali Acc: 0.881 Test Loss: 0.669 Test Acc: 0.881
Validation loss decreased (-0.856649 --> -0.880539).  Saving model ...
Epoch: 12 cost time: 2.303363561630249
Epoch: 12, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.566 Vali Acc: 0.877 Test Loss: 0.566 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3033859729766846
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.877 Vali Acc: 0.860 Test Loss: 0.877 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.208714723587036
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.153 Vali Acc: 0.816 Test Loss: 1.153 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1805686950683594
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.585 Vali Acc: 0.809 Test Loss: 1.585 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.139733076095581
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.766 Vali Acc: 0.860 Test Loss: 0.766 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1981587409973145
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.536 Vali Acc: 0.819 Test Loss: 1.536 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0504157543182373
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.164 Vali Acc: 0.853 Test Loss: 1.164 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1493687629699707
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.512 Vali Acc: 0.812 Test Loss: 1.512 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7581064701080322
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.853 Test Loss: 1.021 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.132449150085449
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.213 Vali Acc: 0.840 Test Loss: 1.213 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 731690
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.627624273300171
Epoch: 1, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (inf --> -0.761086).  Saving model ...
Epoch: 2 cost time: 2.003380060195923
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.372 Vali Acc: 0.846 Test Loss: 0.372 Test Acc: 0.846
Validation loss decreased (-0.761086 --> -0.846413).  Saving model ...
Epoch: 3 cost time: 2.031278133392334
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.834 Vali Acc: 0.724 Test Loss: 0.834 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.113250732421875
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.696 Vali Acc: 0.792 Test Loss: 0.696 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9657418727874756
Epoch: 5, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0558149814605713
Epoch: 6, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.507 Vali Acc: 0.860 Test Loss: 0.507 Test Acc: 0.860
Validation loss decreased (-0.846413 --> -0.860063).  Saving model ...
Epoch: 7 cost time: 2.020458459854126
Epoch: 7, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.221 Vali Acc: 0.724 Test Loss: 1.221 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.91471266746521
Epoch: 8, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.102 Vali Acc: 0.638 Test Loss: 2.102 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8450472354888916
Epoch: 9, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.961 Vali Acc: 0.829 Test Loss: 0.961 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8512227535247803
Epoch: 10, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.654 Vali Acc: 0.870 Test Loss: 0.654 Test Acc: 0.870
Validation loss decreased (-0.860063 --> -0.870301).  Saving model ...
Epoch: 11 cost time: 2.0322718620300293
Epoch: 11, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.661 Vali Acc: 0.659 Test Loss: 1.661 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0911309719085693
Epoch: 12, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.905 Vali Acc: 0.713 Test Loss: 1.905 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0469517707824707
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.352 Vali Acc: 0.768 Test Loss: 1.352 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.032860279083252
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.266 Vali Acc: 0.730 Test Loss: 2.266 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9582593441009521
Epoch: 15, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.399 Vali Acc: 0.724 Test Loss: 2.399 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8627924919128418
Epoch: 16, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.846 Vali Acc: 0.874 Test Loss: 0.846 Test Acc: 0.874
Validation loss decreased (-0.870301 --> -0.873712).  Saving model ...
Epoch: 17 cost time: 1.9890742301940918
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.186 Vali Acc: 0.860 Test Loss: 1.186 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0338306427001953
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.447 Vali Acc: 0.782 Test Loss: 2.447 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2901768684387207
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.124 Vali Acc: 0.853 Test Loss: 1.124 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3168892860412598
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.527 Vali Acc: 0.805 Test Loss: 1.527 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.242454767227173
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.177 Vali Acc: 0.867 Test Loss: 1.177 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.054241895675659
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.741 Vali Acc: 0.734 Test Loss: 2.741 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.037645101547241
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.351 Vali Acc: 0.860 Test Loss: 1.351 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0369200706481934
Epoch: 24, Steps: 17 | Train Loss: 0.248 Vali Loss: 2.005 Vali Acc: 0.812 Test Loss: 2.005 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2111730575561523
Epoch: 25, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.309 Vali Acc: 0.802 Test Loss: 2.309 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.264906644821167
Epoch: 26, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.038 Vali Acc: 0.816 Test Loss: 2.038 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 731690
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.612894058227539
Epoch: 1, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.524 Vali Acc: 0.795 Test Loss: 0.524 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 1.8506693840026855
Epoch: 2, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.351 Vali Acc: 0.874 Test Loss: 0.351 Test Acc: 0.874
Validation loss decreased (-0.795217 --> -0.873717).  Saving model ...
Epoch: 3 cost time: 1.8198370933532715
Epoch: 3, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.938 Vali Acc: 0.734 Test Loss: 0.938 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9648840427398682
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.513 Vali Acc: 0.816 Test Loss: 0.513 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8859596252441406
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.476 Vali Acc: 0.802 Test Loss: 0.476 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9168109893798828
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.956 Vali Acc: 0.782 Test Loss: 0.956 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0230422019958496
Epoch: 7, Steps: 17 | Train Loss: 0.428 Vali Loss: 1.205 Vali Acc: 0.669 Test Loss: 1.205 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.003654956817627
Epoch: 8, Steps: 17 | Train Loss: 0.488 Vali Loss: 1.854 Vali Acc: 0.655 Test Loss: 1.854 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9669198989868164
Epoch: 9, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.090 Vali Acc: 0.812 Test Loss: 1.090 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.706852674484253
Epoch: 10, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.714 Vali Acc: 0.812 Test Loss: 0.714 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.82474684715271
Epoch: 11, Steps: 17 | Train Loss: 0.308 Vali Loss: 3.110 Vali Acc: 0.570 Test Loss: 3.110 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.900637149810791
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.082 Vali Acc: 0.829 Test Loss: 1.082 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 731690
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.097089529037476
Epoch: 1, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.684 Vali Acc: 0.788 Test Loss: 0.684 Test Acc: 0.788
Validation loss decreased (inf --> -0.788389).  Saving model ...
Epoch: 2 cost time: 2.2720940113067627
Epoch: 2, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
Validation loss decreased (-0.788389 --> -0.812279).  Saving model ...
Epoch: 3 cost time: 2.3678369522094727
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.656 Vali Acc: 0.826 Test Loss: 0.656 Test Acc: 0.826
Validation loss decreased (-0.812279 --> -0.825932).  Saving model ...
Epoch: 4 cost time: 2.33097243309021
Epoch: 4, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.578 Vali Acc: 0.843 Test Loss: 0.578 Test Acc: 0.843
Validation loss decreased (-0.825932 --> -0.842998).  Saving model ...
Epoch: 5 cost time: 2.3719542026519775
Epoch: 5, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.122 Vali Acc: 0.648 Test Loss: 2.122 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3508424758911133
Epoch: 6, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
Validation loss decreased (-0.842998 --> -0.866887).  Saving model ...
Epoch: 7 cost time: 2.3040966987609863
Epoch: 7, Steps: 17 | Train Loss: 0.252 Vali Loss: 1.915 Vali Acc: 0.734 Test Loss: 1.915 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.06019926071167
Epoch: 8, Steps: 17 | Train Loss: 0.368 Vali Loss: 1.701 Vali Acc: 0.819 Test Loss: 1.701 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3299689292907715
Epoch: 9, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.696 Vali Acc: 0.662 Test Loss: 2.696 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.393772840499878
Epoch: 10, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.451 Vali Acc: 0.672 Test Loss: 2.451 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4385569095611572
Epoch: 11, Steps: 17 | Train Loss: 0.525 Vali Loss: 2.365 Vali Acc: 0.785 Test Loss: 2.365 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.431553602218628
Epoch: 12, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.116 Vali Acc: 0.863 Test Loss: 1.116 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.244716167449951
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.391 Vali Acc: 0.795 Test Loss: 1.391 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2742276191711426
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.108 Vali Acc: 0.833 Test Loss: 1.108 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2670602798461914
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.443 Vali Acc: 0.823 Test Loss: 1.443 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1979129314422607
Epoch: 16, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.243 Vali Acc: 0.853 Test Loss: 1.243 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 666154
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.807116985321045
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.665 Vali Acc: 0.823 Test Loss: 0.665 Test Acc: 0.823
Validation loss decreased (inf --> -0.822519).  Saving model ...
Epoch: 2 cost time: 2.1090123653411865
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.746 Vali Acc: 0.795 Test Loss: 0.746 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.009092330932617
Epoch: 3, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0340702533721924
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.507 Vali Acc: 0.874 Test Loss: 0.507 Test Acc: 0.874
Validation loss decreased (-0.822519 --> -0.873715).  Saving model ...
Epoch: 5 cost time: 2.166718006134033
Epoch: 5, Steps: 17 | Train Loss: 0.546 Vali Loss: 1.098 Vali Acc: 0.778 Test Loss: 1.098 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3418922424316406
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.789 Vali Acc: 0.833 Test Loss: 0.789 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2483484745025635
Epoch: 7, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.633 Vali Acc: 0.577 Test Loss: 2.633 Test Acc: 0.577
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1414434909820557
Epoch: 8, Steps: 17 | Train Loss: 0.251 Vali Loss: 1.249 Vali Acc: 0.768 Test Loss: 1.249 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1118507385253906
Epoch: 9, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.407 Vali Acc: 0.768 Test Loss: 1.407 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9674551486968994
Epoch: 10, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.597 Vali Acc: 0.874 Test Loss: 0.597 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.029245615005493
Epoch: 11, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.248 Vali Acc: 0.819 Test Loss: 1.248 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1239027976989746
Epoch: 12, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.646 Vali Acc: 0.799 Test Loss: 1.646 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1480307579040527
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.746 Vali Acc: 0.874 Test Loss: 0.746 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2186522483825684
Epoch: 14, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.634 Vali Acc: 0.785 Test Loss: 1.634 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 666154
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6465280055999756
Epoch: 1, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
Validation loss decreased (inf --> -0.808867).  Saving model ...
Epoch: 2 cost time: 2.0463414192199707
Epoch: 2, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.727 Vali Acc: 0.805 Test Loss: 0.727 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9208123683929443
Epoch: 3, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.690 Vali Acc: 0.771 Test Loss: 0.690 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.909900426864624
Epoch: 4, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.938 Vali Acc: 0.734 Test Loss: 0.938 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.046743869781494
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.709 Vali Acc: 0.792 Test Loss: 0.709 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.985408067703247
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
Validation loss decreased (-0.808867 --> -0.870303).  Saving model ...
Epoch: 7 cost time: 2.004897117614746
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.799 Vali Acc: 0.645 Test Loss: 1.799 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0599212646484375
Epoch: 8, Steps: 17 | Train Loss: 0.777 Vali Loss: 3.106 Vali Acc: 0.621 Test Loss: 3.106 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.924419641494751
Epoch: 9, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.650 Vali Acc: 0.843 Test Loss: 0.650 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0767970085144043
Epoch: 10, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.704 Vali Acc: 0.887 Test Loss: 0.704 Test Acc: 0.887
Validation loss decreased (-0.870303 --> -0.887365).  Saving model ...
Epoch: 11 cost time: 2.20823335647583
Epoch: 11, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.669 Vali Acc: 0.730 Test Loss: 1.669 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1612398624420166
Epoch: 12, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.134 Vali Acc: 0.771 Test Loss: 1.134 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.901045322418213
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.826 Vali Acc: 0.843 Test Loss: 0.826 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2353665828704834
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.281 Vali Acc: 0.788 Test Loss: 1.281 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1872596740722656
Epoch: 15, Steps: 17 | Train Loss: 0.210 Vali Loss: 2.641 Vali Acc: 0.737 Test Loss: 2.641 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1322035789489746
Epoch: 16, Steps: 17 | Train Loss: 0.783 Vali Loss: 2.065 Vali Acc: 0.775 Test Loss: 2.065 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1529219150543213
Epoch: 17, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.834 Vali Acc: 0.741 Test Loss: 2.834 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0596957206726074
Epoch: 18, Steps: 17 | Train Loss: 0.203 Vali Loss: 2.724 Vali Acc: 0.744 Test Loss: 2.724 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9156649112701416
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.323 Vali Acc: 0.840 Test Loss: 1.323 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.85050368309021
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.408 Vali Acc: 0.826 Test Loss: 1.408 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 666154
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8254928588867188
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.693 Vali Acc: 0.788 Test Loss: 0.693 Test Acc: 0.788
Validation loss decreased (inf --> -0.788389).  Saving model ...
Epoch: 2 cost time: 1.7523808479309082
Epoch: 2, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.812 Vali Acc: 0.792 Test Loss: 0.812 Test Acc: 0.792
Validation loss decreased (-0.788389 --> -0.791801).  Saving model ...
Epoch: 3 cost time: 1.6673362255096436
Epoch: 3, Steps: 17 | Train Loss: 0.694 Vali Loss: 1.019 Vali Acc: 0.655 Test Loss: 1.019 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.631746530532837
Epoch: 4, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.138 Vali Acc: 0.693 Test Loss: 1.138 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7516753673553467
Epoch: 5, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.619 Vali Acc: 0.795 Test Loss: 0.619 Test Acc: 0.795
Validation loss decreased (-0.791801 --> -0.795216).  Saving model ...
Epoch: 6 cost time: 1.7357680797576904
Epoch: 6, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.700 Vali Acc: 0.863 Test Loss: 0.700 Test Acc: 0.863
Validation loss decreased (-0.795216 --> -0.863474).  Saving model ...
Epoch: 7 cost time: 1.836822271347046
Epoch: 7, Steps: 17 | Train Loss: 0.801 Vali Loss: 3.582 Vali Acc: 0.481 Test Loss: 3.582 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.001805305480957
Epoch: 8, Steps: 17 | Train Loss: 1.088 Vali Loss: 0.830 Vali Acc: 0.823 Test Loss: 0.830 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9613890647888184
Epoch: 9, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.634 Vali Acc: 0.823 Test Loss: 0.634 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9388365745544434
Epoch: 10, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.765 Vali Acc: 0.857 Test Loss: 0.765 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9313037395477295
Epoch: 11, Steps: 17 | Train Loss: 0.608 Vali Loss: 3.561 Vali Acc: 0.597 Test Loss: 3.561 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6215426921844482
Epoch: 12, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.342 Vali Acc: 0.782 Test Loss: 1.342 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7612707614898682
Epoch: 13, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.606 Vali Acc: 0.730 Test Loss: 1.606 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8235585689544678
Epoch: 14, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.877 Vali Acc: 0.812 Test Loss: 1.877 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9196715354919434
Epoch: 15, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.455 Vali Acc: 0.788 Test Loss: 1.455 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9617855548858643
Epoch: 16, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.725 Vali Acc: 0.788 Test Loss: 1.725 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 666154
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9456310272216797
Epoch: 1, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.753 Vali Acc: 0.747 Test Loss: 0.753 Test Acc: 0.747
Validation loss decreased (inf --> -0.747433).  Saving model ...
Epoch: 2 cost time: 2.256666660308838
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.887 Vali Acc: 0.751 Test Loss: 0.887 Test Acc: 0.751
Validation loss decreased (-0.747433 --> -0.750844).  Saving model ...
Epoch: 3 cost time: 2.3442094326019287
Epoch: 3, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.825 Vali Acc: 0.720 Test Loss: 0.825 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2763187885284424
Epoch: 4, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.606 Vali Acc: 0.829 Test Loss: 0.606 Test Acc: 0.829
Validation loss decreased (-0.750844 --> -0.829345).  Saving model ...
Epoch: 5 cost time: 2.31058931350708
Epoch: 5, Steps: 17 | Train Loss: 0.372 Vali Loss: 1.073 Vali Acc: 0.771 Test Loss: 1.073 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3814380168914795
Epoch: 6, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.938 Vali Acc: 0.840 Test Loss: 0.938 Test Acc: 0.840
Validation loss decreased (-0.829345 --> -0.839581).  Saving model ...
Epoch: 7 cost time: 2.3283112049102783
Epoch: 7, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.658 Vali Acc: 0.853 Test Loss: 0.658 Test Acc: 0.853
Validation loss decreased (-0.839581 --> -0.853236).  Saving model ...
Epoch: 8 cost time: 2.141356945037842
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.162 Vali Acc: 0.765 Test Loss: 1.162 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.349396228790283
Epoch: 9, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.098 Vali Acc: 0.802 Test Loss: 1.098 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.347038507461548
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.475 Vali Acc: 0.727 Test Loss: 1.475 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2184066772460938
Epoch: 11, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.205 Vali Acc: 0.782 Test Loss: 1.205 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1174628734588623
Epoch: 12, Steps: 17 | Train Loss: 0.437 Vali Loss: 1.205 Vali Acc: 0.860 Test Loss: 1.205 Test Acc: 0.860
Validation loss decreased (-0.853236 --> -0.860056).  Saving model ...
Epoch: 13 cost time: 2.1440224647521973
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.347 Vali Acc: 0.826 Test Loss: 1.347 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.287900447845459
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.080 Vali Acc: 0.836 Test Loss: 1.080 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3679189682006836
Epoch: 15, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.610 Vali Acc: 0.795 Test Loss: 1.610 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4206888675689697
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.519 Vali Acc: 0.816 Test Loss: 1.519 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3732211589813232
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.304 Vali Acc: 0.846 Test Loss: 1.304 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.08994722366333
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.813 Vali Acc: 0.809 Test Loss: 1.813 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1311731338500977
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.599 Vali Acc: 0.850 Test Loss: 1.599 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1969234943389893
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.740 Vali Acc: 0.826 Test Loss: 1.740 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2318689823150635
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.656 Vali Acc: 0.836 Test Loss: 1.656 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4540348052978516
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.214 Vali Acc: 0.833 Test Loss: 1.214 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 633386
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.946906089782715
Epoch: 1, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.780 Vali Acc: 0.754 Test Loss: 0.780 Test Acc: 0.754
Validation loss decreased (inf --> -0.754258).  Saving model ...
Epoch: 2 cost time: 2.2794570922851562
Epoch: 2, Steps: 17 | Train Loss: 0.462 Vali Loss: 1.219 Vali Acc: 0.700 Test Loss: 1.219 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2250072956085205
Epoch: 3, Steps: 17 | Train Loss: 0.437 Vali Loss: 2.449 Vali Acc: 0.553 Test Loss: 2.449 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0347306728363037
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.512 Vali Acc: 0.840 Test Loss: 0.512 Test Acc: 0.840
Validation loss decreased (-0.754258 --> -0.839585).  Saving model ...
Epoch: 5 cost time: 2.160064935684204
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.594 Vali Acc: 0.648 Test Loss: 1.594 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.006789207458496
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.645 Vali Acc: 0.863 Test Loss: 0.645 Test Acc: 0.863
Validation loss decreased (-0.839585 --> -0.863475).  Saving model ...
Epoch: 7 cost time: 1.9202897548675537
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.581 Vali Acc: 0.874 Test Loss: 0.581 Test Acc: 0.874
Validation loss decreased (-0.863475 --> -0.873714).  Saving model ...
Epoch: 8 cost time: 1.9563686847686768
Epoch: 8, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.960 Vali Acc: 0.758 Test Loss: 0.960 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0028891563415527
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 2.425 Vali Acc: 0.669 Test Loss: 2.425 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.415801525115967
Epoch: 10, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.459 Vali Acc: 0.843 Test Loss: 1.459 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.371875286102295
Epoch: 11, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.988 Vali Acc: 0.874 Test Loss: 0.988 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1878700256347656
Epoch: 12, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.791 Vali Acc: 0.887 Test Loss: 0.791 Test Acc: 0.887
Validation loss decreased (-0.873714 --> -0.887364).  Saving model ...
Epoch: 13 cost time: 2.1529674530029297
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.955 Vali Acc: 0.782 Test Loss: 1.955 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2354657649993896
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.039 Vali Acc: 0.829 Test Loss: 1.039 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.090472936630249
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.363 Vali Acc: 0.833 Test Loss: 1.363 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2165095806121826
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.845 Vali Acc: 0.870 Test Loss: 0.845 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.160292863845825
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.179 Vali Acc: 0.823 Test Loss: 1.179 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0733630657196045
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.078 Vali Acc: 0.840 Test Loss: 1.078 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.186034679412842
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.893 Vali Acc: 0.826 Test Loss: 1.893 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.142150402069092
Epoch: 20, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.284 Vali Acc: 0.799 Test Loss: 2.284 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.122375249862671
Epoch: 21, Steps: 17 | Train Loss: 0.228 Vali Loss: 4.122 Vali Acc: 0.648 Test Loss: 4.122 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.122710943222046
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.467 Vali Acc: 0.863 Test Loss: 1.467 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 633386
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9089338779449463
Epoch: 1, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.756 Vali Acc: 0.734 Test Loss: 0.756 Test Acc: 0.734
Validation loss decreased (inf --> -0.733781).  Saving model ...
Epoch: 2 cost time: 2.0607216358184814
Epoch: 2, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
Validation loss decreased (-0.733781 --> -0.808868).  Saving model ...
Epoch: 3 cost time: 2.177180051803589
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 1.380 Vali Acc: 0.587 Test Loss: 1.380 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9426288604736328
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.792 Vali Acc: 0.792 Test Loss: 0.792 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.020925760269165
Epoch: 5, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.560 Vali Acc: 0.648 Test Loss: 1.560 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.903879165649414
Epoch: 6, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.602 Vali Acc: 0.857 Test Loss: 0.602 Test Acc: 0.857
Validation loss decreased (-0.808868 --> -0.856649).  Saving model ...
Epoch: 7 cost time: 1.8376681804656982
Epoch: 7, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.807 Vali Acc: 0.802 Test Loss: 0.807 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0094783306121826
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 1.669 Vali Acc: 0.751 Test Loss: 1.669 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.062147378921509
Epoch: 9, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.970 Vali Acc: 0.782 Test Loss: 0.970 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0702481269836426
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 3.253 Vali Acc: 0.608 Test Loss: 3.253 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.107255220413208
Epoch: 11, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.815 Vali Acc: 0.846 Test Loss: 0.815 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.080096960067749
Epoch: 12, Steps: 17 | Train Loss: 0.453 Vali Loss: 1.118 Vali Acc: 0.857 Test Loss: 1.118 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9965038299560547
Epoch: 13, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.094 Vali Acc: 0.700 Test Loss: 2.094 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.990518569946289
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.540 Vali Acc: 0.788 Test Loss: 1.540 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9669461250305176
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.793 Vali Acc: 0.765 Test Loss: 1.793 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0655786991119385
Epoch: 16, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.048 Vali Acc: 0.850 Test Loss: 1.048 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 633386
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.51304292678833
Epoch: 1, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.669 Vali Acc: 0.799 Test Loss: 0.669 Test Acc: 0.799
Validation loss decreased (inf --> -0.798628).  Saving model ...
Epoch: 2 cost time: 1.7611956596374512
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.553 Vali Acc: 0.823 Test Loss: 0.553 Test Acc: 0.823
Validation loss decreased (-0.798628 --> -0.822520).  Saving model ...
Epoch: 3 cost time: 1.7939438819885254
Epoch: 3, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.924 Vali Acc: 0.669 Test Loss: 0.924 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8101820945739746
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (-0.822520 --> -0.877129).  Saving model ...
Epoch: 5 cost time: 1.9233784675598145
Epoch: 5, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.039 Vali Acc: 0.741 Test Loss: 1.039 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8157861232757568
Epoch: 6, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.856 Vali Acc: 0.652 Test Loss: 1.856 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9596741199493408
Epoch: 7, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.823 Vali Acc: 0.843 Test Loss: 0.823 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8465008735656738
Epoch: 8, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.892 Vali Acc: 0.782 Test Loss: 0.892 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8376665115356445
Epoch: 9, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.719 Vali Acc: 0.829 Test Loss: 0.719 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.756836175918579
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.480 Vali Acc: 0.601 Test Loss: 2.480 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7839422225952148
Epoch: 11, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.203 Vali Acc: 0.747 Test Loss: 1.203 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9181187152862549
Epoch: 12, Steps: 17 | Train Loss: 0.540 Vali Loss: 1.218 Vali Acc: 0.853 Test Loss: 1.218 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.911057949066162
Epoch: 13, Steps: 17 | Train Loss: 0.787 Vali Loss: 1.120 Vali Acc: 0.826 Test Loss: 1.120 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9568531513214111
Epoch: 14, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.935 Vali Acc: 0.846 Test Loss: 0.935 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 633386
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4665770530700684
Epoch: 1, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.411 Vali Acc: 0.857 Test Loss: 0.411 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 1.7561678886413574
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7256972789764404
Epoch: 3, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.765507698059082
Epoch: 4, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.722 Vali Acc: 0.771 Test Loss: 0.722 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7119166851043701
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6613128185272217
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.598 Vali Acc: 0.846 Test Loss: 0.598 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7754566669464111
Epoch: 7, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.994 Vali Acc: 0.710 Test Loss: 0.994 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8079016208648682
Epoch: 8, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.894 Vali Acc: 0.751 Test Loss: 0.894 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.807772159576416
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.718 Vali Acc: 0.812 Test Loss: 0.718 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7372064590454102
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.736 Vali Acc: 0.823 Test Loss: 0.736 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7387497425079346
Epoch: 11, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.574 Vali Acc: 0.724 Test Loss: 1.574 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 791850
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.390749931335449
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.416 Vali Acc: 0.860 Test Loss: 0.416 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 1.665217399597168
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.539 Vali Acc: 0.799 Test Loss: 0.539 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.644559383392334
Epoch: 3, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7701733112335205
Epoch: 4, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.997 Vali Acc: 0.696 Test Loss: 0.997 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6958091259002686
Epoch: 5, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.429 Vali Acc: 0.870 Test Loss: 0.429 Test Acc: 0.870
Validation loss decreased (-0.860064 --> -0.870303).  Saving model ...
Epoch: 6 cost time: 1.6713950634002686
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.514 Vali Acc: 0.860 Test Loss: 0.514 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5631182193756104
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.091 Vali Acc: 0.734 Test Loss: 1.091 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5497639179229736
Epoch: 8, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.309 Vali Acc: 0.669 Test Loss: 1.309 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.531034231185913
Epoch: 9, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.865 Vali Acc: 0.870 Test Loss: 0.865 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.552795648574829
Epoch: 10, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.468 Vali Acc: 0.860 Test Loss: 0.468 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6051268577575684
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.294 Vali Acc: 0.737 Test Loss: 1.294 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6915249824523926
Epoch: 12, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.119 Vali Acc: 0.775 Test Loss: 1.119 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7949585914611816
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.604 Vali Acc: 0.881 Test Loss: 0.604 Test Acc: 0.881
Validation loss decreased (-0.870303 --> -0.880540).  Saving model ...
Epoch: 14 cost time: 1.719667673110962
Epoch: 14, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.432 Vali Acc: 0.737 Test Loss: 1.432 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5373213291168213
Epoch: 15, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.696 Vali Acc: 0.785 Test Loss: 1.696 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5163154602050781
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.784 Vali Acc: 0.846 Test Loss: 0.784 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5391969680786133
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.839 Vali Acc: 0.881 Test Loss: 0.839 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.538989543914795
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.133 Vali Acc: 0.812 Test Loss: 1.133 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5200588703155518
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.732 Vali Acc: 0.874 Test Loss: 0.732 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6243107318878174
Epoch: 20, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.870 Vali Acc: 0.860 Test Loss: 0.870 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7377357482910156
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.266 Vali Acc: 0.826 Test Loss: 1.266 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7297511100769043
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.983 Vali Acc: 0.857 Test Loss: 0.983 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6869561672210693
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.025 Vali Acc: 0.843 Test Loss: 1.025 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 791850
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3115575313568115
Epoch: 1, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 1.4990649223327637
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.806 Vali Acc: 0.734 Test Loss: 0.806 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4584522247314453
Epoch: 3, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.440 Vali Acc: 0.853 Test Loss: 0.440 Test Acc: 0.853
Validation loss decreased (-0.849825 --> -0.853238).  Saving model ...
Epoch: 4 cost time: 1.5750682353973389
Epoch: 4, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5321807861328125
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.466 Vali Acc: 0.860 Test Loss: 0.466 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860064).  Saving model ...
Epoch: 6 cost time: 1.6642162799835205
Epoch: 6, Steps: 17 | Train Loss: 0.539 Vali Loss: 1.343 Vali Acc: 0.621 Test Loss: 1.343 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.53346848487854
Epoch: 7, Steps: 17 | Train Loss: 0.584 Vali Loss: 1.146 Vali Acc: 0.744 Test Loss: 1.146 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6144354343414307
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.058 Vali Acc: 0.710 Test Loss: 1.058 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4564321041107178
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.375 Vali Acc: 0.730 Test Loss: 1.375 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6391944885253906
Epoch: 10, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.64986252784729
Epoch: 11, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.711 Vali Acc: 0.805 Test Loss: 0.711 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6872081756591797
Epoch: 12, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.964 Vali Acc: 0.666 Test Loss: 1.964 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5601685047149658
Epoch: 13, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6161746978759766
Epoch: 14, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.879 Vali Acc: 0.795 Test Loss: 0.879 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5801968574523926
Epoch: 15, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.354 Vali Acc: 0.761 Test Loss: 1.354 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 791850
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.371131420135498
Epoch: 1, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.427 Vali Acc: 0.843 Test Loss: 0.427 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 1.4619996547698975
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.900 Vali Acc: 0.706 Test Loss: 0.900 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4373738765716553
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3461182117462158
Epoch: 4, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.122 Vali Acc: 0.611 Test Loss: 1.122 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4497389793395996
Epoch: 5, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.842999 --> -0.849825).  Saving model ...
Epoch: 6 cost time: 1.5170693397521973
Epoch: 6, Steps: 17 | Train Loss: 0.507 Vali Loss: 1.109 Vali Acc: 0.614 Test Loss: 1.109 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5058202743530273
Epoch: 7, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.672 Vali Acc: 0.676 Test Loss: 1.672 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5287628173828125
Epoch: 8, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.625 Vali Acc: 0.782 Test Loss: 0.625 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4426133632659912
Epoch: 9, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.715 Vali Acc: 0.816 Test Loss: 0.715 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4939768314361572
Epoch: 10, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4872400760650635
Epoch: 11, Steps: 17 | Train Loss: 0.372 Vali Loss: 1.488 Vali Acc: 0.703 Test Loss: 1.488 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3060495853424072
Epoch: 12, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.702 Vali Acc: 0.645 Test Loss: 1.702 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.357424020767212
Epoch: 13, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.582 Vali Acc: 0.823 Test Loss: 0.582 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3164091110229492
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.470 Vali Acc: 0.874 Test Loss: 0.470 Test Acc: 0.874
Validation loss decreased (-0.849825 --> -0.873715).  Saving model ...
Epoch: 15 cost time: 1.355973482131958
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.104 Vali Acc: 0.758 Test Loss: 1.104 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4297335147857666
Epoch: 16, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.063 Vali Acc: 0.782 Test Loss: 1.063 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.523879051208496
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.160 Vali Acc: 0.761 Test Loss: 1.160 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.493940830230713
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.969 Vali Acc: 0.799 Test Loss: 0.969 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4378015995025635
Epoch: 19, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.044 Vali Acc: 0.829 Test Loss: 1.044 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3766124248504639
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.262 Vali Acc: 0.778 Test Loss: 1.262 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3381950855255127
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.127 Vali Acc: 0.823 Test Loss: 1.127 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.398146390914917
Epoch: 22, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.906 Vali Acc: 0.843 Test Loss: 0.906 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.207944631576538
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.899 Vali Acc: 0.751 Test Loss: 1.899 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.403533935546875
Epoch: 24, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.622 Vali Acc: 0.802 Test Loss: 1.622 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 791850
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.426152467727661
Epoch: 1, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.468 Vali Acc: 0.805 Test Loss: 0.468 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 1.4496750831604004
Epoch: 2, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.481 Vali Acc: 0.836 Test Loss: 0.481 Test Acc: 0.836
Validation loss decreased (-0.805456 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.3050172328948975
Epoch: 3, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4550423622131348
Epoch: 4, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.595292329788208
Epoch: 5, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.481 Vali Acc: 0.823 Test Loss: 0.481 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6336183547973633
Epoch: 6, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.071 Vali Acc: 0.747 Test Loss: 1.071 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.762561321258545
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.175 Vali Acc: 0.720 Test Loss: 1.175 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6398756504058838
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.613 Vali Acc: 0.860 Test Loss: 0.613 Test Acc: 0.860
Validation loss decreased (-0.836173 --> -0.860062).  Saving model ...
Epoch: 9 cost time: 1.5601558685302734
Epoch: 9, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.986 Vali Acc: 0.751 Test Loss: 0.986 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5092623233795166
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.762 Vali Acc: 0.823 Test Loss: 0.762 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5765833854675293
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.145 Vali Acc: 0.809 Test Loss: 1.145 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5033464431762695
Epoch: 12, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.620 Vali Acc: 0.703 Test Loss: 1.620 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6241166591644287
Epoch: 13, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.146 Vali Acc: 0.768 Test Loss: 1.146 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6749846935272217
Epoch: 14, Steps: 17 | Train Loss: 0.419 Vali Loss: 1.351 Vali Acc: 0.809 Test Loss: 1.351 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8287787437438965
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.225 Vali Acc: 0.829 Test Loss: 1.225 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8475666046142578
Epoch: 16, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.063 Vali Acc: 0.816 Test Loss: 1.063 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8544394969940186
Epoch: 17, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.609 Vali Acc: 0.778 Test Loss: 1.609 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8878579139709473
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.855 Vali Acc: 0.881 Test Loss: 0.855 Test Acc: 0.881
Validation loss decreased (-0.860062 --> -0.880538).  Saving model ...
Epoch: 19 cost time: 1.7340667247772217
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.151 Vali Acc: 0.836 Test Loss: 1.151 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6506187915802002
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.519 Vali Acc: 0.747 Test Loss: 1.519 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7427678108215332
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.142 Vali Acc: 0.853 Test Loss: 1.142 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8061890602111816
Epoch: 22, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.593 Vali Acc: 0.782 Test Loss: 1.593 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.887402057647705
Epoch: 23, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.205 Vali Acc: 0.840 Test Loss: 1.205 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8167486190795898
Epoch: 24, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.435 Vali Acc: 0.836 Test Loss: 1.435 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.853041172027588
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.598 Vali Acc: 0.819 Test Loss: 1.598 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6129159927368164
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.080 Vali Acc: 0.843 Test Loss: 1.080 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7337665557861328
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.415 Vali Acc: 0.819 Test Loss: 1.415 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.686156988143921
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.816 Test Loss: 1.468 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 529706
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4020590782165527
Epoch: 1, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.472 Vali Acc: 0.792 Test Loss: 0.472 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.5835497379302979
Epoch: 2, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.477 Vali Acc: 0.840 Test Loss: 0.477 Test Acc: 0.840
Validation loss decreased (-0.791804 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 1.6007883548736572
Epoch: 3, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4582583904266357
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.591 Vali Acc: 0.771 Test Loss: 0.591 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5404021739959717
Epoch: 5, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.449 Vali Acc: 0.857 Test Loss: 0.449 Test Acc: 0.857
Validation loss decreased (-0.839586 --> -0.856651).  Saving model ...
Epoch: 6 cost time: 1.440004587173462
Epoch: 6, Steps: 17 | Train Loss: 0.275 Vali Loss: 1.226 Vali Acc: 0.730 Test Loss: 1.226 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5746655464172363
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.600677251815796
Epoch: 8, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.684 Vali Acc: 0.870 Test Loss: 0.684 Test Acc: 0.870
Validation loss decreased (-0.856651 --> -0.870300).  Saving model ...
Epoch: 9 cost time: 1.5386784076690674
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.468 Vali Acc: 0.693 Test Loss: 1.468 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5866155624389648
Epoch: 10, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.727 Vali Acc: 0.840 Test Loss: 0.727 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6303305625915527
Epoch: 11, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.640 Vali Acc: 0.857 Test Loss: 0.640 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6287014484405518
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.128 Vali Acc: 0.823 Test Loss: 1.128 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5340068340301514
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6185212135314941
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.746 Vali Acc: 0.843 Test Loss: 0.746 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6352107524871826
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.027 Vali Acc: 0.843 Test Loss: 1.027 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5881049633026123
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.919 Vali Acc: 0.843 Test Loss: 0.919 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6407175064086914
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.115 Vali Acc: 0.819 Test Loss: 1.115 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.491405725479126
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.794 Vali Acc: 0.860 Test Loss: 0.794 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 529706
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4106531143188477
Epoch: 1, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.472 Vali Acc: 0.792 Test Loss: 0.472 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.533444881439209
Epoch: 2, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.791804 --> -0.849824).  Saving model ...
Epoch: 3 cost time: 1.5565211772918701
Epoch: 3, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.665 Vali Acc: 0.754 Test Loss: 0.665 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.393439531326294
Epoch: 4, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4966402053833008
Epoch: 5, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.476 Vali Acc: 0.840 Test Loss: 0.476 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.362065315246582
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.974 Vali Acc: 0.730 Test Loss: 0.974 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5749468803405762
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.809 Vali Acc: 0.765 Test Loss: 0.809 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5507104396820068
Epoch: 8, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.733 Vali Acc: 0.778 Test Loss: 0.733 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.573009729385376
Epoch: 9, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.568 Vali Acc: 0.686 Test Loss: 1.568 Test Acc: 0.686
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4962761402130127
Epoch: 10, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.722 Vali Acc: 0.792 Test Loss: 0.722 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4850413799285889
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.314 Vali Acc: 0.802 Test Loss: 1.314 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5546441078186035
Epoch: 12, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.838 Vali Acc: 0.812 Test Loss: 0.838 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 529706
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3793606758117676
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.456 Vali Acc: 0.799 Test Loss: 0.456 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.390779972076416
Epoch: 2, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.798630 --> -0.815694).  Saving model ...
Epoch: 3 cost time: 1.3455822467803955
Epoch: 3, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.704 Vali Acc: 0.758 Test Loss: 0.704 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3212568759918213
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.558 Vali Acc: 0.771 Test Loss: 0.558 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3410568237304688
Epoch: 5, Steps: 17 | Train Loss: 0.481 Vali Loss: 1.177 Vali Acc: 0.717 Test Loss: 1.177 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4505298137664795
Epoch: 6, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.542 Vali Acc: 0.799 Test Loss: 0.542 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2682034969329834
Epoch: 7, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.676 Vali Acc: 0.747 Test Loss: 0.676 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.337700605392456
Epoch: 8, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.492 Vali Acc: 0.840 Test Loss: 0.492 Test Acc: 0.840
Validation loss decreased (-0.815694 --> -0.839586).  Saving model ...
Epoch: 9 cost time: 1.3603527545928955
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.913 Vali Acc: 0.614 Test Loss: 1.913 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.357572078704834
Epoch: 10, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.830 Vali Acc: 0.765 Test Loss: 0.830 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4322726726531982
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.296 Vali Acc: 0.587 Test Loss: 1.296 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3854148387908936
Epoch: 12, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853237).  Saving model ...
Epoch: 13 cost time: 1.3534166812896729
Epoch: 13, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.306 Vali Acc: 0.669 Test Loss: 1.306 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2304668426513672
Epoch: 14, Steps: 17 | Train Loss: 0.663 Vali Loss: 2.035 Vali Acc: 0.652 Test Loss: 2.035 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3463950157165527
Epoch: 15, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.019 Vali Acc: 0.795 Test Loss: 1.019 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3239197731018066
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.801 Vali Acc: 0.782 Test Loss: 0.801 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3925836086273193
Epoch: 17, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.940 Vali Acc: 0.799 Test Loss: 0.940 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3057739734649658
Epoch: 18, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.015 Vali Acc: 0.795 Test Loss: 1.015 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3941199779510498
Epoch: 19, Steps: 17 | Train Loss: 0.285 Vali Loss: 2.925 Vali Acc: 0.573 Test Loss: 2.925 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3763537406921387
Epoch: 20, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.030 Vali Acc: 0.836 Test Loss: 1.030 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3459303379058838
Epoch: 21, Steps: 17 | Train Loss: 0.302 Vali Loss: 2.130 Vali Acc: 0.724 Test Loss: 2.130 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2893271446228027
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.822 Vali Acc: 0.765 Test Loss: 1.822 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 529706
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1342968940734863
Epoch: 1, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (inf --> -0.853237).  Saving model ...
Epoch: 2 cost time: 1.5179967880249023
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.930 Vali Acc: 0.710 Test Loss: 0.930 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.638920545578003
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.560 Vali Acc: 0.782 Test Loss: 0.560 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5335614681243896
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7825727462768555
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.319 Vali Acc: 0.659 Test Loss: 1.319 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.682363510131836
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.567 Vali Acc: 0.863 Test Loss: 0.567 Test Acc: 0.863
Validation loss decreased (-0.853237 --> -0.863476).  Saving model ...
Epoch: 7 cost time: 1.7720723152160645
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.629 Vali Acc: 0.840 Test Loss: 0.629 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7502593994140625
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.997 Vali Acc: 0.768 Test Loss: 0.997 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8470346927642822
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.032 Vali Acc: 0.706 Test Loss: 1.032 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8549940586090088
Epoch: 10, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.010 Vali Acc: 0.836 Test Loss: 1.010 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.646094560623169
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.594 Vali Acc: 0.860 Test Loss: 0.594 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.791015863418579
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.452 Vali Acc: 0.720 Test Loss: 1.452 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8941750526428223
Epoch: 13, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.426 Vali Acc: 0.802 Test Loss: 1.426 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8075895309448242
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.805 Vali Acc: 0.833 Test Loss: 0.805 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7471988201141357
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.040 Vali Acc: 0.833 Test Loss: 1.040 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.804015874862671
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.081 Vali Acc: 0.840 Test Loss: 1.081 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 398634
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4312188625335693
Epoch: 1, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 1.5708396434783936
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.949 Vali Acc: 0.696 Test Loss: 0.949 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4885032176971436
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5329437255859375
Epoch: 4, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.534552812576294
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.939 Vali Acc: 0.713 Test Loss: 0.939 Test Acc: 0.713
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5001111030578613
Epoch: 6, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.430 Vali Acc: 0.860 Test Loss: 0.430 Test Acc: 0.860
Validation loss decreased (-0.849825 --> -0.860064).  Saving model ...
Epoch: 7 cost time: 1.4417309761047363
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4243295192718506
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.689 Vali Acc: 0.836 Test Loss: 0.689 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4621334075927734
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.545 Vali Acc: 0.853 Test Loss: 0.545 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4340274333953857
Epoch: 10, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.635 Vali Acc: 0.877 Test Loss: 0.635 Test Acc: 0.877
Validation loss decreased (-0.860064 --> -0.877127).  Saving model ...
Epoch: 11 cost time: 1.4238901138305664
Epoch: 11, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.511 Vali Acc: 0.884 Test Loss: 0.511 Test Acc: 0.884
Validation loss decreased (-0.877127 --> -0.883954).  Saving model ...
Epoch: 12 cost time: 1.4691758155822754
Epoch: 12, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.667 Vali Acc: 0.846 Test Loss: 0.667 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.55306077003479
Epoch: 13, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.847 Vali Acc: 0.754 Test Loss: 1.847 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5060720443725586
Epoch: 14, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.268 Vali Acc: 0.823 Test Loss: 1.268 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5188384056091309
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.887 Vali Acc: 0.853 Test Loss: 0.887 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3318734169006348
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.668 Vali Acc: 0.724 Test Loss: 1.668 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4276738166809082
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.099 Vali Acc: 0.819 Test Loss: 1.099 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.383523941040039
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.824 Vali Acc: 0.853 Test Loss: 0.824 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4721031188964844
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.353 Vali Acc: 0.843 Test Loss: 1.353 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.409844160079956
Epoch: 20, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.168 Vali Acc: 0.833 Test Loss: 1.168 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5680420398712158
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.064 Vali Acc: 0.840 Test Loss: 1.064 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 398634
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2076921463012695
Epoch: 1, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.493 Vali Acc: 0.823 Test Loss: 0.493 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.3036024570465088
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.930 Vali Acc: 0.686 Test Loss: 0.930 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5384111404418945
Epoch: 3, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.597 Vali Acc: 0.771 Test Loss: 0.597 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4805982112884521
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.822521 --> -0.883955).  Saving model ...
Epoch: 5 cost time: 1.608726978302002
Epoch: 5, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.768 Vali Acc: 0.734 Test Loss: 0.768 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5077006816864014
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5300662517547607
Epoch: 7, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.385 Vali Acc: 0.874 Test Loss: 0.385 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5210802555084229
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.592 Vali Acc: 0.836 Test Loss: 0.592 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3772473335266113
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.514 Vali Acc: 0.829 Test Loss: 0.514 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3897638320922852
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.455 Vali Acc: 0.857 Test Loss: 0.455 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.366037130355835
Epoch: 11, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.525 Vali Acc: 0.840 Test Loss: 0.525 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.456125259399414
Epoch: 12, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.383164644241333
Epoch: 13, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.530 Vali Acc: 0.706 Test Loss: 1.530 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4875280857086182
Epoch: 14, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.594 Vali Acc: 0.846 Test Loss: 0.594 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 398634
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.088529348373413
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.2703289985656738
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.745 Vali Acc: 0.710 Test Loss: 0.745 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2751052379608154
Epoch: 3, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.587 Vali Acc: 0.754 Test Loss: 0.587 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3724730014801025
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.439 Vali Acc: 0.823 Test Loss: 0.439 Test Acc: 0.823
Validation loss decreased (-0.812282 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.293346881866455
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3079068660736084
Epoch: 6, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.918 Vali Acc: 0.778 Test Loss: 0.918 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4318492412567139
Epoch: 7, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.395 Vali Acc: 0.618 Test Loss: 1.395 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3911395072937012
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.455 Vali Acc: 0.853 Test Loss: 0.455 Test Acc: 0.853
Validation loss decreased (-0.822521 --> -0.853238).  Saving model ...
Epoch: 9 cost time: 1.4024128913879395
Epoch: 9, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866890).  Saving model ...
Epoch: 10 cost time: 1.3156108856201172
Epoch: 10, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.586 Vali Acc: 0.857 Test Loss: 0.586 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3348002433776855
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2371296882629395
Epoch: 12, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.999 Vali Acc: 0.771 Test Loss: 0.999 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.377816915512085
Epoch: 13, Steps: 17 | Train Loss: 0.318 Vali Loss: 1.243 Vali Acc: 0.730 Test Loss: 1.243 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3794493675231934
Epoch: 14, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.700 Vali Acc: 0.846 Test Loss: 0.700 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3383450508117676
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.447 Vali Acc: 0.881 Test Loss: 0.447 Test Acc: 0.881
Validation loss decreased (-0.866890 --> -0.880542).  Saving model ...
Epoch: 16 cost time: 1.4246821403503418
Epoch: 16, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.688 Vali Acc: 0.836 Test Loss: 0.688 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3970773220062256
Epoch: 17, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.182 Vali Acc: 0.638 Test Loss: 2.182 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3871285915374756
Epoch: 18, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.232 Vali Acc: 0.853 Test Loss: 1.232 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4363954067230225
Epoch: 19, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.024 Vali Acc: 0.799 Test Loss: 1.024 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3505373001098633
Epoch: 20, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.835 Vali Acc: 0.741 Test Loss: 1.835 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3987112045288086
Epoch: 21, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.869 Vali Acc: 0.826 Test Loss: 0.869 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.321929931640625
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.306 Vali Acc: 0.782 Test Loss: 1.306 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2655408382415771
Epoch: 23, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.066 Vali Acc: 0.846 Test Loss: 1.066 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3215663433074951
Epoch: 24, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.201 Vali Acc: 0.823 Test Loss: 1.201 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4145619869232178
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.940 Vali Acc: 0.754 Test Loss: 1.940 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 398634
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4669055938720703
Epoch: 1, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.491 Vali Acc: 0.840 Test Loss: 0.491 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 1.6973731517791748
Epoch: 2, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.443 Vali Acc: 0.860 Test Loss: 0.443 Test Acc: 0.860
Validation loss decreased (-0.839586 --> -0.860064).  Saving model ...
Epoch: 3 cost time: 1.6844227313995361
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.985 Vali Acc: 0.679 Test Loss: 0.985 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7826673984527588
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6471712589263916
Epoch: 5, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.413 Vali Acc: 0.874 Test Loss: 0.413 Test Acc: 0.874
Validation loss decreased (-0.860064 --> -0.873716).  Saving model ...
Epoch: 6 cost time: 1.6319143772125244
Epoch: 6, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7799890041351318
Epoch: 7, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.758 Vali Acc: 0.795 Test Loss: 0.758 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7366142272949219
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.035 Vali Acc: 0.713 Test Loss: 1.035 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7903640270233154
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.838 Vali Acc: 0.785 Test Loss: 0.838 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.617509365081787
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.973 Vali Acc: 0.819 Test Loss: 0.973 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6985294818878174
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.574 Vali Acc: 0.874 Test Loss: 0.574 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6444060802459717
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.660 Vali Acc: 0.853 Test Loss: 0.660 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6377449035644531
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.696 Vali Acc: 0.829 Test Loss: 0.696 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6463987827301025
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.288 Vali Acc: 0.768 Test Loss: 1.288 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6306889057159424
Epoch: 15, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.903 Vali Acc: 0.850 Test Loss: 0.903 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 333098
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.26263689994812
Epoch: 1, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (inf --> -0.832759).  Saving model ...
Epoch: 2 cost time: 1.4372918605804443
Epoch: 2, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.832759 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 1.4479217529296875
Epoch: 3, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.059 Vali Acc: 0.659 Test Loss: 1.059 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4335346221923828
Epoch: 4, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.415262222290039
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.866890 --> -0.883955).  Saving model ...
Epoch: 6 cost time: 1.4082419872283936
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5829949378967285
Epoch: 7, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.323 Vali Acc: 0.741 Test Loss: 1.323 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.599644660949707
Epoch: 8, Steps: 17 | Train Loss: 0.505 Vali Loss: 1.412 Vali Acc: 0.713 Test Loss: 1.412 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.539041519165039
Epoch: 9, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.696 Vali Acc: 0.846 Test Loss: 0.696 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3739686012268066
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.827 Vali Acc: 0.802 Test Loss: 0.827 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.488377332687378
Epoch: 11, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.725 Vali Acc: 0.805 Test Loss: 0.725 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3250393867492676
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.787 Vali Acc: 0.826 Test Loss: 0.787 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4168572425842285
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.759 Vali Acc: 0.785 Test Loss: 0.759 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4736182689666748
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.786 Vali Acc: 0.846 Test Loss: 0.786 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4922502040863037
Epoch: 15, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.639 Vali Acc: 0.857 Test Loss: 0.639 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 333098
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3813183307647705
Epoch: 1, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
Validation loss decreased (inf --> -0.812281).  Saving model ...
Epoch: 2 cost time: 1.3419685363769531
Epoch: 2, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.812281 --> -0.849824).  Saving model ...
Epoch: 3 cost time: 1.3361687660217285
Epoch: 3, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.939 Vali Acc: 0.672 Test Loss: 0.939 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3896901607513428
Epoch: 4, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.516 Vali Acc: 0.846 Test Loss: 0.516 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4364802837371826
Epoch: 5, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.385 Vali Acc: 0.874 Test Loss: 0.385 Test Acc: 0.874
Validation loss decreased (-0.849824 --> -0.873716).  Saving model ...
Epoch: 6 cost time: 1.5286893844604492
Epoch: 6, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.850 Vali Acc: 0.754 Test Loss: 0.850 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4902782440185547
Epoch: 7, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.687 Vali Acc: 0.805 Test Loss: 0.687 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.505833625793457
Epoch: 8, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4497060775756836
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4197056293487549
Epoch: 10, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3843262195587158
Epoch: 11, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4178564548492432
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.015 Vali Acc: 0.758 Test Loss: 1.015 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5196073055267334
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.779 Vali Acc: 0.785 Test Loss: 0.779 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.385124921798706
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.439246654510498
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.678 Vali Acc: 0.860 Test Loss: 0.678 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 333098
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1194870471954346
Epoch: 1, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.588 Vali Acc: 0.782 Test Loss: 0.588 Test Acc: 0.782
Validation loss decreased (inf --> -0.781564).  Saving model ...
Epoch: 2 cost time: 1.2332587242126465
Epoch: 2, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.519 Vali Acc: 0.846 Test Loss: 0.519 Test Acc: 0.846
Validation loss decreased (-0.781564 --> -0.846411).  Saving model ...
Epoch: 3 cost time: 1.2906653881072998
Epoch: 3, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.872 Vali Acc: 0.696 Test Loss: 0.872 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2952146530151367
Epoch: 4, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.572 Vali Acc: 0.823 Test Loss: 0.572 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3406338691711426
Epoch: 5, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.365 Vali Acc: 0.863 Test Loss: 0.365 Test Acc: 0.863
Validation loss decreased (-0.846411 --> -0.863478).  Saving model ...
Epoch: 6 cost time: 1.3339006900787354
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.536 Vali Acc: 0.747 Test Loss: 0.536 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2840242385864258
Epoch: 7, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.828 Vali Acc: 0.724 Test Loss: 0.828 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2777984142303467
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.023 Vali Acc: 0.676 Test Loss: 1.023 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2483525276184082
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.502 Vali Acc: 0.846 Test Loss: 0.502 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3431000709533691
Epoch: 10, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.306 Vali Acc: 0.672 Test Loss: 1.306 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.228330373764038
Epoch: 11, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.491 Vali Acc: 0.652 Test Loss: 1.491 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2036876678466797
Epoch: 12, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.263714075088501
Epoch: 13, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.736 Vali Acc: 0.812 Test Loss: 0.736 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2413263320922852
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.609 Vali Acc: 0.846 Test Loss: 0.609 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2872648239135742
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.874 Vali Acc: 0.792 Test Loss: 0.874 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 333098
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.336186408996582
Epoch: 1, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.642 Vali Acc: 0.730 Test Loss: 0.642 Test Acc: 0.730
Validation loss decreased (inf --> -0.730369).  Saving model ...
Epoch: 2 cost time: 1.5742616653442383
Epoch: 2, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.591 Vali Acc: 0.795 Test Loss: 0.591 Test Acc: 0.795
Validation loss decreased (-0.730369 --> -0.795216).  Saving model ...
Epoch: 3 cost time: 1.616286277770996
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.866 Vali Acc: 0.720 Test Loss: 0.866 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.636021375656128
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.432 Vali Acc: 0.874 Test Loss: 0.432 Test Acc: 0.874
Validation loss decreased (-0.795216 --> -0.873716).  Saving model ...
Epoch: 5 cost time: 1.5502729415893555
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.511 Vali Acc: 0.799 Test Loss: 0.511 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6083760261535645
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.681 Vali Acc: 0.819 Test Loss: 0.681 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.634127140045166
Epoch: 7, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.716 Vali Acc: 0.826 Test Loss: 0.716 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6134209632873535
Epoch: 8, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.671 Vali Acc: 0.843 Test Loss: 0.671 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.622391700744629
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.062 Vali Acc: 0.816 Test Loss: 1.062 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.643843173980713
Epoch: 10, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.684 Vali Acc: 0.823 Test Loss: 0.684 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6496853828430176
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.669 Vali Acc: 0.846 Test Loss: 0.669 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.493847131729126
Epoch: 12, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.088 Vali Acc: 0.778 Test Loss: 1.088 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5559823513031006
Epoch: 13, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.002 Vali Acc: 0.819 Test Loss: 1.002 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.610450029373169
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.773 Vali Acc: 0.863 Test Loss: 0.773 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 300330
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3653461933135986
Epoch: 1, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.672 Vali Acc: 0.713 Test Loss: 0.672 Test Acc: 0.713
Validation loss decreased (inf --> -0.713304).  Saving model ...
Epoch: 2 cost time: 1.5309503078460693
Epoch: 2, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.713304 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.4280776977539062
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.732 Vali Acc: 0.771 Test Loss: 0.732 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4537124633789062
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.443 Vali Acc: 0.857 Test Loss: 0.443 Test Acc: 0.857
Validation loss decreased (-0.808869 --> -0.856651).  Saving model ...
Epoch: 5 cost time: 1.4614648818969727
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.864 Vali Acc: 0.683 Test Loss: 0.864 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5097403526306152
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
Validation loss decreased (-0.856651 --> -0.870302).  Saving model ...
Epoch: 7 cost time: 1.546509027481079
Epoch: 7, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5441992282867432
Epoch: 8, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.512 Vali Acc: 0.846 Test Loss: 0.512 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5646014213562012
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.500398874282837
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.942 Vali Acc: 0.799 Test Loss: 0.942 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4314641952514648
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.421 Vali Acc: 0.734 Test Loss: 1.421 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3576972484588623
Epoch: 12, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.731 Vali Acc: 0.795 Test Loss: 0.731 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.397531270980835
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.843 Vali Acc: 0.829 Test Loss: 0.843 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3683936595916748
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.891 Vali Acc: 0.823 Test Loss: 0.891 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3794679641723633
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.854 Vali Acc: 0.846 Test Loss: 0.854 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4319360256195068
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.873 Vali Acc: 0.812 Test Loss: 0.873 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 300330
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.087353467941284
Epoch: 1, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.644 Vali Acc: 0.724 Test Loss: 0.644 Test Acc: 0.724
Validation loss decreased (inf --> -0.723543).  Saving model ...
Epoch: 2 cost time: 1.3053972721099854
Epoch: 2, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
Validation loss decreased (-0.723543 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.3881347179412842
Epoch: 3, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.498 Vali Acc: 0.823 Test Loss: 0.498 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4310626983642578
Epoch: 4, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.721 Vali Acc: 0.778 Test Loss: 0.721 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5313401222229004
Epoch: 5, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.383 Vali Acc: 0.826 Test Loss: 0.383 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5092291831970215
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.375 Vali Acc: 0.881 Test Loss: 0.375 Test Acc: 0.881
Validation loss decreased (-0.836173 --> -0.880542).  Saving model ...
Epoch: 7 cost time: 1.5183916091918945
Epoch: 7, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4486231803894043
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.665 Vali Acc: 0.727 Test Loss: 0.665 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2326445579528809
Epoch: 9, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.639 Vali Acc: 0.836 Test Loss: 0.639 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5484566688537598
Epoch: 10, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.806 Vali Acc: 0.816 Test Loss: 0.806 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4066364765167236
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.512 Vali Acc: 0.884 Test Loss: 0.512 Test Acc: 0.884
Validation loss decreased (-0.880542 --> -0.883954).  Saving model ...
Epoch: 12 cost time: 1.4562087059020996
Epoch: 12, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.869 Vali Acc: 0.710 Test Loss: 0.869 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5181617736816406
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.883 Vali Acc: 0.809 Test Loss: 0.883 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5477511882781982
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.867 Vali Acc: 0.805 Test Loss: 0.867 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6052782535552979
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.549 Vali Acc: 0.843 Test Loss: 0.549 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6109604835510254
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.598 Vali Acc: 0.836 Test Loss: 0.598 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5681359767913818
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5073070526123047
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.204 Vali Acc: 0.788 Test Loss: 1.204 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3992588520050049
Epoch: 19, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.068 Vali Acc: 0.853 Test Loss: 1.068 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2884583473205566
Epoch: 20, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.191 Vali Acc: 0.802 Test Loss: 1.191 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3658957481384277
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.189 Vali Acc: 0.744 Test Loss: 1.189 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 300330
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.223299026489258
Epoch: 1, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.561 Vali Acc: 0.747 Test Loss: 0.561 Test Acc: 0.747
Validation loss decreased (inf --> -0.747435).  Saving model ...
Epoch: 2 cost time: 1.188793659210205
Epoch: 2, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
Validation loss decreased (-0.747435 --> -0.778151).  Saving model ...
Epoch: 3 cost time: 1.3034052848815918
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.707 Vali Acc: 0.761 Test Loss: 0.707 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2874679565429688
Epoch: 4, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.711 Vali Acc: 0.778 Test Loss: 0.711 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2358863353729248
Epoch: 5, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.376 Vali Acc: 0.843 Test Loss: 0.376 Test Acc: 0.843
Validation loss decreased (-0.778151 --> -0.843000).  Saving model ...
Epoch: 6 cost time: 1.3160626888275146
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.534 Vali Acc: 0.778 Test Loss: 0.534 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2617475986480713
Epoch: 7, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.644 Vali Acc: 0.836 Test Loss: 0.644 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1989290714263916
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.410 Vali Acc: 0.846 Test Loss: 0.410 Test Acc: 0.846
Validation loss decreased (-0.843000 --> -0.846412).  Saving model ...
Epoch: 9 cost time: 1.2945516109466553
Epoch: 9, Steps: 17 | Train Loss: 0.430 Vali Loss: 1.147 Vali Acc: 0.683 Test Loss: 1.147 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.251554250717163
Epoch: 10, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.484 Vali Acc: 0.655 Test Loss: 1.484 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2567863464355469
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2359988689422607
Epoch: 12, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.740 Vali Acc: 0.833 Test Loss: 0.740 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.256011724472046
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3348820209503174
Epoch: 14, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.892 Vali Acc: 0.795 Test Loss: 0.892 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2623591423034668
Epoch: 15, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.678 Vali Acc: 0.795 Test Loss: 0.678 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2462384700775146
Epoch: 16, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.846412 --> -0.863476).  Saving model ...
Epoch: 17 cost time: 1.1568071842193604
Epoch: 17, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.796 Vali Acc: 0.826 Test Loss: 0.796 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2662010192871094
Epoch: 18, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.915 Vali Acc: 0.782 Test Loss: 0.915 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2519361972808838
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.979 Vali Acc: 0.799 Test Loss: 0.979 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2753949165344238
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.855 Vali Acc: 0.823 Test Loss: 0.855 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3246564865112305
Epoch: 21, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.363 Vali Acc: 0.768 Test Loss: 1.363 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2123477458953857
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.062 Vali Acc: 0.802 Test Loss: 1.062 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2449231147766113
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.148 Vali Acc: 0.809 Test Loss: 1.148 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1102581024169922
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.839 Vali Acc: 0.737 Test Loss: 1.839 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3483431339263916
Epoch: 25, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.799 Vali Acc: 0.874 Test Loss: 0.799 Test Acc: 0.874
Validation loss decreased (-0.863476 --> -0.873712).  Saving model ...
Epoch: 26 cost time: 1.296849012374878
Epoch: 26, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.280 Vali Acc: 0.761 Test Loss: 2.280 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3026788234710693
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.221 Vali Acc: 0.840 Test Loss: 1.221 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2957255840301514
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.657 Vali Acc: 0.724 Test Loss: 2.657 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2297334671020508
Epoch: 29, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.628 Vali Acc: 0.816 Test Loss: 1.628 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2958734035491943
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.837 Vali Acc: 0.799 Test Loss: 1.837 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1305756568908691
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.405 Vali Acc: 0.843 Test Loss: 1.405 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2641360759735107
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.613 Vali Acc: 0.805 Test Loss: 1.613 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3409900665283203
Epoch: 33, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.432 Vali Acc: 0.782 Test Loss: 2.432 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2541534900665283
Epoch: 34, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.315 Vali Acc: 0.785 Test Loss: 2.315 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.223634958267212
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.727 Vali Acc: 0.823 Test Loss: 1.727 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 300330
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5696887969970703
Epoch: 1, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.610 Vali Acc: 0.730 Test Loss: 0.610 Test Acc: 0.730
Validation loss decreased (inf --> -0.730369).  Saving model ...
Epoch: 2 cost time: 1.6085960865020752
Epoch: 2, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
Validation loss decreased (-0.730369 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.5710773468017578
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.812282 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 1.6384799480438232
Epoch: 4, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.728 Vali Acc: 0.758 Test Loss: 0.728 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6328577995300293
Epoch: 5, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 6 cost time: 1.6307380199432373
Epoch: 6, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.681 Vali Acc: 0.799 Test Loss: 0.681 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6934187412261963
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.545 Vali Acc: 0.836 Test Loss: 0.545 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6728522777557373
Epoch: 8, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.735 Vali Acc: 0.823 Test Loss: 0.735 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7621498107910156
Epoch: 9, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.622 Vali Acc: 0.843 Test Loss: 0.622 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.842997).  Saving model ...
Epoch: 10 cost time: 1.7334177494049072
Epoch: 10, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.680 Vali Acc: 0.741 Test Loss: 1.680 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7003297805786133
Epoch: 11, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.654723882675171
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6307594776153564
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.914 Vali Acc: 0.829 Test Loss: 0.914 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.50510835647583
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.629 Vali Acc: 0.727 Test Loss: 1.629 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.635953664779663
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.952 Vali Acc: 0.816 Test Loss: 0.952 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7301092147827148
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.780 Vali Acc: 0.877 Test Loss: 0.780 Test Acc: 0.877
Validation loss decreased (-0.842997 --> -0.877125).  Saving model ...
Epoch: 17 cost time: 1.5882999897003174
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.177 Vali Acc: 0.765 Test Loss: 1.177 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4610118865966797
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.078 Vali Acc: 0.826 Test Loss: 1.078 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.63987398147583
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.501 Vali Acc: 0.795 Test Loss: 1.501 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6541931629180908
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.631 Vali Acc: 0.703 Test Loss: 2.631 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7292566299438477
Epoch: 21, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.965 Vali Acc: 0.863 Test Loss: 0.965 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.803997278213501
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.929 Vali Acc: 0.775 Test Loss: 1.929 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7393057346343994
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.160 Vali Acc: 0.850 Test Loss: 1.160 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.647735834121704
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.271 Vali Acc: 0.823 Test Loss: 1.271 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5601184368133545
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.168 Vali Acc: 0.829 Test Loss: 1.168 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6371150016784668
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.255 Vali Acc: 0.833 Test Loss: 1.255 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 283946
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5402474403381348
Epoch: 1, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.615 Vali Acc: 0.720 Test Loss: 0.615 Test Acc: 0.720
Validation loss decreased (inf --> -0.720130).  Saving model ...
Epoch: 2 cost time: 1.608832597732544
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
Validation loss decreased (-0.720130 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 1.6136314868927002
Epoch: 3, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.362523078918457
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.627 Vali Acc: 0.782 Test Loss: 0.627 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4646637439727783
Epoch: 5, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.404 Vali Acc: 0.860 Test Loss: 0.404 Test Acc: 0.860
Validation loss decreased (-0.825934 --> -0.860064).  Saving model ...
Epoch: 6 cost time: 1.5427653789520264
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.692 Vali Acc: 0.792 Test Loss: 0.692 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4612319469451904
Epoch: 7, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.553 Vali Acc: 0.840 Test Loss: 0.553 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5443201065063477
Epoch: 8, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.417 Vali Acc: 0.635 Test Loss: 2.417 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5282042026519775
Epoch: 9, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.144 Vali Acc: 0.812 Test Loss: 1.144 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5849175453186035
Epoch: 10, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.359 Vali Acc: 0.703 Test Loss: 1.359 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6230170726776123
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.713 Vali Acc: 0.874 Test Loss: 0.713 Test Acc: 0.874
Validation loss decreased (-0.860064 --> -0.873713).  Saving model ...
Epoch: 12 cost time: 1.711488962173462
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.854 Vali Acc: 0.809 Test Loss: 0.854 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6131031513214111
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.810 Vali Acc: 0.809 Test Loss: 0.810 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6334927082061768
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.011 Vali Acc: 0.792 Test Loss: 1.011 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5732710361480713
Epoch: 15, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.056 Vali Acc: 0.795 Test Loss: 1.056 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4951236248016357
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.942 Vali Acc: 0.843 Test Loss: 0.942 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5283138751983643
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.900 Vali Acc: 0.829 Test Loss: 0.900 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4483890533447266
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.143 Vali Acc: 0.792 Test Loss: 1.143 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5354506969451904
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.990 Vali Acc: 0.819 Test Loss: 0.990 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5902185440063477
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.983 Vali Acc: 0.819 Test Loss: 0.983 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6124343872070312
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.878 Vali Acc: 0.840 Test Loss: 0.878 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 283946
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3780148029327393
Epoch: 1, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (inf --> -0.726956).  Saving model ...
Epoch: 2 cost time: 1.5131864547729492
Epoch: 2, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
Validation loss decreased (-0.726956 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 1.4536924362182617
Epoch: 3, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.578 Vali Acc: 0.788 Test Loss: 0.578 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.480072259902954
Epoch: 4, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.576 Vali Acc: 0.785 Test Loss: 0.576 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4156370162963867
Epoch: 5, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
Validation loss decreased (-0.815695 --> -0.819108).  Saving model ...
Epoch: 6 cost time: 1.4220163822174072
Epoch: 6, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3835327625274658
Epoch: 7, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.571 Vali Acc: 0.799 Test Loss: 0.571 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2604782581329346
Epoch: 8, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4715993404388428
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.452 Vali Acc: 0.846 Test Loss: 0.452 Test Acc: 0.846
Validation loss decreased (-0.819108 --> -0.846412).  Saving model ...
Epoch: 10 cost time: 1.4325132369995117
Epoch: 10, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.456 Vali Acc: 0.696 Test Loss: 1.456 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4954817295074463
Epoch: 11, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.779 Vali Acc: 0.809 Test Loss: 0.779 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4875354766845703
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.794 Vali Acc: 0.812 Test Loss: 0.794 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3526594638824463
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2901179790496826
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3094990253448486
Epoch: 15, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.844 Vali Acc: 0.816 Test Loss: 0.844 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3049359321594238
Epoch: 16, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.624 Vali Acc: 0.870 Test Loss: 0.624 Test Acc: 0.870
Validation loss decreased (-0.846412 --> -0.870301).  Saving model ...
Epoch: 17 cost time: 1.2974720001220703
Epoch: 17, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.897 Vali Acc: 0.809 Test Loss: 0.897 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3227510452270508
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.065 Vali Acc: 0.778 Test Loss: 1.065 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.355435848236084
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.846 Vali Acc: 0.840 Test Loss: 0.846 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.427520513534546
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.567 Vali Acc: 0.761 Test Loss: 1.567 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3750019073486328
Epoch: 21, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.675 Vali Acc: 0.853 Test Loss: 0.675 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3972642421722412
Epoch: 22, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.971 Vali Acc: 0.836 Test Loss: 0.971 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5306403636932373
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.190 Vali Acc: 0.829 Test Loss: 1.190 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4825210571289062
Epoch: 24, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.236 Vali Acc: 0.843 Test Loss: 1.236 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4497027397155762
Epoch: 25, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.272 Vali Acc: 0.819 Test Loss: 1.272 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4516613483428955
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.376 Vali Acc: 0.840 Test Loss: 1.376 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 283946
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0523860454559326
Epoch: 1, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.533 Vali Acc: 0.754 Test Loss: 0.533 Test Acc: 0.754
Validation loss decreased (inf --> -0.754261).  Saving model ...
Epoch: 2 cost time: 1.326066493988037
Epoch: 2, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.584 Vali Acc: 0.768 Test Loss: 0.584 Test Acc: 0.768
Validation loss decreased (-0.754261 --> -0.767912).  Saving model ...
Epoch: 3 cost time: 1.3404626846313477
Epoch: 3, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
Validation loss decreased (-0.767912 --> -0.774738).  Saving model ...
Epoch: 4 cost time: 1.2671217918395996
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
Validation loss decreased (-0.774738 --> -0.819108).  Saving model ...
Epoch: 5 cost time: 1.1646885871887207
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829347).  Saving model ...
Epoch: 6 cost time: 1.283630132675171
Epoch: 6, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.693 Vali Acc: 0.758 Test Loss: 0.693 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.283329725265503
Epoch: 7, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.898 Vali Acc: 0.744 Test Loss: 0.898 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2766661643981934
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.887 Vali Acc: 0.734 Test Loss: 0.887 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2819552421569824
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832759).  Saving model ...
Epoch: 10 cost time: 1.301529884338379
Epoch: 10, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.136 Vali Acc: 0.724 Test Loss: 1.136 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2711734771728516
Epoch: 11, Steps: 17 | Train Loss: 0.420 Vali Loss: 1.034 Vali Acc: 0.751 Test Loss: 1.034 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2260746955871582
Epoch: 12, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.233 Vali Acc: 0.717 Test Loss: 1.233 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2984397411346436
Epoch: 13, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.565 Vali Acc: 0.836 Test Loss: 0.565 Test Acc: 0.836
Validation loss decreased (-0.832759 --> -0.836172).  Saving model ...
Epoch: 14 cost time: 1.2729268074035645
Epoch: 14, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.162 Vali Acc: 0.744 Test Loss: 1.162 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.270373821258545
Epoch: 15, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.131 Vali Acc: 0.747 Test Loss: 1.131 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2328510284423828
Epoch: 16, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.501 Vali Acc: 0.874 Test Loss: 0.501 Test Acc: 0.874
Validation loss decreased (-0.836172 --> -0.873715).  Saving model ...
Epoch: 17 cost time: 1.3041231632232666
Epoch: 17, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.852 Vali Acc: 0.816 Test Loss: 0.852 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2688007354736328
Epoch: 18, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.349 Vali Acc: 0.717 Test Loss: 1.349 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2031562328338623
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.702 Vali Acc: 0.857 Test Loss: 0.702 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2778244018554688
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.246 Vali Acc: 0.802 Test Loss: 1.246 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1680958271026611
Epoch: 21, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.870 Vali Acc: 0.812 Test Loss: 0.870 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.283975601196289
Epoch: 22, Steps: 17 | Train Loss: 0.131 Vali Loss: 2.661 Vali Acc: 0.730 Test Loss: 2.661 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2147948741912842
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.784 Vali Acc: 0.870 Test Loss: 0.784 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2108631134033203
Epoch: 24, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.263 Vali Acc: 0.802 Test Loss: 1.263 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3323428630828857
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.248 Vali Acc: 0.816 Test Loss: 1.248 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3868348598480225
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.003 Vali Acc: 0.843 Test Loss: 1.003 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 283946
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.115968704223633
Epoch: 1, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.1787474155426025
Epoch: 2, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2331180572509766
Epoch: 3, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.217465877532959
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
Validation loss decreased (-0.815695 --> -0.853237).  Saving model ...
Epoch: 5 cost time: 1.3132758140563965
Epoch: 5, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.608 Vali Acc: 0.771 Test Loss: 0.608 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.216888427734375
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.407 Vali Acc: 0.853 Test Loss: 0.407 Test Acc: 0.853
Validation loss decreased (-0.853237 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.373621940612793
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.635 Vali Acc: 0.799 Test Loss: 0.635 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.38627028465271
Epoch: 8, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.632 Vali Acc: 0.799 Test Loss: 0.632 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4408512115478516
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4233996868133545
Epoch: 10, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1708383560180664
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3204905986785889
Epoch: 12, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3668956756591797
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.689 Vali Acc: 0.843 Test Loss: 0.689 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3452391624450684
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.746 Vali Acc: 0.805 Test Loss: 0.746 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3362696170806885
Epoch: 15, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.459 Vali Acc: 0.860 Test Loss: 0.459 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860064).  Saving model ...
Epoch: 16 cost time: 1.328463077545166
Epoch: 16, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.082 Vali Acc: 0.737 Test Loss: 1.082 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3013219833374023
Epoch: 17, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.711 Vali Acc: 0.853 Test Loss: 0.711 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3849520683288574
Epoch: 18, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.852 Vali Acc: 0.792 Test Loss: 0.852 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5080015659332275
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.102 Vali Acc: 0.795 Test Loss: 1.102 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3743488788604736
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.804 Vali Acc: 0.833 Test Loss: 0.804 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4318511486053467
Epoch: 21, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.847 Vali Acc: 0.823 Test Loss: 0.847 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3937697410583496
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.146 Vali Acc: 0.799 Test Loss: 1.146 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3411469459533691
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.743 Vali Acc: 0.867 Test Loss: 0.743 Test Acc: 0.867
Validation loss decreased (-0.860064 --> -0.866887).  Saving model ...
Epoch: 24 cost time: 1.370354175567627
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.978 Vali Acc: 0.823 Test Loss: 0.978 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3919470310211182
Epoch: 25, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.020 Vali Acc: 0.850 Test Loss: 1.020 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.33785080909729
Epoch: 26, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.909 Vali Acc: 0.867 Test Loss: 0.909 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.374591588973999
Epoch: 27, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.023 Vali Acc: 0.809 Test Loss: 1.023 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.394486665725708
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2096037864685059
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.904 Vali Acc: 0.853 Test Loss: 0.904 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4001781940460205
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.221 Vali Acc: 0.782 Test Loss: 1.221 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3907322883605957
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.016 Vali Acc: 0.823 Test Loss: 1.016 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4279367923736572
Epoch: 32, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.848 Vali Acc: 0.836 Test Loss: 0.848 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3442602157592773
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.833 Vali Acc: 0.846 Test Loss: 0.833 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 387754
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.107936382293701
Epoch: 1, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.500 Vali Acc: 0.802 Test Loss: 0.500 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 1.1873204708099365
Epoch: 2, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.535 Vali Acc: 0.799 Test Loss: 0.535 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.308828592300415
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.650 Vali Acc: 0.724 Test Loss: 0.650 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2258412837982178
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.511 Vali Acc: 0.846 Test Loss: 0.511 Test Acc: 0.846
Validation loss decreased (-0.802043 --> -0.846411).  Saving model ...
Epoch: 5 cost time: 1.4325001239776611
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3784511089324951
Epoch: 6, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.403 Vali Acc: 0.874 Test Loss: 0.403 Test Acc: 0.874
Validation loss decreased (-0.846411 --> -0.873716).  Saving model ...
Epoch: 7 cost time: 1.4700233936309814
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.350590705871582
Epoch: 8, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.869 Vali Acc: 0.751 Test Loss: 0.869 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2785496711730957
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.800 Vali Acc: 0.727 Test Loss: 0.800 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2534422874450684
Epoch: 10, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.521 Vali Acc: 0.836 Test Loss: 0.521 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2118284702301025
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.801 Vali Acc: 0.805 Test Loss: 0.801 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.273569107055664
Epoch: 12, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3021936416625977
Epoch: 13, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2395126819610596
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.605 Vali Acc: 0.802 Test Loss: 0.605 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4175925254821777
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4439013004302979
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.637 Vali Acc: 0.823 Test Loss: 0.637 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 387754
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.998150110244751
Epoch: 1, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.510 Vali Acc: 0.785 Test Loss: 0.510 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 1.2477920055389404
Epoch: 2, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
Validation loss decreased (-0.784978 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.2479298114776611
Epoch: 3, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2479147911071777
Epoch: 4, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.510 Vali Acc: 0.840 Test Loss: 0.510 Test Acc: 0.840
Validation loss decreased (-0.808869 --> -0.839585).  Saving model ...
Epoch: 5 cost time: 1.259812355041504
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.660 Vali Acc: 0.765 Test Loss: 0.660 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2844626903533936
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.399 Vali Acc: 0.857 Test Loss: 0.399 Test Acc: 0.857
Validation loss decreased (-0.839585 --> -0.856651).  Saving model ...
Epoch: 7 cost time: 1.195225477218628
Epoch: 7, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.437 Vali Acc: 0.846 Test Loss: 0.437 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.303192138671875
Epoch: 8, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.773 Vali Acc: 0.771 Test Loss: 0.773 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.348555564880371
Epoch: 9, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.610 Vali Acc: 0.788 Test Loss: 0.610 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3087825775146484
Epoch: 10, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1764628887176514
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.628 Vali Acc: 0.785 Test Loss: 0.628 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2792437076568604
Epoch: 12, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.087 Vali Acc: 0.710 Test Loss: 1.087 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2440426349639893
Epoch: 13, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.098 Vali Acc: 0.747 Test Loss: 1.098 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2298235893249512
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2146263122558594
Epoch: 15, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.665 Vali Acc: 0.788 Test Loss: 0.665 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.16725754737854
Epoch: 16, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.840 Vali Acc: 0.782 Test Loss: 0.840 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 387754
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0478672981262207
Epoch: 1, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.478 Vali Acc: 0.792 Test Loss: 0.478 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.180528163909912
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.516 Vali Acc: 0.805 Test Loss: 0.516 Test Acc: 0.805
Validation loss decreased (-0.791804 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 1.2048194408416748
Epoch: 3, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.1858651638031006
Epoch: 4, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.463 Vali Acc: 0.860 Test Loss: 0.463 Test Acc: 0.860
Validation loss decreased (-0.819108 --> -0.860064).  Saving model ...
Epoch: 5 cost time: 1.1314761638641357
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.513 Vali Acc: 0.802 Test Loss: 0.513 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2120494842529297
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1219353675842285
Epoch: 7, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.443 Vali Acc: 0.846 Test Loss: 0.443 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2896547317504883
Epoch: 8, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.662 Vali Acc: 0.785 Test Loss: 0.662 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0714566707611084
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2417640686035156
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.666 Vali Acc: 0.771 Test Loss: 0.666 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2456881999969482
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2039575576782227
Epoch: 12, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2245523929595947
Epoch: 13, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1068758964538574
Epoch: 14, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.582 Vali Acc: 0.805 Test Loss: 0.582 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 387754
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.348600149154663
Epoch: 1, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.24934983253479
Epoch: 2, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.466651439666748
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.518 Vali Acc: 0.802 Test Loss: 0.518 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3734502792358398
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.408 Vali Acc: 0.853 Test Loss: 0.408 Test Acc: 0.853
Validation loss decreased (-0.829347 --> -0.853238).  Saving model ...
Epoch: 5 cost time: 1.3449900150299072
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.330212116241455
Epoch: 6, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866890).  Saving model ...
Epoch: 7 cost time: 1.1375041007995605
Epoch: 7, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2533900737762451
Epoch: 8, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3962140083312988
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.318509817123413
Epoch: 10, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.362617015838623
Epoch: 11, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3454387187957764
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.567 Vali Acc: 0.843 Test Loss: 0.567 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3009028434753418
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.954 Vali Acc: 0.799 Test Loss: 0.954 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2866370677947998
Epoch: 14, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.689 Vali Acc: 0.802 Test Loss: 0.689 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3473453521728516
Epoch: 15, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2359225749969482
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.676 Vali Acc: 0.809 Test Loss: 0.676 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 256682
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.005202054977417
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.2964000701904297
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.623 Vali Acc: 0.737 Test Loss: 0.623 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.357010841369629
Epoch: 3, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.532 Vali Acc: 0.768 Test Loss: 0.532 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2890825271606445
Epoch: 4, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.392 Vali Acc: 0.853 Test Loss: 0.392 Test Acc: 0.853
Validation loss decreased (-0.829347 --> -0.853238).  Saving model ...
Epoch: 5 cost time: 1.2981743812561035
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.095 Vali Acc: 0.648 Test Loss: 1.095 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2077462673187256
Epoch: 6, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866890).  Saving model ...
Epoch: 7 cost time: 1.2154521942138672
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.743 Vali Acc: 0.710 Test Loss: 0.743 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2007982730865479
Epoch: 8, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.607 Vali Acc: 0.843 Test Loss: 0.607 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2021231651306152
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2489657402038574
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.727 Vali Acc: 0.785 Test Loss: 0.727 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.17283296585083
Epoch: 11, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.510 Vali Acc: 0.812 Test Loss: 0.510 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2414371967315674
Epoch: 12, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.640 Vali Acc: 0.805 Test Loss: 0.640 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.296001672744751
Epoch: 13, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.777 Vali Acc: 0.795 Test Loss: 0.777 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2894928455352783
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.732 Vali Acc: 0.795 Test Loss: 0.732 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.26408052444458
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.258605718612671
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.633 Vali Acc: 0.802 Test Loss: 0.633 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 256682
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8720810413360596
Epoch: 1, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.437 Vali Acc: 0.816 Test Loss: 0.437 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.0941219329833984
Epoch: 2, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1934583187103271
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.589 Vali Acc: 0.758 Test Loss: 0.589 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1521484851837158
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.412 Vali Acc: 0.853 Test Loss: 0.412 Test Acc: 0.853
Validation loss decreased (-0.815695 --> -0.853238).  Saving model ...
Epoch: 5 cost time: 1.3011658191680908
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.796 Vali Acc: 0.713 Test Loss: 0.796 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2424297332763672
Epoch: 6, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.404 Vali Acc: 0.860 Test Loss: 0.404 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860064).  Saving model ...
Epoch: 7 cost time: 1.2152624130249023
Epoch: 7, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.572 Vali Acc: 0.782 Test Loss: 0.572 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.152176856994629
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
Validation loss decreased (-0.860064 --> -0.866890).  Saving model ...
Epoch: 9 cost time: 1.2296531200408936
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2520136833190918
Epoch: 10, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.736 Vali Acc: 0.778 Test Loss: 0.736 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2210869789123535
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.475 Vali Acc: 0.857 Test Loss: 0.475 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1384751796722412
Epoch: 12, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0358588695526123
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.882 Vali Acc: 0.734 Test Loss: 0.882 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.248082160949707
Epoch: 14, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2540302276611328
Epoch: 15, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.908 Vali Acc: 0.761 Test Loss: 0.908 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.194674015045166
Epoch: 16, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.718 Vali Acc: 0.792 Test Loss: 0.718 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2206602096557617
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.728 Vali Acc: 0.782 Test Loss: 0.728 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1578319072723389
Epoch: 18, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.165 Vali Acc: 0.710 Test Loss: 1.165 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 256682
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.015239953994751
Epoch: 1, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.417 Vali Acc: 0.843 Test Loss: 0.417 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 1.1759371757507324
Epoch: 2, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1689553260803223
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.635 Vali Acc: 0.741 Test Loss: 0.635 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.127941608428955
Epoch: 4, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1116530895233154
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.733 Vali Acc: 0.737 Test Loss: 0.733 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0557401180267334
Epoch: 6, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.466 Vali Acc: 0.812 Test Loss: 0.466 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0911991596221924
Epoch: 7, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1350421905517578
Epoch: 8, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
Validation loss decreased (-0.842999 --> -0.849825).  Saving model ...
Epoch: 9 cost time: 1.1011567115783691
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.075575590133667
Epoch: 10, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1167457103729248
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.388 Vali Acc: 0.846 Test Loss: 0.388 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0735359191894531
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.467 Vali Acc: 0.846 Test Loss: 0.467 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1150474548339844
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.380 Vali Acc: 0.659 Test Loss: 1.380 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1063668727874756
Epoch: 14, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.531 Vali Acc: 0.857 Test Loss: 0.531 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856650).  Saving model ...
Epoch: 15 cost time: 1.109931230545044
Epoch: 15, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.676 Vali Acc: 0.805 Test Loss: 0.676 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.138601541519165
Epoch: 16, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.894 Vali Acc: 0.737 Test Loss: 0.894 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0837557315826416
Epoch: 17, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.791 Vali Acc: 0.792 Test Loss: 0.791 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0572547912597656
Epoch: 18, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0296425819396973
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.623 Vali Acc: 0.843 Test Loss: 0.623 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.123910903930664
Epoch: 20, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.475 Vali Acc: 0.846 Test Loss: 0.475 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1366150379180908
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.893 Vali Acc: 0.799 Test Loss: 0.893 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1128246784210205
Epoch: 22, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.754 Vali Acc: 0.816 Test Loss: 0.754 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.088355302810669
Epoch: 23, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.938 Vali Acc: 0.771 Test Loss: 0.938 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0919764041900635
Epoch: 24, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.703 Vali Acc: 0.846 Test Loss: 0.703 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 256682
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.091295003890991
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.417 Vali Acc: 0.823 Test Loss: 0.417 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.2226486206054688
Epoch: 2, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.540 Vali Acc: 0.788 Test Loss: 0.540 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2641518115997314
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.716 Vali Acc: 0.727 Test Loss: 0.716 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2171201705932617
Epoch: 4, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.516 Vali Acc: 0.805 Test Loss: 0.516 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3144397735595703
Epoch: 5, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2080352306365967
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.459 Vali Acc: 0.846 Test Loss: 0.459 Test Acc: 0.846
Validation loss decreased (-0.822521 --> -0.846412).  Saving model ...
Epoch: 7 cost time: 1.2017126083374023
Epoch: 7, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.790 Vali Acc: 0.771 Test Loss: 0.790 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.311352252960205
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.592 Vali Acc: 0.823 Test Loss: 0.592 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3558776378631592
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
Validation loss decreased (-0.846412 --> -0.870302).  Saving model ...
Epoch: 10 cost time: 1.32252836227417
Epoch: 10, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.278 Vali Acc: 0.666 Test Loss: 1.278 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3645095825195312
Epoch: 11, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2777433395385742
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.872 Vali Acc: 0.778 Test Loss: 0.872 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2242002487182617
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2758231163024902
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.820 Vali Acc: 0.765 Test Loss: 0.820 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1722321510314941
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.677 Vali Acc: 0.843 Test Loss: 0.677 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3563432693481445
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3286755084991455
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.654 Vali Acc: 0.819 Test Loss: 0.654 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3656516075134277
Epoch: 18, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.953 Vali Acc: 0.812 Test Loss: 0.953 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3928203582763672
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.731 Vali Acc: 0.816 Test Loss: 0.731 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 191146
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0737407207489014
Epoch: 1, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.422 Vali Acc: 0.823 Test Loss: 0.422 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.294574499130249
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.530 Vali Acc: 0.799 Test Loss: 0.530 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.237943172454834
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.830 Vali Acc: 0.700 Test Loss: 0.830 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2757139205932617
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.520 Vali Acc: 0.802 Test Loss: 0.520 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2352516651153564
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3501315116882324
Epoch: 6, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.406 Vali Acc: 0.853 Test Loss: 0.406 Test Acc: 0.853
Validation loss decreased (-0.822521 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.26896071434021
Epoch: 7, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3074941635131836
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.597 Vali Acc: 0.799 Test Loss: 0.597 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2651922702789307
Epoch: 9, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
Validation loss decreased (-0.853238 --> -0.877128).  Saving model ...
Epoch: 10 cost time: 1.2577266693115234
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.102 Vali Acc: 0.676 Test Loss: 1.102 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2572886943817139
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.474 Vali Acc: 0.874 Test Loss: 0.474 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2074170112609863
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.108 Vali Acc: 0.717 Test Loss: 1.108 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1616652011871338
Epoch: 13, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.255220651626587
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.696 Vali Acc: 0.843 Test Loss: 0.696 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2597086429595947
Epoch: 15, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.569 Vali Acc: 0.840 Test Loss: 0.569 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1972556114196777
Epoch: 16, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.619 Vali Acc: 0.826 Test Loss: 0.619 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.260331392288208
Epoch: 17, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.512 Vali Acc: 0.843 Test Loss: 0.512 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3181736469268799
Epoch: 18, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.361 Vali Acc: 0.792 Test Loss: 1.361 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2805366516113281
Epoch: 19, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.722 Vali Acc: 0.857 Test Loss: 0.722 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 191146
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.854267120361328
Epoch: 1, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.426 Vali Acc: 0.829 Test Loss: 0.426 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.0962963104248047
Epoch: 2, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1740953922271729
Epoch: 3, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.820 Vali Acc: 0.683 Test Loss: 0.820 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2631065845489502
Epoch: 4, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.551 Vali Acc: 0.799 Test Loss: 0.551 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2686560153961182
Epoch: 5, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1865451335906982
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.472 Vali Acc: 0.805 Test Loss: 0.472 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.170881986618042
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.481 Vali Acc: 0.843 Test Loss: 0.481 Test Acc: 0.843
Validation loss decreased (-0.829347 --> -0.842999).  Saving model ...
Epoch: 8 cost time: 1.0721144676208496
Epoch: 8, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.613 Vali Acc: 0.792 Test Loss: 0.613 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0776665210723877
Epoch: 9, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.487 Vali Acc: 0.846 Test Loss: 0.487 Test Acc: 0.846
Validation loss decreased (-0.842999 --> -0.846412).  Saving model ...
Epoch: 10 cost time: 1.1169326305389404
Epoch: 10, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.863 Vali Acc: 0.754 Test Loss: 0.863 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0940091609954834
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0965428352355957
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.485 Vali Acc: 0.846 Test Loss: 0.485 Test Acc: 0.846
Validation loss decreased (-0.846412 --> -0.846412).  Saving model ...
Epoch: 13 cost time: 1.1017272472381592
Epoch: 13, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.505 Vali Acc: 0.840 Test Loss: 0.505 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1982622146606445
Epoch: 14, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.903 Vali Acc: 0.751 Test Loss: 0.903 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3145623207092285
Epoch: 15, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.659 Vali Acc: 0.819 Test Loss: 0.659 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3030500411987305
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2879724502563477
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.688 Vali Acc: 0.812 Test Loss: 0.688 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2998831272125244
Epoch: 18, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2666752338409424
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.828 Vali Acc: 0.785 Test Loss: 0.828 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.250030279159546
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.018 Vali Acc: 0.747 Test Loss: 1.018 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.280078649520874
Epoch: 21, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.525 Vali Acc: 0.863 Test Loss: 0.525 Test Acc: 0.863
Validation loss decreased (-0.846412 --> -0.863476).  Saving model ...
Epoch: 22 cost time: 1.282463788986206
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.874 Vali Acc: 0.785 Test Loss: 0.874 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3015031814575195
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.828 Vali Acc: 0.823 Test Loss: 0.828 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.194974660873413
Epoch: 24, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.595 Vali Acc: 0.863 Test Loss: 0.595 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1974034309387207
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3237342834472656
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.775 Vali Acc: 0.843 Test Loss: 0.775 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.273315668106079
Epoch: 27, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1677372455596924
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.690 Vali Acc: 0.840 Test Loss: 0.690 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.211644172668457
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.875 Vali Acc: 0.853 Test Loss: 0.875 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2063281536102295
Epoch: 30, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2250487804412842
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.751 Vali Acc: 0.853 Test Loss: 0.751 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 191146
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6340270042419434
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.0393385887145996
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
Validation loss decreased (-0.815695 --> -0.832759).  Saving model ...
Epoch: 3 cost time: 1.0226898193359375
Epoch: 3, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.455 Vali Acc: 0.795 Test Loss: 0.455 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0021545886993408
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.601 Vali Acc: 0.778 Test Loss: 0.601 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.116894006729126
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
Validation loss decreased (-0.832759 --> -0.849825).  Saving model ...
Epoch: 6 cost time: 0.9899070262908936
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.420 Vali Acc: 0.823 Test Loss: 0.420 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1635417938232422
Epoch: 7, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.414 Vali Acc: 0.857 Test Loss: 0.414 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856651).  Saving model ...
Epoch: 8 cost time: 1.1863279342651367
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.558 Vali Acc: 0.799 Test Loss: 0.558 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1664113998413086
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.542 Vali Acc: 0.836 Test Loss: 0.542 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2492072582244873
Epoch: 10, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1442222595214844
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1614177227020264
Epoch: 12, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.850 Vali Acc: 0.782 Test Loss: 0.850 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1693909168243408
Epoch: 13, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.084301233291626
Epoch: 14, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.795 Vali Acc: 0.782 Test Loss: 0.795 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0867176055908203
Epoch: 15, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.542 Vali Acc: 0.795 Test Loss: 0.542 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1758999824523926
Epoch: 16, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.483 Vali Acc: 0.846 Test Loss: 0.483 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0641653537750244
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.159 Vali Acc: 0.683 Test Loss: 1.159 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 191146
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1157760620117188
Epoch: 1, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.548 Vali Acc: 0.720 Test Loss: 0.548 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 1.2587330341339111
Epoch: 2, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.762 Vali Acc: 0.703 Test Loss: 0.762 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.348093032836914
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.654 Vali Acc: 0.765 Test Loss: 0.654 Test Acc: 0.765
Validation loss decreased (-0.720131 --> -0.764499).  Saving model ...
Epoch: 4 cost time: 1.247262716293335
Epoch: 4, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.582 Vali Acc: 0.768 Test Loss: 0.582 Test Acc: 0.768
Validation loss decreased (-0.764499 --> -0.767912).  Saving model ...
Epoch: 5 cost time: 1.3314564228057861
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.462 Vali Acc: 0.826 Test Loss: 0.462 Test Acc: 0.826
Validation loss decreased (-0.767912 --> -0.825934).  Saving model ...
Epoch: 6 cost time: 1.2022063732147217
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.774 Vali Acc: 0.696 Test Loss: 0.774 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.291039228439331
Epoch: 7, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3267292976379395
Epoch: 8, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.382124900817871
Epoch: 9, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.660 Vali Acc: 0.792 Test Loss: 0.660 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3196446895599365
Epoch: 10, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.526 Vali Acc: 0.823 Test Loss: 0.526 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2775318622589111
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.177116870880127
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.885 Vali Acc: 0.778 Test Loss: 0.885 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0976285934448242
Epoch: 13, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1452934741973877
Epoch: 14, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.686 Vali Acc: 0.853 Test Loss: 0.686 Test Acc: 0.853
Validation loss decreased (-0.825934 --> -0.853235).  Saving model ...
Epoch: 15 cost time: 1.257411241531372
Epoch: 15, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2395110130310059
Epoch: 16, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.012 Vali Acc: 0.782 Test Loss: 1.012 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1112303733825684
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.702 Vali Acc: 0.857 Test Loss: 0.702 Test Acc: 0.857
Validation loss decreased (-0.853235 --> -0.856648).  Saving model ...
Epoch: 18 cost time: 1.3947339057922363
Epoch: 18, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.784 Vali Acc: 0.829 Test Loss: 0.784 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2960789203643799
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3236134052276611
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.927 Vali Acc: 0.805 Test Loss: 0.927 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2519419193267822
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.899 Vali Acc: 0.816 Test Loss: 0.899 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3269760608673096
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.334083080291748
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.177 Vali Acc: 0.826 Test Loss: 1.177 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2828433513641357
Epoch: 24, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.759 Vali Acc: 0.823 Test Loss: 0.759 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2478177547454834
Epoch: 25, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.913 Vali Acc: 0.816 Test Loss: 0.913 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3506629467010498
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3129799365997314
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.928 Vali Acc: 0.809 Test Loss: 0.928 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 158378
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.103663682937622
Epoch: 1, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.544 Vali Acc: 0.720 Test Loss: 0.544 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 1.2147200107574463
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.752 Vali Acc: 0.706 Test Loss: 0.752 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2056424617767334
Epoch: 3, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.664 Vali Acc: 0.747 Test Loss: 0.664 Test Acc: 0.747
Validation loss decreased (-0.720131 --> -0.747434).  Saving model ...
Epoch: 4 cost time: 1.1773743629455566
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.630 Vali Acc: 0.744 Test Loss: 0.630 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2216286659240723
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.447 Vali Acc: 0.840 Test Loss: 0.447 Test Acc: 0.840
Validation loss decreased (-0.747434 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 1.3159801959991455
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.736 Vali Acc: 0.700 Test Loss: 0.736 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2475271224975586
Epoch: 7, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.594 Vali Acc: 0.795 Test Loss: 0.594 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2938439846038818
Epoch: 8, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
Validation loss decreased (-0.839586 --> -0.866890).  Saving model ...
Epoch: 9 cost time: 1.318877935409546
Epoch: 9, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.895 Vali Acc: 0.761 Test Loss: 0.895 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1738219261169434
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.802 Vali Acc: 0.724 Test Loss: 0.802 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2202861309051514
Epoch: 11, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.238624095916748
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.769 Vali Acc: 0.812 Test Loss: 0.769 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0564355850219727
Epoch: 13, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.769 Vali Acc: 0.771 Test Loss: 0.769 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1855008602142334
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.683 Vali Acc: 0.840 Test Loss: 0.683 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1587693691253662
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.689 Vali Acc: 0.829 Test Loss: 0.689 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1792943477630615
Epoch: 16, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.922 Vali Acc: 0.768 Test Loss: 0.922 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2477030754089355
Epoch: 17, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.561 Vali Acc: 0.860 Test Loss: 0.561 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3093464374542236
Epoch: 18, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.071 Vali Acc: 0.840 Test Loss: 1.071 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 158378
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.883143663406372
Epoch: 1, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.558 Vali Acc: 0.710 Test Loss: 0.558 Test Acc: 0.710
Validation loss decreased (inf --> -0.709892).  Saving model ...
Epoch: 2 cost time: 1.0968828201293945
Epoch: 2, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.712 Vali Acc: 0.700 Test Loss: 0.712 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1446402072906494
Epoch: 3, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
Validation loss decreased (-0.709892 --> -0.740609).  Saving model ...
Epoch: 4 cost time: 1.0764119625091553
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.534 Vali Acc: 0.782 Test Loss: 0.534 Test Acc: 0.782
Validation loss decreased (-0.740609 --> -0.781565).  Saving model ...
Epoch: 5 cost time: 1.2070691585540771
Epoch: 5, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.504 Vali Acc: 0.792 Test Loss: 0.504 Test Acc: 0.792
Validation loss decreased (-0.781565 --> -0.791804).  Saving model ...
Epoch: 6 cost time: 1.1842031478881836
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.637 Vali Acc: 0.730 Test Loss: 0.637 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1832776069641113
Epoch: 7, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.645 Vali Acc: 0.768 Test Loss: 0.645 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1970419883728027
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.791804 --> -0.815694).  Saving model ...
Epoch: 9 cost time: 1.1726558208465576
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
Validation loss decreased (-0.815694 --> -0.825933).  Saving model ...
Epoch: 10 cost time: 1.2193994522094727
Epoch: 10, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.700 Vali Acc: 0.758 Test Loss: 0.700 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1375892162322998
Epoch: 11, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.478 Vali Acc: 0.846 Test Loss: 0.478 Test Acc: 0.846
Validation loss decreased (-0.825933 --> -0.846412).  Saving model ...
Epoch: 12 cost time: 1.1555631160736084
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.744 Vali Acc: 0.785 Test Loss: 0.744 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0771033763885498
Epoch: 13, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.054 Vali Acc: 0.717 Test Loss: 1.054 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.091935157775879
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.846412 --> -0.849824).  Saving model ...
Epoch: 15 cost time: 1.1436142921447754
Epoch: 15, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.610 Vali Acc: 0.836 Test Loss: 0.610 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.181349754333496
Epoch: 16, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0948750972747803
Epoch: 17, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
Validation loss decreased (-0.849824 --> -0.877128).  Saving model ...
Epoch: 18 cost time: 1.2306315898895264
Epoch: 18, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.006 Vali Acc: 0.785 Test Loss: 1.006 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.163501262664795
Epoch: 19, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1666309833526611
Epoch: 20, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.932 Vali Acc: 0.802 Test Loss: 0.932 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1865150928497314
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.673 Vali Acc: 0.843 Test Loss: 0.673 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1306955814361572
Epoch: 22, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.909 Vali Acc: 0.795 Test Loss: 0.909 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1659486293792725
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.908 Vali Acc: 0.805 Test Loss: 0.908 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.031097173690796
Epoch: 24, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
Validation loss decreased (-0.877128 --> -0.883954).  Saving model ...
Epoch: 25 cost time: 1.1274011135101318
Epoch: 25, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.902 Vali Acc: 0.802 Test Loss: 0.902 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.112769365310669
Epoch: 26, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.054 Vali Acc: 0.782 Test Loss: 1.054 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0337855815887451
Epoch: 27, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.030 Vali Acc: 0.819 Test Loss: 1.030 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1381149291992188
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.801 Vali Acc: 0.843 Test Loss: 0.801 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1918187141418457
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.935 Vali Acc: 0.826 Test Loss: 0.935 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1650185585021973
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.883 Vali Acc: 0.816 Test Loss: 0.883 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1777019500732422
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.920 Vali Acc: 0.833 Test Loss: 0.920 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1387944221496582
Epoch: 32, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.053 Vali Acc: 0.812 Test Loss: 1.053 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1807632446289062
Epoch: 33, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.654 Vali Acc: 0.881 Test Loss: 0.654 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2047452926635742
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.484 Vali Acc: 0.761 Test Loss: 1.484 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 158378
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8372044563293457
Epoch: 1, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.561 Vali Acc: 0.713 Test Loss: 0.561 Test Acc: 0.713
Validation loss decreased (inf --> -0.713305).  Saving model ...
Epoch: 2 cost time: 1.0781879425048828
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.686 Vali Acc: 0.710 Test Loss: 0.686 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1202380657196045
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
Validation loss decreased (-0.713305 --> -0.726956).  Saving model ...
Epoch: 4 cost time: 1.140962839126587
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.570 Vali Acc: 0.778 Test Loss: 0.570 Test Acc: 0.778
Validation loss decreased (-0.726956 --> -0.778151).  Saving model ...
Epoch: 5 cost time: 1.0579888820648193
Epoch: 5, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.778151 --> -0.819108).  Saving model ...
Epoch: 6 cost time: 1.1918509006500244
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.862 Vali Acc: 0.666 Test Loss: 0.862 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.035491704940796
Epoch: 7, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.613 Vali Acc: 0.785 Test Loss: 0.613 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.102867603302002
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829346).  Saving model ...
Epoch: 9 cost time: 1.0580699443817139
Epoch: 9, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9852840900421143
Epoch: 10, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.706 Vali Acc: 0.747 Test Loss: 0.706 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0773844718933105
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0985958576202393
Epoch: 12, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.686 Vali Acc: 0.799 Test Loss: 0.686 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.104161262512207
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0116760730743408
Epoch: 14, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.572 Vali Acc: 0.823 Test Loss: 0.572 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0635488033294678
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.456 Vali Acc: 0.840 Test Loss: 0.456 Test Acc: 0.840
Validation loss decreased (-0.829346 --> -0.839586).  Saving model ...
Epoch: 16 cost time: 1.050581932067871
Epoch: 16, Steps: 17 | Train Loss: 0.280 Vali Loss: 1.047 Vali Acc: 0.724 Test Loss: 1.047 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2097442150115967
Epoch: 17, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.416 Vali Acc: 0.867 Test Loss: 0.416 Test Acc: 0.867
Validation loss decreased (-0.839586 --> -0.866890).  Saving model ...
Epoch: 18 cost time: 1.1560659408569336
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.178 Vali Acc: 0.741 Test Loss: 1.178 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1402060985565186
Epoch: 19, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.480 Vali Acc: 0.840 Test Loss: 0.480 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1344740390777588
Epoch: 20, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1361887454986572
Epoch: 21, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9998390674591064
Epoch: 22, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.946 Vali Acc: 0.768 Test Loss: 0.946 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0679244995117188
Epoch: 23, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.726 Vali Acc: 0.829 Test Loss: 0.726 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0828592777252197
Epoch: 24, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.880 Vali Acc: 0.775 Test Loss: 0.880 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1061780452728271
Epoch: 25, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.574 Vali Acc: 0.734 Test Loss: 1.574 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1262075901031494
Epoch: 26, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1294941902160645
Epoch: 27, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.016 Vali Acc: 0.720 Test Loss: 2.016 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 158378
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8869946002960205
Epoch: 1, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 1.243589162826538
Epoch: 2, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2956359386444092
Epoch: 3, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3525779247283936
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.608 Vali Acc: 0.765 Test Loss: 0.608 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3484337329864502
Epoch: 5, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.819108 --> -0.849825).  Saving model ...
Epoch: 6 cost time: 1.241302728652954
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.762 Vali Acc: 0.754 Test Loss: 0.762 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.27388334274292
Epoch: 7, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.511 Vali Acc: 0.843 Test Loss: 0.511 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2514874935150146
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.722 Vali Acc: 0.768 Test Loss: 0.722 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2408802509307861
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.764 Vali Acc: 0.816 Test Loss: 0.764 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2691376209259033
Epoch: 10, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.749 Vali Acc: 0.792 Test Loss: 0.749 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2253835201263428
Epoch: 11, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2286663055419922
Epoch: 12, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.699 Vali Acc: 0.826 Test Loss: 0.699 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2708778381347656
Epoch: 13, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3285207748413086
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.618 Vali Acc: 0.812 Test Loss: 0.618 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3370580673217773
Epoch: 15, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.814 Vali Acc: 0.823 Test Loss: 0.814 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 141994
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.046295642852783
Epoch: 1, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.202272891998291
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.224830150604248
Epoch: 3, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2953166961669922
Epoch: 4, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3407230377197266
Epoch: 5, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.428 Vali Acc: 0.843 Test Loss: 0.428 Test Acc: 0.843
Validation loss decreased (-0.822521 --> -0.842999).  Saving model ...
Epoch: 6 cost time: 1.2563843727111816
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.712 Vali Acc: 0.744 Test Loss: 0.712 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2641637325286865
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1190693378448486
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2350459098815918
Epoch: 9, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.807 Vali Acc: 0.802 Test Loss: 0.807 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2080304622650146
Epoch: 10, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2170076370239258
Epoch: 11, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.483 Vali Acc: 0.843 Test Loss: 0.483 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1612322330474854
Epoch: 12, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.546 Vali Acc: 0.805 Test Loss: 0.546 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2075414657592773
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.430 Vali Acc: 0.874 Test Loss: 0.430 Test Acc: 0.874
Validation loss decreased (-0.842999 --> -0.873716).  Saving model ...
Epoch: 14 cost time: 1.1688752174377441
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.489 Vali Acc: 0.857 Test Loss: 0.489 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.215233564376831
Epoch: 15, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.893 Vali Acc: 0.754 Test Loss: 0.893 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2259459495544434
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2822942733764648
Epoch: 17, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.215761661529541
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.733 Vali Acc: 0.792 Test Loss: 0.733 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.168771743774414
Epoch: 19, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.934 Vali Acc: 0.840 Test Loss: 0.934 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.12571382522583
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1875646114349365
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.995 Vali Acc: 0.765 Test Loss: 0.995 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.13106369972229
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.642 Vali Acc: 0.863 Test Loss: 0.642 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.178757905960083
Epoch: 23, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.723 Vali Acc: 0.840 Test Loss: 0.723 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 141994
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8231961727142334
Epoch: 1, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.463 Vali Acc: 0.823 Test Loss: 0.463 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.2250478267669678
Epoch: 2, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0545768737792969
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.822521 --> -0.829347).  Saving model ...
Epoch: 4 cost time: 1.120694637298584
Epoch: 4, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.612 Vali Acc: 0.744 Test Loss: 0.612 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0937330722808838
Epoch: 5, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.414 Vali Acc: 0.843 Test Loss: 0.414 Test Acc: 0.843
Validation loss decreased (-0.829347 --> -0.842999).  Saving model ...
Epoch: 6 cost time: 1.1018588542938232
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0831212997436523
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.574 Vali Acc: 0.785 Test Loss: 0.574 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1537518501281738
Epoch: 8, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2869610786437988
Epoch: 9, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1832749843597412
Epoch: 10, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.732 Vali Acc: 0.785 Test Loss: 0.732 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1977453231811523
Epoch: 11, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1956892013549805
Epoch: 12, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.635 Vali Acc: 0.805 Test Loss: 0.635 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.199113368988037
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
Validation loss decreased (-0.842999 --> -0.877129).  Saving model ...
Epoch: 14 cost time: 1.1721396446228027
Epoch: 14, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.150552749633789
Epoch: 15, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1427645683288574
Epoch: 16, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.817 Vali Acc: 0.785 Test Loss: 0.817 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1328213214874268
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.618 Vali Acc: 0.840 Test Loss: 0.618 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2311062812805176
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.711 Vali Acc: 0.782 Test Loss: 0.711 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1832449436187744
Epoch: 19, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1708009243011475
Epoch: 20, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.003 Vali Acc: 0.751 Test Loss: 1.003 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1090543270111084
Epoch: 21, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.844 Vali Acc: 0.840 Test Loss: 0.844 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.073625087738037
Epoch: 22, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.859 Vali Acc: 0.799 Test Loss: 0.859 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0735023021697998
Epoch: 23, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.858 Vali Acc: 0.829 Test Loss: 0.858 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 141994
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.91111159324646
Epoch: 1, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.477 Vali Acc: 0.802 Test Loss: 0.477 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 1.139030933380127
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.569 Vali Acc: 0.799 Test Loss: 0.569 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1970152854919434
Epoch: 3, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.429 Vali Acc: 0.843 Test Loss: 0.429 Test Acc: 0.843
Validation loss decreased (-0.802043 --> -0.842999).  Saving model ...
Epoch: 4 cost time: 1.139397144317627
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.561 Vali Acc: 0.775 Test Loss: 0.561 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1812398433685303
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1572597026824951
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.694 Vali Acc: 0.720 Test Loss: 0.694 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1737513542175293
Epoch: 7, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.428 Vali Acc: 0.823 Test Loss: 0.428 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1379315853118896
Epoch: 8, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.497 Vali Acc: 0.840 Test Loss: 0.497 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1451244354248047
Epoch: 9, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.552 Vali Acc: 0.805 Test Loss: 0.552 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1721155643463135
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1727209091186523
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.952 Vali Acc: 0.734 Test Loss: 0.952 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1763339042663574
Epoch: 12, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.380 Vali Acc: 0.887 Test Loss: 0.380 Test Acc: 0.887
Validation loss decreased (-0.842999 --> -0.887368).  Saving model ...
Epoch: 13 cost time: 1.2358977794647217
Epoch: 13, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1521401405334473
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.821 Vali Acc: 0.737 Test Loss: 0.821 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.125758171081543
Epoch: 15, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1399261951446533
Epoch: 16, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.784 Vali Acc: 0.768 Test Loss: 0.784 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2334609031677246
Epoch: 17, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1846923828125
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1794960498809814
Epoch: 19, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.988 Vali Acc: 0.816 Test Loss: 0.988 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.070765495300293
Epoch: 20, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.304 Vali Acc: 0.669 Test Loss: 1.304 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0612633228302002
Epoch: 21, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0961134433746338
Epoch: 22, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.870 Vali Acc: 0.785 Test Loss: 0.870 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 141994
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.061612129211426
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.407 Vali Acc: 0.840 Test Loss: 0.407 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 1.3452587127685547
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.640 Vali Acc: 0.788 Test Loss: 0.640 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.320995807647705
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.270749568939209
Epoch: 4, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.660 Vali Acc: 0.758 Test Loss: 0.660 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3151278495788574
Epoch: 5, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.440 Vali Acc: 0.823 Test Loss: 0.440 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3270180225372314
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.539 Vali Acc: 0.843 Test Loss: 0.539 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842998).  Saving model ...
Epoch: 7 cost time: 1.3569023609161377
Epoch: 7, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.517 Vali Acc: 0.802 Test Loss: 0.517 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.325878620147705
Epoch: 8, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.404 Vali Acc: 0.846 Test Loss: 0.404 Test Acc: 0.846
Validation loss decreased (-0.842998 --> -0.846412).  Saving model ...
Epoch: 9 cost time: 1.329529047012329
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 1.068 Vali Acc: 0.659 Test Loss: 1.068 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1635847091674805
Epoch: 10, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.521 Vali Acc: 0.860 Test Loss: 0.521 Test Acc: 0.860
Validation loss decreased (-0.846412 --> -0.860063).  Saving model ...
Epoch: 11 cost time: 1.3649535179138184
Epoch: 11, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.802 Vali Acc: 0.747 Test Loss: 0.802 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3230385780334473
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.645 Vali Acc: 0.799 Test Loss: 0.645 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2560904026031494
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
Validation loss decreased (-0.860063 --> -0.863476).  Saving model ...
Epoch: 14 cost time: 1.2717628479003906
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.059 Vali Acc: 0.744 Test Loss: 1.059 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3510587215423584
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2981786727905273
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
Validation loss decreased (-0.863476 --> -0.866888).  Saving model ...
Epoch: 17 cost time: 1.35007905960083
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.633 Vali Acc: 0.853 Test Loss: 0.633 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2344629764556885
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.716 Vali Acc: 0.840 Test Loss: 0.716 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3129804134368896
Epoch: 19, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.697 Vali Acc: 0.863 Test Loss: 0.697 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2252616882324219
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.142 Vali Acc: 0.737 Test Loss: 1.142 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3060026168823242
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.583 Vali Acc: 0.863 Test Loss: 0.583 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.276158094406128
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.720 Vali Acc: 0.846 Test Loss: 0.720 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2295598983764648
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.383 Vali Acc: 0.720 Test Loss: 1.383 Test Acc: 0.720
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.293003797531128
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.809 Vali Acc: 0.857 Test Loss: 0.809 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.261688470840454
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.033 Vali Acc: 0.765 Test Loss: 1.033 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2180800437927246
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.758 Vali Acc: 0.836 Test Loss: 0.758 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 133802
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9681859016418457
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.155735731124878
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1202099323272705
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.703 Vali Acc: 0.730 Test Loss: 0.703 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.134770393371582
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.704 Vali Acc: 0.730 Test Loss: 0.704 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1946284770965576
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2105083465576172
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.832760 --> -0.849824).  Saving model ...
Epoch: 7 cost time: 1.242196798324585
Epoch: 7, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.461 Vali Acc: 0.846 Test Loss: 0.461 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2604551315307617
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.849824 --> -0.866890).  Saving model ...
Epoch: 9 cost time: 1.2800319194793701
Epoch: 9, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.911 Vali Acc: 0.693 Test Loss: 0.911 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3569514751434326
Epoch: 10, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.531 Vali Acc: 0.857 Test Loss: 0.531 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2836246490478516
Epoch: 11, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.640 Vali Acc: 0.778 Test Loss: 0.640 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1590096950531006
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0300061702728271
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
Validation loss decreased (-0.866890 --> -0.877129).  Saving model ...
Epoch: 14 cost time: 1.0103607177734375
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.145 Vali Acc: 0.747 Test Loss: 1.145 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0932269096374512
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.643 Vali Acc: 0.768 Test Loss: 0.643 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0569324493408203
Epoch: 16, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.854 Vali Acc: 0.826 Test Loss: 0.854 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1361193656921387
Epoch: 17, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2053885459899902
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1559348106384277
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.759 Vali Acc: 0.857 Test Loss: 0.759 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2295773029327393
Epoch: 20, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.283 Vali Acc: 0.724 Test Loss: 1.283 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0560030937194824
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1714105606079102
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.729 Vali Acc: 0.860 Test Loss: 0.729 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2110719680786133
Epoch: 23, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.223 Vali Acc: 0.751 Test Loss: 1.223 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 133802
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.961987257003784
Epoch: 1, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.1781878471374512
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0058798789978027
Epoch: 3, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1315267086029053
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.662 Vali Acc: 0.724 Test Loss: 0.662 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0779576301574707
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.416 Vali Acc: 0.836 Test Loss: 0.416 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 6 cost time: 1.0638043880462646
Epoch: 6, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.049412488937378
Epoch: 7, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.494 Vali Acc: 0.799 Test Loss: 0.494 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0517871379852295
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.396 Vali Acc: 0.863 Test Loss: 0.396 Test Acc: 0.863
Validation loss decreased (-0.836173 --> -0.863477).  Saving model ...
Epoch: 9 cost time: 1.1775500774383545
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 1.388 Vali Acc: 0.628 Test Loss: 1.388 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1481235027313232
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.464 Vali Acc: 0.860 Test Loss: 0.464 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1989293098449707
Epoch: 11, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.713 Vali Acc: 0.751 Test Loss: 0.713 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.147284984588623
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.586 Vali Acc: 0.795 Test Loss: 0.586 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2071192264556885
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.399 Vali Acc: 0.874 Test Loss: 0.399 Test Acc: 0.874
Validation loss decreased (-0.863477 --> -0.873716).  Saving model ...
Epoch: 14 cost time: 1.1492893695831299
Epoch: 14, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.463 Vali Acc: 0.706 Test Loss: 1.463 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1953272819519043
Epoch: 15, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.720 Vali Acc: 0.795 Test Loss: 0.720 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2067031860351562
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.647 Vali Acc: 0.829 Test Loss: 0.647 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.188021183013916
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1838345527648926
Epoch: 18, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1876511573791504
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.860 Vali Acc: 0.826 Test Loss: 0.860 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1433043479919434
Epoch: 20, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.224 Vali Acc: 0.734 Test Loss: 1.224 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1390459537506104
Epoch: 21, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.640 Vali Acc: 0.863 Test Loss: 0.640 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1598374843597412
Epoch: 22, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1605033874511719
Epoch: 23, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.318 Vali Acc: 0.727 Test Loss: 1.318 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 133802
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7421047687530518
Epoch: 1, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.0286438465118408
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0701353549957275
Epoch: 3, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.916 Vali Acc: 0.635 Test Loss: 0.916 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0933077335357666
Epoch: 4, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0569052696228027
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.397 Vali Acc: 0.816 Test Loss: 0.397 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.048321008682251
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.545 Vali Acc: 0.829 Test Loss: 0.545 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0384597778320312
Epoch: 7, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.592 Vali Acc: 0.799 Test Loss: 0.592 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0407452583312988
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.406 Vali Acc: 0.823 Test Loss: 0.406 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0407400131225586
Epoch: 9, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.927 Vali Acc: 0.710 Test Loss: 0.927 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0320982933044434
Epoch: 10, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.829347 --> -0.849825).  Saving model ...
Epoch: 11 cost time: 1.0405185222625732
Epoch: 11, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0216362476348877
Epoch: 12, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9696288108825684
Epoch: 13, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.569 Vali Acc: 0.795 Test Loss: 0.569 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0246870517730713
Epoch: 14, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.278 Vali Acc: 0.683 Test Loss: 1.278 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0332200527191162
Epoch: 15, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.601 Vali Acc: 0.782 Test Loss: 0.601 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0591998100280762
Epoch: 16, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0336461067199707
Epoch: 17, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.549 Vali Acc: 0.823 Test Loss: 0.549 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9500184059143066
Epoch: 18, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.849825 --> -0.870303).  Saving model ...
Epoch: 19 cost time: 1.0070748329162598
Epoch: 19, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.673 Vali Acc: 0.836 Test Loss: 0.673 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0066554546356201
Epoch: 20, Steps: 17 | Train Loss: 0.321 Vali Loss: 1.294 Vali Acc: 0.734 Test Loss: 1.294 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0089914798736572
Epoch: 21, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.838 Vali Acc: 0.833 Test Loss: 0.838 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.039285659790039
Epoch: 22, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.622 Vali Acc: 0.812 Test Loss: 0.622 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0195527076721191
Epoch: 23, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.928 Vali Acc: 0.761 Test Loss: 0.928 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0130929946899414
Epoch: 24, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.677 Vali Acc: 0.846 Test Loss: 0.677 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9611251354217529
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.784 Vali Acc: 0.792 Test Loss: 0.784 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0490453243255615
Epoch: 26, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.862 Vali Acc: 0.823 Test Loss: 0.862 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0430002212524414
Epoch: 27, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.814 Vali Acc: 0.829 Test Loss: 0.814 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0103282928466797
Epoch: 28, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
Validation loss decreased (-0.870303 --> -0.880541).  Saving model ...
Epoch: 29 cost time: 1.034463882446289
Epoch: 29, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9457302093505859
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.886 Vali Acc: 0.812 Test Loss: 0.886 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.053093433380127
Epoch: 31, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.785 Vali Acc: 0.846 Test Loss: 0.785 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.015498399734497
Epoch: 32, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.877 Vali Acc: 0.826 Test Loss: 0.877 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.011427640914917
Epoch: 33, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.838 Vali Acc: 0.816 Test Loss: 0.838 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9900224208831787
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.032 Vali Acc: 0.785 Test Loss: 1.032 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.019601583480835
Epoch: 35, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.801 Vali Acc: 0.833 Test Loss: 0.801 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0916314125061035
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.863 Vali Acc: 0.829 Test Loss: 0.863 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0479285717010498
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.816 Test Loss: 1.015 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.073775053024292
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.085 Vali Acc: 0.792 Test Loss: 1.085 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 133802
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9609768390655518
Epoch: 1, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.443 Vali Acc: 0.812 Test Loss: 0.443 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.1596155166625977
Epoch: 2, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.477 Vali Acc: 0.812 Test Loss: 0.477 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1215486526489258
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
Validation loss decreased (-0.812282 --> -0.815695).  Saving model ...
Epoch: 4 cost time: 1.06306791305542
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.464 Vali Acc: 0.829 Test Loss: 0.464 Test Acc: 0.829
Validation loss decreased (-0.815695 --> -0.829347).  Saving model ...
Epoch: 5 cost time: 1.0813624858856201
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.547 Vali Acc: 0.785 Test Loss: 0.547 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.107116937637329
Epoch: 6, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0940053462982178
Epoch: 7, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.500 Vali Acc: 0.788 Test Loss: 0.500 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.095930814743042
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.469 Vali Acc: 0.836 Test Loss: 0.469 Test Acc: 0.836
Validation loss decreased (-0.829347 --> -0.836173).  Saving model ...
Epoch: 9 cost time: 1.0781776905059814
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.447 Vali Acc: 0.840 Test Loss: 0.447 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.1688282489776611
Epoch: 10, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.473 Vali Acc: 0.802 Test Loss: 0.473 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1450793743133545
Epoch: 11, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1336901187896729
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.467 Vali Acc: 0.840 Test Loss: 0.467 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1082322597503662
Epoch: 13, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0423133373260498
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.856 Vali Acc: 0.812 Test Loss: 0.856 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1345045566558838
Epoch: 15, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.482 Vali Acc: 0.843 Test Loss: 0.482 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842999).  Saving model ...
Epoch: 16 cost time: 1.0640006065368652
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1118855476379395
Epoch: 17, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
Validation loss decreased (-0.842999 --> -0.890780).  Saving model ...
Epoch: 18 cost time: 1.124983310699463
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.882 Vali Acc: 0.778 Test Loss: 0.882 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1015286445617676
Epoch: 19, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.700 Vali Acc: 0.829 Test Loss: 0.700 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1706674098968506
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.658 Vali Acc: 0.823 Test Loss: 0.658 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1075849533081055
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.727 Vali Acc: 0.826 Test Loss: 0.727 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.097064733505249
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0860035419464111
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.679 Vali Acc: 0.823 Test Loss: 0.679 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1250567436218262
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.808 Vali Acc: 0.823 Test Loss: 0.808 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1440646648406982
Epoch: 25, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.724 Vali Acc: 0.829 Test Loss: 0.724 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0741450786590576
Epoch: 26, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.892 Vali Acc: 0.853 Test Loss: 0.892 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1523265838623047
Epoch: 27, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.763 Vali Acc: 0.826 Test Loss: 0.763 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 191850
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9296963214874268
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.447 Vali Acc: 0.812 Test Loss: 0.447 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.11480712890625
Epoch: 2, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.473 Vali Acc: 0.823 Test Loss: 0.473 Test Acc: 0.823
Validation loss decreased (-0.812282 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.0380299091339111
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0931661128997803
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 1.05808687210083
Epoch: 5, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.525 Vali Acc: 0.785 Test Loss: 0.525 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0358495712280273
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 7 cost time: 1.0845258235931396
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0179102420806885
Epoch: 8, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1110703945159912
Epoch: 9, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.430 Vali Acc: 0.840 Test Loss: 0.430 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.065237045288086
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.458 Vali Acc: 0.823 Test Loss: 0.458 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0641086101531982
Epoch: 11, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.602 Vali Acc: 0.792 Test Loss: 0.602 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1279346942901611
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1246998310089111
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0187032222747803
Epoch: 14, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.719 Vali Acc: 0.805 Test Loss: 0.719 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9635899066925049
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.460 Vali Acc: 0.843 Test Loss: 0.460 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842999).  Saving model ...
Epoch: 16 cost time: 1.0044317245483398
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9802262783050537
Epoch: 17, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.468 Vali Acc: 0.881 Test Loss: 0.468 Test Acc: 0.881
Validation loss decreased (-0.842999 --> -0.880541).  Saving model ...
Epoch: 18 cost time: 0.9900853633880615
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.092 Vali Acc: 0.689 Test Loss: 1.092 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9817252159118652
Epoch: 19, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.552 Vali Acc: 0.860 Test Loss: 0.552 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0655369758605957
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.568 Vali Acc: 0.843 Test Loss: 0.568 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1070783138275146
Epoch: 21, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0936305522918701
Epoch: 22, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.510 Vali Acc: 0.846 Test Loss: 0.510 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0778417587280273
Epoch: 23, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.193 Vali Acc: 0.713 Test Loss: 1.193 Test Acc: 0.713
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1265137195587158
Epoch: 24, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1372385025024414
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.773 Vali Acc: 0.792 Test Loss: 0.773 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1521141529083252
Epoch: 26, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.790 Vali Acc: 0.819 Test Loss: 0.790 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.120260238647461
Epoch: 27, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.694 Vali Acc: 0.826 Test Loss: 0.694 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 191850
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.812692403793335
Epoch: 1, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.437 Vali Acc: 0.802 Test Loss: 0.437 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 1.1584272384643555
Epoch: 2, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (-0.802043 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.115549087524414
Epoch: 3, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1040551662445068
Epoch: 4, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.447 Vali Acc: 0.829 Test Loss: 0.447 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.074502944946289
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0551393032073975
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.412 Vali Acc: 0.846 Test Loss: 0.412 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 7 cost time: 1.0994830131530762
Epoch: 7, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.456 Vali Acc: 0.802 Test Loss: 0.456 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.135376214981079
Epoch: 8, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1310629844665527
Epoch: 9, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.494 Vali Acc: 0.785 Test Loss: 0.494 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1482419967651367
Epoch: 10, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.151414394378662
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.513 Vali Acc: 0.812 Test Loss: 0.513 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9785101413726807
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.576 Vali Acc: 0.761 Test Loss: 0.576 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1208229064941406
Epoch: 13, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.846412 --> -0.849825).  Saving model ...
Epoch: 14 cost time: 1.091390609741211
Epoch: 14, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.801 Vali Acc: 0.788 Test Loss: 0.801 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1191916465759277
Epoch: 15, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.849825 --> -0.870303).  Saving model ...
Epoch: 16 cost time: 1.1746642589569092
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.691 Vali Acc: 0.754 Test Loss: 0.691 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1226112842559814
Epoch: 17, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.427 Vali Acc: 0.881 Test Loss: 0.427 Test Acc: 0.881
Validation loss decreased (-0.870303 --> -0.880542).  Saving model ...
Epoch: 18 cost time: 1.0567710399627686
Epoch: 18, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.101 Vali Acc: 0.710 Test Loss: 1.101 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1186094284057617
Epoch: 19, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.633 Vali Acc: 0.782 Test Loss: 0.633 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.113353967666626
Epoch: 20, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.609 Vali Acc: 0.805 Test Loss: 0.609 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0884344577789307
Epoch: 21, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.801 Vali Acc: 0.744 Test Loss: 0.801 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1116700172424316
Epoch: 22, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.128472089767456
Epoch: 23, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.745 Vali Acc: 0.782 Test Loss: 0.745 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1243681907653809
Epoch: 24, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1218810081481934
Epoch: 25, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.641 Vali Acc: 0.765 Test Loss: 0.641 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0755245685577393
Epoch: 26, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.109684705734253
Epoch: 27, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.738 Vali Acc: 0.751 Test Loss: 0.738 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 191850
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8123393058776855
Epoch: 1, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.481 Vali Acc: 0.768 Test Loss: 0.481 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.0178520679473877
Epoch: 2, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
Validation loss decreased (-0.767913 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.0446627140045166
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.519 Vali Acc: 0.795 Test Loss: 0.519 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0021488666534424
Epoch: 4, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.509 Vali Acc: 0.802 Test Loss: 0.509 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.999927282333374
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.526 Vali Acc: 0.785 Test Loss: 0.526 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1802732944488525
Epoch: 6, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
Validation loss decreased (-0.808869 --> -0.832760).  Saving model ...
Epoch: 7 cost time: 1.1891825199127197
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1389906406402588
Epoch: 8, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1750195026397705
Epoch: 9, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.450 Vali Acc: 0.823 Test Loss: 0.450 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1063041687011719
Epoch: 10, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0860893726348877
Epoch: 11, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.497 Vali Acc: 0.805 Test Loss: 0.497 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0843162536621094
Epoch: 12, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.572 Vali Acc: 0.754 Test Loss: 0.572 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0740671157836914
Epoch: 13, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
Validation loss decreased (-0.832760 --> -0.870303).  Saving model ...
Epoch: 14 cost time: 1.2254738807678223
Epoch: 14, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.771 Vali Acc: 0.744 Test Loss: 0.771 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1228513717651367
Epoch: 15, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.422 Vali Acc: 0.857 Test Loss: 0.422 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1256608963012695
Epoch: 16, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.625 Vali Acc: 0.792 Test Loss: 0.625 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0325493812561035
Epoch: 17, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.479 Vali Acc: 0.860 Test Loss: 0.479 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.185884952545166
Epoch: 18, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.747 Vali Acc: 0.775 Test Loss: 0.747 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1173605918884277
Epoch: 19, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.766 Vali Acc: 0.741 Test Loss: 0.766 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1222057342529297
Epoch: 20, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.671 Vali Acc: 0.765 Test Loss: 0.671 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0909526348114014
Epoch: 21, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1905193328857422
Epoch: 22, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.870303 --> -0.877129).  Saving model ...
Epoch: 23 cost time: 1.2152812480926514
Epoch: 23, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.783 Vali Acc: 0.744 Test Loss: 0.783 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0889513492584229
Epoch: 24, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0489130020141602
Epoch: 25, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.758 Vali Acc: 0.734 Test Loss: 0.758 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0724875926971436
Epoch: 26, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.528 Vali Acc: 0.836 Test Loss: 0.528 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1545073986053467
Epoch: 27, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.462 Vali Acc: 0.829 Test Loss: 0.462 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0898840427398682
Epoch: 28, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1713483333587646
Epoch: 29, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.134164571762085
Epoch: 30, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.643 Vali Acc: 0.805 Test Loss: 0.643 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1585426330566406
Epoch: 31, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1512601375579834
Epoch: 32, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 191850
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.735264301300049
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.476 Vali Acc: 0.799 Test Loss: 0.476 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.050079107284546
Epoch: 2, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.543 Vali Acc: 0.795 Test Loss: 0.543 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0457813739776611
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
Validation loss decreased (-0.798630 --> -0.829346).  Saving model ...
Epoch: 4 cost time: 1.0232887268066406
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.461 Vali Acc: 0.829 Test Loss: 0.461 Test Acc: 0.829
Validation loss decreased (-0.829346 --> -0.829347).  Saving model ...
Epoch: 5 cost time: 1.084489345550537
Epoch: 5, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9499585628509521
Epoch: 6, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.523 Vali Acc: 0.778 Test Loss: 0.523 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9795317649841309
Epoch: 7, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.571 Vali Acc: 0.778 Test Loss: 0.571 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.050666093826294
Epoch: 8, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.464 Vali Acc: 0.826 Test Loss: 0.464 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0339593887329102
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.684 Vali Acc: 0.802 Test Loss: 0.684 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.009946584701538
Epoch: 10, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.510 Vali Acc: 0.812 Test Loss: 0.510 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0213944911956787
Epoch: 11, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.557 Vali Acc: 0.795 Test Loss: 0.557 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0104691982269287
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.624 Vali Acc: 0.843 Test Loss: 0.624 Test Acc: 0.843
Validation loss decreased (-0.829347 --> -0.842997).  Saving model ...
Epoch: 13 cost time: 1.0283761024475098
Epoch: 13, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.561 Vali Acc: 0.823 Test Loss: 0.561 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0484061241149902
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.531 Vali Acc: 0.870 Test Loss: 0.531 Test Acc: 0.870
Validation loss decreased (-0.842997 --> -0.870302).  Saving model ...
Epoch: 15 cost time: 1.0045216083526611
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.019918441772461
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.721 Vali Acc: 0.812 Test Loss: 0.721 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0393726825714111
Epoch: 17, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
Validation loss decreased (-0.870302 --> -0.877128).  Saving model ...
Epoch: 18 cost time: 1.102027177810669
Epoch: 18, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.588 Vali Acc: 0.857 Test Loss: 0.588 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1036312580108643
Epoch: 19, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1110033988952637
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.713 Vali Acc: 0.853 Test Loss: 0.713 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0788447856903076
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.796 Vali Acc: 0.805 Test Loss: 0.796 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9542837142944336
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.574 Vali Acc: 0.840 Test Loss: 0.574 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0922842025756836
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.857 Vali Acc: 0.812 Test Loss: 0.857 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0497217178344727
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0549724102020264
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0730416774749756
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0384724140167236
Epoch: 27, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 126314
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9204509258270264
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.481 Vali Acc: 0.792 Test Loss: 0.481 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.0945992469787598
Epoch: 2, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.559 Vali Acc: 0.785 Test Loss: 0.559 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.940791130065918
Epoch: 3, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.512 Vali Acc: 0.823 Test Loss: 0.512 Test Acc: 0.823
Validation loss decreased (-0.791804 --> -0.822520).  Saving model ...
Epoch: 4 cost time: 0.9846174716949463
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
Validation loss decreased (-0.822520 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.0055124759674072
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.471 Vali Acc: 0.836 Test Loss: 0.471 Test Acc: 0.836
Validation loss decreased (-0.822521 --> -0.836173).  Saving model ...
Epoch: 6 cost time: 1.0068564414978027
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.497 Vali Acc: 0.799 Test Loss: 0.497 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9799504280090332
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0012788772583008
Epoch: 8, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.463 Vali Acc: 0.823 Test Loss: 0.463 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0010497570037842
Epoch: 9, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.524 Vali Acc: 0.840 Test Loss: 0.524 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839585).  Saving model ...
Epoch: 10 cost time: 1.1240010261535645
Epoch: 10, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.431 Vali Acc: 0.860 Test Loss: 0.431 Test Acc: 0.860
Validation loss decreased (-0.839585 --> -0.860064).  Saving model ...
Epoch: 11 cost time: 1.0254862308502197
Epoch: 11, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.527 Vali Acc: 0.792 Test Loss: 0.527 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0583910942077637
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.056401014328003
Epoch: 13, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0725829601287842
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.860064 --> -0.866890).  Saving model ...
Epoch: 15 cost time: 1.0467360019683838
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
Validation loss decreased (-0.866890 --> -0.870303).  Saving model ...
Epoch: 16 cost time: 0.9987742900848389
Epoch: 16, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.744 Vali Acc: 0.788 Test Loss: 0.744 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0201423168182373
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.459 Vali Acc: 0.874 Test Loss: 0.459 Test Acc: 0.874
Validation loss decreased (-0.870303 --> -0.873716).  Saving model ...
Epoch: 18 cost time: 0.9828572273254395
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0126123428344727
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9040639400482178
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.014667272567749
Epoch: 21, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.898 Vali Acc: 0.737 Test Loss: 0.898 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0320756435394287
Epoch: 22, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0194015502929688
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.695 Vali Acc: 0.829 Test Loss: 0.695 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0549285411834717
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.651 Vali Acc: 0.823 Test Loss: 0.651 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0685625076293945
Epoch: 25, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0666158199310303
Epoch: 26, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.721 Vali Acc: 0.857 Test Loss: 0.721 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.070319414138794
Epoch: 27, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 126314
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8370258808135986
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.475 Vali Acc: 0.778 Test Loss: 0.475 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 1.061225175857544
Epoch: 2, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.529 Vali Acc: 0.802 Test Loss: 0.529 Test Acc: 0.802
Validation loss decreased (-0.778152 --> -0.802042).  Saving model ...
Epoch: 3 cost time: 1.1256639957427979
Epoch: 3, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
Validation loss decreased (-0.802042 --> -0.836173).  Saving model ...
Epoch: 4 cost time: 1.0279099941253662
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.400 Vali Acc: 0.843 Test Loss: 0.400 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.842999).  Saving model ...
Epoch: 5 cost time: 0.9591269493103027
Epoch: 5, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.466 Vali Acc: 0.812 Test Loss: 0.466 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0334508419036865
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.506 Vali Acc: 0.771 Test Loss: 0.506 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0361742973327637
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9838151931762695
Epoch: 8, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9987573623657227
Epoch: 9, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.444 Vali Acc: 0.823 Test Loss: 0.444 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0012333393096924
Epoch: 10, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.842999 --> -0.870303).  Saving model ...
Epoch: 11 cost time: 1.0510811805725098
Epoch: 11, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9706268310546875
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9560017585754395
Epoch: 13, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.665 Vali Acc: 0.782 Test Loss: 0.665 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9648280143737793
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1658966541290283
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0358986854553223
Epoch: 16, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0804853439331055
Epoch: 17, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.460 Vali Acc: 0.846 Test Loss: 0.460 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0241000652313232
Epoch: 18, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.461 Vali Acc: 0.881 Test Loss: 0.461 Test Acc: 0.881
Validation loss decreased (-0.870303 --> -0.880541).  Saving model ...
Epoch: 19 cost time: 1.107818603515625
Epoch: 19, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.675 Vali Acc: 0.795 Test Loss: 0.675 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0958902835845947
Epoch: 20, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1913702487945557
Epoch: 21, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.862 Vali Acc: 0.727 Test Loss: 0.862 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0351948738098145
Epoch: 22, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.474 Vali Acc: 0.846 Test Loss: 0.474 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0525128841400146
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.711 Vali Acc: 0.758 Test Loss: 0.711 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.493969440460205
Epoch: 24, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.679 Vali Acc: 0.812 Test Loss: 0.679 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3714745044708252
Epoch: 25, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4867956638336182
Epoch: 26, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.774 Vali Acc: 0.799 Test Loss: 0.774 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4620041847229004
Epoch: 27, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4074523448944092
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 126314
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.307826280593872
Epoch: 1, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.504 Vali Acc: 0.758 Test Loss: 0.504 Test Acc: 0.758
Validation loss decreased (inf --> -0.757674).  Saving model ...
Epoch: 2 cost time: 1.5511202812194824
Epoch: 2, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.491 Vali Acc: 0.795 Test Loss: 0.491 Test Acc: 0.795
Validation loss decreased (-0.757674 --> -0.795217).  Saving model ...
Epoch: 3 cost time: 1.4093027114868164
Epoch: 3, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
Validation loss decreased (-0.795217 --> -0.836173).  Saving model ...
Epoch: 4 cost time: 1.375511646270752
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4873497486114502
Epoch: 5, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4498026371002197
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.546 Vali Acc: 0.778 Test Loss: 0.546 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3840532302856445
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.560 Vali Acc: 0.751 Test Loss: 0.560 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4695720672607422
Epoch: 8, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2492408752441406
Epoch: 9, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.551 Vali Acc: 0.785 Test Loss: 0.551 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4351019859313965
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (-0.836173 --> -0.870304).  Saving model ...
Epoch: 11 cost time: 1.4445772171020508
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5956025123596191
Epoch: 12, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.633 Vali Acc: 0.778 Test Loss: 0.633 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2946507930755615
Epoch: 13, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.581 Vali Acc: 0.778 Test Loss: 0.581 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5184872150421143
Epoch: 14, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.843 Test Loss: 0.393 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4843473434448242
Epoch: 15, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3639910221099854
Epoch: 16, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.642 Vali Acc: 0.771 Test Loss: 0.642 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0668606758117676
Epoch: 17, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
Validation loss decreased (-0.870304 --> -0.880542).  Saving model ...
Epoch: 18 cost time: 1.5861058235168457
Epoch: 18, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.650 Vali Acc: 0.782 Test Loss: 0.650 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.413353443145752
Epoch: 19, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.798 Vali Acc: 0.771 Test Loss: 0.798 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4220271110534668
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.671 Vali Acc: 0.782 Test Loss: 0.671 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5237302780151367
Epoch: 21, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.562 Vali Acc: 0.775 Test Loss: 0.562 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2978172302246094
Epoch: 22, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3646256923675537
Epoch: 23, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.234 Vali Acc: 0.648 Test Loss: 1.234 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.524907112121582
Epoch: 24, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.499 Vali Acc: 0.860 Test Loss: 0.499 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5385057926177979
Epoch: 25, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.698 Vali Acc: 0.782 Test Loss: 0.698 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2421488761901855
Epoch: 26, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.597 Vali Acc: 0.823 Test Loss: 0.597 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4356105327606201
Epoch: 27, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.411 Vali Acc: 0.853 Test Loss: 0.411 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 126314
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9585072994232178
Epoch: 1, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.480 Vali Acc: 0.771 Test Loss: 0.480 Test Acc: 0.771
Validation loss decreased (inf --> -0.771326).  Saving model ...
Epoch: 2 cost time: 1.4133062362670898
Epoch: 2, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.491 Vali Acc: 0.802 Test Loss: 0.491 Test Acc: 0.802
Validation loss decreased (-0.771326 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.4759047031402588
Epoch: 3, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.545 Vali Acc: 0.785 Test Loss: 0.545 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.458745002746582
Epoch: 4, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.802043 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 1.311650037765503
Epoch: 5, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.549 Vali Acc: 0.795 Test Loss: 0.549 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1126513481140137
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.491 Vali Acc: 0.843 Test Loss: 0.491 Test Acc: 0.843
Validation loss decreased (-0.825934 --> -0.842999).  Saving model ...
Epoch: 7 cost time: 1.40596604347229
Epoch: 7, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4493772983551025
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.655 Vali Acc: 0.741 Test Loss: 0.655 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3485407829284668
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.56368088722229
Epoch: 10, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.350078821182251
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4803106784820557
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.467 Vali Acc: 0.843 Test Loss: 0.467 Test Acc: 0.843
Validation loss decreased (-0.842999 --> -0.842999).  Saving model ...
Epoch: 13 cost time: 1.533822774887085
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.489 Vali Acc: 0.846 Test Loss: 0.489 Test Acc: 0.846
Validation loss decreased (-0.842999 --> -0.846411).  Saving model ...
Epoch: 14 cost time: 1.5097057819366455
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.598 Vali Acc: 0.778 Test Loss: 0.598 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2668554782867432
Epoch: 15, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
Validation loss decreased (-0.846411 --> -0.853236).  Saving model ...
Epoch: 16 cost time: 1.3726446628570557
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.633 Vali Acc: 0.836 Test Loss: 0.633 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5369389057159424
Epoch: 17, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.759 Vali Acc: 0.747 Test Loss: 0.759 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.357572317123413
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2369725704193115
Epoch: 19, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.722 Vali Acc: 0.860 Test Loss: 0.722 Test Acc: 0.860
Validation loss decreased (-0.853236 --> -0.860061).  Saving model ...
Epoch: 20 cost time: 1.0279595851898193
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.813 Vali Acc: 0.809 Test Loss: 0.813 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0273633003234863
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0569190979003906
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.700 Vali Acc: 0.805 Test Loss: 0.700 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0408923625946045
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.745 Vali Acc: 0.812 Test Loss: 0.745 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1401872634887695
Epoch: 24, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.785 Vali Acc: 0.826 Test Loss: 0.785 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4384222030639648
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3799920082092285
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.693 Vali Acc: 0.867 Test Loss: 0.693 Test Acc: 0.867
Validation loss decreased (-0.860061 --> -0.866887).  Saving model ...
Epoch: 27 cost time: 1.443817377090454
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.817 Vali Acc: 0.823 Test Loss: 0.817 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4789092540740967
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.637 Vali Acc: 0.853 Test Loss: 0.637 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3334991931915283
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4279565811157227
Epoch: 30, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.655 Vali Acc: 0.870 Test Loss: 0.655 Test Acc: 0.870
Validation loss decreased (-0.866887 --> -0.870301).  Saving model ...
Epoch: 31 cost time: 1.462674617767334
Epoch: 31, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.957 Vali Acc: 0.826 Test Loss: 0.957 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3935966491699219
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.741 Vali Acc: 0.853 Test Loss: 0.741 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3205084800720215
Epoch: 33, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.906 Vali Acc: 0.826 Test Loss: 0.906 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4455339908599854
Epoch: 34, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.889 Vali Acc: 0.812 Test Loss: 0.889 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4722564220428467
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.738 Vali Acc: 0.850 Test Loss: 0.738 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0338706970214844
Epoch: 36, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.021 Vali Acc: 0.805 Test Loss: 1.021 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4113104343414307
Epoch: 37, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.785 Vali Acc: 0.874 Test Loss: 0.785 Test Acc: 0.874
Validation loss decreased (-0.870301 --> -0.873712).  Saving model ...
Epoch: 38 cost time: 1.5053918361663818
Epoch: 38, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.127 Vali Acc: 0.792 Test Loss: 1.127 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3119516372680664
Epoch: 39, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.763 Vali Acc: 0.860 Test Loss: 0.763 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2730627059936523
Epoch: 40, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.340 Vali Acc: 0.840 Test Loss: 1.340 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.405932903289795
Epoch: 41, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.274 Vali Acc: 0.819 Test Loss: 1.274 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4089229106903076
Epoch: 42, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.014 Vali Acc: 0.843 Test Loss: 1.014 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1828134059906006
Epoch: 43, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.183 Vali Acc: 0.805 Test Loss: 1.183 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5181365013122559
Epoch: 44, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.185 Vali Acc: 0.809 Test Loss: 1.185 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4472098350524902
Epoch: 45, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.325 Vali Acc: 0.792 Test Loss: 1.325 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4556796550750732
Epoch: 46, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.104 Vali Acc: 0.836 Test Loss: 1.104 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.4185616970062256
Epoch: 47, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.543 Vali Acc: 0.805 Test Loss: 1.543 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 93546
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.29508638381958
Epoch: 1, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.485 Vali Acc: 0.775 Test Loss: 0.485 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.4316730499267578
Epoch: 2, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.494 Vali Acc: 0.802 Test Loss: 0.494 Test Acc: 0.802
Validation loss decreased (-0.774739 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.4706120491027832
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.556 Vali Acc: 0.785 Test Loss: 0.556 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1218557357788086
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
Validation loss decreased (-0.802043 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 1.4635875225067139
Epoch: 5, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.560 Vali Acc: 0.785 Test Loss: 0.560 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.461127519607544
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1540544033050537
Epoch: 7, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.483 Vali Acc: 0.792 Test Loss: 0.483 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5629942417144775
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.674 Vali Acc: 0.730 Test Loss: 0.674 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3410301208496094
Epoch: 9, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0720100402832031
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.461 Vali Acc: 0.805 Test Loss: 0.461 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3732376098632812
Epoch: 11, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2994050979614258
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
Validation loss decreased (-0.836173 --> -0.853238).  Saving model ...
Epoch: 13 cost time: 1.1434717178344727
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5161468982696533
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4735538959503174
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.612 Vali Acc: 0.829 Test Loss: 0.612 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1930606365203857
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.517 Vali Acc: 0.857 Test Loss: 0.517 Test Acc: 0.857
Validation loss decreased (-0.853238 --> -0.856650).  Saving model ...
Epoch: 17 cost time: 1.5904150009155273
Epoch: 17, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.628 Vali Acc: 0.799 Test Loss: 0.628 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5097944736480713
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3174049854278564
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.510542631149292
Epoch: 20, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4948039054870605
Epoch: 21, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.853 Vali Acc: 0.802 Test Loss: 0.853 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0680036544799805
Epoch: 22, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.594 Vali Acc: 0.840 Test Loss: 0.594 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4896345138549805
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.789 Vali Acc: 0.795 Test Loss: 0.789 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5079667568206787
Epoch: 24, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1122159957885742
Epoch: 25, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.770 Vali Acc: 0.809 Test Loss: 0.770 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6064465045928955
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
Validation loss decreased (-0.856650 --> -0.863475).  Saving model ...
Epoch: 27 cost time: 1.5317635536193848
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.718 Vali Acc: 0.829 Test Loss: 0.718 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4145643711090088
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.685 Vali Acc: 0.802 Test Loss: 0.685 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3826274871826172
Epoch: 29, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.096 Vali Acc: 0.799 Test Loss: 1.096 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2261736392974854
Epoch: 30, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.701 Vali Acc: 0.853 Test Loss: 0.701 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0887155532836914
Epoch: 31, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.848 Vali Acc: 0.853 Test Loss: 0.848 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1039669513702393
Epoch: 32, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
Validation loss decreased (-0.863475 --> -0.866887).  Saving model ...
Epoch: 33 cost time: 1.1253211498260498
Epoch: 33, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.705 Vali Acc: 0.857 Test Loss: 0.705 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4861886501312256
Epoch: 34, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.943 Vali Acc: 0.819 Test Loss: 0.943 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.347231149673462
Epoch: 35, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
Validation loss decreased (-0.866887 --> -0.866888).  Saving model ...
Epoch: 36 cost time: 1.51835036277771
Epoch: 36, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.902 Vali Acc: 0.823 Test Loss: 0.902 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4996531009674072
Epoch: 37, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.792 Vali Acc: 0.857 Test Loss: 0.792 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4368853569030762
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.053 Vali Acc: 0.799 Test Loss: 1.053 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3479478359222412
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.743 Vali Acc: 0.860 Test Loss: 0.743 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5095908641815186
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.988 Vali Acc: 0.816 Test Loss: 0.988 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5005898475646973
Epoch: 41, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.057 Vali Acc: 0.829 Test Loss: 1.057 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.103663682937622
Epoch: 42, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5856044292449951
Epoch: 43, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.973 Vali Acc: 0.846 Test Loss: 0.973 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4837985038757324
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.049 Vali Acc: 0.805 Test Loss: 1.049 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3518946170806885
Epoch: 45, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.848 Vali Acc: 0.840 Test Loss: 0.848 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 93546
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3687527179718018
Epoch: 1, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.476 Vali Acc: 0.792 Test Loss: 0.476 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.3799071311950684
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.791804 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.4982354640960693
Epoch: 3, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
Validation loss decreased (-0.812282 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.2263462543487549
Epoch: 4, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 1.5246508121490479
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.503 Vali Acc: 0.782 Test Loss: 0.503 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.510899543762207
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 7 cost time: 1.2390077114105225
Epoch: 7, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.477 Vali Acc: 0.768 Test Loss: 0.477 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.502669334411621
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.730 Vali Acc: 0.703 Test Loss: 0.730 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4691567420959473
Epoch: 9, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.757 Vali Acc: 0.693 Test Loss: 0.757 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2066659927368164
Epoch: 10, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.452 Vali Acc: 0.805 Test Loss: 0.452 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4012796878814697
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3987081050872803
Epoch: 12, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 13 cost time: 1.4334473609924316
Epoch: 13, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.586 Vali Acc: 0.795 Test Loss: 0.586 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4919867515563965
Epoch: 14, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.404 Vali Acc: 0.843 Test Loss: 0.404 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.842999).  Saving model ...
Epoch: 15 cost time: 1.4455807209014893
Epoch: 15, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.472578525543213
Epoch: 16, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.495 Vali Acc: 0.846 Test Loss: 0.495 Test Acc: 0.846
Validation loss decreased (-0.842999 --> -0.846411).  Saving model ...
Epoch: 17 cost time: 1.5230317115783691
Epoch: 17, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5028789043426514
Epoch: 18, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.558 Vali Acc: 0.823 Test Loss: 0.558 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2008812427520752
Epoch: 19, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.424 Vali Acc: 0.843 Test Loss: 0.424 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4913053512573242
Epoch: 20, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.797 Vali Acc: 0.805 Test Loss: 0.797 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3973217010498047
Epoch: 21, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.582 Vali Acc: 0.857 Test Loss: 0.582 Test Acc: 0.857
Validation loss decreased (-0.846411 --> -0.856649).  Saving model ...
Epoch: 22 cost time: 1.0277228355407715
Epoch: 22, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.845 Vali Acc: 0.737 Test Loss: 0.845 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4782462120056152
Epoch: 23, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.756 Vali Acc: 0.782 Test Loss: 0.756 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3846135139465332
Epoch: 24, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.629 Vali Acc: 0.805 Test Loss: 0.629 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0712463855743408
Epoch: 25, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.671 Vali Acc: 0.816 Test Loss: 0.671 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3700182437896729
Epoch: 26, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.532 Vali Acc: 0.881 Test Loss: 0.532 Test Acc: 0.881
Validation loss decreased (-0.856649 --> -0.880541).  Saving model ...
Epoch: 27 cost time: 1.2073853015899658
Epoch: 27, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3990693092346191
Epoch: 28, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.795 Vali Acc: 0.758 Test Loss: 0.795 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4844655990600586
Epoch: 29, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.862 Vali Acc: 0.765 Test Loss: 0.862 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1264712810516357
Epoch: 30, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.624 Vali Acc: 0.792 Test Loss: 0.624 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5361528396606445
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.755 Vali Acc: 0.795 Test Loss: 0.755 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4635982513427734
Epoch: 32, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.174511194229126
Epoch: 33, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.475984811782837
Epoch: 34, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4526646137237549
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0800669193267822
Epoch: 36, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.781 Vali Acc: 0.792 Test Loss: 0.781 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 93546
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.806856155395508
Epoch: 1, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.541 Vali Acc: 0.747 Test Loss: 0.541 Test Acc: 0.747
Validation loss decreased (inf --> -0.747435).  Saving model ...
Epoch: 2 cost time: 1.190011978149414
Epoch: 2, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.485 Vali Acc: 0.805 Test Loss: 0.485 Test Acc: 0.805
Validation loss decreased (-0.747435 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 1.4704549312591553
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.523 Vali Acc: 0.785 Test Loss: 0.523 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5045521259307861
Epoch: 4, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.518 Vali Acc: 0.799 Test Loss: 0.518 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.245678424835205
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4576506614685059
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.575 Vali Acc: 0.785 Test Loss: 0.575 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4135842323303223
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 8 cost time: 1.3101963996887207
Epoch: 8, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.707 Vali Acc: 0.737 Test Loss: 0.707 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4513757228851318
Epoch: 9, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.479 Vali Acc: 0.785 Test Loss: 0.479 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0960204601287842
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.527 Vali Acc: 0.758 Test Loss: 0.527 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.363574743270874
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.485 Vali Acc: 0.840 Test Loss: 0.485 Test Acc: 0.840
Validation loss decreased (-0.819108 --> -0.839586).  Saving model ...
Epoch: 12 cost time: 1.3348639011383057
Epoch: 12, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.420 Vali Acc: 0.846 Test Loss: 0.420 Test Acc: 0.846
Validation loss decreased (-0.839586 --> -0.846412).  Saving model ...
Epoch: 13 cost time: 1.0588250160217285
Epoch: 13, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.642 Vali Acc: 0.754 Test Loss: 0.642 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0204083919525146
Epoch: 14, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.373 Vali Acc: 0.846 Test Loss: 0.373 Test Acc: 0.846
Validation loss decreased (-0.846412 --> -0.846413).  Saving model ...
Epoch: 15 cost time: 0.9973230361938477
Epoch: 15, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.030898094177246
Epoch: 16, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.603 Vali Acc: 0.792 Test Loss: 0.603 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.369992733001709
Epoch: 17, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.509 Vali Acc: 0.823 Test Loss: 0.509 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2716622352600098
Epoch: 18, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.749 Vali Acc: 0.737 Test Loss: 0.749 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3989982604980469
Epoch: 19, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
Validation loss decreased (-0.846413 --> -0.870303).  Saving model ...
Epoch: 20 cost time: 1.4617576599121094
Epoch: 20, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4611186981201172
Epoch: 21, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0794451236724854
Epoch: 22, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4505565166473389
Epoch: 23, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.721 Vali Acc: 0.778 Test Loss: 0.721 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.160677433013916
Epoch: 24, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.758 Vali Acc: 0.812 Test Loss: 0.758 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3786628246307373
Epoch: 25, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.735 Vali Acc: 0.805 Test Loss: 0.735 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0896353721618652
Epoch: 26, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.573 Vali Acc: 0.823 Test Loss: 0.573 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4445562362670898
Epoch: 27, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.465881586074829
Epoch: 28, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.491 Vali Acc: 0.846 Test Loss: 0.491 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4211103916168213
Epoch: 29, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.740 Vali Acc: 0.799 Test Loss: 0.740 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 93546
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7895030975341797
Epoch: 1, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.434 Vali Acc: 0.802 Test Loss: 0.434 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 1.2680902481079102
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.524 Vali Acc: 0.782 Test Loss: 0.524 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4313156604766846
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.437 Vali Acc: 0.823 Test Loss: 0.437 Test Acc: 0.823
Validation loss decreased (-0.802043 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.2589011192321777
Epoch: 4, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.446 Vali Acc: 0.816 Test Loss: 0.446 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4370791912078857
Epoch: 5, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.468 Vali Acc: 0.805 Test Loss: 0.468 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4717702865600586
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4264540672302246
Epoch: 7, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
Validation loss decreased (-0.822521 --> -0.849825).  Saving model ...
Epoch: 8 cost time: 1.280712366104126
Epoch: 8, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4874587059020996
Epoch: 9, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.660 Vali Acc: 0.795 Test Loss: 0.660 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3547816276550293
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.433 Vali Acc: 0.874 Test Loss: 0.433 Test Acc: 0.874
Validation loss decreased (-0.849825 --> -0.873716).  Saving model ...
Epoch: 11 cost time: 1.1992402076721191
Epoch: 11, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4994845390319824
Epoch: 12, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2659580707550049
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.505 Vali Acc: 0.846 Test Loss: 0.505 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5083136558532715
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.489 Vali Acc: 0.840 Test Loss: 0.489 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3941142559051514
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.40968918800354
Epoch: 16, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.737 Vali Acc: 0.754 Test Loss: 0.737 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4496564865112305
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.649 Vali Acc: 0.877 Test Loss: 0.649 Test Acc: 0.877
Validation loss decreased (-0.873716 --> -0.877127).  Saving model ...
Epoch: 18 cost time: 1.4319548606872559
Epoch: 18, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.711 Vali Acc: 0.771 Test Loss: 0.711 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3141777515411377
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.741 Vali Acc: 0.816 Test Loss: 0.741 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5576708316802979
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.649 Vali Acc: 0.795 Test Loss: 0.649 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2577743530273438
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.521 Vali Acc: 0.846 Test Loss: 0.521 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6176927089691162
Epoch: 22, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4164087772369385
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.685 Vali Acc: 0.836 Test Loss: 0.685 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.492027759552002
Epoch: 24, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.704 Vali Acc: 0.840 Test Loss: 0.704 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5003492832183838
Epoch: 25, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4928855895996094
Epoch: 26, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.741 Vali Acc: 0.823 Test Loss: 0.741 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3893439769744873
Epoch: 27, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 77162
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1787726879119873
Epoch: 1, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.443 Vali Acc: 0.805 Test Loss: 0.443 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 1.5464112758636475
Epoch: 2, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2864775657653809
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.2681212425231934
Epoch: 4, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.426 Vali Acc: 0.829 Test Loss: 0.426 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829347).  Saving model ...
Epoch: 5 cost time: 1.0363478660583496
Epoch: 5, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9571652412414551
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.446 Vali Acc: 0.816 Test Loss: 0.446 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0383801460266113
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.450 Vali Acc: 0.805 Test Loss: 0.450 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0991113185882568
Epoch: 8, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.478 Vali Acc: 0.846 Test Loss: 0.478 Test Acc: 0.846
Validation loss decreased (-0.829347 --> -0.846412).  Saving model ...
Epoch: 9 cost time: 1.5054371356964111
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.689 Vali Acc: 0.788 Test Loss: 0.689 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.564384937286377
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.429 Vali Acc: 0.860 Test Loss: 0.429 Test Acc: 0.860
Validation loss decreased (-0.846412 --> -0.860064).  Saving model ...
Epoch: 11 cost time: 1.0847859382629395
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.570 Vali Acc: 0.805 Test Loss: 0.570 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.532092571258545
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.520 Vali Acc: 0.846 Test Loss: 0.520 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.475003957748413
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
Validation loss decreased (-0.860064 --> -0.863477).  Saving model ...
Epoch: 14 cost time: 1.1389846801757812
Epoch: 14, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.863477 --> -0.870303).  Saving model ...
Epoch: 15 cost time: 1.4183168411254883
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4738280773162842
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.701 Vali Acc: 0.751 Test Loss: 0.701 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4355862140655518
Epoch: 17, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.588 Vali Acc: 0.863 Test Loss: 0.588 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5589301586151123
Epoch: 18, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.568 Vali Acc: 0.805 Test Loss: 0.568 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0369923114776611
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.596 Vali Acc: 0.829 Test Loss: 0.596 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4576566219329834
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.701 Vali Acc: 0.778 Test Loss: 0.701 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5222547054290771
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.558 Vali Acc: 0.840 Test Loss: 0.558 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.072303056716919
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.505523443222046
Epoch: 23, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.714 Vali Acc: 0.829 Test Loss: 0.714 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5805654525756836
Epoch: 24, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.692 Vali Acc: 0.840 Test Loss: 0.692 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 77162
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0674889087677
Epoch: 1, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.455 Vali Acc: 0.782 Test Loss: 0.455 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 1.4745557308197021
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.508 Vali Acc: 0.802 Test Loss: 0.508 Test Acc: 0.802
Validation loss decreased (-0.781565 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.4575858116149902
Epoch: 3, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.466 Vali Acc: 0.826 Test Loss: 0.466 Test Acc: 0.826
Validation loss decreased (-0.802043 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 1.0411064624786377
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.406 Vali Acc: 0.836 Test Loss: 0.406 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 1.416069746017456
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.432 Vali Acc: 0.829 Test Loss: 0.432 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4664993286132812
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.305572509765625
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.485 Vali Acc: 0.771 Test Loss: 0.485 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4915003776550293
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.429 Vali Acc: 0.843 Test Loss: 0.429 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.842999).  Saving model ...
Epoch: 9 cost time: 1.445235013961792
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.610 Vali Acc: 0.795 Test Loss: 0.610 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3808374404907227
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
Validation loss decreased (-0.842999 --> -0.866890).  Saving model ...
Epoch: 11 cost time: 1.107952356338501
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4485254287719727
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.482 Vali Acc: 0.823 Test Loss: 0.482 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4318318367004395
Epoch: 13, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0028562545776367
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
Validation loss decreased (-0.866890 --> -0.866890).  Saving model ...
Epoch: 15 cost time: 0.9963102340698242
Epoch: 15, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0154273509979248
Epoch: 16, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.455 Vali Acc: 0.829 Test Loss: 0.455 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9892771244049072
Epoch: 17, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.511 Vali Acc: 0.840 Test Loss: 0.511 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.930356502532959
Epoch: 18, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.687 Vali Acc: 0.744 Test Loss: 0.687 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1948282718658447
Epoch: 19, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4667017459869385
Epoch: 20, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2800440788269043
Epoch: 21, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4363346099853516
Epoch: 22, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.465043306350708
Epoch: 23, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1545062065124512
Epoch: 24, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 77162
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.516022205352783
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (inf --> -0.740609).  Saving model ...
Epoch: 2 cost time: 1.3051302433013916
Epoch: 2, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.561 Vali Acc: 0.782 Test Loss: 0.561 Test Acc: 0.782
Validation loss decreased (-0.740609 --> -0.781564).  Saving model ...
Epoch: 3 cost time: 1.4174466133117676
Epoch: 3, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.518 Vali Acc: 0.788 Test Loss: 0.518 Test Acc: 0.788
Validation loss decreased (-0.781564 --> -0.788391).  Saving model ...
Epoch: 4 cost time: 1.4176139831542969
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
Validation loss decreased (-0.788391 --> -0.808869).  Saving model ...
Epoch: 5 cost time: 1.1346685886383057
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
Validation loss decreased (-0.808869 --> -0.825934).  Saving model ...
Epoch: 6 cost time: 1.444702386856079
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.534 Vali Acc: 0.788 Test Loss: 0.534 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4585731029510498
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2067394256591797
Epoch: 8, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.431 Vali Acc: 0.843 Test Loss: 0.431 Test Acc: 0.843
Validation loss decreased (-0.825934 --> -0.842999).  Saving model ...
Epoch: 9 cost time: 1.0971355438232422
Epoch: 9, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2582414150238037
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.408 Vali Acc: 0.846 Test Loss: 0.408 Test Acc: 0.846
Validation loss decreased (-0.842999 --> -0.846412).  Saving model ...
Epoch: 11 cost time: 1.162660837173462
Epoch: 11, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2455313205718994
Epoch: 12, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.441 Vali Acc: 0.846 Test Loss: 0.441 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4437530040740967
Epoch: 13, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
Validation loss decreased (-0.846412 --> -0.877130).  Saving model ...
Epoch: 14 cost time: 1.3334178924560547
Epoch: 14, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.538 Vali Acc: 0.799 Test Loss: 0.538 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0260047912597656
Epoch: 15, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.777 Vali Acc: 0.744 Test Loss: 0.777 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4759070873260498
Epoch: 16, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.553 Vali Acc: 0.778 Test Loss: 0.553 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.383709192276001
Epoch: 17, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.624 Vali Acc: 0.785 Test Loss: 0.624 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3060636520385742
Epoch: 18, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.895 Vali Acc: 0.706 Test Loss: 0.895 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.483534812927246
Epoch: 19, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.558 Vali Acc: 0.799 Test Loss: 0.558 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4528839588165283
Epoch: 20, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.426 Vali Acc: 0.836 Test Loss: 0.426 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4134492874145508
Epoch: 21, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.652 Vali Acc: 0.765 Test Loss: 0.652 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3804559707641602
Epoch: 22, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0572097301483154
Epoch: 23, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.433 Vali Acc: 0.860 Test Loss: 0.433 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 77162
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.418337821960449
Epoch: 1, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.459 Vali Acc: 0.771 Test Loss: 0.459 Test Acc: 0.771
Validation loss decreased (inf --> -0.771326).  Saving model ...
Epoch: 2 cost time: 1.4791762828826904
Epoch: 2, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.510 Vali Acc: 0.802 Test Loss: 0.510 Test Acc: 0.802
Validation loss decreased (-0.771326 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.2094619274139404
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.433 Vali Acc: 0.846 Test Loss: 0.433 Test Acc: 0.846
Validation loss decreased (-0.802043 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 1.3975114822387695
Epoch: 4, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3944787979125977
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1384429931640625
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.448 Vali Acc: 0.836 Test Loss: 0.448 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.40450119972229
Epoch: 7, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.487 Vali Acc: 0.840 Test Loss: 0.487 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4058201313018799
Epoch: 8, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.846412 --> -0.849825).  Saving model ...
Epoch: 9 cost time: 1.1281254291534424
Epoch: 9, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.495 Vali Acc: 0.799 Test Loss: 0.495 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2621588706970215
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.458 Vali Acc: 0.840 Test Loss: 0.458 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4004237651824951
Epoch: 11, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.689 Vali Acc: 0.799 Test Loss: 0.689 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3239243030548096
Epoch: 12, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
Validation loss decreased (-0.849825 --> -0.870303).  Saving model ...
Epoch: 13 cost time: 1.2654709815979004
Epoch: 13, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5189125537872314
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.560 Vali Acc: 0.805 Test Loss: 0.560 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4567534923553467
Epoch: 15, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.143904685974121
Epoch: 16, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.647 Vali Acc: 0.836 Test Loss: 0.647 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.390434741973877
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.578 Vali Acc: 0.840 Test Loss: 0.578 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2860584259033203
Epoch: 18, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.725 Vali Acc: 0.829 Test Loss: 0.725 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3703057765960693
Epoch: 19, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.554 Vali Acc: 0.853 Test Loss: 0.554 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4412686824798584
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.660 Vali Acc: 0.840 Test Loss: 0.660 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2101502418518066
Epoch: 21, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.704 Vali Acc: 0.829 Test Loss: 0.704 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4607551097869873
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.677 Vali Acc: 0.840 Test Loss: 0.677 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 68970
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5078554153442383
Epoch: 1, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.472 Vali Acc: 0.765 Test Loss: 0.472 Test Acc: 0.765
Validation loss decreased (inf --> -0.764500).  Saving model ...
Epoch: 2 cost time: 1.3750193119049072
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.518 Vali Acc: 0.802 Test Loss: 0.518 Test Acc: 0.802
Validation loss decreased (-0.764500 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.409376621246338
Epoch: 3, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.430 Vali Acc: 0.846 Test Loss: 0.430 Test Acc: 0.846
Validation loss decreased (-0.802043 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 1.3314685821533203
Epoch: 4, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2569053173065186
Epoch: 5, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4628124237060547
Epoch: 6, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4329802989959717
Epoch: 7, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.252326488494873
Epoch: 8, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4321231842041016
Epoch: 9, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4074664115905762
Epoch: 10, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.440 Vali Acc: 0.857 Test Loss: 0.440 Test Acc: 0.857
Validation loss decreased (-0.846412 --> -0.856651).  Saving model ...
Epoch: 11 cost time: 1.153303623199463
Epoch: 11, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.894 Vali Acc: 0.761 Test Loss: 0.894 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4478063583374023
Epoch: 12, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.439 Vali Acc: 0.874 Test Loss: 0.439 Test Acc: 0.874
Validation loss decreased (-0.856651 --> -0.873716).  Saving model ...
Epoch: 13 cost time: 1.3716847896575928
Epoch: 13, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.190279245376587
Epoch: 14, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5154674053192139
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.730 Vali Acc: 0.792 Test Loss: 0.730 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2728912830352783
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.514 Vali Acc: 0.846 Test Loss: 0.514 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2568252086639404
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0557971000671387
Epoch: 18, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0953640937805176
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0327601432800293
Epoch: 20, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1038503646850586
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.615 Vali Acc: 0.836 Test Loss: 0.615 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4163568019866943
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.615 Vali Acc: 0.840 Test Loss: 0.615 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 68970
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3528881072998047
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.473 Vali Acc: 0.747 Test Loss: 0.473 Test Acc: 0.747
Validation loss decreased (inf --> -0.747436).  Saving model ...
Epoch: 2 cost time: 1.4189503192901611
Epoch: 2, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.485 Vali Acc: 0.802 Test Loss: 0.485 Test Acc: 0.802
Validation loss decreased (-0.747436 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.0494189262390137
Epoch: 3, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.414 Vali Acc: 0.840 Test Loss: 0.414 Test Acc: 0.840
Validation loss decreased (-0.802043 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.4294769763946533
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.395 Vali Acc: 0.836 Test Loss: 0.395 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.150278091430664
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.506 Vali Acc: 0.805 Test Loss: 0.506 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4018194675445557
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.409 Vali Acc: 0.843 Test Loss: 0.409 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842999).  Saving model ...
Epoch: 7 cost time: 1.434307336807251
Epoch: 7, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.404952049255371
Epoch: 8, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.090423345565796
Epoch: 9, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.562 Vali Acc: 0.754 Test Loss: 0.562 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4612698554992676
Epoch: 10, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
Validation loss decreased (-0.842999 --> -0.870303).  Saving model ...
Epoch: 11 cost time: 1.2894365787506104
Epoch: 11, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.883 Vali Acc: 0.720 Test Loss: 0.883 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4707770347595215
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4706027507781982
Epoch: 13, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.630 Vali Acc: 0.758 Test Loss: 0.630 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.519498586654663
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.475 Vali Acc: 0.805 Test Loss: 0.475 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4588661193847656
Epoch: 15, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.740 Vali Acc: 0.782 Test Loss: 0.740 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4254040718078613
Epoch: 16, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.452 Vali Acc: 0.846 Test Loss: 0.452 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2612450122833252
Epoch: 17, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4548726081848145
Epoch: 18, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.836 Vali Acc: 0.724 Test Loss: 0.836 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2181353569030762
Epoch: 19, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.438 Vali Acc: 0.857 Test Loss: 0.438 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2935421466827393
Epoch: 20, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.703 Vali Acc: 0.805 Test Loss: 0.703 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 68970
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4569268226623535
Epoch: 1, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.548 Vali Acc: 0.713 Test Loss: 0.548 Test Acc: 0.713
Validation loss decreased (inf --> -0.713305).  Saving model ...
Epoch: 2 cost time: 1.3549082279205322
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.480 Vali Acc: 0.788 Test Loss: 0.480 Test Acc: 0.788
Validation loss decreased (-0.713305 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 1.3840851783752441
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.432 Vali Acc: 0.840 Test Loss: 0.432 Test Acc: 0.840
Validation loss decreased (-0.788391 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.4828612804412842
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.452 Vali Acc: 0.812 Test Loss: 0.452 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3896996974945068
Epoch: 5, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.572 Vali Acc: 0.771 Test Loss: 0.572 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3605105876922607
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.437 Vali Acc: 0.836 Test Loss: 0.437 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2600066661834717
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.494 Vali Acc: 0.805 Test Loss: 0.494 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.405404806137085
Epoch: 8, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3542020320892334
Epoch: 9, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.654 Vali Acc: 0.744 Test Loss: 0.654 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.188474178314209
Epoch: 10, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4304757118225098
Epoch: 11, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.708 Vali Acc: 0.754 Test Loss: 0.708 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1392779350280762
Epoch: 12, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.380 Vali Acc: 0.853 Test Loss: 0.380 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853239).  Saving model ...
Epoch: 13 cost time: 1.428060531616211
Epoch: 13, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.584 Vali Acc: 0.792 Test Loss: 0.584 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4698975086212158
Epoch: 14, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.419 Vali Acc: 0.846 Test Loss: 0.419 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3864150047302246
Epoch: 15, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.622 Vali Acc: 0.792 Test Loss: 0.622 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.398390531539917
Epoch: 16, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.435 Vali Acc: 0.857 Test Loss: 0.435 Test Acc: 0.857
Validation loss decreased (-0.853239 --> -0.856651).  Saving model ...
Epoch: 17 cost time: 1.414426326751709
Epoch: 17, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.695 Vali Acc: 0.747 Test Loss: 0.695 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1619000434875488
Epoch: 18, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.701 Vali Acc: 0.747 Test Loss: 0.701 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3475878238677979
Epoch: 19, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.665 Vali Acc: 0.785 Test Loss: 0.665 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.077638864517212
Epoch: 20, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.630 Vali Acc: 0.788 Test Loss: 0.630 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3751530647277832
Epoch: 21, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.486 Vali Acc: 0.846 Test Loss: 0.486 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2894256114959717
Epoch: 22, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3768634796142578
Epoch: 23, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.880 Vali Acc: 0.765 Test Loss: 0.880 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3745732307434082
Epoch: 24, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.802 Vali Acc: 0.771 Test Loss: 0.802 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3672454357147217
Epoch: 25, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.638 Vali Acc: 0.799 Test Loss: 0.638 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1292359828948975
Epoch: 26, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.875 Vali Acc: 0.744 Test Loss: 0.875 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 68970
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2160277366638184
Epoch: 1, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.413 Vali Acc: 0.816 Test Loss: 0.413 Test Acc: 0.816
Validation loss decreased (inf --> -0.815696).  Saving model ...
Epoch: 2 cost time: 1.4324517250061035
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
Validation loss decreased (-0.815696 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.39634108543396
Epoch: 3, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.440 Vali Acc: 0.840 Test Loss: 0.440 Test Acc: 0.840
Validation loss decreased (-0.819108 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.2176494598388672
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.509 Vali Acc: 0.792 Test Loss: 0.509 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5496609210968018
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.098219871520996
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.559 Vali Acc: 0.829 Test Loss: 0.559 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3578073978424072
Epoch: 7, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.462 Vali Acc: 0.840 Test Loss: 0.462 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.025956392288208
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853238).  Saving model ...
Epoch: 9 cost time: 0.9958734512329102
Epoch: 9, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.635 Vali Acc: 0.771 Test Loss: 0.635 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0262415409088135
Epoch: 10, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0210883617401123
Epoch: 11, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3764619827270508
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.853238 --> -0.866889).  Saving model ...
Epoch: 13 cost time: 0.9575531482696533
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.783 Vali Acc: 0.805 Test Loss: 0.783 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3404738903045654
Epoch: 14, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.836 Test Loss: 0.556 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3220069408416748
Epoch: 15, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2994747161865234
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.723 Vali Acc: 0.812 Test Loss: 0.723 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9344329833984375
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.553 Vali Acc: 0.870 Test Loss: 0.553 Test Acc: 0.870
Validation loss decreased (-0.866889 --> -0.870302).  Saving model ...
Epoch: 18 cost time: 1.398679256439209
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.610 Vali Acc: 0.843 Test Loss: 0.610 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.033843755722046
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.686 Vali Acc: 0.799 Test Loss: 0.686 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9886159896850586
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.614 Vali Acc: 0.829 Test Loss: 0.614 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4520201683044434
Epoch: 21, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.599 Vali Acc: 0.840 Test Loss: 0.599 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1025962829589844
Epoch: 22, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.915 Vali Acc: 0.792 Test Loss: 0.915 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.402184247970581
Epoch: 23, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.617 Vali Acc: 0.843 Test Loss: 0.617 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.222839117050171
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.827 Vali Acc: 0.778 Test Loss: 0.827 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4192821979522705
Epoch: 25, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.779 Vali Acc: 0.857 Test Loss: 0.779 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3685722351074219
Epoch: 26, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.730 Vali Acc: 0.829 Test Loss: 0.730 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3755202293395996
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.627 Vali Acc: 0.870 Test Loss: 0.627 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 64874
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2717034816741943
Epoch: 1, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.414 Vali Acc: 0.805 Test Loss: 0.414 Test Acc: 0.805
Validation loss decreased (inf --> -0.805457).  Saving model ...
Epoch: 2 cost time: 1.3436005115509033
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
Validation loss decreased (-0.805457 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.4095289707183838
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.441 Vali Acc: 0.840 Test Loss: 0.441 Test Acc: 0.840
Validation loss decreased (-0.812282 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.5185129642486572
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.507 Vali Acc: 0.792 Test Loss: 0.507 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3960177898406982
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.439 Vali Acc: 0.816 Test Loss: 0.439 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2730495929718018
Epoch: 6, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.535 Vali Acc: 0.823 Test Loss: 0.535 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.387714147567749
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.453 Vali Acc: 0.823 Test Loss: 0.453 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4110684394836426
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (-0.839586 --> -0.863477).  Saving model ...
Epoch: 9 cost time: 1.4469728469848633
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.738 Vali Acc: 0.761 Test Loss: 0.738 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0331542491912842
Epoch: 10, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.523 Vali Acc: 0.802 Test Loss: 0.523 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4517674446105957
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.735 Vali Acc: 0.730 Test Loss: 0.735 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.082071304321289
Epoch: 12, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.525 Vali Acc: 0.846 Test Loss: 0.525 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4191555976867676
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.879 Vali Acc: 0.768 Test Loss: 0.879 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1727972030639648
Epoch: 14, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.530 Vali Acc: 0.860 Test Loss: 0.530 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3471662998199463
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.321753740310669
Epoch: 16, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3697788715362549
Epoch: 17, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.526 Vali Acc: 0.846 Test Loss: 0.526 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5092816352844238
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.436 Vali Acc: 0.874 Test Loss: 0.436 Test Acc: 0.874
Validation loss decreased (-0.863477 --> -0.873716).  Saving model ...
Epoch: 19 cost time: 1.1292839050292969
Epoch: 19, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.563 Vali Acc: 0.846 Test Loss: 0.563 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4361340999603271
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.39949369430542
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.558 Vali Acc: 0.823 Test Loss: 0.558 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3579795360565186
Epoch: 22, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.783 Vali Acc: 0.805 Test Loss: 0.783 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2043399810791016
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2506706714630127
Epoch: 24, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.601 Vali Acc: 0.829 Test Loss: 0.601 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.317274570465088
Epoch: 25, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.806 Vali Acc: 0.778 Test Loss: 0.806 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3792805671691895
Epoch: 26, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.740 Vali Acc: 0.833 Test Loss: 0.740 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.261526346206665
Epoch: 27, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0107338428497314
Epoch: 28, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.082 Vali Acc: 0.744 Test Loss: 1.082 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 64874
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1503896713256836
Epoch: 1, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.414 Vali Acc: 0.809 Test Loss: 0.414 Test Acc: 0.809
Validation loss decreased (inf --> -0.808870).  Saving model ...
Epoch: 2 cost time: 1.20013427734375
Epoch: 2, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.223548173904419
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.409 Vali Acc: 0.840 Test Loss: 0.409 Test Acc: 0.840
Validation loss decreased (-0.808870 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.2450692653656006
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.509 Vali Acc: 0.788 Test Loss: 0.509 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.395078182220459
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.406 Vali Acc: 0.840 Test Loss: 0.406 Test Acc: 0.840
Validation loss decreased (-0.839586 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 1.1118392944335938
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.527 Vali Acc: 0.802 Test Loss: 0.527 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4109578132629395
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.839586 --> -0.849825).  Saving model ...
Epoch: 8 cost time: 1.0622038841247559
Epoch: 8, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.397 Vali Acc: 0.857 Test Loss: 0.397 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856651).  Saving model ...
Epoch: 9 cost time: 1.4070076942443848
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0319955348968506
Epoch: 10, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.470 Vali Acc: 0.823 Test Loss: 0.470 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.976470947265625
Epoch: 11, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.737 Vali Acc: 0.706 Test Loss: 0.737 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1337597370147705
Epoch: 12, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.491 Vali Acc: 0.843 Test Loss: 0.491 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0914199352264404
Epoch: 13, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.666 Vali Acc: 0.788 Test Loss: 0.666 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3096144199371338
Epoch: 14, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.484 Vali Acc: 0.857 Test Loss: 0.484 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.000122308731079
Epoch: 15, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.617 Vali Acc: 0.734 Test Loss: 0.617 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2823283672332764
Epoch: 16, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.856651 --> -0.870303).  Saving model ...
Epoch: 17 cost time: 1.3222155570983887
Epoch: 17, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.805 Vali Acc: 0.689 Test Loss: 0.805 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1454224586486816
Epoch: 18, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.423 Vali Acc: 0.843 Test Loss: 0.423 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5024473667144775
Epoch: 19, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5043764114379883
Epoch: 20, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.250488519668579
Epoch: 21, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4921023845672607
Epoch: 22, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.777 Vali Acc: 0.782 Test Loss: 0.777 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.334155559539795
Epoch: 23, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.624 Vali Acc: 0.792 Test Loss: 0.624 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0672943592071533
Epoch: 24, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3651902675628662
Epoch: 25, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.849 Vali Acc: 0.765 Test Loss: 0.849 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3747518062591553
Epoch: 26, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.702 Vali Acc: 0.836 Test Loss: 0.702 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 64874
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.962796449661255
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.498 Vali Acc: 0.765 Test Loss: 0.498 Test Acc: 0.765
Validation loss decreased (inf --> -0.764500).  Saving model ...
Epoch: 2 cost time: 1.4751157760620117
Epoch: 2, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.472 Vali Acc: 0.782 Test Loss: 0.472 Test Acc: 0.782
Validation loss decreased (-0.764500 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 1.4730851650238037
Epoch: 3, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
Validation loss decreased (-0.781565 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 1.0820796489715576
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.476346731185913
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 6 cost time: 1.3359744548797607
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.544 Vali Acc: 0.775 Test Loss: 0.544 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0235908031463623
Epoch: 7, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.480 Vali Acc: 0.812 Test Loss: 0.480 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4104785919189453
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.423 Vali Acc: 0.846 Test Loss: 0.423 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 9 cost time: 1.4170994758605957
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.549 Vali Acc: 0.795 Test Loss: 0.549 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.155613899230957
Epoch: 10, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.565 Vali Acc: 0.761 Test Loss: 0.565 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4046392440795898
Epoch: 11, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.714 Vali Acc: 0.706 Test Loss: 0.714 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3512499332427979
Epoch: 12, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2672650814056396
Epoch: 13, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.394115686416626
Epoch: 14, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2691898345947266
Epoch: 15, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3754839897155762
Epoch: 16, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4332726001739502
Epoch: 17, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.420 Vali Acc: 0.853 Test Loss: 0.420 Test Acc: 0.853
Validation loss decreased (-0.846412 --> -0.853238).  Saving model ...
Epoch: 18 cost time: 1.0573527812957764
Epoch: 18, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3224403858184814
Epoch: 19, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.566 Vali Acc: 0.802 Test Loss: 0.566 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3957030773162842
Epoch: 20, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.678 Vali Acc: 0.765 Test Loss: 0.678 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0288867950439453
Epoch: 21, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2830021381378174
Epoch: 22, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.750 Vali Acc: 0.771 Test Loss: 0.750 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.349663496017456
Epoch: 23, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.741 Vali Acc: 0.771 Test Loss: 0.741 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0358681678771973
Epoch: 24, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.389 Vali Acc: 0.863 Test Loss: 0.389 Test Acc: 0.863
Validation loss decreased (-0.853238 --> -0.863477).  Saving model ...
Epoch: 25 cost time: 1.310178279876709
Epoch: 25, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.356827974319458
Epoch: 26, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.730 Vali Acc: 0.768 Test Loss: 0.730 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0696322917938232
Epoch: 27, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3999450206756592
Epoch: 28, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.860 Vali Acc: 0.785 Test Loss: 0.860 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4079632759094238
Epoch: 29, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
Validation loss decreased (-0.863477 --> -0.877129).  Saving model ...
Epoch: 30 cost time: 1.0755598545074463
Epoch: 30, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.800 Vali Acc: 0.768 Test Loss: 0.800 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4141294956207275
Epoch: 31, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.904 Vali Acc: 0.744 Test Loss: 0.904 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4005732536315918
Epoch: 32, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.459 Vali Acc: 0.874 Test Loss: 0.459 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9716517925262451
Epoch: 33, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.721 Vali Acc: 0.836 Test Loss: 0.721 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9594287872314453
Epoch: 34, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8841662406921387
Epoch: 35, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.614 Vali Acc: 0.826 Test Loss: 0.614 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8863093852996826
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.542 Vali Acc: 0.840 Test Loss: 0.542 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2281453609466553
Epoch: 37, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3681104183197021
Epoch: 38, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.749 Vali Acc: 0.799 Test Loss: 0.749 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0405175685882568
Epoch: 39, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.488 Vali Acc: 0.857 Test Loss: 0.488 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_ETSformer_UEA_ftM_sl896_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 64874
model size : 0.87MB
