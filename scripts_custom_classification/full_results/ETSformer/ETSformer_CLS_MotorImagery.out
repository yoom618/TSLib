Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.32546305656433
Epoch: 1, Steps: 35 | Train Loss: 7.935 Vali Loss: 9.040 Vali Acc: 0.570 Test Loss: 9.040 Test Acc: 0.570
Validation loss decreased (inf --> -0.569910).  Saving model ...
Epoch: 2 cost time: 17.373292684555054
Epoch: 2, Steps: 35 | Train Loss: 15.547 Vali Loss: 34.579 Vali Acc: 0.520 Test Loss: 34.579 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.325548887252808
Epoch: 3, Steps: 35 | Train Loss: 22.297 Vali Loss: 24.507 Vali Acc: 0.540 Test Loss: 24.507 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.155040740966797
Epoch: 4, Steps: 35 | Train Loss: 14.482 Vali Loss: 46.433 Vali Acc: 0.430 Test Loss: 46.433 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.918333530426025
Epoch: 5, Steps: 35 | Train Loss: 24.321 Vali Loss: 28.117 Vali Acc: 0.570 Test Loss: 28.117 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.262297868728638
Epoch: 6, Steps: 35 | Train Loss: 18.182 Vali Loss: 27.138 Vali Acc: 0.450 Test Loss: 27.138 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.16177749633789
Epoch: 7, Steps: 35 | Train Loss: 7.743 Vali Loss: 14.375 Vali Acc: 0.410 Test Loss: 14.375 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.47607183456421
Epoch: 8, Steps: 35 | Train Loss: 7.120 Vali Loss: 46.009 Vali Acc: 0.530 Test Loss: 46.009 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.624583959579468
Epoch: 9, Steps: 35 | Train Loss: 12.296 Vali Loss: 39.003 Vali Acc: 0.540 Test Loss: 39.003 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.912846565246582
Epoch: 10, Steps: 35 | Train Loss: 11.577 Vali Loss: 52.430 Vali Acc: 0.520 Test Loss: 52.430 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.336021900177002
Epoch: 11, Steps: 35 | Train Loss: 10.170 Vali Loss: 22.163 Vali Acc: 0.490 Test Loss: 22.163 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 8555042
model size : 42.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.742802619934082
Epoch: 1, Steps: 35 | Train Loss: 7.256 Vali Loss: 9.492 Vali Acc: 0.500 Test Loss: 9.492 Test Acc: 0.500
Validation loss decreased (inf --> -0.499905).  Saving model ...
Epoch: 2 cost time: 15.2212553024292
Epoch: 2, Steps: 35 | Train Loss: 12.853 Vali Loss: 21.981 Vali Acc: 0.560 Test Loss: 21.981 Test Acc: 0.560
Validation loss decreased (-0.499905 --> -0.559780).  Saving model ...
Epoch: 3 cost time: 15.79489254951477
Epoch: 3, Steps: 35 | Train Loss: 19.003 Vali Loss: 21.639 Vali Acc: 0.520 Test Loss: 21.639 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.708988428115845
Epoch: 4, Steps: 35 | Train Loss: 8.802 Vali Loss: 16.256 Vali Acc: 0.510 Test Loss: 16.256 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.814589023590088
Epoch: 5, Steps: 35 | Train Loss: 15.262 Vali Loss: 36.214 Vali Acc: 0.560 Test Loss: 36.214 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.435778617858887
Epoch: 6, Steps: 35 | Train Loss: 25.540 Vali Loss: 67.237 Vali Acc: 0.490 Test Loss: 67.237 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.426346778869629
Epoch: 7, Steps: 35 | Train Loss: 11.843 Vali Loss: 40.042 Vali Acc: 0.520 Test Loss: 40.042 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.447566747665405
Epoch: 8, Steps: 35 | Train Loss: 11.226 Vali Loss: 27.043 Vali Acc: 0.520 Test Loss: 27.043 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 15.249157667160034
Epoch: 9, Steps: 35 | Train Loss: 9.408 Vali Loss: 30.924 Vali Acc: 0.490 Test Loss: 30.924 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.728078842163086
Epoch: 10, Steps: 35 | Train Loss: 4.903 Vali Loss: 40.188 Vali Acc: 0.480 Test Loss: 40.188 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.895073652267456
Epoch: 11, Steps: 35 | Train Loss: 11.702 Vali Loss: 47.940 Vali Acc: 0.560 Test Loss: 47.940 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.639952898025513
Epoch: 12, Steps: 35 | Train Loss: 21.052 Vali Loss: 36.565 Vali Acc: 0.510 Test Loss: 36.565 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 8555042
model size : 42.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.26813530921936
Epoch: 1, Steps: 35 | Train Loss: 7.836 Vali Loss: 9.149 Vali Acc: 0.530 Test Loss: 9.149 Test Acc: 0.530
Validation loss decreased (inf --> -0.529909).  Saving model ...
Epoch: 2 cost time: 12.67757534980774
Epoch: 2, Steps: 35 | Train Loss: 11.078 Vali Loss: 24.472 Vali Acc: 0.550 Test Loss: 24.472 Test Acc: 0.550
Validation loss decreased (-0.529909 --> -0.549755).  Saving model ...
Epoch: 3 cost time: 13.320427179336548
Epoch: 3, Steps: 35 | Train Loss: 19.129 Vali Loss: 11.228 Vali Acc: 0.520 Test Loss: 11.228 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.988892078399658
Epoch: 4, Steps: 35 | Train Loss: 19.400 Vali Loss: 47.345 Vali Acc: 0.500 Test Loss: 47.345 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.137733936309814
Epoch: 5, Steps: 35 | Train Loss: 22.614 Vali Loss: 25.400 Vali Acc: 0.530 Test Loss: 25.400 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.499208211898804
Epoch: 6, Steps: 35 | Train Loss: 11.464 Vali Loss: 41.674 Vali Acc: 0.500 Test Loss: 41.674 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.099405288696289
Epoch: 7, Steps: 35 | Train Loss: 7.811 Vali Loss: 53.652 Vali Acc: 0.540 Test Loss: 53.652 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.629672050476074
Epoch: 8, Steps: 35 | Train Loss: 14.689 Vali Loss: 35.692 Vali Acc: 0.390 Test Loss: 35.692 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.362289428710938
Epoch: 9, Steps: 35 | Train Loss: 4.273 Vali Loss: 50.381 Vali Acc: 0.470 Test Loss: 50.381 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.565454959869385
Epoch: 10, Steps: 35 | Train Loss: 9.742 Vali Loss: 40.789 Vali Acc: 0.440 Test Loss: 40.789 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 14.049506425857544
Epoch: 11, Steps: 35 | Train Loss: 8.233 Vali Loss: 55.531 Vali Acc: 0.490 Test Loss: 55.531 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 14.626353740692139
Epoch: 12, Steps: 35 | Train Loss: 11.219 Vali Loss: 27.876 Vali Acc: 0.570 Test Loss: 27.876 Test Acc: 0.570
Validation loss decreased (-0.549755 --> -0.569721).  Saving model ...
Epoch: 13 cost time: 14.140437841415405
Epoch: 13, Steps: 35 | Train Loss: 8.432 Vali Loss: 47.284 Vali Acc: 0.510 Test Loss: 47.284 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.830639362335205
Epoch: 14, Steps: 35 | Train Loss: 5.203 Vali Loss: 40.235 Vali Acc: 0.540 Test Loss: 40.235 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.47031283378601
Epoch: 15, Steps: 35 | Train Loss: 7.738 Vali Loss: 32.792 Vali Acc: 0.510 Test Loss: 32.792 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.194369792938232
Epoch: 16, Steps: 35 | Train Loss: 8.513 Vali Loss: 48.857 Vali Acc: 0.520 Test Loss: 48.857 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.963351249694824
Epoch: 17, Steps: 35 | Train Loss: 6.769 Vali Loss: 50.503 Vali Acc: 0.520 Test Loss: 50.503 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.115097999572754
Epoch: 18, Steps: 35 | Train Loss: 6.693 Vali Loss: 32.021 Vali Acc: 0.500 Test Loss: 32.021 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.196366548538208
Epoch: 19, Steps: 35 | Train Loss: 5.242 Vali Loss: 95.605 Vali Acc: 0.520 Test Loss: 95.605 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.346837043762207
Epoch: 20, Steps: 35 | Train Loss: 23.980 Vali Loss: 89.218 Vali Acc: 0.540 Test Loss: 89.218 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.263290643692017
Epoch: 21, Steps: 35 | Train Loss: 6.533 Vali Loss: 49.039 Vali Acc: 0.600 Test Loss: 49.039 Test Acc: 0.600
Validation loss decreased (-0.569721 --> -0.599510).  Saving model ...
Epoch: 22 cost time: 13.930102109909058
Epoch: 22, Steps: 35 | Train Loss: 4.610 Vali Loss: 118.647 Vali Acc: 0.550 Test Loss: 118.647 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.280404806137085
Epoch: 23, Steps: 35 | Train Loss: 6.216 Vali Loss: 91.678 Vali Acc: 0.540 Test Loss: 91.678 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.393667459487915
Epoch: 24, Steps: 35 | Train Loss: 7.998 Vali Loss: 55.470 Vali Acc: 0.500 Test Loss: 55.470 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.137499809265137
Epoch: 25, Steps: 35 | Train Loss: 7.415 Vali Loss: 179.979 Vali Acc: 0.480 Test Loss: 179.979 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.040541172027588
Epoch: 26, Steps: 35 | Train Loss: 4.939 Vali Loss: 93.105 Vali Acc: 0.560 Test Loss: 93.105 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.352224826812744
Epoch: 27, Steps: 35 | Train Loss: 4.713 Vali Loss: 53.934 Vali Acc: 0.490 Test Loss: 53.934 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 13.699275493621826
Epoch: 28, Steps: 35 | Train Loss: 7.902 Vali Loss: 89.090 Vali Acc: 0.550 Test Loss: 89.090 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 14.28377103805542
Epoch: 29, Steps: 35 | Train Loss: 3.933 Vali Loss: 102.816 Vali Acc: 0.490 Test Loss: 102.816 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 14.725348711013794
Epoch: 30, Steps: 35 | Train Loss: 5.367 Vali Loss: 73.215 Vali Acc: 0.600 Test Loss: 73.215 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 14.509469985961914
Epoch: 31, Steps: 35 | Train Loss: 2.231 Vali Loss: 97.965 Vali Acc: 0.580 Test Loss: 97.965 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 8555042
model size : 42.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.361841678619385
Epoch: 1, Steps: 35 | Train Loss: 6.586 Vali Loss: 6.699 Vali Acc: 0.530 Test Loss: 6.699 Test Acc: 0.530
Validation loss decreased (inf --> -0.529933).  Saving model ...
Epoch: 2 cost time: 12.878953456878662
Epoch: 2, Steps: 35 | Train Loss: 20.688 Vali Loss: 26.531 Vali Acc: 0.470 Test Loss: 26.531 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.203039169311523
Epoch: 3, Steps: 35 | Train Loss: 14.137 Vali Loss: 18.389 Vali Acc: 0.510 Test Loss: 18.389 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.100932359695435
Epoch: 4, Steps: 35 | Train Loss: 12.711 Vali Loss: 25.914 Vali Acc: 0.420 Test Loss: 25.914 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.711496114730835
Epoch: 5, Steps: 35 | Train Loss: 22.499 Vali Loss: 22.316 Vali Acc: 0.520 Test Loss: 22.316 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.112898111343384
Epoch: 6, Steps: 35 | Train Loss: 11.634 Vali Loss: 25.585 Vali Acc: 0.460 Test Loss: 25.585 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.744516372680664
Epoch: 7, Steps: 35 | Train Loss: 9.700 Vali Loss: 36.270 Vali Acc: 0.500 Test Loss: 36.270 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.17751431465149
Epoch: 8, Steps: 35 | Train Loss: 34.304 Vali Loss: 66.732 Vali Acc: 0.500 Test Loss: 66.732 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.358538627624512
Epoch: 9, Steps: 35 | Train Loss: 19.657 Vali Loss: 22.395 Vali Acc: 0.520 Test Loss: 22.395 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.222020387649536
Epoch: 10, Steps: 35 | Train Loss: 8.182 Vali Loss: 89.869 Vali Acc: 0.500 Test Loss: 89.869 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.593700885772705
Epoch: 11, Steps: 35 | Train Loss: 23.910 Vali Loss: 25.195 Vali Acc: 0.500 Test Loss: 25.195 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 8555042
model size : 42.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.97886323928833
Epoch: 1, Steps: 35 | Train Loss: 4.378 Vali Loss: 6.225 Vali Acc: 0.540 Test Loss: 6.225 Test Acc: 0.540
Validation loss decreased (inf --> -0.539938).  Saving model ...
Epoch: 2 cost time: 14.302000761032104
Epoch: 2, Steps: 35 | Train Loss: 15.768 Vali Loss: 8.950 Vali Acc: 0.610 Test Loss: 8.950 Test Acc: 0.610
Validation loss decreased (-0.539938 --> -0.609910).  Saving model ...
Epoch: 3 cost time: 14.84937858581543
Epoch: 3, Steps: 35 | Train Loss: 10.862 Vali Loss: 8.664 Vali Acc: 0.560 Test Loss: 8.664 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.861033916473389
Epoch: 4, Steps: 35 | Train Loss: 13.498 Vali Loss: 41.622 Vali Acc: 0.600 Test Loss: 41.622 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.042525053024292
Epoch: 5, Steps: 35 | Train Loss: 14.076 Vali Loss: 15.771 Vali Acc: 0.520 Test Loss: 15.771 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.050877809524536
Epoch: 6, Steps: 35 | Train Loss: 16.180 Vali Loss: 25.190 Vali Acc: 0.540 Test Loss: 25.190 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.52554726600647
Epoch: 7, Steps: 35 | Train Loss: 25.837 Vali Loss: 16.759 Vali Acc: 0.530 Test Loss: 16.759 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.09982419013977
Epoch: 8, Steps: 35 | Train Loss: 10.433 Vali Loss: 36.993 Vali Acc: 0.530 Test Loss: 36.993 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.985036373138428
Epoch: 9, Steps: 35 | Train Loss: 13.886 Vali Loss: 55.063 Vali Acc: 0.540 Test Loss: 55.063 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.224820852279663
Epoch: 10, Steps: 35 | Train Loss: 8.787 Vali Loss: 31.731 Vali Acc: 0.520 Test Loss: 31.731 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 15.091186046600342
Epoch: 11, Steps: 35 | Train Loss: 7.425 Vali Loss: 25.903 Vali Acc: 0.500 Test Loss: 25.903 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 15.034057140350342
Epoch: 12, Steps: 35 | Train Loss: 9.723 Vali Loss: 31.092 Vali Acc: 0.520 Test Loss: 31.092 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 6457890
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.421849012374878
Epoch: 1, Steps: 35 | Train Loss: 4.273 Vali Loss: 4.688 Vali Acc: 0.540 Test Loss: 4.688 Test Acc: 0.540
Validation loss decreased (inf --> -0.539953).  Saving model ...
Epoch: 2 cost time: 12.908363580703735
Epoch: 2, Steps: 35 | Train Loss: 12.897 Vali Loss: 10.099 Vali Acc: 0.440 Test Loss: 10.099 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.371649980545044
Epoch: 3, Steps: 35 | Train Loss: 8.383 Vali Loss: 32.449 Vali Acc: 0.370 Test Loss: 32.449 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.29253888130188
Epoch: 4, Steps: 35 | Train Loss: 18.712 Vali Loss: 18.388 Vali Acc: 0.550 Test Loss: 18.388 Test Acc: 0.550
Validation loss decreased (-0.539953 --> -0.549816).  Saving model ...
Epoch: 5 cost time: 13.320560216903687
Epoch: 5, Steps: 35 | Train Loss: 15.705 Vali Loss: 19.241 Vali Acc: 0.520 Test Loss: 19.241 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.938565492630005
Epoch: 6, Steps: 35 | Train Loss: 24.194 Vali Loss: 38.301 Vali Acc: 0.600 Test Loss: 38.301 Test Acc: 0.600
Validation loss decreased (-0.549816 --> -0.599617).  Saving model ...
Epoch: 7 cost time: 13.090001821517944
Epoch: 7, Steps: 35 | Train Loss: 21.652 Vali Loss: 46.810 Vali Acc: 0.470 Test Loss: 46.810 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.928453207015991
Epoch: 8, Steps: 35 | Train Loss: 14.663 Vali Loss: 76.740 Vali Acc: 0.470 Test Loss: 76.740 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.696170091629028
Epoch: 9, Steps: 35 | Train Loss: 12.862 Vali Loss: 34.337 Vali Acc: 0.510 Test Loss: 34.337 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.147140741348267
Epoch: 10, Steps: 35 | Train Loss: 12.042 Vali Loss: 66.744 Vali Acc: 0.510 Test Loss: 66.744 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.361775875091553
Epoch: 11, Steps: 35 | Train Loss: 6.031 Vali Loss: 53.452 Vali Acc: 0.470 Test Loss: 53.452 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.51126503944397
Epoch: 12, Steps: 35 | Train Loss: 13.461 Vali Loss: 48.962 Vali Acc: 0.510 Test Loss: 48.962 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.896142959594727
Epoch: 13, Steps: 35 | Train Loss: 7.458 Vali Loss: 44.203 Vali Acc: 0.460 Test Loss: 44.203 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.413079500198364
Epoch: 14, Steps: 35 | Train Loss: 7.253 Vali Loss: 38.778 Vali Acc: 0.460 Test Loss: 38.778 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.891726016998291
Epoch: 15, Steps: 35 | Train Loss: 5.569 Vali Loss: 66.181 Vali Acc: 0.520 Test Loss: 66.181 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.850852251052856
Epoch: 16, Steps: 35 | Train Loss: 8.111 Vali Loss: 67.405 Vali Acc: 0.520 Test Loss: 67.405 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 6457890
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.467482566833496
Epoch: 1, Steps: 35 | Train Loss: 3.953 Vali Loss: 3.230 Vali Acc: 0.570 Test Loss: 3.230 Test Acc: 0.570
Validation loss decreased (inf --> -0.569968).  Saving model ...
Epoch: 2 cost time: 13.61217451095581
Epoch: 2, Steps: 35 | Train Loss: 7.871 Vali Loss: 11.195 Vali Acc: 0.430 Test Loss: 11.195 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.01352572441101
Epoch: 3, Steps: 35 | Train Loss: 9.293 Vali Loss: 13.489 Vali Acc: 0.470 Test Loss: 13.489 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.987955808639526
Epoch: 4, Steps: 35 | Train Loss: 13.340 Vali Loss: 17.781 Vali Acc: 0.560 Test Loss: 17.781 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.11668086051941
Epoch: 5, Steps: 35 | Train Loss: 13.827 Vali Loss: 25.521 Vali Acc: 0.500 Test Loss: 25.521 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.669512510299683
Epoch: 6, Steps: 35 | Train Loss: 12.531 Vali Loss: 80.187 Vali Acc: 0.540 Test Loss: 80.187 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.353336095809937
Epoch: 7, Steps: 35 | Train Loss: 31.401 Vali Loss: 30.670 Vali Acc: 0.540 Test Loss: 30.670 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 12.23828411102295
Epoch: 8, Steps: 35 | Train Loss: 14.351 Vali Loss: 34.813 Vali Acc: 0.460 Test Loss: 34.813 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.475456953048706
Epoch: 9, Steps: 35 | Train Loss: 12.988 Vali Loss: 28.780 Vali Acc: 0.470 Test Loss: 28.780 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.222362518310547
Epoch: 10, Steps: 35 | Train Loss: 10.414 Vali Loss: 56.438 Vali Acc: 0.500 Test Loss: 56.438 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.357697486877441
Epoch: 11, Steps: 35 | Train Loss: 6.248 Vali Loss: 30.489 Vali Acc: 0.480 Test Loss: 30.489 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 6457890
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.489299535751343
Epoch: 1, Steps: 35 | Train Loss: 4.161 Vali Loss: 9.034 Vali Acc: 0.540 Test Loss: 9.034 Test Acc: 0.540
Validation loss decreased (inf --> -0.539910).  Saving model ...
Epoch: 2 cost time: 10.900353908538818
Epoch: 2, Steps: 35 | Train Loss: 7.435 Vali Loss: 13.284 Vali Acc: 0.500 Test Loss: 13.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.822407007217407
Epoch: 3, Steps: 35 | Train Loss: 11.082 Vali Loss: 21.812 Vali Acc: 0.480 Test Loss: 21.812 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.050233602523804
Epoch: 4, Steps: 35 | Train Loss: 15.292 Vali Loss: 31.918 Vali Acc: 0.600 Test Loss: 31.918 Test Acc: 0.600
Validation loss decreased (-0.539910 --> -0.599681).  Saving model ...
Epoch: 5 cost time: 11.013564586639404
Epoch: 5, Steps: 35 | Train Loss: 12.622 Vali Loss: 14.518 Vali Acc: 0.580 Test Loss: 14.518 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.247397184371948
Epoch: 6, Steps: 35 | Train Loss: 9.068 Vali Loss: 24.173 Vali Acc: 0.510 Test Loss: 24.173 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.115004062652588
Epoch: 7, Steps: 35 | Train Loss: 28.414 Vali Loss: 30.684 Vali Acc: 0.490 Test Loss: 30.684 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.956745386123657
Epoch: 8, Steps: 35 | Train Loss: 14.309 Vali Loss: 29.881 Vali Acc: 0.530 Test Loss: 29.881 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.257002830505371
Epoch: 9, Steps: 35 | Train Loss: 8.460 Vali Loss: 23.364 Vali Acc: 0.510 Test Loss: 23.364 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.66599440574646
Epoch: 10, Steps: 35 | Train Loss: 9.726 Vali Loss: 46.754 Vali Acc: 0.510 Test Loss: 46.754 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.767764568328857
Epoch: 11, Steps: 35 | Train Loss: 9.604 Vali Loss: 40.730 Vali Acc: 0.530 Test Loss: 40.730 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.70653510093689
Epoch: 12, Steps: 35 | Train Loss: 7.783 Vali Loss: 20.098 Vali Acc: 0.620 Test Loss: 20.098 Test Acc: 0.620
Validation loss decreased (-0.599681 --> -0.619799).  Saving model ...
Epoch: 13 cost time: 11.139926433563232
Epoch: 13, Steps: 35 | Train Loss: 6.016 Vali Loss: 34.794 Vali Acc: 0.550 Test Loss: 34.794 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.07141900062561
Epoch: 14, Steps: 35 | Train Loss: 10.264 Vali Loss: 105.191 Vali Acc: 0.490 Test Loss: 105.191 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.2067232131958
Epoch: 15, Steps: 35 | Train Loss: 12.448 Vali Loss: 111.239 Vali Acc: 0.490 Test Loss: 111.239 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.711343765258789
Epoch: 16, Steps: 35 | Train Loss: 12.698 Vali Loss: 66.501 Vali Acc: 0.500 Test Loss: 66.501 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.095093727111816
Epoch: 17, Steps: 35 | Train Loss: 6.271 Vali Loss: 45.320 Vali Acc: 0.490 Test Loss: 45.320 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.88492465019226
Epoch: 18, Steps: 35 | Train Loss: 6.134 Vali Loss: 40.156 Vali Acc: 0.560 Test Loss: 40.156 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.424979448318481
Epoch: 19, Steps: 35 | Train Loss: 5.340 Vali Loss: 38.032 Vali Acc: 0.560 Test Loss: 38.032 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.354206800460815
Epoch: 20, Steps: 35 | Train Loss: 2.172 Vali Loss: 63.998 Vali Acc: 0.460 Test Loss: 63.998 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.745214700698853
Epoch: 21, Steps: 35 | Train Loss: 7.699 Vali Loss: 45.415 Vali Acc: 0.540 Test Loss: 45.415 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.142317295074463
Epoch: 22, Steps: 35 | Train Loss: 6.760 Vali Loss: 42.656 Vali Acc: 0.550 Test Loss: 42.656 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6457890
model size : 34.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.321760892868042
Epoch: 1, Steps: 35 | Train Loss: 5.687 Vali Loss: 10.743 Vali Acc: 0.470 Test Loss: 10.743 Test Acc: 0.470
Validation loss decreased (inf --> -0.469893).  Saving model ...
Epoch: 2 cost time: 14.042530298233032
Epoch: 2, Steps: 35 | Train Loss: 14.439 Vali Loss: 27.340 Vali Acc: 0.500 Test Loss: 27.340 Test Acc: 0.500
Validation loss decreased (-0.469893 --> -0.499727).  Saving model ...
Epoch: 3 cost time: 14.219131708145142
Epoch: 3, Steps: 35 | Train Loss: 19.821 Vali Loss: 17.410 Vali Acc: 0.450 Test Loss: 17.410 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.31177568435669
Epoch: 4, Steps: 35 | Train Loss: 17.450 Vali Loss: 33.455 Vali Acc: 0.460 Test Loss: 33.455 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.780727624893188
Epoch: 5, Steps: 35 | Train Loss: 17.689 Vali Loss: 30.515 Vali Acc: 0.510 Test Loss: 30.515 Test Acc: 0.510
Validation loss decreased (-0.499727 --> -0.509695).  Saving model ...
Epoch: 6 cost time: 13.667739629745483
Epoch: 6, Steps: 35 | Train Loss: 14.462 Vali Loss: 64.081 Vali Acc: 0.520 Test Loss: 64.081 Test Acc: 0.520
Validation loss decreased (-0.509695 --> -0.519359).  Saving model ...
Epoch: 7 cost time: 13.91893720626831
Epoch: 7, Steps: 35 | Train Loss: 12.006 Vali Loss: 20.908 Vali Acc: 0.540 Test Loss: 20.908 Test Acc: 0.540
Validation loss decreased (-0.519359 --> -0.539791).  Saving model ...
Epoch: 8 cost time: 14.859922647476196
Epoch: 8, Steps: 35 | Train Loss: 6.564 Vali Loss: 16.655 Vali Acc: 0.580 Test Loss: 16.655 Test Acc: 0.580
Validation loss decreased (-0.539791 --> -0.579833).  Saving model ...
Epoch: 9 cost time: 14.486032724380493
Epoch: 9, Steps: 35 | Train Loss: 5.959 Vali Loss: 73.921 Vali Acc: 0.530 Test Loss: 73.921 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.275673151016235
Epoch: 10, Steps: 35 | Train Loss: 13.862 Vali Loss: 34.151 Vali Acc: 0.510 Test Loss: 34.151 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.172182559967041
Epoch: 11, Steps: 35 | Train Loss: 13.433 Vali Loss: 64.016 Vali Acc: 0.460 Test Loss: 64.016 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.213337659835815
Epoch: 12, Steps: 35 | Train Loss: 4.944 Vali Loss: 37.501 Vali Acc: 0.480 Test Loss: 37.501 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.113918542861938
Epoch: 13, Steps: 35 | Train Loss: 4.490 Vali Loss: 35.291 Vali Acc: 0.480 Test Loss: 35.291 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.6066575050354
Epoch: 14, Steps: 35 | Train Loss: 3.308 Vali Loss: 38.167 Vali Acc: 0.490 Test Loss: 38.167 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.75870156288147
Epoch: 15, Steps: 35 | Train Loss: 6.977 Vali Loss: 36.517 Vali Acc: 0.570 Test Loss: 36.517 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.423290491104126
Epoch: 16, Steps: 35 | Train Loss: 8.025 Vali Loss: 109.422 Vali Acc: 0.510 Test Loss: 109.422 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.385683298110962
Epoch: 17, Steps: 35 | Train Loss: 8.798 Vali Loss: 60.560 Vali Acc: 0.530 Test Loss: 60.560 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 15.495816469192505
Epoch: 18, Steps: 35 | Train Loss: 2.707 Vali Loss: 88.340 Vali Acc: 0.560 Test Loss: 88.340 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5409314
model size : 30.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.001221656799316
Epoch: 1, Steps: 35 | Train Loss: 5.258 Vali Loss: 4.086 Vali Acc: 0.570 Test Loss: 4.086 Test Acc: 0.570
Validation loss decreased (inf --> -0.569959).  Saving model ...
Epoch: 2 cost time: 13.150652647018433
Epoch: 2, Steps: 35 | Train Loss: 12.596 Vali Loss: 20.496 Vali Acc: 0.500 Test Loss: 20.496 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.488402366638184
Epoch: 3, Steps: 35 | Train Loss: 18.167 Vali Loss: 18.678 Vali Acc: 0.520 Test Loss: 18.678 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.03611969947815
Epoch: 4, Steps: 35 | Train Loss: 16.270 Vali Loss: 47.531 Vali Acc: 0.500 Test Loss: 47.531 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.582975387573242
Epoch: 5, Steps: 35 | Train Loss: 12.301 Vali Loss: 17.525 Vali Acc: 0.530 Test Loss: 17.525 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.929307222366333
Epoch: 6, Steps: 35 | Train Loss: 10.265 Vali Loss: 26.109 Vali Acc: 0.530 Test Loss: 26.109 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.74002718925476
Epoch: 7, Steps: 35 | Train Loss: 10.884 Vali Loss: 20.029 Vali Acc: 0.610 Test Loss: 20.029 Test Acc: 0.610
Validation loss decreased (-0.569959 --> -0.609800).  Saving model ...
Epoch: 8 cost time: 13.639228343963623
Epoch: 8, Steps: 35 | Train Loss: 12.071 Vali Loss: 39.526 Vali Acc: 0.510 Test Loss: 39.526 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.97542929649353
Epoch: 9, Steps: 35 | Train Loss: 10.274 Vali Loss: 101.898 Vali Acc: 0.490 Test Loss: 101.898 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.6558997631073
Epoch: 10, Steps: 35 | Train Loss: 7.105 Vali Loss: 50.200 Vali Acc: 0.520 Test Loss: 50.200 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.012847661972046
Epoch: 11, Steps: 35 | Train Loss: 6.621 Vali Loss: 84.065 Vali Acc: 0.420 Test Loss: 84.065 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.388001680374146
Epoch: 12, Steps: 35 | Train Loss: 7.994 Vali Loss: 94.899 Vali Acc: 0.510 Test Loss: 94.899 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.815510272979736
Epoch: 13, Steps: 35 | Train Loss: 11.715 Vali Loss: 45.332 Vali Acc: 0.570 Test Loss: 45.332 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.429038047790527
Epoch: 14, Steps: 35 | Train Loss: 6.583 Vali Loss: 37.685 Vali Acc: 0.550 Test Loss: 37.685 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.14218020439148
Epoch: 15, Steps: 35 | Train Loss: 5.396 Vali Loss: 42.043 Vali Acc: 0.590 Test Loss: 42.043 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.76117491722107
Epoch: 16, Steps: 35 | Train Loss: 7.264 Vali Loss: 58.308 Vali Acc: 0.570 Test Loss: 58.308 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.198098182678223
Epoch: 17, Steps: 35 | Train Loss: 5.776 Vali Loss: 58.172 Vali Acc: 0.470 Test Loss: 58.172 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5409314
model size : 30.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.977260828018188
Epoch: 1, Steps: 35 | Train Loss: 4.608 Vali Loss: 14.631 Vali Acc: 0.520 Test Loss: 14.631 Test Acc: 0.520
Validation loss decreased (inf --> -0.519854).  Saving model ...
Epoch: 2 cost time: 11.911448240280151
Epoch: 2, Steps: 35 | Train Loss: 13.343 Vali Loss: 14.165 Vali Acc: 0.490 Test Loss: 14.165 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.772544622421265
Epoch: 3, Steps: 35 | Train Loss: 11.052 Vali Loss: 17.072 Vali Acc: 0.510 Test Loss: 17.072 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.960946321487427
Epoch: 4, Steps: 35 | Train Loss: 11.029 Vali Loss: 23.540 Vali Acc: 0.520 Test Loss: 23.540 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.033084154129028
Epoch: 5, Steps: 35 | Train Loss: 10.423 Vali Loss: 18.251 Vali Acc: 0.550 Test Loss: 18.251 Test Acc: 0.550
Validation loss decreased (-0.519854 --> -0.549817).  Saving model ...
Epoch: 6 cost time: 11.831560611724854
Epoch: 6, Steps: 35 | Train Loss: 14.948 Vali Loss: 26.114 Vali Acc: 0.510 Test Loss: 26.114 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.184047222137451
Epoch: 7, Steps: 35 | Train Loss: 21.372 Vali Loss: 24.816 Vali Acc: 0.540 Test Loss: 24.816 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.692662954330444
Epoch: 8, Steps: 35 | Train Loss: 24.529 Vali Loss: 30.529 Vali Acc: 0.570 Test Loss: 30.529 Test Acc: 0.570
Validation loss decreased (-0.549817 --> -0.569695).  Saving model ...
Epoch: 9 cost time: 11.704554319381714
Epoch: 9, Steps: 35 | Train Loss: 14.918 Vali Loss: 53.294 Vali Acc: 0.500 Test Loss: 53.294 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.975545406341553
Epoch: 10, Steps: 35 | Train Loss: 16.114 Vali Loss: 36.879 Vali Acc: 0.530 Test Loss: 36.879 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.722292423248291
Epoch: 11, Steps: 35 | Train Loss: 5.253 Vali Loss: 23.486 Vali Acc: 0.500 Test Loss: 23.486 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.510176420211792
Epoch: 12, Steps: 35 | Train Loss: 4.073 Vali Loss: 23.704 Vali Acc: 0.570 Test Loss: 23.704 Test Acc: 0.570
Validation loss decreased (-0.569695 --> -0.569763).  Saving model ...
Epoch: 13 cost time: 11.321863412857056
Epoch: 13, Steps: 35 | Train Loss: 7.021 Vali Loss: 74.996 Vali Acc: 0.520 Test Loss: 74.996 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.76822018623352
Epoch: 14, Steps: 35 | Train Loss: 8.246 Vali Loss: 59.276 Vali Acc: 0.470 Test Loss: 59.276 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.836807012557983
Epoch: 15, Steps: 35 | Train Loss: 8.543 Vali Loss: 67.473 Vali Acc: 0.490 Test Loss: 67.473 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.81930947303772
Epoch: 16, Steps: 35 | Train Loss: 5.407 Vali Loss: 44.306 Vali Acc: 0.470 Test Loss: 44.306 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.298460245132446
Epoch: 17, Steps: 35 | Train Loss: 7.059 Vali Loss: 57.654 Vali Acc: 0.500 Test Loss: 57.654 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.279327392578125
Epoch: 18, Steps: 35 | Train Loss: 4.234 Vali Loss: 45.489 Vali Acc: 0.520 Test Loss: 45.489 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.945439100265503
Epoch: 19, Steps: 35 | Train Loss: 5.293 Vali Loss: 44.870 Vali Acc: 0.510 Test Loss: 44.870 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.99926233291626
Epoch: 20, Steps: 35 | Train Loss: 10.930 Vali Loss: 74.059 Vali Acc: 0.530 Test Loss: 74.059 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.396620512008667
Epoch: 21, Steps: 35 | Train Loss: 7.082 Vali Loss: 77.705 Vali Acc: 0.470 Test Loss: 77.705 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.29185676574707
Epoch: 22, Steps: 35 | Train Loss: 2.700 Vali Loss: 51.639 Vali Acc: 0.540 Test Loss: 51.639 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5409314
model size : 30.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.503219842910767
Epoch: 1, Steps: 35 | Train Loss: 4.953 Vali Loss: 3.867 Vali Acc: 0.520 Test Loss: 3.867 Test Acc: 0.520
Validation loss decreased (inf --> -0.519961).  Saving model ...
Epoch: 2 cost time: 10.858069658279419
Epoch: 2, Steps: 35 | Train Loss: 9.289 Vali Loss: 16.787 Vali Acc: 0.450 Test Loss: 16.787 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.012809991836548
Epoch: 3, Steps: 35 | Train Loss: 11.505 Vali Loss: 16.031 Vali Acc: 0.520 Test Loss: 16.031 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.923190593719482
Epoch: 4, Steps: 35 | Train Loss: 14.335 Vali Loss: 14.326 Vali Acc: 0.540 Test Loss: 14.326 Test Acc: 0.540
Validation loss decreased (-0.519961 --> -0.539857).  Saving model ...
Epoch: 5 cost time: 10.81764006614685
Epoch: 5, Steps: 35 | Train Loss: 20.087 Vali Loss: 33.461 Vali Acc: 0.550 Test Loss: 33.461 Test Acc: 0.550
Validation loss decreased (-0.539857 --> -0.549665).  Saving model ...
Epoch: 6 cost time: 11.220999002456665
Epoch: 6, Steps: 35 | Train Loss: 11.372 Vali Loss: 27.829 Vali Acc: 0.550 Test Loss: 27.829 Test Acc: 0.550
Validation loss decreased (-0.549665 --> -0.549722).  Saving model ...
Epoch: 7 cost time: 11.293729782104492
Epoch: 7, Steps: 35 | Train Loss: 22.660 Vali Loss: 30.202 Vali Acc: 0.530 Test Loss: 30.202 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.525481700897217
Epoch: 8, Steps: 35 | Train Loss: 38.841 Vali Loss: 48.909 Vali Acc: 0.490 Test Loss: 48.909 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.968710660934448
Epoch: 9, Steps: 35 | Train Loss: 11.408 Vali Loss: 41.765 Vali Acc: 0.490 Test Loss: 41.765 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.654764652252197
Epoch: 10, Steps: 35 | Train Loss: 11.798 Vali Loss: 28.204 Vali Acc: 0.450 Test Loss: 28.204 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.671541929244995
Epoch: 11, Steps: 35 | Train Loss: 10.328 Vali Loss: 51.221 Vali Acc: 0.470 Test Loss: 51.221 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.118180751800537
Epoch: 12, Steps: 35 | Train Loss: 26.196 Vali Loss: 45.426 Vali Acc: 0.540 Test Loss: 45.426 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.660695552825928
Epoch: 13, Steps: 35 | Train Loss: 16.027 Vali Loss: 44.179 Vali Acc: 0.500 Test Loss: 44.179 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.963369607925415
Epoch: 14, Steps: 35 | Train Loss: 6.132 Vali Loss: 32.748 Vali Acc: 0.570 Test Loss: 32.748 Test Acc: 0.570
Validation loss decreased (-0.549722 --> -0.569673).  Saving model ...
Epoch: 15 cost time: 10.452869415283203
Epoch: 15, Steps: 35 | Train Loss: 6.106 Vali Loss: 39.445 Vali Acc: 0.490 Test Loss: 39.445 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.536962509155273
Epoch: 16, Steps: 35 | Train Loss: 9.886 Vali Loss: 34.157 Vali Acc: 0.500 Test Loss: 34.157 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.489924430847168
Epoch: 17, Steps: 35 | Train Loss: 3.584 Vali Loss: 58.758 Vali Acc: 0.520 Test Loss: 58.758 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.879379510879517
Epoch: 18, Steps: 35 | Train Loss: 6.407 Vali Loss: 46.443 Vali Acc: 0.510 Test Loss: 46.443 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.56587290763855
Epoch: 19, Steps: 35 | Train Loss: 9.093 Vali Loss: 68.170 Vali Acc: 0.450 Test Loss: 68.170 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.374894142150879
Epoch: 20, Steps: 35 | Train Loss: 5.169 Vali Loss: 107.172 Vali Acc: 0.490 Test Loss: 107.172 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.580686807632446
Epoch: 21, Steps: 35 | Train Loss: 6.473 Vali Loss: 50.523 Vali Acc: 0.530 Test Loss: 50.523 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.670905828475952
Epoch: 22, Steps: 35 | Train Loss: 6.215 Vali Loss: 41.951 Vali Acc: 0.470 Test Loss: 41.951 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.881700277328491
Epoch: 23, Steps: 35 | Train Loss: 3.946 Vali Loss: 42.756 Vali Acc: 0.540 Test Loss: 42.756 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.060077428817749
Epoch: 24, Steps: 35 | Train Loss: 1.601 Vali Loss: 65.451 Vali Acc: 0.460 Test Loss: 65.451 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5409314
model size : 30.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.32794451713562
Epoch: 1, Steps: 35 | Train Loss: 6.361 Vali Loss: 11.468 Vali Acc: 0.480 Test Loss: 11.468 Test Acc: 0.480
Validation loss decreased (inf --> -0.479885).  Saving model ...
Epoch: 2 cost time: 13.671573638916016
Epoch: 2, Steps: 35 | Train Loss: 18.475 Vali Loss: 24.175 Vali Acc: 0.510 Test Loss: 24.175 Test Acc: 0.510
Validation loss decreased (-0.479885 --> -0.509758).  Saving model ...
Epoch: 3 cost time: 14.180553674697876
Epoch: 3, Steps: 35 | Train Loss: 17.732 Vali Loss: 30.233 Vali Acc: 0.520 Test Loss: 30.233 Test Acc: 0.520
Validation loss decreased (-0.509758 --> -0.519698).  Saving model ...
Epoch: 4 cost time: 14.434165477752686
Epoch: 4, Steps: 35 | Train Loss: 12.641 Vali Loss: 23.377 Vali Acc: 0.490 Test Loss: 23.377 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.692363023757935
Epoch: 5, Steps: 35 | Train Loss: 8.730 Vali Loss: 34.285 Vali Acc: 0.490 Test Loss: 34.285 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.09439492225647
Epoch: 6, Steps: 35 | Train Loss: 13.583 Vali Loss: 31.199 Vali Acc: 0.500 Test Loss: 31.199 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.20275330543518
Epoch: 7, Steps: 35 | Train Loss: 15.893 Vali Loss: 49.752 Vali Acc: 0.480 Test Loss: 49.752 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.886595964431763
Epoch: 8, Steps: 35 | Train Loss: 10.426 Vali Loss: 22.005 Vali Acc: 0.480 Test Loss: 22.005 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.605918169021606
Epoch: 9, Steps: 35 | Train Loss: 8.801 Vali Loss: 57.927 Vali Acc: 0.460 Test Loss: 57.927 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.682539939880371
Epoch: 10, Steps: 35 | Train Loss: 10.041 Vali Loss: 27.141 Vali Acc: 0.430 Test Loss: 27.141 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.60673999786377
Epoch: 11, Steps: 35 | Train Loss: 6.205 Vali Loss: 28.000 Vali Acc: 0.530 Test Loss: 28.000 Test Acc: 0.530
Validation loss decreased (-0.519698 --> -0.529720).  Saving model ...
Epoch: 12 cost time: 13.354073524475098
Epoch: 12, Steps: 35 | Train Loss: 13.491 Vali Loss: 28.184 Vali Acc: 0.550 Test Loss: 28.184 Test Acc: 0.550
Validation loss decreased (-0.529720 --> -0.549718).  Saving model ...
Epoch: 13 cost time: 13.692296028137207
Epoch: 13, Steps: 35 | Train Loss: 7.690 Vali Loss: 36.253 Vali Acc: 0.520 Test Loss: 36.253 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.730891466140747
Epoch: 14, Steps: 35 | Train Loss: 3.900 Vali Loss: 34.864 Vali Acc: 0.460 Test Loss: 34.864 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.582544326782227
Epoch: 15, Steps: 35 | Train Loss: 3.143 Vali Loss: 34.618 Vali Acc: 0.560 Test Loss: 34.618 Test Acc: 0.560
Validation loss decreased (-0.549718 --> -0.559654).  Saving model ...
Epoch: 16 cost time: 13.806741952896118
Epoch: 16, Steps: 35 | Train Loss: 6.408 Vali Loss: 42.994 Vali Acc: 0.490 Test Loss: 42.994 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.213812589645386
Epoch: 17, Steps: 35 | Train Loss: 12.635 Vali Loss: 60.687 Vali Acc: 0.500 Test Loss: 60.687 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.121179103851318
Epoch: 18, Steps: 35 | Train Loss: 20.731 Vali Loss: 61.020 Vali Acc: 0.510 Test Loss: 61.020 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.924404382705688
Epoch: 19, Steps: 35 | Train Loss: 7.856 Vali Loss: 73.020 Vali Acc: 0.570 Test Loss: 73.020 Test Acc: 0.570
Validation loss decreased (-0.559654 --> -0.569270).  Saving model ...
Epoch: 20 cost time: 14.111621379852295
Epoch: 20, Steps: 35 | Train Loss: 2.992 Vali Loss: 50.687 Vali Acc: 0.500 Test Loss: 50.687 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.530910730361938
Epoch: 21, Steps: 35 | Train Loss: 4.476 Vali Loss: 78.363 Vali Acc: 0.560 Test Loss: 78.363 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.947649002075195
Epoch: 22, Steps: 35 | Train Loss: 5.882 Vali Loss: 49.168 Vali Acc: 0.470 Test Loss: 49.168 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 14.064445495605469
Epoch: 23, Steps: 35 | Train Loss: 3.988 Vali Loss: 47.780 Vali Acc: 0.530 Test Loss: 47.780 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 14.099055290222168
Epoch: 24, Steps: 35 | Train Loss: 3.554 Vali Loss: 72.507 Vali Acc: 0.550 Test Loss: 72.507 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 14.614940643310547
Epoch: 25, Steps: 35 | Train Loss: 9.317 Vali Loss: 92.005 Vali Acc: 0.520 Test Loss: 92.005 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 14.095661878585815
Epoch: 26, Steps: 35 | Train Loss: 1.442 Vali Loss: 64.873 Vali Acc: 0.550 Test Loss: 64.873 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.945419311523438
Epoch: 27, Steps: 35 | Train Loss: 2.271 Vali Loss: 97.152 Vali Acc: 0.570 Test Loss: 97.152 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.306519985198975
Epoch: 28, Steps: 35 | Train Loss: 3.182 Vali Loss: 115.282 Vali Acc: 0.550 Test Loss: 115.282 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 14.47087025642395
Epoch: 29, Steps: 35 | Train Loss: 2.155 Vali Loss: 93.367 Vali Acc: 0.490 Test Loss: 93.367 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4885026
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.87590503692627
Epoch: 1, Steps: 35 | Train Loss: 7.712 Vali Loss: 19.062 Vali Acc: 0.420 Test Loss: 19.062 Test Acc: 0.420
Validation loss decreased (inf --> -0.419809).  Saving model ...
Epoch: 2 cost time: 12.544234275817871
Epoch: 2, Steps: 35 | Train Loss: 20.329 Vali Loss: 24.860 Vali Acc: 0.460 Test Loss: 24.860 Test Acc: 0.460
Validation loss decreased (-0.419809 --> -0.459751).  Saving model ...
Epoch: 3 cost time: 12.739334106445312
Epoch: 3, Steps: 35 | Train Loss: 12.923 Vali Loss: 42.301 Vali Acc: 0.490 Test Loss: 42.301 Test Acc: 0.490
Validation loss decreased (-0.459751 --> -0.489577).  Saving model ...
Epoch: 4 cost time: 12.649089574813843
Epoch: 4, Steps: 35 | Train Loss: 14.367 Vali Loss: 27.767 Vali Acc: 0.490 Test Loss: 27.767 Test Acc: 0.490
Validation loss decreased (-0.489577 --> -0.489722).  Saving model ...
Epoch: 5 cost time: 12.318989276885986
Epoch: 5, Steps: 35 | Train Loss: 11.692 Vali Loss: 21.297 Vali Acc: 0.470 Test Loss: 21.297 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.22541880607605
Epoch: 6, Steps: 35 | Train Loss: 11.109 Vali Loss: 19.914 Vali Acc: 0.500 Test Loss: 19.914 Test Acc: 0.500
Validation loss decreased (-0.489722 --> -0.499801).  Saving model ...
Epoch: 7 cost time: 12.294638633728027
Epoch: 7, Steps: 35 | Train Loss: 20.887 Vali Loss: 21.988 Vali Acc: 0.540 Test Loss: 21.988 Test Acc: 0.540
Validation loss decreased (-0.499801 --> -0.539780).  Saving model ...
Epoch: 8 cost time: 12.580112934112549
Epoch: 8, Steps: 35 | Train Loss: 15.685 Vali Loss: 31.633 Vali Acc: 0.480 Test Loss: 31.633 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.760114431381226
Epoch: 9, Steps: 35 | Train Loss: 11.446 Vali Loss: 68.599 Vali Acc: 0.490 Test Loss: 68.599 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.275233507156372
Epoch: 10, Steps: 35 | Train Loss: 9.755 Vali Loss: 19.874 Vali Acc: 0.540 Test Loss: 19.874 Test Acc: 0.540
Validation loss decreased (-0.539780 --> -0.539801).  Saving model ...
Epoch: 11 cost time: 12.98902416229248
Epoch: 11, Steps: 35 | Train Loss: 12.636 Vali Loss: 64.062 Vali Acc: 0.530 Test Loss: 64.062 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.799469947814941
Epoch: 12, Steps: 35 | Train Loss: 10.669 Vali Loss: 35.813 Vali Acc: 0.550 Test Loss: 35.813 Test Acc: 0.550
Validation loss decreased (-0.539801 --> -0.549642).  Saving model ...
Epoch: 13 cost time: 12.584354162216187
Epoch: 13, Steps: 35 | Train Loss: 2.647 Vali Loss: 32.459 Vali Acc: 0.520 Test Loss: 32.459 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.625446557998657
Epoch: 14, Steps: 35 | Train Loss: 8.337 Vali Loss: 72.192 Vali Acc: 0.450 Test Loss: 72.192 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.344743728637695
Epoch: 15, Steps: 35 | Train Loss: 28.208 Vali Loss: 33.887 Vali Acc: 0.600 Test Loss: 33.887 Test Acc: 0.600
Validation loss decreased (-0.549642 --> -0.599661).  Saving model ...
Epoch: 16 cost time: 12.621066331863403
Epoch: 16, Steps: 35 | Train Loss: 7.743 Vali Loss: 64.064 Vali Acc: 0.480 Test Loss: 64.064 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.900885343551636
Epoch: 17, Steps: 35 | Train Loss: 6.502 Vali Loss: 97.042 Vali Acc: 0.530 Test Loss: 97.042 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.848982095718384
Epoch: 18, Steps: 35 | Train Loss: 13.668 Vali Loss: 106.355 Vali Acc: 0.530 Test Loss: 106.355 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.956599712371826
Epoch: 19, Steps: 35 | Train Loss: 14.669 Vali Loss: 64.418 Vali Acc: 0.540 Test Loss: 64.418 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.367358446121216
Epoch: 20, Steps: 35 | Train Loss: 11.873 Vali Loss: 52.742 Vali Acc: 0.550 Test Loss: 52.742 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.977480173110962
Epoch: 21, Steps: 35 | Train Loss: 6.323 Vali Loss: 96.518 Vali Acc: 0.520 Test Loss: 96.518 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.292401552200317
Epoch: 22, Steps: 35 | Train Loss: 3.525 Vali Loss: 50.003 Vali Acc: 0.540 Test Loss: 50.003 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.675456285476685
Epoch: 23, Steps: 35 | Train Loss: 2.573 Vali Loss: 91.694 Vali Acc: 0.580 Test Loss: 91.694 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.965675830841064
Epoch: 24, Steps: 35 | Train Loss: 2.271 Vali Loss: 110.276 Vali Acc: 0.470 Test Loss: 110.276 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.18059492111206
Epoch: 25, Steps: 35 | Train Loss: 3.249 Vali Loss: 87.961 Vali Acc: 0.530 Test Loss: 87.961 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4885026
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.065104484558105
Epoch: 1, Steps: 35 | Train Loss: 4.983 Vali Loss: 8.638 Vali Acc: 0.480 Test Loss: 8.638 Test Acc: 0.480
Validation loss decreased (inf --> -0.479914).  Saving model ...
Epoch: 2 cost time: 11.294193506240845
Epoch: 2, Steps: 35 | Train Loss: 10.387 Vali Loss: 32.315 Vali Acc: 0.510 Test Loss: 32.315 Test Acc: 0.510
Validation loss decreased (-0.479914 --> -0.509677).  Saving model ...
Epoch: 3 cost time: 11.456572532653809
Epoch: 3, Steps: 35 | Train Loss: 21.542 Vali Loss: 37.368 Vali Acc: 0.470 Test Loss: 37.368 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.95785665512085
Epoch: 4, Steps: 35 | Train Loss: 14.281 Vali Loss: 31.773 Vali Acc: 0.510 Test Loss: 31.773 Test Acc: 0.510
Validation loss decreased (-0.509677 --> -0.509682).  Saving model ...
Epoch: 5 cost time: 11.34562349319458
Epoch: 5, Steps: 35 | Train Loss: 8.648 Vali Loss: 21.635 Vali Acc: 0.530 Test Loss: 21.635 Test Acc: 0.530
Validation loss decreased (-0.509682 --> -0.529784).  Saving model ...
Epoch: 6 cost time: 11.690187454223633
Epoch: 6, Steps: 35 | Train Loss: 9.659 Vali Loss: 37.197 Vali Acc: 0.470 Test Loss: 37.197 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.391463994979858
Epoch: 7, Steps: 35 | Train Loss: 25.847 Vali Loss: 36.577 Vali Acc: 0.510 Test Loss: 36.577 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.16763710975647
Epoch: 8, Steps: 35 | Train Loss: 12.537 Vali Loss: 47.015 Vali Acc: 0.470 Test Loss: 47.015 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.453960657119751
Epoch: 9, Steps: 35 | Train Loss: 9.256 Vali Loss: 79.179 Vali Acc: 0.500 Test Loss: 79.179 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.660268068313599
Epoch: 10, Steps: 35 | Train Loss: 14.359 Vali Loss: 44.105 Vali Acc: 0.520 Test Loss: 44.105 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.744063377380371
Epoch: 11, Steps: 35 | Train Loss: 6.497 Vali Loss: 49.281 Vali Acc: 0.490 Test Loss: 49.281 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.649630546569824
Epoch: 12, Steps: 35 | Train Loss: 13.382 Vali Loss: 58.238 Vali Acc: 0.530 Test Loss: 58.238 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.217050552368164
Epoch: 13, Steps: 35 | Train Loss: 14.554 Vali Loss: 44.887 Vali Acc: 0.540 Test Loss: 44.887 Test Acc: 0.540
Validation loss decreased (-0.529784 --> -0.539551).  Saving model ...
Epoch: 14 cost time: 11.374731302261353
Epoch: 14, Steps: 35 | Train Loss: 9.020 Vali Loss: 39.227 Vali Acc: 0.490 Test Loss: 39.227 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.721396207809448
Epoch: 15, Steps: 35 | Train Loss: 6.035 Vali Loss: 45.752 Vali Acc: 0.460 Test Loss: 45.752 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.378451824188232
Epoch: 16, Steps: 35 | Train Loss: 7.376 Vali Loss: 68.461 Vali Acc: 0.460 Test Loss: 68.461 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.411029815673828
Epoch: 17, Steps: 35 | Train Loss: 5.465 Vali Loss: 55.915 Vali Acc: 0.500 Test Loss: 55.915 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.41268014907837
Epoch: 18, Steps: 35 | Train Loss: 5.238 Vali Loss: 53.205 Vali Acc: 0.500 Test Loss: 53.205 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.506906986236572
Epoch: 19, Steps: 35 | Train Loss: 7.195 Vali Loss: 50.519 Vali Acc: 0.550 Test Loss: 50.519 Test Acc: 0.550
Validation loss decreased (-0.539551 --> -0.549495).  Saving model ...
Epoch: 20 cost time: 11.71163535118103
Epoch: 20, Steps: 35 | Train Loss: 2.039 Vali Loss: 61.166 Vali Acc: 0.550 Test Loss: 61.166 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.410545587539673
Epoch: 21, Steps: 35 | Train Loss: 5.562 Vali Loss: 103.216 Vali Acc: 0.550 Test Loss: 103.216 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.200043201446533
Epoch: 22, Steps: 35 | Train Loss: 17.093 Vali Loss: 68.548 Vali Acc: 0.450 Test Loss: 68.548 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.033390998840332
Epoch: 23, Steps: 35 | Train Loss: 7.605 Vali Loss: 71.648 Vali Acc: 0.430 Test Loss: 71.648 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.50435209274292
Epoch: 24, Steps: 35 | Train Loss: 13.437 Vali Loss: 54.983 Vali Acc: 0.520 Test Loss: 54.983 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.714412212371826
Epoch: 25, Steps: 35 | Train Loss: 6.596 Vali Loss: 135.824 Vali Acc: 0.510 Test Loss: 135.824 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.567533016204834
Epoch: 26, Steps: 35 | Train Loss: 3.197 Vali Loss: 110.349 Vali Acc: 0.560 Test Loss: 110.349 Test Acc: 0.560
Validation loss decreased (-0.549495 --> -0.558897).  Saving model ...
Epoch: 27 cost time: 11.02522611618042
Epoch: 27, Steps: 35 | Train Loss: 4.794 Vali Loss: 86.154 Vali Acc: 0.540 Test Loss: 86.154 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.078139305114746
Epoch: 28, Steps: 35 | Train Loss: 7.926 Vali Loss: 145.988 Vali Acc: 0.510 Test Loss: 145.988 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 11.156507968902588
Epoch: 29, Steps: 35 | Train Loss: 6.809 Vali Loss: 161.604 Vali Acc: 0.490 Test Loss: 161.604 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.149726867675781
Epoch: 30, Steps: 35 | Train Loss: 9.661 Vali Loss: 76.952 Vali Acc: 0.550 Test Loss: 76.952 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 11.250125408172607
Epoch: 31, Steps: 35 | Train Loss: 3.214 Vali Loss: 61.203 Vali Acc: 0.540 Test Loss: 61.203 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 11.158475875854492
Epoch: 32, Steps: 35 | Train Loss: 6.960 Vali Loss: 63.313 Vali Acc: 0.570 Test Loss: 63.313 Test Acc: 0.570
Validation loss decreased (-0.558897 --> -0.569367).  Saving model ...
Epoch: 33 cost time: 11.411984920501709
Epoch: 33, Steps: 35 | Train Loss: 5.985 Vali Loss: 127.236 Vali Acc: 0.530 Test Loss: 127.236 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 11.27687668800354
Epoch: 34, Steps: 35 | Train Loss: 5.025 Vali Loss: 111.518 Vali Acc: 0.570 Test Loss: 111.518 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 10.978570222854614
Epoch: 35, Steps: 35 | Train Loss: 4.809 Vali Loss: 193.046 Vali Acc: 0.520 Test Loss: 193.046 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 11.46249270439148
Epoch: 36, Steps: 35 | Train Loss: 2.091 Vali Loss: 117.249 Vali Acc: 0.530 Test Loss: 117.249 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 11.871142625808716
Epoch: 37, Steps: 35 | Train Loss: 0.761 Vali Loss: 108.184 Vali Acc: 0.460 Test Loss: 108.184 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 11.976632833480835
Epoch: 38, Steps: 35 | Train Loss: 3.917 Vali Loss: 103.467 Vali Acc: 0.580 Test Loss: 103.467 Test Acc: 0.580
Validation loss decreased (-0.569367 --> -0.578965).  Saving model ...
Epoch: 39 cost time: 11.086720943450928
Epoch: 39, Steps: 35 | Train Loss: 1.969 Vali Loss: 133.774 Vali Acc: 0.480 Test Loss: 133.774 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 11.601440668106079
Epoch: 40, Steps: 35 | Train Loss: 5.098 Vali Loss: 90.979 Vali Acc: 0.540 Test Loss: 90.979 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 11.23564076423645
Epoch: 41, Steps: 35 | Train Loss: 3.924 Vali Loss: 153.958 Vali Acc: 0.550 Test Loss: 153.958 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 11.302189826965332
Epoch: 42, Steps: 35 | Train Loss: 3.715 Vali Loss: 111.669 Vali Acc: 0.520 Test Loss: 111.669 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 11.413569688796997
Epoch: 43, Steps: 35 | Train Loss: 3.443 Vali Loss: 134.354 Vali Acc: 0.530 Test Loss: 134.354 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 11.363711595535278
Epoch: 44, Steps: 35 | Train Loss: 7.281 Vali Loss: 92.980 Vali Acc: 0.470 Test Loss: 92.980 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 11.38563871383667
Epoch: 45, Steps: 35 | Train Loss: 5.937 Vali Loss: 86.787 Vali Acc: 0.570 Test Loss: 86.787 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 11.218038558959961
Epoch: 46, Steps: 35 | Train Loss: 5.269 Vali Loss: 127.942 Vali Acc: 0.510 Test Loss: 127.942 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 11.360412359237671
Epoch: 47, Steps: 35 | Train Loss: 4.825 Vali Loss: 100.670 Vali Acc: 0.520 Test Loss: 100.670 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 11.445534944534302
Epoch: 48, Steps: 35 | Train Loss: 1.910 Vali Loss: 102.606 Vali Acc: 0.480 Test Loss: 102.606 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4885026
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.166923761367798
Epoch: 1, Steps: 35 | Train Loss: 5.100 Vali Loss: 14.375 Vali Acc: 0.350 Test Loss: 14.375 Test Acc: 0.350
Validation loss decreased (inf --> -0.349856).  Saving model ...
Epoch: 2 cost time: 10.006173849105835
Epoch: 2, Steps: 35 | Train Loss: 16.589 Vali Loss: 28.972 Vali Acc: 0.370 Test Loss: 28.972 Test Acc: 0.370
Validation loss decreased (-0.349856 --> -0.369710).  Saving model ...
Epoch: 3 cost time: 10.066977500915527
Epoch: 3, Steps: 35 | Train Loss: 10.790 Vali Loss: 14.906 Vali Acc: 0.510 Test Loss: 14.906 Test Acc: 0.510
Validation loss decreased (-0.369710 --> -0.509851).  Saving model ...
Epoch: 4 cost time: 10.453501224517822
Epoch: 4, Steps: 35 | Train Loss: 8.974 Vali Loss: 50.835 Vali Acc: 0.430 Test Loss: 50.835 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.03671646118164
Epoch: 5, Steps: 35 | Train Loss: 13.881 Vali Loss: 13.274 Vali Acc: 0.580 Test Loss: 13.274 Test Acc: 0.580
Validation loss decreased (-0.509851 --> -0.579867).  Saving model ...
Epoch: 6 cost time: 9.900691270828247
Epoch: 6, Steps: 35 | Train Loss: 15.764 Vali Loss: 32.270 Vali Acc: 0.440 Test Loss: 32.270 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.061435461044312
Epoch: 7, Steps: 35 | Train Loss: 21.700 Vali Loss: 48.989 Vali Acc: 0.490 Test Loss: 48.989 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.908503532409668
Epoch: 8, Steps: 35 | Train Loss: 13.144 Vali Loss: 46.303 Vali Acc: 0.480 Test Loss: 46.303 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.234322309494019
Epoch: 9, Steps: 35 | Train Loss: 8.821 Vali Loss: 48.164 Vali Acc: 0.500 Test Loss: 48.164 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.032683849334717
Epoch: 10, Steps: 35 | Train Loss: 7.463 Vali Loss: 26.630 Vali Acc: 0.520 Test Loss: 26.630 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.044638633728027
Epoch: 11, Steps: 35 | Train Loss: 8.069 Vali Loss: 27.676 Vali Acc: 0.510 Test Loss: 27.676 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.292773723602295
Epoch: 12, Steps: 35 | Train Loss: 11.363 Vali Loss: 26.488 Vali Acc: 0.500 Test Loss: 26.488 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.116950035095215
Epoch: 13, Steps: 35 | Train Loss: 7.935 Vali Loss: 52.510 Vali Acc: 0.510 Test Loss: 52.510 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.501935720443726
Epoch: 14, Steps: 35 | Train Loss: 14.421 Vali Loss: 31.633 Vali Acc: 0.520 Test Loss: 31.633 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.345072746276855
Epoch: 15, Steps: 35 | Train Loss: 8.344 Vali Loss: 87.015 Vali Acc: 0.500 Test Loss: 87.015 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4885026
model size : 28.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.103639841079712
Epoch: 1, Steps: 35 | Train Loss: 10.553 Vali Loss: 15.076 Vali Acc: 0.520 Test Loss: 15.076 Test Acc: 0.520
Validation loss decreased (inf --> -0.519849).  Saving model ...
Epoch: 2 cost time: 13.530983924865723
Epoch: 2, Steps: 35 | Train Loss: 14.262 Vali Loss: 24.877 Vali Acc: 0.550 Test Loss: 24.877 Test Acc: 0.550
Validation loss decreased (-0.519849 --> -0.549751).  Saving model ...
Epoch: 3 cost time: 13.334241390228271
Epoch: 3, Steps: 35 | Train Loss: 16.539 Vali Loss: 19.309 Vali Acc: 0.530 Test Loss: 19.309 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.752264499664307
Epoch: 4, Steps: 35 | Train Loss: 13.494 Vali Loss: 32.660 Vali Acc: 0.520 Test Loss: 32.660 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.805301666259766
Epoch: 5, Steps: 35 | Train Loss: 15.959 Vali Loss: 24.306 Vali Acc: 0.560 Test Loss: 24.306 Test Acc: 0.560
Validation loss decreased (-0.549751 --> -0.559757).  Saving model ...
Epoch: 6 cost time: 13.795641899108887
Epoch: 6, Steps: 35 | Train Loss: 16.652 Vali Loss: 20.803 Vali Acc: 0.520 Test Loss: 20.803 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.545653343200684
Epoch: 7, Steps: 35 | Train Loss: 17.308 Vali Loss: 72.723 Vali Acc: 0.500 Test Loss: 72.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.845586061477661
Epoch: 8, Steps: 35 | Train Loss: 16.301 Vali Loss: 24.099 Vali Acc: 0.530 Test Loss: 24.099 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.374191761016846
Epoch: 9, Steps: 35 | Train Loss: 33.476 Vali Loss: 19.576 Vali Acc: 0.610 Test Loss: 19.576 Test Acc: 0.610
Validation loss decreased (-0.559757 --> -0.609804).  Saving model ...
Epoch: 10 cost time: 13.365004062652588
Epoch: 10, Steps: 35 | Train Loss: 6.426 Vali Loss: 41.520 Vali Acc: 0.490 Test Loss: 41.520 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.424507856369019
Epoch: 11, Steps: 35 | Train Loss: 6.255 Vali Loss: 23.369 Vali Acc: 0.580 Test Loss: 23.369 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.258005380630493
Epoch: 12, Steps: 35 | Train Loss: 4.299 Vali Loss: 36.862 Vali Acc: 0.600 Test Loss: 36.862 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.37758183479309
Epoch: 13, Steps: 35 | Train Loss: 6.327 Vali Loss: 81.949 Vali Acc: 0.460 Test Loss: 81.949 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.42270827293396
Epoch: 14, Steps: 35 | Train Loss: 12.486 Vali Loss: 35.500 Vali Acc: 0.480 Test Loss: 35.500 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.517064094543457
Epoch: 15, Steps: 35 | Train Loss: 12.451 Vali Loss: 38.546 Vali Acc: 0.540 Test Loss: 38.546 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.539430141448975
Epoch: 16, Steps: 35 | Train Loss: 10.903 Vali Loss: 68.449 Vali Acc: 0.520 Test Loss: 68.449 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.350552797317505
Epoch: 17, Steps: 35 | Train Loss: 4.633 Vali Loss: 69.960 Vali Acc: 0.520 Test Loss: 69.960 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.185891151428223
Epoch: 18, Steps: 35 | Train Loss: 2.499 Vali Loss: 96.899 Vali Acc: 0.520 Test Loss: 96.899 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.54416561126709
Epoch: 19, Steps: 35 | Train Loss: 6.901 Vali Loss: 41.341 Vali Acc: 0.460 Test Loss: 41.341 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4622882
model size : 27.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.074494361877441
Epoch: 1, Steps: 35 | Train Loss: 11.108 Vali Loss: 14.568 Vali Acc: 0.530 Test Loss: 14.568 Test Acc: 0.530
Validation loss decreased (inf --> -0.529854).  Saving model ...
Epoch: 2 cost time: 12.454444169998169
Epoch: 2, Steps: 35 | Train Loss: 12.109 Vali Loss: 18.317 Vali Acc: 0.470 Test Loss: 18.317 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.800100803375244
Epoch: 3, Steps: 35 | Train Loss: 19.960 Vali Loss: 21.553 Vali Acc: 0.500 Test Loss: 21.553 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.716171264648438
Epoch: 4, Steps: 35 | Train Loss: 14.849 Vali Loss: 43.369 Vali Acc: 0.490 Test Loss: 43.369 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.74080514907837
Epoch: 5, Steps: 35 | Train Loss: 21.764 Vali Loss: 59.646 Vali Acc: 0.480 Test Loss: 59.646 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.224300622940063
Epoch: 6, Steps: 35 | Train Loss: 16.059 Vali Loss: 19.901 Vali Acc: 0.530 Test Loss: 19.901 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.669692277908325
Epoch: 7, Steps: 35 | Train Loss: 11.104 Vali Loss: 17.194 Vali Acc: 0.600 Test Loss: 17.194 Test Acc: 0.600
Validation loss decreased (-0.529854 --> -0.599828).  Saving model ...
Epoch: 8 cost time: 12.435070037841797
Epoch: 8, Steps: 35 | Train Loss: 10.366 Vali Loss: 55.786 Vali Acc: 0.540 Test Loss: 55.786 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.601238012313843
Epoch: 9, Steps: 35 | Train Loss: 10.340 Vali Loss: 42.475 Vali Acc: 0.450 Test Loss: 42.475 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.798418521881104
Epoch: 10, Steps: 35 | Train Loss: 8.820 Vali Loss: 57.410 Vali Acc: 0.500 Test Loss: 57.410 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.366670608520508
Epoch: 11, Steps: 35 | Train Loss: 7.696 Vali Loss: 26.213 Vali Acc: 0.510 Test Loss: 26.213 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.893465757369995
Epoch: 12, Steps: 35 | Train Loss: 5.984 Vali Loss: 33.249 Vali Acc: 0.580 Test Loss: 33.249 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.441438674926758
Epoch: 13, Steps: 35 | Train Loss: 8.782 Vali Loss: 40.695 Vali Acc: 0.560 Test Loss: 40.695 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.547006845474243
Epoch: 14, Steps: 35 | Train Loss: 10.174 Vali Loss: 24.320 Vali Acc: 0.550 Test Loss: 24.320 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.533959865570068
Epoch: 15, Steps: 35 | Train Loss: 5.364 Vali Loss: 52.313 Vali Acc: 0.550 Test Loss: 52.313 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.573940753936768
Epoch: 16, Steps: 35 | Train Loss: 8.588 Vali Loss: 40.022 Vali Acc: 0.500 Test Loss: 40.022 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.078514099121094
Epoch: 17, Steps: 35 | Train Loss: 8.552 Vali Loss: 92.713 Vali Acc: 0.500 Test Loss: 92.713 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4622882
model size : 27.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.539805889129639
Epoch: 1, Steps: 35 | Train Loss: 7.024 Vali Loss: 9.661 Vali Acc: 0.570 Test Loss: 9.661 Test Acc: 0.570
Validation loss decreased (inf --> -0.569903).  Saving model ...
Epoch: 2 cost time: 10.853002309799194
Epoch: 2, Steps: 35 | Train Loss: 7.698 Vali Loss: 20.287 Vali Acc: 0.490 Test Loss: 20.287 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.320091962814331
Epoch: 3, Steps: 35 | Train Loss: 12.785 Vali Loss: 16.992 Vali Acc: 0.490 Test Loss: 16.992 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.707254886627197
Epoch: 4, Steps: 35 | Train Loss: 14.248 Vali Loss: 16.048 Vali Acc: 0.550 Test Loss: 16.048 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.407882928848267
Epoch: 5, Steps: 35 | Train Loss: 20.250 Vali Loss: 31.960 Vali Acc: 0.520 Test Loss: 31.960 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.227734804153442
Epoch: 6, Steps: 35 | Train Loss: 12.490 Vali Loss: 24.104 Vali Acc: 0.560 Test Loss: 24.104 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.304803609848022
Epoch: 7, Steps: 35 | Train Loss: 15.320 Vali Loss: 43.690 Vali Acc: 0.490 Test Loss: 43.690 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.326148986816406
Epoch: 8, Steps: 35 | Train Loss: 11.146 Vali Loss: 31.850 Vali Acc: 0.480 Test Loss: 31.850 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.494609832763672
Epoch: 9, Steps: 35 | Train Loss: 13.088 Vali Loss: 45.365 Vali Acc: 0.510 Test Loss: 45.365 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.8900146484375
Epoch: 10, Steps: 35 | Train Loss: 13.366 Vali Loss: 40.140 Vali Acc: 0.490 Test Loss: 40.140 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.261754512786865
Epoch: 11, Steps: 35 | Train Loss: 11.545 Vali Loss: 48.734 Vali Acc: 0.510 Test Loss: 48.734 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4622882
model size : 27.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.57725977897644
Epoch: 1, Steps: 35 | Train Loss: 8.418 Vali Loss: 11.356 Vali Acc: 0.450 Test Loss: 11.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.449886).  Saving model ...
Epoch: 2 cost time: 10.33185362815857
Epoch: 2, Steps: 35 | Train Loss: 11.265 Vali Loss: 22.986 Vali Acc: 0.570 Test Loss: 22.986 Test Acc: 0.570
Validation loss decreased (-0.449886 --> -0.569770).  Saving model ...
Epoch: 3 cost time: 10.544935703277588
Epoch: 3, Steps: 35 | Train Loss: 10.618 Vali Loss: 14.052 Vali Acc: 0.480 Test Loss: 14.052 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.199294567108154
Epoch: 4, Steps: 35 | Train Loss: 11.286 Vali Loss: 32.767 Vali Acc: 0.500 Test Loss: 32.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.358702898025513
Epoch: 5, Steps: 35 | Train Loss: 9.318 Vali Loss: 18.461 Vali Acc: 0.520 Test Loss: 18.461 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.560896873474121
Epoch: 6, Steps: 35 | Train Loss: 14.585 Vali Loss: 25.228 Vali Acc: 0.590 Test Loss: 25.228 Test Acc: 0.590
Validation loss decreased (-0.569770 --> -0.589748).  Saving model ...
Epoch: 7 cost time: 10.11768126487732
Epoch: 7, Steps: 35 | Train Loss: 15.725 Vali Loss: 27.765 Vali Acc: 0.580 Test Loss: 27.765 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.822848558425903
Epoch: 8, Steps: 35 | Train Loss: 17.716 Vali Loss: 50.164 Vali Acc: 0.470 Test Loss: 50.164 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.205252408981323
Epoch: 9, Steps: 35 | Train Loss: 12.750 Vali Loss: 26.774 Vali Acc: 0.590 Test Loss: 26.774 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.311662912368774
Epoch: 10, Steps: 35 | Train Loss: 8.886 Vali Loss: 44.234 Vali Acc: 0.520 Test Loss: 44.234 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.246500968933105
Epoch: 11, Steps: 35 | Train Loss: 7.864 Vali Loss: 28.402 Vali Acc: 0.510 Test Loss: 28.402 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.27058458328247
Epoch: 12, Steps: 35 | Train Loss: 14.774 Vali Loss: 27.438 Vali Acc: 0.550 Test Loss: 27.438 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.281694889068604
Epoch: 13, Steps: 35 | Train Loss: 8.131 Vali Loss: 47.435 Vali Acc: 0.490 Test Loss: 47.435 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.228065729141235
Epoch: 14, Steps: 35 | Train Loss: 11.339 Vali Loss: 32.924 Vali Acc: 0.530 Test Loss: 32.924 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.983388423919678
Epoch: 15, Steps: 35 | Train Loss: 11.322 Vali Loss: 43.954 Vali Acc: 0.510 Test Loss: 43.954 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.11272120475769
Epoch: 16, Steps: 35 | Train Loss: 7.583 Vali Loss: 52.044 Vali Acc: 0.520 Test Loss: 52.044 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4622882
model size : 27.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.71789264678955
Epoch: 1, Steps: 35 | Train Loss: 8.131 Vali Loss: 16.768 Vali Acc: 0.470 Test Loss: 16.768 Test Acc: 0.470
Validation loss decreased (inf --> -0.469832).  Saving model ...
Epoch: 2 cost time: 13.03462266921997
Epoch: 2, Steps: 35 | Train Loss: 12.120 Vali Loss: 37.893 Vali Acc: 0.460 Test Loss: 37.893 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.264301776885986
Epoch: 3, Steps: 35 | Train Loss: 11.545 Vali Loss: 19.436 Vali Acc: 0.520 Test Loss: 19.436 Test Acc: 0.520
Validation loss decreased (-0.469832 --> -0.519806).  Saving model ...
Epoch: 4 cost time: 14.016284465789795
Epoch: 4, Steps: 35 | Train Loss: 17.610 Vali Loss: 43.402 Vali Acc: 0.470 Test Loss: 43.402 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.393111944198608
Epoch: 5, Steps: 35 | Train Loss: 18.863 Vali Loss: 12.863 Vali Acc: 0.550 Test Loss: 12.863 Test Acc: 0.550
Validation loss decreased (-0.519806 --> -0.549871).  Saving model ...
Epoch: 6 cost time: 13.687788009643555
Epoch: 6, Steps: 35 | Train Loss: 19.208 Vali Loss: 28.424 Vali Acc: 0.560 Test Loss: 28.424 Test Acc: 0.560
Validation loss decreased (-0.549871 --> -0.559716).  Saving model ...
Epoch: 7 cost time: 13.49326491355896
Epoch: 7, Steps: 35 | Train Loss: 19.694 Vali Loss: 65.404 Vali Acc: 0.520 Test Loss: 65.404 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.908801794052124
Epoch: 8, Steps: 35 | Train Loss: 16.908 Vali Loss: 24.908 Vali Acc: 0.520 Test Loss: 24.908 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.875186681747437
Epoch: 9, Steps: 35 | Train Loss: 10.415 Vali Loss: 21.717 Vali Acc: 0.500 Test Loss: 21.717 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.358258962631226
Epoch: 10, Steps: 35 | Train Loss: 6.868 Vali Loss: 56.157 Vali Acc: 0.520 Test Loss: 56.157 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.587509393692017
Epoch: 11, Steps: 35 | Train Loss: 11.909 Vali Loss: 22.823 Vali Acc: 0.510 Test Loss: 22.823 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.685933589935303
Epoch: 12, Steps: 35 | Train Loss: 4.564 Vali Loss: 43.807 Vali Acc: 0.520 Test Loss: 43.807 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.838654518127441
Epoch: 13, Steps: 35 | Train Loss: 6.371 Vali Loss: 22.169 Vali Acc: 0.570 Test Loss: 22.169 Test Acc: 0.570
Validation loss decreased (-0.559716 --> -0.569778).  Saving model ...
Epoch: 14 cost time: 13.757038354873657
Epoch: 14, Steps: 35 | Train Loss: 5.397 Vali Loss: 77.684 Vali Acc: 0.480 Test Loss: 77.684 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.016331672668457
Epoch: 15, Steps: 35 | Train Loss: 3.198 Vali Loss: 37.476 Vali Acc: 0.500 Test Loss: 37.476 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.435570240020752
Epoch: 16, Steps: 35 | Train Loss: 3.535 Vali Loss: 70.848 Vali Acc: 0.520 Test Loss: 70.848 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.570583820343018
Epoch: 17, Steps: 35 | Train Loss: 8.568 Vali Loss: 84.104 Vali Acc: 0.500 Test Loss: 84.104 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.299623012542725
Epoch: 18, Steps: 35 | Train Loss: 9.325 Vali Loss: 67.849 Vali Acc: 0.560 Test Loss: 67.849 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.73327088356018
Epoch: 19, Steps: 35 | Train Loss: 4.840 Vali Loss: 94.479 Vali Acc: 0.520 Test Loss: 94.479 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.458102703094482
Epoch: 20, Steps: 35 | Train Loss: 9.893 Vali Loss: 48.375 Vali Acc: 0.540 Test Loss: 48.375 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.783376216888428
Epoch: 21, Steps: 35 | Train Loss: 2.593 Vali Loss: 55.528 Vali Acc: 0.500 Test Loss: 55.528 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.386119842529297
Epoch: 22, Steps: 35 | Train Loss: 1.025 Vali Loss: 44.531 Vali Acc: 0.560 Test Loss: 44.531 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 13.63631272315979
Epoch: 23, Steps: 35 | Train Loss: 1.848 Vali Loss: 44.695 Vali Acc: 0.480 Test Loss: 44.695 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4491810
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.652178049087524
Epoch: 1, Steps: 35 | Train Loss: 8.451 Vali Loss: 17.968 Vali Acc: 0.450 Test Loss: 17.968 Test Acc: 0.450
Validation loss decreased (inf --> -0.449820).  Saving model ...
Epoch: 2 cost time: 12.104204416275024
Epoch: 2, Steps: 35 | Train Loss: 15.481 Vali Loss: 25.442 Vali Acc: 0.480 Test Loss: 25.442 Test Acc: 0.480
Validation loss decreased (-0.449820 --> -0.479746).  Saving model ...
Epoch: 3 cost time: 12.63761854171753
Epoch: 3, Steps: 35 | Train Loss: 12.697 Vali Loss: 18.872 Vali Acc: 0.510 Test Loss: 18.872 Test Acc: 0.510
Validation loss decreased (-0.479746 --> -0.509811).  Saving model ...
Epoch: 4 cost time: 12.627146005630493
Epoch: 4, Steps: 35 | Train Loss: 15.026 Vali Loss: 28.236 Vali Acc: 0.510 Test Loss: 28.236 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.135236740112305
Epoch: 5, Steps: 35 | Train Loss: 21.840 Vali Loss: 46.193 Vali Acc: 0.500 Test Loss: 46.193 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.82888913154602
Epoch: 6, Steps: 35 | Train Loss: 18.169 Vali Loss: 12.383 Vali Acc: 0.550 Test Loss: 12.383 Test Acc: 0.550
Validation loss decreased (-0.509811 --> -0.549876).  Saving model ...
Epoch: 7 cost time: 12.455430030822754
Epoch: 7, Steps: 35 | Train Loss: 16.638 Vali Loss: 21.926 Vali Acc: 0.500 Test Loss: 21.926 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.936838388442993
Epoch: 8, Steps: 35 | Train Loss: 9.717 Vali Loss: 27.982 Vali Acc: 0.490 Test Loss: 27.982 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.981746196746826
Epoch: 9, Steps: 35 | Train Loss: 7.123 Vali Loss: 18.544 Vali Acc: 0.490 Test Loss: 18.544 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.487667560577393
Epoch: 10, Steps: 35 | Train Loss: 8.380 Vali Loss: 69.541 Vali Acc: 0.520 Test Loss: 69.541 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.061937093734741
Epoch: 11, Steps: 35 | Train Loss: 10.442 Vali Loss: 33.193 Vali Acc: 0.590 Test Loss: 33.193 Test Acc: 0.590
Validation loss decreased (-0.549876 --> -0.589668).  Saving model ...
Epoch: 12 cost time: 13.239321231842041
Epoch: 12, Steps: 35 | Train Loss: 6.721 Vali Loss: 83.865 Vali Acc: 0.490 Test Loss: 83.865 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.068554878234863
Epoch: 13, Steps: 35 | Train Loss: 8.462 Vali Loss: 55.435 Vali Acc: 0.560 Test Loss: 55.435 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.525508642196655
Epoch: 14, Steps: 35 | Train Loss: 5.327 Vali Loss: 38.904 Vali Acc: 0.440 Test Loss: 38.904 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.693715810775757
Epoch: 15, Steps: 35 | Train Loss: 8.596 Vali Loss: 36.976 Vali Acc: 0.480 Test Loss: 36.976 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.573997020721436
Epoch: 16, Steps: 35 | Train Loss: 9.476 Vali Loss: 87.048 Vali Acc: 0.500 Test Loss: 87.048 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.324890851974487
Epoch: 17, Steps: 35 | Train Loss: 8.965 Vali Loss: 41.129 Vali Acc: 0.450 Test Loss: 41.129 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.818026781082153
Epoch: 18, Steps: 35 | Train Loss: 6.002 Vali Loss: 40.592 Vali Acc: 0.490 Test Loss: 40.592 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.916052103042603
Epoch: 19, Steps: 35 | Train Loss: 9.043 Vali Loss: 62.117 Vali Acc: 0.430 Test Loss: 62.117 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.802830696105957
Epoch: 20, Steps: 35 | Train Loss: 5.315 Vali Loss: 126.516 Vali Acc: 0.520 Test Loss: 126.516 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.015403270721436
Epoch: 21, Steps: 35 | Train Loss: 6.539 Vali Loss: 31.967 Vali Acc: 0.470 Test Loss: 31.967 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4491810
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.020657300949097
Epoch: 1, Steps: 35 | Train Loss: 7.922 Vali Loss: 15.143 Vali Acc: 0.490 Test Loss: 15.143 Test Acc: 0.490
Validation loss decreased (inf --> -0.489849).  Saving model ...
Epoch: 2 cost time: 10.965667963027954
Epoch: 2, Steps: 35 | Train Loss: 11.136 Vali Loss: 11.382 Vali Acc: 0.540 Test Loss: 11.382 Test Acc: 0.540
Validation loss decreased (-0.489849 --> -0.539886).  Saving model ...
Epoch: 3 cost time: 11.374469518661499
Epoch: 3, Steps: 35 | Train Loss: 15.237 Vali Loss: 9.984 Vali Acc: 0.540 Test Loss: 9.984 Test Acc: 0.540
Validation loss decreased (-0.539886 --> -0.539900).  Saving model ...
Epoch: 4 cost time: 11.90160083770752
Epoch: 4, Steps: 35 | Train Loss: 14.279 Vali Loss: 27.374 Vali Acc: 0.470 Test Loss: 27.374 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.704854965209961
Epoch: 5, Steps: 35 | Train Loss: 21.557 Vali Loss: 29.026 Vali Acc: 0.540 Test Loss: 29.026 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.968961238861084
Epoch: 6, Steps: 35 | Train Loss: 14.969 Vali Loss: 16.596 Vali Acc: 0.520 Test Loss: 16.596 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.643155813217163
Epoch: 7, Steps: 35 | Train Loss: 10.870 Vali Loss: 24.941 Vali Acc: 0.530 Test Loss: 24.941 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.68790578842163
Epoch: 8, Steps: 35 | Train Loss: 9.576 Vali Loss: 26.624 Vali Acc: 0.500 Test Loss: 26.624 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.906383514404297
Epoch: 9, Steps: 35 | Train Loss: 8.824 Vali Loss: 38.029 Vali Acc: 0.560 Test Loss: 38.029 Test Acc: 0.560
Validation loss decreased (-0.539900 --> -0.559620).  Saving model ...
Epoch: 10 cost time: 11.647480726242065
Epoch: 10, Steps: 35 | Train Loss: 6.316 Vali Loss: 47.412 Vali Acc: 0.520 Test Loss: 47.412 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.668470859527588
Epoch: 11, Steps: 35 | Train Loss: 9.654 Vali Loss: 45.542 Vali Acc: 0.470 Test Loss: 45.542 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.769559144973755
Epoch: 12, Steps: 35 | Train Loss: 12.813 Vali Loss: 33.485 Vali Acc: 0.490 Test Loss: 33.485 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.006145477294922
Epoch: 13, Steps: 35 | Train Loss: 3.940 Vali Loss: 32.818 Vali Acc: 0.500 Test Loss: 32.818 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.76578164100647
Epoch: 14, Steps: 35 | Train Loss: 14.714 Vali Loss: 46.952 Vali Acc: 0.490 Test Loss: 46.952 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.991792917251587
Epoch: 15, Steps: 35 | Train Loss: 7.945 Vali Loss: 49.040 Vali Acc: 0.520 Test Loss: 49.040 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.581073760986328
Epoch: 16, Steps: 35 | Train Loss: 8.408 Vali Loss: 36.447 Vali Acc: 0.500 Test Loss: 36.447 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.416316270828247
Epoch: 17, Steps: 35 | Train Loss: 3.074 Vali Loss: 42.375 Vali Acc: 0.470 Test Loss: 42.375 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.977379322052002
Epoch: 18, Steps: 35 | Train Loss: 3.491 Vali Loss: 68.996 Vali Acc: 0.480 Test Loss: 68.996 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.851195812225342
Epoch: 19, Steps: 35 | Train Loss: 6.187 Vali Loss: 52.895 Vali Acc: 0.480 Test Loss: 52.895 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4491810
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.932332754135132
Epoch: 1, Steps: 35 | Train Loss: 7.741 Vali Loss: 33.411 Vali Acc: 0.480 Test Loss: 33.411 Test Acc: 0.480
Validation loss decreased (inf --> -0.479666).  Saving model ...
Epoch: 2 cost time: 10.513889789581299
Epoch: 2, Steps: 35 | Train Loss: 9.834 Vali Loss: 11.232 Vali Acc: 0.490 Test Loss: 11.232 Test Acc: 0.490
Validation loss decreased (-0.479666 --> -0.489888).  Saving model ...
Epoch: 3 cost time: 10.2412748336792
Epoch: 3, Steps: 35 | Train Loss: 13.891 Vali Loss: 21.227 Vali Acc: 0.490 Test Loss: 21.227 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.513540029525757
Epoch: 4, Steps: 35 | Train Loss: 10.829 Vali Loss: 31.869 Vali Acc: 0.490 Test Loss: 31.869 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.327574968338013
Epoch: 5, Steps: 35 | Train Loss: 18.878 Vali Loss: 41.910 Vali Acc: 0.480 Test Loss: 41.910 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.115301609039307
Epoch: 6, Steps: 35 | Train Loss: 18.165 Vali Loss: 16.185 Vali Acc: 0.560 Test Loss: 16.185 Test Acc: 0.560
Validation loss decreased (-0.489888 --> -0.559838).  Saving model ...
Epoch: 7 cost time: 10.47581434249878
Epoch: 7, Steps: 35 | Train Loss: 9.371 Vali Loss: 23.648 Vali Acc: 0.470 Test Loss: 23.648 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.630409002304077
Epoch: 8, Steps: 35 | Train Loss: 17.995 Vali Loss: 26.339 Vali Acc: 0.540 Test Loss: 26.339 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.330365180969238
Epoch: 9, Steps: 35 | Train Loss: 8.062 Vali Loss: 18.896 Vali Acc: 0.570 Test Loss: 18.896 Test Acc: 0.570
Validation loss decreased (-0.559838 --> -0.569811).  Saving model ...
Epoch: 10 cost time: 10.323204517364502
Epoch: 10, Steps: 35 | Train Loss: 11.148 Vali Loss: 44.897 Vali Acc: 0.500 Test Loss: 44.897 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.308383703231812
Epoch: 11, Steps: 35 | Train Loss: 19.032 Vali Loss: 31.675 Vali Acc: 0.600 Test Loss: 31.675 Test Acc: 0.600
Validation loss decreased (-0.569811 --> -0.599683).  Saving model ...
Epoch: 12 cost time: 10.139312744140625
Epoch: 12, Steps: 35 | Train Loss: 16.301 Vali Loss: 33.366 Vali Acc: 0.490 Test Loss: 33.366 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.694860935211182
Epoch: 13, Steps: 35 | Train Loss: 10.425 Vali Loss: 52.354 Vali Acc: 0.530 Test Loss: 52.354 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.541537523269653
Epoch: 14, Steps: 35 | Train Loss: 4.731 Vali Loss: 31.682 Vali Acc: 0.450 Test Loss: 31.682 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.185406923294067
Epoch: 15, Steps: 35 | Train Loss: 13.112 Vali Loss: 20.950 Vali Acc: 0.500 Test Loss: 20.950 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.147715330123901
Epoch: 16, Steps: 35 | Train Loss: 8.931 Vali Loss: 68.311 Vali Acc: 0.530 Test Loss: 68.311 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.461749076843262
Epoch: 17, Steps: 35 | Train Loss: 11.451 Vali Loss: 40.580 Vali Acc: 0.550 Test Loss: 40.580 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.371017217636108
Epoch: 18, Steps: 35 | Train Loss: 4.566 Vali Loss: 69.305 Vali Acc: 0.520 Test Loss: 69.305 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.401031017303467
Epoch: 19, Steps: 35 | Train Loss: 4.328 Vali Loss: 43.992 Vali Acc: 0.470 Test Loss: 43.992 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.12490439414978
Epoch: 20, Steps: 35 | Train Loss: 4.031 Vali Loss: 101.831 Vali Acc: 0.510 Test Loss: 101.831 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.980875492095947
Epoch: 21, Steps: 35 | Train Loss: 11.625 Vali Loss: 47.790 Vali Acc: 0.470 Test Loss: 47.790 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4491810
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.485120296478271
Epoch: 1, Steps: 35 | Train Loss: 3.902 Vali Loss: 6.279 Vali Acc: 0.500 Test Loss: 6.279 Test Acc: 0.500
Validation loss decreased (inf --> -0.499937).  Saving model ...
Epoch: 2 cost time: 9.313968181610107
Epoch: 2, Steps: 35 | Train Loss: 4.272 Vali Loss: 5.328 Vali Acc: 0.490 Test Loss: 5.328 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.271785497665405
Epoch: 3, Steps: 35 | Train Loss: 6.981 Vali Loss: 14.797 Vali Acc: 0.520 Test Loss: 14.797 Test Acc: 0.520
Validation loss decreased (-0.499937 --> -0.519852).  Saving model ...
Epoch: 4 cost time: 9.869693040847778
Epoch: 4, Steps: 35 | Train Loss: 7.959 Vali Loss: 21.568 Vali Acc: 0.480 Test Loss: 21.568 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.055132865905762
Epoch: 5, Steps: 35 | Train Loss: 6.382 Vali Loss: 7.280 Vali Acc: 0.540 Test Loss: 7.280 Test Acc: 0.540
Validation loss decreased (-0.519852 --> -0.539927).  Saving model ...
Epoch: 6 cost time: 9.206796169281006
Epoch: 6, Steps: 35 | Train Loss: 6.674 Vali Loss: 9.578 Vali Acc: 0.470 Test Loss: 9.578 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.649609327316284
Epoch: 7, Steps: 35 | Train Loss: 6.238 Vali Loss: 27.850 Vali Acc: 0.490 Test Loss: 27.850 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.658896684646606
Epoch: 8, Steps: 35 | Train Loss: 12.276 Vali Loss: 24.173 Vali Acc: 0.520 Test Loss: 24.173 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.200441598892212
Epoch: 9, Steps: 35 | Train Loss: 4.714 Vali Loss: 16.023 Vali Acc: 0.500 Test Loss: 16.023 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.48429274559021
Epoch: 10, Steps: 35 | Train Loss: 5.948 Vali Loss: 38.063 Vali Acc: 0.380 Test Loss: 38.063 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.62791633605957
Epoch: 11, Steps: 35 | Train Loss: 12.847 Vali Loss: 32.960 Vali Acc: 0.520 Test Loss: 32.960 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.23244571685791
Epoch: 12, Steps: 35 | Train Loss: 1.867 Vali Loss: 33.581 Vali Acc: 0.530 Test Loss: 33.581 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.679389476776123
Epoch: 13, Steps: 35 | Train Loss: 2.709 Vali Loss: 24.182 Vali Acc: 0.500 Test Loss: 24.182 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.584972381591797
Epoch: 14, Steps: 35 | Train Loss: 4.503 Vali Loss: 35.458 Vali Acc: 0.500 Test Loss: 35.458 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.059612274169922
Epoch: 15, Steps: 35 | Train Loss: 3.484 Vali Loss: 33.698 Vali Acc: 0.470 Test Loss: 33.698 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 4015650
model size : 20.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.07963490486145
Epoch: 1, Steps: 35 | Train Loss: 3.282 Vali Loss: 3.418 Vali Acc: 0.520 Test Loss: 3.418 Test Acc: 0.520
Validation loss decreased (inf --> -0.519966).  Saving model ...
Epoch: 2 cost time: 8.86244249343872
Epoch: 2, Steps: 35 | Train Loss: 8.299 Vali Loss: 9.278 Vali Acc: 0.570 Test Loss: 9.278 Test Acc: 0.570
Validation loss decreased (-0.519966 --> -0.569907).  Saving model ...
Epoch: 3 cost time: 8.640213012695312
Epoch: 3, Steps: 35 | Train Loss: 9.492 Vali Loss: 12.264 Vali Acc: 0.510 Test Loss: 12.264 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.85808539390564
Epoch: 4, Steps: 35 | Train Loss: 6.258 Vali Loss: 12.844 Vali Acc: 0.540 Test Loss: 12.844 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.47489047050476
Epoch: 5, Steps: 35 | Train Loss: 9.146 Vali Loss: 23.577 Vali Acc: 0.500 Test Loss: 23.577 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.070568084716797
Epoch: 6, Steps: 35 | Train Loss: 5.810 Vali Loss: 14.054 Vali Acc: 0.490 Test Loss: 14.054 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.679876565933228
Epoch: 7, Steps: 35 | Train Loss: 5.649 Vali Loss: 20.386 Vali Acc: 0.580 Test Loss: 20.386 Test Acc: 0.580
Validation loss decreased (-0.569907 --> -0.579796).  Saving model ...
Epoch: 8 cost time: 8.93309736251831
Epoch: 8, Steps: 35 | Train Loss: 6.548 Vali Loss: 15.366 Vali Acc: 0.530 Test Loss: 15.366 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.074530839920044
Epoch: 9, Steps: 35 | Train Loss: 2.842 Vali Loss: 18.503 Vali Acc: 0.560 Test Loss: 18.503 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.695688009262085
Epoch: 10, Steps: 35 | Train Loss: 6.134 Vali Loss: 18.897 Vali Acc: 0.440 Test Loss: 18.897 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.764479637145996
Epoch: 11, Steps: 35 | Train Loss: 3.138 Vali Loss: 21.058 Vali Acc: 0.510 Test Loss: 21.058 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.398788690567017
Epoch: 12, Steps: 35 | Train Loss: 4.019 Vali Loss: 32.497 Vali Acc: 0.520 Test Loss: 32.497 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.906925201416016
Epoch: 13, Steps: 35 | Train Loss: 3.751 Vali Loss: 24.182 Vali Acc: 0.500 Test Loss: 24.182 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.76872444152832
Epoch: 14, Steps: 35 | Train Loss: 3.414 Vali Loss: 26.344 Vali Acc: 0.480 Test Loss: 26.344 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.721120834350586
Epoch: 15, Steps: 35 | Train Loss: 2.430 Vali Loss: 26.856 Vali Acc: 0.530 Test Loss: 26.856 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.553792715072632
Epoch: 16, Steps: 35 | Train Loss: 6.271 Vali Loss: 43.777 Vali Acc: 0.430 Test Loss: 43.777 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.423386096954346
Epoch: 17, Steps: 35 | Train Loss: 16.116 Vali Loss: 44.360 Vali Acc: 0.500 Test Loss: 44.360 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4015650
model size : 20.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.720555305480957
Epoch: 1, Steps: 35 | Train Loss: 5.403 Vali Loss: 5.771 Vali Acc: 0.530 Test Loss: 5.771 Test Acc: 0.530
Validation loss decreased (inf --> -0.529942).  Saving model ...
Epoch: 2 cost time: 7.988228797912598
Epoch: 2, Steps: 35 | Train Loss: 10.586 Vali Loss: 4.874 Vali Acc: 0.560 Test Loss: 4.874 Test Acc: 0.560
Validation loss decreased (-0.529942 --> -0.559951).  Saving model ...
Epoch: 3 cost time: 8.191081047058105
Epoch: 3, Steps: 35 | Train Loss: 6.601 Vali Loss: 11.386 Vali Acc: 0.520 Test Loss: 11.386 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.689061641693115
Epoch: 4, Steps: 35 | Train Loss: 6.161 Vali Loss: 9.543 Vali Acc: 0.510 Test Loss: 9.543 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.17112398147583
Epoch: 5, Steps: 35 | Train Loss: 8.998 Vali Loss: 9.851 Vali Acc: 0.450 Test Loss: 9.851 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.892345905303955
Epoch: 6, Steps: 35 | Train Loss: 6.613 Vali Loss: 16.832 Vali Acc: 0.540 Test Loss: 16.832 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.246371746063232
Epoch: 7, Steps: 35 | Train Loss: 18.443 Vali Loss: 40.019 Vali Acc: 0.510 Test Loss: 40.019 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.427964210510254
Epoch: 8, Steps: 35 | Train Loss: 8.630 Vali Loss: 18.325 Vali Acc: 0.500 Test Loss: 18.325 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.229050159454346
Epoch: 9, Steps: 35 | Train Loss: 5.861 Vali Loss: 38.270 Vali Acc: 0.520 Test Loss: 38.270 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.98166561126709
Epoch: 10, Steps: 35 | Train Loss: 11.178 Vali Loss: 25.426 Vali Acc: 0.490 Test Loss: 25.426 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.107206106185913
Epoch: 11, Steps: 35 | Train Loss: 8.444 Vali Loss: 44.756 Vali Acc: 0.510 Test Loss: 44.756 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.870868921279907
Epoch: 12, Steps: 35 | Train Loss: 2.804 Vali Loss: 22.121 Vali Acc: 0.540 Test Loss: 22.121 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4015650
model size : 20.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.853562593460083
Epoch: 1, Steps: 35 | Train Loss: 3.852 Vali Loss: 5.873 Vali Acc: 0.590 Test Loss: 5.873 Test Acc: 0.590
Validation loss decreased (inf --> -0.589941).  Saving model ...
Epoch: 2 cost time: 6.972411155700684
Epoch: 2, Steps: 35 | Train Loss: 6.311 Vali Loss: 9.201 Vali Acc: 0.500 Test Loss: 9.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.959436893463135
Epoch: 3, Steps: 35 | Train Loss: 8.722 Vali Loss: 11.099 Vali Acc: 0.500 Test Loss: 11.099 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.177478790283203
Epoch: 4, Steps: 35 | Train Loss: 6.916 Vali Loss: 16.706 Vali Acc: 0.480 Test Loss: 16.706 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.578538656234741
Epoch: 5, Steps: 35 | Train Loss: 6.332 Vali Loss: 9.199 Vali Acc: 0.500 Test Loss: 9.199 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.223149299621582
Epoch: 6, Steps: 35 | Train Loss: 6.442 Vali Loss: 8.347 Vali Acc: 0.490 Test Loss: 8.347 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.669250249862671
Epoch: 7, Steps: 35 | Train Loss: 5.214 Vali Loss: 13.185 Vali Acc: 0.500 Test Loss: 13.185 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.251733064651489
Epoch: 8, Steps: 35 | Train Loss: 5.917 Vali Loss: 10.300 Vali Acc: 0.510 Test Loss: 10.300 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.148632049560547
Epoch: 9, Steps: 35 | Train Loss: 6.801 Vali Loss: 14.413 Vali Acc: 0.500 Test Loss: 14.413 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.833383560180664
Epoch: 10, Steps: 35 | Train Loss: 4.816 Vali Loss: 16.694 Vali Acc: 0.390 Test Loss: 16.694 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.218533277511597
Epoch: 11, Steps: 35 | Train Loss: 5.935 Vali Loss: 15.399 Vali Acc: 0.490 Test Loss: 15.399 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4015650
model size : 20.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.382083415985107
Epoch: 1, Steps: 35 | Train Loss: 3.086 Vali Loss: 5.081 Vali Acc: 0.540 Test Loss: 5.081 Test Acc: 0.540
Validation loss decreased (inf --> -0.539949).  Saving model ...
Epoch: 2 cost time: 8.595364809036255
Epoch: 2, Steps: 35 | Train Loss: 5.836 Vali Loss: 6.395 Vali Acc: 0.510 Test Loss: 6.395 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.369353294372559
Epoch: 3, Steps: 35 | Train Loss: 6.330 Vali Loss: 12.249 Vali Acc: 0.540 Test Loss: 12.249 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.702249765396118
Epoch: 4, Steps: 35 | Train Loss: 7.318 Vali Loss: 10.833 Vali Acc: 0.590 Test Loss: 10.833 Test Acc: 0.590
Validation loss decreased (-0.539949 --> -0.589892).  Saving model ...
Epoch: 5 cost time: 8.808409929275513
Epoch: 5, Steps: 35 | Train Loss: 7.029 Vali Loss: 16.660 Vali Acc: 0.550 Test Loss: 16.660 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.082325220108032
Epoch: 6, Steps: 35 | Train Loss: 8.769 Vali Loss: 50.946 Vali Acc: 0.500 Test Loss: 50.946 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.197945356369019
Epoch: 7, Steps: 35 | Train Loss: 13.819 Vali Loss: 18.825 Vali Acc: 0.500 Test Loss: 18.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.1648530960083
Epoch: 8, Steps: 35 | Train Loss: 5.648 Vali Loss: 10.810 Vali Acc: 0.530 Test Loss: 10.810 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.984761238098145
Epoch: 9, Steps: 35 | Train Loss: 6.141 Vali Loss: 16.858 Vali Acc: 0.480 Test Loss: 16.858 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.877564668655396
Epoch: 10, Steps: 35 | Train Loss: 4.602 Vali Loss: 42.544 Vali Acc: 0.520 Test Loss: 42.544 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.858810901641846
Epoch: 11, Steps: 35 | Train Loss: 9.484 Vali Loss: 19.115 Vali Acc: 0.470 Test Loss: 19.115 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.946245908737183
Epoch: 12, Steps: 35 | Train Loss: 3.501 Vali Loss: 21.566 Vali Acc: 0.470 Test Loss: 21.566 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.114455938339233
Epoch: 13, Steps: 35 | Train Loss: 5.012 Vali Loss: 40.929 Vali Acc: 0.540 Test Loss: 40.929 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.204443216323853
Epoch: 14, Steps: 35 | Train Loss: 6.497 Vali Loss: 27.085 Vali Acc: 0.560 Test Loss: 27.085 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2967074
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.242571353912354
Epoch: 1, Steps: 35 | Train Loss: 3.047 Vali Loss: 4.780 Vali Acc: 0.550 Test Loss: 4.780 Test Acc: 0.550
Validation loss decreased (inf --> -0.549952).  Saving model ...
Epoch: 2 cost time: 7.8899102210998535
Epoch: 2, Steps: 35 | Train Loss: 5.037 Vali Loss: 4.576 Vali Acc: 0.590 Test Loss: 4.576 Test Acc: 0.590
Validation loss decreased (-0.549952 --> -0.589954).  Saving model ...
Epoch: 3 cost time: 8.546745300292969
Epoch: 3, Steps: 35 | Train Loss: 7.040 Vali Loss: 17.128 Vali Acc: 0.490 Test Loss: 17.128 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.05467414855957
Epoch: 4, Steps: 35 | Train Loss: 4.938 Vali Loss: 9.223 Vali Acc: 0.560 Test Loss: 9.223 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.979813814163208
Epoch: 5, Steps: 35 | Train Loss: 10.596 Vali Loss: 14.581 Vali Acc: 0.490 Test Loss: 14.581 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.192511796951294
Epoch: 6, Steps: 35 | Train Loss: 5.871 Vali Loss: 14.178 Vali Acc: 0.530 Test Loss: 14.178 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.10164499282837
Epoch: 7, Steps: 35 | Train Loss: 7.692 Vali Loss: 30.678 Vali Acc: 0.470 Test Loss: 30.678 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.976338863372803
Epoch: 8, Steps: 35 | Train Loss: 11.213 Vali Loss: 22.464 Vali Acc: 0.450 Test Loss: 22.464 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.685595273971558
Epoch: 9, Steps: 35 | Train Loss: 9.590 Vali Loss: 15.822 Vali Acc: 0.570 Test Loss: 15.822 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.370554208755493
Epoch: 10, Steps: 35 | Train Loss: 15.581 Vali Loss: 25.257 Vali Acc: 0.460 Test Loss: 25.257 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.050835847854614
Epoch: 11, Steps: 35 | Train Loss: 4.186 Vali Loss: 14.091 Vali Acc: 0.550 Test Loss: 14.091 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.209647417068481
Epoch: 12, Steps: 35 | Train Loss: 2.963 Vali Loss: 18.777 Vali Acc: 0.600 Test Loss: 18.777 Test Acc: 0.600
Validation loss decreased (-0.589954 --> -0.599812).  Saving model ...
Epoch: 13 cost time: 8.22641634941101
Epoch: 13, Steps: 35 | Train Loss: 2.786 Vali Loss: 21.734 Vali Acc: 0.510 Test Loss: 21.734 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.153755187988281
Epoch: 14, Steps: 35 | Train Loss: 2.453 Vali Loss: 30.362 Vali Acc: 0.460 Test Loss: 30.362 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.779145240783691
Epoch: 15, Steps: 35 | Train Loss: 3.325 Vali Loss: 26.651 Vali Acc: 0.460 Test Loss: 26.651 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.270380735397339
Epoch: 16, Steps: 35 | Train Loss: 2.255 Vali Loss: 19.779 Vali Acc: 0.520 Test Loss: 19.779 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.064258575439453
Epoch: 17, Steps: 35 | Train Loss: 1.426 Vali Loss: 23.619 Vali Acc: 0.500 Test Loss: 23.619 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.876906633377075
Epoch: 18, Steps: 35 | Train Loss: 0.917 Vali Loss: 21.492 Vali Acc: 0.570 Test Loss: 21.492 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.740558385848999
Epoch: 19, Steps: 35 | Train Loss: 4.435 Vali Loss: 30.642 Vali Acc: 0.470 Test Loss: 30.642 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.703551530838013
Epoch: 20, Steps: 35 | Train Loss: 2.105 Vali Loss: 30.938 Vali Acc: 0.560 Test Loss: 30.938 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.978498220443726
Epoch: 21, Steps: 35 | Train Loss: 6.046 Vali Loss: 45.502 Vali Acc: 0.560 Test Loss: 45.502 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.9628212451934814
Epoch: 22, Steps: 35 | Train Loss: 3.546 Vali Loss: 37.588 Vali Acc: 0.530 Test Loss: 37.588 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2967074
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.754747152328491
Epoch: 1, Steps: 35 | Train Loss: 3.668 Vali Loss: 5.965 Vali Acc: 0.570 Test Loss: 5.965 Test Acc: 0.570
Validation loss decreased (inf --> -0.569940).  Saving model ...
Epoch: 2 cost time: 6.9539735317230225
Epoch: 2, Steps: 35 | Train Loss: 5.224 Vali Loss: 3.218 Vali Acc: 0.540 Test Loss: 3.218 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.246561765670776
Epoch: 3, Steps: 35 | Train Loss: 8.243 Vali Loss: 11.532 Vali Acc: 0.540 Test Loss: 11.532 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.9793806076049805
Epoch: 4, Steps: 35 | Train Loss: 9.441 Vali Loss: 24.824 Vali Acc: 0.500 Test Loss: 24.824 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.484533309936523
Epoch: 5, Steps: 35 | Train Loss: 9.525 Vali Loss: 16.430 Vali Acc: 0.540 Test Loss: 16.430 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.330920934677124
Epoch: 6, Steps: 35 | Train Loss: 12.584 Vali Loss: 13.464 Vali Acc: 0.490 Test Loss: 13.464 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.434540510177612
Epoch: 7, Steps: 35 | Train Loss: 5.880 Vali Loss: 12.270 Vali Acc: 0.510 Test Loss: 12.270 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.433458089828491
Epoch: 8, Steps: 35 | Train Loss: 6.458 Vali Loss: 15.156 Vali Acc: 0.520 Test Loss: 15.156 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.31992506980896
Epoch: 9, Steps: 35 | Train Loss: 6.084 Vali Loss: 9.791 Vali Acc: 0.470 Test Loss: 9.791 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.876383543014526
Epoch: 10, Steps: 35 | Train Loss: 3.033 Vali Loss: 18.570 Vali Acc: 0.510 Test Loss: 18.570 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.476572275161743
Epoch: 11, Steps: 35 | Train Loss: 5.687 Vali Loss: 18.912 Vali Acc: 0.440 Test Loss: 18.912 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2967074
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.451057195663452
Epoch: 1, Steps: 35 | Train Loss: 4.368 Vali Loss: 4.757 Vali Acc: 0.450 Test Loss: 4.757 Test Acc: 0.450
Validation loss decreased (inf --> -0.449952).  Saving model ...
Epoch: 2 cost time: 6.137192010879517
Epoch: 2, Steps: 35 | Train Loss: 3.803 Vali Loss: 10.834 Vali Acc: 0.510 Test Loss: 10.834 Test Acc: 0.510
Validation loss decreased (-0.449952 --> -0.509892).  Saving model ...
Epoch: 3 cost time: 6.18221116065979
Epoch: 3, Steps: 35 | Train Loss: 5.530 Vali Loss: 9.185 Vali Acc: 0.430 Test Loss: 9.185 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.244825124740601
Epoch: 4, Steps: 35 | Train Loss: 15.778 Vali Loss: 18.114 Vali Acc: 0.520 Test Loss: 18.114 Test Acc: 0.520
Validation loss decreased (-0.509892 --> -0.519819).  Saving model ...
Epoch: 5 cost time: 6.407686948776245
Epoch: 5, Steps: 35 | Train Loss: 8.925 Vali Loss: 27.430 Vali Acc: 0.510 Test Loss: 27.430 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.2092084884643555
Epoch: 6, Steps: 35 | Train Loss: 11.274 Vali Loss: 14.600 Vali Acc: 0.510 Test Loss: 14.600 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.808813571929932
Epoch: 7, Steps: 35 | Train Loss: 4.851 Vali Loss: 6.969 Vali Acc: 0.510 Test Loss: 6.969 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.445728778839111
Epoch: 8, Steps: 35 | Train Loss: 4.634 Vali Loss: 12.208 Vali Acc: 0.430 Test Loss: 12.208 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.213714599609375
Epoch: 9, Steps: 35 | Train Loss: 3.831 Vali Loss: 23.108 Vali Acc: 0.510 Test Loss: 23.108 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.8616321086883545
Epoch: 10, Steps: 35 | Train Loss: 6.606 Vali Loss: 12.370 Vali Acc: 0.540 Test Loss: 12.370 Test Acc: 0.540
Validation loss decreased (-0.519819 --> -0.539876).  Saving model ...
Epoch: 11 cost time: 6.345020055770874
Epoch: 11, Steps: 35 | Train Loss: 6.337 Vali Loss: 9.595 Vali Acc: 0.590 Test Loss: 9.595 Test Acc: 0.590
Validation loss decreased (-0.539876 --> -0.589904).  Saving model ...
Epoch: 12 cost time: 6.234041929244995
Epoch: 12, Steps: 35 | Train Loss: 4.971 Vali Loss: 9.144 Vali Acc: 0.570 Test Loss: 9.144 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.35721492767334
Epoch: 13, Steps: 35 | Train Loss: 4.530 Vali Loss: 25.665 Vali Acc: 0.510 Test Loss: 25.665 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.388357400894165
Epoch: 14, Steps: 35 | Train Loss: 4.523 Vali Loss: 16.151 Vali Acc: 0.500 Test Loss: 16.151 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.93236231803894
Epoch: 15, Steps: 35 | Train Loss: 4.631 Vali Loss: 28.064 Vali Acc: 0.530 Test Loss: 28.064 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.472055435180664
Epoch: 16, Steps: 35 | Train Loss: 3.875 Vali Loss: 20.990 Vali Acc: 0.510 Test Loss: 20.990 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.5507001876831055
Epoch: 17, Steps: 35 | Train Loss: 4.478 Vali Loss: 60.402 Vali Acc: 0.500 Test Loss: 60.402 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.37140154838562
Epoch: 18, Steps: 35 | Train Loss: 4.589 Vali Loss: 32.090 Vali Acc: 0.530 Test Loss: 32.090 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.609781265258789
Epoch: 19, Steps: 35 | Train Loss: 2.997 Vali Loss: 17.662 Vali Acc: 0.540 Test Loss: 17.662 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.5700201988220215
Epoch: 20, Steps: 35 | Train Loss: 2.662 Vali Loss: 23.758 Vali Acc: 0.500 Test Loss: 23.758 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.607736349105835
Epoch: 21, Steps: 35 | Train Loss: 4.307 Vali Loss: 19.074 Vali Acc: 0.520 Test Loss: 19.074 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2967074
model size : 16.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.596087455749512
Epoch: 1, Steps: 35 | Train Loss: 2.743 Vali Loss: 4.079 Vali Acc: 0.450 Test Loss: 4.079 Test Acc: 0.450
Validation loss decreased (inf --> -0.449959).  Saving model ...
Epoch: 2 cost time: 8.147654294967651
Epoch: 2, Steps: 35 | Train Loss: 5.520 Vali Loss: 19.238 Vali Acc: 0.500 Test Loss: 19.238 Test Acc: 0.500
Validation loss decreased (-0.449959 --> -0.499808).  Saving model ...
Epoch: 3 cost time: 8.428388595581055
Epoch: 3, Steps: 35 | Train Loss: 6.644 Vali Loss: 17.709 Vali Acc: 0.500 Test Loss: 17.709 Test Acc: 0.500
Validation loss decreased (-0.499808 --> -0.499823).  Saving model ...
Epoch: 4 cost time: 8.154360055923462
Epoch: 4, Steps: 35 | Train Loss: 8.162 Vali Loss: 17.168 Vali Acc: 0.480 Test Loss: 17.168 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.017876863479614
Epoch: 5, Steps: 35 | Train Loss: 10.940 Vali Loss: 21.721 Vali Acc: 0.570 Test Loss: 21.721 Test Acc: 0.570
Validation loss decreased (-0.499823 --> -0.569783).  Saving model ...
Epoch: 6 cost time: 8.345948219299316
Epoch: 6, Steps: 35 | Train Loss: 5.134 Vali Loss: 11.006 Vali Acc: 0.480 Test Loss: 11.006 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.230378866195679
Epoch: 7, Steps: 35 | Train Loss: 7.883 Vali Loss: 12.347 Vali Acc: 0.530 Test Loss: 12.347 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.437644243240356
Epoch: 8, Steps: 35 | Train Loss: 4.599 Vali Loss: 19.890 Vali Acc: 0.500 Test Loss: 19.890 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.013782024383545
Epoch: 9, Steps: 35 | Train Loss: 4.412 Vali Loss: 31.379 Vali Acc: 0.490 Test Loss: 31.379 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.463980197906494
Epoch: 10, Steps: 35 | Train Loss: 16.980 Vali Loss: 52.318 Vali Acc: 0.470 Test Loss: 52.318 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.113494396209717
Epoch: 11, Steps: 35 | Train Loss: 16.048 Vali Loss: 38.796 Vali Acc: 0.510 Test Loss: 38.796 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.068447351455688
Epoch: 12, Steps: 35 | Train Loss: 4.207 Vali Loss: 20.630 Vali Acc: 0.520 Test Loss: 20.630 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.399988889694214
Epoch: 13, Steps: 35 | Train Loss: 5.005 Vali Loss: 17.303 Vali Acc: 0.520 Test Loss: 17.303 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.65718388557434
Epoch: 14, Steps: 35 | Train Loss: 4.317 Vali Loss: 17.781 Vali Acc: 0.520 Test Loss: 17.781 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.16750192642212
Epoch: 15, Steps: 35 | Train Loss: 2.008 Vali Loss: 33.171 Vali Acc: 0.470 Test Loss: 33.171 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2442786
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.145848512649536
Epoch: 1, Steps: 35 | Train Loss: 3.162 Vali Loss: 4.551 Vali Acc: 0.440 Test Loss: 4.551 Test Acc: 0.440
Validation loss decreased (inf --> -0.439954).  Saving model ...
Epoch: 2 cost time: 7.7963361740112305
Epoch: 2, Steps: 35 | Train Loss: 4.939 Vali Loss: 21.140 Vali Acc: 0.510 Test Loss: 21.140 Test Acc: 0.510
Validation loss decreased (-0.439954 --> -0.509789).  Saving model ...
Epoch: 3 cost time: 7.935652256011963
Epoch: 3, Steps: 35 | Train Loss: 6.668 Vali Loss: 15.954 Vali Acc: 0.480 Test Loss: 15.954 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.968889474868774
Epoch: 4, Steps: 35 | Train Loss: 6.222 Vali Loss: 8.228 Vali Acc: 0.530 Test Loss: 8.228 Test Acc: 0.530
Validation loss decreased (-0.509789 --> -0.529918).  Saving model ...
Epoch: 5 cost time: 7.860349893569946
Epoch: 5, Steps: 35 | Train Loss: 6.099 Vali Loss: 12.629 Vali Acc: 0.530 Test Loss: 12.629 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.823873281478882
Epoch: 6, Steps: 35 | Train Loss: 7.936 Vali Loss: 15.428 Vali Acc: 0.540 Test Loss: 15.428 Test Acc: 0.540
Validation loss decreased (-0.529918 --> -0.539846).  Saving model ...
Epoch: 7 cost time: 7.831266403198242
Epoch: 7, Steps: 35 | Train Loss: 6.484 Vali Loss: 27.304 Vali Acc: 0.480 Test Loss: 27.304 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.972629070281982
Epoch: 8, Steps: 35 | Train Loss: 8.354 Vali Loss: 16.451 Vali Acc: 0.540 Test Loss: 16.451 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.197274208068848
Epoch: 9, Steps: 35 | Train Loss: 5.797 Vali Loss: 23.754 Vali Acc: 0.460 Test Loss: 23.754 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.8386242389678955
Epoch: 10, Steps: 35 | Train Loss: 3.230 Vali Loss: 32.722 Vali Acc: 0.490 Test Loss: 32.722 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.22149395942688
Epoch: 11, Steps: 35 | Train Loss: 2.695 Vali Loss: 13.102 Vali Acc: 0.540 Test Loss: 13.102 Test Acc: 0.540
Validation loss decreased (-0.539846 --> -0.539869).  Saving model ...
Epoch: 12 cost time: 7.920522212982178
Epoch: 12, Steps: 35 | Train Loss: 3.091 Vali Loss: 22.025 Vali Acc: 0.530 Test Loss: 22.025 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.019088745117188
Epoch: 13, Steps: 35 | Train Loss: 4.191 Vali Loss: 18.218 Vali Acc: 0.550 Test Loss: 18.218 Test Acc: 0.550
Validation loss decreased (-0.539869 --> -0.549818).  Saving model ...
Epoch: 14 cost time: 8.346155405044556
Epoch: 14, Steps: 35 | Train Loss: 4.794 Vali Loss: 22.545 Vali Acc: 0.480 Test Loss: 22.545 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.053558111190796
Epoch: 15, Steps: 35 | Train Loss: 5.707 Vali Loss: 42.631 Vali Acc: 0.520 Test Loss: 42.631 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.162209272384644
Epoch: 16, Steps: 35 | Train Loss: 3.793 Vali Loss: 42.211 Vali Acc: 0.520 Test Loss: 42.211 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.22400689125061
Epoch: 17, Steps: 35 | Train Loss: 2.808 Vali Loss: 33.299 Vali Acc: 0.470 Test Loss: 33.299 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.04825735092163
Epoch: 18, Steps: 35 | Train Loss: 2.368 Vali Loss: 35.637 Vali Acc: 0.540 Test Loss: 35.637 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.194653749465942
Epoch: 19, Steps: 35 | Train Loss: 4.240 Vali Loss: 42.747 Vali Acc: 0.530 Test Loss: 42.747 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.067358016967773
Epoch: 20, Steps: 35 | Train Loss: 3.431 Vali Loss: 27.876 Vali Acc: 0.490 Test Loss: 27.876 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.890694618225098
Epoch: 21, Steps: 35 | Train Loss: 4.213 Vali Loss: 51.449 Vali Acc: 0.510 Test Loss: 51.449 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.10006833076477
Epoch: 22, Steps: 35 | Train Loss: 2.308 Vali Loss: 46.440 Vali Acc: 0.500 Test Loss: 46.440 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.891516447067261
Epoch: 23, Steps: 35 | Train Loss: 2.856 Vali Loss: 47.875 Vali Acc: 0.470 Test Loss: 47.875 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2442786
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.118526935577393
Epoch: 1, Steps: 35 | Train Loss: 2.786 Vali Loss: 6.991 Vali Acc: 0.470 Test Loss: 6.991 Test Acc: 0.470
Validation loss decreased (inf --> -0.469930).  Saving model ...
Epoch: 2 cost time: 6.919122219085693
Epoch: 2, Steps: 35 | Train Loss: 5.017 Vali Loss: 9.551 Vali Acc: 0.500 Test Loss: 9.551 Test Acc: 0.500
Validation loss decreased (-0.469930 --> -0.499904).  Saving model ...
Epoch: 3 cost time: 6.7523276805877686
Epoch: 3, Steps: 35 | Train Loss: 10.103 Vali Loss: 13.905 Vali Acc: 0.420 Test Loss: 13.905 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.8573784828186035
Epoch: 4, Steps: 35 | Train Loss: 7.691 Vali Loss: 18.432 Vali Acc: 0.480 Test Loss: 18.432 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.776103734970093
Epoch: 5, Steps: 35 | Train Loss: 4.753 Vali Loss: 8.494 Vali Acc: 0.440 Test Loss: 8.494 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.458183526992798
Epoch: 6, Steps: 35 | Train Loss: 7.180 Vali Loss: 15.672 Vali Acc: 0.430 Test Loss: 15.672 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.106950998306274
Epoch: 7, Steps: 35 | Train Loss: 7.599 Vali Loss: 10.031 Vali Acc: 0.540 Test Loss: 10.031 Test Acc: 0.540
Validation loss decreased (-0.499904 --> -0.539900).  Saving model ...
Epoch: 8 cost time: 6.876800537109375
Epoch: 8, Steps: 35 | Train Loss: 8.713 Vali Loss: 21.716 Vali Acc: 0.540 Test Loss: 21.716 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.866521596908569
Epoch: 9, Steps: 35 | Train Loss: 2.853 Vali Loss: 14.720 Vali Acc: 0.450 Test Loss: 14.720 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.8772382736206055
Epoch: 10, Steps: 35 | Train Loss: 4.122 Vali Loss: 29.207 Vali Acc: 0.500 Test Loss: 29.207 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.970582485198975
Epoch: 11, Steps: 35 | Train Loss: 4.436 Vali Loss: 20.669 Vali Acc: 0.470 Test Loss: 20.669 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.718107223510742
Epoch: 12, Steps: 35 | Train Loss: 5.623 Vali Loss: 23.926 Vali Acc: 0.460 Test Loss: 23.926 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.818422317504883
Epoch: 13, Steps: 35 | Train Loss: 7.591 Vali Loss: 14.973 Vali Acc: 0.540 Test Loss: 14.973 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.818348407745361
Epoch: 14, Steps: 35 | Train Loss: 3.630 Vali Loss: 18.056 Vali Acc: 0.550 Test Loss: 18.056 Test Acc: 0.550
Validation loss decreased (-0.539900 --> -0.549819).  Saving model ...
Epoch: 15 cost time: 7.005677223205566
Epoch: 15, Steps: 35 | Train Loss: 2.926 Vali Loss: 32.495 Vali Acc: 0.500 Test Loss: 32.495 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.722182273864746
Epoch: 16, Steps: 35 | Train Loss: 9.980 Vali Loss: 53.276 Vali Acc: 0.510 Test Loss: 53.276 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.924442529678345
Epoch: 17, Steps: 35 | Train Loss: 5.432 Vali Loss: 39.109 Vali Acc: 0.530 Test Loss: 39.109 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.823512315750122
Epoch: 18, Steps: 35 | Train Loss: 3.985 Vali Loss: 29.520 Vali Acc: 0.580 Test Loss: 29.520 Test Acc: 0.580
Validation loss decreased (-0.549819 --> -0.579705).  Saving model ...
Epoch: 19 cost time: 6.578310012817383
Epoch: 19, Steps: 35 | Train Loss: 2.226 Vali Loss: 26.293 Vali Acc: 0.540 Test Loss: 26.293 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.8237245082855225
Epoch: 20, Steps: 35 | Train Loss: 2.836 Vali Loss: 32.273 Vali Acc: 0.480 Test Loss: 32.273 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.923661947250366
Epoch: 21, Steps: 35 | Train Loss: 2.328 Vali Loss: 50.314 Vali Acc: 0.470 Test Loss: 50.314 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.826067924499512
Epoch: 22, Steps: 35 | Train Loss: 2.256 Vali Loss: 33.688 Vali Acc: 0.550 Test Loss: 33.688 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.8772406578063965
Epoch: 23, Steps: 35 | Train Loss: 6.390 Vali Loss: 42.175 Vali Acc: 0.520 Test Loss: 42.175 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.924692392349243
Epoch: 24, Steps: 35 | Train Loss: 3.103 Vali Loss: 28.602 Vali Acc: 0.480 Test Loss: 28.602 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.619276762008667
Epoch: 25, Steps: 35 | Train Loss: 1.607 Vali Loss: 46.477 Vali Acc: 0.540 Test Loss: 46.477 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.7568793296813965
Epoch: 26, Steps: 35 | Train Loss: 2.073 Vali Loss: 36.289 Vali Acc: 0.530 Test Loss: 36.289 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.616910934448242
Epoch: 27, Steps: 35 | Train Loss: 1.894 Vali Loss: 53.310 Vali Acc: 0.520 Test Loss: 53.310 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.758708953857422
Epoch: 28, Steps: 35 | Train Loss: 2.913 Vali Loss: 57.906 Vali Acc: 0.550 Test Loss: 57.906 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2442786
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.899892568588257
Epoch: 1, Steps: 35 | Train Loss: 2.078 Vali Loss: 4.972 Vali Acc: 0.450 Test Loss: 4.972 Test Acc: 0.450
Validation loss decreased (inf --> -0.449950).  Saving model ...
Epoch: 2 cost time: 6.08902382850647
Epoch: 2, Steps: 35 | Train Loss: 5.118 Vali Loss: 10.908 Vali Acc: 0.500 Test Loss: 10.908 Test Acc: 0.500
Validation loss decreased (-0.449950 --> -0.499891).  Saving model ...
Epoch: 3 cost time: 6.130526304244995
Epoch: 3, Steps: 35 | Train Loss: 4.082 Vali Loss: 9.179 Vali Acc: 0.530 Test Loss: 9.179 Test Acc: 0.530
Validation loss decreased (-0.499891 --> -0.529908).  Saving model ...
Epoch: 4 cost time: 6.0763256549835205
Epoch: 4, Steps: 35 | Train Loss: 11.197 Vali Loss: 16.443 Vali Acc: 0.450 Test Loss: 16.443 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.062544345855713
Epoch: 5, Steps: 35 | Train Loss: 5.721 Vali Loss: 15.479 Vali Acc: 0.470 Test Loss: 15.479 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.399999380111694
Epoch: 6, Steps: 35 | Train Loss: 7.930 Vali Loss: 19.337 Vali Acc: 0.440 Test Loss: 19.337 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.51111912727356
Epoch: 7, Steps: 35 | Train Loss: 9.607 Vali Loss: 25.564 Vali Acc: 0.500 Test Loss: 25.564 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.072374105453491
Epoch: 8, Steps: 35 | Train Loss: 6.427 Vali Loss: 12.116 Vali Acc: 0.510 Test Loss: 12.116 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.5311126708984375
Epoch: 9, Steps: 35 | Train Loss: 5.076 Vali Loss: 16.887 Vali Acc: 0.500 Test Loss: 16.887 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.257976293563843
Epoch: 10, Steps: 35 | Train Loss: 5.521 Vali Loss: 31.884 Vali Acc: 0.490 Test Loss: 31.884 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.0270795822143555
Epoch: 11, Steps: 35 | Train Loss: 6.653 Vali Loss: 21.800 Vali Acc: 0.510 Test Loss: 21.800 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.24870753288269
Epoch: 12, Steps: 35 | Train Loss: 4.482 Vali Loss: 22.499 Vali Acc: 0.530 Test Loss: 22.499 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.239150285720825
Epoch: 13, Steps: 35 | Train Loss: 3.465 Vali Loss: 13.906 Vali Acc: 0.590 Test Loss: 13.906 Test Acc: 0.590
Validation loss decreased (-0.529908 --> -0.589861).  Saving model ...
Epoch: 14 cost time: 6.637014150619507
Epoch: 14, Steps: 35 | Train Loss: 5.773 Vali Loss: 20.980 Vali Acc: 0.560 Test Loss: 20.980 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.094949007034302
Epoch: 15, Steps: 35 | Train Loss: 8.779 Vali Loss: 17.794 Vali Acc: 0.550 Test Loss: 17.794 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.435967445373535
Epoch: 16, Steps: 35 | Train Loss: 12.885 Vali Loss: 27.631 Vali Acc: 0.550 Test Loss: 27.631 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.347424268722534
Epoch: 17, Steps: 35 | Train Loss: 6.567 Vali Loss: 35.944 Vali Acc: 0.540 Test Loss: 35.944 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.461420297622681
Epoch: 18, Steps: 35 | Train Loss: 7.964 Vali Loss: 47.635 Vali Acc: 0.510 Test Loss: 47.635 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.439300775527954
Epoch: 19, Steps: 35 | Train Loss: 9.164 Vali Loss: 34.746 Vali Acc: 0.420 Test Loss: 34.746 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.510683059692383
Epoch: 20, Steps: 35 | Train Loss: 5.145 Vali Loss: 18.604 Vali Acc: 0.560 Test Loss: 18.604 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.4139463901519775
Epoch: 21, Steps: 35 | Train Loss: 3.907 Vali Loss: 25.085 Vali Acc: 0.550 Test Loss: 25.085 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.191120862960815
Epoch: 22, Steps: 35 | Train Loss: 2.992 Vali Loss: 36.016 Vali Acc: 0.500 Test Loss: 36.016 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.32702898979187
Epoch: 23, Steps: 35 | Train Loss: 3.835 Vali Loss: 45.125 Vali Acc: 0.520 Test Loss: 45.125 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2442786
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.650505542755127
Epoch: 1, Steps: 35 | Train Loss: 3.322 Vali Loss: 4.322 Vali Acc: 0.460 Test Loss: 4.322 Test Acc: 0.460
Validation loss decreased (inf --> -0.459957).  Saving model ...
Epoch: 2 cost time: 8.10103702545166
Epoch: 2, Steps: 35 | Train Loss: 4.519 Vali Loss: 6.227 Vali Acc: 0.510 Test Loss: 6.227 Test Acc: 0.510
Validation loss decreased (-0.459957 --> -0.509938).  Saving model ...
Epoch: 3 cost time: 8.4945809841156
Epoch: 3, Steps: 35 | Train Loss: 5.896 Vali Loss: 14.116 Vali Acc: 0.480 Test Loss: 14.116 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.164222002029419
Epoch: 4, Steps: 35 | Train Loss: 8.211 Vali Loss: 6.288 Vali Acc: 0.500 Test Loss: 6.288 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.612653255462646
Epoch: 5, Steps: 35 | Train Loss: 7.023 Vali Loss: 23.353 Vali Acc: 0.500 Test Loss: 23.353 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.571718215942383
Epoch: 6, Steps: 35 | Train Loss: 9.520 Vali Loss: 12.667 Vali Acc: 0.490 Test Loss: 12.667 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.090825319290161
Epoch: 7, Steps: 35 | Train Loss: 5.426 Vali Loss: 13.794 Vali Acc: 0.470 Test Loss: 13.794 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.303170204162598
Epoch: 8, Steps: 35 | Train Loss: 2.525 Vali Loss: 19.461 Vali Acc: 0.540 Test Loss: 19.461 Test Acc: 0.540
Validation loss decreased (-0.509938 --> -0.539805).  Saving model ...
Epoch: 9 cost time: 8.097102403640747
Epoch: 9, Steps: 35 | Train Loss: 5.551 Vali Loss: 9.370 Vali Acc: 0.570 Test Loss: 9.370 Test Acc: 0.570
Validation loss decreased (-0.539805 --> -0.569906).  Saving model ...
Epoch: 10 cost time: 8.445040702819824
Epoch: 10, Steps: 35 | Train Loss: 3.715 Vali Loss: 31.559 Vali Acc: 0.480 Test Loss: 31.559 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.45646619796753
Epoch: 11, Steps: 35 | Train Loss: 6.569 Vali Loss: 26.759 Vali Acc: 0.540 Test Loss: 26.759 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.322156190872192
Epoch: 12, Steps: 35 | Train Loss: 2.715 Vali Loss: 38.504 Vali Acc: 0.500 Test Loss: 38.504 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.32766342163086
Epoch: 13, Steps: 35 | Train Loss: 3.221 Vali Loss: 20.327 Vali Acc: 0.550 Test Loss: 20.327 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.430965662002563
Epoch: 14, Steps: 35 | Train Loss: 4.465 Vali Loss: 12.860 Vali Acc: 0.490 Test Loss: 12.860 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.672237634658813
Epoch: 15, Steps: 35 | Train Loss: 2.952 Vali Loss: 25.483 Vali Acc: 0.570 Test Loss: 25.483 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.760190725326538
Epoch: 16, Steps: 35 | Train Loss: 2.939 Vali Loss: 25.523 Vali Acc: 0.490 Test Loss: 25.523 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.775132417678833
Epoch: 17, Steps: 35 | Train Loss: 5.252 Vali Loss: 22.363 Vali Acc: 0.550 Test Loss: 22.363 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.476354837417603
Epoch: 18, Steps: 35 | Train Loss: 7.669 Vali Loss: 27.615 Vali Acc: 0.500 Test Loss: 27.615 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.290231466293335
Epoch: 19, Steps: 35 | Train Loss: 2.702 Vali Loss: 31.545 Vali Acc: 0.560 Test Loss: 31.545 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2180642
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.078811645507812
Epoch: 1, Steps: 35 | Train Loss: 3.069 Vali Loss: 6.751 Vali Acc: 0.470 Test Loss: 6.751 Test Acc: 0.470
Validation loss decreased (inf --> -0.469932).  Saving model ...
Epoch: 2 cost time: 7.552952289581299
Epoch: 2, Steps: 35 | Train Loss: 5.857 Vali Loss: 6.131 Vali Acc: 0.610 Test Loss: 6.131 Test Acc: 0.610
Validation loss decreased (-0.469932 --> -0.609939).  Saving model ...
Epoch: 3 cost time: 7.094062805175781
Epoch: 3, Steps: 35 | Train Loss: 7.623 Vali Loss: 15.831 Vali Acc: 0.470 Test Loss: 15.831 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.783641815185547
Epoch: 4, Steps: 35 | Train Loss: 6.523 Vali Loss: 8.893 Vali Acc: 0.510 Test Loss: 8.893 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.659834146499634
Epoch: 5, Steps: 35 | Train Loss: 6.496 Vali Loss: 12.394 Vali Acc: 0.460 Test Loss: 12.394 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.939568281173706
Epoch: 6, Steps: 35 | Train Loss: 6.896 Vali Loss: 12.977 Vali Acc: 0.550 Test Loss: 12.977 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.535471200942993
Epoch: 7, Steps: 35 | Train Loss: 9.360 Vali Loss: 10.205 Vali Acc: 0.570 Test Loss: 10.205 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.234453678131104
Epoch: 8, Steps: 35 | Train Loss: 11.253 Vali Loss: 67.195 Vali Acc: 0.500 Test Loss: 67.195 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.430621147155762
Epoch: 9, Steps: 35 | Train Loss: 17.267 Vali Loss: 17.007 Vali Acc: 0.450 Test Loss: 17.007 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.524373769760132
Epoch: 10, Steps: 35 | Train Loss: 7.638 Vali Loss: 17.116 Vali Acc: 0.490 Test Loss: 17.116 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.018779277801514
Epoch: 11, Steps: 35 | Train Loss: 6.518 Vali Loss: 34.913 Vali Acc: 0.500 Test Loss: 34.913 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.97584342956543
Epoch: 12, Steps: 35 | Train Loss: 2.923 Vali Loss: 38.423 Vali Acc: 0.450 Test Loss: 38.423 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2180642
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.22013783454895
Epoch: 1, Steps: 35 | Train Loss: 2.876 Vali Loss: 7.617 Vali Acc: 0.480 Test Loss: 7.617 Test Acc: 0.480
Validation loss decreased (inf --> -0.479924).  Saving model ...
Epoch: 2 cost time: 6.712324619293213
Epoch: 2, Steps: 35 | Train Loss: 5.994 Vali Loss: 4.810 Vali Acc: 0.570 Test Loss: 4.810 Test Acc: 0.570
Validation loss decreased (-0.479924 --> -0.569952).  Saving model ...
Epoch: 3 cost time: 6.817789077758789
Epoch: 3, Steps: 35 | Train Loss: 14.355 Vali Loss: 35.311 Vali Acc: 0.500 Test Loss: 35.311 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.206312417984009
Epoch: 4, Steps: 35 | Train Loss: 8.708 Vali Loss: 9.078 Vali Acc: 0.530 Test Loss: 9.078 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.120216131210327
Epoch: 5, Steps: 35 | Train Loss: 7.471 Vali Loss: 9.724 Vali Acc: 0.500 Test Loss: 9.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.962804317474365
Epoch: 6, Steps: 35 | Train Loss: 7.168 Vali Loss: 11.064 Vali Acc: 0.500 Test Loss: 11.064 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.963373422622681
Epoch: 7, Steps: 35 | Train Loss: 7.252 Vali Loss: 13.465 Vali Acc: 0.430 Test Loss: 13.465 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.25538969039917
Epoch: 8, Steps: 35 | Train Loss: 8.822 Vali Loss: 11.258 Vali Acc: 0.510 Test Loss: 11.258 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.201406955718994
Epoch: 9, Steps: 35 | Train Loss: 5.227 Vali Loss: 26.146 Vali Acc: 0.450 Test Loss: 26.146 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.9961323738098145
Epoch: 10, Steps: 35 | Train Loss: 4.401 Vali Loss: 46.584 Vali Acc: 0.480 Test Loss: 46.584 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.2832207679748535
Epoch: 11, Steps: 35 | Train Loss: 5.956 Vali Loss: 21.259 Vali Acc: 0.590 Test Loss: 21.259 Test Acc: 0.590
Validation loss decreased (-0.569952 --> -0.589787).  Saving model ...
Epoch: 12 cost time: 6.969140291213989
Epoch: 12, Steps: 35 | Train Loss: 5.701 Vali Loss: 28.344 Vali Acc: 0.480 Test Loss: 28.344 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.7862303256988525
Epoch: 13, Steps: 35 | Train Loss: 3.901 Vali Loss: 14.163 Vali Acc: 0.590 Test Loss: 14.163 Test Acc: 0.590
Validation loss decreased (-0.589787 --> -0.589858).  Saving model ...
Epoch: 14 cost time: 6.8223347663879395
Epoch: 14, Steps: 35 | Train Loss: 2.375 Vali Loss: 61.719 Vali Acc: 0.490 Test Loss: 61.719 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.560891151428223
Epoch: 15, Steps: 35 | Train Loss: 5.680 Vali Loss: 20.806 Vali Acc: 0.480 Test Loss: 20.806 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.935817718505859
Epoch: 16, Steps: 35 | Train Loss: 5.830 Vali Loss: 37.099 Vali Acc: 0.530 Test Loss: 37.099 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.86530613899231
Epoch: 17, Steps: 35 | Train Loss: 2.800 Vali Loss: 31.423 Vali Acc: 0.480 Test Loss: 31.423 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.714467287063599
Epoch: 18, Steps: 35 | Train Loss: 5.560 Vali Loss: 56.074 Vali Acc: 0.500 Test Loss: 56.074 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.827647924423218
Epoch: 19, Steps: 35 | Train Loss: 2.920 Vali Loss: 27.877 Vali Acc: 0.540 Test Loss: 27.877 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.643930435180664
Epoch: 20, Steps: 35 | Train Loss: 2.645 Vali Loss: 19.266 Vali Acc: 0.530 Test Loss: 19.266 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.766656160354614
Epoch: 21, Steps: 35 | Train Loss: 2.378 Vali Loss: 24.162 Vali Acc: 0.510 Test Loss: 24.162 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.891025066375732
Epoch: 22, Steps: 35 | Train Loss: 1.746 Vali Loss: 30.658 Vali Acc: 0.540 Test Loss: 30.658 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.57320761680603
Epoch: 23, Steps: 35 | Train Loss: 3.308 Vali Loss: 37.171 Vali Acc: 0.530 Test Loss: 37.171 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2180642
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.485426902770996
Epoch: 1, Steps: 35 | Train Loss: 2.425 Vali Loss: 8.240 Vali Acc: 0.470 Test Loss: 8.240 Test Acc: 0.470
Validation loss decreased (inf --> -0.469918).  Saving model ...
Epoch: 2 cost time: 5.851544618606567
Epoch: 2, Steps: 35 | Train Loss: 4.441 Vali Loss: 7.650 Vali Acc: 0.470 Test Loss: 7.650 Test Acc: 0.470
Validation loss decreased (-0.469918 --> -0.469923).  Saving model ...
Epoch: 3 cost time: 6.021405458450317
Epoch: 3, Steps: 35 | Train Loss: 5.574 Vali Loss: 10.022 Vali Acc: 0.470 Test Loss: 10.022 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.131912708282471
Epoch: 4, Steps: 35 | Train Loss: 7.398 Vali Loss: 9.360 Vali Acc: 0.530 Test Loss: 9.360 Test Acc: 0.530
Validation loss decreased (-0.469923 --> -0.529906).  Saving model ...
Epoch: 5 cost time: 5.893378496170044
Epoch: 5, Steps: 35 | Train Loss: 8.217 Vali Loss: 13.882 Vali Acc: 0.470 Test Loss: 13.882 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.774824142456055
Epoch: 6, Steps: 35 | Train Loss: 5.828 Vali Loss: 7.099 Vali Acc: 0.550 Test Loss: 7.099 Test Acc: 0.550
Validation loss decreased (-0.529906 --> -0.549929).  Saving model ...
Epoch: 7 cost time: 6.188330173492432
Epoch: 7, Steps: 35 | Train Loss: 3.271 Vali Loss: 10.870 Vali Acc: 0.530 Test Loss: 10.870 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.135749816894531
Epoch: 8, Steps: 35 | Train Loss: 4.606 Vali Loss: 12.024 Vali Acc: 0.510 Test Loss: 12.024 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.876471281051636
Epoch: 9, Steps: 35 | Train Loss: 7.396 Vali Loss: 7.990 Vali Acc: 0.590 Test Loss: 7.990 Test Acc: 0.590
Validation loss decreased (-0.549929 --> -0.589920).  Saving model ...
Epoch: 10 cost time: 6.058732032775879
Epoch: 10, Steps: 35 | Train Loss: 6.274 Vali Loss: 13.995 Vali Acc: 0.500 Test Loss: 13.995 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.310569763183594
Epoch: 11, Steps: 35 | Train Loss: 3.712 Vali Loss: 17.773 Vali Acc: 0.480 Test Loss: 17.773 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.30781364440918
Epoch: 12, Steps: 35 | Train Loss: 4.982 Vali Loss: 13.142 Vali Acc: 0.480 Test Loss: 13.142 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.087362766265869
Epoch: 13, Steps: 35 | Train Loss: 4.156 Vali Loss: 19.683 Vali Acc: 0.410 Test Loss: 19.683 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.1206138134002686
Epoch: 14, Steps: 35 | Train Loss: 3.360 Vali Loss: 19.668 Vali Acc: 0.530 Test Loss: 19.668 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.633406162261963
Epoch: 15, Steps: 35 | Train Loss: 3.573 Vali Loss: 23.644 Vali Acc: 0.510 Test Loss: 23.644 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.287286043167114
Epoch: 16, Steps: 35 | Train Loss: 6.145 Vali Loss: 18.284 Vali Acc: 0.550 Test Loss: 18.284 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.13077449798584
Epoch: 17, Steps: 35 | Train Loss: 3.632 Vali Loss: 26.227 Vali Acc: 0.520 Test Loss: 26.227 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.749281644821167
Epoch: 18, Steps: 35 | Train Loss: 5.586 Vali Loss: 39.264 Vali Acc: 0.410 Test Loss: 39.264 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.015547037124634
Epoch: 19, Steps: 35 | Train Loss: 5.263 Vali Loss: 28.920 Vali Acc: 0.530 Test Loss: 28.920 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2180642
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.327749013900757
Epoch: 1, Steps: 35 | Train Loss: 4.406 Vali Loss: 6.357 Vali Acc: 0.420 Test Loss: 6.357 Test Acc: 0.420
Validation loss decreased (inf --> -0.419936).  Saving model ...
Epoch: 2 cost time: 8.014280319213867
Epoch: 2, Steps: 35 | Train Loss: 10.655 Vali Loss: 9.480 Vali Acc: 0.520 Test Loss: 9.480 Test Acc: 0.520
Validation loss decreased (-0.419936 --> -0.519905).  Saving model ...
Epoch: 3 cost time: 7.9966700077056885
Epoch: 3, Steps: 35 | Train Loss: 9.553 Vali Loss: 6.169 Vali Acc: 0.490 Test Loss: 6.169 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.050837516784668
Epoch: 4, Steps: 35 | Train Loss: 11.640 Vali Loss: 23.171 Vali Acc: 0.550 Test Loss: 23.171 Test Acc: 0.550
Validation loss decreased (-0.519905 --> -0.549768).  Saving model ...
Epoch: 5 cost time: 7.867706537246704
Epoch: 5, Steps: 35 | Train Loss: 8.971 Vali Loss: 17.545 Vali Acc: 0.530 Test Loss: 17.545 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.535566329956055
Epoch: 6, Steps: 35 | Train Loss: 6.119 Vali Loss: 16.452 Vali Acc: 0.510 Test Loss: 16.452 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.955578088760376
Epoch: 7, Steps: 35 | Train Loss: 8.544 Vali Loss: 13.730 Vali Acc: 0.530 Test Loss: 13.730 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.869982481002808
Epoch: 8, Steps: 35 | Train Loss: 4.027 Vali Loss: 17.665 Vali Acc: 0.530 Test Loss: 17.665 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.008180141448975
Epoch: 9, Steps: 35 | Train Loss: 8.967 Vali Loss: 11.000 Vali Acc: 0.510 Test Loss: 11.000 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.159298181533813
Epoch: 10, Steps: 35 | Train Loss: 2.223 Vali Loss: 15.475 Vali Acc: 0.430 Test Loss: 15.475 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.53740644454956
Epoch: 11, Steps: 35 | Train Loss: 2.465 Vali Loss: 20.310 Vali Acc: 0.530 Test Loss: 20.310 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.640068292617798
Epoch: 12, Steps: 35 | Train Loss: 8.099 Vali Loss: 21.355 Vali Acc: 0.540 Test Loss: 21.355 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.451168060302734
Epoch: 13, Steps: 35 | Train Loss: 4.461 Vali Loss: 22.376 Vali Acc: 0.540 Test Loss: 22.376 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.392632484436035
Epoch: 14, Steps: 35 | Train Loss: 2.935 Vali Loss: 26.673 Vali Acc: 0.520 Test Loss: 26.673 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2049570
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.165614128112793
Epoch: 1, Steps: 35 | Train Loss: 4.508 Vali Loss: 9.325 Vali Acc: 0.410 Test Loss: 9.325 Test Acc: 0.410
Validation loss decreased (inf --> -0.409907).  Saving model ...
Epoch: 2 cost time: 7.661804676055908
Epoch: 2, Steps: 35 | Train Loss: 7.428 Vali Loss: 8.107 Vali Acc: 0.490 Test Loss: 8.107 Test Acc: 0.490
Validation loss decreased (-0.409907 --> -0.489919).  Saving model ...
Epoch: 3 cost time: 7.664490222930908
Epoch: 3, Steps: 35 | Train Loss: 8.317 Vali Loss: 15.226 Vali Acc: 0.520 Test Loss: 15.226 Test Acc: 0.520
Validation loss decreased (-0.489919 --> -0.519848).  Saving model ...
Epoch: 4 cost time: 7.820346355438232
Epoch: 4, Steps: 35 | Train Loss: 5.295 Vali Loss: 9.696 Vali Acc: 0.500 Test Loss: 9.696 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.987337350845337
Epoch: 5, Steps: 35 | Train Loss: 5.696 Vali Loss: 14.851 Vali Acc: 0.510 Test Loss: 14.851 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.807540416717529
Epoch: 6, Steps: 35 | Train Loss: 9.350 Vali Loss: 9.921 Vali Acc: 0.500 Test Loss: 9.921 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.96639609336853
Epoch: 7, Steps: 35 | Train Loss: 6.020 Vali Loss: 28.697 Vali Acc: 0.480 Test Loss: 28.697 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.70491361618042
Epoch: 8, Steps: 35 | Train Loss: 3.936 Vali Loss: 34.904 Vali Acc: 0.530 Test Loss: 34.904 Test Acc: 0.530
Validation loss decreased (-0.519848 --> -0.529651).  Saving model ...
Epoch: 9 cost time: 7.595368146896362
Epoch: 9, Steps: 35 | Train Loss: 11.222 Vali Loss: 13.837 Vali Acc: 0.450 Test Loss: 13.837 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.413554430007935
Epoch: 10, Steps: 35 | Train Loss: 5.539 Vali Loss: 18.645 Vali Acc: 0.540 Test Loss: 18.645 Test Acc: 0.540
Validation loss decreased (-0.529651 --> -0.539814).  Saving model ...
Epoch: 11 cost time: 7.303244352340698
Epoch: 11, Steps: 35 | Train Loss: 6.274 Vali Loss: 25.132 Vali Acc: 0.520 Test Loss: 25.132 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.362457990646362
Epoch: 12, Steps: 35 | Train Loss: 4.606 Vali Loss: 31.294 Vali Acc: 0.540 Test Loss: 31.294 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.306336879730225
Epoch: 13, Steps: 35 | Train Loss: 3.863 Vali Loss: 14.819 Vali Acc: 0.500 Test Loss: 14.819 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.289116382598877
Epoch: 14, Steps: 35 | Train Loss: 5.853 Vali Loss: 43.104 Vali Acc: 0.460 Test Loss: 43.104 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.427159070968628
Epoch: 15, Steps: 35 | Train Loss: 5.487 Vali Loss: 16.090 Vali Acc: 0.510 Test Loss: 16.090 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.485569953918457
Epoch: 16, Steps: 35 | Train Loss: 2.523 Vali Loss: 23.838 Vali Acc: 0.560 Test Loss: 23.838 Test Acc: 0.560
Validation loss decreased (-0.539814 --> -0.559762).  Saving model ...
Epoch: 17 cost time: 7.43570613861084
Epoch: 17, Steps: 35 | Train Loss: 1.561 Vali Loss: 29.164 Vali Acc: 0.500 Test Loss: 29.164 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.517686128616333
Epoch: 18, Steps: 35 | Train Loss: 0.980 Vali Loss: 22.165 Vali Acc: 0.520 Test Loss: 22.165 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.427049875259399
Epoch: 19, Steps: 35 | Train Loss: 1.282 Vali Loss: 39.935 Vali Acc: 0.500 Test Loss: 39.935 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.577573776245117
Epoch: 20, Steps: 35 | Train Loss: 8.173 Vali Loss: 33.978 Vali Acc: 0.560 Test Loss: 33.978 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.37865138053894
Epoch: 21, Steps: 35 | Train Loss: 4.196 Vali Loss: 24.158 Vali Acc: 0.510 Test Loss: 24.158 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.341034173965454
Epoch: 22, Steps: 35 | Train Loss: 2.975 Vali Loss: 26.048 Vali Acc: 0.490 Test Loss: 26.048 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.840399503707886
Epoch: 23, Steps: 35 | Train Loss: 7.829 Vali Loss: 27.634 Vali Acc: 0.540 Test Loss: 27.634 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.664370775222778
Epoch: 24, Steps: 35 | Train Loss: 2.285 Vali Loss: 32.857 Vali Acc: 0.560 Test Loss: 32.857 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.848325967788696
Epoch: 25, Steps: 35 | Train Loss: 2.661 Vali Loss: 44.489 Vali Acc: 0.480 Test Loss: 44.489 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.789856195449829
Epoch: 26, Steps: 35 | Train Loss: 2.079 Vali Loss: 27.286 Vali Acc: 0.460 Test Loss: 27.286 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2049570
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.605521202087402
Epoch: 1, Steps: 35 | Train Loss: 4.384 Vali Loss: 6.932 Vali Acc: 0.440 Test Loss: 6.932 Test Acc: 0.440
Validation loss decreased (inf --> -0.439931).  Saving model ...
Epoch: 2 cost time: 6.676059007644653
Epoch: 2, Steps: 35 | Train Loss: 8.600 Vali Loss: 14.152 Vali Acc: 0.510 Test Loss: 14.152 Test Acc: 0.510
Validation loss decreased (-0.439931 --> -0.509858).  Saving model ...
Epoch: 3 cost time: 6.623700857162476
Epoch: 3, Steps: 35 | Train Loss: 12.628 Vali Loss: 7.608 Vali Acc: 0.540 Test Loss: 7.608 Test Acc: 0.540
Validation loss decreased (-0.509858 --> -0.539924).  Saving model ...
Epoch: 4 cost time: 6.598490238189697
Epoch: 4, Steps: 35 | Train Loss: 8.181 Vali Loss: 8.144 Vali Acc: 0.440 Test Loss: 8.144 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.801596403121948
Epoch: 5, Steps: 35 | Train Loss: 5.949 Vali Loss: 17.394 Vali Acc: 0.490 Test Loss: 17.394 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.9352898597717285
Epoch: 6, Steps: 35 | Train Loss: 7.664 Vali Loss: 10.104 Vali Acc: 0.520 Test Loss: 10.104 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.717272520065308
Epoch: 7, Steps: 35 | Train Loss: 3.726 Vali Loss: 20.917 Vali Acc: 0.500 Test Loss: 20.917 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.751503229141235
Epoch: 8, Steps: 35 | Train Loss: 4.294 Vali Loss: 25.288 Vali Acc: 0.520 Test Loss: 25.288 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.501555442810059
Epoch: 9, Steps: 35 | Train Loss: 4.291 Vali Loss: 18.457 Vali Acc: 0.510 Test Loss: 18.457 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.5163733959198
Epoch: 10, Steps: 35 | Train Loss: 4.305 Vali Loss: 50.569 Vali Acc: 0.510 Test Loss: 50.569 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.428380489349365
Epoch: 11, Steps: 35 | Train Loss: 7.383 Vali Loss: 36.680 Vali Acc: 0.490 Test Loss: 36.680 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.646273136138916
Epoch: 12, Steps: 35 | Train Loss: 8.116 Vali Loss: 17.465 Vali Acc: 0.570 Test Loss: 17.465 Test Acc: 0.570
Validation loss decreased (-0.539924 --> -0.569825).  Saving model ...
Epoch: 13 cost time: 6.602442502975464
Epoch: 13, Steps: 35 | Train Loss: 3.805 Vali Loss: 16.486 Vali Acc: 0.540 Test Loss: 16.486 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.763137102127075
Epoch: 14, Steps: 35 | Train Loss: 2.765 Vali Loss: 18.933 Vali Acc: 0.490 Test Loss: 18.933 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.694729804992676
Epoch: 15, Steps: 35 | Train Loss: 3.038 Vali Loss: 20.263 Vali Acc: 0.530 Test Loss: 20.263 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.652754068374634
Epoch: 16, Steps: 35 | Train Loss: 2.249 Vali Loss: 24.020 Vali Acc: 0.540 Test Loss: 24.020 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.447126150131226
Epoch: 17, Steps: 35 | Train Loss: 8.211 Vali Loss: 18.781 Vali Acc: 0.600 Test Loss: 18.781 Test Acc: 0.600
Validation loss decreased (-0.569825 --> -0.599812).  Saving model ...
Epoch: 18 cost time: 6.534754991531372
Epoch: 18, Steps: 35 | Train Loss: 4.818 Vali Loss: 26.641 Vali Acc: 0.550 Test Loss: 26.641 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.509446144104004
Epoch: 19, Steps: 35 | Train Loss: 3.707 Vali Loss: 23.611 Vali Acc: 0.570 Test Loss: 23.611 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.6673972606658936
Epoch: 20, Steps: 35 | Train Loss: 5.760 Vali Loss: 40.236 Vali Acc: 0.530 Test Loss: 40.236 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.599844694137573
Epoch: 21, Steps: 35 | Train Loss: 3.137 Vali Loss: 41.510 Vali Acc: 0.510 Test Loss: 41.510 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.6982200145721436
Epoch: 22, Steps: 35 | Train Loss: 3.376 Vali Loss: 33.821 Vali Acc: 0.570 Test Loss: 33.821 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.735313653945923
Epoch: 23, Steps: 35 | Train Loss: 12.642 Vali Loss: 105.517 Vali Acc: 0.510 Test Loss: 105.517 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.597635984420776
Epoch: 24, Steps: 35 | Train Loss: 4.857 Vali Loss: 48.176 Vali Acc: 0.460 Test Loss: 48.176 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.672736644744873
Epoch: 25, Steps: 35 | Train Loss: 7.364 Vali Loss: 61.908 Vali Acc: 0.470 Test Loss: 61.908 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.602705240249634
Epoch: 26, Steps: 35 | Train Loss: 7.425 Vali Loss: 44.517 Vali Acc: 0.530 Test Loss: 44.517 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.8168299198150635
Epoch: 27, Steps: 35 | Train Loss: 5.714 Vali Loss: 61.198 Vali Acc: 0.470 Test Loss: 61.198 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2049570
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.84173846244812
Epoch: 1, Steps: 35 | Train Loss: 2.827 Vali Loss: 5.250 Vali Acc: 0.500 Test Loss: 5.250 Test Acc: 0.500
Validation loss decreased (inf --> -0.499948).  Saving model ...
Epoch: 2 cost time: 5.976421594619751
Epoch: 2, Steps: 35 | Train Loss: 4.865 Vali Loss: 8.428 Vali Acc: 0.450 Test Loss: 8.428 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.979753255844116
Epoch: 3, Steps: 35 | Train Loss: 5.262 Vali Loss: 11.282 Vali Acc: 0.500 Test Loss: 11.282 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.428985118865967
Epoch: 4, Steps: 35 | Train Loss: 5.402 Vali Loss: 19.383 Vali Acc: 0.480 Test Loss: 19.383 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.223507881164551
Epoch: 5, Steps: 35 | Train Loss: 6.162 Vali Loss: 15.948 Vali Acc: 0.480 Test Loss: 15.948 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.1744065284729
Epoch: 6, Steps: 35 | Train Loss: 4.801 Vali Loss: 7.321 Vali Acc: 0.450 Test Loss: 7.321 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.394467115402222
Epoch: 7, Steps: 35 | Train Loss: 4.846 Vali Loss: 32.076 Vali Acc: 0.490 Test Loss: 32.076 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.185022354125977
Epoch: 8, Steps: 35 | Train Loss: 6.336 Vali Loss: 26.428 Vali Acc: 0.530 Test Loss: 26.428 Test Acc: 0.530
Validation loss decreased (-0.499948 --> -0.529736).  Saving model ...
Epoch: 9 cost time: 6.334150314331055
Epoch: 9, Steps: 35 | Train Loss: 8.991 Vali Loss: 13.895 Vali Acc: 0.450 Test Loss: 13.895 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.003177642822266
Epoch: 10, Steps: 35 | Train Loss: 4.455 Vali Loss: 18.208 Vali Acc: 0.460 Test Loss: 18.208 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.688421010971069
Epoch: 11, Steps: 35 | Train Loss: 5.047 Vali Loss: 22.003 Vali Acc: 0.490 Test Loss: 22.003 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.022728204727173
Epoch: 12, Steps: 35 | Train Loss: 8.303 Vali Loss: 14.295 Vali Acc: 0.450 Test Loss: 14.295 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.024551630020142
Epoch: 13, Steps: 35 | Train Loss: 3.794 Vali Loss: 12.226 Vali Acc: 0.480 Test Loss: 12.226 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.991514205932617
Epoch: 14, Steps: 35 | Train Loss: 6.804 Vali Loss: 15.293 Vali Acc: 0.540 Test Loss: 15.293 Test Acc: 0.540
Validation loss decreased (-0.529736 --> -0.539847).  Saving model ...
Epoch: 15 cost time: 6.184654712677002
Epoch: 15, Steps: 35 | Train Loss: 5.370 Vali Loss: 27.655 Vali Acc: 0.450 Test Loss: 27.655 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.734591007232666
Epoch: 16, Steps: 35 | Train Loss: 3.943 Vali Loss: 41.731 Vali Acc: 0.470 Test Loss: 41.731 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.832526445388794
Epoch: 17, Steps: 35 | Train Loss: 2.485 Vali Loss: 17.980 Vali Acc: 0.500 Test Loss: 17.980 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.683189392089844
Epoch: 18, Steps: 35 | Train Loss: 3.516 Vali Loss: 23.578 Vali Acc: 0.500 Test Loss: 23.578 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.9760847091674805
Epoch: 19, Steps: 35 | Train Loss: 10.004 Vali Loss: 19.798 Vali Acc: 0.510 Test Loss: 19.798 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.288153648376465
Epoch: 20, Steps: 35 | Train Loss: 4.538 Vali Loss: 36.883 Vali Acc: 0.480 Test Loss: 36.883 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.044274806976318
Epoch: 21, Steps: 35 | Train Loss: 8.865 Vali Loss: 35.429 Vali Acc: 0.520 Test Loss: 35.429 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.904401540756226
Epoch: 22, Steps: 35 | Train Loss: 2.240 Vali Loss: 24.993 Vali Acc: 0.480 Test Loss: 24.993 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.091152191162109
Epoch: 23, Steps: 35 | Train Loss: 7.251 Vali Loss: 36.591 Vali Acc: 0.400 Test Loss: 36.591 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.1426355838775635
Epoch: 24, Steps: 35 | Train Loss: 2.944 Vali Loss: 28.319 Vali Acc: 0.520 Test Loss: 28.319 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 2049570
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.696704387664795
Epoch: 1, Steps: 35 | Train Loss: 3.155 Vali Loss: 4.268 Vali Acc: 0.560 Test Loss: 4.268 Test Acc: 0.560
Validation loss decreased (inf --> -0.559957).  Saving model ...
Epoch: 2 cost time: 8.367600440979004
Epoch: 2, Steps: 35 | Train Loss: 4.980 Vali Loss: 5.923 Vali Acc: 0.510 Test Loss: 5.923 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.443835020065308
Epoch: 3, Steps: 35 | Train Loss: 5.338 Vali Loss: 9.786 Vali Acc: 0.560 Test Loss: 9.786 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.711325645446777
Epoch: 4, Steps: 35 | Train Loss: 5.195 Vali Loss: 10.147 Vali Acc: 0.530 Test Loss: 10.147 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.29508113861084
Epoch: 5, Steps: 35 | Train Loss: 11.107 Vali Loss: 8.581 Vali Acc: 0.460 Test Loss: 8.581 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.399308443069458
Epoch: 6, Steps: 35 | Train Loss: 7.526 Vali Loss: 17.864 Vali Acc: 0.540 Test Loss: 17.864 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.41224193572998
Epoch: 7, Steps: 35 | Train Loss: 8.908 Vali Loss: 13.044 Vali Acc: 0.490 Test Loss: 13.044 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.678795099258423
Epoch: 8, Steps: 35 | Train Loss: 7.451 Vali Loss: 37.044 Vali Acc: 0.500 Test Loss: 37.044 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.254645586013794
Epoch: 9, Steps: 35 | Train Loss: 3.622 Vali Loss: 27.433 Vali Acc: 0.500 Test Loss: 27.433 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.58315110206604
Epoch: 10, Steps: 35 | Train Loss: 6.424 Vali Loss: 30.058 Vali Acc: 0.490 Test Loss: 30.058 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.104756832122803
Epoch: 11, Steps: 35 | Train Loss: 4.277 Vali Loss: 18.287 Vali Acc: 0.560 Test Loss: 18.287 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1984034
model size : 12.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.623193740844727
Epoch: 1, Steps: 35 | Train Loss: 3.089 Vali Loss: 6.356 Vali Acc: 0.490 Test Loss: 6.356 Test Acc: 0.490
Validation loss decreased (inf --> -0.489936).  Saving model ...
Epoch: 2 cost time: 7.31047511100769
Epoch: 2, Steps: 35 | Train Loss: 6.840 Vali Loss: 10.262 Vali Acc: 0.510 Test Loss: 10.262 Test Acc: 0.510
Validation loss decreased (-0.489936 --> -0.509897).  Saving model ...
Epoch: 3 cost time: 7.113086700439453
Epoch: 3, Steps: 35 | Train Loss: 5.203 Vali Loss: 8.393 Vali Acc: 0.450 Test Loss: 8.393 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.2702226638793945
Epoch: 4, Steps: 35 | Train Loss: 7.766 Vali Loss: 8.275 Vali Acc: 0.500 Test Loss: 8.275 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.916789531707764
Epoch: 5, Steps: 35 | Train Loss: 8.008 Vali Loss: 5.752 Vali Acc: 0.580 Test Loss: 5.752 Test Acc: 0.580
Validation loss decreased (-0.509897 --> -0.579942).  Saving model ...
Epoch: 6 cost time: 7.037745952606201
Epoch: 6, Steps: 35 | Train Loss: 8.757 Vali Loss: 10.891 Vali Acc: 0.490 Test Loss: 10.891 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.211871385574341
Epoch: 7, Steps: 35 | Train Loss: 10.196 Vali Loss: 17.675 Vali Acc: 0.560 Test Loss: 17.675 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.1823365688323975
Epoch: 8, Steps: 35 | Train Loss: 5.275 Vali Loss: 35.652 Vali Acc: 0.500 Test Loss: 35.652 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.2233312129974365
Epoch: 9, Steps: 35 | Train Loss: 4.709 Vali Loss: 13.929 Vali Acc: 0.530 Test Loss: 13.929 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.106535911560059
Epoch: 10, Steps: 35 | Train Loss: 7.576 Vali Loss: 13.028 Vali Acc: 0.480 Test Loss: 13.028 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.021277666091919
Epoch: 11, Steps: 35 | Train Loss: 4.543 Vali Loss: 15.790 Vali Acc: 0.540 Test Loss: 15.790 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.08257269859314
Epoch: 12, Steps: 35 | Train Loss: 5.747 Vali Loss: 42.522 Vali Acc: 0.500 Test Loss: 42.522 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.856940031051636
Epoch: 13, Steps: 35 | Train Loss: 4.881 Vali Loss: 44.996 Vali Acc: 0.510 Test Loss: 44.996 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.2665839195251465
Epoch: 14, Steps: 35 | Train Loss: 6.074 Vali Loss: 50.312 Vali Acc: 0.500 Test Loss: 50.312 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.044438600540161
Epoch: 15, Steps: 35 | Train Loss: 7.314 Vali Loss: 29.151 Vali Acc: 0.490 Test Loss: 29.151 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1984034
model size : 12.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.272184610366821
Epoch: 1, Steps: 35 | Train Loss: 2.868 Vali Loss: 9.252 Vali Acc: 0.490 Test Loss: 9.252 Test Acc: 0.490
Validation loss decreased (inf --> -0.489907).  Saving model ...
Epoch: 2 cost time: 6.5409486293792725
Epoch: 2, Steps: 35 | Train Loss: 5.534 Vali Loss: 5.347 Vali Acc: 0.470 Test Loss: 5.347 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6250834465026855
Epoch: 3, Steps: 35 | Train Loss: 6.490 Vali Loss: 5.896 Vali Acc: 0.560 Test Loss: 5.896 Test Acc: 0.560
Validation loss decreased (-0.489907 --> -0.559941).  Saving model ...
Epoch: 4 cost time: 7.057162284851074
Epoch: 4, Steps: 35 | Train Loss: 4.852 Vali Loss: 24.959 Vali Acc: 0.480 Test Loss: 24.959 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.040018320083618
Epoch: 5, Steps: 35 | Train Loss: 9.361 Vali Loss: 15.328 Vali Acc: 0.520 Test Loss: 15.328 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.161189556121826
Epoch: 6, Steps: 35 | Train Loss: 9.982 Vali Loss: 36.167 Vali Acc: 0.500 Test Loss: 36.167 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.9296324253082275
Epoch: 7, Steps: 35 | Train Loss: 13.536 Vali Loss: 11.986 Vali Acc: 0.510 Test Loss: 11.986 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.93545126914978
Epoch: 8, Steps: 35 | Train Loss: 7.703 Vali Loss: 41.812 Vali Acc: 0.510 Test Loss: 41.812 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.0437095165252686
Epoch: 9, Steps: 35 | Train Loss: 7.606 Vali Loss: 13.058 Vali Acc: 0.580 Test Loss: 13.058 Test Acc: 0.580
Validation loss decreased (-0.559941 --> -0.579869).  Saving model ...
Epoch: 10 cost time: 7.079846620559692
Epoch: 10, Steps: 35 | Train Loss: 6.030 Vali Loss: 15.309 Vali Acc: 0.490 Test Loss: 15.309 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.027392864227295
Epoch: 11, Steps: 35 | Train Loss: 6.932 Vali Loss: 11.233 Vali Acc: 0.540 Test Loss: 11.233 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.8609583377838135
Epoch: 12, Steps: 35 | Train Loss: 4.820 Vali Loss: 62.991 Vali Acc: 0.500 Test Loss: 62.991 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.846229076385498
Epoch: 13, Steps: 35 | Train Loss: 11.965 Vali Loss: 20.335 Vali Acc: 0.470 Test Loss: 20.335 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.747668743133545
Epoch: 14, Steps: 35 | Train Loss: 6.886 Vali Loss: 24.664 Vali Acc: 0.530 Test Loss: 24.664 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.781716346740723
Epoch: 15, Steps: 35 | Train Loss: 2.688 Vali Loss: 17.148 Vali Acc: 0.460 Test Loss: 17.148 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.114792823791504
Epoch: 16, Steps: 35 | Train Loss: 11.218 Vali Loss: 29.079 Vali Acc: 0.550 Test Loss: 29.079 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.034311532974243
Epoch: 17, Steps: 35 | Train Loss: 0.957 Vali Loss: 14.518 Vali Acc: 0.670 Test Loss: 14.518 Test Acc: 0.670
Validation loss decreased (-0.579869 --> -0.669855).  Saving model ...
Epoch: 18 cost time: 6.807840347290039
Epoch: 18, Steps: 35 | Train Loss: 3.598 Vali Loss: 24.743 Vali Acc: 0.520 Test Loss: 24.743 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.863507509231567
Epoch: 19, Steps: 35 | Train Loss: 3.782 Vali Loss: 55.827 Vali Acc: 0.520 Test Loss: 55.827 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.656286954879761
Epoch: 20, Steps: 35 | Train Loss: 3.384 Vali Loss: 24.708 Vali Acc: 0.460 Test Loss: 24.708 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.717331886291504
Epoch: 21, Steps: 35 | Train Loss: 1.274 Vali Loss: 25.429 Vali Acc: 0.550 Test Loss: 25.429 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.898496389389038
Epoch: 22, Steps: 35 | Train Loss: 1.508 Vali Loss: 27.320 Vali Acc: 0.510 Test Loss: 27.320 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.00166916847229
Epoch: 23, Steps: 35 | Train Loss: 2.383 Vali Loss: 39.234 Vali Acc: 0.440 Test Loss: 39.234 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.885995626449585
Epoch: 24, Steps: 35 | Train Loss: 2.860 Vali Loss: 29.027 Vali Acc: 0.470 Test Loss: 29.027 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.742960214614868
Epoch: 25, Steps: 35 | Train Loss: 1.461 Vali Loss: 64.232 Vali Acc: 0.520 Test Loss: 64.232 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.802022695541382
Epoch: 26, Steps: 35 | Train Loss: 4.428 Vali Loss: 24.507 Vali Acc: 0.510 Test Loss: 24.507 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.620474576950073
Epoch: 27, Steps: 35 | Train Loss: 1.272 Vali Loss: 33.342 Vali Acc: 0.510 Test Loss: 33.342 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 1984034
model size : 12.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.455941677093506
Epoch: 1, Steps: 35 | Train Loss: 2.817 Vali Loss: 3.889 Vali Acc: 0.430 Test Loss: 3.889 Test Acc: 0.430
Validation loss decreased (inf --> -0.429961).  Saving model ...
Epoch: 2 cost time: 5.712147951126099
Epoch: 2, Steps: 35 | Train Loss: 7.344 Vali Loss: 11.745 Vali Acc: 0.520 Test Loss: 11.745 Test Acc: 0.520
Validation loss decreased (-0.429961 --> -0.519883).  Saving model ...
Epoch: 3 cost time: 5.540446519851685
Epoch: 3, Steps: 35 | Train Loss: 6.067 Vali Loss: 9.570 Vali Acc: 0.520 Test Loss: 9.570 Test Acc: 0.520
Validation loss decreased (-0.519883 --> -0.519904).  Saving model ...
Epoch: 4 cost time: 5.696123838424683
Epoch: 4, Steps: 35 | Train Loss: 10.597 Vali Loss: 25.451 Vali Acc: 0.510 Test Loss: 25.451 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.586859226226807
Epoch: 5, Steps: 35 | Train Loss: 9.648 Vali Loss: 6.211 Vali Acc: 0.490 Test Loss: 6.211 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.830940008163452
Epoch: 6, Steps: 35 | Train Loss: 8.037 Vali Loss: 10.332 Vali Acc: 0.500 Test Loss: 10.332 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.696975469589233
Epoch: 7, Steps: 35 | Train Loss: 6.076 Vali Loss: 12.689 Vali Acc: 0.490 Test Loss: 12.689 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.757920026779175
Epoch: 8, Steps: 35 | Train Loss: 8.993 Vali Loss: 23.904 Vali Acc: 0.520 Test Loss: 23.904 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.914573669433594
Epoch: 9, Steps: 35 | Train Loss: 3.413 Vali Loss: 10.462 Vali Acc: 0.500 Test Loss: 10.462 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.921613693237305
Epoch: 10, Steps: 35 | Train Loss: 4.336 Vali Loss: 9.943 Vali Acc: 0.540 Test Loss: 9.943 Test Acc: 0.540
Validation loss decreased (-0.519904 --> -0.539901).  Saving model ...
Epoch: 11 cost time: 5.793837547302246
Epoch: 11, Steps: 35 | Train Loss: 4.810 Vali Loss: 17.455 Vali Acc: 0.450 Test Loss: 17.455 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.9999165534973145
Epoch: 12, Steps: 35 | Train Loss: 4.121 Vali Loss: 39.093 Vali Acc: 0.500 Test Loss: 39.093 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.071600675582886
Epoch: 13, Steps: 35 | Train Loss: 5.989 Vali Loss: 20.873 Vali Acc: 0.510 Test Loss: 20.873 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.121916055679321
Epoch: 14, Steps: 35 | Train Loss: 4.305 Vali Loss: 25.956 Vali Acc: 0.470 Test Loss: 25.956 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.87050199508667
Epoch: 15, Steps: 35 | Train Loss: 3.868 Vali Loss: 12.527 Vali Acc: 0.540 Test Loss: 12.527 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.9584033489227295
Epoch: 16, Steps: 35 | Train Loss: 5.089 Vali Loss: 16.665 Vali Acc: 0.500 Test Loss: 16.665 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.991121292114258
Epoch: 17, Steps: 35 | Train Loss: 6.683 Vali Loss: 51.214 Vali Acc: 0.510 Test Loss: 51.214 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.569282054901123
Epoch: 18, Steps: 35 | Train Loss: 6.341 Vali Loss: 19.821 Vali Acc: 0.500 Test Loss: 19.821 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.67450737953186
Epoch: 19, Steps: 35 | Train Loss: 3.033 Vali Loss: 38.705 Vali Acc: 0.490 Test Loss: 38.705 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.1204674243927
Epoch: 20, Steps: 35 | Train Loss: 4.906 Vali Loss: 21.815 Vali Acc: 0.530 Test Loss: 21.815 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1984034
model size : 12.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.566167593002319
Epoch: 1, Steps: 35 | Train Loss: 2.028 Vali Loss: 4.918 Vali Acc: 0.490 Test Loss: 4.918 Test Acc: 0.490
Validation loss decreased (inf --> -0.489951).  Saving model ...
Epoch: 2 cost time: 5.8152501583099365
Epoch: 2, Steps: 35 | Train Loss: 3.779 Vali Loss: 4.924 Vali Acc: 0.530 Test Loss: 4.924 Test Acc: 0.530
Validation loss decreased (-0.489951 --> -0.529951).  Saving model ...
Epoch: 3 cost time: 5.807799577713013
Epoch: 3, Steps: 35 | Train Loss: 7.069 Vali Loss: 10.820 Vali Acc: 0.500 Test Loss: 10.820 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.667591571807861
Epoch: 4, Steps: 35 | Train Loss: 4.325 Vali Loss: 3.838 Vali Acc: 0.490 Test Loss: 3.838 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.717460632324219
Epoch: 5, Steps: 35 | Train Loss: 3.911 Vali Loss: 6.856 Vali Acc: 0.490 Test Loss: 6.856 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.8591468334198
Epoch: 6, Steps: 35 | Train Loss: 4.033 Vali Loss: 5.135 Vali Acc: 0.540 Test Loss: 5.135 Test Acc: 0.540
Validation loss decreased (-0.529951 --> -0.539949).  Saving model ...
Epoch: 7 cost time: 5.995243787765503
Epoch: 7, Steps: 35 | Train Loss: 3.262 Vali Loss: 10.471 Vali Acc: 0.510 Test Loss: 10.471 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.228526592254639
Epoch: 8, Steps: 35 | Train Loss: 2.380 Vali Loss: 11.382 Vali Acc: 0.470 Test Loss: 11.382 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8779191970825195
Epoch: 9, Steps: 35 | Train Loss: 3.137 Vali Loss: 13.724 Vali Acc: 0.500 Test Loss: 13.724 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.96201753616333
Epoch: 10, Steps: 35 | Train Loss: 5.023 Vali Loss: 24.359 Vali Acc: 0.480 Test Loss: 24.359 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.2454047203063965
Epoch: 11, Steps: 35 | Train Loss: 3.216 Vali Loss: 12.570 Vali Acc: 0.480 Test Loss: 12.570 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.359578371047974
Epoch: 12, Steps: 35 | Train Loss: 0.886 Vali Loss: 12.638 Vali Acc: 0.520 Test Loss: 12.638 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.271309852600098
Epoch: 13, Steps: 35 | Train Loss: 1.744 Vali Loss: 13.100 Vali Acc: 0.470 Test Loss: 13.100 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.181983709335327
Epoch: 14, Steps: 35 | Train Loss: 1.650 Vali Loss: 14.283 Vali Acc: 0.540 Test Loss: 14.283 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.069657564163208
Epoch: 15, Steps: 35 | Train Loss: 1.523 Vali Loss: 28.064 Vali Acc: 0.500 Test Loss: 28.064 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.050450801849365
Epoch: 16, Steps: 35 | Train Loss: 1.688 Vali Loss: 16.264 Vali Acc: 0.450 Test Loss: 16.264 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1942562
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.356601715087891
Epoch: 1, Steps: 35 | Train Loss: 1.972 Vali Loss: 4.874 Vali Acc: 0.490 Test Loss: 4.874 Test Acc: 0.490
Validation loss decreased (inf --> -0.489951).  Saving model ...
Epoch: 2 cost time: 5.697497844696045
Epoch: 2, Steps: 35 | Train Loss: 3.516 Vali Loss: 5.609 Vali Acc: 0.590 Test Loss: 5.609 Test Acc: 0.590
Validation loss decreased (-0.489951 --> -0.589944).  Saving model ...
Epoch: 3 cost time: 5.7448203563690186
Epoch: 3, Steps: 35 | Train Loss: 3.261 Vali Loss: 5.640 Vali Acc: 0.490 Test Loss: 5.640 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.077869176864624
Epoch: 4, Steps: 35 | Train Loss: 2.828 Vali Loss: 6.707 Vali Acc: 0.540 Test Loss: 6.707 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.574130296707153
Epoch: 5, Steps: 35 | Train Loss: 3.280 Vali Loss: 7.430 Vali Acc: 0.520 Test Loss: 7.430 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.819340467453003
Epoch: 6, Steps: 35 | Train Loss: 4.204 Vali Loss: 7.552 Vali Acc: 0.510 Test Loss: 7.552 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.51836895942688
Epoch: 7, Steps: 35 | Train Loss: 1.743 Vali Loss: 8.997 Vali Acc: 0.520 Test Loss: 8.997 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.7217676639556885
Epoch: 8, Steps: 35 | Train Loss: 3.896 Vali Loss: 11.206 Vali Acc: 0.470 Test Loss: 11.206 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.492350101470947
Epoch: 9, Steps: 35 | Train Loss: 3.182 Vali Loss: 15.227 Vali Acc: 0.510 Test Loss: 15.227 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.7143025398254395
Epoch: 10, Steps: 35 | Train Loss: 3.449 Vali Loss: 11.566 Vali Acc: 0.560 Test Loss: 11.566 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.69460391998291
Epoch: 11, Steps: 35 | Train Loss: 1.692 Vali Loss: 11.920 Vali Acc: 0.510 Test Loss: 11.920 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.461049795150757
Epoch: 12, Steps: 35 | Train Loss: 2.032 Vali Loss: 15.811 Vali Acc: 0.500 Test Loss: 15.811 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1942562
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.856411933898926
Epoch: 1, Steps: 35 | Train Loss: 1.699 Vali Loss: 2.255 Vali Acc: 0.600 Test Loss: 2.255 Test Acc: 0.600
Validation loss decreased (inf --> -0.599977).  Saving model ...
Epoch: 2 cost time: 5.10834813117981
Epoch: 2, Steps: 35 | Train Loss: 2.888 Vali Loss: 4.179 Vali Acc: 0.550 Test Loss: 4.179 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.233348846435547
Epoch: 3, Steps: 35 | Train Loss: 3.446 Vali Loss: 6.673 Vali Acc: 0.520 Test Loss: 6.673 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.243375062942505
Epoch: 4, Steps: 35 | Train Loss: 3.530 Vali Loss: 4.883 Vali Acc: 0.590 Test Loss: 4.883 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.507938623428345
Epoch: 5, Steps: 35 | Train Loss: 5.269 Vali Loss: 4.059 Vali Acc: 0.520 Test Loss: 4.059 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.4094226360321045
Epoch: 6, Steps: 35 | Train Loss: 5.023 Vali Loss: 9.402 Vali Acc: 0.500 Test Loss: 9.402 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.244336843490601
Epoch: 7, Steps: 35 | Train Loss: 3.954 Vali Loss: 7.763 Vali Acc: 0.500 Test Loss: 7.763 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.437776565551758
Epoch: 8, Steps: 35 | Train Loss: 3.179 Vali Loss: 13.865 Vali Acc: 0.450 Test Loss: 13.865 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.2448341846466064
Epoch: 9, Steps: 35 | Train Loss: 3.504 Vali Loss: 10.811 Vali Acc: 0.490 Test Loss: 10.811 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.330897331237793
Epoch: 10, Steps: 35 | Train Loss: 3.996 Vali Loss: 13.224 Vali Acc: 0.490 Test Loss: 13.224 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.605754375457764
Epoch: 11, Steps: 35 | Train Loss: 2.414 Vali Loss: 12.651 Vali Acc: 0.490 Test Loss: 12.651 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1942562
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.589115858078003
Epoch: 1, Steps: 35 | Train Loss: 1.381 Vali Loss: 2.304 Vali Acc: 0.520 Test Loss: 2.304 Test Acc: 0.520
Validation loss decreased (inf --> -0.519977).  Saving model ...
Epoch: 2 cost time: 4.787688493728638
Epoch: 2, Steps: 35 | Train Loss: 3.074 Vali Loss: 7.314 Vali Acc: 0.590 Test Loss: 7.314 Test Acc: 0.590
Validation loss decreased (-0.519977 --> -0.589927).  Saving model ...
Epoch: 3 cost time: 4.801363945007324
Epoch: 3, Steps: 35 | Train Loss: 4.238 Vali Loss: 3.809 Vali Acc: 0.480 Test Loss: 3.809 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7346696853637695
Epoch: 4, Steps: 35 | Train Loss: 3.395 Vali Loss: 6.061 Vali Acc: 0.600 Test Loss: 6.061 Test Acc: 0.600
Validation loss decreased (-0.589927 --> -0.599939).  Saving model ...
Epoch: 5 cost time: 5.261771202087402
Epoch: 5, Steps: 35 | Train Loss: 3.788 Vali Loss: 9.031 Vali Acc: 0.510 Test Loss: 9.031 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.241372108459473
Epoch: 6, Steps: 35 | Train Loss: 3.209 Vali Loss: 7.184 Vali Acc: 0.490 Test Loss: 7.184 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.168824911117554
Epoch: 7, Steps: 35 | Train Loss: 5.219 Vali Loss: 16.418 Vali Acc: 0.500 Test Loss: 16.418 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.108550548553467
Epoch: 8, Steps: 35 | Train Loss: 4.046 Vali Loss: 8.976 Vali Acc: 0.450 Test Loss: 8.976 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.12370753288269
Epoch: 9, Steps: 35 | Train Loss: 3.124 Vali Loss: 8.796 Vali Acc: 0.470 Test Loss: 8.796 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.2587573528289795
Epoch: 10, Steps: 35 | Train Loss: 1.881 Vali Loss: 8.206 Vali Acc: 0.470 Test Loss: 8.206 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.955029249191284
Epoch: 11, Steps: 35 | Train Loss: 3.585 Vali Loss: 11.869 Vali Acc: 0.470 Test Loss: 11.869 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.186490058898926
Epoch: 12, Steps: 35 | Train Loss: 7.650 Vali Loss: 11.173 Vali Acc: 0.550 Test Loss: 11.173 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.169273853302002
Epoch: 13, Steps: 35 | Train Loss: 4.635 Vali Loss: 15.054 Vali Acc: 0.500 Test Loss: 15.054 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.104827880859375
Epoch: 14, Steps: 35 | Train Loss: 4.821 Vali Loss: 11.395 Vali Acc: 0.520 Test Loss: 11.395 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1942562
model size : 9.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.709492206573486
Epoch: 1, Steps: 35 | Train Loss: 2.409 Vali Loss: 2.517 Vali Acc: 0.510 Test Loss: 2.517 Test Acc: 0.510
Validation loss decreased (inf --> -0.509975).  Saving model ...
Epoch: 2 cost time: 5.362974405288696
Epoch: 2, Steps: 35 | Train Loss: 3.268 Vali Loss: 5.088 Vali Acc: 0.520 Test Loss: 5.088 Test Acc: 0.520
Validation loss decreased (-0.509975 --> -0.519949).  Saving model ...
Epoch: 3 cost time: 5.288133144378662
Epoch: 3, Steps: 35 | Train Loss: 3.689 Vali Loss: 3.024 Vali Acc: 0.470 Test Loss: 3.024 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.3838865756988525
Epoch: 4, Steps: 35 | Train Loss: 3.509 Vali Loss: 8.555 Vali Acc: 0.500 Test Loss: 8.555 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.698253393173218
Epoch: 5, Steps: 35 | Train Loss: 5.485 Vali Loss: 15.442 Vali Acc: 0.470 Test Loss: 15.442 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.839852333068848
Epoch: 6, Steps: 35 | Train Loss: 6.512 Vali Loss: 7.556 Vali Acc: 0.480 Test Loss: 7.556 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.48773193359375
Epoch: 7, Steps: 35 | Train Loss: 4.312 Vali Loss: 8.036 Vali Acc: 0.480 Test Loss: 8.036 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.607198238372803
Epoch: 8, Steps: 35 | Train Loss: 2.287 Vali Loss: 21.149 Vali Acc: 0.500 Test Loss: 21.149 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.597731113433838
Epoch: 9, Steps: 35 | Train Loss: 3.113 Vali Loss: 6.045 Vali Acc: 0.510 Test Loss: 6.045 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.560851335525513
Epoch: 10, Steps: 35 | Train Loss: 2.016 Vali Loss: 6.340 Vali Acc: 0.520 Test Loss: 6.340 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.5310187339782715
Epoch: 11, Steps: 35 | Train Loss: 3.539 Vali Loss: 22.077 Vali Acc: 0.470 Test Loss: 22.077 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.5480194091796875
Epoch: 12, Steps: 35 | Train Loss: 3.616 Vali Loss: 14.028 Vali Acc: 0.480 Test Loss: 14.028 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 1418274
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.21548318862915
Epoch: 1, Steps: 35 | Train Loss: 2.008 Vali Loss: 1.034 Vali Acc: 0.640 Test Loss: 1.034 Test Acc: 0.640
Validation loss decreased (inf --> -0.639990).  Saving model ...
Epoch: 2 cost time: 5.338542461395264
Epoch: 2, Steps: 35 | Train Loss: 2.862 Vali Loss: 3.431 Vali Acc: 0.500 Test Loss: 3.431 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.3152642250061035
Epoch: 3, Steps: 35 | Train Loss: 3.235 Vali Loss: 3.903 Vali Acc: 0.500 Test Loss: 3.903 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.372380256652832
Epoch: 4, Steps: 35 | Train Loss: 3.909 Vali Loss: 4.252 Vali Acc: 0.550 Test Loss: 4.252 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.484867572784424
Epoch: 5, Steps: 35 | Train Loss: 3.575 Vali Loss: 12.654 Vali Acc: 0.520 Test Loss: 12.654 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.184196472167969
Epoch: 6, Steps: 35 | Train Loss: 6.450 Vali Loss: 12.798 Vali Acc: 0.520 Test Loss: 12.798 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.331083297729492
Epoch: 7, Steps: 35 | Train Loss: 2.801 Vali Loss: 14.821 Vali Acc: 0.480 Test Loss: 14.821 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.205484390258789
Epoch: 8, Steps: 35 | Train Loss: 5.077 Vali Loss: 24.177 Vali Acc: 0.500 Test Loss: 24.177 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.462075233459473
Epoch: 9, Steps: 35 | Train Loss: 3.634 Vali Loss: 12.299 Vali Acc: 0.490 Test Loss: 12.299 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.543312072753906
Epoch: 10, Steps: 35 | Train Loss: 3.176 Vali Loss: 7.894 Vali Acc: 0.550 Test Loss: 7.894 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.143364667892456
Epoch: 11, Steps: 35 | Train Loss: 1.092 Vali Loss: 16.542 Vali Acc: 0.490 Test Loss: 16.542 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 1418274
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.454967498779297
Epoch: 1, Steps: 35 | Train Loss: 1.885 Vali Loss: 2.538 Vali Acc: 0.470 Test Loss: 2.538 Test Acc: 0.470
Validation loss decreased (inf --> -0.469975).  Saving model ...
Epoch: 2 cost time: 4.767318964004517
Epoch: 2, Steps: 35 | Train Loss: 3.824 Vali Loss: 2.429 Vali Acc: 0.530 Test Loss: 2.429 Test Acc: 0.530
Validation loss decreased (-0.469975 --> -0.529976).  Saving model ...
Epoch: 3 cost time: 4.806739330291748
Epoch: 3, Steps: 35 | Train Loss: 2.859 Vali Loss: 5.997 Vali Acc: 0.490 Test Loss: 5.997 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.76531982421875
Epoch: 4, Steps: 35 | Train Loss: 4.585 Vali Loss: 8.769 Vali Acc: 0.520 Test Loss: 8.769 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.700340986251831
Epoch: 5, Steps: 35 | Train Loss: 6.588 Vali Loss: 19.267 Vali Acc: 0.470 Test Loss: 19.267 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.788797378540039
Epoch: 6, Steps: 35 | Train Loss: 3.120 Vali Loss: 14.727 Vali Acc: 0.500 Test Loss: 14.727 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.925584316253662
Epoch: 7, Steps: 35 | Train Loss: 2.929 Vali Loss: 4.675 Vali Acc: 0.450 Test Loss: 4.675 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.974576711654663
Epoch: 8, Steps: 35 | Train Loss: 2.507 Vali Loss: 14.354 Vali Acc: 0.460 Test Loss: 14.354 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.040469408035278
Epoch: 9, Steps: 35 | Train Loss: 1.259 Vali Loss: 5.471 Vali Acc: 0.500 Test Loss: 5.471 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.92180871963501
Epoch: 10, Steps: 35 | Train Loss: 1.751 Vali Loss: 30.844 Vali Acc: 0.490 Test Loss: 30.844 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.94411301612854
Epoch: 11, Steps: 35 | Train Loss: 8.580 Vali Loss: 10.696 Vali Acc: 0.550 Test Loss: 10.696 Test Acc: 0.550
Validation loss decreased (-0.529976 --> -0.549893).  Saving model ...
Epoch: 12 cost time: 4.946812391281128
Epoch: 12, Steps: 35 | Train Loss: 4.000 Vali Loss: 12.835 Vali Acc: 0.480 Test Loss: 12.835 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.132917404174805
Epoch: 13, Steps: 35 | Train Loss: 2.928 Vali Loss: 14.166 Vali Acc: 0.510 Test Loss: 14.166 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.783667087554932
Epoch: 14, Steps: 35 | Train Loss: 5.080 Vali Loss: 21.384 Vali Acc: 0.420 Test Loss: 21.384 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.116295337677002
Epoch: 15, Steps: 35 | Train Loss: 2.744 Vali Loss: 23.664 Vali Acc: 0.450 Test Loss: 23.664 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.939964056015015
Epoch: 16, Steps: 35 | Train Loss: 2.809 Vali Loss: 31.339 Vali Acc: 0.520 Test Loss: 31.339 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.925097703933716
Epoch: 17, Steps: 35 | Train Loss: 2.773 Vali Loss: 22.647 Vali Acc: 0.510 Test Loss: 22.647 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.801956415176392
Epoch: 18, Steps: 35 | Train Loss: 5.088 Vali Loss: 22.708 Vali Acc: 0.530 Test Loss: 22.708 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.99289083480835
Epoch: 19, Steps: 35 | Train Loss: 3.143 Vali Loss: 15.910 Vali Acc: 0.530 Test Loss: 15.910 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.184255123138428
Epoch: 20, Steps: 35 | Train Loss: 2.815 Vali Loss: 16.382 Vali Acc: 0.520 Test Loss: 16.382 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.046924114227295
Epoch: 21, Steps: 35 | Train Loss: 2.913 Vali Loss: 31.289 Vali Acc: 0.470 Test Loss: 31.289 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1418274
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.577972412109375
Epoch: 1, Steps: 35 | Train Loss: 1.715 Vali Loss: 2.690 Vali Acc: 0.440 Test Loss: 2.690 Test Acc: 0.440
Validation loss decreased (inf --> -0.439973).  Saving model ...
Epoch: 2 cost time: 4.479032516479492
Epoch: 2, Steps: 35 | Train Loss: 2.899 Vali Loss: 3.026 Vali Acc: 0.550 Test Loss: 3.026 Test Acc: 0.550
Validation loss decreased (-0.439973 --> -0.549970).  Saving model ...
Epoch: 3 cost time: 4.517002105712891
Epoch: 3, Steps: 35 | Train Loss: 3.328 Vali Loss: 5.176 Vali Acc: 0.470 Test Loss: 5.176 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.510950326919556
Epoch: 4, Steps: 35 | Train Loss: 2.533 Vali Loss: 6.403 Vali Acc: 0.520 Test Loss: 6.403 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.437096834182739
Epoch: 5, Steps: 35 | Train Loss: 5.011 Vali Loss: 18.820 Vali Acc: 0.470 Test Loss: 18.820 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.2478179931640625
Epoch: 6, Steps: 35 | Train Loss: 7.225 Vali Loss: 6.990 Vali Acc: 0.490 Test Loss: 6.990 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.524110555648804
Epoch: 7, Steps: 35 | Train Loss: 2.102 Vali Loss: 8.287 Vali Acc: 0.410 Test Loss: 8.287 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.4449920654296875
Epoch: 8, Steps: 35 | Train Loss: 3.637 Vali Loss: 15.202 Vali Acc: 0.500 Test Loss: 15.202 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.2405664920806885
Epoch: 9, Steps: 35 | Train Loss: 4.918 Vali Loss: 8.905 Vali Acc: 0.400 Test Loss: 8.905 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.649993181228638
Epoch: 10, Steps: 35 | Train Loss: 3.670 Vali Loss: 5.306 Vali Acc: 0.500 Test Loss: 5.306 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.727484941482544
Epoch: 11, Steps: 35 | Train Loss: 1.942 Vali Loss: 8.499 Vali Acc: 0.520 Test Loss: 8.499 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.952984809875488
Epoch: 12, Steps: 35 | Train Loss: 1.922 Vali Loss: 9.786 Vali Acc: 0.480 Test Loss: 9.786 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1418274
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.869340419769287
Epoch: 1, Steps: 35 | Train Loss: 2.245 Vali Loss: 2.763 Vali Acc: 0.400 Test Loss: 2.763 Test Acc: 0.400
Validation loss decreased (inf --> -0.399972).  Saving model ...
Epoch: 2 cost time: 5.142238140106201
Epoch: 2, Steps: 35 | Train Loss: 3.156 Vali Loss: 3.885 Vali Acc: 0.500 Test Loss: 3.885 Test Acc: 0.500
Validation loss decreased (-0.399972 --> -0.499961).  Saving model ...
Epoch: 3 cost time: 5.303174018859863
Epoch: 3, Steps: 35 | Train Loss: 3.549 Vali Loss: 9.937 Vali Acc: 0.540 Test Loss: 9.937 Test Acc: 0.540
Validation loss decreased (-0.499961 --> -0.539901).  Saving model ...
Epoch: 4 cost time: 5.216955900192261
Epoch: 4, Steps: 35 | Train Loss: 3.246 Vali Loss: 9.219 Vali Acc: 0.470 Test Loss: 9.219 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.309481382369995
Epoch: 5, Steps: 35 | Train Loss: 3.745 Vali Loss: 14.106 Vali Acc: 0.490 Test Loss: 14.106 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.326345682144165
Epoch: 6, Steps: 35 | Train Loss: 2.776 Vali Loss: 11.139 Vali Acc: 0.540 Test Loss: 11.139 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.006727933883667
Epoch: 7, Steps: 35 | Train Loss: 1.601 Vali Loss: 8.248 Vali Acc: 0.550 Test Loss: 8.248 Test Acc: 0.550
Validation loss decreased (-0.539901 --> -0.549918).  Saving model ...
Epoch: 8 cost time: 5.148417711257935
Epoch: 8, Steps: 35 | Train Loss: 2.797 Vali Loss: 6.908 Vali Acc: 0.530 Test Loss: 6.908 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.153715372085571
Epoch: 9, Steps: 35 | Train Loss: 3.510 Vali Loss: 7.898 Vali Acc: 0.590 Test Loss: 7.898 Test Acc: 0.590
Validation loss decreased (-0.549918 --> -0.589921).  Saving model ...
Epoch: 10 cost time: 5.181806325912476
Epoch: 10, Steps: 35 | Train Loss: 2.758 Vali Loss: 9.106 Vali Acc: 0.430 Test Loss: 9.106 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.282109975814819
Epoch: 11, Steps: 35 | Train Loss: 3.569 Vali Loss: 14.127 Vali Acc: 0.560 Test Loss: 14.127 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.34404182434082
Epoch: 12, Steps: 35 | Train Loss: 2.730 Vali Loss: 9.327 Vali Acc: 0.440 Test Loss: 9.327 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.328138828277588
Epoch: 13, Steps: 35 | Train Loss: 3.258 Vali Loss: 19.198 Vali Acc: 0.480 Test Loss: 19.198 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.5592262744903564
Epoch: 14, Steps: 35 | Train Loss: 2.742 Vali Loss: 14.087 Vali Acc: 0.510 Test Loss: 14.087 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.021839618682861
Epoch: 15, Steps: 35 | Train Loss: 0.698 Vali Loss: 14.998 Vali Acc: 0.410 Test Loss: 14.998 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.072191476821899
Epoch: 16, Steps: 35 | Train Loss: 0.800 Vali Loss: 10.306 Vali Acc: 0.500 Test Loss: 10.306 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.21641206741333
Epoch: 17, Steps: 35 | Train Loss: 1.331 Vali Loss: 34.856 Vali Acc: 0.520 Test Loss: 34.856 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.293107032775879
Epoch: 18, Steps: 35 | Train Loss: 2.409 Vali Loss: 12.745 Vali Acc: 0.410 Test Loss: 12.745 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.406630039215088
Epoch: 19, Steps: 35 | Train Loss: 1.176 Vali Loss: 11.813 Vali Acc: 0.500 Test Loss: 11.813 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1156130
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.12931227684021
Epoch: 1, Steps: 35 | Train Loss: 2.145 Vali Loss: 3.338 Vali Acc: 0.390 Test Loss: 3.338 Test Acc: 0.390
Validation loss decreased (inf --> -0.389967).  Saving model ...
Epoch: 2 cost time: 4.88616681098938
Epoch: 2, Steps: 35 | Train Loss: 2.508 Vali Loss: 7.306 Vali Acc: 0.480 Test Loss: 7.306 Test Acc: 0.480
Validation loss decreased (-0.389967 --> -0.479927).  Saving model ...
Epoch: 3 cost time: 4.969001770019531
Epoch: 3, Steps: 35 | Train Loss: 3.474 Vali Loss: 10.482 Vali Acc: 0.510 Test Loss: 10.482 Test Acc: 0.510
Validation loss decreased (-0.479927 --> -0.509895).  Saving model ...
Epoch: 4 cost time: 4.929834842681885
Epoch: 4, Steps: 35 | Train Loss: 2.519 Vali Loss: 6.310 Vali Acc: 0.440 Test Loss: 6.310 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.069974660873413
Epoch: 5, Steps: 35 | Train Loss: 3.305 Vali Loss: 8.969 Vali Acc: 0.450 Test Loss: 8.969 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.93251371383667
Epoch: 6, Steps: 35 | Train Loss: 4.233 Vali Loss: 6.902 Vali Acc: 0.590 Test Loss: 6.902 Test Acc: 0.590
Validation loss decreased (-0.509895 --> -0.589931).  Saving model ...
Epoch: 7 cost time: 5.148448705673218
Epoch: 7, Steps: 35 | Train Loss: 4.782 Vali Loss: 6.702 Vali Acc: 0.520 Test Loss: 6.702 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.24587607383728
Epoch: 8, Steps: 35 | Train Loss: 2.575 Vali Loss: 15.059 Vali Acc: 0.500 Test Loss: 15.059 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.925457000732422
Epoch: 9, Steps: 35 | Train Loss: 1.995 Vali Loss: 8.901 Vali Acc: 0.580 Test Loss: 8.901 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.90737771987915
Epoch: 10, Steps: 35 | Train Loss: 2.642 Vali Loss: 12.021 Vali Acc: 0.490 Test Loss: 12.021 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.93491268157959
Epoch: 11, Steps: 35 | Train Loss: 7.646 Vali Loss: 13.014 Vali Acc: 0.460 Test Loss: 13.014 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.178412437438965
Epoch: 12, Steps: 35 | Train Loss: 6.345 Vali Loss: 23.044 Vali Acc: 0.490 Test Loss: 23.044 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.05463171005249
Epoch: 13, Steps: 35 | Train Loss: 2.376 Vali Loss: 16.567 Vali Acc: 0.470 Test Loss: 16.567 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.155805349349976
Epoch: 14, Steps: 35 | Train Loss: 2.343 Vali Loss: 38.710 Vali Acc: 0.480 Test Loss: 38.710 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.1873252391815186
Epoch: 15, Steps: 35 | Train Loss: 4.285 Vali Loss: 9.700 Vali Acc: 0.560 Test Loss: 9.700 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.432923793792725
Epoch: 16, Steps: 35 | Train Loss: 2.310 Vali Loss: 25.369 Vali Acc: 0.540 Test Loss: 25.369 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1156130
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.317260503768921
Epoch: 1, Steps: 35 | Train Loss: 1.974 Vali Loss: 3.512 Vali Acc: 0.450 Test Loss: 3.512 Test Acc: 0.450
Validation loss decreased (inf --> -0.449965).  Saving model ...
Epoch: 2 cost time: 4.598974227905273
Epoch: 2, Steps: 35 | Train Loss: 4.015 Vali Loss: 10.754 Vali Acc: 0.460 Test Loss: 10.754 Test Acc: 0.460
Validation loss decreased (-0.449965 --> -0.459892).  Saving model ...
Epoch: 3 cost time: 4.750013589859009
Epoch: 3, Steps: 35 | Train Loss: 4.760 Vali Loss: 14.786 Vali Acc: 0.510 Test Loss: 14.786 Test Acc: 0.510
Validation loss decreased (-0.459892 --> -0.509852).  Saving model ...
Epoch: 4 cost time: 4.738299131393433
Epoch: 4, Steps: 35 | Train Loss: 5.104 Vali Loss: 5.650 Vali Acc: 0.500 Test Loss: 5.650 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.636038780212402
Epoch: 5, Steps: 35 | Train Loss: 3.701 Vali Loss: 9.365 Vali Acc: 0.480 Test Loss: 9.365 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.405364990234375
Epoch: 6, Steps: 35 | Train Loss: 1.997 Vali Loss: 5.484 Vali Acc: 0.530 Test Loss: 5.484 Test Acc: 0.530
Validation loss decreased (-0.509852 --> -0.529945).  Saving model ...
Epoch: 7 cost time: 4.508753299713135
Epoch: 7, Steps: 35 | Train Loss: 2.099 Vali Loss: 8.238 Vali Acc: 0.470 Test Loss: 8.238 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.404928684234619
Epoch: 8, Steps: 35 | Train Loss: 3.189 Vali Loss: 10.601 Vali Acc: 0.430 Test Loss: 10.601 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.463023900985718
Epoch: 9, Steps: 35 | Train Loss: 2.129 Vali Loss: 14.332 Vali Acc: 0.480 Test Loss: 14.332 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.5160791873931885
Epoch: 10, Steps: 35 | Train Loss: 3.722 Vali Loss: 18.055 Vali Acc: 0.520 Test Loss: 18.055 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.735767841339111
Epoch: 11, Steps: 35 | Train Loss: 2.948 Vali Loss: 16.723 Vali Acc: 0.440 Test Loss: 16.723 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.756162405014038
Epoch: 12, Steps: 35 | Train Loss: 1.919 Vali Loss: 20.594 Vali Acc: 0.510 Test Loss: 20.594 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.790640115737915
Epoch: 13, Steps: 35 | Train Loss: 2.425 Vali Loss: 13.994 Vali Acc: 0.490 Test Loss: 13.994 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.471729278564453
Epoch: 14, Steps: 35 | Train Loss: 1.890 Vali Loss: 31.626 Vali Acc: 0.510 Test Loss: 31.626 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.7167205810546875
Epoch: 15, Steps: 35 | Train Loss: 2.986 Vali Loss: 20.680 Vali Acc: 0.490 Test Loss: 20.680 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.780189514160156
Epoch: 16, Steps: 35 | Train Loss: 1.518 Vali Loss: 13.000 Vali Acc: 0.500 Test Loss: 13.000 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1156130
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.387613534927368
Epoch: 1, Steps: 35 | Train Loss: 1.653 Vali Loss: 3.627 Vali Acc: 0.420 Test Loss: 3.627 Test Acc: 0.420
Validation loss decreased (inf --> -0.419964).  Saving model ...
Epoch: 2 cost time: 4.229729175567627
Epoch: 2, Steps: 35 | Train Loss: 2.574 Vali Loss: 3.126 Vali Acc: 0.540 Test Loss: 3.126 Test Acc: 0.540
Validation loss decreased (-0.419964 --> -0.539969).  Saving model ...
Epoch: 3 cost time: 4.262452840805054
Epoch: 3, Steps: 35 | Train Loss: 4.231 Vali Loss: 3.403 Vali Acc: 0.560 Test Loss: 3.403 Test Acc: 0.560
Validation loss decreased (-0.539969 --> -0.559966).  Saving model ...
Epoch: 4 cost time: 4.24419641494751
Epoch: 4, Steps: 35 | Train Loss: 3.852 Vali Loss: 3.930 Vali Acc: 0.470 Test Loss: 3.930 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.308401346206665
Epoch: 5, Steps: 35 | Train Loss: 2.808 Vali Loss: 3.348 Vali Acc: 0.510 Test Loss: 3.348 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.115194320678711
Epoch: 6, Steps: 35 | Train Loss: 2.863 Vali Loss: 5.577 Vali Acc: 0.510 Test Loss: 5.577 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.08182954788208
Epoch: 7, Steps: 35 | Train Loss: 3.254 Vali Loss: 4.030 Vali Acc: 0.610 Test Loss: 4.030 Test Acc: 0.610
Validation loss decreased (-0.559966 --> -0.609960).  Saving model ...
Epoch: 8 cost time: 3.926345109939575
Epoch: 8, Steps: 35 | Train Loss: 2.731 Vali Loss: 13.085 Vali Acc: 0.490 Test Loss: 13.085 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.081607818603516
Epoch: 9, Steps: 35 | Train Loss: 3.869 Vali Loss: 6.808 Vali Acc: 0.530 Test Loss: 6.808 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.23871922492981
Epoch: 10, Steps: 35 | Train Loss: 2.471 Vali Loss: 8.110 Vali Acc: 0.520 Test Loss: 8.110 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.408196449279785
Epoch: 11, Steps: 35 | Train Loss: 2.411 Vali Loss: 18.261 Vali Acc: 0.460 Test Loss: 18.261 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.164326190948486
Epoch: 12, Steps: 35 | Train Loss: 3.947 Vali Loss: 13.189 Vali Acc: 0.500 Test Loss: 13.189 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.067723035812378
Epoch: 13, Steps: 35 | Train Loss: 2.315 Vali Loss: 24.453 Vali Acc: 0.480 Test Loss: 24.453 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.053796768188477
Epoch: 14, Steps: 35 | Train Loss: 2.181 Vali Loss: 14.485 Vali Acc: 0.490 Test Loss: 14.485 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.164275169372559
Epoch: 15, Steps: 35 | Train Loss: 3.173 Vali Loss: 18.985 Vali Acc: 0.490 Test Loss: 18.985 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.1186606884002686
Epoch: 16, Steps: 35 | Train Loss: 5.287 Vali Loss: 11.436 Vali Acc: 0.540 Test Loss: 11.436 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.032890796661377
Epoch: 17, Steps: 35 | Train Loss: 3.940 Vali Loss: 19.381 Vali Acc: 0.480 Test Loss: 19.381 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1156130
model size : 6.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.232463359832764
Epoch: 1, Steps: 35 | Train Loss: 1.724 Vali Loss: 4.905 Vali Acc: 0.550 Test Loss: 4.905 Test Acc: 0.550
Validation loss decreased (inf --> -0.549951).  Saving model ...
Epoch: 2 cost time: 5.196244716644287
Epoch: 2, Steps: 35 | Train Loss: 3.746 Vali Loss: 6.091 Vali Acc: 0.410 Test Loss: 6.091 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.235072135925293
Epoch: 3, Steps: 35 | Train Loss: 3.985 Vali Loss: 5.676 Vali Acc: 0.510 Test Loss: 5.676 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.1132025718688965
Epoch: 4, Steps: 35 | Train Loss: 3.105 Vali Loss: 4.993 Vali Acc: 0.430 Test Loss: 4.993 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.886695146560669
Epoch: 5, Steps: 35 | Train Loss: 3.948 Vali Loss: 6.141 Vali Acc: 0.460 Test Loss: 6.141 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.192146062850952
Epoch: 6, Steps: 35 | Train Loss: 5.558 Vali Loss: 4.075 Vali Acc: 0.460 Test Loss: 4.075 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.996336221694946
Epoch: 7, Steps: 35 | Train Loss: 4.298 Vali Loss: 9.919 Vali Acc: 0.510 Test Loss: 9.919 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.3532328605651855
Epoch: 8, Steps: 35 | Train Loss: 4.492 Vali Loss: 13.362 Vali Acc: 0.440 Test Loss: 13.362 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.387603998184204
Epoch: 9, Steps: 35 | Train Loss: 2.561 Vali Loss: 6.840 Vali Acc: 0.540 Test Loss: 6.840 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.382786273956299
Epoch: 10, Steps: 35 | Train Loss: 2.484 Vali Loss: 8.098 Vali Acc: 0.510 Test Loss: 8.098 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.23646092414856
Epoch: 11, Steps: 35 | Train Loss: 1.991 Vali Loss: 10.348 Vali Acc: 0.520 Test Loss: 10.348 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1025058
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.268258094787598
Epoch: 1, Steps: 35 | Train Loss: 1.695 Vali Loss: 4.420 Vali Acc: 0.550 Test Loss: 4.420 Test Acc: 0.550
Validation loss decreased (inf --> -0.549956).  Saving model ...
Epoch: 2 cost time: 4.945858716964722
Epoch: 2, Steps: 35 | Train Loss: 3.577 Vali Loss: 6.801 Vali Acc: 0.450 Test Loss: 6.801 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.88719916343689
Epoch: 3, Steps: 35 | Train Loss: 4.150 Vali Loss: 5.048 Vali Acc: 0.490 Test Loss: 5.048 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.041815519332886
Epoch: 4, Steps: 35 | Train Loss: 6.293 Vali Loss: 8.227 Vali Acc: 0.570 Test Loss: 8.227 Test Acc: 0.570
Validation loss decreased (-0.549956 --> -0.569918).  Saving model ...
Epoch: 5 cost time: 4.909045219421387
Epoch: 5, Steps: 35 | Train Loss: 4.084 Vali Loss: 5.802 Vali Acc: 0.480 Test Loss: 5.802 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.0746824741363525
Epoch: 6, Steps: 35 | Train Loss: 3.884 Vali Loss: 3.775 Vali Acc: 0.490 Test Loss: 3.775 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.788379192352295
Epoch: 7, Steps: 35 | Train Loss: 2.546 Vali Loss: 6.936 Vali Acc: 0.550 Test Loss: 6.936 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.9229583740234375
Epoch: 8, Steps: 35 | Train Loss: 1.113 Vali Loss: 5.203 Vali Acc: 0.450 Test Loss: 5.203 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.735929727554321
Epoch: 9, Steps: 35 | Train Loss: 2.831 Vali Loss: 12.746 Vali Acc: 0.540 Test Loss: 12.746 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.0953428745269775
Epoch: 10, Steps: 35 | Train Loss: 2.592 Vali Loss: 12.898 Vali Acc: 0.510 Test Loss: 12.898 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.122885227203369
Epoch: 11, Steps: 35 | Train Loss: 2.829 Vali Loss: 14.839 Vali Acc: 0.480 Test Loss: 14.839 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.006582260131836
Epoch: 12, Steps: 35 | Train Loss: 1.422 Vali Loss: 12.392 Vali Acc: 0.510 Test Loss: 12.392 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.682605028152466
Epoch: 13, Steps: 35 | Train Loss: 3.422 Vali Loss: 9.562 Vali Acc: 0.550 Test Loss: 9.562 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.658401966094971
Epoch: 14, Steps: 35 | Train Loss: 0.877 Vali Loss: 9.187 Vali Acc: 0.530 Test Loss: 9.187 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1025058
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.8632707595825195
Epoch: 1, Steps: 35 | Train Loss: 1.525 Vali Loss: 4.390 Vali Acc: 0.550 Test Loss: 4.390 Test Acc: 0.550
Validation loss decreased (inf --> -0.549956).  Saving model ...
Epoch: 2 cost time: 4.453245162963867
Epoch: 2, Steps: 35 | Train Loss: 3.086 Vali Loss: 7.677 Vali Acc: 0.430 Test Loss: 7.677 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.515496730804443
Epoch: 3, Steps: 35 | Train Loss: 3.918 Vali Loss: 4.463 Vali Acc: 0.530 Test Loss: 4.463 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.522158145904541
Epoch: 4, Steps: 35 | Train Loss: 2.887 Vali Loss: 3.383 Vali Acc: 0.510 Test Loss: 3.383 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.502788305282593
Epoch: 5, Steps: 35 | Train Loss: 3.781 Vali Loss: 7.962 Vali Acc: 0.500 Test Loss: 7.962 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.5285749435424805
Epoch: 6, Steps: 35 | Train Loss: 3.926 Vali Loss: 7.574 Vali Acc: 0.500 Test Loss: 7.574 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.467881202697754
Epoch: 7, Steps: 35 | Train Loss: 3.417 Vali Loss: 10.260 Vali Acc: 0.460 Test Loss: 10.260 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.27100133895874
Epoch: 8, Steps: 35 | Train Loss: 2.142 Vali Loss: 11.035 Vali Acc: 0.480 Test Loss: 11.035 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.268648147583008
Epoch: 9, Steps: 35 | Train Loss: 4.590 Vali Loss: 8.220 Vali Acc: 0.500 Test Loss: 8.220 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.45210862159729
Epoch: 10, Steps: 35 | Train Loss: 2.393 Vali Loss: 7.930 Vali Acc: 0.510 Test Loss: 7.930 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.746774196624756
Epoch: 11, Steps: 35 | Train Loss: 3.722 Vali Loss: 10.066 Vali Acc: 0.480 Test Loss: 10.066 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1025058
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.954765319824219
Epoch: 1, Steps: 35 | Train Loss: 1.243 Vali Loss: 4.725 Vali Acc: 0.540 Test Loss: 4.725 Test Acc: 0.540
Validation loss decreased (inf --> -0.539953).  Saving model ...
Epoch: 2 cost time: 4.092538833618164
Epoch: 2, Steps: 35 | Train Loss: 2.577 Vali Loss: 8.036 Vali Acc: 0.410 Test Loss: 8.036 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.388128042221069
Epoch: 3, Steps: 35 | Train Loss: 4.353 Vali Loss: 8.159 Vali Acc: 0.510 Test Loss: 8.159 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.996504306793213
Epoch: 4, Steps: 35 | Train Loss: 5.423 Vali Loss: 9.165 Vali Acc: 0.550 Test Loss: 9.165 Test Acc: 0.550
Validation loss decreased (-0.539953 --> -0.549908).  Saving model ...
Epoch: 5 cost time: 3.9800376892089844
Epoch: 5, Steps: 35 | Train Loss: 3.674 Vali Loss: 8.209 Vali Acc: 0.500 Test Loss: 8.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.004713773727417
Epoch: 6, Steps: 35 | Train Loss: 4.268 Vali Loss: 5.822 Vali Acc: 0.500 Test Loss: 5.822 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.023000240325928
Epoch: 7, Steps: 35 | Train Loss: 4.072 Vali Loss: 7.645 Vali Acc: 0.480 Test Loss: 7.645 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.049821376800537
Epoch: 8, Steps: 35 | Train Loss: 2.200 Vali Loss: 15.713 Vali Acc: 0.490 Test Loss: 15.713 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.194077253341675
Epoch: 9, Steps: 35 | Train Loss: 3.204 Vali Loss: 7.359 Vali Acc: 0.470 Test Loss: 7.359 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.206592798233032
Epoch: 10, Steps: 35 | Train Loss: 2.225 Vali Loss: 9.633 Vali Acc: 0.520 Test Loss: 9.633 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.273243188858032
Epoch: 11, Steps: 35 | Train Loss: 2.949 Vali Loss: 13.129 Vali Acc: 0.500 Test Loss: 13.129 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.021031856536865
Epoch: 12, Steps: 35 | Train Loss: 2.885 Vali Loss: 8.807 Vali Acc: 0.420 Test Loss: 8.807 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.089529275894165
Epoch: 13, Steps: 35 | Train Loss: 3.190 Vali Loss: 10.566 Vali Acc: 0.400 Test Loss: 10.566 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.7860796451568604
Epoch: 14, Steps: 35 | Train Loss: 1.593 Vali Loss: 11.947 Vali Acc: 0.440 Test Loss: 11.947 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1025058
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.013826131820679
Epoch: 1, Steps: 35 | Train Loss: 2.566 Vali Loss: 3.135 Vali Acc: 0.450 Test Loss: 3.135 Test Acc: 0.450
Validation loss decreased (inf --> -0.449969).  Saving model ...
Epoch: 2 cost time: 5.178307294845581
Epoch: 2, Steps: 35 | Train Loss: 2.330 Vali Loss: 4.065 Vali Acc: 0.480 Test Loss: 4.065 Test Acc: 0.480
Validation loss decreased (-0.449969 --> -0.479959).  Saving model ...
Epoch: 3 cost time: 5.3720808029174805
Epoch: 3, Steps: 35 | Train Loss: 4.215 Vali Loss: 7.118 Vali Acc: 0.540 Test Loss: 7.118 Test Acc: 0.540
Validation loss decreased (-0.479959 --> -0.539929).  Saving model ...
Epoch: 4 cost time: 5.057244777679443
Epoch: 4, Steps: 35 | Train Loss: 4.246 Vali Loss: 4.217 Vali Acc: 0.580 Test Loss: 4.217 Test Acc: 0.580
Validation loss decreased (-0.539929 --> -0.579958).  Saving model ...
Epoch: 5 cost time: 5.021970748901367
Epoch: 5, Steps: 35 | Train Loss: 3.808 Vali Loss: 2.537 Vali Acc: 0.570 Test Loss: 2.537 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.0626068115234375
Epoch: 6, Steps: 35 | Train Loss: 3.857 Vali Loss: 7.735 Vali Acc: 0.460 Test Loss: 7.735 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.313570022583008
Epoch: 7, Steps: 35 | Train Loss: 4.673 Vali Loss: 6.114 Vali Acc: 0.510 Test Loss: 6.114 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.23796534538269
Epoch: 8, Steps: 35 | Train Loss: 4.094 Vali Loss: 13.217 Vali Acc: 0.510 Test Loss: 13.217 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.255926132202148
Epoch: 9, Steps: 35 | Train Loss: 3.808 Vali Loss: 9.489 Vali Acc: 0.490 Test Loss: 9.489 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.098181247711182
Epoch: 10, Steps: 35 | Train Loss: 2.599 Vali Loss: 9.237 Vali Acc: 0.440 Test Loss: 9.237 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.1358747482299805
Epoch: 11, Steps: 35 | Train Loss: 0.865 Vali Loss: 6.195 Vali Acc: 0.510 Test Loss: 6.195 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.928580045700073
Epoch: 12, Steps: 35 | Train Loss: 2.018 Vali Loss: 12.527 Vali Acc: 0.510 Test Loss: 12.527 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.962976932525635
Epoch: 13, Steps: 35 | Train Loss: 1.664 Vali Loss: 22.173 Vali Acc: 0.460 Test Loss: 22.173 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.104564666748047
Epoch: 14, Steps: 35 | Train Loss: 2.120 Vali Loss: 9.987 Vali Acc: 0.550 Test Loss: 9.987 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 959522
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.351689338684082
Epoch: 1, Steps: 35 | Train Loss: 2.535 Vali Loss: 2.577 Vali Acc: 0.480 Test Loss: 2.577 Test Acc: 0.480
Validation loss decreased (inf --> -0.479974).  Saving model ...
Epoch: 2 cost time: 4.537806510925293
Epoch: 2, Steps: 35 | Train Loss: 2.343 Vali Loss: 1.580 Vali Acc: 0.560 Test Loss: 1.580 Test Acc: 0.560
Validation loss decreased (-0.479974 --> -0.559984).  Saving model ...
Epoch: 3 cost time: 4.650412321090698
Epoch: 3, Steps: 35 | Train Loss: 3.550 Vali Loss: 5.676 Vali Acc: 0.510 Test Loss: 5.676 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.679936647415161
Epoch: 4, Steps: 35 | Train Loss: 2.718 Vali Loss: 7.309 Vali Acc: 0.600 Test Loss: 7.309 Test Acc: 0.600
Validation loss decreased (-0.559984 --> -0.599927).  Saving model ...
Epoch: 5 cost time: 4.6354968547821045
Epoch: 5, Steps: 35 | Train Loss: 2.830 Vali Loss: 2.805 Vali Acc: 0.570 Test Loss: 2.805 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.6031904220581055
Epoch: 6, Steps: 35 | Train Loss: 3.875 Vali Loss: 9.844 Vali Acc: 0.490 Test Loss: 9.844 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.777265787124634
Epoch: 7, Steps: 35 | Train Loss: 3.520 Vali Loss: 6.309 Vali Acc: 0.590 Test Loss: 6.309 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.942425489425659
Epoch: 8, Steps: 35 | Train Loss: 3.802 Vali Loss: 8.361 Vali Acc: 0.490 Test Loss: 8.361 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.811262130737305
Epoch: 9, Steps: 35 | Train Loss: 2.584 Vali Loss: 10.043 Vali Acc: 0.480 Test Loss: 10.043 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.896539688110352
Epoch: 10, Steps: 35 | Train Loss: 4.457 Vali Loss: 24.739 Vali Acc: 0.500 Test Loss: 24.739 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.053941965103149
Epoch: 11, Steps: 35 | Train Loss: 5.787 Vali Loss: 19.012 Vali Acc: 0.430 Test Loss: 19.012 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.856909990310669
Epoch: 12, Steps: 35 | Train Loss: 3.497 Vali Loss: 14.598 Vali Acc: 0.520 Test Loss: 14.598 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.760421991348267
Epoch: 13, Steps: 35 | Train Loss: 2.829 Vali Loss: 8.118 Vali Acc: 0.530 Test Loss: 8.118 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.8129026889801025
Epoch: 14, Steps: 35 | Train Loss: 1.605 Vali Loss: 8.970 Vali Acc: 0.560 Test Loss: 8.970 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 959522
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.33179497718811
Epoch: 1, Steps: 35 | Train Loss: 2.433 Vali Loss: 2.242 Vali Acc: 0.510 Test Loss: 2.242 Test Acc: 0.510
Validation loss decreased (inf --> -0.509978).  Saving model ...
Epoch: 2 cost time: 4.239380598068237
Epoch: 2, Steps: 35 | Train Loss: 1.929 Vali Loss: 3.134 Vali Acc: 0.630 Test Loss: 3.134 Test Acc: 0.630
Validation loss decreased (-0.509978 --> -0.629969).  Saving model ...
Epoch: 3 cost time: 4.3241658210754395
Epoch: 3, Steps: 35 | Train Loss: 4.781 Vali Loss: 10.095 Vali Acc: 0.530 Test Loss: 10.095 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.234533071517944
Epoch: 4, Steps: 35 | Train Loss: 4.201 Vali Loss: 5.943 Vali Acc: 0.490 Test Loss: 5.943 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.53676962852478
Epoch: 5, Steps: 35 | Train Loss: 3.250 Vali Loss: 5.721 Vali Acc: 0.590 Test Loss: 5.721 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.452808618545532
Epoch: 6, Steps: 35 | Train Loss: 2.808 Vali Loss: 4.203 Vali Acc: 0.570 Test Loss: 4.203 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.468281030654907
Epoch: 7, Steps: 35 | Train Loss: 3.599 Vali Loss: 8.354 Vali Acc: 0.470 Test Loss: 8.354 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.5648698806762695
Epoch: 8, Steps: 35 | Train Loss: 2.929 Vali Loss: 10.722 Vali Acc: 0.510 Test Loss: 10.722 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.96312141418457
Epoch: 9, Steps: 35 | Train Loss: 3.403 Vali Loss: 5.929 Vali Acc: 0.530 Test Loss: 5.929 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.684889554977417
Epoch: 10, Steps: 35 | Train Loss: 3.031 Vali Loss: 12.673 Vali Acc: 0.430 Test Loss: 12.673 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.942177772521973
Epoch: 11, Steps: 35 | Train Loss: 1.899 Vali Loss: 16.373 Vali Acc: 0.470 Test Loss: 16.373 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.655215501785278
Epoch: 12, Steps: 35 | Train Loss: 2.016 Vali Loss: 9.716 Vali Acc: 0.460 Test Loss: 9.716 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 959522
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.823570013046265
Epoch: 1, Steps: 35 | Train Loss: 2.097 Vali Loss: 3.168 Vali Acc: 0.470 Test Loss: 3.168 Test Acc: 0.470
Validation loss decreased (inf --> -0.469968).  Saving model ...
Epoch: 2 cost time: 4.317959308624268
Epoch: 2, Steps: 35 | Train Loss: 2.706 Vali Loss: 2.152 Vali Acc: 0.570 Test Loss: 2.152 Test Acc: 0.570
Validation loss decreased (-0.469968 --> -0.569978).  Saving model ...
Epoch: 3 cost time: 4.626781463623047
Epoch: 3, Steps: 35 | Train Loss: 2.208 Vali Loss: 2.788 Vali Acc: 0.500 Test Loss: 2.788 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.2578535079956055
Epoch: 4, Steps: 35 | Train Loss: 2.561 Vali Loss: 5.562 Vali Acc: 0.540 Test Loss: 5.562 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.369434356689453
Epoch: 5, Steps: 35 | Train Loss: 1.965 Vali Loss: 4.400 Vali Acc: 0.590 Test Loss: 4.400 Test Acc: 0.590
Validation loss decreased (-0.569978 --> -0.589956).  Saving model ...
Epoch: 6 cost time: 4.416296482086182
Epoch: 6, Steps: 35 | Train Loss: 1.952 Vali Loss: 7.330 Vali Acc: 0.450 Test Loss: 7.330 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.286991596221924
Epoch: 7, Steps: 35 | Train Loss: 2.278 Vali Loss: 9.258 Vali Acc: 0.550 Test Loss: 9.258 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.259544610977173
Epoch: 8, Steps: 35 | Train Loss: 2.648 Vali Loss: 7.916 Vali Acc: 0.500 Test Loss: 7.916 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.111604690551758
Epoch: 9, Steps: 35 | Train Loss: 2.188 Vali Loss: 13.619 Vali Acc: 0.480 Test Loss: 13.619 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.226323843002319
Epoch: 10, Steps: 35 | Train Loss: 2.741 Vali Loss: 10.989 Vali Acc: 0.450 Test Loss: 10.989 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.238481283187866
Epoch: 11, Steps: 35 | Train Loss: 2.547 Vali Loss: 8.593 Vali Acc: 0.550 Test Loss: 8.593 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.161078691482544
Epoch: 12, Steps: 35 | Train Loss: 1.545 Vali Loss: 11.310 Vali Acc: 0.530 Test Loss: 11.310 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.540438890457153
Epoch: 13, Steps: 35 | Train Loss: 4.970 Vali Loss: 29.847 Vali Acc: 0.490 Test Loss: 29.847 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.720310688018799
Epoch: 14, Steps: 35 | Train Loss: 2.373 Vali Loss: 14.787 Vali Acc: 0.550 Test Loss: 14.787 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.6944849491119385
Epoch: 15, Steps: 35 | Train Loss: 3.037 Vali Loss: 11.940 Vali Acc: 0.530 Test Loss: 11.940 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 959522
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.775319337844849
Epoch: 1, Steps: 35 | Train Loss: 1.696 Vali Loss: 1.786 Vali Acc: 0.520 Test Loss: 1.786 Test Acc: 0.520
Validation loss decreased (inf --> -0.519982).  Saving model ...
Epoch: 2 cost time: 5.618051528930664
Epoch: 2, Steps: 35 | Train Loss: 3.120 Vali Loss: 8.439 Vali Acc: 0.510 Test Loss: 8.439 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.754414319992065
Epoch: 3, Steps: 35 | Train Loss: 4.538 Vali Loss: 10.975 Vali Acc: 0.490 Test Loss: 10.975 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.761252164840698
Epoch: 4, Steps: 35 | Train Loss: 5.570 Vali Loss: 11.236 Vali Acc: 0.570 Test Loss: 11.236 Test Acc: 0.570
Validation loss decreased (-0.519982 --> -0.569888).  Saving model ...
Epoch: 5 cost time: 5.576099634170532
Epoch: 5, Steps: 35 | Train Loss: 5.981 Vali Loss: 10.480 Vali Acc: 0.520 Test Loss: 10.480 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.695642471313477
Epoch: 6, Steps: 35 | Train Loss: 4.239 Vali Loss: 7.087 Vali Acc: 0.490 Test Loss: 7.087 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.607102155685425
Epoch: 7, Steps: 35 | Train Loss: 3.904 Vali Loss: 5.035 Vali Acc: 0.530 Test Loss: 5.035 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.9912590980529785
Epoch: 8, Steps: 35 | Train Loss: 2.329 Vali Loss: 6.140 Vali Acc: 0.570 Test Loss: 6.140 Test Acc: 0.570
Validation loss decreased (-0.569888 --> -0.569939).  Saving model ...
Epoch: 9 cost time: 5.595012187957764
Epoch: 9, Steps: 35 | Train Loss: 3.125 Vali Loss: 4.853 Vali Acc: 0.550 Test Loss: 4.853 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.36609411239624
Epoch: 10, Steps: 35 | Train Loss: 1.351 Vali Loss: 7.557 Vali Acc: 0.500 Test Loss: 7.557 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.444551706314087
Epoch: 11, Steps: 35 | Train Loss: 2.272 Vali Loss: 9.977 Vali Acc: 0.500 Test Loss: 9.977 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.818702697753906
Epoch: 12, Steps: 35 | Train Loss: 1.535 Vali Loss: 5.884 Vali Acc: 0.520 Test Loss: 5.884 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.777413606643677
Epoch: 13, Steps: 35 | Train Loss: 2.102 Vali Loss: 9.231 Vali Acc: 0.510 Test Loss: 9.231 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.868216276168823
Epoch: 14, Steps: 35 | Train Loss: 1.504 Vali Loss: 10.456 Vali Acc: 0.490 Test Loss: 10.456 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.06405234336853
Epoch: 15, Steps: 35 | Train Loss: 3.433 Vali Loss: 12.692 Vali Acc: 0.520 Test Loss: 12.692 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.70163106918335
Epoch: 16, Steps: 35 | Train Loss: 1.330 Vali Loss: 11.593 Vali Acc: 0.520 Test Loss: 11.593 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.51003885269165
Epoch: 17, Steps: 35 | Train Loss: 2.123 Vali Loss: 11.299 Vali Acc: 0.540 Test Loss: 11.299 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.686484098434448
Epoch: 18, Steps: 35 | Train Loss: 1.468 Vali Loss: 12.591 Vali Acc: 0.480 Test Loss: 12.591 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 926754
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.552337408065796
Epoch: 1, Steps: 35 | Train Loss: 1.717 Vali Loss: 1.372 Vali Acc: 0.530 Test Loss: 1.372 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 5.133548974990845
Epoch: 2, Steps: 35 | Train Loss: 2.640 Vali Loss: 5.335 Vali Acc: 0.480 Test Loss: 5.335 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.0828022956848145
Epoch: 3, Steps: 35 | Train Loss: 3.403 Vali Loss: 4.332 Vali Acc: 0.490 Test Loss: 4.332 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.393231153488159
Epoch: 4, Steps: 35 | Train Loss: 2.416 Vali Loss: 6.048 Vali Acc: 0.580 Test Loss: 6.048 Test Acc: 0.580
Validation loss decreased (-0.529986 --> -0.579940).  Saving model ...
Epoch: 5 cost time: 5.1656653881073
Epoch: 5, Steps: 35 | Train Loss: 2.757 Vali Loss: 10.265 Vali Acc: 0.480 Test Loss: 10.265 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.236258268356323
Epoch: 6, Steps: 35 | Train Loss: 3.056 Vali Loss: 9.184 Vali Acc: 0.520 Test Loss: 9.184 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.116514444351196
Epoch: 7, Steps: 35 | Train Loss: 3.328 Vali Loss: 5.203 Vali Acc: 0.610 Test Loss: 5.203 Test Acc: 0.610
Validation loss decreased (-0.579940 --> -0.609948).  Saving model ...
Epoch: 8 cost time: 5.129755020141602
Epoch: 8, Steps: 35 | Train Loss: 3.485 Vali Loss: 8.546 Vali Acc: 0.470 Test Loss: 8.546 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.159558296203613
Epoch: 9, Steps: 35 | Train Loss: 1.168 Vali Loss: 5.198 Vali Acc: 0.610 Test Loss: 5.198 Test Acc: 0.610
Validation loss decreased (-0.609948 --> -0.609948).  Saving model ...
Epoch: 10 cost time: 5.186160087585449
Epoch: 10, Steps: 35 | Train Loss: 2.126 Vali Loss: 9.268 Vali Acc: 0.480 Test Loss: 9.268 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.427976369857788
Epoch: 11, Steps: 35 | Train Loss: 2.180 Vali Loss: 6.816 Vali Acc: 0.600 Test Loss: 6.816 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.986956834793091
Epoch: 12, Steps: 35 | Train Loss: 3.759 Vali Loss: 13.454 Vali Acc: 0.490 Test Loss: 13.454 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.1941423416137695
Epoch: 13, Steps: 35 | Train Loss: 1.443 Vali Loss: 10.569 Vali Acc: 0.490 Test Loss: 10.569 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.503391742706299
Epoch: 14, Steps: 35 | Train Loss: 2.237 Vali Loss: 12.333 Vali Acc: 0.520 Test Loss: 12.333 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.2651848793029785
Epoch: 15, Steps: 35 | Train Loss: 2.593 Vali Loss: 8.365 Vali Acc: 0.560 Test Loss: 8.365 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.3953258991241455
Epoch: 16, Steps: 35 | Train Loss: 0.932 Vali Loss: 14.237 Vali Acc: 0.480 Test Loss: 14.237 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.137638807296753
Epoch: 17, Steps: 35 | Train Loss: 1.315 Vali Loss: 28.711 Vali Acc: 0.500 Test Loss: 28.711 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.291905164718628
Epoch: 18, Steps: 35 | Train Loss: 2.201 Vali Loss: 9.201 Vali Acc: 0.490 Test Loss: 9.201 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.02226448059082
Epoch: 19, Steps: 35 | Train Loss: 2.878 Vali Loss: 15.137 Vali Acc: 0.480 Test Loss: 15.137 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 926754
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.8160295486450195
Epoch: 1, Steps: 35 | Train Loss: 1.686 Vali Loss: 2.285 Vali Acc: 0.550 Test Loss: 2.285 Test Acc: 0.550
Validation loss decreased (inf --> -0.549977).  Saving model ...
Epoch: 2 cost time: 4.994691848754883
Epoch: 2, Steps: 35 | Train Loss: 3.681 Vali Loss: 2.822 Vali Acc: 0.550 Test Loss: 2.822 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.169735908508301
Epoch: 3, Steps: 35 | Train Loss: 2.624 Vali Loss: 6.125 Vali Acc: 0.530 Test Loss: 6.125 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.966959714889526
Epoch: 4, Steps: 35 | Train Loss: 4.703 Vali Loss: 4.952 Vali Acc: 0.540 Test Loss: 4.952 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.696044921875
Epoch: 5, Steps: 35 | Train Loss: 3.070 Vali Loss: 5.957 Vali Acc: 0.440 Test Loss: 5.957 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.946731090545654
Epoch: 6, Steps: 35 | Train Loss: 2.586 Vali Loss: 5.198 Vali Acc: 0.530 Test Loss: 5.198 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.47848105430603
Epoch: 7, Steps: 35 | Train Loss: 3.248 Vali Loss: 6.528 Vali Acc: 0.560 Test Loss: 6.528 Test Acc: 0.560
Validation loss decreased (-0.549977 --> -0.559935).  Saving model ...
Epoch: 8 cost time: 4.441953897476196
Epoch: 8, Steps: 35 | Train Loss: 1.641 Vali Loss: 10.205 Vali Acc: 0.440 Test Loss: 10.205 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.584864854812622
Epoch: 9, Steps: 35 | Train Loss: 1.530 Vali Loss: 4.840 Vali Acc: 0.540 Test Loss: 4.840 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.6689980030059814
Epoch: 10, Steps: 35 | Train Loss: 2.508 Vali Loss: 6.717 Vali Acc: 0.480 Test Loss: 6.717 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.543891668319702
Epoch: 11, Steps: 35 | Train Loss: 4.222 Vali Loss: 5.772 Vali Acc: 0.570 Test Loss: 5.772 Test Acc: 0.570
Validation loss decreased (-0.559935 --> -0.569942).  Saving model ...
Epoch: 12 cost time: 4.764151334762573
Epoch: 12, Steps: 35 | Train Loss: 3.427 Vali Loss: 30.849 Vali Acc: 0.500 Test Loss: 30.849 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.808238506317139
Epoch: 13, Steps: 35 | Train Loss: 7.091 Vali Loss: 17.966 Vali Acc: 0.490 Test Loss: 17.966 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.99223780632019
Epoch: 14, Steps: 35 | Train Loss: 3.994 Vali Loss: 8.771 Vali Acc: 0.550 Test Loss: 8.771 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.861741781234741
Epoch: 15, Steps: 35 | Train Loss: 2.745 Vali Loss: 15.819 Vali Acc: 0.490 Test Loss: 15.819 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.955557584762573
Epoch: 16, Steps: 35 | Train Loss: 3.119 Vali Loss: 7.614 Vali Acc: 0.530 Test Loss: 7.614 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.205137491226196
Epoch: 17, Steps: 35 | Train Loss: 2.677 Vali Loss: 10.632 Vali Acc: 0.490 Test Loss: 10.632 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.0701682567596436
Epoch: 18, Steps: 35 | Train Loss: 1.501 Vali Loss: 10.425 Vali Acc: 0.540 Test Loss: 10.425 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.151830196380615
Epoch: 19, Steps: 35 | Train Loss: 0.836 Vali Loss: 20.223 Vali Acc: 0.560 Test Loss: 20.223 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.915870189666748
Epoch: 20, Steps: 35 | Train Loss: 1.957 Vali Loss: 24.862 Vali Acc: 0.540 Test Loss: 24.862 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.85494065284729
Epoch: 21, Steps: 35 | Train Loss: 1.914 Vali Loss: 14.595 Vali Acc: 0.490 Test Loss: 14.595 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 926754
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.822473764419556
Epoch: 1, Steps: 35 | Train Loss: 1.511 Vali Loss: 6.386 Vali Acc: 0.480 Test Loss: 6.386 Test Acc: 0.480
Validation loss decreased (inf --> -0.479936).  Saving model ...
Epoch: 2 cost time: 4.248833417892456
Epoch: 2, Steps: 35 | Train Loss: 2.662 Vali Loss: 2.893 Vali Acc: 0.510 Test Loss: 2.893 Test Acc: 0.510
Validation loss decreased (-0.479936 --> -0.509971).  Saving model ...
Epoch: 3 cost time: 4.282135248184204
Epoch: 3, Steps: 35 | Train Loss: 2.800 Vali Loss: 4.499 Vali Acc: 0.490 Test Loss: 4.499 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.380582332611084
Epoch: 4, Steps: 35 | Train Loss: 2.378 Vali Loss: 4.841 Vali Acc: 0.580 Test Loss: 4.841 Test Acc: 0.580
Validation loss decreased (-0.509971 --> -0.579952).  Saving model ...
Epoch: 5 cost time: 4.084164142608643
Epoch: 5, Steps: 35 | Train Loss: 2.371 Vali Loss: 3.922 Vali Acc: 0.580 Test Loss: 3.922 Test Acc: 0.580
Validation loss decreased (-0.579952 --> -0.579961).  Saving model ...
Epoch: 6 cost time: 4.1527252197265625
Epoch: 6, Steps: 35 | Train Loss: 1.989 Vali Loss: 7.450 Vali Acc: 0.540 Test Loss: 7.450 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.370810508728027
Epoch: 7, Steps: 35 | Train Loss: 2.656 Vali Loss: 5.338 Vali Acc: 0.590 Test Loss: 5.338 Test Acc: 0.590
Validation loss decreased (-0.579961 --> -0.589947).  Saving model ...
Epoch: 8 cost time: 4.422072410583496
Epoch: 8, Steps: 35 | Train Loss: 3.093 Vali Loss: 10.159 Vali Acc: 0.450 Test Loss: 10.159 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.395997762680054
Epoch: 9, Steps: 35 | Train Loss: 3.554 Vali Loss: 8.566 Vali Acc: 0.600 Test Loss: 8.566 Test Acc: 0.600
Validation loss decreased (-0.589947 --> -0.599914).  Saving model ...
Epoch: 10 cost time: 4.282850980758667
Epoch: 10, Steps: 35 | Train Loss: 3.416 Vali Loss: 6.225 Vali Acc: 0.530 Test Loss: 6.225 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.349475145339966
Epoch: 11, Steps: 35 | Train Loss: 3.629 Vali Loss: 8.453 Vali Acc: 0.560 Test Loss: 8.453 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.261818885803223
Epoch: 12, Steps: 35 | Train Loss: 3.689 Vali Loss: 13.075 Vali Acc: 0.530 Test Loss: 13.075 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.331768035888672
Epoch: 13, Steps: 35 | Train Loss: 1.892 Vali Loss: 7.931 Vali Acc: 0.570 Test Loss: 7.931 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.212228059768677
Epoch: 14, Steps: 35 | Train Loss: 2.471 Vali Loss: 9.364 Vali Acc: 0.520 Test Loss: 9.364 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.238909006118774
Epoch: 15, Steps: 35 | Train Loss: 2.419 Vali Loss: 11.232 Vali Acc: 0.560 Test Loss: 11.232 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.5339741706848145
Epoch: 16, Steps: 35 | Train Loss: 3.485 Vali Loss: 6.527 Vali Acc: 0.570 Test Loss: 6.527 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.408924341201782
Epoch: 17, Steps: 35 | Train Loss: 2.190 Vali Loss: 21.085 Vali Acc: 0.490 Test Loss: 21.085 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.512640476226807
Epoch: 18, Steps: 35 | Train Loss: 3.125 Vali Loss: 23.843 Vali Acc: 0.510 Test Loss: 23.843 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.457059144973755
Epoch: 19, Steps: 35 | Train Loss: 3.558 Vali Loss: 11.948 Vali Acc: 0.510 Test Loss: 11.948 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 926754
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.244131803512573
Epoch: 1, Steps: 35 | Train Loss: 1.534 Vali Loss: 1.814 Vali Acc: 0.450 Test Loss: 1.814 Test Acc: 0.450
Validation loss decreased (inf --> -0.449982).  Saving model ...
Epoch: 2 cost time: 5.208118438720703
Epoch: 2, Steps: 35 | Train Loss: 1.628 Vali Loss: 2.752 Vali Acc: 0.480 Test Loss: 2.752 Test Acc: 0.480
Validation loss decreased (-0.449982 --> -0.479972).  Saving model ...
Epoch: 3 cost time: 4.995413303375244
Epoch: 3, Steps: 35 | Train Loss: 1.607 Vali Loss: 1.621 Vali Acc: 0.510 Test Loss: 1.621 Test Acc: 0.510
Validation loss decreased (-0.479972 --> -0.509984).  Saving model ...
Epoch: 4 cost time: 4.769122123718262
Epoch: 4, Steps: 35 | Train Loss: 1.625 Vali Loss: 5.827 Vali Acc: 0.490 Test Loss: 5.827 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.714339256286621
Epoch: 5, Steps: 35 | Train Loss: 2.738 Vali Loss: 3.404 Vali Acc: 0.530 Test Loss: 3.404 Test Acc: 0.530
Validation loss decreased (-0.509984 --> -0.529966).  Saving model ...
Epoch: 6 cost time: 4.841772556304932
Epoch: 6, Steps: 35 | Train Loss: 2.284 Vali Loss: 5.284 Vali Acc: 0.480 Test Loss: 5.284 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2350640296936035
Epoch: 7, Steps: 35 | Train Loss: 1.511 Vali Loss: 4.188 Vali Acc: 0.590 Test Loss: 4.188 Test Acc: 0.590
Validation loss decreased (-0.529966 --> -0.589958).  Saving model ...
Epoch: 8 cost time: 5.449163436889648
Epoch: 8, Steps: 35 | Train Loss: 1.592 Vali Loss: 3.556 Vali Acc: 0.510 Test Loss: 3.556 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.262913703918457
Epoch: 9, Steps: 35 | Train Loss: 0.842 Vali Loss: 6.665 Vali Acc: 0.520 Test Loss: 6.665 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.99698543548584
Epoch: 10, Steps: 35 | Train Loss: 1.891 Vali Loss: 3.965 Vali Acc: 0.500 Test Loss: 3.965 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.985695838928223
Epoch: 11, Steps: 35 | Train Loss: 1.740 Vali Loss: 9.597 Vali Acc: 0.450 Test Loss: 9.597 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.042744874954224
Epoch: 12, Steps: 35 | Train Loss: 1.982 Vali Loss: 8.893 Vali Acc: 0.470 Test Loss: 8.893 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.612531661987305
Epoch: 13, Steps: 35 | Train Loss: 1.026 Vali Loss: 8.050 Vali Acc: 0.450 Test Loss: 8.050 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.861068248748779
Epoch: 14, Steps: 35 | Train Loss: 1.215 Vali Loss: 9.742 Vali Acc: 0.460 Test Loss: 9.742 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.903974771499634
Epoch: 15, Steps: 35 | Train Loss: 1.618 Vali Loss: 12.932 Vali Acc: 0.490 Test Loss: 12.932 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.194875717163086
Epoch: 16, Steps: 35 | Train Loss: 1.206 Vali Loss: 10.902 Vali Acc: 0.520 Test Loss: 10.902 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.59155535697937
Epoch: 17, Steps: 35 | Train Loss: 0.986 Vali Loss: 5.433 Vali Acc: 0.520 Test Loss: 5.433 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 955170
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.997242212295532
Epoch: 1, Steps: 35 | Train Loss: 1.444 Vali Loss: 2.225 Vali Acc: 0.500 Test Loss: 2.225 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 4.922678709030151
Epoch: 2, Steps: 35 | Train Loss: 1.690 Vali Loss: 3.618 Vali Acc: 0.470 Test Loss: 3.618 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.595357418060303
Epoch: 3, Steps: 35 | Train Loss: 1.702 Vali Loss: 2.737 Vali Acc: 0.520 Test Loss: 2.737 Test Acc: 0.520
Validation loss decreased (-0.499978 --> -0.519973).  Saving model ...
Epoch: 4 cost time: 4.47096061706543
Epoch: 4, Steps: 35 | Train Loss: 1.231 Vali Loss: 4.173 Vali Acc: 0.470 Test Loss: 4.173 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.600436449050903
Epoch: 5, Steps: 35 | Train Loss: 1.798 Vali Loss: 3.349 Vali Acc: 0.480 Test Loss: 3.349 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.749220132827759
Epoch: 6, Steps: 35 | Train Loss: 2.032 Vali Loss: 4.293 Vali Acc: 0.490 Test Loss: 4.293 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.731420516967773
Epoch: 7, Steps: 35 | Train Loss: 1.830 Vali Loss: 7.691 Vali Acc: 0.470 Test Loss: 7.691 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.784007787704468
Epoch: 8, Steps: 35 | Train Loss: 1.263 Vali Loss: 6.770 Vali Acc: 0.520 Test Loss: 6.770 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.989674091339111
Epoch: 9, Steps: 35 | Train Loss: 1.750 Vali Loss: 6.293 Vali Acc: 0.540 Test Loss: 6.293 Test Acc: 0.540
Validation loss decreased (-0.519973 --> -0.539937).  Saving model ...
Epoch: 10 cost time: 4.900259017944336
Epoch: 10, Steps: 35 | Train Loss: 0.614 Vali Loss: 17.822 Vali Acc: 0.480 Test Loss: 17.822 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.553441286087036
Epoch: 11, Steps: 35 | Train Loss: 1.419 Vali Loss: 9.101 Vali Acc: 0.480 Test Loss: 9.101 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.654471397399902
Epoch: 12, Steps: 35 | Train Loss: 1.370 Vali Loss: 14.942 Vali Acc: 0.510 Test Loss: 14.942 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.58198618888855
Epoch: 13, Steps: 35 | Train Loss: 2.142 Vali Loss: 13.938 Vali Acc: 0.530 Test Loss: 13.938 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.531327724456787
Epoch: 14, Steps: 35 | Train Loss: 1.789 Vali Loss: 11.347 Vali Acc: 0.540 Test Loss: 11.347 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.918020248413086
Epoch: 15, Steps: 35 | Train Loss: 1.583 Vali Loss: 13.365 Vali Acc: 0.510 Test Loss: 13.365 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.008702278137207
Epoch: 16, Steps: 35 | Train Loss: 1.984 Vali Loss: 8.815 Vali Acc: 0.500 Test Loss: 8.815 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.783712863922119
Epoch: 17, Steps: 35 | Train Loss: 1.188 Vali Loss: 8.771 Vali Acc: 0.550 Test Loss: 8.771 Test Acc: 0.550
Validation loss decreased (-0.539937 --> -0.549912).  Saving model ...
Epoch: 18 cost time: 4.784208059310913
Epoch: 18, Steps: 35 | Train Loss: 0.882 Vali Loss: 16.542 Vali Acc: 0.520 Test Loss: 16.542 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.792612075805664
Epoch: 19, Steps: 35 | Train Loss: 0.983 Vali Loss: 9.604 Vali Acc: 0.570 Test Loss: 9.604 Test Acc: 0.570
Validation loss decreased (-0.549912 --> -0.569904).  Saving model ...
Epoch: 20 cost time: 4.981393337249756
Epoch: 20, Steps: 35 | Train Loss: 1.001 Vali Loss: 20.794 Vali Acc: 0.570 Test Loss: 20.794 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.05347466468811
Epoch: 21, Steps: 35 | Train Loss: 1.042 Vali Loss: 9.795 Vali Acc: 0.560 Test Loss: 9.795 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.162628412246704
Epoch: 22, Steps: 35 | Train Loss: 0.962 Vali Loss: 18.371 Vali Acc: 0.570 Test Loss: 18.371 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.8606486320495605
Epoch: 23, Steps: 35 | Train Loss: 1.007 Vali Loss: 15.971 Vali Acc: 0.550 Test Loss: 15.971 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.12480354309082
Epoch: 24, Steps: 35 | Train Loss: 2.267 Vali Loss: 20.684 Vali Acc: 0.540 Test Loss: 20.684 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.738535165786743
Epoch: 25, Steps: 35 | Train Loss: 0.641 Vali Loss: 14.773 Vali Acc: 0.570 Test Loss: 14.773 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.753811597824097
Epoch: 26, Steps: 35 | Train Loss: 0.537 Vali Loss: 15.521 Vali Acc: 0.530 Test Loss: 15.521 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.484262704849243
Epoch: 27, Steps: 35 | Train Loss: 1.917 Vali Loss: 17.750 Vali Acc: 0.520 Test Loss: 17.750 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.506802082061768
Epoch: 28, Steps: 35 | Train Loss: 0.751 Vali Loss: 22.367 Vali Acc: 0.550 Test Loss: 22.367 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.484111785888672
Epoch: 29, Steps: 35 | Train Loss: 1.212 Vali Loss: 16.542 Vali Acc: 0.530 Test Loss: 16.542 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 955170
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.969040632247925
Epoch: 1, Steps: 35 | Train Loss: 1.381 Vali Loss: 2.345 Vali Acc: 0.480 Test Loss: 2.345 Test Acc: 0.480
Validation loss decreased (inf --> -0.479977).  Saving model ...
Epoch: 2 cost time: 4.4504499435424805
Epoch: 2, Steps: 35 | Train Loss: 1.730 Vali Loss: 2.077 Vali Acc: 0.480 Test Loss: 2.077 Test Acc: 0.480
Validation loss decreased (-0.479977 --> -0.479979).  Saving model ...
Epoch: 3 cost time: 4.4806108474731445
Epoch: 3, Steps: 35 | Train Loss: 1.617 Vali Loss: 5.162 Vali Acc: 0.480 Test Loss: 5.162 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.180935621261597
Epoch: 4, Steps: 35 | Train Loss: 1.442 Vali Loss: 3.057 Vali Acc: 0.520 Test Loss: 3.057 Test Acc: 0.520
Validation loss decreased (-0.479979 --> -0.519969).  Saving model ...
Epoch: 5 cost time: 4.301865100860596
Epoch: 5, Steps: 35 | Train Loss: 1.597 Vali Loss: 4.719 Vali Acc: 0.440 Test Loss: 4.719 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.564288854598999
Epoch: 6, Steps: 35 | Train Loss: 2.733 Vali Loss: 4.659 Vali Acc: 0.480 Test Loss: 4.659 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.462707042694092
Epoch: 7, Steps: 35 | Train Loss: 0.996 Vali Loss: 4.107 Vali Acc: 0.470 Test Loss: 4.107 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.298271417617798
Epoch: 8, Steps: 35 | Train Loss: 1.481 Vali Loss: 5.190 Vali Acc: 0.520 Test Loss: 5.190 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.19271993637085
Epoch: 9, Steps: 35 | Train Loss: 1.360 Vali Loss: 4.676 Vali Acc: 0.560 Test Loss: 4.676 Test Acc: 0.560
Validation loss decreased (-0.519969 --> -0.559953).  Saving model ...
Epoch: 10 cost time: 4.318359613418579
Epoch: 10, Steps: 35 | Train Loss: 1.147 Vali Loss: 8.281 Vali Acc: 0.510 Test Loss: 8.281 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.410535097122192
Epoch: 11, Steps: 35 | Train Loss: 1.665 Vali Loss: 10.036 Vali Acc: 0.490 Test Loss: 10.036 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.4328296184539795
Epoch: 12, Steps: 35 | Train Loss: 1.556 Vali Loss: 7.000 Vali Acc: 0.580 Test Loss: 7.000 Test Acc: 0.580
Validation loss decreased (-0.559953 --> -0.579930).  Saving model ...
Epoch: 13 cost time: 4.555495500564575
Epoch: 13, Steps: 35 | Train Loss: 1.756 Vali Loss: 6.133 Vali Acc: 0.600 Test Loss: 6.133 Test Acc: 0.600
Validation loss decreased (-0.579930 --> -0.599939).  Saving model ...
Epoch: 14 cost time: 4.3609230518341064
Epoch: 14, Steps: 35 | Train Loss: 1.495 Vali Loss: 6.514 Vali Acc: 0.550 Test Loss: 6.514 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5712456703186035
Epoch: 15, Steps: 35 | Train Loss: 1.116 Vali Loss: 6.005 Vali Acc: 0.590 Test Loss: 6.005 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.250765323638916
Epoch: 16, Steps: 35 | Train Loss: 1.143 Vali Loss: 7.082 Vali Acc: 0.470 Test Loss: 7.082 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.447141885757446
Epoch: 17, Steps: 35 | Train Loss: 0.876 Vali Loss: 8.614 Vali Acc: 0.460 Test Loss: 8.614 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.494803428649902
Epoch: 18, Steps: 35 | Train Loss: 1.327 Vali Loss: 7.569 Vali Acc: 0.590 Test Loss: 7.569 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.808441638946533
Epoch: 19, Steps: 35 | Train Loss: 2.010 Vali Loss: 8.069 Vali Acc: 0.560 Test Loss: 8.069 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.6087327003479
Epoch: 20, Steps: 35 | Train Loss: 0.971 Vali Loss: 8.729 Vali Acc: 0.550 Test Loss: 8.729 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.109267950057983
Epoch: 21, Steps: 35 | Train Loss: 2.003 Vali Loss: 6.743 Vali Acc: 0.560 Test Loss: 6.743 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.43970251083374
Epoch: 22, Steps: 35 | Train Loss: 2.703 Vali Loss: 8.034 Vali Acc: 0.550 Test Loss: 8.034 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.50874662399292
Epoch: 23, Steps: 35 | Train Loss: 1.859 Vali Loss: 10.373 Vali Acc: 0.480 Test Loss: 10.373 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 955170
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.027717590332031
Epoch: 1, Steps: 35 | Train Loss: 1.438 Vali Loss: 2.160 Vali Acc: 0.440 Test Loss: 2.160 Test Acc: 0.440
Validation loss decreased (inf --> -0.439978).  Saving model ...
Epoch: 2 cost time: 3.958859920501709
Epoch: 2, Steps: 35 | Train Loss: 2.267 Vali Loss: 1.823 Vali Acc: 0.470 Test Loss: 1.823 Test Acc: 0.470
Validation loss decreased (-0.439978 --> -0.469982).  Saving model ...
Epoch: 3 cost time: 4.055786848068237
Epoch: 3, Steps: 35 | Train Loss: 1.641 Vali Loss: 2.479 Vali Acc: 0.540 Test Loss: 2.479 Test Acc: 0.540
Validation loss decreased (-0.469982 --> -0.539975).  Saving model ...
Epoch: 4 cost time: 4.397667169570923
Epoch: 4, Steps: 35 | Train Loss: 1.894 Vali Loss: 2.661 Vali Acc: 0.550 Test Loss: 2.661 Test Acc: 0.550
Validation loss decreased (-0.539975 --> -0.549973).  Saving model ...
Epoch: 5 cost time: 4.347057819366455
Epoch: 5, Steps: 35 | Train Loss: 2.333 Vali Loss: 4.420 Vali Acc: 0.510 Test Loss: 4.420 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.205489635467529
Epoch: 6, Steps: 35 | Train Loss: 2.328 Vali Loss: 4.720 Vali Acc: 0.460 Test Loss: 4.720 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.134484529495239
Epoch: 7, Steps: 35 | Train Loss: 1.705 Vali Loss: 4.219 Vali Acc: 0.510 Test Loss: 4.219 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.1707141399383545
Epoch: 8, Steps: 35 | Train Loss: 2.239 Vali Loss: 5.283 Vali Acc: 0.540 Test Loss: 5.283 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.21475076675415
Epoch: 9, Steps: 35 | Train Loss: 2.117 Vali Loss: 9.483 Vali Acc: 0.510 Test Loss: 9.483 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.20989465713501
Epoch: 10, Steps: 35 | Train Loss: 2.428 Vali Loss: 11.265 Vali Acc: 0.510 Test Loss: 11.265 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.2273290157318115
Epoch: 11, Steps: 35 | Train Loss: 2.307 Vali Loss: 4.747 Vali Acc: 0.500 Test Loss: 4.747 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.386549472808838
Epoch: 12, Steps: 35 | Train Loss: 1.640 Vali Loss: 5.980 Vali Acc: 0.510 Test Loss: 5.980 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.40136194229126
Epoch: 13, Steps: 35 | Train Loss: 2.286 Vali Loss: 5.447 Vali Acc: 0.590 Test Loss: 5.447 Test Acc: 0.590
Validation loss decreased (-0.549973 --> -0.589946).  Saving model ...
Epoch: 14 cost time: 4.380243301391602
Epoch: 14, Steps: 35 | Train Loss: 1.576 Vali Loss: 8.004 Vali Acc: 0.510 Test Loss: 8.004 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.340582370758057
Epoch: 15, Steps: 35 | Train Loss: 2.147 Vali Loss: 8.494 Vali Acc: 0.480 Test Loss: 8.494 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.611689329147339
Epoch: 16, Steps: 35 | Train Loss: 1.417 Vali Loss: 5.452 Vali Acc: 0.550 Test Loss: 5.452 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.587587118148804
Epoch: 17, Steps: 35 | Train Loss: 1.769 Vali Loss: 8.976 Vali Acc: 0.520 Test Loss: 8.976 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.643172025680542
Epoch: 18, Steps: 35 | Train Loss: 1.719 Vali Loss: 19.231 Vali Acc: 0.490 Test Loss: 19.231 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.520129442214966
Epoch: 19, Steps: 35 | Train Loss: 2.997 Vali Loss: 9.225 Vali Acc: 0.480 Test Loss: 9.225 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.7681238651275635
Epoch: 20, Steps: 35 | Train Loss: 1.140 Vali Loss: 9.895 Vali Acc: 0.500 Test Loss: 9.895 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.482885837554932
Epoch: 21, Steps: 35 | Train Loss: 1.406 Vali Loss: 6.212 Vali Acc: 0.440 Test Loss: 6.212 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.573909759521484
Epoch: 22, Steps: 35 | Train Loss: 1.982 Vali Loss: 13.779 Vali Acc: 0.470 Test Loss: 13.779 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.746206998825073
Epoch: 23, Steps: 35 | Train Loss: 3.007 Vali Loss: 7.631 Vali Acc: 0.450 Test Loss: 7.631 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 955170
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.347981691360474
Epoch: 1, Steps: 35 | Train Loss: 1.293 Vali Loss: 1.342 Vali Acc: 0.570 Test Loss: 1.342 Test Acc: 0.570
Validation loss decreased (inf --> -0.569987).  Saving model ...
Epoch: 2 cost time: 4.617298364639282
Epoch: 2, Steps: 35 | Train Loss: 1.706 Vali Loss: 1.749 Vali Acc: 0.510 Test Loss: 1.749 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.391022443771362
Epoch: 3, Steps: 35 | Train Loss: 1.737 Vali Loss: 2.929 Vali Acc: 0.500 Test Loss: 2.929 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.402055263519287
Epoch: 4, Steps: 35 | Train Loss: 2.650 Vali Loss: 2.856 Vali Acc: 0.560 Test Loss: 2.856 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.643317699432373
Epoch: 5, Steps: 35 | Train Loss: 3.225 Vali Loss: 3.048 Vali Acc: 0.500 Test Loss: 3.048 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.125173330307007
Epoch: 6, Steps: 35 | Train Loss: 1.736 Vali Loss: 2.916 Vali Acc: 0.470 Test Loss: 2.916 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.772824287414551
Epoch: 7, Steps: 35 | Train Loss: 1.211 Vali Loss: 3.545 Vali Acc: 0.520 Test Loss: 3.545 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.682106018066406
Epoch: 8, Steps: 35 | Train Loss: 1.553 Vali Loss: 6.678 Vali Acc: 0.460 Test Loss: 6.678 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.982255697250366
Epoch: 9, Steps: 35 | Train Loss: 1.356 Vali Loss: 10.713 Vali Acc: 0.500 Test Loss: 10.713 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.957070350646973
Epoch: 10, Steps: 35 | Train Loss: 2.002 Vali Loss: 8.664 Vali Acc: 0.460 Test Loss: 8.664 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.813607215881348
Epoch: 11, Steps: 35 | Train Loss: 2.626 Vali Loss: 9.055 Vali Acc: 0.560 Test Loss: 9.055 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 693026
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.58753228187561
Epoch: 1, Steps: 35 | Train Loss: 1.239 Vali Loss: 1.338 Vali Acc: 0.590 Test Loss: 1.338 Test Acc: 0.590
Validation loss decreased (inf --> -0.589987).  Saving model ...
Epoch: 2 cost time: 4.265210151672363
Epoch: 2, Steps: 35 | Train Loss: 1.702 Vali Loss: 1.832 Vali Acc: 0.530 Test Loss: 1.832 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.378209114074707
Epoch: 3, Steps: 35 | Train Loss: 3.050 Vali Loss: 4.808 Vali Acc: 0.510 Test Loss: 4.808 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.192379713058472
Epoch: 4, Steps: 35 | Train Loss: 3.286 Vali Loss: 4.201 Vali Acc: 0.460 Test Loss: 4.201 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.207714557647705
Epoch: 5, Steps: 35 | Train Loss: 1.773 Vali Loss: 3.553 Vali Acc: 0.540 Test Loss: 3.553 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.091878652572632
Epoch: 6, Steps: 35 | Train Loss: 1.829 Vali Loss: 9.419 Vali Acc: 0.490 Test Loss: 9.419 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.248574733734131
Epoch: 7, Steps: 35 | Train Loss: 2.467 Vali Loss: 6.673 Vali Acc: 0.460 Test Loss: 6.673 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.138066053390503
Epoch: 8, Steps: 35 | Train Loss: 1.719 Vali Loss: 4.754 Vali Acc: 0.510 Test Loss: 4.754 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.083045959472656
Epoch: 9, Steps: 35 | Train Loss: 2.084 Vali Loss: 4.097 Vali Acc: 0.510 Test Loss: 4.097 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.406414985656738
Epoch: 10, Steps: 35 | Train Loss: 2.258 Vali Loss: 7.157 Vali Acc: 0.490 Test Loss: 7.157 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.186485290527344
Epoch: 11, Steps: 35 | Train Loss: 1.624 Vali Loss: 4.137 Vali Acc: 0.550 Test Loss: 4.137 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 693026
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.507823705673218
Epoch: 1, Steps: 35 | Train Loss: 1.184 Vali Loss: 1.238 Vali Acc: 0.610 Test Loss: 1.238 Test Acc: 0.610
Validation loss decreased (inf --> -0.609988).  Saving model ...
Epoch: 2 cost time: 4.209550619125366
Epoch: 2, Steps: 35 | Train Loss: 1.756 Vali Loss: 1.841 Vali Acc: 0.600 Test Loss: 1.841 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9815025329589844
Epoch: 3, Steps: 35 | Train Loss: 3.873 Vali Loss: 2.866 Vali Acc: 0.580 Test Loss: 2.866 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.265253067016602
Epoch: 4, Steps: 35 | Train Loss: 1.832 Vali Loss: 2.232 Vali Acc: 0.550 Test Loss: 2.232 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7848143577575684
Epoch: 5, Steps: 35 | Train Loss: 1.814 Vali Loss: 4.097 Vali Acc: 0.500 Test Loss: 4.097 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5364389419555664
Epoch: 6, Steps: 35 | Train Loss: 1.184 Vali Loss: 2.670 Vali Acc: 0.550 Test Loss: 2.670 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4922423362731934
Epoch: 7, Steps: 35 | Train Loss: 1.099 Vali Loss: 3.847 Vali Acc: 0.550 Test Loss: 3.847 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6452157497406006
Epoch: 8, Steps: 35 | Train Loss: 1.489 Vali Loss: 3.636 Vali Acc: 0.520 Test Loss: 3.636 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9070730209350586
Epoch: 9, Steps: 35 | Train Loss: 1.096 Vali Loss: 2.951 Vali Acc: 0.640 Test Loss: 2.951 Test Acc: 0.640
Validation loss decreased (-0.609988 --> -0.639970).  Saving model ...
Epoch: 10 cost time: 3.8264851570129395
Epoch: 10, Steps: 35 | Train Loss: 1.946 Vali Loss: 10.154 Vali Acc: 0.460 Test Loss: 10.154 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0006701946258545
Epoch: 11, Steps: 35 | Train Loss: 1.887 Vali Loss: 8.321 Vali Acc: 0.450 Test Loss: 8.321 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.957080364227295
Epoch: 12, Steps: 35 | Train Loss: 2.001 Vali Loss: 4.547 Vali Acc: 0.570 Test Loss: 4.547 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9417970180511475
Epoch: 13, Steps: 35 | Train Loss: 1.071 Vali Loss: 8.797 Vali Acc: 0.460 Test Loss: 8.797 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.3067615032196045
Epoch: 14, Steps: 35 | Train Loss: 1.335 Vali Loss: 6.323 Vali Acc: 0.450 Test Loss: 6.323 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.09454607963562
Epoch: 15, Steps: 35 | Train Loss: 1.989 Vali Loss: 9.913 Vali Acc: 0.500 Test Loss: 9.913 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.215463638305664
Epoch: 16, Steps: 35 | Train Loss: 0.982 Vali Loss: 6.351 Vali Acc: 0.540 Test Loss: 6.351 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.43739128112793
Epoch: 17, Steps: 35 | Train Loss: 1.584 Vali Loss: 13.871 Vali Acc: 0.500 Test Loss: 13.871 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.261445045471191
Epoch: 18, Steps: 35 | Train Loss: 2.366 Vali Loss: 11.843 Vali Acc: 0.500 Test Loss: 11.843 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.120690822601318
Epoch: 19, Steps: 35 | Train Loss: 1.053 Vali Loss: 7.811 Vali Acc: 0.560 Test Loss: 7.811 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 693026
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.8106842041015625
Epoch: 1, Steps: 35 | Train Loss: 1.081 Vali Loss: 1.346 Vali Acc: 0.550 Test Loss: 1.346 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 4.0997068881988525
Epoch: 2, Steps: 35 | Train Loss: 1.772 Vali Loss: 2.775 Vali Acc: 0.590 Test Loss: 2.775 Test Acc: 0.590
Validation loss decreased (-0.549987 --> -0.589972).  Saving model ...
Epoch: 3 cost time: 3.9581258296966553
Epoch: 3, Steps: 35 | Train Loss: 2.857 Vali Loss: 2.952 Vali Acc: 0.540 Test Loss: 2.952 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.836510181427002
Epoch: 4, Steps: 35 | Train Loss: 1.957 Vali Loss: 2.750 Vali Acc: 0.540 Test Loss: 2.750 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.964526653289795
Epoch: 5, Steps: 35 | Train Loss: 1.637 Vali Loss: 2.546 Vali Acc: 0.560 Test Loss: 2.546 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.071765661239624
Epoch: 6, Steps: 35 | Train Loss: 1.319 Vali Loss: 4.302 Vali Acc: 0.510 Test Loss: 4.302 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.361997127532959
Epoch: 7, Steps: 35 | Train Loss: 2.433 Vali Loss: 3.539 Vali Acc: 0.520 Test Loss: 3.539 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.159905195236206
Epoch: 8, Steps: 35 | Train Loss: 2.374 Vali Loss: 6.129 Vali Acc: 0.500 Test Loss: 6.129 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.862999439239502
Epoch: 9, Steps: 35 | Train Loss: 1.609 Vali Loss: 2.885 Vali Acc: 0.580 Test Loss: 2.885 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.928180694580078
Epoch: 10, Steps: 35 | Train Loss: 1.923 Vali Loss: 7.607 Vali Acc: 0.520 Test Loss: 7.607 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.016523122787476
Epoch: 11, Steps: 35 | Train Loss: 1.542 Vali Loss: 5.249 Vali Acc: 0.520 Test Loss: 5.249 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8082525730133057
Epoch: 12, Steps: 35 | Train Loss: 2.528 Vali Loss: 5.543 Vali Acc: 0.580 Test Loss: 5.543 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 693026
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.554151296615601
Epoch: 1, Steps: 35 | Train Loss: 1.118 Vali Loss: 0.810 Vali Acc: 0.610 Test Loss: 0.810 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 4.074223279953003
Epoch: 2, Steps: 35 | Train Loss: 1.262 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.982041597366333
Epoch: 3, Steps: 35 | Train Loss: 1.604 Vali Loss: 2.063 Vali Acc: 0.460 Test Loss: 2.063 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.143871068954468
Epoch: 4, Steps: 35 | Train Loss: 1.311 Vali Loss: 3.415 Vali Acc: 0.530 Test Loss: 3.415 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.169935703277588
Epoch: 5, Steps: 35 | Train Loss: 1.901 Vali Loss: 3.146 Vali Acc: 0.510 Test Loss: 3.146 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.3064045906066895
Epoch: 6, Steps: 35 | Train Loss: 1.445 Vali Loss: 2.639 Vali Acc: 0.490 Test Loss: 2.639 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.197323322296143
Epoch: 7, Steps: 35 | Train Loss: 1.108 Vali Loss: 4.916 Vali Acc: 0.540 Test Loss: 4.916 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.3094096183776855
Epoch: 8, Steps: 35 | Train Loss: 1.078 Vali Loss: 3.944 Vali Acc: 0.520 Test Loss: 3.944 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.1735100746154785
Epoch: 9, Steps: 35 | Train Loss: 1.042 Vali Loss: 4.024 Vali Acc: 0.550 Test Loss: 4.024 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.336860179901123
Epoch: 10, Steps: 35 | Train Loss: 1.012 Vali Loss: 5.842 Vali Acc: 0.410 Test Loss: 5.842 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.302184104919434
Epoch: 11, Steps: 35 | Train Loss: 1.246 Vali Loss: 5.832 Vali Acc: 0.460 Test Loss: 5.832 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 561954
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.994825839996338
Epoch: 1, Steps: 35 | Train Loss: 1.116 Vali Loss: 0.933 Vali Acc: 0.620 Test Loss: 0.933 Test Acc: 0.620
Validation loss decreased (inf --> -0.619991).  Saving model ...
Epoch: 2 cost time: 3.790926933288574
Epoch: 2, Steps: 35 | Train Loss: 1.324 Vali Loss: 2.568 Vali Acc: 0.450 Test Loss: 2.568 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.941359519958496
Epoch: 3, Steps: 35 | Train Loss: 1.459 Vali Loss: 4.492 Vali Acc: 0.460 Test Loss: 4.492 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.138259172439575
Epoch: 4, Steps: 35 | Train Loss: 3.103 Vali Loss: 5.389 Vali Acc: 0.460 Test Loss: 5.389 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.260279893875122
Epoch: 5, Steps: 35 | Train Loss: 1.989 Vali Loss: 3.656 Vali Acc: 0.490 Test Loss: 3.656 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.964653968811035
Epoch: 6, Steps: 35 | Train Loss: 1.553 Vali Loss: 5.021 Vali Acc: 0.420 Test Loss: 5.021 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.050953149795532
Epoch: 7, Steps: 35 | Train Loss: 2.416 Vali Loss: 3.606 Vali Acc: 0.530 Test Loss: 3.606 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9124181270599365
Epoch: 8, Steps: 35 | Train Loss: 1.406 Vali Loss: 4.298 Vali Acc: 0.500 Test Loss: 4.298 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.843484878540039
Epoch: 9, Steps: 35 | Train Loss: 1.286 Vali Loss: 7.010 Vali Acc: 0.510 Test Loss: 7.010 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.7947285175323486
Epoch: 10, Steps: 35 | Train Loss: 2.418 Vali Loss: 6.244 Vali Acc: 0.440 Test Loss: 6.244 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.956291913986206
Epoch: 11, Steps: 35 | Train Loss: 1.927 Vali Loss: 5.346 Vali Acc: 0.430 Test Loss: 5.346 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 561954
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.991278171539307
Epoch: 1, Steps: 35 | Train Loss: 1.099 Vali Loss: 0.871 Vali Acc: 0.600 Test Loss: 0.871 Test Acc: 0.600
Validation loss decreased (inf --> -0.599991).  Saving model ...
Epoch: 2 cost time: 4.196167945861816
Epoch: 2, Steps: 35 | Train Loss: 1.593 Vali Loss: 1.992 Vali Acc: 0.430 Test Loss: 1.992 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.350663661956787
Epoch: 3, Steps: 35 | Train Loss: 1.934 Vali Loss: 1.902 Vali Acc: 0.450 Test Loss: 1.902 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.984189748764038
Epoch: 4, Steps: 35 | Train Loss: 2.685 Vali Loss: 6.676 Vali Acc: 0.500 Test Loss: 6.676 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.325287103652954
Epoch: 5, Steps: 35 | Train Loss: 2.732 Vali Loss: 6.237 Vali Acc: 0.510 Test Loss: 6.237 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9637718200683594
Epoch: 6, Steps: 35 | Train Loss: 1.700 Vali Loss: 5.245 Vali Acc: 0.520 Test Loss: 5.245 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.13482666015625
Epoch: 7, Steps: 35 | Train Loss: 1.467 Vali Loss: 3.468 Vali Acc: 0.480 Test Loss: 3.468 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.222074031829834
Epoch: 8, Steps: 35 | Train Loss: 1.575 Vali Loss: 4.419 Vali Acc: 0.450 Test Loss: 4.419 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.02659797668457
Epoch: 9, Steps: 35 | Train Loss: 2.047 Vali Loss: 4.075 Vali Acc: 0.550 Test Loss: 4.075 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9450862407684326
Epoch: 10, Steps: 35 | Train Loss: 1.476 Vali Loss: 6.695 Vali Acc: 0.510 Test Loss: 6.695 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.899420738220215
Epoch: 11, Steps: 35 | Train Loss: 1.696 Vali Loss: 4.903 Vali Acc: 0.460 Test Loss: 4.903 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 561954
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.726475238800049
Epoch: 1, Steps: 35 | Train Loss: 1.063 Vali Loss: 1.067 Vali Acc: 0.570 Test Loss: 1.067 Test Acc: 0.570
Validation loss decreased (inf --> -0.569989).  Saving model ...
Epoch: 2 cost time: 4.139649152755737
Epoch: 2, Steps: 35 | Train Loss: 1.283 Vali Loss: 4.868 Vali Acc: 0.490 Test Loss: 4.868 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.268661260604858
Epoch: 3, Steps: 35 | Train Loss: 1.922 Vali Loss: 1.901 Vali Acc: 0.510 Test Loss: 1.901 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9864776134490967
Epoch: 4, Steps: 35 | Train Loss: 1.678 Vali Loss: 8.251 Vali Acc: 0.500 Test Loss: 8.251 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.680539131164551
Epoch: 5, Steps: 35 | Train Loss: 2.739 Vali Loss: 5.849 Vali Acc: 0.550 Test Loss: 5.849 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8799288272857666
Epoch: 6, Steps: 35 | Train Loss: 2.204 Vali Loss: 10.161 Vali Acc: 0.490 Test Loss: 10.161 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.9802403450012207
Epoch: 7, Steps: 35 | Train Loss: 1.471 Vali Loss: 4.969 Vali Acc: 0.430 Test Loss: 4.969 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9185678958892822
Epoch: 8, Steps: 35 | Train Loss: 1.706 Vali Loss: 5.099 Vali Acc: 0.490 Test Loss: 5.099 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.8721773624420166
Epoch: 9, Steps: 35 | Train Loss: 1.575 Vali Loss: 4.619 Vali Acc: 0.490 Test Loss: 4.619 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.936417818069458
Epoch: 10, Steps: 35 | Train Loss: 2.328 Vali Loss: 4.717 Vali Acc: 0.570 Test Loss: 4.717 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.915703535079956
Epoch: 11, Steps: 35 | Train Loss: 1.651 Vali Loss: 4.035 Vali Acc: 0.570 Test Loss: 4.035 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 561954
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.968742609024048
Epoch: 1, Steps: 35 | Train Loss: 1.178 Vali Loss: 2.071 Vali Acc: 0.520 Test Loss: 2.071 Test Acc: 0.520
Validation loss decreased (inf --> -0.519979).  Saving model ...
Epoch: 2 cost time: 3.9929802417755127
Epoch: 2, Steps: 35 | Train Loss: 2.107 Vali Loss: 2.945 Vali Acc: 0.520 Test Loss: 2.945 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.090377569198608
Epoch: 3, Steps: 35 | Train Loss: 2.375 Vali Loss: 2.658 Vali Acc: 0.460 Test Loss: 2.658 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.113340854644775
Epoch: 4, Steps: 35 | Train Loss: 2.718 Vali Loss: 5.401 Vali Acc: 0.530 Test Loss: 5.401 Test Acc: 0.530
Validation loss decreased (-0.519979 --> -0.529946).  Saving model ...
Epoch: 5 cost time: 4.091856956481934
Epoch: 5, Steps: 35 | Train Loss: 1.928 Vali Loss: 1.940 Vali Acc: 0.570 Test Loss: 1.940 Test Acc: 0.570
Validation loss decreased (-0.529946 --> -0.569981).  Saving model ...
Epoch: 6 cost time: 4.278195142745972
Epoch: 6, Steps: 35 | Train Loss: 1.579 Vali Loss: 5.736 Vali Acc: 0.460 Test Loss: 5.736 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.333143472671509
Epoch: 7, Steps: 35 | Train Loss: 1.247 Vali Loss: 4.434 Vali Acc: 0.500 Test Loss: 4.434 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.490406036376953
Epoch: 8, Steps: 35 | Train Loss: 1.683 Vali Loss: 5.911 Vali Acc: 0.500 Test Loss: 5.911 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.304059267044067
Epoch: 9, Steps: 35 | Train Loss: 2.852 Vali Loss: 10.643 Vali Acc: 0.520 Test Loss: 10.643 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.3997931480407715
Epoch: 10, Steps: 35 | Train Loss: 1.115 Vali Loss: 3.044 Vali Acc: 0.520 Test Loss: 3.044 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.313681364059448
Epoch: 11, Steps: 35 | Train Loss: 1.636 Vali Loss: 5.565 Vali Acc: 0.530 Test Loss: 5.565 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.2145466804504395
Epoch: 12, Steps: 35 | Train Loss: 1.045 Vali Loss: 5.190 Vali Acc: 0.510 Test Loss: 5.190 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.199528455734253
Epoch: 13, Steps: 35 | Train Loss: 1.697 Vali Loss: 4.772 Vali Acc: 0.540 Test Loss: 4.772 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.195647716522217
Epoch: 14, Steps: 35 | Train Loss: 1.324 Vali Loss: 5.309 Vali Acc: 0.520 Test Loss: 5.309 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.215813159942627
Epoch: 15, Steps: 35 | Train Loss: 0.656 Vali Loss: 5.083 Vali Acc: 0.540 Test Loss: 5.083 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 496418
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.867089748382568
Epoch: 1, Steps: 35 | Train Loss: 1.140 Vali Loss: 1.980 Vali Acc: 0.480 Test Loss: 1.980 Test Acc: 0.480
Validation loss decreased (inf --> -0.479980).  Saving model ...
Epoch: 2 cost time: 3.9691672325134277
Epoch: 2, Steps: 35 | Train Loss: 1.663 Vali Loss: 2.161 Vali Acc: 0.450 Test Loss: 2.161 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.767028331756592
Epoch: 3, Steps: 35 | Train Loss: 2.007 Vali Loss: 1.498 Vali Acc: 0.570 Test Loss: 1.498 Test Acc: 0.570
Validation loss decreased (-0.479980 --> -0.569985).  Saving model ...
Epoch: 4 cost time: 3.871065616607666
Epoch: 4, Steps: 35 | Train Loss: 1.423 Vali Loss: 3.583 Vali Acc: 0.530 Test Loss: 3.583 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.658920049667358
Epoch: 5, Steps: 35 | Train Loss: 2.417 Vali Loss: 4.917 Vali Acc: 0.500 Test Loss: 4.917 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.608402729034424
Epoch: 6, Steps: 35 | Train Loss: 2.208 Vali Loss: 3.649 Vali Acc: 0.530 Test Loss: 3.649 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.210476636886597
Epoch: 7, Steps: 35 | Train Loss: 1.500 Vali Loss: 14.389 Vali Acc: 0.460 Test Loss: 14.389 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8889968395233154
Epoch: 8, Steps: 35 | Train Loss: 1.763 Vali Loss: 8.383 Vali Acc: 0.510 Test Loss: 8.383 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.2239720821380615
Epoch: 9, Steps: 35 | Train Loss: 1.955 Vali Loss: 4.089 Vali Acc: 0.550 Test Loss: 4.089 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.181792974472046
Epoch: 10, Steps: 35 | Train Loss: 1.464 Vali Loss: 5.449 Vali Acc: 0.570 Test Loss: 5.449 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.156499147415161
Epoch: 11, Steps: 35 | Train Loss: 1.726 Vali Loss: 4.593 Vali Acc: 0.490 Test Loss: 4.593 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.404496192932129
Epoch: 12, Steps: 35 | Train Loss: 1.323 Vali Loss: 3.164 Vali Acc: 0.570 Test Loss: 3.164 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.289111614227295
Epoch: 13, Steps: 35 | Train Loss: 1.884 Vali Loss: 7.691 Vali Acc: 0.520 Test Loss: 7.691 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 496418
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.77373194694519
Epoch: 1, Steps: 35 | Train Loss: 1.150 Vali Loss: 2.314 Vali Acc: 0.480 Test Loss: 2.314 Test Acc: 0.480
Validation loss decreased (inf --> -0.479977).  Saving model ...
Epoch: 2 cost time: 3.707221508026123
Epoch: 2, Steps: 35 | Train Loss: 1.795 Vali Loss: 1.911 Vali Acc: 0.510 Test Loss: 1.911 Test Acc: 0.510
Validation loss decreased (-0.479977 --> -0.509981).  Saving model ...
Epoch: 3 cost time: 3.6820030212402344
Epoch: 3, Steps: 35 | Train Loss: 2.235 Vali Loss: 3.840 Vali Acc: 0.560 Test Loss: 3.840 Test Acc: 0.560
Validation loss decreased (-0.509981 --> -0.559962).  Saving model ...
Epoch: 4 cost time: 3.6484763622283936
Epoch: 4, Steps: 35 | Train Loss: 2.047 Vali Loss: 3.471 Vali Acc: 0.550 Test Loss: 3.471 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.646683692932129
Epoch: 5, Steps: 35 | Train Loss: 1.993 Vali Loss: 3.565 Vali Acc: 0.580 Test Loss: 3.565 Test Acc: 0.580
Validation loss decreased (-0.559962 --> -0.579964).  Saving model ...
Epoch: 6 cost time: 3.860044240951538
Epoch: 6, Steps: 35 | Train Loss: 1.434 Vali Loss: 5.046 Vali Acc: 0.450 Test Loss: 5.046 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.913904905319214
Epoch: 7, Steps: 35 | Train Loss: 2.194 Vali Loss: 10.990 Vali Acc: 0.480 Test Loss: 10.990 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.008630752563477
Epoch: 8, Steps: 35 | Train Loss: 1.266 Vali Loss: 5.397 Vali Acc: 0.560 Test Loss: 5.397 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.861720561981201
Epoch: 9, Steps: 35 | Train Loss: 2.836 Vali Loss: 5.219 Vali Acc: 0.560 Test Loss: 5.219 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.017888307571411
Epoch: 10, Steps: 35 | Train Loss: 1.544 Vali Loss: 7.955 Vali Acc: 0.370 Test Loss: 7.955 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9299190044403076
Epoch: 11, Steps: 35 | Train Loss: 1.985 Vali Loss: 7.195 Vali Acc: 0.450 Test Loss: 7.195 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.262293815612793
Epoch: 12, Steps: 35 | Train Loss: 1.292 Vali Loss: 5.724 Vali Acc: 0.500 Test Loss: 5.724 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.160148859024048
Epoch: 13, Steps: 35 | Train Loss: 1.341 Vali Loss: 6.504 Vali Acc: 0.520 Test Loss: 6.504 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.064237117767334
Epoch: 14, Steps: 35 | Train Loss: 1.535 Vali Loss: 9.010 Vali Acc: 0.490 Test Loss: 9.010 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.901883602142334
Epoch: 15, Steps: 35 | Train Loss: 1.407 Vali Loss: 13.381 Vali Acc: 0.540 Test Loss: 13.381 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 496418
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.530353307723999
Epoch: 1, Steps: 35 | Train Loss: 1.242 Vali Loss: 3.301 Vali Acc: 0.480 Test Loss: 3.301 Test Acc: 0.480
Validation loss decreased (inf --> -0.479967).  Saving model ...
Epoch: 2 cost time: 3.8137447834014893
Epoch: 2, Steps: 35 | Train Loss: 2.137 Vali Loss: 3.188 Vali Acc: 0.500 Test Loss: 3.188 Test Acc: 0.500
Validation loss decreased (-0.479967 --> -0.499968).  Saving model ...
Epoch: 3 cost time: 4.217759609222412
Epoch: 3, Steps: 35 | Train Loss: 1.328 Vali Loss: 5.635 Vali Acc: 0.500 Test Loss: 5.635 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.08254337310791
Epoch: 4, Steps: 35 | Train Loss: 2.959 Vali Loss: 3.797 Vali Acc: 0.610 Test Loss: 3.797 Test Acc: 0.610
Validation loss decreased (-0.499968 --> -0.609962).  Saving model ...
Epoch: 5 cost time: 4.544615983963013
Epoch: 5, Steps: 35 | Train Loss: 2.751 Vali Loss: 2.399 Vali Acc: 0.570 Test Loss: 2.399 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.780730485916138
Epoch: 6, Steps: 35 | Train Loss: 1.515 Vali Loss: 3.533 Vali Acc: 0.600 Test Loss: 3.533 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.219080686569214
Epoch: 7, Steps: 35 | Train Loss: 1.600 Vali Loss: 8.344 Vali Acc: 0.480 Test Loss: 8.344 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.318742752075195
Epoch: 8, Steps: 35 | Train Loss: 1.816 Vali Loss: 5.723 Vali Acc: 0.470 Test Loss: 5.723 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.183373928070068
Epoch: 9, Steps: 35 | Train Loss: 1.455 Vali Loss: 3.761 Vali Acc: 0.540 Test Loss: 3.761 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8577024936676025
Epoch: 10, Steps: 35 | Train Loss: 1.608 Vali Loss: 8.970 Vali Acc: 0.480 Test Loss: 8.970 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.728236436843872
Epoch: 11, Steps: 35 | Train Loss: 1.041 Vali Loss: 3.434 Vali Acc: 0.580 Test Loss: 3.434 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.063297510147095
Epoch: 12, Steps: 35 | Train Loss: 2.196 Vali Loss: 3.895 Vali Acc: 0.510 Test Loss: 3.895 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.8533098697662354
Epoch: 13, Steps: 35 | Train Loss: 2.802 Vali Loss: 6.021 Vali Acc: 0.530 Test Loss: 6.021 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9091532230377197
Epoch: 14, Steps: 35 | Train Loss: 1.754 Vali Loss: 7.809 Vali Acc: 0.550 Test Loss: 7.809 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 496418
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.214242458343506
Epoch: 1, Steps: 35 | Train Loss: 1.276 Vali Loss: 1.755 Vali Acc: 0.500 Test Loss: 1.755 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 4.102730751037598
Epoch: 2, Steps: 35 | Train Loss: 1.343 Vali Loss: 1.451 Vali Acc: 0.500 Test Loss: 1.451 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 4.386687278747559
Epoch: 3, Steps: 35 | Train Loss: 2.023 Vali Loss: 2.847 Vali Acc: 0.520 Test Loss: 2.847 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519972).  Saving model ...
Epoch: 4 cost time: 4.169787168502808
Epoch: 4, Steps: 35 | Train Loss: 2.033 Vali Loss: 2.997 Vali Acc: 0.520 Test Loss: 2.997 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0734703540802
Epoch: 5, Steps: 35 | Train Loss: 2.019 Vali Loss: 5.985 Vali Acc: 0.470 Test Loss: 5.985 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.00687575340271
Epoch: 6, Steps: 35 | Train Loss: 2.007 Vali Loss: 2.306 Vali Acc: 0.530 Test Loss: 2.306 Test Acc: 0.530
Validation loss decreased (-0.519972 --> -0.529977).  Saving model ...
Epoch: 7 cost time: 4.205174922943115
Epoch: 7, Steps: 35 | Train Loss: 1.550 Vali Loss: 2.465 Vali Acc: 0.490 Test Loss: 2.465 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.2238969802856445
Epoch: 8, Steps: 35 | Train Loss: 2.513 Vali Loss: 4.132 Vali Acc: 0.550 Test Loss: 4.132 Test Acc: 0.550
Validation loss decreased (-0.529977 --> -0.549959).  Saving model ...
Epoch: 9 cost time: 4.130342483520508
Epoch: 9, Steps: 35 | Train Loss: 1.831 Vali Loss: 18.225 Vali Acc: 0.500 Test Loss: 18.225 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.965898275375366
Epoch: 10, Steps: 35 | Train Loss: 2.993 Vali Loss: 5.789 Vali Acc: 0.490 Test Loss: 5.789 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9031684398651123
Epoch: 11, Steps: 35 | Train Loss: 1.324 Vali Loss: 7.399 Vali Acc: 0.540 Test Loss: 7.399 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.394176244735718
Epoch: 12, Steps: 35 | Train Loss: 0.687 Vali Loss: 5.181 Vali Acc: 0.450 Test Loss: 5.181 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.219980239868164
Epoch: 13, Steps: 35 | Train Loss: 0.897 Vali Loss: 14.297 Vali Acc: 0.500 Test Loss: 14.297 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.959545135498047
Epoch: 14, Steps: 35 | Train Loss: 1.245 Vali Loss: 13.408 Vali Acc: 0.510 Test Loss: 13.408 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.120731592178345
Epoch: 15, Steps: 35 | Train Loss: 1.123 Vali Loss: 6.416 Vali Acc: 0.500 Test Loss: 6.416 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.410104990005493
Epoch: 16, Steps: 35 | Train Loss: 1.807 Vali Loss: 6.635 Vali Acc: 0.480 Test Loss: 6.635 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.768014669418335
Epoch: 17, Steps: 35 | Train Loss: 1.200 Vali Loss: 14.755 Vali Acc: 0.500 Test Loss: 14.755 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.521692991256714
Epoch: 18, Steps: 35 | Train Loss: 0.735 Vali Loss: 7.069 Vali Acc: 0.540 Test Loss: 7.069 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 463650
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.535264730453491
Epoch: 1, Steps: 35 | Train Loss: 1.343 Vali Loss: 1.925 Vali Acc: 0.470 Test Loss: 1.925 Test Acc: 0.470
Validation loss decreased (inf --> -0.469981).  Saving model ...
Epoch: 2 cost time: 4.0493011474609375
Epoch: 2, Steps: 35 | Train Loss: 1.624 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
Validation loss decreased (-0.469981 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 4.26775050163269
Epoch: 3, Steps: 35 | Train Loss: 2.128 Vali Loss: 4.448 Vali Acc: 0.500 Test Loss: 4.448 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.198642015457153
Epoch: 4, Steps: 35 | Train Loss: 1.874 Vali Loss: 2.529 Vali Acc: 0.460 Test Loss: 2.529 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.392857074737549
Epoch: 5, Steps: 35 | Train Loss: 1.914 Vali Loss: 2.321 Vali Acc: 0.520 Test Loss: 2.321 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519977).  Saving model ...
Epoch: 6 cost time: 4.090660095214844
Epoch: 6, Steps: 35 | Train Loss: 1.817 Vali Loss: 3.029 Vali Acc: 0.460 Test Loss: 3.029 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9343862533569336
Epoch: 7, Steps: 35 | Train Loss: 3.354 Vali Loss: 6.907 Vali Acc: 0.480 Test Loss: 6.907 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.062924861907959
Epoch: 8, Steps: 35 | Train Loss: 2.913 Vali Loss: 5.816 Vali Acc: 0.510 Test Loss: 5.816 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.4243152141571045
Epoch: 9, Steps: 35 | Train Loss: 2.119 Vali Loss: 9.340 Vali Acc: 0.480 Test Loss: 9.340 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9821252822875977
Epoch: 10, Steps: 35 | Train Loss: 2.003 Vali Loss: 9.512 Vali Acc: 0.490 Test Loss: 9.512 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.347212076187134
Epoch: 11, Steps: 35 | Train Loss: 1.129 Vali Loss: 7.407 Vali Acc: 0.520 Test Loss: 7.407 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.52032732963562
Epoch: 12, Steps: 35 | Train Loss: 1.447 Vali Loss: 4.735 Vali Acc: 0.510 Test Loss: 4.735 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.202322959899902
Epoch: 13, Steps: 35 | Train Loss: 0.630 Vali Loss: 3.809 Vali Acc: 0.500 Test Loss: 3.809 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.098931074142456
Epoch: 14, Steps: 35 | Train Loss: 1.320 Vali Loss: 10.323 Vali Acc: 0.540 Test Loss: 10.323 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539897).  Saving model ...
Epoch: 15 cost time: 4.447758913040161
Epoch: 15, Steps: 35 | Train Loss: 1.331 Vali Loss: 9.978 Vali Acc: 0.510 Test Loss: 9.978 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.445574760437012
Epoch: 16, Steps: 35 | Train Loss: 1.295 Vali Loss: 9.331 Vali Acc: 0.480 Test Loss: 9.331 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.576761245727539
Epoch: 17, Steps: 35 | Train Loss: 0.969 Vali Loss: 6.927 Vali Acc: 0.550 Test Loss: 6.927 Test Acc: 0.550
Validation loss decreased (-0.539897 --> -0.549931).  Saving model ...
Epoch: 18 cost time: 4.441957235336304
Epoch: 18, Steps: 35 | Train Loss: 1.227 Vali Loss: 12.029 Vali Acc: 0.570 Test Loss: 12.029 Test Acc: 0.570
Validation loss decreased (-0.549931 --> -0.569880).  Saving model ...
Epoch: 19 cost time: 4.5568811893463135
Epoch: 19, Steps: 35 | Train Loss: 0.721 Vali Loss: 8.078 Vali Acc: 0.540 Test Loss: 8.078 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.553565502166748
Epoch: 20, Steps: 35 | Train Loss: 0.904 Vali Loss: 6.657 Vali Acc: 0.630 Test Loss: 6.657 Test Acc: 0.630
Validation loss decreased (-0.569880 --> -0.629933).  Saving model ...
Epoch: 21 cost time: 4.113241195678711
Epoch: 21, Steps: 35 | Train Loss: 0.404 Vali Loss: 10.285 Vali Acc: 0.570 Test Loss: 10.285 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.057057857513428
Epoch: 22, Steps: 35 | Train Loss: 0.997 Vali Loss: 5.199 Vali Acc: 0.470 Test Loss: 5.199 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.103085279464722
Epoch: 23, Steps: 35 | Train Loss: 0.492 Vali Loss: 8.857 Vali Acc: 0.490 Test Loss: 8.857 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.5169806480407715
Epoch: 24, Steps: 35 | Train Loss: 0.487 Vali Loss: 8.351 Vali Acc: 0.490 Test Loss: 8.351 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.026822328567505
Epoch: 25, Steps: 35 | Train Loss: 0.671 Vali Loss: 13.980 Vali Acc: 0.460 Test Loss: 13.980 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.165834665298462
Epoch: 26, Steps: 35 | Train Loss: 0.419 Vali Loss: 10.079 Vali Acc: 0.520 Test Loss: 10.079 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.115897178649902
Epoch: 27, Steps: 35 | Train Loss: 0.570 Vali Loss: 9.623 Vali Acc: 0.440 Test Loss: 9.623 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.421640634536743
Epoch: 28, Steps: 35 | Train Loss: 0.513 Vali Loss: 18.873 Vali Acc: 0.490 Test Loss: 18.873 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.207892417907715
Epoch: 29, Steps: 35 | Train Loss: 0.624 Vali Loss: 17.364 Vali Acc: 0.490 Test Loss: 17.364 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.199257135391235
Epoch: 30, Steps: 35 | Train Loss: 0.911 Vali Loss: 14.483 Vali Acc: 0.500 Test Loss: 14.483 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 463650
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.914976596832275
Epoch: 1, Steps: 35 | Train Loss: 1.272 Vali Loss: 2.165 Vali Acc: 0.480 Test Loss: 2.165 Test Acc: 0.480
Validation loss decreased (inf --> -0.479978).  Saving model ...
Epoch: 2 cost time: 4.080556631088257
Epoch: 2, Steps: 35 | Train Loss: 2.171 Vali Loss: 3.558 Vali Acc: 0.490 Test Loss: 3.558 Test Acc: 0.490
Validation loss decreased (-0.479978 --> -0.489964).  Saving model ...
Epoch: 3 cost time: 4.074204921722412
Epoch: 3, Steps: 35 | Train Loss: 2.853 Vali Loss: 2.210 Vali Acc: 0.530 Test Loss: 2.210 Test Acc: 0.530
Validation loss decreased (-0.489964 --> -0.529978).  Saving model ...
Epoch: 4 cost time: 4.220709562301636
Epoch: 4, Steps: 35 | Train Loss: 2.194 Vali Loss: 1.769 Vali Acc: 0.560 Test Loss: 1.769 Test Acc: 0.560
Validation loss decreased (-0.529978 --> -0.559982).  Saving model ...
Epoch: 5 cost time: 4.0643651485443115
Epoch: 5, Steps: 35 | Train Loss: 2.068 Vali Loss: 3.815 Vali Acc: 0.550 Test Loss: 3.815 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.036625623703003
Epoch: 6, Steps: 35 | Train Loss: 1.429 Vali Loss: 4.223 Vali Acc: 0.500 Test Loss: 4.223 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.246148586273193
Epoch: 7, Steps: 35 | Train Loss: 3.327 Vali Loss: 3.488 Vali Acc: 0.490 Test Loss: 3.488 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.116899013519287
Epoch: 8, Steps: 35 | Train Loss: 1.682 Vali Loss: 4.502 Vali Acc: 0.430 Test Loss: 4.502 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.392261981964111
Epoch: 9, Steps: 35 | Train Loss: 1.884 Vali Loss: 4.535 Vali Acc: 0.500 Test Loss: 4.535 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.458858013153076
Epoch: 10, Steps: 35 | Train Loss: 1.390 Vali Loss: 7.061 Vali Acc: 0.470 Test Loss: 7.061 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.09539532661438
Epoch: 11, Steps: 35 | Train Loss: 2.488 Vali Loss: 7.927 Vali Acc: 0.450 Test Loss: 7.927 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.220660209655762
Epoch: 12, Steps: 35 | Train Loss: 1.283 Vali Loss: 6.013 Vali Acc: 0.550 Test Loss: 6.013 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.110903739929199
Epoch: 13, Steps: 35 | Train Loss: 1.826 Vali Loss: 7.846 Vali Acc: 0.510 Test Loss: 7.846 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.397303819656372
Epoch: 14, Steps: 35 | Train Loss: 1.108 Vali Loss: 7.928 Vali Acc: 0.470 Test Loss: 7.928 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 463650
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.579894542694092
Epoch: 1, Steps: 35 | Train Loss: 1.296 Vali Loss: 1.652 Vali Acc: 0.530 Test Loss: 1.652 Test Acc: 0.530
Validation loss decreased (inf --> -0.529983).  Saving model ...
Epoch: 2 cost time: 3.998601198196411
Epoch: 2, Steps: 35 | Train Loss: 2.037 Vali Loss: 1.812 Vali Acc: 0.490 Test Loss: 1.812 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.243835926055908
Epoch: 3, Steps: 35 | Train Loss: 2.562 Vali Loss: 2.939 Vali Acc: 0.570 Test Loss: 2.939 Test Acc: 0.570
Validation loss decreased (-0.529983 --> -0.569971).  Saving model ...
Epoch: 4 cost time: 3.8331491947174072
Epoch: 4, Steps: 35 | Train Loss: 3.282 Vali Loss: 1.969 Vali Acc: 0.600 Test Loss: 1.969 Test Acc: 0.600
Validation loss decreased (-0.569971 --> -0.599980).  Saving model ...
Epoch: 5 cost time: 3.755995035171509
Epoch: 5, Steps: 35 | Train Loss: 1.164 Vali Loss: 4.439 Vali Acc: 0.510 Test Loss: 4.439 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8125953674316406
Epoch: 6, Steps: 35 | Train Loss: 1.612 Vali Loss: 3.325 Vali Acc: 0.480 Test Loss: 3.325 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.028469085693359
Epoch: 7, Steps: 35 | Train Loss: 2.827 Vali Loss: 2.425 Vali Acc: 0.560 Test Loss: 2.425 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.100677967071533
Epoch: 8, Steps: 35 | Train Loss: 1.913 Vali Loss: 7.716 Vali Acc: 0.500 Test Loss: 7.716 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.839452028274536
Epoch: 9, Steps: 35 | Train Loss: 2.484 Vali Loss: 5.085 Vali Acc: 0.540 Test Loss: 5.085 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.86354398727417
Epoch: 10, Steps: 35 | Train Loss: 1.527 Vali Loss: 7.081 Vali Acc: 0.480 Test Loss: 7.081 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.105687379837036
Epoch: 11, Steps: 35 | Train Loss: 1.440 Vali Loss: 5.504 Vali Acc: 0.510 Test Loss: 5.504 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9763894081115723
Epoch: 12, Steps: 35 | Train Loss: 0.982 Vali Loss: 3.294 Vali Acc: 0.530 Test Loss: 3.294 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.9486119747161865
Epoch: 13, Steps: 35 | Train Loss: 1.858 Vali Loss: 4.338 Vali Acc: 0.600 Test Loss: 4.338 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.84039306640625
Epoch: 14, Steps: 35 | Train Loss: 1.090 Vali Loss: 3.754 Vali Acc: 0.580 Test Loss: 3.754 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 463650
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.257434844970703
Epoch: 1, Steps: 35 | Train Loss: 1.717 Vali Loss: 1.877 Vali Acc: 0.590 Test Loss: 1.877 Test Acc: 0.590
Validation loss decreased (inf --> -0.589981).  Saving model ...
Epoch: 2 cost time: 4.171032667160034
Epoch: 2, Steps: 35 | Train Loss: 2.357 Vali Loss: 2.792 Vali Acc: 0.460 Test Loss: 2.792 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.308999300003052
Epoch: 3, Steps: 35 | Train Loss: 2.126 Vali Loss: 3.144 Vali Acc: 0.540 Test Loss: 3.144 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.174798011779785
Epoch: 4, Steps: 35 | Train Loss: 3.060 Vali Loss: 4.467 Vali Acc: 0.480 Test Loss: 4.467 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.375978946685791
Epoch: 5, Steps: 35 | Train Loss: 3.087 Vali Loss: 4.545 Vali Acc: 0.570 Test Loss: 4.545 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.5681538581848145
Epoch: 6, Steps: 35 | Train Loss: 1.877 Vali Loss: 3.498 Vali Acc: 0.530 Test Loss: 3.498 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.318881988525391
Epoch: 7, Steps: 35 | Train Loss: 1.655 Vali Loss: 10.024 Vali Acc: 0.570 Test Loss: 10.024 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.6226677894592285
Epoch: 8, Steps: 35 | Train Loss: 1.933 Vali Loss: 3.521 Vali Acc: 0.490 Test Loss: 3.521 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.466061115264893
Epoch: 9, Steps: 35 | Train Loss: 1.453 Vali Loss: 12.213 Vali Acc: 0.500 Test Loss: 12.213 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.412390470504761
Epoch: 10, Steps: 35 | Train Loss: 2.492 Vali Loss: 6.282 Vali Acc: 0.530 Test Loss: 6.282 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.484532594680786
Epoch: 11, Steps: 35 | Train Loss: 1.982 Vali Loss: 12.247 Vali Acc: 0.470 Test Loss: 12.247 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 447266
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.917684078216553
Epoch: 1, Steps: 35 | Train Loss: 1.562 Vali Loss: 1.714 Vali Acc: 0.600 Test Loss: 1.714 Test Acc: 0.600
Validation loss decreased (inf --> -0.599983).  Saving model ...
Epoch: 2 cost time: 3.91866135597229
Epoch: 2, Steps: 35 | Train Loss: 1.672 Vali Loss: 1.399 Vali Acc: 0.530 Test Loss: 1.399 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.523015022277832
Epoch: 3, Steps: 35 | Train Loss: 2.608 Vali Loss: 8.340 Vali Acc: 0.500 Test Loss: 8.340 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.2975335121154785
Epoch: 4, Steps: 35 | Train Loss: 3.898 Vali Loss: 4.315 Vali Acc: 0.500 Test Loss: 4.315 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.4149980545043945
Epoch: 5, Steps: 35 | Train Loss: 2.224 Vali Loss: 4.119 Vali Acc: 0.430 Test Loss: 4.119 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.133857011795044
Epoch: 6, Steps: 35 | Train Loss: 1.938 Vali Loss: 4.388 Vali Acc: 0.490 Test Loss: 4.388 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.493854522705078
Epoch: 7, Steps: 35 | Train Loss: 1.835 Vali Loss: 7.688 Vali Acc: 0.560 Test Loss: 7.688 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.317272424697876
Epoch: 8, Steps: 35 | Train Loss: 1.997 Vali Loss: 3.691 Vali Acc: 0.480 Test Loss: 3.691 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.263080835342407
Epoch: 9, Steps: 35 | Train Loss: 1.822 Vali Loss: 18.590 Vali Acc: 0.500 Test Loss: 18.590 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.289365530014038
Epoch: 10, Steps: 35 | Train Loss: 2.504 Vali Loss: 7.775 Vali Acc: 0.570 Test Loss: 7.775 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.413091659545898
Epoch: 11, Steps: 35 | Train Loss: 1.854 Vali Loss: 10.566 Vali Acc: 0.560 Test Loss: 10.566 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 447266
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.915785312652588
Epoch: 1, Steps: 35 | Train Loss: 1.491 Vali Loss: 1.689 Vali Acc: 0.620 Test Loss: 1.689 Test Acc: 0.620
Validation loss decreased (inf --> -0.619983).  Saving model ...
Epoch: 2 cost time: 4.124996185302734
Epoch: 2, Steps: 35 | Train Loss: 1.704 Vali Loss: 1.521 Vali Acc: 0.510 Test Loss: 1.521 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9934988021850586
Epoch: 3, Steps: 35 | Train Loss: 2.125 Vali Loss: 2.377 Vali Acc: 0.560 Test Loss: 2.377 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9931414127349854
Epoch: 4, Steps: 35 | Train Loss: 2.868 Vali Loss: 6.034 Vali Acc: 0.420 Test Loss: 6.034 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.048621654510498
Epoch: 5, Steps: 35 | Train Loss: 2.081 Vali Loss: 3.794 Vali Acc: 0.450 Test Loss: 3.794 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.358333110809326
Epoch: 6, Steps: 35 | Train Loss: 2.482 Vali Loss: 5.161 Vali Acc: 0.520 Test Loss: 5.161 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.732653379440308
Epoch: 7, Steps: 35 | Train Loss: 1.506 Vali Loss: 2.623 Vali Acc: 0.550 Test Loss: 2.623 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.786492347717285
Epoch: 8, Steps: 35 | Train Loss: 1.208 Vali Loss: 5.751 Vali Acc: 0.520 Test Loss: 5.751 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.610671043395996
Epoch: 9, Steps: 35 | Train Loss: 0.840 Vali Loss: 4.154 Vali Acc: 0.490 Test Loss: 4.154 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.350566864013672
Epoch: 10, Steps: 35 | Train Loss: 1.027 Vali Loss: 5.913 Vali Acc: 0.550 Test Loss: 5.913 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.489711761474609
Epoch: 11, Steps: 35 | Train Loss: 1.533 Vali Loss: 5.342 Vali Acc: 0.440 Test Loss: 5.342 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 447266
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.605569839477539
Epoch: 1, Steps: 35 | Train Loss: 1.412 Vali Loss: 1.550 Vali Acc: 0.600 Test Loss: 1.550 Test Acc: 0.600
Validation loss decreased (inf --> -0.599985).  Saving model ...
Epoch: 2 cost time: 3.487431764602661
Epoch: 2, Steps: 35 | Train Loss: 1.890 Vali Loss: 1.492 Vali Acc: 0.570 Test Loss: 1.492 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.585486650466919
Epoch: 3, Steps: 35 | Train Loss: 2.331 Vali Loss: 2.865 Vali Acc: 0.460 Test Loss: 2.865 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.627516746520996
Epoch: 4, Steps: 35 | Train Loss: 1.493 Vali Loss: 3.802 Vali Acc: 0.510 Test Loss: 3.802 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9447920322418213
Epoch: 5, Steps: 35 | Train Loss: 1.822 Vali Loss: 5.063 Vali Acc: 0.420 Test Loss: 5.063 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.562642812728882
Epoch: 6, Steps: 35 | Train Loss: 1.878 Vali Loss: 6.208 Vali Acc: 0.540 Test Loss: 6.208 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.499873161315918
Epoch: 7, Steps: 35 | Train Loss: 2.766 Vali Loss: 4.013 Vali Acc: 0.580 Test Loss: 4.013 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.02592396736145
Epoch: 8, Steps: 35 | Train Loss: 1.986 Vali Loss: 3.978 Vali Acc: 0.580 Test Loss: 3.978 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9339027404785156
Epoch: 9, Steps: 35 | Train Loss: 2.692 Vali Loss: 9.097 Vali Acc: 0.500 Test Loss: 9.097 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.082123041152954
Epoch: 10, Steps: 35 | Train Loss: 3.109 Vali Loss: 4.900 Vali Acc: 0.570 Test Loss: 4.900 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.7659554481506348
Epoch: 11, Steps: 35 | Train Loss: 1.909 Vali Loss: 4.522 Vali Acc: 0.520 Test Loss: 4.522 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 447266
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.055169343948364
Epoch: 1, Steps: 35 | Train Loss: 1.346 Vali Loss: 1.149 Vali Acc: 0.510 Test Loss: 1.149 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 3.886652708053589
Epoch: 2, Steps: 35 | Train Loss: 1.051 Vali Loss: 1.066 Vali Acc: 0.550 Test Loss: 1.066 Test Acc: 0.550
Validation loss decreased (-0.509989 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 4.061108350753784
Epoch: 3, Steps: 35 | Train Loss: 1.150 Vali Loss: 5.011 Vali Acc: 0.500 Test Loss: 5.011 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.417405128479004
Epoch: 4, Steps: 35 | Train Loss: 1.467 Vali Loss: 1.667 Vali Acc: 0.560 Test Loss: 1.667 Test Acc: 0.560
Validation loss decreased (-0.549989 --> -0.559983).  Saving model ...
Epoch: 5 cost time: 4.573477029800415
Epoch: 5, Steps: 35 | Train Loss: 0.971 Vali Loss: 4.385 Vali Acc: 0.470 Test Loss: 4.385 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.953037738800049
Epoch: 6, Steps: 35 | Train Loss: 0.969 Vali Loss: 1.733 Vali Acc: 0.590 Test Loss: 1.733 Test Acc: 0.590
Validation loss decreased (-0.559983 --> -0.589983).  Saving model ...
Epoch: 7 cost time: 3.873828411102295
Epoch: 7, Steps: 35 | Train Loss: 0.909 Vali Loss: 1.450 Vali Acc: 0.500 Test Loss: 1.450 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.08105993270874
Epoch: 8, Steps: 35 | Train Loss: 1.326 Vali Loss: 2.308 Vali Acc: 0.430 Test Loss: 2.308 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9300074577331543
Epoch: 9, Steps: 35 | Train Loss: 1.059 Vali Loss: 1.957 Vali Acc: 0.520 Test Loss: 1.957 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8754076957702637
Epoch: 10, Steps: 35 | Train Loss: 1.106 Vali Loss: 1.968 Vali Acc: 0.530 Test Loss: 1.968 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.801858425140381
Epoch: 11, Steps: 35 | Train Loss: 1.105 Vali Loss: 7.974 Vali Acc: 0.500 Test Loss: 7.974 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.955404281616211
Epoch: 12, Steps: 35 | Train Loss: 1.434 Vali Loss: 2.906 Vali Acc: 0.530 Test Loss: 2.906 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.074875354766846
Epoch: 13, Steps: 35 | Train Loss: 0.823 Vali Loss: 6.482 Vali Acc: 0.510 Test Loss: 6.482 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.073990345001221
Epoch: 14, Steps: 35 | Train Loss: 1.082 Vali Loss: 3.245 Vali Acc: 0.480 Test Loss: 3.245 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.404458045959473
Epoch: 15, Steps: 35 | Train Loss: 1.096 Vali Loss: 2.954 Vali Acc: 0.540 Test Loss: 2.954 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.316442489624023
Epoch: 16, Steps: 35 | Train Loss: 0.505 Vali Loss: 4.148 Vali Acc: 0.550 Test Loss: 4.148 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 473762
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.772993564605713
Epoch: 1, Steps: 35 | Train Loss: 1.298 Vali Loss: 1.253 Vali Acc: 0.490 Test Loss: 1.253 Test Acc: 0.490
Validation loss decreased (inf --> -0.489987).  Saving model ...
Epoch: 2 cost time: 4.085478782653809
Epoch: 2, Steps: 35 | Train Loss: 0.992 Vali Loss: 0.931 Vali Acc: 0.520 Test Loss: 0.931 Test Acc: 0.520
Validation loss decreased (-0.489987 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 3.924032688140869
Epoch: 3, Steps: 35 | Train Loss: 0.957 Vali Loss: 2.229 Vali Acc: 0.560 Test Loss: 2.229 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559978).  Saving model ...
Epoch: 4 cost time: 3.8465564250946045
Epoch: 4, Steps: 35 | Train Loss: 1.245 Vali Loss: 1.066 Vali Acc: 0.510 Test Loss: 1.066 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.97623348236084
Epoch: 5, Steps: 35 | Train Loss: 1.142 Vali Loss: 2.102 Vali Acc: 0.520 Test Loss: 2.102 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9191622734069824
Epoch: 6, Steps: 35 | Train Loss: 1.147 Vali Loss: 1.820 Vali Acc: 0.490 Test Loss: 1.820 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6804251670837402
Epoch: 7, Steps: 35 | Train Loss: 0.766 Vali Loss: 1.987 Vali Acc: 0.530 Test Loss: 1.987 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.942570686340332
Epoch: 8, Steps: 35 | Train Loss: 0.844 Vali Loss: 2.372 Vali Acc: 0.530 Test Loss: 2.372 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.074453830718994
Epoch: 9, Steps: 35 | Train Loss: 1.000 Vali Loss: 1.953 Vali Acc: 0.500 Test Loss: 1.953 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.406062364578247
Epoch: 10, Steps: 35 | Train Loss: 0.701 Vali Loss: 2.479 Vali Acc: 0.530 Test Loss: 2.479 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.781362295150757
Epoch: 11, Steps: 35 | Train Loss: 0.858 Vali Loss: 4.018 Vali Acc: 0.540 Test Loss: 4.018 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.130944013595581
Epoch: 12, Steps: 35 | Train Loss: 0.678 Vali Loss: 3.101 Vali Acc: 0.530 Test Loss: 3.101 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.2229743003845215
Epoch: 13, Steps: 35 | Train Loss: 0.807 Vali Loss: 5.597 Vali Acc: 0.490 Test Loss: 5.597 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 473762
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.171739816665649
Epoch: 1, Steps: 35 | Train Loss: 1.220 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 3.8284683227539062
Epoch: 2, Steps: 35 | Train Loss: 1.026 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 3.9424827098846436
Epoch: 3, Steps: 35 | Train Loss: 0.888 Vali Loss: 2.812 Vali Acc: 0.500 Test Loss: 2.812 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.312361240386963
Epoch: 4, Steps: 35 | Train Loss: 0.866 Vali Loss: 1.264 Vali Acc: 0.470 Test Loss: 1.264 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.770056962966919
Epoch: 5, Steps: 35 | Train Loss: 1.084 Vali Loss: 1.653 Vali Acc: 0.510 Test Loss: 1.653 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7953569889068604
Epoch: 6, Steps: 35 | Train Loss: 0.890 Vali Loss: 1.778 Vali Acc: 0.520 Test Loss: 1.778 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.557461977005005
Epoch: 7, Steps: 35 | Train Loss: 1.874 Vali Loss: 3.031 Vali Acc: 0.500 Test Loss: 3.031 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8964943885803223
Epoch: 8, Steps: 35 | Train Loss: 1.194 Vali Loss: 3.691 Vali Acc: 0.470 Test Loss: 3.691 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.019051790237427
Epoch: 9, Steps: 35 | Train Loss: 1.219 Vali Loss: 3.089 Vali Acc: 0.540 Test Loss: 3.089 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539969).  Saving model ...
Epoch: 10 cost time: 4.049253940582275
Epoch: 10, Steps: 35 | Train Loss: 1.362 Vali Loss: 3.775 Vali Acc: 0.420 Test Loss: 3.775 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9385123252868652
Epoch: 11, Steps: 35 | Train Loss: 1.294 Vali Loss: 3.327 Vali Acc: 0.450 Test Loss: 3.327 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.1636879444122314
Epoch: 12, Steps: 35 | Train Loss: 1.166 Vali Loss: 3.099 Vali Acc: 0.450 Test Loss: 3.099 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.365821838378906
Epoch: 13, Steps: 35 | Train Loss: 0.748 Vali Loss: 3.800 Vali Acc: 0.480 Test Loss: 3.800 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.975451707839966
Epoch: 14, Steps: 35 | Train Loss: 1.234 Vali Loss: 3.639 Vali Acc: 0.500 Test Loss: 3.639 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.203016996383667
Epoch: 15, Steps: 35 | Train Loss: 1.311 Vali Loss: 3.420 Vali Acc: 0.530 Test Loss: 3.420 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.013415336608887
Epoch: 16, Steps: 35 | Train Loss: 0.848 Vali Loss: 8.876 Vali Acc: 0.490 Test Loss: 8.876 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.317277908325195
Epoch: 17, Steps: 35 | Train Loss: 1.955 Vali Loss: 6.127 Vali Acc: 0.510 Test Loss: 6.127 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.0767951011657715
Epoch: 18, Steps: 35 | Train Loss: 0.962 Vali Loss: 3.829 Vali Acc: 0.500 Test Loss: 3.829 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.861175775527954
Epoch: 19, Steps: 35 | Train Loss: 0.808 Vali Loss: 5.445 Vali Acc: 0.450 Test Loss: 5.445 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 473762
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.86103630065918
Epoch: 1, Steps: 35 | Train Loss: 1.095 Vali Loss: 1.121 Vali Acc: 0.480 Test Loss: 1.121 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 3.729055881500244
Epoch: 2, Steps: 35 | Train Loss: 0.997 Vali Loss: 1.226 Vali Acc: 0.580 Test Loss: 1.226 Test Acc: 0.580
Validation loss decreased (-0.479989 --> -0.579988).  Saving model ...
Epoch: 3 cost time: 4.175221920013428
Epoch: 3, Steps: 35 | Train Loss: 0.811 Vali Loss: 2.492 Vali Acc: 0.550 Test Loss: 2.492 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.185735464096069
Epoch: 4, Steps: 35 | Train Loss: 1.639 Vali Loss: 3.818 Vali Acc: 0.500 Test Loss: 3.818 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.232374429702759
Epoch: 5, Steps: 35 | Train Loss: 1.186 Vali Loss: 1.912 Vali Acc: 0.530 Test Loss: 1.912 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.132059335708618
Epoch: 6, Steps: 35 | Train Loss: 0.870 Vali Loss: 1.343 Vali Acc: 0.550 Test Loss: 1.343 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.092167854309082
Epoch: 7, Steps: 35 | Train Loss: 1.205 Vali Loss: 4.877 Vali Acc: 0.530 Test Loss: 4.877 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.380736589431763
Epoch: 8, Steps: 35 | Train Loss: 1.542 Vali Loss: 2.909 Vali Acc: 0.540 Test Loss: 2.909 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.104535818099976
Epoch: 9, Steps: 35 | Train Loss: 1.069 Vali Loss: 3.692 Vali Acc: 0.470 Test Loss: 3.692 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.093216180801392
Epoch: 10, Steps: 35 | Train Loss: 1.640 Vali Loss: 4.787 Vali Acc: 0.490 Test Loss: 4.787 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.213735580444336
Epoch: 11, Steps: 35 | Train Loss: 0.943 Vali Loss: 2.782 Vali Acc: 0.530 Test Loss: 2.782 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.519214391708374
Epoch: 12, Steps: 35 | Train Loss: 1.630 Vali Loss: 2.415 Vali Acc: 0.520 Test Loss: 2.415 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 473762
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.709840536117554
Epoch: 1, Steps: 35 | Train Loss: 1.138 Vali Loss: 1.087 Vali Acc: 0.430 Test Loss: 1.087 Test Acc: 0.430
Validation loss decreased (inf --> -0.429989).  Saving model ...
Epoch: 2 cost time: 3.671771764755249
Epoch: 2, Steps: 35 | Train Loss: 1.207 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.429989 --> -0.479987).  Saving model ...
Epoch: 3 cost time: 3.8610422611236572
Epoch: 3, Steps: 35 | Train Loss: 0.931 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
Validation loss decreased (-0.479987 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 3.913409948348999
Epoch: 4, Steps: 35 | Train Loss: 1.446 Vali Loss: 1.861 Vali Acc: 0.480 Test Loss: 1.861 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.958780288696289
Epoch: 5, Steps: 35 | Train Loss: 0.855 Vali Loss: 1.661 Vali Acc: 0.400 Test Loss: 1.661 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.159009218215942
Epoch: 6, Steps: 35 | Train Loss: 0.700 Vali Loss: 1.449 Vali Acc: 0.520 Test Loss: 1.449 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.950765609741211
Epoch: 7, Steps: 35 | Train Loss: 0.567 Vali Loss: 2.332 Vali Acc: 0.450 Test Loss: 2.332 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.910902976989746
Epoch: 8, Steps: 35 | Train Loss: 1.070 Vali Loss: 2.922 Vali Acc: 0.470 Test Loss: 2.922 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.924818992614746
Epoch: 9, Steps: 35 | Train Loss: 0.635 Vali Loss: 1.973 Vali Acc: 0.580 Test Loss: 1.973 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579980).  Saving model ...
Epoch: 10 cost time: 3.9665119647979736
Epoch: 10, Steps: 35 | Train Loss: 0.527 Vali Loss: 4.447 Vali Acc: 0.540 Test Loss: 4.447 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9732449054718018
Epoch: 11, Steps: 35 | Train Loss: 0.988 Vali Loss: 7.633 Vali Acc: 0.520 Test Loss: 7.633 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9974846839904785
Epoch: 12, Steps: 35 | Train Loss: 0.562 Vali Loss: 1.797 Vali Acc: 0.550 Test Loss: 1.797 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.212366342544556
Epoch: 13, Steps: 35 | Train Loss: 0.309 Vali Loss: 2.402 Vali Acc: 0.560 Test Loss: 2.402 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.006363868713379
Epoch: 14, Steps: 35 | Train Loss: 0.302 Vali Loss: 3.697 Vali Acc: 0.540 Test Loss: 3.697 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8234333992004395
Epoch: 15, Steps: 35 | Train Loss: 0.478 Vali Loss: 3.403 Vali Acc: 0.500 Test Loss: 3.403 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.038076877593994
Epoch: 16, Steps: 35 | Train Loss: 0.595 Vali Loss: 3.377 Vali Acc: 0.580 Test Loss: 3.377 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.088310241699219
Epoch: 17, Steps: 35 | Train Loss: 1.191 Vali Loss: 8.310 Vali Acc: 0.520 Test Loss: 8.310 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8457093238830566
Epoch: 18, Steps: 35 | Train Loss: 0.828 Vali Loss: 5.606 Vali Acc: 0.540 Test Loss: 5.606 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.909912109375
Epoch: 19, Steps: 35 | Train Loss: 1.010 Vali Loss: 11.319 Vali Acc: 0.500 Test Loss: 11.319 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 342690
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.49201226234436
Epoch: 1, Steps: 35 | Train Loss: 1.138 Vali Loss: 1.055 Vali Acc: 0.470 Test Loss: 1.055 Test Acc: 0.470
Validation loss decreased (inf --> -0.469989).  Saving model ...
Epoch: 2 cost time: 3.8579001426696777
Epoch: 2, Steps: 35 | Train Loss: 1.196 Vali Loss: 1.352 Vali Acc: 0.510 Test Loss: 1.352 Test Acc: 0.510
Validation loss decreased (-0.469989 --> -0.509986).  Saving model ...
Epoch: 3 cost time: 4.035027265548706
Epoch: 3, Steps: 35 | Train Loss: 1.009 Vali Loss: 2.631 Vali Acc: 0.500 Test Loss: 2.631 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.796525478363037
Epoch: 4, Steps: 35 | Train Loss: 1.273 Vali Loss: 1.708 Vali Acc: 0.580 Test Loss: 1.708 Test Acc: 0.580
Validation loss decreased (-0.509986 --> -0.579983).  Saving model ...
Epoch: 5 cost time: 3.5069620609283447
Epoch: 5, Steps: 35 | Train Loss: 0.866 Vali Loss: 1.804 Vali Acc: 0.550 Test Loss: 1.804 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5997185707092285
Epoch: 6, Steps: 35 | Train Loss: 0.868 Vali Loss: 4.544 Vali Acc: 0.480 Test Loss: 4.544 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9259958267211914
Epoch: 7, Steps: 35 | Train Loss: 0.847 Vali Loss: 3.558 Vali Acc: 0.510 Test Loss: 3.558 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.778225898742676
Epoch: 8, Steps: 35 | Train Loss: 1.223 Vali Loss: 2.797 Vali Acc: 0.470 Test Loss: 2.797 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.019526481628418
Epoch: 9, Steps: 35 | Train Loss: 1.112 Vali Loss: 3.647 Vali Acc: 0.520 Test Loss: 3.647 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.89119291305542
Epoch: 10, Steps: 35 | Train Loss: 1.109 Vali Loss: 3.324 Vali Acc: 0.540 Test Loss: 3.324 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6464803218841553
Epoch: 11, Steps: 35 | Train Loss: 0.872 Vali Loss: 7.320 Vali Acc: 0.510 Test Loss: 7.320 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.906845808029175
Epoch: 12, Steps: 35 | Train Loss: 0.860 Vali Loss: 3.089 Vali Acc: 0.460 Test Loss: 3.089 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.611124038696289
Epoch: 13, Steps: 35 | Train Loss: 0.444 Vali Loss: 3.879 Vali Acc: 0.490 Test Loss: 3.879 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.8031187057495117
Epoch: 14, Steps: 35 | Train Loss: 0.747 Vali Loss: 3.644 Vali Acc: 0.550 Test Loss: 3.644 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 342690
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.163601398468018
Epoch: 1, Steps: 35 | Train Loss: 1.124 Vali Loss: 1.048 Vali Acc: 0.480 Test Loss: 1.048 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 4.318626642227173
Epoch: 2, Steps: 35 | Train Loss: 1.233 Vali Loss: 1.885 Vali Acc: 0.490 Test Loss: 1.885 Test Acc: 0.490
Validation loss decreased (-0.479990 --> -0.489981).  Saving model ...
Epoch: 3 cost time: 4.108169794082642
Epoch: 3, Steps: 35 | Train Loss: 1.074 Vali Loss: 2.020 Vali Acc: 0.500 Test Loss: 2.020 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 4.000033617019653
Epoch: 4, Steps: 35 | Train Loss: 1.677 Vali Loss: 4.080 Vali Acc: 0.500 Test Loss: 4.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.925589084625244
Epoch: 5, Steps: 35 | Train Loss: 1.526 Vali Loss: 3.375 Vali Acc: 0.500 Test Loss: 3.375 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9519236087799072
Epoch: 6, Steps: 35 | Train Loss: 1.215 Vali Loss: 2.946 Vali Acc: 0.530 Test Loss: 2.946 Test Acc: 0.530
Validation loss decreased (-0.499980 --> -0.529971).  Saving model ...
Epoch: 7 cost time: 4.098103761672974
Epoch: 7, Steps: 35 | Train Loss: 1.002 Vali Loss: 5.703 Vali Acc: 0.500 Test Loss: 5.703 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8668527603149414
Epoch: 8, Steps: 35 | Train Loss: 2.118 Vali Loss: 3.696 Vali Acc: 0.500 Test Loss: 3.696 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9163691997528076
Epoch: 9, Steps: 35 | Train Loss: 0.884 Vali Loss: 3.483 Vali Acc: 0.580 Test Loss: 3.483 Test Acc: 0.580
Validation loss decreased (-0.529971 --> -0.579965).  Saving model ...
Epoch: 10 cost time: 3.971952438354492
Epoch: 10, Steps: 35 | Train Loss: 1.093 Vali Loss: 2.337 Vali Acc: 0.510 Test Loss: 2.337 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9928224086761475
Epoch: 11, Steps: 35 | Train Loss: 1.067 Vali Loss: 3.906 Vali Acc: 0.520 Test Loss: 3.906 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.924384355545044
Epoch: 12, Steps: 35 | Train Loss: 0.739 Vali Loss: 4.925 Vali Acc: 0.480 Test Loss: 4.925 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.0398101806640625
Epoch: 13, Steps: 35 | Train Loss: 1.012 Vali Loss: 3.062 Vali Acc: 0.510 Test Loss: 3.062 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.958073377609253
Epoch: 14, Steps: 35 | Train Loss: 0.834 Vali Loss: 4.330 Vali Acc: 0.510 Test Loss: 4.330 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.105316638946533
Epoch: 15, Steps: 35 | Train Loss: 0.801 Vali Loss: 3.493 Vali Acc: 0.510 Test Loss: 3.493 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.750678062438965
Epoch: 16, Steps: 35 | Train Loss: 0.720 Vali Loss: 3.329 Vali Acc: 0.560 Test Loss: 3.329 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.8663501739501953
Epoch: 17, Steps: 35 | Train Loss: 1.004 Vali Loss: 3.929 Vali Acc: 0.500 Test Loss: 3.929 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.003660202026367
Epoch: 18, Steps: 35 | Train Loss: 0.841 Vali Loss: 3.535 Vali Acc: 0.540 Test Loss: 3.535 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.938507080078125
Epoch: 19, Steps: 35 | Train Loss: 0.928 Vali Loss: 4.298 Vali Acc: 0.560 Test Loss: 4.298 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 342690
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.103058338165283
Epoch: 1, Steps: 35 | Train Loss: 1.016 Vali Loss: 1.039 Vali Acc: 0.420 Test Loss: 1.039 Test Acc: 0.420
Validation loss decreased (inf --> -0.419990).  Saving model ...
Epoch: 2 cost time: 4.150346994400024
Epoch: 2, Steps: 35 | Train Loss: 1.138 Vali Loss: 1.158 Vali Acc: 0.490 Test Loss: 1.158 Test Acc: 0.490
Validation loss decreased (-0.419990 --> -0.489988).  Saving model ...
Epoch: 3 cost time: 4.681859254837036
Epoch: 3, Steps: 35 | Train Loss: 0.962 Vali Loss: 4.031 Vali Acc: 0.510 Test Loss: 4.031 Test Acc: 0.510
Validation loss decreased (-0.489988 --> -0.509960).  Saving model ...
Epoch: 4 cost time: 4.606490850448608
Epoch: 4, Steps: 35 | Train Loss: 1.306 Vali Loss: 2.550 Vali Acc: 0.470 Test Loss: 2.550 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1156439781188965
Epoch: 5, Steps: 35 | Train Loss: 1.108 Vali Loss: 1.262 Vali Acc: 0.530 Test Loss: 1.262 Test Acc: 0.530
Validation loss decreased (-0.509960 --> -0.529987).  Saving model ...
Epoch: 6 cost time: 3.524355173110962
Epoch: 6, Steps: 35 | Train Loss: 1.139 Vali Loss: 3.599 Vali Acc: 0.530 Test Loss: 3.599 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6657001972198486
Epoch: 7, Steps: 35 | Train Loss: 0.833 Vali Loss: 2.493 Vali Acc: 0.480 Test Loss: 2.493 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6285924911499023
Epoch: 8, Steps: 35 | Train Loss: 1.861 Vali Loss: 2.898 Vali Acc: 0.620 Test Loss: 2.898 Test Acc: 0.620
Validation loss decreased (-0.529987 --> -0.619971).  Saving model ...
Epoch: 9 cost time: 3.7603371143341064
Epoch: 9, Steps: 35 | Train Loss: 1.061 Vali Loss: 1.840 Vali Acc: 0.580 Test Loss: 1.840 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5438003540039062
Epoch: 10, Steps: 35 | Train Loss: 1.450 Vali Loss: 2.566 Vali Acc: 0.560 Test Loss: 2.566 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.946401596069336
Epoch: 11, Steps: 35 | Train Loss: 1.291 Vali Loss: 6.771 Vali Acc: 0.510 Test Loss: 6.771 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.49151873588562
Epoch: 12, Steps: 35 | Train Loss: 1.475 Vali Loss: 4.600 Vali Acc: 0.520 Test Loss: 4.600 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.197296857833862
Epoch: 13, Steps: 35 | Train Loss: 1.146 Vali Loss: 2.958 Vali Acc: 0.540 Test Loss: 2.958 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.966395854949951
Epoch: 14, Steps: 35 | Train Loss: 1.518 Vali Loss: 4.299 Vali Acc: 0.520 Test Loss: 4.299 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.7731263637542725
Epoch: 15, Steps: 35 | Train Loss: 1.144 Vali Loss: 3.180 Vali Acc: 0.540 Test Loss: 3.180 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.239418983459473
Epoch: 16, Steps: 35 | Train Loss: 1.006 Vali Loss: 2.287 Vali Acc: 0.570 Test Loss: 2.287 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.154745817184448
Epoch: 17, Steps: 35 | Train Loss: 1.170 Vali Loss: 4.556 Vali Acc: 0.580 Test Loss: 4.556 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.133570194244385
Epoch: 18, Steps: 35 | Train Loss: 1.219 Vali Loss: 3.817 Vali Acc: 0.570 Test Loss: 3.817 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 342690
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.5688440799713135
Epoch: 1, Steps: 35 | Train Loss: 1.085 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.446171283721924
Epoch: 2, Steps: 35 | Train Loss: 1.278 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5140740871429443
Epoch: 3, Steps: 35 | Train Loss: 1.806 Vali Loss: 1.356 Vali Acc: 0.470 Test Loss: 1.356 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6559786796569824
Epoch: 4, Steps: 35 | Train Loss: 0.904 Vali Loss: 1.161 Vali Acc: 0.520 Test Loss: 1.161 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519988).  Saving model ...
Epoch: 5 cost time: 3.6118831634521484
Epoch: 5, Steps: 35 | Train Loss: 0.809 Vali Loss: 1.190 Vali Acc: 0.510 Test Loss: 1.190 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.549785614013672
Epoch: 6, Steps: 35 | Train Loss: 1.054 Vali Loss: 2.821 Vali Acc: 0.510 Test Loss: 2.821 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.079696416854858
Epoch: 7, Steps: 35 | Train Loss: 1.266 Vali Loss: 1.688 Vali Acc: 0.490 Test Loss: 1.688 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.018094301223755
Epoch: 8, Steps: 35 | Train Loss: 1.020 Vali Loss: 3.068 Vali Acc: 0.460 Test Loss: 3.068 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.391385793685913
Epoch: 9, Steps: 35 | Train Loss: 0.441 Vali Loss: 2.244 Vali Acc: 0.540 Test Loss: 2.244 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539978).  Saving model ...
Epoch: 10 cost time: 4.007191181182861
Epoch: 10, Steps: 35 | Train Loss: 0.454 Vali Loss: 1.705 Vali Acc: 0.520 Test Loss: 1.705 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.038440465927124
Epoch: 11, Steps: 35 | Train Loss: 0.456 Vali Loss: 2.691 Vali Acc: 0.490 Test Loss: 2.691 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.2658703327178955
Epoch: 12, Steps: 35 | Train Loss: 0.675 Vali Loss: 2.319 Vali Acc: 0.520 Test Loss: 2.319 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.080765008926392
Epoch: 13, Steps: 35 | Train Loss: 0.547 Vali Loss: 3.772 Vali Acc: 0.540 Test Loss: 3.772 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8236026763916016
Epoch: 14, Steps: 35 | Train Loss: 0.372 Vali Loss: 6.473 Vali Acc: 0.470 Test Loss: 6.473 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7685837745666504
Epoch: 15, Steps: 35 | Train Loss: 0.297 Vali Loss: 7.006 Vali Acc: 0.530 Test Loss: 7.006 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.1051435470581055
Epoch: 16, Steps: 35 | Train Loss: 0.731 Vali Loss: 6.765 Vali Acc: 0.520 Test Loss: 6.765 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.091017484664917
Epoch: 17, Steps: 35 | Train Loss: 0.617 Vali Loss: 3.671 Vali Acc: 0.520 Test Loss: 3.671 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9187674522399902
Epoch: 18, Steps: 35 | Train Loss: 0.249 Vali Loss: 3.755 Vali Acc: 0.530 Test Loss: 3.755 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.181105375289917
Epoch: 19, Steps: 35 | Train Loss: 0.218 Vali Loss: 3.911 Vali Acc: 0.570 Test Loss: 3.911 Test Acc: 0.570
Validation loss decreased (-0.539978 --> -0.569961).  Saving model ...
Epoch: 20 cost time: 4.3283281326293945
Epoch: 20, Steps: 35 | Train Loss: 0.366 Vali Loss: 5.945 Vali Acc: 0.500 Test Loss: 5.945 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.135447263717651
Epoch: 21, Steps: 35 | Train Loss: 0.245 Vali Loss: 8.038 Vali Acc: 0.460 Test Loss: 8.038 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8112401962280273
Epoch: 22, Steps: 35 | Train Loss: 0.259 Vali Loss: 8.253 Vali Acc: 0.500 Test Loss: 8.253 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.082571506500244
Epoch: 23, Steps: 35 | Train Loss: 0.514 Vali Loss: 6.164 Vali Acc: 0.530 Test Loss: 6.164 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.827337026596069
Epoch: 24, Steps: 35 | Train Loss: 0.409 Vali Loss: 4.721 Vali Acc: 0.560 Test Loss: 4.721 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.236868619918823
Epoch: 25, Steps: 35 | Train Loss: 0.366 Vali Loss: 7.538 Vali Acc: 0.520 Test Loss: 7.538 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.261585235595703
Epoch: 26, Steps: 35 | Train Loss: 0.064 Vali Loss: 10.336 Vali Acc: 0.510 Test Loss: 10.336 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.32117223739624
Epoch: 27, Steps: 35 | Train Loss: 0.549 Vali Loss: 5.603 Vali Acc: 0.490 Test Loss: 5.603 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.546036958694458
Epoch: 28, Steps: 35 | Train Loss: 0.067 Vali Loss: 7.433 Vali Acc: 0.540 Test Loss: 7.433 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.269236087799072
Epoch: 29, Steps: 35 | Train Loss: 0.243 Vali Loss: 6.159 Vali Acc: 0.500 Test Loss: 6.159 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 277154
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.874422311782837
Epoch: 1, Steps: 35 | Train Loss: 1.060 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.605652093887329
Epoch: 2, Steps: 35 | Train Loss: 1.276 Vali Loss: 1.434 Vali Acc: 0.460 Test Loss: 1.434 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6496307849884033
Epoch: 3, Steps: 35 | Train Loss: 1.282 Vali Loss: 1.615 Vali Acc: 0.540 Test Loss: 1.615 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 3.5994207859039307
Epoch: 4, Steps: 35 | Train Loss: 1.082 Vali Loss: 3.767 Vali Acc: 0.490 Test Loss: 3.767 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.719576835632324
Epoch: 5, Steps: 35 | Train Loss: 1.224 Vali Loss: 2.322 Vali Acc: 0.510 Test Loss: 2.322 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.139948844909668
Epoch: 6, Steps: 35 | Train Loss: 0.691 Vali Loss: 3.425 Vali Acc: 0.500 Test Loss: 3.425 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.087998390197754
Epoch: 7, Steps: 35 | Train Loss: 0.608 Vali Loss: 1.755 Vali Acc: 0.510 Test Loss: 1.755 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.534882545471191
Epoch: 8, Steps: 35 | Train Loss: 0.755 Vali Loss: 3.217 Vali Acc: 0.470 Test Loss: 3.217 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.010171413421631
Epoch: 9, Steps: 35 | Train Loss: 0.548 Vali Loss: 2.263 Vali Acc: 0.490 Test Loss: 2.263 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.932091236114502
Epoch: 10, Steps: 35 | Train Loss: 0.341 Vali Loss: 2.511 Vali Acc: 0.460 Test Loss: 2.511 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.006946086883545
Epoch: 11, Steps: 35 | Train Loss: 0.435 Vali Loss: 2.993 Vali Acc: 0.470 Test Loss: 2.993 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.884969472885132
Epoch: 12, Steps: 35 | Train Loss: 0.274 Vali Loss: 2.752 Vali Acc: 0.530 Test Loss: 2.752 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.933509588241577
Epoch: 13, Steps: 35 | Train Loss: 0.553 Vali Loss: 4.960 Vali Acc: 0.540 Test Loss: 4.960 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 277154
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.361625909805298
Epoch: 1, Steps: 35 | Train Loss: 1.045 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.890963554382324
Epoch: 2, Steps: 35 | Train Loss: 1.271 Vali Loss: 1.519 Vali Acc: 0.450 Test Loss: 1.519 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7436437606811523
Epoch: 3, Steps: 35 | Train Loss: 1.130 Vali Loss: 1.334 Vali Acc: 0.530 Test Loss: 1.334 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529987).  Saving model ...
Epoch: 4 cost time: 3.6487302780151367
Epoch: 4, Steps: 35 | Train Loss: 1.018 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.504586935043335
Epoch: 5, Steps: 35 | Train Loss: 1.040 Vali Loss: 1.390 Vali Acc: 0.490 Test Loss: 1.390 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.900057077407837
Epoch: 6, Steps: 35 | Train Loss: 0.848 Vali Loss: 2.674 Vali Acc: 0.490 Test Loss: 2.674 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.022287130355835
Epoch: 7, Steps: 35 | Train Loss: 1.123 Vali Loss: 2.354 Vali Acc: 0.440 Test Loss: 2.354 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.022580862045288
Epoch: 8, Steps: 35 | Train Loss: 0.768 Vali Loss: 2.093 Vali Acc: 0.500 Test Loss: 2.093 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.148268222808838
Epoch: 9, Steps: 35 | Train Loss: 1.699 Vali Loss: 4.703 Vali Acc: 0.470 Test Loss: 4.703 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.382138013839722
Epoch: 10, Steps: 35 | Train Loss: 1.118 Vali Loss: 2.520 Vali Acc: 0.490 Test Loss: 2.520 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.057513952255249
Epoch: 11, Steps: 35 | Train Loss: 0.894 Vali Loss: 3.363 Vali Acc: 0.520 Test Loss: 3.363 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.202191352844238
Epoch: 12, Steps: 35 | Train Loss: 0.783 Vali Loss: 6.579 Vali Acc: 0.510 Test Loss: 6.579 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.263339519500732
Epoch: 13, Steps: 35 | Train Loss: 0.791 Vali Loss: 2.796 Vali Acc: 0.520 Test Loss: 2.796 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 277154
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.531941890716553
Epoch: 1, Steps: 35 | Train Loss: 1.049 Vali Loss: 0.756 Vali Acc: 0.590 Test Loss: 0.756 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 3.717827081680298
Epoch: 2, Steps: 35 | Train Loss: 0.934 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.488093614578247
Epoch: 3, Steps: 35 | Train Loss: 1.044 Vali Loss: 1.094 Vali Acc: 0.560 Test Loss: 1.094 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5892841815948486
Epoch: 4, Steps: 35 | Train Loss: 1.582 Vali Loss: 3.931 Vali Acc: 0.470 Test Loss: 3.931 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.178505182266235
Epoch: 5, Steps: 35 | Train Loss: 1.623 Vali Loss: 2.086 Vali Acc: 0.500 Test Loss: 2.086 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.403502464294434
Epoch: 6, Steps: 35 | Train Loss: 1.205 Vali Loss: 3.893 Vali Acc: 0.490 Test Loss: 3.893 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.2338738441467285
Epoch: 7, Steps: 35 | Train Loss: 1.150 Vali Loss: 2.859 Vali Acc: 0.510 Test Loss: 2.859 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.410035133361816
Epoch: 8, Steps: 35 | Train Loss: 1.172 Vali Loss: 4.353 Vali Acc: 0.540 Test Loss: 4.353 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.544352769851685
Epoch: 9, Steps: 35 | Train Loss: 0.886 Vali Loss: 2.805 Vali Acc: 0.540 Test Loss: 2.805 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.724642038345337
Epoch: 10, Steps: 35 | Train Loss: 1.190 Vali Loss: 3.716 Vali Acc: 0.520 Test Loss: 3.716 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.035238981246948
Epoch: 11, Steps: 35 | Train Loss: 1.096 Vali Loss: 2.749 Vali Acc: 0.550 Test Loss: 2.749 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 277154
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.801081657409668
Epoch: 1, Steps: 35 | Train Loss: 1.040 Vali Loss: 1.222 Vali Acc: 0.470 Test Loss: 1.222 Test Acc: 0.470
Validation loss decreased (inf --> -0.469988).  Saving model ...
Epoch: 2 cost time: 3.7590978145599365
Epoch: 2, Steps: 35 | Train Loss: 1.217 Vali Loss: 2.251 Vali Acc: 0.560 Test Loss: 2.251 Test Acc: 0.560
Validation loss decreased (-0.469988 --> -0.559977).  Saving model ...
Epoch: 3 cost time: 3.9264323711395264
Epoch: 3, Steps: 35 | Train Loss: 1.411 Vali Loss: 1.545 Vali Acc: 0.480 Test Loss: 1.545 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.163551568984985
Epoch: 4, Steps: 35 | Train Loss: 1.208 Vali Loss: 2.735 Vali Acc: 0.450 Test Loss: 2.735 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.060567617416382
Epoch: 5, Steps: 35 | Train Loss: 1.187 Vali Loss: 4.057 Vali Acc: 0.510 Test Loss: 4.057 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.985715627670288
Epoch: 6, Steps: 35 | Train Loss: 1.376 Vali Loss: 2.811 Vali Acc: 0.480 Test Loss: 2.811 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9980671405792236
Epoch: 7, Steps: 35 | Train Loss: 0.835 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9202613830566406
Epoch: 8, Steps: 35 | Train Loss: 1.284 Vali Loss: 5.150 Vali Acc: 0.500 Test Loss: 5.150 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.9665918350219727
Epoch: 9, Steps: 35 | Train Loss: 1.167 Vali Loss: 3.411 Vali Acc: 0.510 Test Loss: 3.411 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.942735195159912
Epoch: 10, Steps: 35 | Train Loss: 1.377 Vali Loss: 2.440 Vali Acc: 0.520 Test Loss: 2.440 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.451994180679321
Epoch: 11, Steps: 35 | Train Loss: 0.454 Vali Loss: 3.471 Vali Acc: 0.490 Test Loss: 3.471 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.304223299026489
Epoch: 12, Steps: 35 | Train Loss: 0.262 Vali Loss: 4.078 Vali Acc: 0.460 Test Loss: 4.078 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 244386
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.146244764328003
Epoch: 1, Steps: 35 | Train Loss: 0.972 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 3.494107246398926
Epoch: 2, Steps: 35 | Train Loss: 1.109 Vali Loss: 1.512 Vali Acc: 0.570 Test Loss: 1.512 Test Acc: 0.570
Validation loss decreased (-0.499984 --> -0.569985).  Saving model ...
Epoch: 3 cost time: 3.5555579662323
Epoch: 3, Steps: 35 | Train Loss: 1.506 Vali Loss: 1.650 Vali Acc: 0.470 Test Loss: 1.650 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.026288747787476
Epoch: 4, Steps: 35 | Train Loss: 1.144 Vali Loss: 3.732 Vali Acc: 0.460 Test Loss: 3.732 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.029384136199951
Epoch: 5, Steps: 35 | Train Loss: 0.851 Vali Loss: 2.606 Vali Acc: 0.490 Test Loss: 2.606 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.32975172996521
Epoch: 6, Steps: 35 | Train Loss: 1.111 Vali Loss: 1.834 Vali Acc: 0.450 Test Loss: 1.834 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8895299434661865
Epoch: 7, Steps: 35 | Train Loss: 0.819 Vali Loss: 3.248 Vali Acc: 0.490 Test Loss: 3.248 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.559802293777466
Epoch: 8, Steps: 35 | Train Loss: 1.031 Vali Loss: 1.762 Vali Acc: 0.510 Test Loss: 1.762 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.284525394439697
Epoch: 9, Steps: 35 | Train Loss: 1.427 Vali Loss: 4.266 Vali Acc: 0.560 Test Loss: 4.266 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.224855422973633
Epoch: 10, Steps: 35 | Train Loss: 1.333 Vali Loss: 2.346 Vali Acc: 0.550 Test Loss: 2.346 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.244740009307861
Epoch: 11, Steps: 35 | Train Loss: 1.122 Vali Loss: 6.683 Vali Acc: 0.460 Test Loss: 6.683 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.410227298736572
Epoch: 12, Steps: 35 | Train Loss: 0.985 Vali Loss: 2.663 Vali Acc: 0.470 Test Loss: 2.663 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 244386
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.2532758712768555
Epoch: 1, Steps: 35 | Train Loss: 0.932 Vali Loss: 1.830 Vali Acc: 0.500 Test Loss: 1.830 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
Epoch: 2 cost time: 4.084609508514404
Epoch: 2, Steps: 35 | Train Loss: 1.095 Vali Loss: 1.443 Vali Acc: 0.480 Test Loss: 1.443 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7992095947265625
Epoch: 3, Steps: 35 | Train Loss: 1.196 Vali Loss: 2.019 Vali Acc: 0.510 Test Loss: 2.019 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509980).  Saving model ...
Epoch: 4 cost time: 4.292847156524658
Epoch: 4, Steps: 35 | Train Loss: 1.253 Vali Loss: 4.235 Vali Acc: 0.500 Test Loss: 4.235 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.209623098373413
Epoch: 5, Steps: 35 | Train Loss: 1.947 Vali Loss: 2.715 Vali Acc: 0.470 Test Loss: 2.715 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.407315731048584
Epoch: 6, Steps: 35 | Train Loss: 1.055 Vali Loss: 2.589 Vali Acc: 0.470 Test Loss: 2.589 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.475700855255127
Epoch: 7, Steps: 35 | Train Loss: 1.308 Vali Loss: 2.099 Vali Acc: 0.530 Test Loss: 2.099 Test Acc: 0.530
Validation loss decreased (-0.509980 --> -0.529979).  Saving model ...
Epoch: 8 cost time: 4.531074047088623
Epoch: 8, Steps: 35 | Train Loss: 0.867 Vali Loss: 4.341 Vali Acc: 0.500 Test Loss: 4.341 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.698020696640015
Epoch: 9, Steps: 35 | Train Loss: 1.287 Vali Loss: 4.186 Vali Acc: 0.520 Test Loss: 4.186 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.461929798126221
Epoch: 10, Steps: 35 | Train Loss: 0.805 Vali Loss: 2.630 Vali Acc: 0.500 Test Loss: 2.630 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.386451005935669
Epoch: 11, Steps: 35 | Train Loss: 0.554 Vali Loss: 7.719 Vali Acc: 0.500 Test Loss: 7.719 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.407069683074951
Epoch: 12, Steps: 35 | Train Loss: 1.031 Vali Loss: 3.280 Vali Acc: 0.470 Test Loss: 3.280 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.481518268585205
Epoch: 13, Steps: 35 | Train Loss: 0.697 Vali Loss: 3.409 Vali Acc: 0.510 Test Loss: 3.409 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.09799861907959
Epoch: 14, Steps: 35 | Train Loss: 0.691 Vali Loss: 5.015 Vali Acc: 0.490 Test Loss: 5.015 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7352991104125977
Epoch: 15, Steps: 35 | Train Loss: 0.658 Vali Loss: 3.267 Vali Acc: 0.460 Test Loss: 3.267 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.911966323852539
Epoch: 16, Steps: 35 | Train Loss: 1.383 Vali Loss: 7.818 Vali Acc: 0.480 Test Loss: 7.818 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.872772216796875
Epoch: 17, Steps: 35 | Train Loss: 1.000 Vali Loss: 4.530 Vali Acc: 0.500 Test Loss: 4.530 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 244386
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.2092931270599365
Epoch: 1, Steps: 35 | Train Loss: 0.848 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.7946484088897705
Epoch: 2, Steps: 35 | Train Loss: 1.156 Vali Loss: 1.384 Vali Acc: 0.510 Test Loss: 1.384 Test Acc: 0.510
Validation loss decreased (-0.499987 --> -0.509986).  Saving model ...
Epoch: 3 cost time: 3.7588186264038086
Epoch: 3, Steps: 35 | Train Loss: 1.186 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8161327838897705
Epoch: 4, Steps: 35 | Train Loss: 1.061 Vali Loss: 4.331 Vali Acc: 0.470 Test Loss: 4.331 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6305084228515625
Epoch: 5, Steps: 35 | Train Loss: 1.831 Vali Loss: 3.148 Vali Acc: 0.490 Test Loss: 3.148 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5861494541168213
Epoch: 6, Steps: 35 | Train Loss: 1.027 Vali Loss: 3.239 Vali Acc: 0.440 Test Loss: 3.239 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.430368423461914
Epoch: 7, Steps: 35 | Train Loss: 1.224 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.886720657348633
Epoch: 8, Steps: 35 | Train Loss: 1.476 Vali Loss: 4.264 Vali Acc: 0.510 Test Loss: 4.264 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.915553092956543
Epoch: 9, Steps: 35 | Train Loss: 1.229 Vali Loss: 4.882 Vali Acc: 0.500 Test Loss: 4.882 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3927953243255615
Epoch: 10, Steps: 35 | Train Loss: 0.940 Vali Loss: 2.224 Vali Acc: 0.480 Test Loss: 2.224 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.943241834640503
Epoch: 11, Steps: 35 | Train Loss: 0.713 Vali Loss: 3.708 Vali Acc: 0.500 Test Loss: 3.708 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8119587898254395
Epoch: 12, Steps: 35 | Train Loss: 0.892 Vali Loss: 2.966 Vali Acc: 0.460 Test Loss: 2.966 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 244386
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.720453977584839
Epoch: 1, Steps: 35 | Train Loss: 1.343 Vali Loss: 1.036 Vali Acc: 0.590 Test Loss: 1.036 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 3.752809762954712
Epoch: 2, Steps: 35 | Train Loss: 1.371 Vali Loss: 2.305 Vali Acc: 0.490 Test Loss: 2.305 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9708197116851807
Epoch: 3, Steps: 35 | Train Loss: 1.026 Vali Loss: 1.219 Vali Acc: 0.470 Test Loss: 1.219 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.997448682785034
Epoch: 4, Steps: 35 | Train Loss: 0.810 Vali Loss: 1.608 Vali Acc: 0.520 Test Loss: 1.608 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.948054313659668
Epoch: 5, Steps: 35 | Train Loss: 0.840 Vali Loss: 4.177 Vali Acc: 0.510 Test Loss: 4.177 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9671273231506348
Epoch: 6, Steps: 35 | Train Loss: 1.584 Vali Loss: 1.697 Vali Acc: 0.530 Test Loss: 1.697 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.766533613204956
Epoch: 7, Steps: 35 | Train Loss: 0.824 Vali Loss: 2.775 Vali Acc: 0.460 Test Loss: 2.775 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.9945833683013916
Epoch: 8, Steps: 35 | Train Loss: 0.640 Vali Loss: 2.967 Vali Acc: 0.540 Test Loss: 2.967 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9171297550201416
Epoch: 9, Steps: 35 | Train Loss: 1.312 Vali Loss: 3.204 Vali Acc: 0.500 Test Loss: 3.204 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9271366596221924
Epoch: 10, Steps: 35 | Train Loss: 0.951 Vali Loss: 2.141 Vali Acc: 0.440 Test Loss: 2.141 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9154186248779297
Epoch: 11, Steps: 35 | Train Loss: 0.736 Vali Loss: 4.560 Vali Acc: 0.510 Test Loss: 4.560 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 228002
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.098326206207275
Epoch: 1, Steps: 35 | Train Loss: 1.316 Vali Loss: 1.109 Vali Acc: 0.580 Test Loss: 1.109 Test Acc: 0.580
Validation loss decreased (inf --> -0.579989).  Saving model ...
Epoch: 2 cost time: 4.084507465362549
Epoch: 2, Steps: 35 | Train Loss: 1.240 Vali Loss: 1.357 Vali Acc: 0.470 Test Loss: 1.357 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086598873138428
Epoch: 3, Steps: 35 | Train Loss: 1.109 Vali Loss: 1.858 Vali Acc: 0.540 Test Loss: 1.858 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8333687782287598
Epoch: 4, Steps: 35 | Train Loss: 1.080 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.704374074935913
Epoch: 5, Steps: 35 | Train Loss: 1.371 Vali Loss: 2.351 Vali Acc: 0.520 Test Loss: 2.351 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7350847721099854
Epoch: 6, Steps: 35 | Train Loss: 1.481 Vali Loss: 1.606 Vali Acc: 0.500 Test Loss: 1.606 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.291896343231201
Epoch: 7, Steps: 35 | Train Loss: 0.952 Vali Loss: 3.292 Vali Acc: 0.480 Test Loss: 3.292 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.055096626281738
Epoch: 8, Steps: 35 | Train Loss: 1.386 Vali Loss: 3.296 Vali Acc: 0.490 Test Loss: 3.296 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.982250928878784
Epoch: 9, Steps: 35 | Train Loss: 1.120 Vali Loss: 3.268 Vali Acc: 0.510 Test Loss: 3.268 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.383873224258423
Epoch: 10, Steps: 35 | Train Loss: 0.586 Vali Loss: 2.306 Vali Acc: 0.570 Test Loss: 2.306 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.297306299209595
Epoch: 11, Steps: 35 | Train Loss: 0.603 Vali Loss: 3.719 Vali Acc: 0.540 Test Loss: 3.719 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 228002
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.39346170425415
Epoch: 1, Steps: 35 | Train Loss: 1.261 Vali Loss: 1.053 Vali Acc: 0.580 Test Loss: 1.053 Test Acc: 0.580
Validation loss decreased (inf --> -0.579989).  Saving model ...
Epoch: 2 cost time: 4.0887439250946045
Epoch: 2, Steps: 35 | Train Loss: 1.503 Vali Loss: 3.231 Vali Acc: 0.500 Test Loss: 3.231 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.784167766571045
Epoch: 3, Steps: 35 | Train Loss: 1.144 Vali Loss: 1.222 Vali Acc: 0.510 Test Loss: 1.222 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9802916049957275
Epoch: 4, Steps: 35 | Train Loss: 0.914 Vali Loss: 0.920 Vali Acc: 0.590 Test Loss: 0.920 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 4.213099956512451
Epoch: 5, Steps: 35 | Train Loss: 1.263 Vali Loss: 3.182 Vali Acc: 0.500 Test Loss: 3.182 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.18256139755249
Epoch: 6, Steps: 35 | Train Loss: 1.526 Vali Loss: 1.195 Vali Acc: 0.540 Test Loss: 1.195 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4363389015197754
Epoch: 7, Steps: 35 | Train Loss: 0.740 Vali Loss: 3.286 Vali Acc: 0.450 Test Loss: 3.286 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.6776368618011475
Epoch: 8, Steps: 35 | Train Loss: 1.600 Vali Loss: 2.634 Vali Acc: 0.510 Test Loss: 2.634 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.218653917312622
Epoch: 9, Steps: 35 | Train Loss: 1.356 Vali Loss: 4.631 Vali Acc: 0.510 Test Loss: 4.631 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.319066047668457
Epoch: 10, Steps: 35 | Train Loss: 1.177 Vali Loss: 2.304 Vali Acc: 0.540 Test Loss: 2.304 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.163006067276001
Epoch: 11, Steps: 35 | Train Loss: 0.742 Vali Loss: 3.254 Vali Acc: 0.530 Test Loss: 3.254 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.861560821533203
Epoch: 12, Steps: 35 | Train Loss: 0.967 Vali Loss: 2.832 Vali Acc: 0.520 Test Loss: 2.832 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.920252323150635
Epoch: 13, Steps: 35 | Train Loss: 1.156 Vali Loss: 4.278 Vali Acc: 0.480 Test Loss: 4.278 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.922513008117676
Epoch: 14, Steps: 35 | Train Loss: 0.791 Vali Loss: 2.988 Vali Acc: 0.530 Test Loss: 2.988 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 228002
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.736611843109131
Epoch: 1, Steps: 35 | Train Loss: 1.113 Vali Loss: 0.924 Vali Acc: 0.480 Test Loss: 0.924 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 4.4345619678497314
Epoch: 2, Steps: 35 | Train Loss: 1.088 Vali Loss: 1.261 Vali Acc: 0.470 Test Loss: 1.261 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8493661880493164
Epoch: 3, Steps: 35 | Train Loss: 1.221 Vali Loss: 3.022 Vali Acc: 0.480 Test Loss: 3.022 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.755289077758789
Epoch: 4, Steps: 35 | Train Loss: 2.120 Vali Loss: 3.431 Vali Acc: 0.500 Test Loss: 3.431 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499966).  Saving model ...
Epoch: 5 cost time: 4.517460584640503
Epoch: 5, Steps: 35 | Train Loss: 1.098 Vali Loss: 2.825 Vali Acc: 0.530 Test Loss: 2.825 Test Acc: 0.530
Validation loss decreased (-0.499966 --> -0.529972).  Saving model ...
Epoch: 6 cost time: 4.752741575241089
Epoch: 6, Steps: 35 | Train Loss: 1.216 Vali Loss: 1.351 Vali Acc: 0.490 Test Loss: 1.351 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.527965307235718
Epoch: 7, Steps: 35 | Train Loss: 0.918 Vali Loss: 3.595 Vali Acc: 0.500 Test Loss: 3.595 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.464940309524536
Epoch: 8, Steps: 35 | Train Loss: 1.054 Vali Loss: 2.774 Vali Acc: 0.570 Test Loss: 2.774 Test Acc: 0.570
Validation loss decreased (-0.529972 --> -0.569972).  Saving model ...
Epoch: 9 cost time: 4.3819193840026855
Epoch: 9, Steps: 35 | Train Loss: 1.475 Vali Loss: 1.298 Vali Acc: 0.580 Test Loss: 1.298 Test Acc: 0.580
Validation loss decreased (-0.569972 --> -0.579987).  Saving model ...
Epoch: 10 cost time: 4.033711194992065
Epoch: 10, Steps: 35 | Train Loss: 1.026 Vali Loss: 3.680 Vali Acc: 0.510 Test Loss: 3.680 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.028797149658203
Epoch: 11, Steps: 35 | Train Loss: 1.129 Vali Loss: 2.080 Vali Acc: 0.560 Test Loss: 2.080 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.453641176223755
Epoch: 12, Steps: 35 | Train Loss: 1.330 Vali Loss: 6.229 Vali Acc: 0.480 Test Loss: 6.229 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.521311044692993
Epoch: 13, Steps: 35 | Train Loss: 1.236 Vali Loss: 3.166 Vali Acc: 0.550 Test Loss: 3.166 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.629349231719971
Epoch: 14, Steps: 35 | Train Loss: 1.050 Vali Loss: 2.631 Vali Acc: 0.530 Test Loss: 2.631 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.1897077560424805
Epoch: 15, Steps: 35 | Train Loss: 0.777 Vali Loss: 2.700 Vali Acc: 0.500 Test Loss: 2.700 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.560227394104004
Epoch: 16, Steps: 35 | Train Loss: 0.783 Vali Loss: 5.215 Vali Acc: 0.530 Test Loss: 5.215 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9801504611968994
Epoch: 17, Steps: 35 | Train Loss: 0.787 Vali Loss: 4.861 Vali Acc: 0.510 Test Loss: 4.861 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.243725776672363
Epoch: 18, Steps: 35 | Train Loss: 1.018 Vali Loss: 6.709 Vali Acc: 0.500 Test Loss: 6.709 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.439542055130005
Epoch: 19, Steps: 35 | Train Loss: 1.104 Vali Loss: 2.422 Vali Acc: 0.620 Test Loss: 2.422 Test Acc: 0.620
Validation loss decreased (-0.579987 --> -0.619976).  Saving model ...
Epoch: 20 cost time: 4.523163318634033
Epoch: 20, Steps: 35 | Train Loss: 1.028 Vali Loss: 6.000 Vali Acc: 0.550 Test Loss: 6.000 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.524568796157837
Epoch: 21, Steps: 35 | Train Loss: 1.307 Vali Loss: 2.646 Vali Acc: 0.580 Test Loss: 2.646 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.574540853500366
Epoch: 22, Steps: 35 | Train Loss: 0.744 Vali Loss: 4.133 Vali Acc: 0.530 Test Loss: 4.133 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.289035797119141
Epoch: 23, Steps: 35 | Train Loss: 0.935 Vali Loss: 10.222 Vali Acc: 0.510 Test Loss: 10.222 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.007141351699829
Epoch: 24, Steps: 35 | Train Loss: 0.988 Vali Loss: 3.211 Vali Acc: 0.580 Test Loss: 3.211 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.435528516769409
Epoch: 25, Steps: 35 | Train Loss: 0.707 Vali Loss: 3.727 Vali Acc: 0.600 Test Loss: 3.727 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.6260764598846436
Epoch: 26, Steps: 35 | Train Loss: 1.270 Vali Loss: 6.750 Vali Acc: 0.580 Test Loss: 6.750 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.547995567321777
Epoch: 27, Steps: 35 | Train Loss: 1.274 Vali Loss: 6.809 Vali Acc: 0.490 Test Loss: 6.809 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.276714563369751
Epoch: 28, Steps: 35 | Train Loss: 1.446 Vali Loss: 4.417 Vali Acc: 0.550 Test Loss: 4.417 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.7470052242279053
Epoch: 29, Steps: 35 | Train Loss: 0.549 Vali Loss: 4.946 Vali Acc: 0.510 Test Loss: 4.946 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 228002
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.734597444534302
Epoch: 1, Steps: 35 | Train Loss: 1.172 Vali Loss: 0.978 Vali Acc: 0.510 Test Loss: 0.978 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 3.996513605117798
Epoch: 2, Steps: 35 | Train Loss: 1.355 Vali Loss: 1.607 Vali Acc: 0.490 Test Loss: 1.607 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.042413949966431
Epoch: 3, Steps: 35 | Train Loss: 1.178 Vali Loss: 1.193 Vali Acc: 0.510 Test Loss: 1.193 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7551076412200928
Epoch: 4, Steps: 35 | Train Loss: 1.023 Vali Loss: 1.674 Vali Acc: 0.560 Test Loss: 1.674 Test Acc: 0.560
Validation loss decreased (-0.509990 --> -0.559983).  Saving model ...
Epoch: 5 cost time: 3.7949295043945312
Epoch: 5, Steps: 35 | Train Loss: 1.309 Vali Loss: 1.826 Vali Acc: 0.520 Test Loss: 1.826 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7231900691986084
Epoch: 6, Steps: 35 | Train Loss: 0.736 Vali Loss: 1.708 Vali Acc: 0.530 Test Loss: 1.708 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8192801475524902
Epoch: 7, Steps: 35 | Train Loss: 1.427 Vali Loss: 3.084 Vali Acc: 0.530 Test Loss: 3.084 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.156988859176636
Epoch: 8, Steps: 35 | Train Loss: 0.916 Vali Loss: 1.883 Vali Acc: 0.470 Test Loss: 1.883 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8547415733337402
Epoch: 9, Steps: 35 | Train Loss: 1.147 Vali Loss: 4.231 Vali Acc: 0.470 Test Loss: 4.231 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.075846910476685
Epoch: 10, Steps: 35 | Train Loss: 1.093 Vali Loss: 5.123 Vali Acc: 0.420 Test Loss: 5.123 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.241172552108765
Epoch: 11, Steps: 35 | Train Loss: 3.192 Vali Loss: 9.283 Vali Acc: 0.500 Test Loss: 9.283 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.088399171829224
Epoch: 12, Steps: 35 | Train Loss: 1.133 Vali Loss: 2.690 Vali Acc: 0.510 Test Loss: 2.690 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.641801595687866
Epoch: 13, Steps: 35 | Train Loss: 0.485 Vali Loss: 3.340 Vali Acc: 0.540 Test Loss: 3.340 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.641704797744751
Epoch: 14, Steps: 35 | Train Loss: 0.444 Vali Loss: 2.941 Vali Acc: 0.520 Test Loss: 2.941 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 219810
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.800584316253662
Epoch: 1, Steps: 35 | Train Loss: 1.159 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 3.9954259395599365
Epoch: 2, Steps: 35 | Train Loss: 1.879 Vali Loss: 2.885 Vali Acc: 0.490 Test Loss: 2.885 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8617522716522217
Epoch: 3, Steps: 35 | Train Loss: 1.447 Vali Loss: 1.573 Vali Acc: 0.520 Test Loss: 1.573 Test Acc: 0.520
Validation loss decreased (-0.509990 --> -0.519984).  Saving model ...
Epoch: 4 cost time: 3.6784262657165527
Epoch: 4, Steps: 35 | Train Loss: 1.250 Vali Loss: 1.934 Vali Acc: 0.620 Test Loss: 1.934 Test Acc: 0.620
Validation loss decreased (-0.519984 --> -0.619981).  Saving model ...
Epoch: 5 cost time: 3.9679646492004395
Epoch: 5, Steps: 35 | Train Loss: 1.073 Vali Loss: 1.625 Vali Acc: 0.470 Test Loss: 1.625 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.120918273925781
Epoch: 6, Steps: 35 | Train Loss: 1.236 Vali Loss: 1.544 Vali Acc: 0.510 Test Loss: 1.544 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.211644887924194
Epoch: 7, Steps: 35 | Train Loss: 1.475 Vali Loss: 2.521 Vali Acc: 0.550 Test Loss: 2.521 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.18855357170105
Epoch: 8, Steps: 35 | Train Loss: 0.780 Vali Loss: 1.608 Vali Acc: 0.590 Test Loss: 1.608 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9861879348754883
Epoch: 9, Steps: 35 | Train Loss: 0.792 Vali Loss: 3.753 Vali Acc: 0.510 Test Loss: 3.753 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.903899908065796
Epoch: 10, Steps: 35 | Train Loss: 0.822 Vali Loss: 2.583 Vali Acc: 0.550 Test Loss: 2.583 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.558652639389038
Epoch: 11, Steps: 35 | Train Loss: 0.529 Vali Loss: 3.731 Vali Acc: 0.520 Test Loss: 3.731 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8388030529022217
Epoch: 12, Steps: 35 | Train Loss: 0.603 Vali Loss: 2.696 Vali Acc: 0.500 Test Loss: 2.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.898231267929077
Epoch: 13, Steps: 35 | Train Loss: 0.361 Vali Loss: 3.430 Vali Acc: 0.480 Test Loss: 3.430 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.3717029094696045
Epoch: 14, Steps: 35 | Train Loss: 0.610 Vali Loss: 3.613 Vali Acc: 0.520 Test Loss: 3.613 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 219810
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.835175037384033
Epoch: 1, Steps: 35 | Train Loss: 1.122 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 3.8237032890319824
Epoch: 2, Steps: 35 | Train Loss: 2.109 Vali Loss: 4.421 Vali Acc: 0.500 Test Loss: 4.421 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.835695028305054
Epoch: 3, Steps: 35 | Train Loss: 1.718 Vali Loss: 1.257 Vali Acc: 0.590 Test Loss: 1.257 Test Acc: 0.590
Validation loss decreased (-0.509990 --> -0.589987).  Saving model ...
Epoch: 4 cost time: 4.1212544441223145
Epoch: 4, Steps: 35 | Train Loss: 1.286 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.08597469329834
Epoch: 5, Steps: 35 | Train Loss: 1.154 Vali Loss: 1.761 Vali Acc: 0.540 Test Loss: 1.761 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.300841331481934
Epoch: 6, Steps: 35 | Train Loss: 0.922 Vali Loss: 1.463 Vali Acc: 0.520 Test Loss: 1.463 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7899324893951416
Epoch: 7, Steps: 35 | Train Loss: 1.754 Vali Loss: 2.775 Vali Acc: 0.570 Test Loss: 2.775 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.42641806602478
Epoch: 8, Steps: 35 | Train Loss: 1.546 Vali Loss: 2.691 Vali Acc: 0.540 Test Loss: 2.691 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.20243763923645
Epoch: 9, Steps: 35 | Train Loss: 1.348 Vali Loss: 2.582 Vali Acc: 0.490 Test Loss: 2.582 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.993487596511841
Epoch: 10, Steps: 35 | Train Loss: 0.848 Vali Loss: 3.839 Vali Acc: 0.460 Test Loss: 3.839 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.105713844299316
Epoch: 11, Steps: 35 | Train Loss: 0.932 Vali Loss: 2.359 Vali Acc: 0.490 Test Loss: 2.359 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.703658580780029
Epoch: 12, Steps: 35 | Train Loss: 1.033 Vali Loss: 2.594 Vali Acc: 0.470 Test Loss: 2.594 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.175910711288452
Epoch: 13, Steps: 35 | Train Loss: 0.529 Vali Loss: 4.543 Vali Acc: 0.550 Test Loss: 4.543 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 219810
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.473737716674805
Epoch: 1, Steps: 35 | Train Loss: 0.986 Vali Loss: 1.351 Vali Acc: 0.460 Test Loss: 1.351 Test Acc: 0.460
Validation loss decreased (inf --> -0.459986).  Saving model ...
Epoch: 2 cost time: 3.8722314834594727
Epoch: 2, Steps: 35 | Train Loss: 1.461 Vali Loss: 1.472 Vali Acc: 0.470 Test Loss: 1.472 Test Acc: 0.470
Validation loss decreased (-0.459986 --> -0.469985).  Saving model ...
Epoch: 3 cost time: 4.364394903182983
Epoch: 3, Steps: 35 | Train Loss: 1.148 Vali Loss: 0.968 Vali Acc: 0.530 Test Loss: 0.968 Test Acc: 0.530
Validation loss decreased (-0.469985 --> -0.529990).  Saving model ...
Epoch: 4 cost time: 3.8201723098754883
Epoch: 4, Steps: 35 | Train Loss: 1.063 Vali Loss: 1.473 Vali Acc: 0.540 Test Loss: 1.473 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539985).  Saving model ...
Epoch: 5 cost time: 4.477140426635742
Epoch: 5, Steps: 35 | Train Loss: 1.413 Vali Loss: 2.033 Vali Acc: 0.500 Test Loss: 2.033 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.238479137420654
Epoch: 6, Steps: 35 | Train Loss: 1.657 Vali Loss: 3.340 Vali Acc: 0.480 Test Loss: 3.340 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9757630825042725
Epoch: 7, Steps: 35 | Train Loss: 1.605 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.626492738723755
Epoch: 8, Steps: 35 | Train Loss: 1.021 Vali Loss: 1.748 Vali Acc: 0.490 Test Loss: 1.748 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.293620347976685
Epoch: 9, Steps: 35 | Train Loss: 0.987 Vali Loss: 5.572 Vali Acc: 0.460 Test Loss: 5.572 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.254463195800781
Epoch: 10, Steps: 35 | Train Loss: 0.909 Vali Loss: 2.664 Vali Acc: 0.430 Test Loss: 2.664 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.052825689315796
Epoch: 11, Steps: 35 | Train Loss: 1.183 Vali Loss: 2.583 Vali Acc: 0.550 Test Loss: 2.583 Test Acc: 0.550
Validation loss decreased (-0.539985 --> -0.549974).  Saving model ...
Epoch: 12 cost time: 4.7621214389801025
Epoch: 12, Steps: 35 | Train Loss: 1.183 Vali Loss: 3.744 Vali Acc: 0.450 Test Loss: 3.744 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.267341613769531
Epoch: 13, Steps: 35 | Train Loss: 1.228 Vali Loss: 4.247 Vali Acc: 0.480 Test Loss: 4.247 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.03105354309082
Epoch: 14, Steps: 35 | Train Loss: 0.723 Vali Loss: 1.763 Vali Acc: 0.530 Test Loss: 1.763 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.339311122894287
Epoch: 15, Steps: 35 | Train Loss: 1.014 Vali Loss: 4.472 Vali Acc: 0.500 Test Loss: 4.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.4792516231536865
Epoch: 16, Steps: 35 | Train Loss: 1.299 Vali Loss: 6.329 Vali Acc: 0.510 Test Loss: 6.329 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.101900815963745
Epoch: 17, Steps: 35 | Train Loss: 0.751 Vali Loss: 4.274 Vali Acc: 0.480 Test Loss: 4.274 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.8661344051361084
Epoch: 18, Steps: 35 | Train Loss: 0.564 Vali Loss: 2.748 Vali Acc: 0.540 Test Loss: 2.748 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.201410293579102
Epoch: 19, Steps: 35 | Train Loss: 0.877 Vali Loss: 4.794 Vali Acc: 0.510 Test Loss: 4.794 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.992267608642578
Epoch: 20, Steps: 35 | Train Loss: 1.324 Vali Loss: 4.498 Vali Acc: 0.490 Test Loss: 4.498 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.736208915710449
Epoch: 21, Steps: 35 | Train Loss: 0.713 Vali Loss: 4.173 Vali Acc: 0.510 Test Loss: 4.173 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 219810
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.631392240524292
Epoch: 1, Steps: 35 | Train Loss: 3.887 Vali Loss: 14.030 Vali Acc: 0.530 Test Loss: 14.030 Test Acc: 0.530
Validation loss decreased (inf --> -0.529860).  Saving model ...
Epoch: 2 cost time: 8.313201189041138
Epoch: 2, Steps: 35 | Train Loss: 6.666 Vali Loss: 19.097 Vali Acc: 0.500 Test Loss: 19.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.02936053276062
Epoch: 3, Steps: 35 | Train Loss: 13.888 Vali Loss: 62.199 Vali Acc: 0.480 Test Loss: 62.199 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.38216781616211
Epoch: 4, Steps: 35 | Train Loss: 21.277 Vali Loss: 48.090 Vali Acc: 0.480 Test Loss: 48.090 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.581648111343384
Epoch: 5, Steps: 35 | Train Loss: 19.254 Vali Loss: 22.978 Vali Acc: 0.560 Test Loss: 22.978 Test Acc: 0.560
Validation loss decreased (-0.529860 --> -0.559770).  Saving model ...
Epoch: 6 cost time: 8.12325119972229
Epoch: 6, Steps: 35 | Train Loss: 17.713 Vali Loss: 16.673 Vali Acc: 0.510 Test Loss: 16.673 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.369178533554077
Epoch: 7, Steps: 35 | Train Loss: 15.432 Vali Loss: 34.677 Vali Acc: 0.490 Test Loss: 34.677 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.669538021087646
Epoch: 8, Steps: 35 | Train Loss: 16.211 Vali Loss: 21.776 Vali Acc: 0.530 Test Loss: 21.776 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.44056487083435
Epoch: 9, Steps: 35 | Train Loss: 23.069 Vali Loss: 45.053 Vali Acc: 0.540 Test Loss: 45.053 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.322604894638062
Epoch: 10, Steps: 35 | Train Loss: 13.426 Vali Loss: 28.221 Vali Acc: 0.490 Test Loss: 28.221 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.367291688919067
Epoch: 11, Steps: 35 | Train Loss: 9.327 Vali Loss: 35.846 Vali Acc: 0.490 Test Loss: 35.846 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.470153331756592
Epoch: 12, Steps: 35 | Train Loss: 19.981 Vali Loss: 57.543 Vali Acc: 0.510 Test Loss: 57.543 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.592224359512329
Epoch: 13, Steps: 35 | Train Loss: 7.444 Vali Loss: 70.680 Vali Acc: 0.500 Test Loss: 70.680 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.328810214996338
Epoch: 14, Steps: 35 | Train Loss: 12.037 Vali Loss: 25.228 Vali Acc: 0.520 Test Loss: 25.228 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.249586343765259
Epoch: 15, Steps: 35 | Train Loss: 14.331 Vali Loss: 46.499 Vali Acc: 0.540 Test Loss: 46.499 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5863698
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.980888605117798
Epoch: 1, Steps: 35 | Train Loss: 4.830 Vali Loss: 13.369 Vali Acc: 0.490 Test Loss: 13.369 Test Acc: 0.490
Validation loss decreased (inf --> -0.489866).  Saving model ...
Epoch: 2 cost time: 7.670971870422363
Epoch: 2, Steps: 35 | Train Loss: 12.861 Vali Loss: 9.804 Vali Acc: 0.580 Test Loss: 9.804 Test Acc: 0.580
Validation loss decreased (-0.489866 --> -0.579902).  Saving model ...
Epoch: 3 cost time: 7.9463112354278564
Epoch: 3, Steps: 35 | Train Loss: 11.887 Vali Loss: 10.870 Vali Acc: 0.600 Test Loss: 10.870 Test Acc: 0.600
Validation loss decreased (-0.579902 --> -0.599891).  Saving model ...
Epoch: 4 cost time: 7.761832237243652
Epoch: 4, Steps: 35 | Train Loss: 23.685 Vali Loss: 35.123 Vali Acc: 0.480 Test Loss: 35.123 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.854766368865967
Epoch: 5, Steps: 35 | Train Loss: 11.018 Vali Loss: 25.329 Vali Acc: 0.550 Test Loss: 25.329 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.961889266967773
Epoch: 6, Steps: 35 | Train Loss: 15.600 Vali Loss: 29.956 Vali Acc: 0.480 Test Loss: 29.956 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.145246267318726
Epoch: 7, Steps: 35 | Train Loss: 12.541 Vali Loss: 14.733 Vali Acc: 0.540 Test Loss: 14.733 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.9699273109436035
Epoch: 8, Steps: 35 | Train Loss: 9.423 Vali Loss: 18.628 Vali Acc: 0.500 Test Loss: 18.628 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.814427137374878
Epoch: 9, Steps: 35 | Train Loss: 10.010 Vali Loss: 25.461 Vali Acc: 0.530 Test Loss: 25.461 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.988550424575806
Epoch: 10, Steps: 35 | Train Loss: 10.710 Vali Loss: 31.130 Vali Acc: 0.450 Test Loss: 31.130 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.534898281097412
Epoch: 11, Steps: 35 | Train Loss: 12.301 Vali Loss: 70.070 Vali Acc: 0.490 Test Loss: 70.070 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.579341173171997
Epoch: 12, Steps: 35 | Train Loss: 12.099 Vali Loss: 32.886 Vali Acc: 0.530 Test Loss: 32.886 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.632154703140259
Epoch: 13, Steps: 35 | Train Loss: 18.587 Vali Loss: 53.957 Vali Acc: 0.450 Test Loss: 53.957 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5863698
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.381369352340698
Epoch: 1, Steps: 35 | Train Loss: 4.900 Vali Loss: 18.192 Vali Acc: 0.530 Test Loss: 18.192 Test Acc: 0.530
Validation loss decreased (inf --> -0.529818).  Saving model ...
Epoch: 2 cost time: 7.453683614730835
Epoch: 2, Steps: 35 | Train Loss: 6.662 Vali Loss: 13.193 Vali Acc: 0.480 Test Loss: 13.193 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.625683069229126
Epoch: 3, Steps: 35 | Train Loss: 11.460 Vali Loss: 30.800 Vali Acc: 0.470 Test Loss: 30.800 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.648502349853516
Epoch: 4, Steps: 35 | Train Loss: 13.644 Vali Loss: 67.330 Vali Acc: 0.470 Test Loss: 67.330 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.477702856063843
Epoch: 5, Steps: 35 | Train Loss: 11.073 Vali Loss: 26.816 Vali Acc: 0.490 Test Loss: 26.816 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.116461753845215
Epoch: 6, Steps: 35 | Train Loss: 12.903 Vali Loss: 38.219 Vali Acc: 0.500 Test Loss: 38.219 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.100549221038818
Epoch: 7, Steps: 35 | Train Loss: 7.615 Vali Loss: 21.185 Vali Acc: 0.550 Test Loss: 21.185 Test Acc: 0.550
Validation loss decreased (-0.529818 --> -0.549788).  Saving model ...
Epoch: 8 cost time: 6.971488952636719
Epoch: 8, Steps: 35 | Train Loss: 11.449 Vali Loss: 33.758 Vali Acc: 0.450 Test Loss: 33.758 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.25024938583374
Epoch: 9, Steps: 35 | Train Loss: 10.474 Vali Loss: 22.769 Vali Acc: 0.540 Test Loss: 22.769 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.5525336265563965
Epoch: 10, Steps: 35 | Train Loss: 8.255 Vali Loss: 62.943 Vali Acc: 0.440 Test Loss: 62.943 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.636266708374023
Epoch: 11, Steps: 35 | Train Loss: 10.490 Vali Loss: 48.458 Vali Acc: 0.480 Test Loss: 48.458 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.755574464797974
Epoch: 12, Steps: 35 | Train Loss: 19.953 Vali Loss: 60.087 Vali Acc: 0.580 Test Loss: 60.087 Test Acc: 0.580
Validation loss decreased (-0.549788 --> -0.579399).  Saving model ...
Epoch: 13 cost time: 7.498124122619629
Epoch: 13, Steps: 35 | Train Loss: 12.266 Vali Loss: 73.917 Vali Acc: 0.470 Test Loss: 73.917 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.51435661315918
Epoch: 14, Steps: 35 | Train Loss: 20.377 Vali Loss: 71.953 Vali Acc: 0.510 Test Loss: 71.953 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.315415859222412
Epoch: 15, Steps: 35 | Train Loss: 14.338 Vali Loss: 63.390 Vali Acc: 0.490 Test Loss: 63.390 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.765887498855591
Epoch: 16, Steps: 35 | Train Loss: 4.447 Vali Loss: 72.778 Vali Acc: 0.500 Test Loss: 72.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.809568643569946
Epoch: 17, Steps: 35 | Train Loss: 7.268 Vali Loss: 59.052 Vali Acc: 0.450 Test Loss: 59.052 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.3905980587005615
Epoch: 18, Steps: 35 | Train Loss: 4.686 Vali Loss: 74.496 Vali Acc: 0.550 Test Loss: 74.496 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.49089503288269
Epoch: 19, Steps: 35 | Train Loss: 4.732 Vali Loss: 112.533 Vali Acc: 0.480 Test Loss: 112.533 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.833698511123657
Epoch: 20, Steps: 35 | Train Loss: 17.731 Vali Loss: 93.271 Vali Acc: 0.510 Test Loss: 93.271 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.937544822692871
Epoch: 21, Steps: 35 | Train Loss: 16.396 Vali Loss: 68.498 Vali Acc: 0.460 Test Loss: 68.498 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.110769033432007
Epoch: 22, Steps: 35 | Train Loss: 7.683 Vali Loss: 71.034 Vali Acc: 0.490 Test Loss: 71.034 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5863698
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.88862133026123
Epoch: 1, Steps: 35 | Train Loss: 3.123 Vali Loss: 9.135 Vali Acc: 0.620 Test Loss: 9.135 Test Acc: 0.620
Validation loss decreased (inf --> -0.619909).  Saving model ...
Epoch: 2 cost time: 6.71971869468689
Epoch: 2, Steps: 35 | Train Loss: 8.946 Vali Loss: 15.686 Vali Acc: 0.520 Test Loss: 15.686 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.634443283081055
Epoch: 3, Steps: 35 | Train Loss: 12.478 Vali Loss: 16.413 Vali Acc: 0.530 Test Loss: 16.413 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.952816724777222
Epoch: 4, Steps: 35 | Train Loss: 17.629 Vali Loss: 18.192 Vali Acc: 0.500 Test Loss: 18.192 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.8842833042144775
Epoch: 5, Steps: 35 | Train Loss: 15.561 Vali Loss: 30.259 Vali Acc: 0.500 Test Loss: 30.259 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.595991373062134
Epoch: 6, Steps: 35 | Train Loss: 11.437 Vali Loss: 17.406 Vali Acc: 0.430 Test Loss: 17.406 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.882611274719238
Epoch: 7, Steps: 35 | Train Loss: 11.061 Vali Loss: 47.321 Vali Acc: 0.500 Test Loss: 47.321 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.578925371170044
Epoch: 8, Steps: 35 | Train Loss: 16.081 Vali Loss: 28.010 Vali Acc: 0.540 Test Loss: 28.010 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.061517000198364
Epoch: 9, Steps: 35 | Train Loss: 10.493 Vali Loss: 26.273 Vali Acc: 0.600 Test Loss: 26.273 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.924506664276123
Epoch: 10, Steps: 35 | Train Loss: 9.720 Vali Loss: 54.924 Vali Acc: 0.510 Test Loss: 54.924 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.027343988418579
Epoch: 11, Steps: 35 | Train Loss: 16.081 Vali Loss: 49.781 Vali Acc: 0.550 Test Loss: 49.781 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 5863698
model size : 32.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.708377599716187
Epoch: 1, Steps: 35 | Train Loss: 5.280 Vali Loss: 4.952 Vali Acc: 0.620 Test Loss: 4.952 Test Acc: 0.620
Validation loss decreased (inf --> -0.619950).  Saving model ...
Epoch: 2 cost time: 8.463915586471558
Epoch: 2, Steps: 35 | Train Loss: 9.824 Vali Loss: 10.197 Vali Acc: 0.460 Test Loss: 10.197 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.311830997467041
Epoch: 3, Steps: 35 | Train Loss: 11.809 Vali Loss: 11.321 Vali Acc: 0.550 Test Loss: 11.321 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.32915997505188
Epoch: 4, Steps: 35 | Train Loss: 12.225 Vali Loss: 41.914 Vali Acc: 0.500 Test Loss: 41.914 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.213563680648804
Epoch: 5, Steps: 35 | Train Loss: 11.181 Vali Loss: 42.327 Vali Acc: 0.510 Test Loss: 42.327 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.574668169021606
Epoch: 6, Steps: 35 | Train Loss: 20.575 Vali Loss: 42.895 Vali Acc: 0.490 Test Loss: 42.895 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.759175062179565
Epoch: 7, Steps: 35 | Train Loss: 19.935 Vali Loss: 73.805 Vali Acc: 0.500 Test Loss: 73.805 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.471782922744751
Epoch: 8, Steps: 35 | Train Loss: 18.948 Vali Loss: 70.963 Vali Acc: 0.470 Test Loss: 70.963 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.629988431930542
Epoch: 9, Steps: 35 | Train Loss: 31.075 Vali Loss: 42.390 Vali Acc: 0.530 Test Loss: 42.390 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.366662502288818
Epoch: 10, Steps: 35 | Train Loss: 10.214 Vali Loss: 91.384 Vali Acc: 0.510 Test Loss: 91.384 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.378064155578613
Epoch: 11, Steps: 35 | Train Loss: 11.625 Vali Loss: 31.595 Vali Acc: 0.460 Test Loss: 31.595 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 4815122
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.869645833969116
Epoch: 1, Steps: 35 | Train Loss: 4.866 Vali Loss: 12.218 Vali Acc: 0.520 Test Loss: 12.218 Test Acc: 0.520
Validation loss decreased (inf --> -0.519878).  Saving model ...
Epoch: 2 cost time: 7.520116329193115
Epoch: 2, Steps: 35 | Train Loss: 7.481 Vali Loss: 18.087 Vali Acc: 0.510 Test Loss: 18.087 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.743649482727051
Epoch: 3, Steps: 35 | Train Loss: 12.728 Vali Loss: 37.878 Vali Acc: 0.530 Test Loss: 37.878 Test Acc: 0.530
Validation loss decreased (-0.519878 --> -0.529621).  Saving model ...
Epoch: 4 cost time: 7.508935451507568
Epoch: 4, Steps: 35 | Train Loss: 12.707 Vali Loss: 20.899 Vali Acc: 0.580 Test Loss: 20.899 Test Acc: 0.580
Validation loss decreased (-0.529621 --> -0.579791).  Saving model ...
Epoch: 5 cost time: 7.6288652420043945
Epoch: 5, Steps: 35 | Train Loss: 8.313 Vali Loss: 25.589 Vali Acc: 0.520 Test Loss: 25.589 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.024787187576294
Epoch: 6, Steps: 35 | Train Loss: 13.914 Vali Loss: 50.812 Vali Acc: 0.500 Test Loss: 50.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.465311050415039
Epoch: 7, Steps: 35 | Train Loss: 19.118 Vali Loss: 37.432 Vali Acc: 0.490 Test Loss: 37.432 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.272315740585327
Epoch: 8, Steps: 35 | Train Loss: 12.482 Vali Loss: 62.030 Vali Acc: 0.460 Test Loss: 62.030 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.663667678833008
Epoch: 9, Steps: 35 | Train Loss: 12.321 Vali Loss: 64.191 Vali Acc: 0.490 Test Loss: 64.191 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.531505584716797
Epoch: 10, Steps: 35 | Train Loss: 14.188 Vali Loss: 50.135 Vali Acc: 0.540 Test Loss: 50.135 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.383192300796509
Epoch: 11, Steps: 35 | Train Loss: 11.595 Vali Loss: 23.103 Vali Acc: 0.590 Test Loss: 23.103 Test Acc: 0.590
Validation loss decreased (-0.579791 --> -0.589769).  Saving model ...
Epoch: 12 cost time: 7.915253639221191
Epoch: 12, Steps: 35 | Train Loss: 14.719 Vali Loss: 31.911 Vali Acc: 0.520 Test Loss: 31.911 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.730259418487549
Epoch: 13, Steps: 35 | Train Loss: 11.591 Vali Loss: 68.760 Vali Acc: 0.490 Test Loss: 68.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.796490430831909
Epoch: 14, Steps: 35 | Train Loss: 11.513 Vali Loss: 29.784 Vali Acc: 0.550 Test Loss: 29.784 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.603783130645752
Epoch: 15, Steps: 35 | Train Loss: 7.405 Vali Loss: 43.996 Vali Acc: 0.530 Test Loss: 43.996 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.848481178283691
Epoch: 16, Steps: 35 | Train Loss: 5.867 Vali Loss: 41.112 Vali Acc: 0.530 Test Loss: 41.112 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.747706413269043
Epoch: 17, Steps: 35 | Train Loss: 3.019 Vali Loss: 23.628 Vali Acc: 0.490 Test Loss: 23.628 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.903141260147095
Epoch: 18, Steps: 35 | Train Loss: 8.515 Vali Loss: 86.979 Vali Acc: 0.510 Test Loss: 86.979 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.013383388519287
Epoch: 19, Steps: 35 | Train Loss: 6.511 Vali Loss: 53.488 Vali Acc: 0.560 Test Loss: 53.488 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.049553155899048
Epoch: 20, Steps: 35 | Train Loss: 4.488 Vali Loss: 43.822 Vali Acc: 0.490 Test Loss: 43.822 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.902662515640259
Epoch: 21, Steps: 35 | Train Loss: 5.470 Vali Loss: 134.591 Vali Acc: 0.480 Test Loss: 134.591 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4815122
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.442833185195923
Epoch: 1, Steps: 35 | Train Loss: 4.816 Vali Loss: 8.885 Vali Acc: 0.520 Test Loss: 8.885 Test Acc: 0.520
Validation loss decreased (inf --> -0.519911).  Saving model ...
Epoch: 2 cost time: 6.845643997192383
Epoch: 2, Steps: 35 | Train Loss: 14.145 Vali Loss: 24.427 Vali Acc: 0.510 Test Loss: 24.427 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.198479413986206
Epoch: 3, Steps: 35 | Train Loss: 12.481 Vali Loss: 15.662 Vali Acc: 0.580 Test Loss: 15.662 Test Acc: 0.580
Validation loss decreased (-0.519911 --> -0.579843).  Saving model ...
Epoch: 4 cost time: 7.891804456710815
Epoch: 4, Steps: 35 | Train Loss: 9.923 Vali Loss: 41.599 Vali Acc: 0.510 Test Loss: 41.599 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.734117269515991
Epoch: 5, Steps: 35 | Train Loss: 16.769 Vali Loss: 15.841 Vali Acc: 0.580 Test Loss: 15.841 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.484645843505859
Epoch: 6, Steps: 35 | Train Loss: 16.961 Vali Loss: 25.192 Vali Acc: 0.530 Test Loss: 25.192 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.641589641571045
Epoch: 7, Steps: 35 | Train Loss: 13.638 Vali Loss: 68.656 Vali Acc: 0.500 Test Loss: 68.656 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.476716995239258
Epoch: 8, Steps: 35 | Train Loss: 23.788 Vali Loss: 26.937 Vali Acc: 0.530 Test Loss: 26.937 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.487668991088867
Epoch: 9, Steps: 35 | Train Loss: 12.612 Vali Loss: 48.690 Vali Acc: 0.490 Test Loss: 48.690 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.53886342048645
Epoch: 10, Steps: 35 | Train Loss: 15.730 Vali Loss: 43.985 Vali Acc: 0.490 Test Loss: 43.985 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.450929641723633
Epoch: 11, Steps: 35 | Train Loss: 10.451 Vali Loss: 24.193 Vali Acc: 0.550 Test Loss: 24.193 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.238535165786743
Epoch: 12, Steps: 35 | Train Loss: 13.679 Vali Loss: 48.332 Vali Acc: 0.480 Test Loss: 48.332 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.748761892318726
Epoch: 13, Steps: 35 | Train Loss: 13.380 Vali Loss: 60.412 Vali Acc: 0.450 Test Loss: 60.412 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4815122
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.078634023666382
Epoch: 1, Steps: 35 | Train Loss: 3.704 Vali Loss: 7.363 Vali Acc: 0.580 Test Loss: 7.363 Test Acc: 0.580
Validation loss decreased (inf --> -0.579926).  Saving model ...
Epoch: 2 cost time: 6.646884202957153
Epoch: 2, Steps: 35 | Train Loss: 14.630 Vali Loss: 11.243 Vali Acc: 0.380 Test Loss: 11.243 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.963119983673096
Epoch: 3, Steps: 35 | Train Loss: 11.530 Vali Loss: 21.872 Vali Acc: 0.550 Test Loss: 21.872 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.85498571395874
Epoch: 4, Steps: 35 | Train Loss: 14.561 Vali Loss: 24.368 Vali Acc: 0.470 Test Loss: 24.368 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.922964572906494
Epoch: 5, Steps: 35 | Train Loss: 13.761 Vali Loss: 24.005 Vali Acc: 0.480 Test Loss: 24.005 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.162042856216431
Epoch: 6, Steps: 35 | Train Loss: 16.426 Vali Loss: 36.971 Vali Acc: 0.540 Test Loss: 36.971 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.139971017837524
Epoch: 7, Steps: 35 | Train Loss: 9.261 Vali Loss: 31.552 Vali Acc: 0.540 Test Loss: 31.552 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.9679505825042725
Epoch: 8, Steps: 35 | Train Loss: 11.660 Vali Loss: 69.880 Vali Acc: 0.470 Test Loss: 69.880 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.542879581451416
Epoch: 9, Steps: 35 | Train Loss: 18.556 Vali Loss: 37.536 Vali Acc: 0.520 Test Loss: 37.536 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.649485111236572
Epoch: 10, Steps: 35 | Train Loss: 8.540 Vali Loss: 68.632 Vali Acc: 0.480 Test Loss: 68.632 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.599322080612183
Epoch: 11, Steps: 35 | Train Loss: 8.283 Vali Loss: 26.783 Vali Acc: 0.560 Test Loss: 26.783 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4815122
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.060099840164185
Epoch: 1, Steps: 35 | Train Loss: 6.733 Vali Loss: 7.325 Vali Acc: 0.560 Test Loss: 7.325 Test Acc: 0.560
Validation loss decreased (inf --> -0.559927).  Saving model ...
Epoch: 2 cost time: 7.620214223861694
Epoch: 2, Steps: 35 | Train Loss: 10.942 Vali Loss: 21.485 Vali Acc: 0.480 Test Loss: 21.485 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.291603088378906
Epoch: 3, Steps: 35 | Train Loss: 10.510 Vali Loss: 17.400 Vali Acc: 0.520 Test Loss: 17.400 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.082008838653564
Epoch: 4, Steps: 35 | Train Loss: 10.969 Vali Loss: 10.020 Vali Acc: 0.530 Test Loss: 10.020 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.84373140335083
Epoch: 5, Steps: 35 | Train Loss: 8.086 Vali Loss: 10.842 Vali Acc: 0.520 Test Loss: 10.842 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.161685943603516
Epoch: 6, Steps: 35 | Train Loss: 11.185 Vali Loss: 17.930 Vali Acc: 0.500 Test Loss: 17.930 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.005736589431763
Epoch: 7, Steps: 35 | Train Loss: 6.909 Vali Loss: 44.505 Vali Acc: 0.500 Test Loss: 44.505 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.885792970657349
Epoch: 8, Steps: 35 | Train Loss: 13.396 Vali Loss: 13.619 Vali Acc: 0.550 Test Loss: 13.619 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.306928873062134
Epoch: 9, Steps: 35 | Train Loss: 7.337 Vali Loss: 44.218 Vali Acc: 0.500 Test Loss: 44.218 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.92460036277771
Epoch: 10, Steps: 35 | Train Loss: 10.061 Vali Loss: 46.064 Vali Acc: 0.480 Test Loss: 46.064 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.852457523345947
Epoch: 11, Steps: 35 | Train Loss: 15.482 Vali Loss: 32.126 Vali Acc: 0.540 Test Loss: 32.126 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4290834
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.563768148422241
Epoch: 1, Steps: 35 | Train Loss: 6.351 Vali Loss: 5.679 Vali Acc: 0.550 Test Loss: 5.679 Test Acc: 0.550
Validation loss decreased (inf --> -0.549943).  Saving model ...
Epoch: 2 cost time: 7.494224309921265
Epoch: 2, Steps: 35 | Train Loss: 14.408 Vali Loss: 14.826 Vali Acc: 0.430 Test Loss: 14.826 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.6901633739471436
Epoch: 3, Steps: 35 | Train Loss: 12.111 Vali Loss: 26.402 Vali Acc: 0.480 Test Loss: 26.402 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.822836637496948
Epoch: 4, Steps: 35 | Train Loss: 13.028 Vali Loss: 33.937 Vali Acc: 0.440 Test Loss: 33.937 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.612677812576294
Epoch: 5, Steps: 35 | Train Loss: 15.986 Vali Loss: 12.037 Vali Acc: 0.500 Test Loss: 12.037 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.504839658737183
Epoch: 6, Steps: 35 | Train Loss: 11.176 Vali Loss: 27.538 Vali Acc: 0.530 Test Loss: 27.538 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.737673759460449
Epoch: 7, Steps: 35 | Train Loss: 8.437 Vali Loss: 64.359 Vali Acc: 0.490 Test Loss: 64.359 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.4782514572143555
Epoch: 8, Steps: 35 | Train Loss: 14.705 Vali Loss: 18.567 Vali Acc: 0.500 Test Loss: 18.567 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.381628036499023
Epoch: 9, Steps: 35 | Train Loss: 9.230 Vali Loss: 58.487 Vali Acc: 0.480 Test Loss: 58.487 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.713449954986572
Epoch: 10, Steps: 35 | Train Loss: 11.839 Vali Loss: 22.686 Vali Acc: 0.540 Test Loss: 22.686 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.543267488479614
Epoch: 11, Steps: 35 | Train Loss: 2.382 Vali Loss: 43.797 Vali Acc: 0.500 Test Loss: 43.797 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 4290834
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.217336893081665
Epoch: 1, Steps: 35 | Train Loss: 9.280 Vali Loss: 7.684 Vali Acc: 0.580 Test Loss: 7.684 Test Acc: 0.580
Validation loss decreased (inf --> -0.579923).  Saving model ...
Epoch: 2 cost time: 6.675600528717041
Epoch: 2, Steps: 35 | Train Loss: 10.268 Vali Loss: 24.543 Vali Acc: 0.390 Test Loss: 24.543 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.864823579788208
Epoch: 3, Steps: 35 | Train Loss: 15.074 Vali Loss: 17.062 Vali Acc: 0.560 Test Loss: 17.062 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.1665613651275635
Epoch: 4, Steps: 35 | Train Loss: 8.950 Vali Loss: 35.554 Vali Acc: 0.490 Test Loss: 35.554 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.130796670913696
Epoch: 5, Steps: 35 | Train Loss: 8.824 Vali Loss: 20.367 Vali Acc: 0.520 Test Loss: 20.367 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.098754405975342
Epoch: 6, Steps: 35 | Train Loss: 8.277 Vali Loss: 25.733 Vali Acc: 0.590 Test Loss: 25.733 Test Acc: 0.590
Validation loss decreased (-0.579923 --> -0.589743).  Saving model ...
Epoch: 7 cost time: 6.990870714187622
Epoch: 7, Steps: 35 | Train Loss: 11.475 Vali Loss: 20.903 Vali Acc: 0.480 Test Loss: 20.903 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.8735291957855225
Epoch: 8, Steps: 35 | Train Loss: 10.527 Vali Loss: 63.152 Vali Acc: 0.500 Test Loss: 63.152 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.767136096954346
Epoch: 9, Steps: 35 | Train Loss: 9.729 Vali Loss: 70.834 Vali Acc: 0.510 Test Loss: 70.834 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.980261564254761
Epoch: 10, Steps: 35 | Train Loss: 17.382 Vali Loss: 52.024 Vali Acc: 0.480 Test Loss: 52.024 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.1138763427734375
Epoch: 11, Steps: 35 | Train Loss: 8.942 Vali Loss: 43.459 Vali Acc: 0.540 Test Loss: 43.459 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.755470037460327
Epoch: 12, Steps: 35 | Train Loss: 7.732 Vali Loss: 46.517 Vali Acc: 0.520 Test Loss: 46.517 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.7639265060424805
Epoch: 13, Steps: 35 | Train Loss: 8.895 Vali Loss: 40.666 Vali Acc: 0.550 Test Loss: 40.666 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.021143674850464
Epoch: 14, Steps: 35 | Train Loss: 9.176 Vali Loss: 79.467 Vali Acc: 0.410 Test Loss: 79.467 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.915927410125732
Epoch: 15, Steps: 35 | Train Loss: 12.900 Vali Loss: 51.136 Vali Acc: 0.500 Test Loss: 51.136 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.950467109680176
Epoch: 16, Steps: 35 | Train Loss: 10.490 Vali Loss: 71.064 Vali Acc: 0.470 Test Loss: 71.064 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4290834
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.226650476455688
Epoch: 1, Steps: 35 | Train Loss: 6.206 Vali Loss: 9.938 Vali Acc: 0.590 Test Loss: 9.938 Test Acc: 0.590
Validation loss decreased (inf --> -0.589901).  Saving model ...
Epoch: 2 cost time: 6.15739893913269
Epoch: 2, Steps: 35 | Train Loss: 11.635 Vali Loss: 18.398 Vali Acc: 0.370 Test Loss: 18.398 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.498811721801758
Epoch: 3, Steps: 35 | Train Loss: 13.196 Vali Loss: 18.984 Vali Acc: 0.510 Test Loss: 18.984 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.21316385269165
Epoch: 4, Steps: 35 | Train Loss: 12.467 Vali Loss: 11.537 Vali Acc: 0.540 Test Loss: 11.537 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.626491069793701
Epoch: 5, Steps: 35 | Train Loss: 12.494 Vali Loss: 26.502 Vali Acc: 0.550 Test Loss: 26.502 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.3906919956207275
Epoch: 6, Steps: 35 | Train Loss: 7.203 Vali Loss: 19.976 Vali Acc: 0.500 Test Loss: 19.976 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.76419734954834
Epoch: 7, Steps: 35 | Train Loss: 10.956 Vali Loss: 22.898 Vali Acc: 0.530 Test Loss: 22.898 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.4358460903167725
Epoch: 8, Steps: 35 | Train Loss: 16.188 Vali Loss: 41.260 Vali Acc: 0.520 Test Loss: 41.260 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.317106485366821
Epoch: 9, Steps: 35 | Train Loss: 8.950 Vali Loss: 31.198 Vali Acc: 0.440 Test Loss: 31.198 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.551935911178589
Epoch: 10, Steps: 35 | Train Loss: 12.061 Vali Loss: 33.465 Vali Acc: 0.490 Test Loss: 33.465 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.504533767700195
Epoch: 11, Steps: 35 | Train Loss: 13.656 Vali Loss: 36.039 Vali Acc: 0.550 Test Loss: 36.039 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4290834
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.601039171218872
Epoch: 1, Steps: 35 | Train Loss: 13.279 Vali Loss: 15.651 Vali Acc: 0.430 Test Loss: 15.651 Test Acc: 0.430
Validation loss decreased (inf --> -0.429843).  Saving model ...
Epoch: 2 cost time: 8.032177448272705
Epoch: 2, Steps: 35 | Train Loss: 16.617 Vali Loss: 17.636 Vali Acc: 0.550 Test Loss: 17.636 Test Acc: 0.550
Validation loss decreased (-0.429843 --> -0.549824).  Saving model ...
Epoch: 3 cost time: 8.006814241409302
Epoch: 3, Steps: 35 | Train Loss: 13.989 Vali Loss: 20.960 Vali Acc: 0.510 Test Loss: 20.960 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.094568014144897
Epoch: 4, Steps: 35 | Train Loss: 12.896 Vali Loss: 20.365 Vali Acc: 0.480 Test Loss: 20.365 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.238966226577759
Epoch: 5, Steps: 35 | Train Loss: 18.534 Vali Loss: 17.971 Vali Acc: 0.510 Test Loss: 17.971 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.217305660247803
Epoch: 6, Steps: 35 | Train Loss: 19.851 Vali Loss: 24.357 Vali Acc: 0.460 Test Loss: 24.357 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.463314771652222
Epoch: 7, Steps: 35 | Train Loss: 13.370 Vali Loss: 34.170 Vali Acc: 0.510 Test Loss: 34.170 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.304073333740234
Epoch: 8, Steps: 35 | Train Loss: 15.705 Vali Loss: 29.533 Vali Acc: 0.420 Test Loss: 29.533 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.789760112762451
Epoch: 9, Steps: 35 | Train Loss: 11.608 Vali Loss: 28.796 Vali Acc: 0.560 Test Loss: 28.796 Test Acc: 0.560
Validation loss decreased (-0.549824 --> -0.559712).  Saving model ...
Epoch: 10 cost time: 8.391646146774292
Epoch: 10, Steps: 35 | Train Loss: 9.463 Vali Loss: 56.352 Vali Acc: 0.470 Test Loss: 56.352 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.555620431900024
Epoch: 11, Steps: 35 | Train Loss: 5.849 Vali Loss: 65.734 Vali Acc: 0.480 Test Loss: 65.734 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.149013996124268
Epoch: 12, Steps: 35 | Train Loss: 10.374 Vali Loss: 22.881 Vali Acc: 0.540 Test Loss: 22.881 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.24232268333435
Epoch: 13, Steps: 35 | Train Loss: 9.265 Vali Loss: 36.796 Vali Acc: 0.540 Test Loss: 36.796 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.500529050827026
Epoch: 14, Steps: 35 | Train Loss: 10.816 Vali Loss: 81.828 Vali Acc: 0.500 Test Loss: 81.828 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.414438009262085
Epoch: 15, Steps: 35 | Train Loss: 7.481 Vali Loss: 32.712 Vali Acc: 0.540 Test Loss: 32.712 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.44168996810913
Epoch: 16, Steps: 35 | Train Loss: 10.606 Vali Loss: 139.218 Vali Acc: 0.500 Test Loss: 139.218 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.15040922164917
Epoch: 17, Steps: 35 | Train Loss: 9.102 Vali Loss: 67.415 Vali Acc: 0.490 Test Loss: 67.415 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.497039556503296
Epoch: 18, Steps: 35 | Train Loss: 6.813 Vali Loss: 40.390 Vali Acc: 0.570 Test Loss: 40.390 Test Acc: 0.570
Validation loss decreased (-0.559712 --> -0.569596).  Saving model ...
Epoch: 19 cost time: 8.335495710372925
Epoch: 19, Steps: 35 | Train Loss: 3.234 Vali Loss: 45.949 Vali Acc: 0.480 Test Loss: 45.949 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.08599853515625
Epoch: 20, Steps: 35 | Train Loss: 8.016 Vali Loss: 41.896 Vali Acc: 0.540 Test Loss: 41.896 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.206438541412354
Epoch: 21, Steps: 35 | Train Loss: 2.478 Vali Loss: 37.046 Vali Acc: 0.550 Test Loss: 37.046 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.279390573501587
Epoch: 22, Steps: 35 | Train Loss: 3.646 Vali Loss: 49.823 Vali Acc: 0.470 Test Loss: 49.823 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.27412486076355
Epoch: 23, Steps: 35 | Train Loss: 4.037 Vali Loss: 62.617 Vali Acc: 0.550 Test Loss: 62.617 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.293162822723389
Epoch: 24, Steps: 35 | Train Loss: 8.244 Vali Loss: 46.899 Vali Acc: 0.540 Test Loss: 46.899 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.470685720443726
Epoch: 25, Steps: 35 | Train Loss: 6.919 Vali Loss: 64.847 Vali Acc: 0.510 Test Loss: 64.847 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 8.002639532089233
Epoch: 26, Steps: 35 | Train Loss: 1.752 Vali Loss: 72.598 Vali Acc: 0.490 Test Loss: 72.598 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.95091986656189
Epoch: 27, Steps: 35 | Train Loss: 15.275 Vali Loss: 147.734 Vali Acc: 0.490 Test Loss: 147.734 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.163328886032104
Epoch: 28, Steps: 35 | Train Loss: 12.795 Vali Loss: 60.999 Vali Acc: 0.490 Test Loss: 60.999 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4028690
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.256059169769287
Epoch: 1, Steps: 35 | Train Loss: 9.377 Vali Loss: 8.567 Vali Acc: 0.520 Test Loss: 8.567 Test Acc: 0.520
Validation loss decreased (inf --> -0.519914).  Saving model ...
Epoch: 2 cost time: 7.460539817810059
Epoch: 2, Steps: 35 | Train Loss: 13.731 Vali Loss: 9.406 Vali Acc: 0.560 Test Loss: 9.406 Test Acc: 0.560
Validation loss decreased (-0.519914 --> -0.559906).  Saving model ...
Epoch: 3 cost time: 7.545183420181274
Epoch: 3, Steps: 35 | Train Loss: 20.565 Vali Loss: 6.834 Vali Acc: 0.560 Test Loss: 6.834 Test Acc: 0.560
Validation loss decreased (-0.559906 --> -0.559932).  Saving model ...
Epoch: 4 cost time: 7.734626293182373
Epoch: 4, Steps: 35 | Train Loss: 8.750 Vali Loss: 21.250 Vali Acc: 0.500 Test Loss: 21.250 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.534074783325195
Epoch: 5, Steps: 35 | Train Loss: 12.041 Vali Loss: 26.579 Vali Acc: 0.480 Test Loss: 26.579 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.670002460479736
Epoch: 6, Steps: 35 | Train Loss: 10.947 Vali Loss: 20.134 Vali Acc: 0.450 Test Loss: 20.134 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.501449346542358
Epoch: 7, Steps: 35 | Train Loss: 12.681 Vali Loss: 50.030 Vali Acc: 0.490 Test Loss: 50.030 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.147971630096436
Epoch: 8, Steps: 35 | Train Loss: 11.943 Vali Loss: 11.629 Vali Acc: 0.510 Test Loss: 11.629 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.6069042682647705
Epoch: 9, Steps: 35 | Train Loss: 9.546 Vali Loss: 16.629 Vali Acc: 0.560 Test Loss: 16.629 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.114403009414673
Epoch: 10, Steps: 35 | Train Loss: 14.143 Vali Loss: 31.972 Vali Acc: 0.480 Test Loss: 31.972 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.8276262283325195
Epoch: 11, Steps: 35 | Train Loss: 14.663 Vali Loss: 33.613 Vali Acc: 0.490 Test Loss: 33.613 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.51694130897522
Epoch: 12, Steps: 35 | Train Loss: 8.908 Vali Loss: 74.001 Vali Acc: 0.500 Test Loss: 74.001 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.630005121231079
Epoch: 13, Steps: 35 | Train Loss: 10.733 Vali Loss: 62.246 Vali Acc: 0.510 Test Loss: 62.246 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4028690
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.905108213424683
Epoch: 1, Steps: 35 | Train Loss: 10.881 Vali Loss: 9.886 Vali Acc: 0.420 Test Loss: 9.886 Test Acc: 0.420
Validation loss decreased (inf --> -0.419901).  Saving model ...
Epoch: 2 cost time: 6.64680814743042
Epoch: 2, Steps: 35 | Train Loss: 18.406 Vali Loss: 16.917 Vali Acc: 0.500 Test Loss: 16.917 Test Acc: 0.500
Validation loss decreased (-0.419901 --> -0.499831).  Saving model ...
Epoch: 3 cost time: 6.905365467071533
Epoch: 3, Steps: 35 | Train Loss: 12.062 Vali Loss: 34.094 Vali Acc: 0.500 Test Loss: 34.094 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.094564199447632
Epoch: 4, Steps: 35 | Train Loss: 8.816 Vali Loss: 25.870 Vali Acc: 0.460 Test Loss: 25.870 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.718826770782471
Epoch: 5, Steps: 35 | Train Loss: 7.034 Vali Loss: 20.806 Vali Acc: 0.490 Test Loss: 20.806 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.755971431732178
Epoch: 6, Steps: 35 | Train Loss: 13.645 Vali Loss: 37.063 Vali Acc: 0.470 Test Loss: 37.063 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.755700349807739
Epoch: 7, Steps: 35 | Train Loss: 11.934 Vali Loss: 22.693 Vali Acc: 0.540 Test Loss: 22.693 Test Acc: 0.540
Validation loss decreased (-0.499831 --> -0.539773).  Saving model ...
Epoch: 8 cost time: 6.906081914901733
Epoch: 8, Steps: 35 | Train Loss: 17.531 Vali Loss: 46.368 Vali Acc: 0.470 Test Loss: 46.368 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.973989725112915
Epoch: 9, Steps: 35 | Train Loss: 20.074 Vali Loss: 33.371 Vali Acc: 0.560 Test Loss: 33.371 Test Acc: 0.560
Validation loss decreased (-0.539773 --> -0.559666).  Saving model ...
Epoch: 10 cost time: 6.8543431758880615
Epoch: 10, Steps: 35 | Train Loss: 18.003 Vali Loss: 56.395 Vali Acc: 0.490 Test Loss: 56.395 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.707452297210693
Epoch: 11, Steps: 35 | Train Loss: 11.696 Vali Loss: 93.898 Vali Acc: 0.440 Test Loss: 93.898 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.79844331741333
Epoch: 12, Steps: 35 | Train Loss: 16.110 Vali Loss: 59.357 Vali Acc: 0.460 Test Loss: 59.357 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.657956600189209
Epoch: 13, Steps: 35 | Train Loss: 10.646 Vali Loss: 48.167 Vali Acc: 0.540 Test Loss: 48.167 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.08526873588562
Epoch: 14, Steps: 35 | Train Loss: 15.377 Vali Loss: 63.002 Vali Acc: 0.510 Test Loss: 63.002 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.850961446762085
Epoch: 15, Steps: 35 | Train Loss: 9.245 Vali Loss: 39.709 Vali Acc: 0.540 Test Loss: 39.709 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.95263671875
Epoch: 16, Steps: 35 | Train Loss: 20.153 Vali Loss: 127.070 Vali Acc: 0.480 Test Loss: 127.070 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.578445911407471
Epoch: 17, Steps: 35 | Train Loss: 26.232 Vali Loss: 47.505 Vali Acc: 0.510 Test Loss: 47.505 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.050187349319458
Epoch: 18, Steps: 35 | Train Loss: 17.811 Vali Loss: 79.955 Vali Acc: 0.510 Test Loss: 79.955 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.594787836074829
Epoch: 19, Steps: 35 | Train Loss: 11.898 Vali Loss: 49.139 Vali Acc: 0.540 Test Loss: 49.139 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 4028690
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.571500301361084
Epoch: 1, Steps: 35 | Train Loss: 9.710 Vali Loss: 13.674 Vali Acc: 0.440 Test Loss: 13.674 Test Acc: 0.440
Validation loss decreased (inf --> -0.439863).  Saving model ...
Epoch: 2 cost time: 6.662157773971558
Epoch: 2, Steps: 35 | Train Loss: 11.739 Vali Loss: 16.746 Vali Acc: 0.560 Test Loss: 16.746 Test Acc: 0.560
Validation loss decreased (-0.439863 --> -0.559833).  Saving model ...
Epoch: 3 cost time: 6.708291053771973
Epoch: 3, Steps: 35 | Train Loss: 10.027 Vali Loss: 8.587 Vali Acc: 0.520 Test Loss: 8.587 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.776598930358887
Epoch: 4, Steps: 35 | Train Loss: 7.544 Vali Loss: 27.585 Vali Acc: 0.550 Test Loss: 27.585 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.470042705535889
Epoch: 5, Steps: 35 | Train Loss: 13.915 Vali Loss: 25.617 Vali Acc: 0.500 Test Loss: 25.617 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.300911903381348
Epoch: 6, Steps: 35 | Train Loss: 12.083 Vali Loss: 35.647 Vali Acc: 0.470 Test Loss: 35.647 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.021989822387695
Epoch: 7, Steps: 35 | Train Loss: 10.078 Vali Loss: 13.622 Vali Acc: 0.600 Test Loss: 13.622 Test Acc: 0.600
Validation loss decreased (-0.559833 --> -0.599864).  Saving model ...
Epoch: 8 cost time: 6.58000922203064
Epoch: 8, Steps: 35 | Train Loss: 15.553 Vali Loss: 39.206 Vali Acc: 0.430 Test Loss: 39.206 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.587929010391235
Epoch: 9, Steps: 35 | Train Loss: 9.990 Vali Loss: 39.652 Vali Acc: 0.510 Test Loss: 39.652 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.628973722457886
Epoch: 10, Steps: 35 | Train Loss: 14.075 Vali Loss: 30.161 Vali Acc: 0.480 Test Loss: 30.161 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.790008306503296
Epoch: 11, Steps: 35 | Train Loss: 15.639 Vali Loss: 71.834 Vali Acc: 0.480 Test Loss: 71.834 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.662487983703613
Epoch: 12, Steps: 35 | Train Loss: 16.588 Vali Loss: 53.067 Vali Acc: 0.520 Test Loss: 53.067 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.548016309738159
Epoch: 13, Steps: 35 | Train Loss: 10.404 Vali Loss: 45.597 Vali Acc: 0.500 Test Loss: 45.597 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.379222869873047
Epoch: 14, Steps: 35 | Train Loss: 9.516 Vali Loss: 32.203 Vali Acc: 0.480 Test Loss: 32.203 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.3294761180877686
Epoch: 15, Steps: 35 | Train Loss: 11.570 Vali Loss: 46.060 Vali Acc: 0.510 Test Loss: 46.060 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.240842580795288
Epoch: 16, Steps: 35 | Train Loss: 18.930 Vali Loss: 35.773 Vali Acc: 0.550 Test Loss: 35.773 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.439030408859253
Epoch: 17, Steps: 35 | Train Loss: 8.731 Vali Loss: 58.616 Vali Acc: 0.530 Test Loss: 58.616 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4028690
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.11240029335022
Epoch: 1, Steps: 35 | Train Loss: 5.873 Vali Loss: 13.230 Vali Acc: 0.450 Test Loss: 13.230 Test Acc: 0.450
Validation loss decreased (inf --> -0.449868).  Saving model ...
Epoch: 2 cost time: 7.8566200733184814
Epoch: 2, Steps: 35 | Train Loss: 12.653 Vali Loss: 8.639 Vali Acc: 0.550 Test Loss: 8.639 Test Acc: 0.550
Validation loss decreased (-0.449868 --> -0.549914).  Saving model ...
Epoch: 3 cost time: 8.226863861083984
Epoch: 3, Steps: 35 | Train Loss: 11.235 Vali Loss: 28.230 Vali Acc: 0.560 Test Loss: 28.230 Test Acc: 0.560
Validation loss decreased (-0.549914 --> -0.559718).  Saving model ...
Epoch: 4 cost time: 8.003960609436035
Epoch: 4, Steps: 35 | Train Loss: 17.782 Vali Loss: 77.058 Vali Acc: 0.510 Test Loss: 77.058 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.325300216674805
Epoch: 5, Steps: 35 | Train Loss: 17.781 Vali Loss: 27.458 Vali Acc: 0.490 Test Loss: 27.458 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.624065160751343
Epoch: 6, Steps: 35 | Train Loss: 14.118 Vali Loss: 32.037 Vali Acc: 0.520 Test Loss: 32.037 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.286994457244873
Epoch: 7, Steps: 35 | Train Loss: 7.179 Vali Loss: 15.351 Vali Acc: 0.490 Test Loss: 15.351 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.287894487380981
Epoch: 8, Steps: 35 | Train Loss: 13.885 Vali Loss: 41.049 Vali Acc: 0.440 Test Loss: 41.049 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.142137050628662
Epoch: 9, Steps: 35 | Train Loss: 7.469 Vali Loss: 33.511 Vali Acc: 0.470 Test Loss: 33.511 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.555010080337524
Epoch: 10, Steps: 35 | Train Loss: 7.358 Vali Loss: 57.788 Vali Acc: 0.510 Test Loss: 57.788 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.379061222076416
Epoch: 11, Steps: 35 | Train Loss: 15.796 Vali Loss: 55.028 Vali Acc: 0.510 Test Loss: 55.028 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.48511266708374
Epoch: 12, Steps: 35 | Train Loss: 10.500 Vali Loss: 23.920 Vali Acc: 0.580 Test Loss: 23.920 Test Acc: 0.580
Validation loss decreased (-0.559718 --> -0.579761).  Saving model ...
Epoch: 13 cost time: 8.297280073165894
Epoch: 13, Steps: 35 | Train Loss: 13.376 Vali Loss: 52.452 Vali Acc: 0.470 Test Loss: 52.452 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.480235815048218
Epoch: 14, Steps: 35 | Train Loss: 8.898 Vali Loss: 20.061 Vali Acc: 0.570 Test Loss: 20.061 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.370479345321655
Epoch: 15, Steps: 35 | Train Loss: 3.320 Vali Loss: 64.638 Vali Acc: 0.470 Test Loss: 64.638 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.393659591674805
Epoch: 16, Steps: 35 | Train Loss: 10.535 Vali Loss: 35.275 Vali Acc: 0.480 Test Loss: 35.275 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.260680675506592
Epoch: 17, Steps: 35 | Train Loss: 9.012 Vali Loss: 32.799 Vali Acc: 0.480 Test Loss: 32.799 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.379598617553711
Epoch: 18, Steps: 35 | Train Loss: 3.984 Vali Loss: 30.044 Vali Acc: 0.530 Test Loss: 30.044 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.463160514831543
Epoch: 19, Steps: 35 | Train Loss: 6.001 Vali Loss: 55.253 Vali Acc: 0.490 Test Loss: 55.253 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.349190711975098
Epoch: 20, Steps: 35 | Train Loss: 11.880 Vali Loss: 54.625 Vali Acc: 0.540 Test Loss: 54.625 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.660254001617432
Epoch: 21, Steps: 35 | Train Loss: 7.239 Vali Loss: 39.910 Vali Acc: 0.470 Test Loss: 39.910 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.431838512420654
Epoch: 22, Steps: 35 | Train Loss: 7.081 Vali Loss: 48.349 Vali Acc: 0.490 Test Loss: 48.349 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3897618
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.778467893600464
Epoch: 1, Steps: 35 | Train Loss: 7.235 Vali Loss: 26.090 Vali Acc: 0.490 Test Loss: 26.090 Test Acc: 0.490
Validation loss decreased (inf --> -0.489739).  Saving model ...
Epoch: 2 cost time: 7.392101287841797
Epoch: 2, Steps: 35 | Train Loss: 15.371 Vali Loss: 30.454 Vali Acc: 0.500 Test Loss: 30.454 Test Acc: 0.500
Validation loss decreased (-0.489739 --> -0.499695).  Saving model ...
Epoch: 3 cost time: 7.386218547821045
Epoch: 3, Steps: 35 | Train Loss: 14.633 Vali Loss: 21.598 Vali Acc: 0.510 Test Loss: 21.598 Test Acc: 0.510
Validation loss decreased (-0.499695 --> -0.509784).  Saving model ...
Epoch: 4 cost time: 7.556607484817505
Epoch: 4, Steps: 35 | Train Loss: 13.965 Vali Loss: 45.628 Vali Acc: 0.490 Test Loss: 45.628 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.831820249557495
Epoch: 5, Steps: 35 | Train Loss: 17.161 Vali Loss: 43.253 Vali Acc: 0.500 Test Loss: 43.253 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.635888576507568
Epoch: 6, Steps: 35 | Train Loss: 14.926 Vali Loss: 34.474 Vali Acc: 0.430 Test Loss: 34.474 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.5249340534210205
Epoch: 7, Steps: 35 | Train Loss: 9.956 Vali Loss: 21.131 Vali Acc: 0.490 Test Loss: 21.131 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.381665945053101
Epoch: 8, Steps: 35 | Train Loss: 11.940 Vali Loss: 35.150 Vali Acc: 0.470 Test Loss: 35.150 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.413323163986206
Epoch: 9, Steps: 35 | Train Loss: 8.372 Vali Loss: 49.028 Vali Acc: 0.500 Test Loss: 49.028 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.432048797607422
Epoch: 10, Steps: 35 | Train Loss: 11.245 Vali Loss: 42.152 Vali Acc: 0.460 Test Loss: 42.152 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.535715579986572
Epoch: 11, Steps: 35 | Train Loss: 7.688 Vali Loss: 24.266 Vali Acc: 0.570 Test Loss: 24.266 Test Acc: 0.570
Validation loss decreased (-0.509784 --> -0.569757).  Saving model ...
Epoch: 12 cost time: 7.439282655715942
Epoch: 12, Steps: 35 | Train Loss: 10.929 Vali Loss: 51.613 Vali Acc: 0.490 Test Loss: 51.613 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.874563694000244
Epoch: 13, Steps: 35 | Train Loss: 5.816 Vali Loss: 58.147 Vali Acc: 0.500 Test Loss: 58.147 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.740076541900635
Epoch: 14, Steps: 35 | Train Loss: 9.315 Vali Loss: 65.899 Vali Acc: 0.510 Test Loss: 65.899 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.849748611450195
Epoch: 15, Steps: 35 | Train Loss: 17.442 Vali Loss: 47.455 Vali Acc: 0.430 Test Loss: 47.455 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.014101266860962
Epoch: 16, Steps: 35 | Train Loss: 15.814 Vali Loss: 28.907 Vali Acc: 0.600 Test Loss: 28.907 Test Acc: 0.600
Validation loss decreased (-0.569757 --> -0.599711).  Saving model ...
Epoch: 17 cost time: 7.784096956253052
Epoch: 17, Steps: 35 | Train Loss: 9.523 Vali Loss: 61.839 Vali Acc: 0.510 Test Loss: 61.839 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.908857345581055
Epoch: 18, Steps: 35 | Train Loss: 5.774 Vali Loss: 46.023 Vali Acc: 0.490 Test Loss: 46.023 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.793339490890503
Epoch: 19, Steps: 35 | Train Loss: 2.951 Vali Loss: 50.559 Vali Acc: 0.570 Test Loss: 50.559 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.562101602554321
Epoch: 20, Steps: 35 | Train Loss: 9.972 Vali Loss: 53.040 Vali Acc: 0.520 Test Loss: 53.040 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.632245063781738
Epoch: 21, Steps: 35 | Train Loss: 5.427 Vali Loss: 46.526 Vali Acc: 0.540 Test Loss: 46.526 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.856055021286011
Epoch: 22, Steps: 35 | Train Loss: 9.575 Vali Loss: 85.047 Vali Acc: 0.520 Test Loss: 85.047 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.791639089584351
Epoch: 23, Steps: 35 | Train Loss: 6.003 Vali Loss: 114.834 Vali Acc: 0.510 Test Loss: 114.834 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.115269422531128
Epoch: 24, Steps: 35 | Train Loss: 10.422 Vali Loss: 61.280 Vali Acc: 0.560 Test Loss: 61.280 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.54350471496582
Epoch: 25, Steps: 35 | Train Loss: 18.194 Vali Loss: 69.828 Vali Acc: 0.510 Test Loss: 69.828 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.681536674499512
Epoch: 26, Steps: 35 | Train Loss: 8.459 Vali Loss: 60.454 Vali Acc: 0.520 Test Loss: 60.454 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3897618
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.054629564285278
Epoch: 1, Steps: 35 | Train Loss: 3.664 Vali Loss: 16.920 Vali Acc: 0.400 Test Loss: 16.920 Test Acc: 0.400
Validation loss decreased (inf --> -0.399831).  Saving model ...
Epoch: 2 cost time: 6.5133984088897705
Epoch: 2, Steps: 35 | Train Loss: 11.818 Vali Loss: 12.428 Vali Acc: 0.510 Test Loss: 12.428 Test Acc: 0.510
Validation loss decreased (-0.399831 --> -0.509876).  Saving model ...
Epoch: 3 cost time: 6.496103286743164
Epoch: 3, Steps: 35 | Train Loss: 13.007 Vali Loss: 19.678 Vali Acc: 0.450 Test Loss: 19.678 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.083883047103882
Epoch: 4, Steps: 35 | Train Loss: 21.384 Vali Loss: 21.862 Vali Acc: 0.470 Test Loss: 21.862 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.390746116638184
Epoch: 5, Steps: 35 | Train Loss: 19.380 Vali Loss: 15.533 Vali Acc: 0.450 Test Loss: 15.533 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.868142366409302
Epoch: 6, Steps: 35 | Train Loss: 12.376 Vali Loss: 17.138 Vali Acc: 0.460 Test Loss: 17.138 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.834454298019409
Epoch: 7, Steps: 35 | Train Loss: 11.245 Vali Loss: 33.254 Vali Acc: 0.590 Test Loss: 33.254 Test Acc: 0.590
Validation loss decreased (-0.509876 --> -0.589667).  Saving model ...
Epoch: 8 cost time: 6.725014686584473
Epoch: 8, Steps: 35 | Train Loss: 7.917 Vali Loss: 20.544 Vali Acc: 0.610 Test Loss: 20.544 Test Acc: 0.610
Validation loss decreased (-0.589667 --> -0.609795).  Saving model ...
Epoch: 9 cost time: 6.87284517288208
Epoch: 9, Steps: 35 | Train Loss: 18.690 Vali Loss: 35.824 Vali Acc: 0.550 Test Loss: 35.824 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.939712285995483
Epoch: 10, Steps: 35 | Train Loss: 11.484 Vali Loss: 88.416 Vali Acc: 0.490 Test Loss: 88.416 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.534394264221191
Epoch: 11, Steps: 35 | Train Loss: 12.116 Vali Loss: 68.842 Vali Acc: 0.510 Test Loss: 68.842 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.594452142715454
Epoch: 12, Steps: 35 | Train Loss: 6.838 Vali Loss: 35.470 Vali Acc: 0.540 Test Loss: 35.470 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.882589817047119
Epoch: 13, Steps: 35 | Train Loss: 12.732 Vali Loss: 43.847 Vali Acc: 0.520 Test Loss: 43.847 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.836345434188843
Epoch: 14, Steps: 35 | Train Loss: 7.477 Vali Loss: 41.449 Vali Acc: 0.520 Test Loss: 41.449 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.970257759094238
Epoch: 15, Steps: 35 | Train Loss: 9.633 Vali Loss: 95.075 Vali Acc: 0.500 Test Loss: 95.075 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.013158082962036
Epoch: 16, Steps: 35 | Train Loss: 11.765 Vali Loss: 37.121 Vali Acc: 0.570 Test Loss: 37.121 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.1039814949035645
Epoch: 17, Steps: 35 | Train Loss: 13.210 Vali Loss: 91.038 Vali Acc: 0.490 Test Loss: 91.038 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.6500115394592285
Epoch: 18, Steps: 35 | Train Loss: 8.366 Vali Loss: 34.457 Vali Acc: 0.460 Test Loss: 34.457 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3897618
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.05829119682312
Epoch: 1, Steps: 35 | Train Loss: 3.984 Vali Loss: 10.890 Vali Acc: 0.490 Test Loss: 10.890 Test Acc: 0.490
Validation loss decreased (inf --> -0.489891).  Saving model ...
Epoch: 2 cost time: 5.856557607650757
Epoch: 2, Steps: 35 | Train Loss: 10.924 Vali Loss: 18.610 Vali Acc: 0.520 Test Loss: 18.610 Test Acc: 0.520
Validation loss decreased (-0.489891 --> -0.519814).  Saving model ...
Epoch: 3 cost time: 5.924560308456421
Epoch: 3, Steps: 35 | Train Loss: 15.681 Vali Loss: 26.480 Vali Acc: 0.460 Test Loss: 26.480 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.244282007217407
Epoch: 4, Steps: 35 | Train Loss: 11.211 Vali Loss: 45.526 Vali Acc: 0.500 Test Loss: 45.526 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.065193176269531
Epoch: 5, Steps: 35 | Train Loss: 16.461 Vali Loss: 31.212 Vali Acc: 0.410 Test Loss: 31.212 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.986285448074341
Epoch: 6, Steps: 35 | Train Loss: 13.730 Vali Loss: 58.793 Vali Acc: 0.500 Test Loss: 58.793 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.0885608196258545
Epoch: 7, Steps: 35 | Train Loss: 17.943 Vali Loss: 27.685 Vali Acc: 0.470 Test Loss: 27.685 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.058572053909302
Epoch: 8, Steps: 35 | Train Loss: 11.540 Vali Loss: 25.205 Vali Acc: 0.480 Test Loss: 25.205 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.032491207122803
Epoch: 9, Steps: 35 | Train Loss: 9.933 Vali Loss: 27.100 Vali Acc: 0.480 Test Loss: 27.100 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.021940231323242
Epoch: 10, Steps: 35 | Train Loss: 9.973 Vali Loss: 43.579 Vali Acc: 0.510 Test Loss: 43.579 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.994750499725342
Epoch: 11, Steps: 35 | Train Loss: 10.056 Vali Loss: 32.463 Vali Acc: 0.480 Test Loss: 32.463 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.04998254776001
Epoch: 12, Steps: 35 | Train Loss: 14.351 Vali Loss: 35.590 Vali Acc: 0.440 Test Loss: 35.590 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 3897618
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.834072589874268
Epoch: 1, Steps: 35 | Train Loss: 5.138 Vali Loss: 3.637 Vali Acc: 0.500 Test Loss: 3.637 Test Acc: 0.500
Validation loss decreased (inf --> -0.499964).  Saving model ...
Epoch: 2 cost time: 7.791475057601929
Epoch: 2, Steps: 35 | Train Loss: 12.868 Vali Loss: 20.242 Vali Acc: 0.480 Test Loss: 20.242 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.728763580322266
Epoch: 3, Steps: 35 | Train Loss: 29.621 Vali Loss: 16.126 Vali Acc: 0.530 Test Loss: 16.126 Test Acc: 0.530
Validation loss decreased (-0.499964 --> -0.529839).  Saving model ...
Epoch: 4 cost time: 7.966080665588379
Epoch: 4, Steps: 35 | Train Loss: 26.486 Vali Loss: 28.633 Vali Acc: 0.460 Test Loss: 28.633 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.402440071105957
Epoch: 5, Steps: 35 | Train Loss: 15.502 Vali Loss: 38.458 Vali Acc: 0.520 Test Loss: 38.458 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.641624689102173
Epoch: 6, Steps: 35 | Train Loss: 16.043 Vali Loss: 32.193 Vali Acc: 0.520 Test Loss: 32.193 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.529043436050415
Epoch: 7, Steps: 35 | Train Loss: 22.901 Vali Loss: 78.183 Vali Acc: 0.490 Test Loss: 78.183 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.575865983963013
Epoch: 8, Steps: 35 | Train Loss: 21.165 Vali Loss: 25.341 Vali Acc: 0.470 Test Loss: 25.341 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.024423599243164
Epoch: 9, Steps: 35 | Train Loss: 13.499 Vali Loss: 72.199 Vali Acc: 0.500 Test Loss: 72.199 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.117711305618286
Epoch: 10, Steps: 35 | Train Loss: 11.186 Vali Loss: 21.095 Vali Acc: 0.520 Test Loss: 21.095 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.786118745803833
Epoch: 11, Steps: 35 | Train Loss: 4.815 Vali Loss: 70.079 Vali Acc: 0.490 Test Loss: 70.079 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.004588842391968
Epoch: 12, Steps: 35 | Train Loss: 6.695 Vali Loss: 40.648 Vali Acc: 0.530 Test Loss: 40.648 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.915149450302124
Epoch: 13, Steps: 35 | Train Loss: 6.090 Vali Loss: 51.481 Vali Acc: 0.480 Test Loss: 51.481 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 3832082
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.328176259994507
Epoch: 1, Steps: 35 | Train Loss: 5.152 Vali Loss: 5.187 Vali Acc: 0.530 Test Loss: 5.187 Test Acc: 0.530
Validation loss decreased (inf --> -0.529948).  Saving model ...
Epoch: 2 cost time: 6.897620916366577
Epoch: 2, Steps: 35 | Train Loss: 10.975 Vali Loss: 14.752 Vali Acc: 0.530 Test Loss: 14.752 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.0656678676605225
Epoch: 3, Steps: 35 | Train Loss: 16.234 Vali Loss: 20.866 Vali Acc: 0.510 Test Loss: 20.866 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.989511489868164
Epoch: 4, Steps: 35 | Train Loss: 19.173 Vali Loss: 42.014 Vali Acc: 0.480 Test Loss: 42.014 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.019876956939697
Epoch: 5, Steps: 35 | Train Loss: 15.894 Vali Loss: 18.596 Vali Acc: 0.510 Test Loss: 18.596 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.150752782821655
Epoch: 6, Steps: 35 | Train Loss: 11.757 Vali Loss: 20.215 Vali Acc: 0.510 Test Loss: 20.215 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.807875156402588
Epoch: 7, Steps: 35 | Train Loss: 16.264 Vali Loss: 40.483 Vali Acc: 0.510 Test Loss: 40.483 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.921153545379639
Epoch: 8, Steps: 35 | Train Loss: 9.806 Vali Loss: 46.277 Vali Acc: 0.460 Test Loss: 46.277 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.811634540557861
Epoch: 9, Steps: 35 | Train Loss: 8.909 Vali Loss: 22.489 Vali Acc: 0.510 Test Loss: 22.489 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.895933628082275
Epoch: 10, Steps: 35 | Train Loss: 7.644 Vali Loss: 46.821 Vali Acc: 0.450 Test Loss: 46.821 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.267552375793457
Epoch: 11, Steps: 35 | Train Loss: 9.988 Vali Loss: 58.039 Vali Acc: 0.460 Test Loss: 58.039 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 3832082
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.860440969467163
Epoch: 1, Steps: 35 | Train Loss: 5.924 Vali Loss: 6.851 Vali Acc: 0.450 Test Loss: 6.851 Test Acc: 0.450
Validation loss decreased (inf --> -0.449931).  Saving model ...
Epoch: 2 cost time: 6.424207448959351
Epoch: 2, Steps: 35 | Train Loss: 8.894 Vali Loss: 19.624 Vali Acc: 0.440 Test Loss: 19.624 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.370160818099976
Epoch: 3, Steps: 35 | Train Loss: 15.772 Vali Loss: 24.385 Vali Acc: 0.470 Test Loss: 24.385 Test Acc: 0.470
Validation loss decreased (-0.449931 --> -0.469756).  Saving model ...
Epoch: 4 cost time: 6.60635781288147
Epoch: 4, Steps: 35 | Train Loss: 8.054 Vali Loss: 20.234 Vali Acc: 0.480 Test Loss: 20.234 Test Acc: 0.480
Validation loss decreased (-0.469756 --> -0.479798).  Saving model ...
Epoch: 5 cost time: 6.66646146774292
Epoch: 5, Steps: 35 | Train Loss: 18.318 Vali Loss: 41.826 Vali Acc: 0.490 Test Loss: 41.826 Test Acc: 0.490
Validation loss decreased (-0.479798 --> -0.489582).  Saving model ...
Epoch: 6 cost time: 6.458754777908325
Epoch: 6, Steps: 35 | Train Loss: 20.398 Vali Loss: 48.384 Vali Acc: 0.490 Test Loss: 48.384 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.719710826873779
Epoch: 7, Steps: 35 | Train Loss: 12.616 Vali Loss: 66.001 Vali Acc: 0.500 Test Loss: 66.001 Test Acc: 0.500
Validation loss decreased (-0.489582 --> -0.499340).  Saving model ...
Epoch: 8 cost time: 7.037251710891724
Epoch: 8, Steps: 35 | Train Loss: 14.117 Vali Loss: 23.498 Vali Acc: 0.500 Test Loss: 23.498 Test Acc: 0.500
Validation loss decreased (-0.499340 --> -0.499765).  Saving model ...
Epoch: 9 cost time: 6.85321307182312
Epoch: 9, Steps: 35 | Train Loss: 12.817 Vali Loss: 58.389 Vali Acc: 0.490 Test Loss: 58.389 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.598587274551392
Epoch: 10, Steps: 35 | Train Loss: 12.549 Vali Loss: 46.648 Vali Acc: 0.500 Test Loss: 46.648 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.688020706176758
Epoch: 11, Steps: 35 | Train Loss: 13.774 Vali Loss: 36.363 Vali Acc: 0.540 Test Loss: 36.363 Test Acc: 0.540
Validation loss decreased (-0.499765 --> -0.539636).  Saving model ...
Epoch: 12 cost time: 6.663472890853882
Epoch: 12, Steps: 35 | Train Loss: 20.384 Vali Loss: 38.722 Vali Acc: 0.530 Test Loss: 38.722 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.432593584060669
Epoch: 13, Steps: 35 | Train Loss: 14.288 Vali Loss: 40.141 Vali Acc: 0.500 Test Loss: 40.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.9627320766448975
Epoch: 14, Steps: 35 | Train Loss: 7.934 Vali Loss: 77.131 Vali Acc: 0.480 Test Loss: 77.131 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.207812309265137
Epoch: 15, Steps: 35 | Train Loss: 15.748 Vali Loss: 34.843 Vali Acc: 0.500 Test Loss: 34.843 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.910951375961304
Epoch: 16, Steps: 35 | Train Loss: 6.707 Vali Loss: 90.356 Vali Acc: 0.510 Test Loss: 90.356 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.673323631286621
Epoch: 17, Steps: 35 | Train Loss: 16.393 Vali Loss: 31.045 Vali Acc: 0.510 Test Loss: 31.045 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.708837270736694
Epoch: 18, Steps: 35 | Train Loss: 9.955 Vali Loss: 79.205 Vali Acc: 0.500 Test Loss: 79.205 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.418419599533081
Epoch: 19, Steps: 35 | Train Loss: 7.891 Vali Loss: 84.857 Vali Acc: 0.470 Test Loss: 84.857 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.451132535934448
Epoch: 20, Steps: 35 | Train Loss: 17.997 Vali Loss: 38.493 Vali Acc: 0.560 Test Loss: 38.493 Test Acc: 0.560
Validation loss decreased (-0.539636 --> -0.559615).  Saving model ...
Epoch: 21 cost time: 7.005496025085449
Epoch: 21, Steps: 35 | Train Loss: 8.509 Vali Loss: 118.619 Vali Acc: 0.500 Test Loss: 118.619 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.751428127288818
Epoch: 22, Steps: 35 | Train Loss: 6.386 Vali Loss: 73.228 Vali Acc: 0.500 Test Loss: 73.228 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.870227575302124
Epoch: 23, Steps: 35 | Train Loss: 7.558 Vali Loss: 123.932 Vali Acc: 0.530 Test Loss: 123.932 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.458739280700684
Epoch: 24, Steps: 35 | Train Loss: 8.268 Vali Loss: 120.441 Vali Acc: 0.470 Test Loss: 120.441 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.6278910636901855
Epoch: 25, Steps: 35 | Train Loss: 12.831 Vali Loss: 60.232 Vali Acc: 0.520 Test Loss: 60.232 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.6296000480651855
Epoch: 26, Steps: 35 | Train Loss: 8.452 Vali Loss: 110.688 Vali Acc: 0.490 Test Loss: 110.688 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.60808801651001
Epoch: 27, Steps: 35 | Train Loss: 4.825 Vali Loss: 60.654 Vali Acc: 0.590 Test Loss: 60.654 Test Acc: 0.590
Validation loss decreased (-0.559615 --> -0.589393).  Saving model ...
Epoch: 28 cost time: 6.853398084640503
Epoch: 28, Steps: 35 | Train Loss: 5.120 Vali Loss: 63.958 Vali Acc: 0.520 Test Loss: 63.958 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.053044557571411
Epoch: 29, Steps: 35 | Train Loss: 1.856 Vali Loss: 103.431 Vali Acc: 0.510 Test Loss: 103.431 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.933688402175903
Epoch: 30, Steps: 35 | Train Loss: 8.887 Vali Loss: 99.367 Vali Acc: 0.530 Test Loss: 99.367 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.732808589935303
Epoch: 31, Steps: 35 | Train Loss: 5.278 Vali Loss: 88.762 Vali Acc: 0.530 Test Loss: 88.762 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.8262763023376465
Epoch: 32, Steps: 35 | Train Loss: 4.310 Vali Loss: 75.041 Vali Acc: 0.540 Test Loss: 75.041 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.922386169433594
Epoch: 33, Steps: 35 | Train Loss: 14.425 Vali Loss: 68.410 Vali Acc: 0.530 Test Loss: 68.410 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.974895477294922
Epoch: 34, Steps: 35 | Train Loss: 10.030 Vali Loss: 96.197 Vali Acc: 0.510 Test Loss: 96.197 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.8628387451171875
Epoch: 35, Steps: 35 | Train Loss: 3.916 Vali Loss: 89.417 Vali Acc: 0.540 Test Loss: 89.417 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.964602708816528
Epoch: 36, Steps: 35 | Train Loss: 2.027 Vali Loss: 73.654 Vali Acc: 0.540 Test Loss: 73.654 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.9145262241363525
Epoch: 37, Steps: 35 | Train Loss: 2.673 Vali Loss: 122.481 Vali Acc: 0.500 Test Loss: 122.481 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3832082
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.324833154678345
Epoch: 1, Steps: 35 | Train Loss: 8.551 Vali Loss: 7.493 Vali Acc: 0.560 Test Loss: 7.493 Test Acc: 0.560
Validation loss decreased (inf --> -0.559925).  Saving model ...
Epoch: 2 cost time: 6.067929983139038
Epoch: 2, Steps: 35 | Train Loss: 9.025 Vali Loss: 14.151 Vali Acc: 0.430 Test Loss: 14.151 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.330260992050171
Epoch: 3, Steps: 35 | Train Loss: 12.645 Vali Loss: 23.130 Vali Acc: 0.510 Test Loss: 23.130 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.936518907546997
Epoch: 4, Steps: 35 | Train Loss: 7.889 Vali Loss: 19.405 Vali Acc: 0.470 Test Loss: 19.405 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.095268964767456
Epoch: 5, Steps: 35 | Train Loss: 11.272 Vali Loss: 20.050 Vali Acc: 0.540 Test Loss: 20.050 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.17540717124939
Epoch: 6, Steps: 35 | Train Loss: 15.090 Vali Loss: 40.832 Vali Acc: 0.490 Test Loss: 40.832 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.0262556076049805
Epoch: 7, Steps: 35 | Train Loss: 20.417 Vali Loss: 111.611 Vali Acc: 0.480 Test Loss: 111.611 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.43087911605835
Epoch: 8, Steps: 35 | Train Loss: 21.695 Vali Loss: 24.652 Vali Acc: 0.530 Test Loss: 24.652 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.08439564704895
Epoch: 9, Steps: 35 | Train Loss: 10.681 Vali Loss: 56.589 Vali Acc: 0.480 Test Loss: 56.589 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.320736646652222
Epoch: 10, Steps: 35 | Train Loss: 15.372 Vali Loss: 70.594 Vali Acc: 0.480 Test Loss: 70.594 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.167906761169434
Epoch: 11, Steps: 35 | Train Loss: 9.030 Vali Loss: 23.594 Vali Acc: 0.570 Test Loss: 23.594 Test Acc: 0.570
Validation loss decreased (-0.559925 --> -0.569764).  Saving model ...
Epoch: 12 cost time: 6.310883522033691
Epoch: 12, Steps: 35 | Train Loss: 22.130 Vali Loss: 53.237 Vali Acc: 0.460 Test Loss: 53.237 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.2024617195129395
Epoch: 13, Steps: 35 | Train Loss: 12.017 Vali Loss: 57.280 Vali Acc: 0.460 Test Loss: 57.280 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.91341233253479
Epoch: 14, Steps: 35 | Train Loss: 11.590 Vali Loss: 53.301 Vali Acc: 0.490 Test Loss: 53.301 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.1839072704315186
Epoch: 15, Steps: 35 | Train Loss: 12.019 Vali Loss: 48.475 Vali Acc: 0.490 Test Loss: 48.475 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.1522698402404785
Epoch: 16, Steps: 35 | Train Loss: 17.206 Vali Loss: 67.776 Vali Acc: 0.450 Test Loss: 67.776 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.423120498657227
Epoch: 17, Steps: 35 | Train Loss: 17.600 Vali Loss: 77.338 Vali Acc: 0.500 Test Loss: 77.338 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.541486978530884
Epoch: 18, Steps: 35 | Train Loss: 4.641 Vali Loss: 58.500 Vali Acc: 0.500 Test Loss: 58.500 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.398758172988892
Epoch: 19, Steps: 35 | Train Loss: 5.508 Vali Loss: 47.072 Vali Acc: 0.490 Test Loss: 47.072 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.088634967803955
Epoch: 20, Steps: 35 | Train Loss: 4.307 Vali Loss: 47.575 Vali Acc: 0.530 Test Loss: 47.575 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.066706895828247
Epoch: 21, Steps: 35 | Train Loss: 3.210 Vali Loss: 46.158 Vali Acc: 0.550 Test Loss: 46.158 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3832082
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.99096941947937
Epoch: 1, Steps: 35 | Train Loss: 2.350 Vali Loss: 8.165 Vali Acc: 0.570 Test Loss: 8.165 Test Acc: 0.570
Validation loss decreased (inf --> -0.569918).  Saving model ...
Epoch: 2 cost time: 5.315169811248779
Epoch: 2, Steps: 35 | Train Loss: 7.011 Vali Loss: 5.549 Vali Acc: 0.510 Test Loss: 5.549 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.1050474643707275
Epoch: 3, Steps: 35 | Train Loss: 5.506 Vali Loss: 7.043 Vali Acc: 0.460 Test Loss: 7.043 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.396931409835815
Epoch: 4, Steps: 35 | Train Loss: 4.094 Vali Loss: 5.050 Vali Acc: 0.510 Test Loss: 5.050 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.689995527267456
Epoch: 5, Steps: 35 | Train Loss: 6.516 Vali Loss: 10.291 Vali Acc: 0.560 Test Loss: 10.291 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.486331462860107
Epoch: 6, Steps: 35 | Train Loss: 7.088 Vali Loss: 13.219 Vali Acc: 0.480 Test Loss: 13.219 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.470289707183838
Epoch: 7, Steps: 35 | Train Loss: 5.912 Vali Loss: 14.996 Vali Acc: 0.550 Test Loss: 14.996 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.412184238433838
Epoch: 8, Steps: 35 | Train Loss: 6.225 Vali Loss: 17.137 Vali Acc: 0.510 Test Loss: 17.137 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.363070726394653
Epoch: 9, Steps: 35 | Train Loss: 11.030 Vali Loss: 13.234 Vali Acc: 0.550 Test Loss: 13.234 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.452767848968506
Epoch: 10, Steps: 35 | Train Loss: 6.373 Vali Loss: 16.984 Vali Acc: 0.570 Test Loss: 16.984 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.369739770889282
Epoch: 11, Steps: 35 | Train Loss: 4.603 Vali Loss: 11.251 Vali Acc: 0.560 Test Loss: 11.251 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2800914
model size : 15.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.9198009967803955
Epoch: 1, Steps: 35 | Train Loss: 2.194 Vali Loss: 7.006 Vali Acc: 0.500 Test Loss: 7.006 Test Acc: 0.500
Validation loss decreased (inf --> -0.499930).  Saving model ...
Epoch: 2 cost time: 5.340604543685913
Epoch: 2, Steps: 35 | Train Loss: 4.527 Vali Loss: 7.504 Vali Acc: 0.500 Test Loss: 7.504 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.016566276550293
Epoch: 3, Steps: 35 | Train Loss: 7.400 Vali Loss: 11.919 Vali Acc: 0.500 Test Loss: 11.919 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.043210744857788
Epoch: 4, Steps: 35 | Train Loss: 8.693 Vali Loss: 17.171 Vali Acc: 0.520 Test Loss: 17.171 Test Acc: 0.520
Validation loss decreased (-0.499930 --> -0.519828).  Saving model ...
Epoch: 5 cost time: 5.014389991760254
Epoch: 5, Steps: 35 | Train Loss: 5.162 Vali Loss: 7.755 Vali Acc: 0.440 Test Loss: 7.755 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.286452293395996
Epoch: 6, Steps: 35 | Train Loss: 5.855 Vali Loss: 11.880 Vali Acc: 0.520 Test Loss: 11.880 Test Acc: 0.520
Validation loss decreased (-0.519828 --> -0.519881).  Saving model ...
Epoch: 7 cost time: 5.16773796081543
Epoch: 7, Steps: 35 | Train Loss: 6.687 Vali Loss: 9.017 Vali Acc: 0.600 Test Loss: 9.017 Test Acc: 0.600
Validation loss decreased (-0.519881 --> -0.599910).  Saving model ...
Epoch: 8 cost time: 5.146428108215332
Epoch: 8, Steps: 35 | Train Loss: 5.854 Vali Loss: 21.997 Vali Acc: 0.530 Test Loss: 21.997 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.99401330947876
Epoch: 9, Steps: 35 | Train Loss: 9.752 Vali Loss: 18.398 Vali Acc: 0.530 Test Loss: 18.398 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.927249431610107
Epoch: 10, Steps: 35 | Train Loss: 4.944 Vali Loss: 9.890 Vali Acc: 0.550 Test Loss: 9.890 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.998163938522339
Epoch: 11, Steps: 35 | Train Loss: 7.104 Vali Loss: 37.272 Vali Acc: 0.490 Test Loss: 37.272 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.855210065841675
Epoch: 12, Steps: 35 | Train Loss: 9.485 Vali Loss: 50.056 Vali Acc: 0.500 Test Loss: 50.056 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.849693536758423
Epoch: 13, Steps: 35 | Train Loss: 4.639 Vali Loss: 29.093 Vali Acc: 0.510 Test Loss: 29.093 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.894751310348511
Epoch: 14, Steps: 35 | Train Loss: 3.694 Vali Loss: 12.050 Vali Acc: 0.560 Test Loss: 12.050 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.822579860687256
Epoch: 15, Steps: 35 | Train Loss: 6.829 Vali Loss: 45.306 Vali Acc: 0.510 Test Loss: 45.306 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.964959383010864
Epoch: 16, Steps: 35 | Train Loss: 5.355 Vali Loss: 26.025 Vali Acc: 0.510 Test Loss: 26.025 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.093751907348633
Epoch: 17, Steps: 35 | Train Loss: 5.381 Vali Loss: 36.580 Vali Acc: 0.550 Test Loss: 36.580 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2800914
model size : 15.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.579658508300781
Epoch: 1, Steps: 35 | Train Loss: 2.414 Vali Loss: 7.959 Vali Acc: 0.550 Test Loss: 7.959 Test Acc: 0.550
Validation loss decreased (inf --> -0.549920).  Saving model ...
Epoch: 2 cost time: 4.34489107131958
Epoch: 2, Steps: 35 | Train Loss: 6.751 Vali Loss: 11.810 Vali Acc: 0.500 Test Loss: 11.810 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.41085410118103
Epoch: 3, Steps: 35 | Train Loss: 4.507 Vali Loss: 12.195 Vali Acc: 0.500 Test Loss: 12.195 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.238215684890747
Epoch: 4, Steps: 35 | Train Loss: 4.660 Vali Loss: 8.681 Vali Acc: 0.530 Test Loss: 8.681 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2898664474487305
Epoch: 5, Steps: 35 | Train Loss: 6.931 Vali Loss: 17.613 Vali Acc: 0.520 Test Loss: 17.613 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.2874391078948975
Epoch: 6, Steps: 35 | Train Loss: 8.634 Vali Loss: 29.026 Vali Acc: 0.500 Test Loss: 29.026 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.719944953918457
Epoch: 7, Steps: 35 | Train Loss: 7.236 Vali Loss: 14.870 Vali Acc: 0.480 Test Loss: 14.870 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.489209175109863
Epoch: 8, Steps: 35 | Train Loss: 7.077 Vali Loss: 26.151 Vali Acc: 0.480 Test Loss: 26.151 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.560302734375
Epoch: 9, Steps: 35 | Train Loss: 4.940 Vali Loss: 23.438 Vali Acc: 0.520 Test Loss: 23.438 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.621529817581177
Epoch: 10, Steps: 35 | Train Loss: 5.220 Vali Loss: 28.168 Vali Acc: 0.530 Test Loss: 28.168 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.330267667770386
Epoch: 11, Steps: 35 | Train Loss: 4.638 Vali Loss: 26.618 Vali Acc: 0.510 Test Loss: 26.618 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2800914
model size : 15.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.19125509262085
Epoch: 1, Steps: 35 | Train Loss: 1.836 Vali Loss: 3.093 Vali Acc: 0.590 Test Loss: 3.093 Test Acc: 0.590
Validation loss decreased (inf --> -0.589969).  Saving model ...
Epoch: 2 cost time: 4.1111369132995605
Epoch: 2, Steps: 35 | Train Loss: 4.339 Vali Loss: 6.635 Vali Acc: 0.510 Test Loss: 6.635 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.897106647491455
Epoch: 3, Steps: 35 | Train Loss: 5.326 Vali Loss: 8.468 Vali Acc: 0.490 Test Loss: 8.468 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.940793037414551
Epoch: 4, Steps: 35 | Train Loss: 4.437 Vali Loss: 8.960 Vali Acc: 0.530 Test Loss: 8.960 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.021349668502808
Epoch: 5, Steps: 35 | Train Loss: 6.338 Vali Loss: 14.879 Vali Acc: 0.520 Test Loss: 14.879 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.044672727584839
Epoch: 6, Steps: 35 | Train Loss: 11.945 Vali Loss: 35.188 Vali Acc: 0.500 Test Loss: 35.188 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.090574502944946
Epoch: 7, Steps: 35 | Train Loss: 10.196 Vali Loss: 18.875 Vali Acc: 0.470 Test Loss: 18.875 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.220866680145264
Epoch: 8, Steps: 35 | Train Loss: 5.971 Vali Loss: 13.214 Vali Acc: 0.470 Test Loss: 13.214 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.083804368972778
Epoch: 9, Steps: 35 | Train Loss: 5.390 Vali Loss: 16.482 Vali Acc: 0.530 Test Loss: 16.482 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.1460490226745605
Epoch: 10, Steps: 35 | Train Loss: 3.770 Vali Loss: 11.091 Vali Acc: 0.490 Test Loss: 11.091 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.320314645767212
Epoch: 11, Steps: 35 | Train Loss: 6.969 Vali Loss: 10.090 Vali Acc: 0.540 Test Loss: 10.090 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2800914
model size : 15.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.046670913696289
Epoch: 1, Steps: 35 | Train Loss: 3.023 Vali Loss: 5.742 Vali Acc: 0.520 Test Loss: 5.742 Test Acc: 0.520
Validation loss decreased (inf --> -0.519943).  Saving model ...
Epoch: 2 cost time: 5.000921726226807
Epoch: 2, Steps: 35 | Train Loss: 4.837 Vali Loss: 11.294 Vali Acc: 0.540 Test Loss: 11.294 Test Acc: 0.540
Validation loss decreased (-0.519943 --> -0.539887).  Saving model ...
Epoch: 3 cost time: 4.933507442474365
Epoch: 3, Steps: 35 | Train Loss: 12.429 Vali Loss: 5.630 Vali Acc: 0.530 Test Loss: 5.630 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.114410400390625
Epoch: 4, Steps: 35 | Train Loss: 8.083 Vali Loss: 12.392 Vali Acc: 0.530 Test Loss: 12.392 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.137476205825806
Epoch: 5, Steps: 35 | Train Loss: 9.275 Vali Loss: 25.749 Vali Acc: 0.420 Test Loss: 25.749 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.258167505264282
Epoch: 6, Steps: 35 | Train Loss: 9.221 Vali Loss: 5.475 Vali Acc: 0.550 Test Loss: 5.475 Test Acc: 0.550
Validation loss decreased (-0.539887 --> -0.549945).  Saving model ...
Epoch: 7 cost time: 5.451777219772339
Epoch: 7, Steps: 35 | Train Loss: 4.798 Vali Loss: 18.516 Vali Acc: 0.500 Test Loss: 18.516 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.287206411361694
Epoch: 8, Steps: 35 | Train Loss: 12.084 Vali Loss: 11.815 Vali Acc: 0.470 Test Loss: 11.815 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.2649147510528564
Epoch: 9, Steps: 35 | Train Loss: 12.399 Vali Loss: 14.894 Vali Acc: 0.510 Test Loss: 14.894 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.103608131408691
Epoch: 10, Steps: 35 | Train Loss: 10.240 Vali Loss: 12.892 Vali Acc: 0.540 Test Loss: 12.892 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.0814807415008545
Epoch: 11, Steps: 35 | Train Loss: 4.629 Vali Loss: 17.754 Vali Acc: 0.450 Test Loss: 17.754 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.987973928451538
Epoch: 12, Steps: 35 | Train Loss: 7.141 Vali Loss: 19.180 Vali Acc: 0.450 Test Loss: 19.180 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.2152628898620605
Epoch: 13, Steps: 35 | Train Loss: 7.222 Vali Loss: 20.572 Vali Acc: 0.500 Test Loss: 20.572 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.09885573387146
Epoch: 14, Steps: 35 | Train Loss: 9.007 Vali Loss: 36.126 Vali Acc: 0.520 Test Loss: 36.126 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.2801125049591064
Epoch: 15, Steps: 35 | Train Loss: 9.060 Vali Loss: 16.218 Vali Acc: 0.510 Test Loss: 16.218 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.391129493713379
Epoch: 16, Steps: 35 | Train Loss: 9.118 Vali Loss: 36.592 Vali Acc: 0.510 Test Loss: 36.592 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2276626
model size : 13.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.279529333114624
Epoch: 1, Steps: 35 | Train Loss: 2.988 Vali Loss: 11.008 Vali Acc: 0.490 Test Loss: 11.008 Test Acc: 0.490
Validation loss decreased (inf --> -0.489890).  Saving model ...
Epoch: 2 cost time: 4.353801965713501
Epoch: 2, Steps: 35 | Train Loss: 4.875 Vali Loss: 10.310 Vali Acc: 0.520 Test Loss: 10.310 Test Acc: 0.520
Validation loss decreased (-0.489890 --> -0.519897).  Saving model ...
Epoch: 3 cost time: 4.342044830322266
Epoch: 3, Steps: 35 | Train Loss: 8.448 Vali Loss: 22.757 Vali Acc: 0.490 Test Loss: 22.757 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.545001983642578
Epoch: 4, Steps: 35 | Train Loss: 7.699 Vali Loss: 4.504 Vali Acc: 0.540 Test Loss: 4.504 Test Acc: 0.540
Validation loss decreased (-0.519897 --> -0.539955).  Saving model ...
Epoch: 5 cost time: 4.525528192520142
Epoch: 5, Steps: 35 | Train Loss: 8.043 Vali Loss: 16.827 Vali Acc: 0.490 Test Loss: 16.827 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.897420167922974
Epoch: 6, Steps: 35 | Train Loss: 10.441 Vali Loss: 9.354 Vali Acc: 0.520 Test Loss: 9.354 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.389370679855347
Epoch: 7, Steps: 35 | Train Loss: 4.548 Vali Loss: 15.026 Vali Acc: 0.590 Test Loss: 15.026 Test Acc: 0.590
Validation loss decreased (-0.539955 --> -0.589850).  Saving model ...
Epoch: 8 cost time: 4.432122230529785
Epoch: 8, Steps: 35 | Train Loss: 10.052 Vali Loss: 15.987 Vali Acc: 0.520 Test Loss: 15.987 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.729782581329346
Epoch: 9, Steps: 35 | Train Loss: 9.097 Vali Loss: 13.752 Vali Acc: 0.530 Test Loss: 13.752 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.047102212905884
Epoch: 10, Steps: 35 | Train Loss: 5.503 Vali Loss: 14.815 Vali Acc: 0.510 Test Loss: 14.815 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.711052894592285
Epoch: 11, Steps: 35 | Train Loss: 6.442 Vali Loss: 16.520 Vali Acc: 0.540 Test Loss: 16.520 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.704681396484375
Epoch: 12, Steps: 35 | Train Loss: 4.833 Vali Loss: 27.623 Vali Acc: 0.530 Test Loss: 27.623 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.028339147567749
Epoch: 13, Steps: 35 | Train Loss: 13.305 Vali Loss: 16.975 Vali Acc: 0.470 Test Loss: 16.975 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.133907318115234
Epoch: 14, Steps: 35 | Train Loss: 11.606 Vali Loss: 27.328 Vali Acc: 0.550 Test Loss: 27.328 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.888376235961914
Epoch: 15, Steps: 35 | Train Loss: 11.871 Vali Loss: 31.582 Vali Acc: 0.480 Test Loss: 31.582 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.850439071655273
Epoch: 16, Steps: 35 | Train Loss: 6.912 Vali Loss: 44.562 Vali Acc: 0.510 Test Loss: 44.562 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.847387075424194
Epoch: 17, Steps: 35 | Train Loss: 5.146 Vali Loss: 20.123 Vali Acc: 0.540 Test Loss: 20.123 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2276626
model size : 13.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.0968239307403564
Epoch: 1, Steps: 35 | Train Loss: 2.759 Vali Loss: 3.020 Vali Acc: 0.430 Test Loss: 3.020 Test Acc: 0.430
Validation loss decreased (inf --> -0.429970).  Saving model ...
Epoch: 2 cost time: 3.950218439102173
Epoch: 2, Steps: 35 | Train Loss: 6.853 Vali Loss: 9.359 Vali Acc: 0.420 Test Loss: 9.359 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.939216136932373
Epoch: 3, Steps: 35 | Train Loss: 5.789 Vali Loss: 14.449 Vali Acc: 0.540 Test Loss: 14.449 Test Acc: 0.540
Validation loss decreased (-0.429970 --> -0.539856).  Saving model ...
Epoch: 4 cost time: 4.052026033401489
Epoch: 4, Steps: 35 | Train Loss: 9.147 Vali Loss: 18.622 Vali Acc: 0.430 Test Loss: 18.622 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.329452037811279
Epoch: 5, Steps: 35 | Train Loss: 6.052 Vali Loss: 21.822 Vali Acc: 0.390 Test Loss: 21.822 Test Acc: 0.390
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.049320697784424
Epoch: 6, Steps: 35 | Train Loss: 8.047 Vali Loss: 12.245 Vali Acc: 0.550 Test Loss: 12.245 Test Acc: 0.550
Validation loss decreased (-0.539856 --> -0.549878).  Saving model ...
Epoch: 7 cost time: 4.145161390304565
Epoch: 7, Steps: 35 | Train Loss: 3.092 Vali Loss: 12.191 Vali Acc: 0.550 Test Loss: 12.191 Test Acc: 0.550
Validation loss decreased (-0.549878 --> -0.549878).  Saving model ...
Epoch: 8 cost time: 4.126183986663818
Epoch: 8, Steps: 35 | Train Loss: 5.098 Vali Loss: 15.598 Vali Acc: 0.510 Test Loss: 15.598 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.350010871887207
Epoch: 9, Steps: 35 | Train Loss: 9.667 Vali Loss: 14.543 Vali Acc: 0.490 Test Loss: 14.543 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.200251817703247
Epoch: 10, Steps: 35 | Train Loss: 7.144 Vali Loss: 11.561 Vali Acc: 0.480 Test Loss: 11.561 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.096489191055298
Epoch: 11, Steps: 35 | Train Loss: 4.220 Vali Loss: 18.011 Vali Acc: 0.490 Test Loss: 18.011 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.212150573730469
Epoch: 12, Steps: 35 | Train Loss: 13.076 Vali Loss: 29.261 Vali Acc: 0.520 Test Loss: 29.261 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.243353843688965
Epoch: 13, Steps: 35 | Train Loss: 7.119 Vali Loss: 25.938 Vali Acc: 0.460 Test Loss: 25.938 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.26157808303833
Epoch: 14, Steps: 35 | Train Loss: 11.267 Vali Loss: 67.982 Vali Acc: 0.500 Test Loss: 67.982 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.376335382461548
Epoch: 15, Steps: 35 | Train Loss: 19.893 Vali Loss: 28.233 Vali Acc: 0.550 Test Loss: 28.233 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.413630247116089
Epoch: 16, Steps: 35 | Train Loss: 8.174 Vali Loss: 30.511 Vali Acc: 0.520 Test Loss: 30.511 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.2934417724609375
Epoch: 17, Steps: 35 | Train Loss: 3.646 Vali Loss: 47.399 Vali Acc: 0.530 Test Loss: 47.399 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2276626
model size : 13.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.150731086730957
Epoch: 1, Steps: 35 | Train Loss: 2.232 Vali Loss: 5.768 Vali Acc: 0.480 Test Loss: 5.768 Test Acc: 0.480
Validation loss decreased (inf --> -0.479942).  Saving model ...
Epoch: 2 cost time: 3.93345308303833
Epoch: 2, Steps: 35 | Train Loss: 4.890 Vali Loss: 2.793 Vali Acc: 0.500 Test Loss: 2.793 Test Acc: 0.500
Validation loss decreased (-0.479942 --> -0.499972).  Saving model ...
Epoch: 3 cost time: 3.7432916164398193
Epoch: 3, Steps: 35 | Train Loss: 7.035 Vali Loss: 8.494 Vali Acc: 0.510 Test Loss: 8.494 Test Acc: 0.510
Validation loss decreased (-0.499972 --> -0.509915).  Saving model ...
Epoch: 4 cost time: 3.941349506378174
Epoch: 4, Steps: 35 | Train Loss: 7.386 Vali Loss: 4.068 Vali Acc: 0.520 Test Loss: 4.068 Test Acc: 0.520
Validation loss decreased (-0.509915 --> -0.519959).  Saving model ...
Epoch: 5 cost time: 3.7654130458831787
Epoch: 5, Steps: 35 | Train Loss: 4.230 Vali Loss: 13.418 Vali Acc: 0.460 Test Loss: 13.418 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.67659330368042
Epoch: 6, Steps: 35 | Train Loss: 7.514 Vali Loss: 6.129 Vali Acc: 0.510 Test Loss: 6.129 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.643850564956665
Epoch: 7, Steps: 35 | Train Loss: 8.789 Vali Loss: 21.226 Vali Acc: 0.480 Test Loss: 21.226 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7256760597229004
Epoch: 8, Steps: 35 | Train Loss: 11.653 Vali Loss: 12.258 Vali Acc: 0.520 Test Loss: 12.258 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.684258460998535
Epoch: 9, Steps: 35 | Train Loss: 9.328 Vali Loss: 21.926 Vali Acc: 0.450 Test Loss: 21.926 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.7725765705108643
Epoch: 10, Steps: 35 | Train Loss: 4.454 Vali Loss: 14.912 Vali Acc: 0.490 Test Loss: 14.912 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7389116287231445
Epoch: 11, Steps: 35 | Train Loss: 7.966 Vali Loss: 24.594 Vali Acc: 0.490 Test Loss: 24.594 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.67872953414917
Epoch: 12, Steps: 35 | Train Loss: 9.595 Vali Loss: 16.941 Vali Acc: 0.470 Test Loss: 16.941 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.8808772563934326
Epoch: 13, Steps: 35 | Train Loss: 11.663 Vali Loss: 21.261 Vali Acc: 0.500 Test Loss: 21.261 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.792294979095459
Epoch: 14, Steps: 35 | Train Loss: 5.757 Vali Loss: 13.670 Vali Acc: 0.560 Test Loss: 13.670 Test Acc: 0.560
Validation loss decreased (-0.519959 --> -0.559863).  Saving model ...
Epoch: 15 cost time: 3.7713544368743896
Epoch: 15, Steps: 35 | Train Loss: 6.067 Vali Loss: 20.058 Vali Acc: 0.560 Test Loss: 20.058 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8792593479156494
Epoch: 16, Steps: 35 | Train Loss: 5.375 Vali Loss: 27.781 Vali Acc: 0.480 Test Loss: 27.781 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8227436542510986
Epoch: 17, Steps: 35 | Train Loss: 5.557 Vali Loss: 15.343 Vali Acc: 0.550 Test Loss: 15.343 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.795632839202881
Epoch: 18, Steps: 35 | Train Loss: 5.332 Vali Loss: 22.807 Vali Acc: 0.490 Test Loss: 22.807 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.681368112564087
Epoch: 19, Steps: 35 | Train Loss: 7.562 Vali Loss: 19.147 Vali Acc: 0.490 Test Loss: 19.147 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6863834857940674
Epoch: 20, Steps: 35 | Train Loss: 3.150 Vali Loss: 25.498 Vali Acc: 0.470 Test Loss: 25.498 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6303398609161377
Epoch: 21, Steps: 35 | Train Loss: 6.431 Vali Loss: 19.173 Vali Acc: 0.520 Test Loss: 19.173 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7403135299682617
Epoch: 22, Steps: 35 | Train Loss: 3.436 Vali Loss: 15.111 Vali Acc: 0.510 Test Loss: 15.111 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.003757953643799
Epoch: 23, Steps: 35 | Train Loss: 2.453 Vali Loss: 20.132 Vali Acc: 0.520 Test Loss: 20.132 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.980990409851074
Epoch: 24, Steps: 35 | Train Loss: 3.897 Vali Loss: 28.720 Vali Acc: 0.570 Test Loss: 28.720 Test Acc: 0.570
Validation loss decreased (-0.559863 --> -0.569713).  Saving model ...
Epoch: 25 cost time: 3.852295398712158
Epoch: 25, Steps: 35 | Train Loss: 3.293 Vali Loss: 23.019 Vali Acc: 0.600 Test Loss: 23.019 Test Acc: 0.600
Validation loss decreased (-0.569713 --> -0.599770).  Saving model ...
Epoch: 26 cost time: 3.815441608428955
Epoch: 26, Steps: 35 | Train Loss: 1.568 Vali Loss: 30.581 Vali Acc: 0.540 Test Loss: 30.581 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.776034116744995
Epoch: 27, Steps: 35 | Train Loss: 3.527 Vali Loss: 29.621 Vali Acc: 0.520 Test Loss: 29.621 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8342010974884033
Epoch: 28, Steps: 35 | Train Loss: 7.141 Vali Loss: 20.245 Vali Acc: 0.570 Test Loss: 20.245 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.761336326599121
Epoch: 29, Steps: 35 | Train Loss: 4.528 Vali Loss: 27.498 Vali Acc: 0.530 Test Loss: 27.498 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.8643407821655273
Epoch: 30, Steps: 35 | Train Loss: 5.203 Vali Loss: 50.952 Vali Acc: 0.510 Test Loss: 50.952 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.7974226474761963
Epoch: 31, Steps: 35 | Train Loss: 6.717 Vali Loss: 20.932 Vali Acc: 0.550 Test Loss: 20.932 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.8230931758880615
Epoch: 32, Steps: 35 | Train Loss: 3.628 Vali Loss: 37.725 Vali Acc: 0.490 Test Loss: 37.725 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.839723587036133
Epoch: 33, Steps: 35 | Train Loss: 2.786 Vali Loss: 45.357 Vali Acc: 0.530 Test Loss: 45.357 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.6907174587249756
Epoch: 34, Steps: 35 | Train Loss: 1.921 Vali Loss: 26.796 Vali Acc: 0.480 Test Loss: 26.796 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.6667227745056152
Epoch: 35, Steps: 35 | Train Loss: 3.521 Vali Loss: 34.565 Vali Acc: 0.510 Test Loss: 34.565 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2276626
model size : 13.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.962234258651733
Epoch: 1, Steps: 35 | Train Loss: 4.275 Vali Loss: 6.558 Vali Acc: 0.500 Test Loss: 6.558 Test Acc: 0.500
Validation loss decreased (inf --> -0.499934).  Saving model ...
Epoch: 2 cost time: 4.7856972217559814
Epoch: 2, Steps: 35 | Train Loss: 7.997 Vali Loss: 23.551 Vali Acc: 0.460 Test Loss: 23.551 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.742784023284912
Epoch: 3, Steps: 35 | Train Loss: 10.695 Vali Loss: 7.308 Vali Acc: 0.580 Test Loss: 7.308 Test Acc: 0.580
Validation loss decreased (-0.499934 --> -0.579927).  Saving model ...
Epoch: 4 cost time: 4.719522953033447
Epoch: 4, Steps: 35 | Train Loss: 10.140 Vali Loss: 8.093 Vali Acc: 0.590 Test Loss: 8.093 Test Acc: 0.590
Validation loss decreased (-0.579927 --> -0.589919).  Saving model ...
Epoch: 5 cost time: 4.7916951179504395
Epoch: 5, Steps: 35 | Train Loss: 10.685 Vali Loss: 12.046 Vali Acc: 0.490 Test Loss: 12.046 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.76562237739563
Epoch: 6, Steps: 35 | Train Loss: 10.401 Vali Loss: 7.930 Vali Acc: 0.490 Test Loss: 7.930 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.792277097702026
Epoch: 7, Steps: 35 | Train Loss: 5.298 Vali Loss: 9.850 Vali Acc: 0.610 Test Loss: 9.850 Test Acc: 0.610
Validation loss decreased (-0.589919 --> -0.609902).  Saving model ...
Epoch: 8 cost time: 4.681983709335327
Epoch: 8, Steps: 35 | Train Loss: 5.161 Vali Loss: 19.398 Vali Acc: 0.420 Test Loss: 19.398 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.6635191440582275
Epoch: 9, Steps: 35 | Train Loss: 7.456 Vali Loss: 19.185 Vali Acc: 0.600 Test Loss: 19.185 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.816997528076172
Epoch: 10, Steps: 35 | Train Loss: 11.801 Vali Loss: 12.009 Vali Acc: 0.530 Test Loss: 12.009 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.648643255233765
Epoch: 11, Steps: 35 | Train Loss: 5.378 Vali Loss: 27.884 Vali Acc: 0.520 Test Loss: 27.884 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.787473440170288
Epoch: 12, Steps: 35 | Train Loss: 5.668 Vali Loss: 27.367 Vali Acc: 0.470 Test Loss: 27.367 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.893257141113281
Epoch: 13, Steps: 35 | Train Loss: 8.619 Vali Loss: 23.746 Vali Acc: 0.500 Test Loss: 23.746 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.958840847015381
Epoch: 14, Steps: 35 | Train Loss: 6.061 Vali Loss: 62.282 Vali Acc: 0.500 Test Loss: 62.282 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.8529417514801025
Epoch: 15, Steps: 35 | Train Loss: 6.021 Vali Loss: 59.926 Vali Acc: 0.500 Test Loss: 59.926 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.944577693939209
Epoch: 16, Steps: 35 | Train Loss: 9.444 Vali Loss: 47.621 Vali Acc: 0.500 Test Loss: 47.621 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.042239189147949
Epoch: 17, Steps: 35 | Train Loss: 4.579 Vali Loss: 20.571 Vali Acc: 0.540 Test Loss: 20.571 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2014482
model size : 12.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.310288429260254
Epoch: 1, Steps: 35 | Train Loss: 3.406 Vali Loss: 3.566 Vali Acc: 0.510 Test Loss: 3.566 Test Acc: 0.510
Validation loss decreased (inf --> -0.509964).  Saving model ...
Epoch: 2 cost time: 4.25987434387207
Epoch: 2, Steps: 35 | Train Loss: 5.517 Vali Loss: 16.784 Vali Acc: 0.490 Test Loss: 16.784 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.471242189407349
Epoch: 3, Steps: 35 | Train Loss: 7.032 Vali Loss: 8.372 Vali Acc: 0.490 Test Loss: 8.372 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.389424085617065
Epoch: 4, Steps: 35 | Train Loss: 6.426 Vali Loss: 6.677 Vali Acc: 0.580 Test Loss: 6.677 Test Acc: 0.580
Validation loss decreased (-0.509964 --> -0.579933).  Saving model ...
Epoch: 5 cost time: 4.376960515975952
Epoch: 5, Steps: 35 | Train Loss: 7.691 Vali Loss: 10.870 Vali Acc: 0.560 Test Loss: 10.870 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.242913484573364
Epoch: 6, Steps: 35 | Train Loss: 9.479 Vali Loss: 36.648 Vali Acc: 0.480 Test Loss: 36.648 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.321825265884399
Epoch: 7, Steps: 35 | Train Loss: 8.497 Vali Loss: 35.220 Vali Acc: 0.510 Test Loss: 35.220 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.4230124950408936
Epoch: 8, Steps: 35 | Train Loss: 6.718 Vali Loss: 15.842 Vali Acc: 0.480 Test Loss: 15.842 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.238434076309204
Epoch: 9, Steps: 35 | Train Loss: 6.719 Vali Loss: 34.979 Vali Acc: 0.520 Test Loss: 34.979 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.26630711555481
Epoch: 10, Steps: 35 | Train Loss: 10.018 Vali Loss: 20.113 Vali Acc: 0.480 Test Loss: 20.113 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.367496490478516
Epoch: 11, Steps: 35 | Train Loss: 4.228 Vali Loss: 28.190 Vali Acc: 0.500 Test Loss: 28.190 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.615930557250977
Epoch: 12, Steps: 35 | Train Loss: 6.561 Vali Loss: 23.120 Vali Acc: 0.520 Test Loss: 23.120 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.499006986618042
Epoch: 13, Steps: 35 | Train Loss: 4.809 Vali Loss: 15.406 Vali Acc: 0.520 Test Loss: 15.406 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.386966943740845
Epoch: 14, Steps: 35 | Train Loss: 9.388 Vali Loss: 26.640 Vali Acc: 0.500 Test Loss: 26.640 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2014482
model size : 12.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.908722400665283
Epoch: 1, Steps: 35 | Train Loss: 3.311 Vali Loss: 5.774 Vali Acc: 0.470 Test Loss: 5.774 Test Acc: 0.470
Validation loss decreased (inf --> -0.469942).  Saving model ...
Epoch: 2 cost time: 4.04517936706543
Epoch: 2, Steps: 35 | Train Loss: 7.652 Vali Loss: 22.446 Vali Acc: 0.470 Test Loss: 22.446 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.063714504241943
Epoch: 3, Steps: 35 | Train Loss: 7.789 Vali Loss: 7.546 Vali Acc: 0.480 Test Loss: 7.546 Test Acc: 0.480
Validation loss decreased (-0.469942 --> -0.479925).  Saving model ...
Epoch: 4 cost time: 3.891115427017212
Epoch: 4, Steps: 35 | Train Loss: 4.547 Vali Loss: 11.055 Vali Acc: 0.500 Test Loss: 11.055 Test Acc: 0.500
Validation loss decreased (-0.479925 --> -0.499889).  Saving model ...
Epoch: 5 cost time: 3.8251724243164062
Epoch: 5, Steps: 35 | Train Loss: 8.005 Vali Loss: 7.638 Vali Acc: 0.530 Test Loss: 7.638 Test Acc: 0.530
Validation loss decreased (-0.499889 --> -0.529924).  Saving model ...
Epoch: 6 cost time: 3.8816065788269043
Epoch: 6, Steps: 35 | Train Loss: 8.814 Vali Loss: 16.727 Vali Acc: 0.490 Test Loss: 16.727 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9190940856933594
Epoch: 7, Steps: 35 | Train Loss: 9.882 Vali Loss: 28.379 Vali Acc: 0.500 Test Loss: 28.379 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.133238077163696
Epoch: 8, Steps: 35 | Train Loss: 10.045 Vali Loss: 27.229 Vali Acc: 0.450 Test Loss: 27.229 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.066830635070801
Epoch: 9, Steps: 35 | Train Loss: 11.138 Vali Loss: 13.017 Vali Acc: 0.500 Test Loss: 13.017 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.019474983215332
Epoch: 10, Steps: 35 | Train Loss: 10.515 Vali Loss: 14.918 Vali Acc: 0.530 Test Loss: 14.918 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9688377380371094
Epoch: 11, Steps: 35 | Train Loss: 6.865 Vali Loss: 33.898 Vali Acc: 0.430 Test Loss: 33.898 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.0870232582092285
Epoch: 12, Steps: 35 | Train Loss: 10.493 Vali Loss: 21.702 Vali Acc: 0.510 Test Loss: 21.702 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.942146062850952
Epoch: 13, Steps: 35 | Train Loss: 10.965 Vali Loss: 54.657 Vali Acc: 0.500 Test Loss: 54.657 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.925572156906128
Epoch: 14, Steps: 35 | Train Loss: 12.274 Vali Loss: 23.877 Vali Acc: 0.520 Test Loss: 23.877 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.978776216506958
Epoch: 15, Steps: 35 | Train Loss: 5.487 Vali Loss: 26.176 Vali Acc: 0.490 Test Loss: 26.176 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 2014482
model size : 12.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.9290993213653564
Epoch: 1, Steps: 35 | Train Loss: 3.151 Vali Loss: 4.190 Vali Acc: 0.510 Test Loss: 4.190 Test Acc: 0.510
Validation loss decreased (inf --> -0.509958).  Saving model ...
Epoch: 2 cost time: 3.9165003299713135
Epoch: 2, Steps: 35 | Train Loss: 4.106 Vali Loss: 5.870 Vali Acc: 0.510 Test Loss: 5.870 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.61781644821167
Epoch: 3, Steps: 35 | Train Loss: 7.578 Vali Loss: 11.577 Vali Acc: 0.520 Test Loss: 11.577 Test Acc: 0.520
Validation loss decreased (-0.509958 --> -0.519884).  Saving model ...
Epoch: 4 cost time: 3.6751656532287598
Epoch: 4, Steps: 35 | Train Loss: 5.303 Vali Loss: 6.756 Vali Acc: 0.470 Test Loss: 6.756 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6696949005126953
Epoch: 5, Steps: 35 | Train Loss: 6.766 Vali Loss: 7.537 Vali Acc: 0.550 Test Loss: 7.537 Test Acc: 0.550
Validation loss decreased (-0.519884 --> -0.549925).  Saving model ...
Epoch: 6 cost time: 3.8115241527557373
Epoch: 6, Steps: 35 | Train Loss: 4.290 Vali Loss: 10.493 Vali Acc: 0.520 Test Loss: 10.493 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6385297775268555
Epoch: 7, Steps: 35 | Train Loss: 6.574 Vali Loss: 12.691 Vali Acc: 0.520 Test Loss: 12.691 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5714449882507324
Epoch: 8, Steps: 35 | Train Loss: 5.738 Vali Loss: 8.616 Vali Acc: 0.470 Test Loss: 8.616 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6905951499938965
Epoch: 9, Steps: 35 | Train Loss: 4.976 Vali Loss: 13.017 Vali Acc: 0.480 Test Loss: 13.017 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6860671043395996
Epoch: 10, Steps: 35 | Train Loss: 10.359 Vali Loss: 11.323 Vali Acc: 0.480 Test Loss: 11.323 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.832202672958374
Epoch: 11, Steps: 35 | Train Loss: 6.658 Vali Loss: 34.879 Vali Acc: 0.480 Test Loss: 34.879 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8935489654541016
Epoch: 12, Steps: 35 | Train Loss: 4.464 Vali Loss: 22.824 Vali Acc: 0.510 Test Loss: 22.824 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.8827338218688965
Epoch: 13, Steps: 35 | Train Loss: 3.659 Vali Loss: 30.121 Vali Acc: 0.510 Test Loss: 30.121 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.052622556686401
Epoch: 14, Steps: 35 | Train Loss: 7.013 Vali Loss: 25.334 Vali Acc: 0.580 Test Loss: 25.334 Test Acc: 0.580
Validation loss decreased (-0.549925 --> -0.579747).  Saving model ...
Epoch: 15 cost time: 3.9266326427459717
Epoch: 15, Steps: 35 | Train Loss: 5.482 Vali Loss: 18.940 Vali Acc: 0.530 Test Loss: 18.940 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.002567768096924
Epoch: 16, Steps: 35 | Train Loss: 4.929 Vali Loss: 32.611 Vali Acc: 0.480 Test Loss: 32.611 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9671990871429443
Epoch: 17, Steps: 35 | Train Loss: 5.395 Vali Loss: 22.392 Vali Acc: 0.510 Test Loss: 22.392 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.887904167175293
Epoch: 18, Steps: 35 | Train Loss: 16.086 Vali Loss: 23.159 Vali Acc: 0.480 Test Loss: 23.159 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7390317916870117
Epoch: 19, Steps: 35 | Train Loss: 5.126 Vali Loss: 25.920 Vali Acc: 0.510 Test Loss: 25.920 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6859664916992188
Epoch: 20, Steps: 35 | Train Loss: 4.101 Vali Loss: 51.214 Vali Acc: 0.490 Test Loss: 51.214 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.9086992740631104
Epoch: 21, Steps: 35 | Train Loss: 7.709 Vali Loss: 25.548 Vali Acc: 0.570 Test Loss: 25.548 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.8169848918914795
Epoch: 22, Steps: 35 | Train Loss: 3.734 Vali Loss: 35.722 Vali Acc: 0.510 Test Loss: 35.722 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.140625715255737
Epoch: 23, Steps: 35 | Train Loss: 5.978 Vali Loss: 23.275 Vali Acc: 0.480 Test Loss: 23.275 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.161363363265991
Epoch: 24, Steps: 35 | Train Loss: 5.063 Vali Loss: 28.628 Vali Acc: 0.550 Test Loss: 28.628 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2014482
model size : 12.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.886565923690796
Epoch: 1, Steps: 35 | Train Loss: 6.369 Vali Loss: 8.400 Vali Acc: 0.440 Test Loss: 8.400 Test Acc: 0.440
Validation loss decreased (inf --> -0.439916).  Saving model ...
Epoch: 2 cost time: 4.208590269088745
Epoch: 2, Steps: 35 | Train Loss: 10.289 Vali Loss: 7.349 Vali Acc: 0.510 Test Loss: 7.349 Test Acc: 0.510
Validation loss decreased (-0.439916 --> -0.509927).  Saving model ...
Epoch: 3 cost time: 4.224915266036987
Epoch: 3, Steps: 35 | Train Loss: 4.907 Vali Loss: 10.811 Vali Acc: 0.590 Test Loss: 10.811 Test Acc: 0.590
Validation loss decreased (-0.509927 --> -0.589892).  Saving model ...
Epoch: 4 cost time: 4.1658313274383545
Epoch: 4, Steps: 35 | Train Loss: 8.860 Vali Loss: 13.076 Vali Acc: 0.460 Test Loss: 13.076 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.167800664901733
Epoch: 5, Steps: 35 | Train Loss: 10.547 Vali Loss: 21.155 Vali Acc: 0.490 Test Loss: 21.155 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.360810995101929
Epoch: 6, Steps: 35 | Train Loss: 9.823 Vali Loss: 14.577 Vali Acc: 0.560 Test Loss: 14.577 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.413437843322754
Epoch: 7, Steps: 35 | Train Loss: 7.013 Vali Loss: 10.127 Vali Acc: 0.540 Test Loss: 10.127 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.4113500118255615
Epoch: 8, Steps: 35 | Train Loss: 8.401 Vali Loss: 17.606 Vali Acc: 0.500 Test Loss: 17.606 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.279556035995483
Epoch: 9, Steps: 35 | Train Loss: 6.907 Vali Loss: 13.706 Vali Acc: 0.500 Test Loss: 13.706 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.439262628555298
Epoch: 10, Steps: 35 | Train Loss: 10.759 Vali Loss: 14.395 Vali Acc: 0.520 Test Loss: 14.395 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.348876953125
Epoch: 11, Steps: 35 | Train Loss: 8.064 Vali Loss: 22.393 Vali Acc: 0.480 Test Loss: 22.393 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.324758768081665
Epoch: 12, Steps: 35 | Train Loss: 10.243 Vali Loss: 19.318 Vali Acc: 0.530 Test Loss: 19.318 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.461458921432495
Epoch: 13, Steps: 35 | Train Loss: 4.588 Vali Loss: 55.900 Vali Acc: 0.490 Test Loss: 55.900 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1883410
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.173178434371948
Epoch: 1, Steps: 35 | Train Loss: 5.434 Vali Loss: 9.102 Vali Acc: 0.460 Test Loss: 9.102 Test Acc: 0.460
Validation loss decreased (inf --> -0.459909).  Saving model ...
Epoch: 2 cost time: 4.158998012542725
Epoch: 2, Steps: 35 | Train Loss: 6.673 Vali Loss: 7.155 Vali Acc: 0.530 Test Loss: 7.155 Test Acc: 0.530
Validation loss decreased (-0.459909 --> -0.529928).  Saving model ...
Epoch: 3 cost time: 4.094604253768921
Epoch: 3, Steps: 35 | Train Loss: 6.739 Vali Loss: 4.908 Vali Acc: 0.540 Test Loss: 4.908 Test Acc: 0.540
Validation loss decreased (-0.529928 --> -0.539951).  Saving model ...
Epoch: 4 cost time: 4.569225311279297
Epoch: 4, Steps: 35 | Train Loss: 10.535 Vali Loss: 11.883 Vali Acc: 0.510 Test Loss: 11.883 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.563376188278198
Epoch: 5, Steps: 35 | Train Loss: 6.727 Vali Loss: 12.093 Vali Acc: 0.540 Test Loss: 12.093 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.671354055404663
Epoch: 6, Steps: 35 | Train Loss: 17.066 Vali Loss: 14.013 Vali Acc: 0.530 Test Loss: 14.013 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.845446348190308
Epoch: 7, Steps: 35 | Train Loss: 11.375 Vali Loss: 21.515 Vali Acc: 0.520 Test Loss: 21.515 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.433565855026245
Epoch: 8, Steps: 35 | Train Loss: 8.848 Vali Loss: 36.459 Vali Acc: 0.500 Test Loss: 36.459 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.285366773605347
Epoch: 9, Steps: 35 | Train Loss: 8.119 Vali Loss: 33.340 Vali Acc: 0.490 Test Loss: 33.340 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.426299810409546
Epoch: 10, Steps: 35 | Train Loss: 8.468 Vali Loss: 35.143 Vali Acc: 0.480 Test Loss: 35.143 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.385973930358887
Epoch: 11, Steps: 35 | Train Loss: 6.117 Vali Loss: 21.990 Vali Acc: 0.500 Test Loss: 21.990 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.893161773681641
Epoch: 12, Steps: 35 | Train Loss: 7.031 Vali Loss: 23.697 Vali Acc: 0.510 Test Loss: 23.697 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.602002859115601
Epoch: 13, Steps: 35 | Train Loss: 5.200 Vali Loss: 32.381 Vali Acc: 0.470 Test Loss: 32.381 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1883410
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.959017992019653
Epoch: 1, Steps: 35 | Train Loss: 5.129 Vali Loss: 6.964 Vali Acc: 0.480 Test Loss: 6.964 Test Acc: 0.480
Validation loss decreased (inf --> -0.479930).  Saving model ...
Epoch: 2 cost time: 3.9497323036193848
Epoch: 2, Steps: 35 | Train Loss: 3.823 Vali Loss: 4.551 Vali Acc: 0.560 Test Loss: 4.551 Test Acc: 0.560
Validation loss decreased (-0.479930 --> -0.559954).  Saving model ...
Epoch: 3 cost time: 3.8415892124176025
Epoch: 3, Steps: 35 | Train Loss: 8.120 Vali Loss: 13.039 Vali Acc: 0.490 Test Loss: 13.039 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8405251502990723
Epoch: 4, Steps: 35 | Train Loss: 5.507 Vali Loss: 4.090 Vali Acc: 0.530 Test Loss: 4.090 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.1431403160095215
Epoch: 5, Steps: 35 | Train Loss: 4.037 Vali Loss: 17.147 Vali Acc: 0.460 Test Loss: 17.147 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.1357262134552
Epoch: 6, Steps: 35 | Train Loss: 9.500 Vali Loss: 35.160 Vali Acc: 0.500 Test Loss: 35.160 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.057420015335083
Epoch: 7, Steps: 35 | Train Loss: 9.888 Vali Loss: 19.600 Vali Acc: 0.600 Test Loss: 19.600 Test Acc: 0.600
Validation loss decreased (-0.559954 --> -0.599804).  Saving model ...
Epoch: 8 cost time: 3.959815740585327
Epoch: 8, Steps: 35 | Train Loss: 9.908 Vali Loss: 23.156 Vali Acc: 0.530 Test Loss: 23.156 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9533944129943848
Epoch: 9, Steps: 35 | Train Loss: 7.775 Vali Loss: 34.513 Vali Acc: 0.460 Test Loss: 34.513 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.097646713256836
Epoch: 10, Steps: 35 | Train Loss: 4.357 Vali Loss: 21.870 Vali Acc: 0.480 Test Loss: 21.870 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.203816890716553
Epoch: 11, Steps: 35 | Train Loss: 8.456 Vali Loss: 19.511 Vali Acc: 0.550 Test Loss: 19.511 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.2075583934783936
Epoch: 12, Steps: 35 | Train Loss: 3.152 Vali Loss: 17.784 Vali Acc: 0.590 Test Loss: 17.784 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.2431581020355225
Epoch: 13, Steps: 35 | Train Loss: 5.094 Vali Loss: 37.246 Vali Acc: 0.470 Test Loss: 37.246 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.178048610687256
Epoch: 14, Steps: 35 | Train Loss: 3.933 Vali Loss: 28.420 Vali Acc: 0.460 Test Loss: 28.420 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.062129735946655
Epoch: 15, Steps: 35 | Train Loss: 7.820 Vali Loss: 28.568 Vali Acc: 0.450 Test Loss: 28.568 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9180994033813477
Epoch: 16, Steps: 35 | Train Loss: 6.715 Vali Loss: 24.001 Vali Acc: 0.460 Test Loss: 24.001 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.045737981796265
Epoch: 17, Steps: 35 | Train Loss: 4.508 Vali Loss: 20.651 Vali Acc: 0.540 Test Loss: 20.651 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1883410
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.66993522644043
Epoch: 1, Steps: 35 | Train Loss: 3.360 Vali Loss: 4.571 Vali Acc: 0.490 Test Loss: 4.571 Test Acc: 0.490
Validation loss decreased (inf --> -0.489954).  Saving model ...
Epoch: 2 cost time: 3.678217649459839
Epoch: 2, Steps: 35 | Train Loss: 4.827 Vali Loss: 10.967 Vali Acc: 0.480 Test Loss: 10.967 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.100117206573486
Epoch: 3, Steps: 35 | Train Loss: 5.237 Vali Loss: 9.857 Vali Acc: 0.560 Test Loss: 9.857 Test Acc: 0.560
Validation loss decreased (-0.489954 --> -0.559901).  Saving model ...
Epoch: 4 cost time: 3.7163474559783936
Epoch: 4, Steps: 35 | Train Loss: 7.227 Vali Loss: 4.625 Vali Acc: 0.530 Test Loss: 4.625 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6293656826019287
Epoch: 5, Steps: 35 | Train Loss: 6.188 Vali Loss: 6.783 Vali Acc: 0.520 Test Loss: 6.783 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7345364093780518
Epoch: 6, Steps: 35 | Train Loss: 7.040 Vali Loss: 20.044 Vali Acc: 0.510 Test Loss: 20.044 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6281042098999023
Epoch: 7, Steps: 35 | Train Loss: 8.515 Vali Loss: 9.316 Vali Acc: 0.550 Test Loss: 9.316 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8424293994903564
Epoch: 8, Steps: 35 | Train Loss: 6.784 Vali Loss: 16.506 Vali Acc: 0.450 Test Loss: 16.506 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8471970558166504
Epoch: 9, Steps: 35 | Train Loss: 7.039 Vali Loss: 22.364 Vali Acc: 0.500 Test Loss: 22.364 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6373255252838135
Epoch: 10, Steps: 35 | Train Loss: 5.521 Vali Loss: 12.308 Vali Acc: 0.530 Test Loss: 12.308 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6334996223449707
Epoch: 11, Steps: 35 | Train Loss: 7.432 Vali Loss: 12.657 Vali Acc: 0.510 Test Loss: 12.657 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.597013473510742
Epoch: 12, Steps: 35 | Train Loss: 5.294 Vali Loss: 12.701 Vali Acc: 0.520 Test Loss: 12.701 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.656022548675537
Epoch: 13, Steps: 35 | Train Loss: 6.270 Vali Loss: 19.568 Vali Acc: 0.450 Test Loss: 19.568 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1883410
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.735976457595825
Epoch: 1, Steps: 35 | Train Loss: 2.813 Vali Loss: 4.705 Vali Acc: 0.550 Test Loss: 4.705 Test Acc: 0.550
Validation loss decreased (inf --> -0.549953).  Saving model ...
Epoch: 2 cost time: 4.66126823425293
Epoch: 2, Steps: 35 | Train Loss: 6.606 Vali Loss: 4.559 Vali Acc: 0.500 Test Loss: 4.559 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.672212839126587
Epoch: 3, Steps: 35 | Train Loss: 13.383 Vali Loss: 9.117 Vali Acc: 0.480 Test Loss: 9.117 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.769982814788818
Epoch: 4, Steps: 35 | Train Loss: 7.659 Vali Loss: 5.328 Vali Acc: 0.520 Test Loss: 5.328 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.0298051834106445
Epoch: 5, Steps: 35 | Train Loss: 7.269 Vali Loss: 15.558 Vali Acc: 0.470 Test Loss: 15.558 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.056399822235107
Epoch: 6, Steps: 35 | Train Loss: 8.499 Vali Loss: 8.710 Vali Acc: 0.520 Test Loss: 8.710 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.969152212142944
Epoch: 7, Steps: 35 | Train Loss: 7.435 Vali Loss: 21.596 Vali Acc: 0.490 Test Loss: 21.596 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.110241174697876
Epoch: 8, Steps: 35 | Train Loss: 10.241 Vali Loss: 27.229 Vali Acc: 0.500 Test Loss: 27.229 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.995904445648193
Epoch: 9, Steps: 35 | Train Loss: 8.999 Vali Loss: 16.101 Vali Acc: 0.480 Test Loss: 16.101 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.027159214019775
Epoch: 10, Steps: 35 | Train Loss: 3.785 Vali Loss: 16.096 Vali Acc: 0.460 Test Loss: 16.096 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.899177312850952
Epoch: 11, Steps: 35 | Train Loss: 4.762 Vali Loss: 25.048 Vali Acc: 0.520 Test Loss: 25.048 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1817874
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.174551486968994
Epoch: 1, Steps: 35 | Train Loss: 2.750 Vali Loss: 7.127 Vali Acc: 0.500 Test Loss: 7.127 Test Acc: 0.500
Validation loss decreased (inf --> -0.499929).  Saving model ...
Epoch: 2 cost time: 4.378958225250244
Epoch: 2, Steps: 35 | Train Loss: 6.788 Vali Loss: 12.436 Vali Acc: 0.500 Test Loss: 12.436 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.133536338806152
Epoch: 3, Steps: 35 | Train Loss: 10.011 Vali Loss: 16.204 Vali Acc: 0.540 Test Loss: 16.204 Test Acc: 0.540
Validation loss decreased (-0.499929 --> -0.539838).  Saving model ...
Epoch: 4 cost time: 4.39303731918335
Epoch: 4, Steps: 35 | Train Loss: 5.481 Vali Loss: 8.483 Vali Acc: 0.500 Test Loss: 8.483 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.265707492828369
Epoch: 5, Steps: 35 | Train Loss: 5.434 Vali Loss: 32.082 Vali Acc: 0.510 Test Loss: 32.082 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.269662380218506
Epoch: 6, Steps: 35 | Train Loss: 7.552 Vali Loss: 18.313 Vali Acc: 0.540 Test Loss: 18.313 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.255883455276489
Epoch: 7, Steps: 35 | Train Loss: 10.640 Vali Loss: 19.085 Vali Acc: 0.540 Test Loss: 19.085 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.346158742904663
Epoch: 8, Steps: 35 | Train Loss: 9.527 Vali Loss: 14.025 Vali Acc: 0.520 Test Loss: 14.025 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.282296895980835
Epoch: 9, Steps: 35 | Train Loss: 4.929 Vali Loss: 9.837 Vali Acc: 0.540 Test Loss: 9.837 Test Acc: 0.540
Validation loss decreased (-0.539838 --> -0.539902).  Saving model ...
Epoch: 10 cost time: 4.6967103481292725
Epoch: 10, Steps: 35 | Train Loss: 4.514 Vali Loss: 20.185 Vali Acc: 0.470 Test Loss: 20.185 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.349898338317871
Epoch: 11, Steps: 35 | Train Loss: 7.117 Vali Loss: 15.829 Vali Acc: 0.550 Test Loss: 15.829 Test Acc: 0.550
Validation loss decreased (-0.539902 --> -0.549842).  Saving model ...
Epoch: 12 cost time: 4.4293129444122314
Epoch: 12, Steps: 35 | Train Loss: 6.238 Vali Loss: 16.155 Vali Acc: 0.440 Test Loss: 16.155 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.917663097381592
Epoch: 13, Steps: 35 | Train Loss: 7.450 Vali Loss: 37.100 Vali Acc: 0.480 Test Loss: 37.100 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.397270679473877
Epoch: 14, Steps: 35 | Train Loss: 7.592 Vali Loss: 21.637 Vali Acc: 0.500 Test Loss: 21.637 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.418424129486084
Epoch: 15, Steps: 35 | Train Loss: 7.217 Vali Loss: 32.428 Vali Acc: 0.490 Test Loss: 32.428 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.416638374328613
Epoch: 16, Steps: 35 | Train Loss: 6.753 Vali Loss: 22.988 Vali Acc: 0.530 Test Loss: 22.988 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.387409687042236
Epoch: 17, Steps: 35 | Train Loss: 7.964 Vali Loss: 16.989 Vali Acc: 0.550 Test Loss: 16.989 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.449440002441406
Epoch: 18, Steps: 35 | Train Loss: 2.405 Vali Loss: 13.836 Vali Acc: 0.550 Test Loss: 13.836 Test Acc: 0.550
Validation loss decreased (-0.549842 --> -0.549862).  Saving model ...
Epoch: 19 cost time: 4.496707439422607
Epoch: 19, Steps: 35 | Train Loss: 1.185 Vali Loss: 42.820 Vali Acc: 0.530 Test Loss: 42.820 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.408233880996704
Epoch: 20, Steps: 35 | Train Loss: 1.652 Vali Loss: 19.123 Vali Acc: 0.550 Test Loss: 19.123 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.434949636459351
Epoch: 21, Steps: 35 | Train Loss: 3.496 Vali Loss: 76.325 Vali Acc: 0.490 Test Loss: 76.325 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.25151515007019
Epoch: 22, Steps: 35 | Train Loss: 12.063 Vali Loss: 42.122 Vali Acc: 0.490 Test Loss: 42.122 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.3098108768463135
Epoch: 23, Steps: 35 | Train Loss: 9.453 Vali Loss: 46.669 Vali Acc: 0.500 Test Loss: 46.669 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.346312761306763
Epoch: 24, Steps: 35 | Train Loss: 6.906 Vali Loss: 50.954 Vali Acc: 0.500 Test Loss: 50.954 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.414437294006348
Epoch: 25, Steps: 35 | Train Loss: 2.757 Vali Loss: 54.578 Vali Acc: 0.520 Test Loss: 54.578 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.353349208831787
Epoch: 26, Steps: 35 | Train Loss: 3.655 Vali Loss: 32.335 Vali Acc: 0.490 Test Loss: 32.335 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.414036512374878
Epoch: 27, Steps: 35 | Train Loss: 2.923 Vali Loss: 33.599 Vali Acc: 0.490 Test Loss: 33.599 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.504849195480347
Epoch: 28, Steps: 35 | Train Loss: 3.068 Vali Loss: 94.139 Vali Acc: 0.500 Test Loss: 94.139 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1817874
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.657153844833374
Epoch: 1, Steps: 35 | Train Loss: 2.281 Vali Loss: 4.414 Vali Acc: 0.530 Test Loss: 4.414 Test Acc: 0.530
Validation loss decreased (inf --> -0.529956).  Saving model ...
Epoch: 2 cost time: 3.7389140129089355
Epoch: 2, Steps: 35 | Train Loss: 4.892 Vali Loss: 4.591 Vali Acc: 0.430 Test Loss: 4.591 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.673713207244873
Epoch: 3, Steps: 35 | Train Loss: 5.663 Vali Loss: 23.282 Vali Acc: 0.490 Test Loss: 23.282 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.753849744796753
Epoch: 4, Steps: 35 | Train Loss: 7.011 Vali Loss: 8.063 Vali Acc: 0.540 Test Loss: 8.063 Test Acc: 0.540
Validation loss decreased (-0.529956 --> -0.539919).  Saving model ...
Epoch: 5 cost time: 3.931668996810913
Epoch: 5, Steps: 35 | Train Loss: 6.119 Vali Loss: 5.839 Vali Acc: 0.580 Test Loss: 5.839 Test Acc: 0.580
Validation loss decreased (-0.539919 --> -0.579942).  Saving model ...
Epoch: 6 cost time: 3.9154982566833496
Epoch: 6, Steps: 35 | Train Loss: 6.319 Vali Loss: 30.859 Vali Acc: 0.500 Test Loss: 30.859 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8812761306762695
Epoch: 7, Steps: 35 | Train Loss: 7.546 Vali Loss: 18.370 Vali Acc: 0.530 Test Loss: 18.370 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.042977571487427
Epoch: 8, Steps: 35 | Train Loss: 9.027 Vali Loss: 32.809 Vali Acc: 0.530 Test Loss: 32.809 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.010621786117554
Epoch: 9, Steps: 35 | Train Loss: 7.780 Vali Loss: 11.225 Vali Acc: 0.500 Test Loss: 11.225 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.003211975097656
Epoch: 10, Steps: 35 | Train Loss: 6.691 Vali Loss: 20.070 Vali Acc: 0.460 Test Loss: 20.070 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.242201805114746
Epoch: 11, Steps: 35 | Train Loss: 4.795 Vali Loss: 22.496 Vali Acc: 0.550 Test Loss: 22.496 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9699084758758545
Epoch: 12, Steps: 35 | Train Loss: 11.335 Vali Loss: 27.968 Vali Acc: 0.510 Test Loss: 27.968 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.937410831451416
Epoch: 13, Steps: 35 | Train Loss: 8.931 Vali Loss: 54.079 Vali Acc: 0.470 Test Loss: 54.079 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.805241584777832
Epoch: 14, Steps: 35 | Train Loss: 8.934 Vali Loss: 16.740 Vali Acc: 0.460 Test Loss: 16.740 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.832322359085083
Epoch: 15, Steps: 35 | Train Loss: 7.066 Vali Loss: 17.615 Vali Acc: 0.500 Test Loss: 17.615 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1817874
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.547780275344849
Epoch: 1, Steps: 35 | Train Loss: 2.238 Vali Loss: 5.177 Vali Acc: 0.520 Test Loss: 5.177 Test Acc: 0.520
Validation loss decreased (inf --> -0.519948).  Saving model ...
Epoch: 2 cost time: 3.7189109325408936
Epoch: 2, Steps: 35 | Train Loss: 6.283 Vali Loss: 4.383 Vali Acc: 0.520 Test Loss: 4.383 Test Acc: 0.520
Validation loss decreased (-0.519948 --> -0.519956).  Saving model ...
Epoch: 3 cost time: 3.4302444458007812
Epoch: 3, Steps: 35 | Train Loss: 5.969 Vali Loss: 11.995 Vali Acc: 0.500 Test Loss: 11.995 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6628851890563965
Epoch: 4, Steps: 35 | Train Loss: 4.992 Vali Loss: 9.480 Vali Acc: 0.500 Test Loss: 9.480 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.68131160736084
Epoch: 5, Steps: 35 | Train Loss: 6.873 Vali Loss: 9.627 Vali Acc: 0.520 Test Loss: 9.627 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6465706825256348
Epoch: 6, Steps: 35 | Train Loss: 3.813 Vali Loss: 15.819 Vali Acc: 0.510 Test Loss: 15.819 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.692622661590576
Epoch: 7, Steps: 35 | Train Loss: 3.685 Vali Loss: 8.700 Vali Acc: 0.470 Test Loss: 8.700 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.65641713142395
Epoch: 8, Steps: 35 | Train Loss: 4.840 Vali Loss: 15.297 Vali Acc: 0.500 Test Loss: 15.297 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.584656000137329
Epoch: 9, Steps: 35 | Train Loss: 5.509 Vali Loss: 9.575 Vali Acc: 0.480 Test Loss: 9.575 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4852962493896484
Epoch: 10, Steps: 35 | Train Loss: 4.475 Vali Loss: 15.396 Vali Acc: 0.470 Test Loss: 15.396 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3999955654144287
Epoch: 11, Steps: 35 | Train Loss: 6.234 Vali Loss: 9.285 Vali Acc: 0.490 Test Loss: 9.285 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.483858346939087
Epoch: 12, Steps: 35 | Train Loss: 10.313 Vali Loss: 25.962 Vali Acc: 0.470 Test Loss: 25.962 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 1817874
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.584428787231445
Epoch: 1, Steps: 35 | Train Loss: 3.049 Vali Loss: 5.941 Vali Acc: 0.570 Test Loss: 5.941 Test Acc: 0.570
Validation loss decreased (inf --> -0.569941).  Saving model ...
Epoch: 2 cost time: 4.654749631881714
Epoch: 2, Steps: 35 | Train Loss: 7.028 Vali Loss: 2.912 Vali Acc: 0.470 Test Loss: 2.912 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.574552297592163
Epoch: 3, Steps: 35 | Train Loss: 5.673 Vali Loss: 6.604 Vali Acc: 0.540 Test Loss: 6.604 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.574368000030518
Epoch: 4, Steps: 35 | Train Loss: 10.092 Vali Loss: 10.575 Vali Acc: 0.520 Test Loss: 10.575 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.760672330856323
Epoch: 5, Steps: 35 | Train Loss: 6.703 Vali Loss: 19.624 Vali Acc: 0.430 Test Loss: 19.624 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.5895164012908936
Epoch: 6, Steps: 35 | Train Loss: 5.923 Vali Loss: 18.149 Vali Acc: 0.500 Test Loss: 18.149 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.580386638641357
Epoch: 7, Steps: 35 | Train Loss: 5.582 Vali Loss: 19.043 Vali Acc: 0.520 Test Loss: 19.043 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.675145149230957
Epoch: 8, Steps: 35 | Train Loss: 6.819 Vali Loss: 12.053 Vali Acc: 0.520 Test Loss: 12.053 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.849261999130249
Epoch: 9, Steps: 35 | Train Loss: 8.653 Vali Loss: 28.890 Vali Acc: 0.500 Test Loss: 28.890 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.588164567947388
Epoch: 10, Steps: 35 | Train Loss: 4.333 Vali Loss: 18.365 Vali Acc: 0.500 Test Loss: 18.365 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.653615951538086
Epoch: 11, Steps: 35 | Train Loss: 7.527 Vali Loss: 34.003 Vali Acc: 0.500 Test Loss: 34.003 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1785106
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.662809371948242
Epoch: 1, Steps: 35 | Train Loss: 3.359 Vali Loss: 6.196 Vali Acc: 0.570 Test Loss: 6.196 Test Acc: 0.570
Validation loss decreased (inf --> -0.569938).  Saving model ...
Epoch: 2 cost time: 4.187640190124512
Epoch: 2, Steps: 35 | Train Loss: 4.782 Vali Loss: 8.059 Vali Acc: 0.450 Test Loss: 8.059 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.12856125831604
Epoch: 3, Steps: 35 | Train Loss: 6.477 Vali Loss: 13.777 Vali Acc: 0.490 Test Loss: 13.777 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.186355829238892
Epoch: 4, Steps: 35 | Train Loss: 7.725 Vali Loss: 5.768 Vali Acc: 0.480 Test Loss: 5.768 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.144046306610107
Epoch: 5, Steps: 35 | Train Loss: 10.615 Vali Loss: 14.196 Vali Acc: 0.520 Test Loss: 14.196 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.160181045532227
Epoch: 6, Steps: 35 | Train Loss: 7.347 Vali Loss: 18.748 Vali Acc: 0.460 Test Loss: 18.748 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.134605407714844
Epoch: 7, Steps: 35 | Train Loss: 7.411 Vali Loss: 8.861 Vali Acc: 0.570 Test Loss: 8.861 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.221487998962402
Epoch: 8, Steps: 35 | Train Loss: 7.575 Vali Loss: 14.046 Vali Acc: 0.500 Test Loss: 14.046 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.577211856842041
Epoch: 9, Steps: 35 | Train Loss: 8.475 Vali Loss: 14.306 Vali Acc: 0.550 Test Loss: 14.306 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.4425060749053955
Epoch: 10, Steps: 35 | Train Loss: 3.302 Vali Loss: 30.770 Vali Acc: 0.490 Test Loss: 30.770 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.650848865509033
Epoch: 11, Steps: 35 | Train Loss: 6.457 Vali Loss: 40.427 Vali Acc: 0.520 Test Loss: 40.427 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1785106
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.689967393875122
Epoch: 1, Steps: 35 | Train Loss: 2.400 Vali Loss: 5.283 Vali Acc: 0.560 Test Loss: 5.283 Test Acc: 0.560
Validation loss decreased (inf --> -0.559947).  Saving model ...
Epoch: 2 cost time: 4.045899152755737
Epoch: 2, Steps: 35 | Train Loss: 5.140 Vali Loss: 10.989 Vali Acc: 0.520 Test Loss: 10.989 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0328991413116455
Epoch: 3, Steps: 35 | Train Loss: 6.554 Vali Loss: 10.803 Vali Acc: 0.460 Test Loss: 10.803 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.036877155303955
Epoch: 4, Steps: 35 | Train Loss: 8.785 Vali Loss: 15.718 Vali Acc: 0.460 Test Loss: 15.718 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.207779407501221
Epoch: 5, Steps: 35 | Train Loss: 8.934 Vali Loss: 9.700 Vali Acc: 0.550 Test Loss: 9.700 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.143370151519775
Epoch: 6, Steps: 35 | Train Loss: 6.001 Vali Loss: 19.605 Vali Acc: 0.460 Test Loss: 19.605 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.1838462352752686
Epoch: 7, Steps: 35 | Train Loss: 6.592 Vali Loss: 12.404 Vali Acc: 0.530 Test Loss: 12.404 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.162490367889404
Epoch: 8, Steps: 35 | Train Loss: 8.821 Vali Loss: 23.514 Vali Acc: 0.430 Test Loss: 23.514 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.042357683181763
Epoch: 9, Steps: 35 | Train Loss: 8.109 Vali Loss: 16.048 Vali Acc: 0.430 Test Loss: 16.048 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.35745906829834
Epoch: 10, Steps: 35 | Train Loss: 5.573 Vali Loss: 25.570 Vali Acc: 0.470 Test Loss: 25.570 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.066380739212036
Epoch: 11, Steps: 35 | Train Loss: 4.476 Vali Loss: 18.712 Vali Acc: 0.560 Test Loss: 18.712 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1785106
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.540780067443848
Epoch: 1, Steps: 35 | Train Loss: 3.577 Vali Loss: 3.270 Vali Acc: 0.510 Test Loss: 3.270 Test Acc: 0.510
Validation loss decreased (inf --> -0.509967).  Saving model ...
Epoch: 2 cost time: 3.7052416801452637
Epoch: 2, Steps: 35 | Train Loss: 4.053 Vali Loss: 5.267 Vali Acc: 0.490 Test Loss: 5.267 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.625728130340576
Epoch: 3, Steps: 35 | Train Loss: 5.125 Vali Loss: 4.069 Vali Acc: 0.480 Test Loss: 4.069 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6265909671783447
Epoch: 4, Steps: 35 | Train Loss: 5.128 Vali Loss: 5.057 Vali Acc: 0.480 Test Loss: 5.057 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.469223976135254
Epoch: 5, Steps: 35 | Train Loss: 8.051 Vali Loss: 5.629 Vali Acc: 0.480 Test Loss: 5.629 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7820029258728027
Epoch: 6, Steps: 35 | Train Loss: 4.351 Vali Loss: 22.467 Vali Acc: 0.500 Test Loss: 22.467 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.751655340194702
Epoch: 7, Steps: 35 | Train Loss: 9.007 Vali Loss: 7.369 Vali Acc: 0.520 Test Loss: 7.369 Test Acc: 0.520
Validation loss decreased (-0.509967 --> -0.519926).  Saving model ...
Epoch: 8 cost time: 3.529097557067871
Epoch: 8, Steps: 35 | Train Loss: 5.503 Vali Loss: 13.617 Vali Acc: 0.520 Test Loss: 13.617 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8056976795196533
Epoch: 9, Steps: 35 | Train Loss: 7.036 Vali Loss: 15.347 Vali Acc: 0.470 Test Loss: 15.347 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.807851791381836
Epoch: 10, Steps: 35 | Train Loss: 11.211 Vali Loss: 20.056 Vali Acc: 0.450 Test Loss: 20.056 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6587655544281006
Epoch: 11, Steps: 35 | Train Loss: 11.510 Vali Loss: 18.331 Vali Acc: 0.470 Test Loss: 18.331 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5663888454437256
Epoch: 12, Steps: 35 | Train Loss: 9.863 Vali Loss: 23.599 Vali Acc: 0.480 Test Loss: 23.599 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.522583484649658
Epoch: 13, Steps: 35 | Train Loss: 6.631 Vali Loss: 39.629 Vali Acc: 0.510 Test Loss: 39.629 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.422556161880493
Epoch: 14, Steps: 35 | Train Loss: 6.290 Vali Loss: 24.082 Vali Acc: 0.540 Test Loss: 24.082 Test Acc: 0.540
Validation loss decreased (-0.519926 --> -0.539759).  Saving model ...
Epoch: 15 cost time: 3.629972219467163
Epoch: 15, Steps: 35 | Train Loss: 8.842 Vali Loss: 24.664 Vali Acc: 0.520 Test Loss: 24.664 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.802692174911499
Epoch: 16, Steps: 35 | Train Loss: 7.744 Vali Loss: 29.581 Vali Acc: 0.500 Test Loss: 29.581 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8336970806121826
Epoch: 17, Steps: 35 | Train Loss: 5.601 Vali Loss: 25.829 Vali Acc: 0.460 Test Loss: 25.829 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.844120502471924
Epoch: 18, Steps: 35 | Train Loss: 7.244 Vali Loss: 35.321 Vali Acc: 0.430 Test Loss: 35.321 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.797363042831421
Epoch: 19, Steps: 35 | Train Loss: 8.382 Vali Loss: 16.892 Vali Acc: 0.500 Test Loss: 16.892 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6536169052124023
Epoch: 20, Steps: 35 | Train Loss: 10.042 Vali Loss: 24.420 Vali Acc: 0.510 Test Loss: 24.420 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7592480182647705
Epoch: 21, Steps: 35 | Train Loss: 4.949 Vali Loss: 33.149 Vali Acc: 0.540 Test Loss: 33.149 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.809558153152466
Epoch: 22, Steps: 35 | Train Loss: 9.794 Vali Loss: 29.363 Vali Acc: 0.540 Test Loss: 29.363 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8178672790527344
Epoch: 23, Steps: 35 | Train Loss: 3.771 Vali Loss: 36.311 Vali Acc: 0.500 Test Loss: 36.311 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7175750732421875
Epoch: 24, Steps: 35 | Train Loss: 2.991 Vali Loss: 15.467 Vali Acc: 0.600 Test Loss: 15.467 Test Acc: 0.600
Validation loss decreased (-0.539759 --> -0.599845).  Saving model ...
Epoch: 25 cost time: 3.64909029006958
Epoch: 25, Steps: 35 | Train Loss: 3.575 Vali Loss: 23.146 Vali Acc: 0.540 Test Loss: 23.146 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8760619163513184
Epoch: 26, Steps: 35 | Train Loss: 7.106 Vali Loss: 22.021 Vali Acc: 0.610 Test Loss: 22.021 Test Acc: 0.610
Validation loss decreased (-0.599845 --> -0.609780).  Saving model ...
Epoch: 27 cost time: 3.6815836429595947
Epoch: 27, Steps: 35 | Train Loss: 3.787 Vali Loss: 29.458 Vali Acc: 0.530 Test Loss: 29.458 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.671692132949829
Epoch: 28, Steps: 35 | Train Loss: 1.198 Vali Loss: 33.007 Vali Acc: 0.510 Test Loss: 33.007 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.84944748878479
Epoch: 29, Steps: 35 | Train Loss: 2.885 Vali Loss: 40.199 Vali Acc: 0.480 Test Loss: 40.199 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6918795108795166
Epoch: 30, Steps: 35 | Train Loss: 4.394 Vali Loss: 73.712 Vali Acc: 0.500 Test Loss: 73.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.771091938018799
Epoch: 31, Steps: 35 | Train Loss: 1.885 Vali Loss: 31.562 Vali Acc: 0.500 Test Loss: 31.562 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.843008041381836
Epoch: 32, Steps: 35 | Train Loss: 3.941 Vali Loss: 58.733 Vali Acc: 0.480 Test Loss: 58.733 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.694411039352417
Epoch: 33, Steps: 35 | Train Loss: 1.305 Vali Loss: 28.209 Vali Acc: 0.540 Test Loss: 28.209 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.826108694076538
Epoch: 34, Steps: 35 | Train Loss: 1.109 Vali Loss: 39.425 Vali Acc: 0.490 Test Loss: 39.425 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.6902952194213867
Epoch: 35, Steps: 35 | Train Loss: 1.253 Vali Loss: 36.559 Vali Acc: 0.520 Test Loss: 36.559 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.579380989074707
Epoch: 36, Steps: 35 | Train Loss: 1.959 Vali Loss: 46.555 Vali Acc: 0.580 Test Loss: 46.555 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1785106
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.7276294231414795
Epoch: 1, Steps: 35 | Train Loss: 1.874 Vali Loss: 3.416 Vali Acc: 0.480 Test Loss: 3.416 Test Acc: 0.480
Validation loss decreased (inf --> -0.479966).  Saving model ...
Epoch: 2 cost time: 3.3248400688171387
Epoch: 2, Steps: 35 | Train Loss: 3.938 Vali Loss: 5.520 Vali Acc: 0.480 Test Loss: 5.520 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6396751403808594
Epoch: 3, Steps: 35 | Train Loss: 4.415 Vali Loss: 5.376 Vali Acc: 0.490 Test Loss: 5.376 Test Acc: 0.490
Validation loss decreased (-0.479966 --> -0.489946).  Saving model ...
Epoch: 4 cost time: 3.602445602416992
Epoch: 4, Steps: 35 | Train Loss: 4.124 Vali Loss: 8.536 Vali Acc: 0.510 Test Loss: 8.536 Test Acc: 0.510
Validation loss decreased (-0.489946 --> -0.509915).  Saving model ...
Epoch: 5 cost time: 3.557642698287964
Epoch: 5, Steps: 35 | Train Loss: 2.368 Vali Loss: 4.682 Vali Acc: 0.430 Test Loss: 4.682 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5925986766815186
Epoch: 6, Steps: 35 | Train Loss: 2.305 Vali Loss: 9.697 Vali Acc: 0.450 Test Loss: 9.697 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.665048837661743
Epoch: 7, Steps: 35 | Train Loss: 4.388 Vali Loss: 9.825 Vali Acc: 0.550 Test Loss: 9.825 Test Acc: 0.550
Validation loss decreased (-0.509915 --> -0.549902).  Saving model ...
Epoch: 8 cost time: 3.579066514968872
Epoch: 8, Steps: 35 | Train Loss: 3.791 Vali Loss: 6.427 Vali Acc: 0.510 Test Loss: 6.427 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7074828147888184
Epoch: 9, Steps: 35 | Train Loss: 3.310 Vali Loss: 14.224 Vali Acc: 0.470 Test Loss: 14.224 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4419140815734863
Epoch: 10, Steps: 35 | Train Loss: 1.795 Vali Loss: 14.423 Vali Acc: 0.500 Test Loss: 14.423 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.60197114944458
Epoch: 11, Steps: 35 | Train Loss: 4.228 Vali Loss: 7.980 Vali Acc: 0.530 Test Loss: 7.980 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.341874599456787
Epoch: 12, Steps: 35 | Train Loss: 4.062 Vali Loss: 18.965 Vali Acc: 0.500 Test Loss: 18.965 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2815306186676025
Epoch: 13, Steps: 35 | Train Loss: 5.535 Vali Loss: 9.627 Vali Acc: 0.460 Test Loss: 9.627 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5769481658935547
Epoch: 14, Steps: 35 | Train Loss: 2.338 Vali Loss: 5.358 Vali Acc: 0.600 Test Loss: 5.358 Test Acc: 0.600
Validation loss decreased (-0.549902 --> -0.599946).  Saving model ...
Epoch: 15 cost time: 3.636688232421875
Epoch: 15, Steps: 35 | Train Loss: 3.871 Vali Loss: 5.577 Vali Acc: 0.620 Test Loss: 5.577 Test Acc: 0.620
Validation loss decreased (-0.599946 --> -0.619944).  Saving model ...
Epoch: 16 cost time: 3.493058919906616
Epoch: 16, Steps: 35 | Train Loss: 2.195 Vali Loss: 18.717 Vali Acc: 0.500 Test Loss: 18.717 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.620410680770874
Epoch: 17, Steps: 35 | Train Loss: 3.094 Vali Loss: 13.091 Vali Acc: 0.460 Test Loss: 13.091 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5364527702331543
Epoch: 18, Steps: 35 | Train Loss: 1.742 Vali Loss: 27.279 Vali Acc: 0.480 Test Loss: 27.279 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6251821517944336
Epoch: 19, Steps: 35 | Train Loss: 7.494 Vali Loss: 32.213 Vali Acc: 0.500 Test Loss: 32.213 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.664156675338745
Epoch: 20, Steps: 35 | Train Loss: 9.123 Vali Loss: 23.494 Vali Acc: 0.470 Test Loss: 23.494 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.638165235519409
Epoch: 21, Steps: 35 | Train Loss: 2.707 Vali Loss: 20.286 Vali Acc: 0.510 Test Loss: 20.286 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.558840274810791
Epoch: 22, Steps: 35 | Train Loss: 1.661 Vali Loss: 21.682 Vali Acc: 0.500 Test Loss: 21.682 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4538094997406006
Epoch: 23, Steps: 35 | Train Loss: 1.131 Vali Loss: 17.852 Vali Acc: 0.530 Test Loss: 17.852 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.3755898475646973
Epoch: 24, Steps: 35 | Train Loss: 0.696 Vali Loss: 7.267 Vali Acc: 0.610 Test Loss: 7.267 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.3423385620117188
Epoch: 25, Steps: 35 | Train Loss: 1.277 Vali Loss: 14.914 Vali Acc: 0.520 Test Loss: 14.914 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1367826
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.04679799079895
Epoch: 1, Steps: 35 | Train Loss: 2.079 Vali Loss: 2.772 Vali Acc: 0.490 Test Loss: 2.772 Test Acc: 0.490
Validation loss decreased (inf --> -0.489972).  Saving model ...
Epoch: 2 cost time: 3.0468626022338867
Epoch: 2, Steps: 35 | Train Loss: 3.276 Vali Loss: 4.932 Vali Acc: 0.490 Test Loss: 4.932 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2438793182373047
Epoch: 3, Steps: 35 | Train Loss: 3.732 Vali Loss: 3.937 Vali Acc: 0.470 Test Loss: 3.937 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2343339920043945
Epoch: 4, Steps: 35 | Train Loss: 3.812 Vali Loss: 3.344 Vali Acc: 0.550 Test Loss: 3.344 Test Acc: 0.550
Validation loss decreased (-0.489972 --> -0.549967).  Saving model ...
Epoch: 5 cost time: 3.084366798400879
Epoch: 5, Steps: 35 | Train Loss: 2.472 Vali Loss: 4.934 Vali Acc: 0.520 Test Loss: 4.934 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.234746217727661
Epoch: 6, Steps: 35 | Train Loss: 2.635 Vali Loss: 11.952 Vali Acc: 0.470 Test Loss: 11.952 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1535580158233643
Epoch: 7, Steps: 35 | Train Loss: 6.711 Vali Loss: 9.068 Vali Acc: 0.550 Test Loss: 9.068 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.051875352859497
Epoch: 8, Steps: 35 | Train Loss: 6.658 Vali Loss: 8.874 Vali Acc: 0.500 Test Loss: 8.874 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.935291290283203
Epoch: 9, Steps: 35 | Train Loss: 1.903 Vali Loss: 5.846 Vali Acc: 0.590 Test Loss: 5.846 Test Acc: 0.590
Validation loss decreased (-0.549967 --> -0.589942).  Saving model ...
Epoch: 10 cost time: 3.0262339115142822
Epoch: 10, Steps: 35 | Train Loss: 5.541 Vali Loss: 9.989 Vali Acc: 0.520 Test Loss: 9.989 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.964181423187256
Epoch: 11, Steps: 35 | Train Loss: 3.217 Vali Loss: 10.146 Vali Acc: 0.520 Test Loss: 10.146 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1742286682128906
Epoch: 12, Steps: 35 | Train Loss: 2.815 Vali Loss: 10.754 Vali Acc: 0.480 Test Loss: 10.754 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.162689685821533
Epoch: 13, Steps: 35 | Train Loss: 3.214 Vali Loss: 14.388 Vali Acc: 0.450 Test Loss: 14.388 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1832470893859863
Epoch: 14, Steps: 35 | Train Loss: 3.754 Vali Loss: 6.740 Vali Acc: 0.530 Test Loss: 6.740 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.129547595977783
Epoch: 15, Steps: 35 | Train Loss: 6.728 Vali Loss: 19.183 Vali Acc: 0.460 Test Loss: 19.183 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2085278034210205
Epoch: 16, Steps: 35 | Train Loss: 6.846 Vali Loss: 8.425 Vali Acc: 0.520 Test Loss: 8.425 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3601064682006836
Epoch: 17, Steps: 35 | Train Loss: 4.066 Vali Loss: 25.111 Vali Acc: 0.420 Test Loss: 25.111 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.12091064453125
Epoch: 18, Steps: 35 | Train Loss: 1.879 Vali Loss: 27.995 Vali Acc: 0.460 Test Loss: 27.995 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2485997676849365
Epoch: 19, Steps: 35 | Train Loss: 1.883 Vali Loss: 10.937 Vali Acc: 0.460 Test Loss: 10.937 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1367826
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.837568759918213
Epoch: 1, Steps: 35 | Train Loss: 1.984 Vali Loss: 2.256 Vali Acc: 0.590 Test Loss: 2.256 Test Acc: 0.590
Validation loss decreased (inf --> -0.589977).  Saving model ...
Epoch: 2 cost time: 3.009369373321533
Epoch: 2, Steps: 35 | Train Loss: 2.508 Vali Loss: 1.383 Vali Acc: 0.530 Test Loss: 1.383 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3481109142303467
Epoch: 3, Steps: 35 | Train Loss: 2.100 Vali Loss: 3.840 Vali Acc: 0.490 Test Loss: 3.840 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.198136568069458
Epoch: 4, Steps: 35 | Train Loss: 3.663 Vali Loss: 8.140 Vali Acc: 0.530 Test Loss: 8.140 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.241780996322632
Epoch: 5, Steps: 35 | Train Loss: 3.773 Vali Loss: 6.626 Vali Acc: 0.490 Test Loss: 6.626 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2103431224823
Epoch: 6, Steps: 35 | Train Loss: 4.929 Vali Loss: 11.130 Vali Acc: 0.460 Test Loss: 11.130 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3351070880889893
Epoch: 7, Steps: 35 | Train Loss: 4.878 Vali Loss: 4.115 Vali Acc: 0.510 Test Loss: 4.115 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2717299461364746
Epoch: 8, Steps: 35 | Train Loss: 3.138 Vali Loss: 9.405 Vali Acc: 0.460 Test Loss: 9.405 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.410109519958496
Epoch: 9, Steps: 35 | Train Loss: 3.890 Vali Loss: 18.049 Vali Acc: 0.510 Test Loss: 18.049 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2870943546295166
Epoch: 10, Steps: 35 | Train Loss: 2.902 Vali Loss: 27.989 Vali Acc: 0.480 Test Loss: 27.989 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.122100591659546
Epoch: 11, Steps: 35 | Train Loss: 2.773 Vali Loss: 9.054 Vali Acc: 0.490 Test Loss: 9.054 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1367826
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.649813175201416
Epoch: 1, Steps: 35 | Train Loss: 1.903 Vali Loss: 1.302 Vali Acc: 0.520 Test Loss: 1.302 Test Acc: 0.520
Validation loss decreased (inf --> -0.519987).  Saving model ...
Epoch: 2 cost time: 2.9220571517944336
Epoch: 2, Steps: 35 | Train Loss: 2.811 Vali Loss: 2.308 Vali Acc: 0.480 Test Loss: 2.308 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9951746463775635
Epoch: 3, Steps: 35 | Train Loss: 3.314 Vali Loss: 3.933 Vali Acc: 0.500 Test Loss: 3.933 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9880871772766113
Epoch: 4, Steps: 35 | Train Loss: 2.809 Vali Loss: 3.196 Vali Acc: 0.460 Test Loss: 3.196 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.097755193710327
Epoch: 5, Steps: 35 | Train Loss: 3.774 Vali Loss: 5.377 Vali Acc: 0.510 Test Loss: 5.377 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9266905784606934
Epoch: 6, Steps: 35 | Train Loss: 6.084 Vali Loss: 11.897 Vali Acc: 0.500 Test Loss: 11.897 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.986401319503784
Epoch: 7, Steps: 35 | Train Loss: 4.212 Vali Loss: 8.812 Vali Acc: 0.520 Test Loss: 8.812 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0455210208892822
Epoch: 8, Steps: 35 | Train Loss: 7.685 Vali Loss: 15.166 Vali Acc: 0.500 Test Loss: 15.166 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9692959785461426
Epoch: 9, Steps: 35 | Train Loss: 4.943 Vali Loss: 6.988 Vali Acc: 0.550 Test Loss: 6.988 Test Acc: 0.550
Validation loss decreased (-0.519987 --> -0.549930).  Saving model ...
Epoch: 10 cost time: 2.9276678562164307
Epoch: 10, Steps: 35 | Train Loss: 3.442 Vali Loss: 7.131 Vali Acc: 0.500 Test Loss: 7.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.87758207321167
Epoch: 11, Steps: 35 | Train Loss: 2.094 Vali Loss: 6.984 Vali Acc: 0.460 Test Loss: 6.984 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.003795862197876
Epoch: 12, Steps: 35 | Train Loss: 5.306 Vali Loss: 22.010 Vali Acc: 0.490 Test Loss: 22.010 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8055062294006348
Epoch: 13, Steps: 35 | Train Loss: 3.841 Vali Loss: 11.039 Vali Acc: 0.520 Test Loss: 11.039 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1124587059020996
Epoch: 14, Steps: 35 | Train Loss: 4.099 Vali Loss: 18.079 Vali Acc: 0.500 Test Loss: 18.079 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9137933254241943
Epoch: 15, Steps: 35 | Train Loss: 4.105 Vali Loss: 9.001 Vali Acc: 0.500 Test Loss: 9.001 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.113774538040161
Epoch: 16, Steps: 35 | Train Loss: 2.538 Vali Loss: 7.299 Vali Acc: 0.560 Test Loss: 7.299 Test Acc: 0.560
Validation loss decreased (-0.549930 --> -0.559927).  Saving model ...
Epoch: 17 cost time: 2.917961597442627
Epoch: 17, Steps: 35 | Train Loss: 2.570 Vali Loss: 12.200 Vali Acc: 0.450 Test Loss: 12.200 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.155707359313965
Epoch: 18, Steps: 35 | Train Loss: 2.770 Vali Loss: 8.307 Vali Acc: 0.510 Test Loss: 8.307 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8871681690216064
Epoch: 19, Steps: 35 | Train Loss: 2.493 Vali Loss: 13.841 Vali Acc: 0.540 Test Loss: 13.841 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0174710750579834
Epoch: 20, Steps: 35 | Train Loss: 4.823 Vali Loss: 11.921 Vali Acc: 0.470 Test Loss: 11.921 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.107219934463501
Epoch: 21, Steps: 35 | Train Loss: 6.422 Vali Loss: 14.893 Vali Acc: 0.510 Test Loss: 14.893 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.039560317993164
Epoch: 22, Steps: 35 | Train Loss: 2.434 Vali Loss: 21.670 Vali Acc: 0.500 Test Loss: 21.670 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9654152393341064
Epoch: 23, Steps: 35 | Train Loss: 2.680 Vali Loss: 12.600 Vali Acc: 0.530 Test Loss: 12.600 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.004276752471924
Epoch: 24, Steps: 35 | Train Loss: 2.981 Vali Loss: 12.771 Vali Acc: 0.540 Test Loss: 12.771 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.8385980129241943
Epoch: 25, Steps: 35 | Train Loss: 1.517 Vali Loss: 17.677 Vali Acc: 0.480 Test Loss: 17.677 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7283198833465576
Epoch: 26, Steps: 35 | Train Loss: 3.793 Vali Loss: 17.388 Vali Acc: 0.550 Test Loss: 17.388 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1367826
model size : 7.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.190197706222534
Epoch: 1, Steps: 35 | Train Loss: 1.532 Vali Loss: 3.676 Vali Acc: 0.530 Test Loss: 3.676 Test Acc: 0.530
Validation loss decreased (inf --> -0.529963).  Saving model ...
Epoch: 2 cost time: 3.265589475631714
Epoch: 2, Steps: 35 | Train Loss: 2.361 Vali Loss: 4.837 Vali Acc: 0.500 Test Loss: 4.837 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2553184032440186
Epoch: 3, Steps: 35 | Train Loss: 2.958 Vali Loss: 4.862 Vali Acc: 0.480 Test Loss: 4.862 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.403247594833374
Epoch: 4, Steps: 35 | Train Loss: 2.975 Vali Loss: 4.132 Vali Acc: 0.420 Test Loss: 4.132 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2592220306396484
Epoch: 5, Steps: 35 | Train Loss: 5.173 Vali Loss: 6.620 Vali Acc: 0.480 Test Loss: 6.620 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.376417636871338
Epoch: 6, Steps: 35 | Train Loss: 3.195 Vali Loss: 8.299 Vali Acc: 0.440 Test Loss: 8.299 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4535160064697266
Epoch: 7, Steps: 35 | Train Loss: 2.610 Vali Loss: 12.086 Vali Acc: 0.470 Test Loss: 12.086 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2392148971557617
Epoch: 8, Steps: 35 | Train Loss: 5.853 Vali Loss: 8.358 Vali Acc: 0.540 Test Loss: 8.358 Test Acc: 0.540
Validation loss decreased (-0.529963 --> -0.539916).  Saving model ...
Epoch: 9 cost time: 3.1495676040649414
Epoch: 9, Steps: 35 | Train Loss: 5.265 Vali Loss: 9.397 Vali Acc: 0.540 Test Loss: 9.397 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2639870643615723
Epoch: 10, Steps: 35 | Train Loss: 1.970 Vali Loss: 5.429 Vali Acc: 0.540 Test Loss: 5.429 Test Acc: 0.540
Validation loss decreased (-0.539916 --> -0.539946).  Saving model ...
Epoch: 11 cost time: 3.456467628479004
Epoch: 11, Steps: 35 | Train Loss: 6.535 Vali Loss: 10.997 Vali Acc: 0.480 Test Loss: 10.997 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5886435508728027
Epoch: 12, Steps: 35 | Train Loss: 2.346 Vali Loss: 6.574 Vali Acc: 0.450 Test Loss: 6.574 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5664291381835938
Epoch: 13, Steps: 35 | Train Loss: 2.577 Vali Loss: 8.406 Vali Acc: 0.500 Test Loss: 8.406 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8171799182891846
Epoch: 14, Steps: 35 | Train Loss: 1.415 Vali Loss: 7.606 Vali Acc: 0.470 Test Loss: 7.606 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.5888497829437256
Epoch: 15, Steps: 35 | Train Loss: 1.308 Vali Loss: 10.189 Vali Acc: 0.480 Test Loss: 10.189 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7499446868896484
Epoch: 16, Steps: 35 | Train Loss: 3.260 Vali Loss: 31.249 Vali Acc: 0.490 Test Loss: 31.249 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.720505714416504
Epoch: 17, Steps: 35 | Train Loss: 2.634 Vali Loss: 17.593 Vali Acc: 0.500 Test Loss: 17.593 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.18624210357666
Epoch: 18, Steps: 35 | Train Loss: 5.266 Vali Loss: 14.160 Vali Acc: 0.500 Test Loss: 14.160 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7716217041015625
Epoch: 19, Steps: 35 | Train Loss: 4.323 Vali Loss: 10.433 Vali Acc: 0.500 Test Loss: 10.433 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6793482303619385
Epoch: 20, Steps: 35 | Train Loss: 1.153 Vali Loss: 19.036 Vali Acc: 0.500 Test Loss: 19.036 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1105682
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.352008819580078
Epoch: 1, Steps: 35 | Train Loss: 1.467 Vali Loss: 1.956 Vali Acc: 0.550 Test Loss: 1.956 Test Acc: 0.550
Validation loss decreased (inf --> -0.549980).  Saving model ...
Epoch: 2 cost time: 3.090869665145874
Epoch: 2, Steps: 35 | Train Loss: 2.449 Vali Loss: 7.960 Vali Acc: 0.500 Test Loss: 7.960 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1358537673950195
Epoch: 3, Steps: 35 | Train Loss: 2.437 Vali Loss: 3.629 Vali Acc: 0.540 Test Loss: 3.629 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.015920877456665
Epoch: 4, Steps: 35 | Train Loss: 3.928 Vali Loss: 6.134 Vali Acc: 0.510 Test Loss: 6.134 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0785162448883057
Epoch: 5, Steps: 35 | Train Loss: 3.525 Vali Loss: 4.391 Vali Acc: 0.580 Test Loss: 4.391 Test Acc: 0.580
Validation loss decreased (-0.549980 --> -0.579956).  Saving model ...
Epoch: 6 cost time: 3.0863730907440186
Epoch: 6, Steps: 35 | Train Loss: 4.133 Vali Loss: 5.394 Vali Acc: 0.500 Test Loss: 5.394 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.110147476196289
Epoch: 7, Steps: 35 | Train Loss: 3.535 Vali Loss: 5.662 Vali Acc: 0.450 Test Loss: 5.662 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.040762186050415
Epoch: 8, Steps: 35 | Train Loss: 5.808 Vali Loss: 8.618 Vali Acc: 0.500 Test Loss: 8.618 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.990710735321045
Epoch: 9, Steps: 35 | Train Loss: 3.004 Vali Loss: 19.213 Vali Acc: 0.490 Test Loss: 19.213 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9542527198791504
Epoch: 10, Steps: 35 | Train Loss: 4.059 Vali Loss: 12.822 Vali Acc: 0.540 Test Loss: 12.822 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9866013526916504
Epoch: 11, Steps: 35 | Train Loss: 2.115 Vali Loss: 13.363 Vali Acc: 0.550 Test Loss: 13.363 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1795318126678467
Epoch: 12, Steps: 35 | Train Loss: 3.178 Vali Loss: 7.314 Vali Acc: 0.480 Test Loss: 7.314 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0589473247528076
Epoch: 13, Steps: 35 | Train Loss: 4.351 Vali Loss: 12.326 Vali Acc: 0.460 Test Loss: 12.326 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9782421588897705
Epoch: 14, Steps: 35 | Train Loss: 2.384 Vali Loss: 11.368 Vali Acc: 0.460 Test Loss: 11.368 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.313408613204956
Epoch: 15, Steps: 35 | Train Loss: 2.815 Vali Loss: 14.154 Vali Acc: 0.530 Test Loss: 14.154 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1105682
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.9809393882751465
Epoch: 1, Steps: 35 | Train Loss: 1.645 Vali Loss: 4.751 Vali Acc: 0.610 Test Loss: 4.751 Test Acc: 0.610
Validation loss decreased (inf --> -0.609952).  Saving model ...
Epoch: 2 cost time: 2.67221999168396
Epoch: 2, Steps: 35 | Train Loss: 1.892 Vali Loss: 5.096 Vali Acc: 0.480 Test Loss: 5.096 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.057072877883911
Epoch: 3, Steps: 35 | Train Loss: 3.505 Vali Loss: 2.973 Vali Acc: 0.540 Test Loss: 2.973 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.090933084487915
Epoch: 4, Steps: 35 | Train Loss: 3.662 Vali Loss: 5.487 Vali Acc: 0.470 Test Loss: 5.487 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.932203531265259
Epoch: 5, Steps: 35 | Train Loss: 5.275 Vali Loss: 9.598 Vali Acc: 0.510 Test Loss: 9.598 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.859712600708008
Epoch: 6, Steps: 35 | Train Loss: 3.365 Vali Loss: 7.992 Vali Acc: 0.480 Test Loss: 7.992 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.929551839828491
Epoch: 7, Steps: 35 | Train Loss: 3.591 Vali Loss: 9.207 Vali Acc: 0.480 Test Loss: 9.207 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.972475051879883
Epoch: 8, Steps: 35 | Train Loss: 4.994 Vali Loss: 5.836 Vali Acc: 0.500 Test Loss: 5.836 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7390270233154297
Epoch: 9, Steps: 35 | Train Loss: 3.696 Vali Loss: 10.601 Vali Acc: 0.480 Test Loss: 10.601 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9169251918792725
Epoch: 10, Steps: 35 | Train Loss: 2.658 Vali Loss: 8.615 Vali Acc: 0.480 Test Loss: 8.615 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8972842693328857
Epoch: 11, Steps: 35 | Train Loss: 4.872 Vali Loss: 11.261 Vali Acc: 0.480 Test Loss: 11.261 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1105682
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.772479295730591
Epoch: 1, Steps: 35 | Train Loss: 1.811 Vali Loss: 2.642 Vali Acc: 0.540 Test Loss: 2.642 Test Acc: 0.540
Validation loss decreased (inf --> -0.539974).  Saving model ...
Epoch: 2 cost time: 2.6511471271514893
Epoch: 2, Steps: 35 | Train Loss: 3.005 Vali Loss: 1.359 Vali Acc: 0.590 Test Loss: 1.359 Test Acc: 0.590
Validation loss decreased (-0.539974 --> -0.589986).  Saving model ...
Epoch: 3 cost time: 2.6543896198272705
Epoch: 3, Steps: 35 | Train Loss: 3.565 Vali Loss: 6.156 Vali Acc: 0.620 Test Loss: 6.156 Test Acc: 0.620
Validation loss decreased (-0.589986 --> -0.619938).  Saving model ...
Epoch: 4 cost time: 2.6033682823181152
Epoch: 4, Steps: 35 | Train Loss: 2.785 Vali Loss: 2.091 Vali Acc: 0.540 Test Loss: 2.091 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.747731924057007
Epoch: 5, Steps: 35 | Train Loss: 3.378 Vali Loss: 5.840 Vali Acc: 0.490 Test Loss: 5.840 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.788212776184082
Epoch: 6, Steps: 35 | Train Loss: 4.229 Vali Loss: 6.076 Vali Acc: 0.480 Test Loss: 6.076 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.017117500305176
Epoch: 7, Steps: 35 | Train Loss: 3.947 Vali Loss: 11.648 Vali Acc: 0.490 Test Loss: 11.648 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9503135681152344
Epoch: 8, Steps: 35 | Train Loss: 4.756 Vali Loss: 4.933 Vali Acc: 0.470 Test Loss: 4.933 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1443772315979004
Epoch: 9, Steps: 35 | Train Loss: 4.003 Vali Loss: 11.111 Vali Acc: 0.440 Test Loss: 11.111 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2267098426818848
Epoch: 10, Steps: 35 | Train Loss: 2.541 Vali Loss: 5.071 Vali Acc: 0.540 Test Loss: 5.071 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.797799825668335
Epoch: 11, Steps: 35 | Train Loss: 2.079 Vali Loss: 7.854 Vali Acc: 0.550 Test Loss: 7.854 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7099266052246094
Epoch: 12, Steps: 35 | Train Loss: 3.274 Vali Loss: 7.178 Vali Acc: 0.460 Test Loss: 7.178 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.05497145652771
Epoch: 13, Steps: 35 | Train Loss: 3.270 Vali Loss: 10.176 Vali Acc: 0.490 Test Loss: 10.176 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1105682
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.5979554653167725
Epoch: 1, Steps: 35 | Train Loss: 1.705 Vali Loss: 1.887 Vali Acc: 0.480 Test Loss: 1.887 Test Acc: 0.480
Validation loss decreased (inf --> -0.479981).  Saving model ...
Epoch: 2 cost time: 3.4660282135009766
Epoch: 2, Steps: 35 | Train Loss: 3.632 Vali Loss: 5.695 Vali Acc: 0.510 Test Loss: 5.695 Test Acc: 0.510
Validation loss decreased (-0.479981 --> -0.509943).  Saving model ...
Epoch: 3 cost time: 3.528240919113159
Epoch: 3, Steps: 35 | Train Loss: 3.201 Vali Loss: 9.984 Vali Acc: 0.500 Test Loss: 9.984 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4608912467956543
Epoch: 4, Steps: 35 | Train Loss: 2.462 Vali Loss: 5.110 Vali Acc: 0.470 Test Loss: 5.110 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3063807487487793
Epoch: 5, Steps: 35 | Train Loss: 3.494 Vali Loss: 22.856 Vali Acc: 0.500 Test Loss: 22.856 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1268603801727295
Epoch: 6, Steps: 35 | Train Loss: 4.994 Vali Loss: 5.082 Vali Acc: 0.560 Test Loss: 5.082 Test Acc: 0.560
Validation loss decreased (-0.509943 --> -0.559949).  Saving model ...
Epoch: 7 cost time: 3.1734771728515625
Epoch: 7, Steps: 35 | Train Loss: 3.327 Vali Loss: 15.251 Vali Acc: 0.550 Test Loss: 15.251 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.362227439880371
Epoch: 8, Steps: 35 | Train Loss: 8.535 Vali Loss: 21.178 Vali Acc: 0.500 Test Loss: 21.178 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.214205503463745
Epoch: 9, Steps: 35 | Train Loss: 2.806 Vali Loss: 14.385 Vali Acc: 0.470 Test Loss: 14.385 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5433616638183594
Epoch: 10, Steps: 35 | Train Loss: 5.062 Vali Loss: 11.970 Vali Acc: 0.500 Test Loss: 11.970 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3067970275878906
Epoch: 11, Steps: 35 | Train Loss: 4.351 Vali Loss: 15.387 Vali Acc: 0.520 Test Loss: 15.387 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1257011890411377
Epoch: 12, Steps: 35 | Train Loss: 3.556 Vali Loss: 5.201 Vali Acc: 0.460 Test Loss: 5.201 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4938204288482666
Epoch: 13, Steps: 35 | Train Loss: 1.069 Vali Loss: 6.956 Vali Acc: 0.570 Test Loss: 6.956 Test Acc: 0.570
Validation loss decreased (-0.559949 --> -0.569930).  Saving model ...
Epoch: 14 cost time: 3.422745704650879
Epoch: 14, Steps: 35 | Train Loss: 1.427 Vali Loss: 9.773 Vali Acc: 0.490 Test Loss: 9.773 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.249079704284668
Epoch: 15, Steps: 35 | Train Loss: 1.191 Vali Loss: 9.089 Vali Acc: 0.530 Test Loss: 9.089 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3833200931549072
Epoch: 16, Steps: 35 | Train Loss: 3.093 Vali Loss: 12.786 Vali Acc: 0.520 Test Loss: 12.786 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4444684982299805
Epoch: 17, Steps: 35 | Train Loss: 1.878 Vali Loss: 12.143 Vali Acc: 0.500 Test Loss: 12.143 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.256464719772339
Epoch: 18, Steps: 35 | Train Loss: 2.397 Vali Loss: 31.579 Vali Acc: 0.470 Test Loss: 31.579 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.150336742401123
Epoch: 19, Steps: 35 | Train Loss: 3.137 Vali Loss: 10.654 Vali Acc: 0.490 Test Loss: 10.654 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.296144723892212
Epoch: 20, Steps: 35 | Train Loss: 2.512 Vali Loss: 7.919 Vali Acc: 0.540 Test Loss: 7.919 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.394735813140869
Epoch: 21, Steps: 35 | Train Loss: 5.966 Vali Loss: 14.676 Vali Acc: 0.450 Test Loss: 14.676 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.3797390460968018
Epoch: 22, Steps: 35 | Train Loss: 3.811 Vali Loss: 15.941 Vali Acc: 0.480 Test Loss: 15.941 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.317403554916382
Epoch: 23, Steps: 35 | Train Loss: 3.612 Vali Loss: 26.363 Vali Acc: 0.430 Test Loss: 26.363 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 974610
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.313711166381836
Epoch: 1, Steps: 35 | Train Loss: 1.624 Vali Loss: 1.912 Vali Acc: 0.520 Test Loss: 1.912 Test Acc: 0.520
Validation loss decreased (inf --> -0.519981).  Saving model ...
Epoch: 2 cost time: 3.2139415740966797
Epoch: 2, Steps: 35 | Train Loss: 2.466 Vali Loss: 7.067 Vali Acc: 0.460 Test Loss: 7.067 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0794146060943604
Epoch: 3, Steps: 35 | Train Loss: 5.357 Vali Loss: 6.001 Vali Acc: 0.510 Test Loss: 6.001 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.971104860305786
Epoch: 4, Steps: 35 | Train Loss: 2.460 Vali Loss: 5.797 Vali Acc: 0.520 Test Loss: 5.797 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.995136260986328
Epoch: 5, Steps: 35 | Train Loss: 3.742 Vali Loss: 21.419 Vali Acc: 0.480 Test Loss: 21.419 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9984822273254395
Epoch: 6, Steps: 35 | Train Loss: 4.055 Vali Loss: 5.119 Vali Acc: 0.570 Test Loss: 5.119 Test Acc: 0.570
Validation loss decreased (-0.519981 --> -0.569949).  Saving model ...
Epoch: 7 cost time: 2.915072441101074
Epoch: 7, Steps: 35 | Train Loss: 5.374 Vali Loss: 8.582 Vali Acc: 0.460 Test Loss: 8.582 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9092345237731934
Epoch: 8, Steps: 35 | Train Loss: 2.626 Vali Loss: 19.948 Vali Acc: 0.500 Test Loss: 19.948 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1468515396118164
Epoch: 9, Steps: 35 | Train Loss: 2.991 Vali Loss: 6.033 Vali Acc: 0.530 Test Loss: 6.033 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1711153984069824
Epoch: 10, Steps: 35 | Train Loss: 4.890 Vali Loss: 20.351 Vali Acc: 0.480 Test Loss: 20.351 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0587377548217773
Epoch: 11, Steps: 35 | Train Loss: 2.413 Vali Loss: 13.414 Vali Acc: 0.440 Test Loss: 13.414 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0662245750427246
Epoch: 12, Steps: 35 | Train Loss: 4.370 Vali Loss: 26.008 Vali Acc: 0.480 Test Loss: 26.008 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.031604528427124
Epoch: 13, Steps: 35 | Train Loss: 4.357 Vali Loss: 14.140 Vali Acc: 0.510 Test Loss: 14.140 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.007488250732422
Epoch: 14, Steps: 35 | Train Loss: 4.843 Vali Loss: 15.467 Vali Acc: 0.470 Test Loss: 15.467 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1494381427764893
Epoch: 15, Steps: 35 | Train Loss: 2.205 Vali Loss: 10.901 Vali Acc: 0.570 Test Loss: 10.901 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.021958112716675
Epoch: 16, Steps: 35 | Train Loss: 1.741 Vali Loss: 20.921 Vali Acc: 0.490 Test Loss: 20.921 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 974610
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.74225640296936
Epoch: 1, Steps: 35 | Train Loss: 1.394 Vali Loss: 2.681 Vali Acc: 0.500 Test Loss: 2.681 Test Acc: 0.500
Validation loss decreased (inf --> -0.499973).  Saving model ...
Epoch: 2 cost time: 2.884392499923706
Epoch: 2, Steps: 35 | Train Loss: 3.175 Vali Loss: 9.007 Vali Acc: 0.500 Test Loss: 9.007 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8386497497558594
Epoch: 3, Steps: 35 | Train Loss: 5.174 Vali Loss: 3.656 Vali Acc: 0.540 Test Loss: 3.656 Test Acc: 0.540
Validation loss decreased (-0.499973 --> -0.539963).  Saving model ...
Epoch: 4 cost time: 3.0662736892700195
Epoch: 4, Steps: 35 | Train Loss: 3.341 Vali Loss: 7.600 Vali Acc: 0.480 Test Loss: 7.600 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.611762762069702
Epoch: 5, Steps: 35 | Train Loss: 4.789 Vali Loss: 14.319 Vali Acc: 0.500 Test Loss: 14.319 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.282588481903076
Epoch: 6, Steps: 35 | Train Loss: 2.818 Vali Loss: 5.246 Vali Acc: 0.520 Test Loss: 5.246 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.117656946182251
Epoch: 7, Steps: 35 | Train Loss: 4.460 Vali Loss: 5.234 Vali Acc: 0.530 Test Loss: 5.234 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9257307052612305
Epoch: 8, Steps: 35 | Train Loss: 2.709 Vali Loss: 16.229 Vali Acc: 0.490 Test Loss: 16.229 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9723479747772217
Epoch: 9, Steps: 35 | Train Loss: 3.562 Vali Loss: 11.221 Vali Acc: 0.480 Test Loss: 11.221 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0795817375183105
Epoch: 10, Steps: 35 | Train Loss: 3.682 Vali Loss: 26.898 Vali Acc: 0.480 Test Loss: 26.898 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.919481039047241
Epoch: 11, Steps: 35 | Train Loss: 1.981 Vali Loss: 14.556 Vali Acc: 0.470 Test Loss: 14.556 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9120900630950928
Epoch: 12, Steps: 35 | Train Loss: 2.864 Vali Loss: 11.454 Vali Acc: 0.520 Test Loss: 11.454 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9413158893585205
Epoch: 13, Steps: 35 | Train Loss: 2.394 Vali Loss: 13.787 Vali Acc: 0.480 Test Loss: 13.787 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 974610
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.604835033416748
Epoch: 1, Steps: 35 | Train Loss: 1.349 Vali Loss: 2.827 Vali Acc: 0.450 Test Loss: 2.827 Test Acc: 0.450
Validation loss decreased (inf --> -0.449972).  Saving model ...
Epoch: 2 cost time: 2.6039581298828125
Epoch: 2, Steps: 35 | Train Loss: 2.482 Vali Loss: 2.831 Vali Acc: 0.490 Test Loss: 2.831 Test Acc: 0.490
Validation loss decreased (-0.449972 --> -0.489972).  Saving model ...
Epoch: 3 cost time: 2.6405701637268066
Epoch: 3, Steps: 35 | Train Loss: 3.443 Vali Loss: 9.431 Vali Acc: 0.500 Test Loss: 9.431 Test Acc: 0.500
Validation loss decreased (-0.489972 --> -0.499906).  Saving model ...
Epoch: 4 cost time: 2.7385566234588623
Epoch: 4, Steps: 35 | Train Loss: 4.186 Vali Loss: 7.156 Vali Acc: 0.470 Test Loss: 7.156 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.802583694458008
Epoch: 5, Steps: 35 | Train Loss: 3.543 Vali Loss: 8.557 Vali Acc: 0.500 Test Loss: 8.557 Test Acc: 0.500
Validation loss decreased (-0.499906 --> -0.499914).  Saving model ...
Epoch: 6 cost time: 2.967862367630005
Epoch: 6, Steps: 35 | Train Loss: 3.897 Vali Loss: 5.784 Vali Acc: 0.530 Test Loss: 5.784 Test Acc: 0.530
Validation loss decreased (-0.499914 --> -0.529942).  Saving model ...
Epoch: 7 cost time: 2.8758158683776855
Epoch: 7, Steps: 35 | Train Loss: 5.010 Vali Loss: 5.922 Vali Acc: 0.470 Test Loss: 5.922 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6306819915771484
Epoch: 8, Steps: 35 | Train Loss: 2.286 Vali Loss: 5.455 Vali Acc: 0.520 Test Loss: 5.455 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4976136684417725
Epoch: 9, Steps: 35 | Train Loss: 4.604 Vali Loss: 8.567 Vali Acc: 0.460 Test Loss: 8.567 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.625378131866455
Epoch: 10, Steps: 35 | Train Loss: 3.860 Vali Loss: 15.519 Vali Acc: 0.480 Test Loss: 15.519 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5107192993164062
Epoch: 11, Steps: 35 | Train Loss: 3.296 Vali Loss: 12.177 Vali Acc: 0.460 Test Loss: 12.177 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.684497117996216
Epoch: 12, Steps: 35 | Train Loss: 3.310 Vali Loss: 14.762 Vali Acc: 0.470 Test Loss: 14.762 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.737025499343872
Epoch: 13, Steps: 35 | Train Loss: 3.491 Vali Loss: 6.970 Vali Acc: 0.520 Test Loss: 6.970 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.820439577102661
Epoch: 14, Steps: 35 | Train Loss: 2.043 Vali Loss: 7.710 Vali Acc: 0.480 Test Loss: 7.710 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7907230854034424
Epoch: 15, Steps: 35 | Train Loss: 3.247 Vali Loss: 9.096 Vali Acc: 0.490 Test Loss: 9.096 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.94989275932312
Epoch: 16, Steps: 35 | Train Loss: 3.552 Vali Loss: 12.263 Vali Acc: 0.570 Test Loss: 12.263 Test Acc: 0.570
Validation loss decreased (-0.529942 --> -0.569877).  Saving model ...
Epoch: 17 cost time: 2.782583713531494
Epoch: 17, Steps: 35 | Train Loss: 1.505 Vali Loss: 7.986 Vali Acc: 0.580 Test Loss: 7.986 Test Acc: 0.580
Validation loss decreased (-0.569877 --> -0.579920).  Saving model ...
Epoch: 18 cost time: 2.834198236465454
Epoch: 18, Steps: 35 | Train Loss: 3.640 Vali Loss: 32.819 Vali Acc: 0.470 Test Loss: 32.819 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.704005241394043
Epoch: 19, Steps: 35 | Train Loss: 5.606 Vali Loss: 9.666 Vali Acc: 0.550 Test Loss: 9.666 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.72465443611145
Epoch: 20, Steps: 35 | Train Loss: 2.842 Vali Loss: 19.153 Vali Acc: 0.500 Test Loss: 19.153 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.701263427734375
Epoch: 21, Steps: 35 | Train Loss: 4.415 Vali Loss: 18.667 Vali Acc: 0.460 Test Loss: 18.667 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5585854053497314
Epoch: 22, Steps: 35 | Train Loss: 2.338 Vali Loss: 12.793 Vali Acc: 0.590 Test Loss: 12.793 Test Acc: 0.590
Validation loss decreased (-0.579920 --> -0.589872).  Saving model ...
Epoch: 23 cost time: 2.540114402770996
Epoch: 23, Steps: 35 | Train Loss: 6.617 Vali Loss: 19.088 Vali Acc: 0.540 Test Loss: 19.088 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.672992467880249
Epoch: 24, Steps: 35 | Train Loss: 3.107 Vali Loss: 21.099 Vali Acc: 0.460 Test Loss: 21.099 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.609060525894165
Epoch: 25, Steps: 35 | Train Loss: 3.252 Vali Loss: 20.942 Vali Acc: 0.480 Test Loss: 20.942 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.843855142593384
Epoch: 26, Steps: 35 | Train Loss: 4.552 Vali Loss: 16.382 Vali Acc: 0.520 Test Loss: 16.382 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8098669052124023
Epoch: 27, Steps: 35 | Train Loss: 1.939 Vali Loss: 28.686 Vali Acc: 0.490 Test Loss: 28.686 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.8695738315582275
Epoch: 28, Steps: 35 | Train Loss: 3.760 Vali Loss: 23.776 Vali Acc: 0.490 Test Loss: 23.776 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8836777210235596
Epoch: 29, Steps: 35 | Train Loss: 2.007 Vali Loss: 19.577 Vali Acc: 0.520 Test Loss: 19.577 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7831883430480957
Epoch: 30, Steps: 35 | Train Loss: 1.364 Vali Loss: 16.693 Vali Acc: 0.500 Test Loss: 16.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.717109441757202
Epoch: 31, Steps: 35 | Train Loss: 2.766 Vali Loss: 20.260 Vali Acc: 0.520 Test Loss: 20.260 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8041367530822754
Epoch: 32, Steps: 35 | Train Loss: 2.730 Vali Loss: 27.644 Vali Acc: 0.540 Test Loss: 27.644 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 974610
model size : 6.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.051862716674805
Epoch: 1, Steps: 35 | Train Loss: 2.094 Vali Loss: 3.078 Vali Acc: 0.450 Test Loss: 3.078 Test Acc: 0.450
Validation loss decreased (inf --> -0.449969).  Saving model ...
Epoch: 2 cost time: 3.162752866744995
Epoch: 2, Steps: 35 | Train Loss: 2.643 Vali Loss: 3.877 Vali Acc: 0.450 Test Loss: 3.877 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.299288272857666
Epoch: 3, Steps: 35 | Train Loss: 2.609 Vali Loss: 4.968 Vali Acc: 0.620 Test Loss: 4.968 Test Acc: 0.620
Validation loss decreased (-0.449969 --> -0.619950).  Saving model ...
Epoch: 4 cost time: 3.130225896835327
Epoch: 4, Steps: 35 | Train Loss: 3.280 Vali Loss: 4.149 Vali Acc: 0.480 Test Loss: 4.149 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.095670461654663
Epoch: 5, Steps: 35 | Train Loss: 3.530 Vali Loss: 6.830 Vali Acc: 0.490 Test Loss: 6.830 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1554088592529297
Epoch: 6, Steps: 35 | Train Loss: 10.773 Vali Loss: 12.481 Vali Acc: 0.510 Test Loss: 12.481 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.096851110458374
Epoch: 7, Steps: 35 | Train Loss: 5.521 Vali Loss: 5.169 Vali Acc: 0.570 Test Loss: 5.169 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0623395442962646
Epoch: 8, Steps: 35 | Train Loss: 4.119 Vali Loss: 8.603 Vali Acc: 0.440 Test Loss: 8.603 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.095242738723755
Epoch: 9, Steps: 35 | Train Loss: 5.566 Vali Loss: 9.384 Vali Acc: 0.480 Test Loss: 9.384 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.168994665145874
Epoch: 10, Steps: 35 | Train Loss: 6.946 Vali Loss: 14.306 Vali Acc: 0.460 Test Loss: 14.306 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.148477077484131
Epoch: 11, Steps: 35 | Train Loss: 2.174 Vali Loss: 15.434 Vali Acc: 0.540 Test Loss: 15.434 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1537978649139404
Epoch: 12, Steps: 35 | Train Loss: 2.292 Vali Loss: 7.948 Vali Acc: 0.470 Test Loss: 7.948 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0576705932617188
Epoch: 13, Steps: 35 | Train Loss: 2.974 Vali Loss: 15.176 Vali Acc: 0.490 Test Loss: 15.176 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 909074
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.123003244400024
Epoch: 1, Steps: 35 | Train Loss: 1.905 Vali Loss: 2.111 Vali Acc: 0.420 Test Loss: 2.111 Test Acc: 0.420
Validation loss decreased (inf --> -0.419979).  Saving model ...
Epoch: 2 cost time: 3.0184125900268555
Epoch: 2, Steps: 35 | Train Loss: 2.550 Vali Loss: 2.794 Vali Acc: 0.510 Test Loss: 2.794 Test Acc: 0.510
Validation loss decreased (-0.419979 --> -0.509972).  Saving model ...
Epoch: 3 cost time: 3.1129467487335205
Epoch: 3, Steps: 35 | Train Loss: 2.253 Vali Loss: 2.610 Vali Acc: 0.470 Test Loss: 2.610 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.116764783859253
Epoch: 4, Steps: 35 | Train Loss: 2.708 Vali Loss: 3.815 Vali Acc: 0.450 Test Loss: 3.815 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.145195960998535
Epoch: 5, Steps: 35 | Train Loss: 3.753 Vali Loss: 9.157 Vali Acc: 0.510 Test Loss: 9.157 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0954887866973877
Epoch: 6, Steps: 35 | Train Loss: 4.131 Vali Loss: 17.600 Vali Acc: 0.490 Test Loss: 17.600 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2894270420074463
Epoch: 7, Steps: 35 | Train Loss: 5.246 Vali Loss: 9.751 Vali Acc: 0.480 Test Loss: 9.751 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2430176734924316
Epoch: 8, Steps: 35 | Train Loss: 5.600 Vali Loss: 15.109 Vali Acc: 0.550 Test Loss: 15.109 Test Acc: 0.550
Validation loss decreased (-0.509972 --> -0.549849).  Saving model ...
Epoch: 9 cost time: 2.944537401199341
Epoch: 9, Steps: 35 | Train Loss: 5.994 Vali Loss: 4.916 Vali Acc: 0.490 Test Loss: 4.916 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.95989990234375
Epoch: 10, Steps: 35 | Train Loss: 4.179 Vali Loss: 14.082 Vali Acc: 0.500 Test Loss: 14.082 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.972686529159546
Epoch: 11, Steps: 35 | Train Loss: 3.696 Vali Loss: 10.261 Vali Acc: 0.450 Test Loss: 10.261 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0419411659240723
Epoch: 12, Steps: 35 | Train Loss: 4.672 Vali Loss: 22.719 Vali Acc: 0.470 Test Loss: 22.719 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.192140579223633
Epoch: 13, Steps: 35 | Train Loss: 8.622 Vali Loss: 29.335 Vali Acc: 0.500 Test Loss: 29.335 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1634140014648438
Epoch: 14, Steps: 35 | Train Loss: 4.427 Vali Loss: 14.220 Vali Acc: 0.490 Test Loss: 14.220 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2370731830596924
Epoch: 15, Steps: 35 | Train Loss: 2.194 Vali Loss: 12.160 Vali Acc: 0.510 Test Loss: 12.160 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2510578632354736
Epoch: 16, Steps: 35 | Train Loss: 4.237 Vali Loss: 16.541 Vali Acc: 0.440 Test Loss: 16.541 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.171987295150757
Epoch: 17, Steps: 35 | Train Loss: 3.046 Vali Loss: 11.636 Vali Acc: 0.550 Test Loss: 11.636 Test Acc: 0.550
Validation loss decreased (-0.549849 --> -0.549884).  Saving model ...
Epoch: 18 cost time: 3.120189905166626
Epoch: 18, Steps: 35 | Train Loss: 2.928 Vali Loss: 14.757 Vali Acc: 0.500 Test Loss: 14.757 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.055882215499878
Epoch: 19, Steps: 35 | Train Loss: 4.994 Vali Loss: 18.416 Vali Acc: 0.490 Test Loss: 18.416 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1095333099365234
Epoch: 20, Steps: 35 | Train Loss: 4.437 Vali Loss: 15.151 Vali Acc: 0.490 Test Loss: 15.151 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9508700370788574
Epoch: 21, Steps: 35 | Train Loss: 2.873 Vali Loss: 29.906 Vali Acc: 0.480 Test Loss: 29.906 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.821289300918579
Epoch: 22, Steps: 35 | Train Loss: 5.274 Vali Loss: 14.530 Vali Acc: 0.560 Test Loss: 14.530 Test Acc: 0.560
Validation loss decreased (-0.549884 --> -0.559855).  Saving model ...
Epoch: 23 cost time: 2.8572893142700195
Epoch: 23, Steps: 35 | Train Loss: 2.339 Vali Loss: 24.358 Vali Acc: 0.480 Test Loss: 24.358 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1105899810791016
Epoch: 24, Steps: 35 | Train Loss: 4.241 Vali Loss: 25.209 Vali Acc: 0.520 Test Loss: 25.209 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.170679807662964
Epoch: 25, Steps: 35 | Train Loss: 2.098 Vali Loss: 42.219 Vali Acc: 0.500 Test Loss: 42.219 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0681169033050537
Epoch: 26, Steps: 35 | Train Loss: 2.713 Vali Loss: 17.494 Vali Acc: 0.540 Test Loss: 17.494 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.165210247039795
Epoch: 27, Steps: 35 | Train Loss: 1.892 Vali Loss: 21.032 Vali Acc: 0.520 Test Loss: 21.032 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0285747051239014
Epoch: 28, Steps: 35 | Train Loss: 2.341 Vali Loss: 15.361 Vali Acc: 0.510 Test Loss: 15.361 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.061230182647705
Epoch: 29, Steps: 35 | Train Loss: 1.603 Vali Loss: 32.801 Vali Acc: 0.500 Test Loss: 32.801 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.06058931350708
Epoch: 30, Steps: 35 | Train Loss: 1.895 Vali Loss: 19.491 Vali Acc: 0.490 Test Loss: 19.491 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.1705119609832764
Epoch: 31, Steps: 35 | Train Loss: 3.011 Vali Loss: 29.553 Vali Acc: 0.500 Test Loss: 29.553 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.091571569442749
Epoch: 32, Steps: 35 | Train Loss: 2.767 Vali Loss: 39.161 Vali Acc: 0.520 Test Loss: 39.161 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 909074
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.032234191894531
Epoch: 1, Steps: 35 | Train Loss: 1.660 Vali Loss: 2.787 Vali Acc: 0.480 Test Loss: 2.787 Test Acc: 0.480
Validation loss decreased (inf --> -0.479972).  Saving model ...
Epoch: 2 cost time: 2.8843870162963867
Epoch: 2, Steps: 35 | Train Loss: 2.231 Vali Loss: 4.606 Vali Acc: 0.460 Test Loss: 4.606 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.825753688812256
Epoch: 3, Steps: 35 | Train Loss: 2.815 Vali Loss: 6.708 Vali Acc: 0.550 Test Loss: 6.708 Test Acc: 0.550
Validation loss decreased (-0.479972 --> -0.549933).  Saving model ...
Epoch: 4 cost time: 3.157869815826416
Epoch: 4, Steps: 35 | Train Loss: 2.612 Vali Loss: 3.805 Vali Acc: 0.480 Test Loss: 3.805 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0078892707824707
Epoch: 5, Steps: 35 | Train Loss: 4.262 Vali Loss: 7.278 Vali Acc: 0.520 Test Loss: 7.278 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1610591411590576
Epoch: 6, Steps: 35 | Train Loss: 5.464 Vali Loss: 12.704 Vali Acc: 0.510 Test Loss: 12.704 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3374366760253906
Epoch: 7, Steps: 35 | Train Loss: 5.915 Vali Loss: 7.164 Vali Acc: 0.540 Test Loss: 7.164 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.059089183807373
Epoch: 8, Steps: 35 | Train Loss: 4.349 Vali Loss: 8.937 Vali Acc: 0.520 Test Loss: 8.937 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.327991485595703
Epoch: 9, Steps: 35 | Train Loss: 3.718 Vali Loss: 14.585 Vali Acc: 0.500 Test Loss: 14.585 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3938019275665283
Epoch: 10, Steps: 35 | Train Loss: 4.514 Vali Loss: 20.851 Vali Acc: 0.480 Test Loss: 20.851 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.294921398162842
Epoch: 11, Steps: 35 | Train Loss: 3.629 Vali Loss: 7.957 Vali Acc: 0.470 Test Loss: 7.957 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.038266658782959
Epoch: 12, Steps: 35 | Train Loss: 4.382 Vali Loss: 12.273 Vali Acc: 0.540 Test Loss: 12.273 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0623106956481934
Epoch: 13, Steps: 35 | Train Loss: 4.084 Vali Loss: 18.255 Vali Acc: 0.550 Test Loss: 18.255 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 909074
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.780411720275879
Epoch: 1, Steps: 35 | Train Loss: 1.479 Vali Loss: 2.147 Vali Acc: 0.470 Test Loss: 2.147 Test Acc: 0.470
Validation loss decreased (inf --> -0.469979).  Saving model ...
Epoch: 2 cost time: 2.7759199142456055
Epoch: 2, Steps: 35 | Train Loss: 2.212 Vali Loss: 2.042 Vali Acc: 0.540 Test Loss: 2.042 Test Acc: 0.540
Validation loss decreased (-0.469979 --> -0.539980).  Saving model ...
Epoch: 3 cost time: 2.7163949012756348
Epoch: 3, Steps: 35 | Train Loss: 2.234 Vali Loss: 3.642 Vali Acc: 0.550 Test Loss: 3.642 Test Acc: 0.550
Validation loss decreased (-0.539980 --> -0.549964).  Saving model ...
Epoch: 4 cost time: 2.7007291316986084
Epoch: 4, Steps: 35 | Train Loss: 2.910 Vali Loss: 3.233 Vali Acc: 0.550 Test Loss: 3.233 Test Acc: 0.550
Validation loss decreased (-0.549964 --> -0.549968).  Saving model ...
Epoch: 5 cost time: 2.693995237350464
Epoch: 5, Steps: 35 | Train Loss: 4.505 Vali Loss: 8.815 Vali Acc: 0.480 Test Loss: 8.815 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6481974124908447
Epoch: 6, Steps: 35 | Train Loss: 6.662 Vali Loss: 5.017 Vali Acc: 0.550 Test Loss: 5.017 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.59153413772583
Epoch: 7, Steps: 35 | Train Loss: 2.797 Vali Loss: 8.324 Vali Acc: 0.530 Test Loss: 8.324 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7862417697906494
Epoch: 8, Steps: 35 | Train Loss: 3.867 Vali Loss: 8.188 Vali Acc: 0.510 Test Loss: 8.188 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7527108192443848
Epoch: 9, Steps: 35 | Train Loss: 3.862 Vali Loss: 7.599 Vali Acc: 0.460 Test Loss: 7.599 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.88655424118042
Epoch: 10, Steps: 35 | Train Loss: 3.123 Vali Loss: 8.011 Vali Acc: 0.520 Test Loss: 8.011 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7548956871032715
Epoch: 11, Steps: 35 | Train Loss: 2.883 Vali Loss: 5.705 Vali Acc: 0.550 Test Loss: 5.705 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6073062419891357
Epoch: 12, Steps: 35 | Train Loss: 2.283 Vali Loss: 6.617 Vali Acc: 0.610 Test Loss: 6.617 Test Acc: 0.610
Validation loss decreased (-0.549968 --> -0.609934).  Saving model ...
Epoch: 13 cost time: 2.7458655834198
Epoch: 13, Steps: 35 | Train Loss: 2.827 Vali Loss: 15.367 Vali Acc: 0.500 Test Loss: 15.367 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.945801258087158
Epoch: 14, Steps: 35 | Train Loss: 5.378 Vali Loss: 8.643 Vali Acc: 0.570 Test Loss: 8.643 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.776376962661743
Epoch: 15, Steps: 35 | Train Loss: 2.066 Vali Loss: 10.039 Vali Acc: 0.500 Test Loss: 10.039 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4999382495880127
Epoch: 16, Steps: 35 | Train Loss: 2.166 Vali Loss: 6.689 Vali Acc: 0.560 Test Loss: 6.689 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.818281412124634
Epoch: 17, Steps: 35 | Train Loss: 4.427 Vali Loss: 11.805 Vali Acc: 0.480 Test Loss: 11.805 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.751805543899536
Epoch: 18, Steps: 35 | Train Loss: 2.428 Vali Loss: 13.947 Vali Acc: 0.470 Test Loss: 13.947 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.741382122039795
Epoch: 19, Steps: 35 | Train Loss: 4.187 Vali Loss: 22.280 Vali Acc: 0.490 Test Loss: 22.280 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.779332160949707
Epoch: 20, Steps: 35 | Train Loss: 3.290 Vali Loss: 8.992 Vali Acc: 0.570 Test Loss: 8.992 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7492525577545166
Epoch: 21, Steps: 35 | Train Loss: 2.601 Vali Loss: 19.577 Vali Acc: 0.500 Test Loss: 19.577 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.741044044494629
Epoch: 22, Steps: 35 | Train Loss: 2.338 Vali Loss: 20.431 Vali Acc: 0.470 Test Loss: 20.431 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 909074
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.09850287437439
Epoch: 1, Steps: 35 | Train Loss: 1.504 Vali Loss: 2.276 Vali Acc: 0.520 Test Loss: 2.276 Test Acc: 0.520
Validation loss decreased (inf --> -0.519977).  Saving model ...
Epoch: 2 cost time: 3.113593101501465
Epoch: 2, Steps: 35 | Train Loss: 2.472 Vali Loss: 3.968 Vali Acc: 0.430 Test Loss: 3.968 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.443345308303833
Epoch: 3, Steps: 35 | Train Loss: 3.218 Vali Loss: 4.773 Vali Acc: 0.520 Test Loss: 4.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.45139741897583
Epoch: 4, Steps: 35 | Train Loss: 2.877 Vali Loss: 4.703 Vali Acc: 0.470 Test Loss: 4.703 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.181889295578003
Epoch: 5, Steps: 35 | Train Loss: 5.077 Vali Loss: 5.023 Vali Acc: 0.560 Test Loss: 5.023 Test Acc: 0.560
Validation loss decreased (-0.519977 --> -0.559950).  Saving model ...
Epoch: 6 cost time: 3.392118215560913
Epoch: 6, Steps: 35 | Train Loss: 5.577 Vali Loss: 6.788 Vali Acc: 0.510 Test Loss: 6.788 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.496790885925293
Epoch: 7, Steps: 35 | Train Loss: 2.904 Vali Loss: 12.871 Vali Acc: 0.490 Test Loss: 12.871 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4661614894866943
Epoch: 8, Steps: 35 | Train Loss: 3.687 Vali Loss: 8.557 Vali Acc: 0.510 Test Loss: 8.557 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5264334678649902
Epoch: 9, Steps: 35 | Train Loss: 2.142 Vali Loss: 10.118 Vali Acc: 0.530 Test Loss: 10.118 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2090470790863037
Epoch: 10, Steps: 35 | Train Loss: 3.620 Vali Loss: 12.762 Vali Acc: 0.500 Test Loss: 12.762 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3892507553100586
Epoch: 11, Steps: 35 | Train Loss: 2.693 Vali Loss: 5.432 Vali Acc: 0.550 Test Loss: 5.432 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2393784523010254
Epoch: 12, Steps: 35 | Train Loss: 3.286 Vali Loss: 7.545 Vali Acc: 0.530 Test Loss: 7.545 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.313424587249756
Epoch: 13, Steps: 35 | Train Loss: 1.784 Vali Loss: 4.910 Vali Acc: 0.580 Test Loss: 4.910 Test Acc: 0.580
Validation loss decreased (-0.559950 --> -0.579951).  Saving model ...
Epoch: 14 cost time: 3.1726489067077637
Epoch: 14, Steps: 35 | Train Loss: 1.221 Vali Loss: 27.631 Vali Acc: 0.490 Test Loss: 27.631 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.086514711380005
Epoch: 15, Steps: 35 | Train Loss: 2.200 Vali Loss: 12.792 Vali Acc: 0.460 Test Loss: 12.792 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1193385124206543
Epoch: 16, Steps: 35 | Train Loss: 4.399 Vali Loss: 17.847 Vali Acc: 0.480 Test Loss: 17.847 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.249654531478882
Epoch: 17, Steps: 35 | Train Loss: 3.034 Vali Loss: 13.108 Vali Acc: 0.550 Test Loss: 13.108 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1752419471740723
Epoch: 18, Steps: 35 | Train Loss: 2.250 Vali Loss: 15.881 Vali Acc: 0.550 Test Loss: 15.881 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.297358274459839
Epoch: 19, Steps: 35 | Train Loss: 1.942 Vali Loss: 19.191 Vali Acc: 0.500 Test Loss: 19.191 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3652970790863037
Epoch: 20, Steps: 35 | Train Loss: 0.909 Vali Loss: 24.749 Vali Acc: 0.500 Test Loss: 24.749 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.317716598510742
Epoch: 21, Steps: 35 | Train Loss: 4.013 Vali Loss: 16.809 Vali Acc: 0.510 Test Loss: 16.809 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.444284677505493
Epoch: 22, Steps: 35 | Train Loss: 2.725 Vali Loss: 22.876 Vali Acc: 0.510 Test Loss: 22.876 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3545451164245605
Epoch: 23, Steps: 35 | Train Loss: 1.362 Vali Loss: 19.420 Vali Acc: 0.490 Test Loss: 19.420 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 876306
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.7739832401275635
Epoch: 1, Steps: 35 | Train Loss: 1.430 Vali Loss: 1.526 Vali Acc: 0.580 Test Loss: 1.526 Test Acc: 0.580
Validation loss decreased (inf --> -0.579985).  Saving model ...
Epoch: 2 cost time: 2.7424228191375732
Epoch: 2, Steps: 35 | Train Loss: 2.223 Vali Loss: 7.002 Vali Acc: 0.500 Test Loss: 7.002 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7603578567504883
Epoch: 3, Steps: 35 | Train Loss: 3.632 Vali Loss: 2.505 Vali Acc: 0.580 Test Loss: 2.505 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7058751583099365
Epoch: 4, Steps: 35 | Train Loss: 5.787 Vali Loss: 6.506 Vali Acc: 0.460 Test Loss: 6.506 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8814902305603027
Epoch: 5, Steps: 35 | Train Loss: 4.882 Vali Loss: 11.747 Vali Acc: 0.510 Test Loss: 11.747 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8978021144866943
Epoch: 6, Steps: 35 | Train Loss: 7.447 Vali Loss: 4.318 Vali Acc: 0.520 Test Loss: 4.318 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.886756181716919
Epoch: 7, Steps: 35 | Train Loss: 3.628 Vali Loss: 10.871 Vali Acc: 0.530 Test Loss: 10.871 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9792144298553467
Epoch: 8, Steps: 35 | Train Loss: 2.701 Vali Loss: 6.371 Vali Acc: 0.540 Test Loss: 6.371 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.937699556350708
Epoch: 9, Steps: 35 | Train Loss: 2.392 Vali Loss: 8.037 Vali Acc: 0.480 Test Loss: 8.037 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8229756355285645
Epoch: 10, Steps: 35 | Train Loss: 3.405 Vali Loss: 20.965 Vali Acc: 0.500 Test Loss: 20.965 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7173547744750977
Epoch: 11, Steps: 35 | Train Loss: 7.467 Vali Loss: 16.677 Vali Acc: 0.480 Test Loss: 16.677 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 876306
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.325843095779419
Epoch: 1, Steps: 35 | Train Loss: 1.370 Vali Loss: 2.134 Vali Acc: 0.550 Test Loss: 2.134 Test Acc: 0.550
Validation loss decreased (inf --> -0.549979).  Saving model ...
Epoch: 2 cost time: 2.571347713470459
Epoch: 2, Steps: 35 | Train Loss: 1.926 Vali Loss: 3.407 Vali Acc: 0.500 Test Loss: 3.407 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6412835121154785
Epoch: 3, Steps: 35 | Train Loss: 4.309 Vali Loss: 8.457 Vali Acc: 0.500 Test Loss: 8.457 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.647672653198242
Epoch: 4, Steps: 35 | Train Loss: 4.886 Vali Loss: 4.799 Vali Acc: 0.490 Test Loss: 4.799 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7014832496643066
Epoch: 5, Steps: 35 | Train Loss: 4.113 Vali Loss: 9.483 Vali Acc: 0.480 Test Loss: 9.483 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9088265895843506
Epoch: 6, Steps: 35 | Train Loss: 3.773 Vali Loss: 4.927 Vali Acc: 0.530 Test Loss: 4.927 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6909842491149902
Epoch: 7, Steps: 35 | Train Loss: 4.050 Vali Loss: 12.255 Vali Acc: 0.510 Test Loss: 12.255 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.691087484359741
Epoch: 8, Steps: 35 | Train Loss: 4.078 Vali Loss: 5.572 Vali Acc: 0.540 Test Loss: 5.572 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7021615505218506
Epoch: 9, Steps: 35 | Train Loss: 4.061 Vali Loss: 7.613 Vali Acc: 0.430 Test Loss: 7.613 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.775960683822632
Epoch: 10, Steps: 35 | Train Loss: 3.825 Vali Loss: 23.152 Vali Acc: 0.490 Test Loss: 23.152 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7407898902893066
Epoch: 11, Steps: 35 | Train Loss: 5.898 Vali Loss: 10.836 Vali Acc: 0.480 Test Loss: 10.836 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 876306
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.457874536514282
Epoch: 1, Steps: 35 | Train Loss: 1.616 Vali Loss: 1.974 Vali Acc: 0.520 Test Loss: 1.974 Test Acc: 0.520
Validation loss decreased (inf --> -0.519980).  Saving model ...
Epoch: 2 cost time: 2.546588897705078
Epoch: 2, Steps: 35 | Train Loss: 1.637 Vali Loss: 5.022 Vali Acc: 0.500 Test Loss: 5.022 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.692295789718628
Epoch: 3, Steps: 35 | Train Loss: 2.484 Vali Loss: 4.035 Vali Acc: 0.490 Test Loss: 4.035 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.644681453704834
Epoch: 4, Steps: 35 | Train Loss: 4.582 Vali Loss: 5.445 Vali Acc: 0.460 Test Loss: 5.445 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.965381622314453
Epoch: 5, Steps: 35 | Train Loss: 2.804 Vali Loss: 5.924 Vali Acc: 0.460 Test Loss: 5.924 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7146620750427246
Epoch: 6, Steps: 35 | Train Loss: 4.646 Vali Loss: 7.291 Vali Acc: 0.490 Test Loss: 7.291 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.690126895904541
Epoch: 7, Steps: 35 | Train Loss: 4.208 Vali Loss: 10.011 Vali Acc: 0.520 Test Loss: 10.011 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5890562534332275
Epoch: 8, Steps: 35 | Train Loss: 3.525 Vali Loss: 4.600 Vali Acc: 0.530 Test Loss: 4.600 Test Acc: 0.530
Validation loss decreased (-0.519980 --> -0.529954).  Saving model ...
Epoch: 9 cost time: 2.6925551891326904
Epoch: 9, Steps: 35 | Train Loss: 4.316 Vali Loss: 6.124 Vali Acc: 0.530 Test Loss: 6.124 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.656707286834717
Epoch: 10, Steps: 35 | Train Loss: 3.513 Vali Loss: 10.039 Vali Acc: 0.540 Test Loss: 10.039 Test Acc: 0.540
Validation loss decreased (-0.529954 --> -0.539900).  Saving model ...
Epoch: 11 cost time: 2.800605535507202
Epoch: 11, Steps: 35 | Train Loss: 4.872 Vali Loss: 12.267 Vali Acc: 0.460 Test Loss: 12.267 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8437113761901855
Epoch: 12, Steps: 35 | Train Loss: 4.433 Vali Loss: 8.266 Vali Acc: 0.530 Test Loss: 8.266 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7433717250823975
Epoch: 13, Steps: 35 | Train Loss: 3.046 Vali Loss: 9.121 Vali Acc: 0.490 Test Loss: 9.121 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.509523391723633
Epoch: 14, Steps: 35 | Train Loss: 2.696 Vali Loss: 15.914 Vali Acc: 0.520 Test Loss: 15.914 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.517361640930176
Epoch: 15, Steps: 35 | Train Loss: 4.248 Vali Loss: 10.780 Vali Acc: 0.470 Test Loss: 10.780 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6091055870056152
Epoch: 16, Steps: 35 | Train Loss: 2.387 Vali Loss: 20.291 Vali Acc: 0.510 Test Loss: 20.291 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5774636268615723
Epoch: 17, Steps: 35 | Train Loss: 2.943 Vali Loss: 13.310 Vali Acc: 0.540 Test Loss: 13.310 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6484220027923584
Epoch: 18, Steps: 35 | Train Loss: 1.652 Vali Loss: 13.576 Vali Acc: 0.520 Test Loss: 13.576 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.034104108810425
Epoch: 19, Steps: 35 | Train Loss: 1.355 Vali Loss: 14.423 Vali Acc: 0.510 Test Loss: 14.423 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.692455768585205
Epoch: 20, Steps: 35 | Train Loss: 2.108 Vali Loss: 15.377 Vali Acc: 0.470 Test Loss: 15.377 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 876306
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.02321195602417
Epoch: 1, Steps: 35 | Train Loss: 1.930 Vali Loss: 1.589 Vali Acc: 0.590 Test Loss: 1.589 Test Acc: 0.590
Validation loss decreased (inf --> -0.589984).  Saving model ...
Epoch: 2 cost time: 3.0353269577026367
Epoch: 2, Steps: 35 | Train Loss: 2.628 Vali Loss: 4.802 Vali Acc: 0.520 Test Loss: 4.802 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.94523549079895
Epoch: 3, Steps: 35 | Train Loss: 4.105 Vali Loss: 11.028 Vali Acc: 0.510 Test Loss: 11.028 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.121063232421875
Epoch: 4, Steps: 35 | Train Loss: 4.008 Vali Loss: 6.400 Vali Acc: 0.570 Test Loss: 6.400 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.907456636428833
Epoch: 5, Steps: 35 | Train Loss: 5.776 Vali Loss: 9.104 Vali Acc: 0.400 Test Loss: 9.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7987308502197266
Epoch: 6, Steps: 35 | Train Loss: 5.521 Vali Loss: 13.799 Vali Acc: 0.510 Test Loss: 13.799 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9404642581939697
Epoch: 7, Steps: 35 | Train Loss: 4.104 Vali Loss: 10.558 Vali Acc: 0.500 Test Loss: 10.558 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9304776191711426
Epoch: 8, Steps: 35 | Train Loss: 5.787 Vali Loss: 10.817 Vali Acc: 0.430 Test Loss: 10.817 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.036071538925171
Epoch: 9, Steps: 35 | Train Loss: 1.888 Vali Loss: 11.092 Vali Acc: 0.510 Test Loss: 11.092 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1061174869537354
Epoch: 10, Steps: 35 | Train Loss: 2.653 Vali Loss: 10.838 Vali Acc: 0.460 Test Loss: 10.838 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.2888782024383545
Epoch: 11, Steps: 35 | Train Loss: 5.433 Vali Loss: 18.712 Vali Acc: 0.480 Test Loss: 18.712 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 859922
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.091169357299805
Epoch: 1, Steps: 35 | Train Loss: 1.788 Vali Loss: 1.713 Vali Acc: 0.620 Test Loss: 1.713 Test Acc: 0.620
Validation loss decreased (inf --> -0.619983).  Saving model ...
Epoch: 2 cost time: 3.1976709365844727
Epoch: 2, Steps: 35 | Train Loss: 3.228 Vali Loss: 4.314 Vali Acc: 0.530 Test Loss: 4.314 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0582079887390137
Epoch: 3, Steps: 35 | Train Loss: 2.532 Vali Loss: 3.751 Vali Acc: 0.470 Test Loss: 3.751 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.111994981765747
Epoch: 4, Steps: 35 | Train Loss: 3.224 Vali Loss: 4.055 Vali Acc: 0.490 Test Loss: 4.055 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.085465669631958
Epoch: 5, Steps: 35 | Train Loss: 5.048 Vali Loss: 4.080 Vali Acc: 0.520 Test Loss: 4.080 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.119081497192383
Epoch: 6, Steps: 35 | Train Loss: 6.693 Vali Loss: 6.991 Vali Acc: 0.490 Test Loss: 6.991 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.092226028442383
Epoch: 7, Steps: 35 | Train Loss: 3.650 Vali Loss: 11.436 Vali Acc: 0.510 Test Loss: 11.436 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2703399658203125
Epoch: 8, Steps: 35 | Train Loss: 3.182 Vali Loss: 23.996 Vali Acc: 0.470 Test Loss: 23.996 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1081697940826416
Epoch: 9, Steps: 35 | Train Loss: 4.232 Vali Loss: 14.406 Vali Acc: 0.520 Test Loss: 14.406 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.102116584777832
Epoch: 10, Steps: 35 | Train Loss: 2.321 Vali Loss: 9.230 Vali Acc: 0.460 Test Loss: 9.230 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.122715473175049
Epoch: 11, Steps: 35 | Train Loss: 3.257 Vali Loss: 9.271 Vali Acc: 0.490 Test Loss: 9.271 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 859922
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.765053987503052
Epoch: 1, Steps: 35 | Train Loss: 2.286 Vali Loss: 2.329 Vali Acc: 0.440 Test Loss: 2.329 Test Acc: 0.440
Validation loss decreased (inf --> -0.439977).  Saving model ...
Epoch: 2 cost time: 2.973909854888916
Epoch: 2, Steps: 35 | Train Loss: 2.494 Vali Loss: 4.545 Vali Acc: 0.510 Test Loss: 4.545 Test Acc: 0.510
Validation loss decreased (-0.439977 --> -0.509955).  Saving model ...
Epoch: 3 cost time: 2.7929954528808594
Epoch: 3, Steps: 35 | Train Loss: 2.781 Vali Loss: 5.195 Vali Acc: 0.530 Test Loss: 5.195 Test Acc: 0.530
Validation loss decreased (-0.509955 --> -0.529948).  Saving model ...
Epoch: 4 cost time: 2.787069082260132
Epoch: 4, Steps: 35 | Train Loss: 5.329 Vali Loss: 6.914 Vali Acc: 0.510 Test Loss: 6.914 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.912100315093994
Epoch: 5, Steps: 35 | Train Loss: 2.577 Vali Loss: 4.340 Vali Acc: 0.490 Test Loss: 4.340 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0171592235565186
Epoch: 6, Steps: 35 | Train Loss: 5.093 Vali Loss: 8.386 Vali Acc: 0.540 Test Loss: 8.386 Test Acc: 0.540
Validation loss decreased (-0.529948 --> -0.539916).  Saving model ...
Epoch: 7 cost time: 2.794203281402588
Epoch: 7, Steps: 35 | Train Loss: 3.746 Vali Loss: 19.155 Vali Acc: 0.490 Test Loss: 19.155 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.908994674682617
Epoch: 8, Steps: 35 | Train Loss: 2.516 Vali Loss: 9.812 Vali Acc: 0.500 Test Loss: 9.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.180046796798706
Epoch: 9, Steps: 35 | Train Loss: 4.267 Vali Loss: 21.716 Vali Acc: 0.450 Test Loss: 21.716 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9868967533111572
Epoch: 10, Steps: 35 | Train Loss: 3.659 Vali Loss: 12.035 Vali Acc: 0.470 Test Loss: 12.035 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0108096599578857
Epoch: 11, Steps: 35 | Train Loss: 2.559 Vali Loss: 17.448 Vali Acc: 0.470 Test Loss: 17.448 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.272489070892334
Epoch: 12, Steps: 35 | Train Loss: 2.551 Vali Loss: 11.667 Vali Acc: 0.480 Test Loss: 11.667 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0045957565307617
Epoch: 13, Steps: 35 | Train Loss: 3.327 Vali Loss: 15.441 Vali Acc: 0.440 Test Loss: 15.441 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.797764778137207
Epoch: 14, Steps: 35 | Train Loss: 2.879 Vali Loss: 12.357 Vali Acc: 0.430 Test Loss: 12.357 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5625901222229004
Epoch: 15, Steps: 35 | Train Loss: 3.946 Vali Loss: 14.368 Vali Acc: 0.510 Test Loss: 14.368 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.788031578063965
Epoch: 16, Steps: 35 | Train Loss: 2.207 Vali Loss: 18.318 Vali Acc: 0.450 Test Loss: 18.318 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 859922
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.262928485870361
Epoch: 1, Steps: 35 | Train Loss: 1.524 Vali Loss: 2.830 Vali Acc: 0.500 Test Loss: 2.830 Test Acc: 0.500
Validation loss decreased (inf --> -0.499972).  Saving model ...
Epoch: 2 cost time: 2.9056217670440674
Epoch: 2, Steps: 35 | Train Loss: 3.145 Vali Loss: 6.131 Vali Acc: 0.520 Test Loss: 6.131 Test Acc: 0.520
Validation loss decreased (-0.499972 --> -0.519939).  Saving model ...
Epoch: 3 cost time: 2.862922191619873
Epoch: 3, Steps: 35 | Train Loss: 2.735 Vali Loss: 5.277 Vali Acc: 0.470 Test Loss: 5.277 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.991518497467041
Epoch: 4, Steps: 35 | Train Loss: 4.689 Vali Loss: 2.927 Vali Acc: 0.580 Test Loss: 2.927 Test Acc: 0.580
Validation loss decreased (-0.519939 --> -0.579971).  Saving model ...
Epoch: 5 cost time: 2.724395751953125
Epoch: 5, Steps: 35 | Train Loss: 5.594 Vali Loss: 4.278 Vali Acc: 0.500 Test Loss: 4.278 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.767648935317993
Epoch: 6, Steps: 35 | Train Loss: 4.738 Vali Loss: 8.661 Vali Acc: 0.490 Test Loss: 8.661 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.687220573425293
Epoch: 7, Steps: 35 | Train Loss: 3.532 Vali Loss: 5.467 Vali Acc: 0.500 Test Loss: 5.467 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8366453647613525
Epoch: 8, Steps: 35 | Train Loss: 2.846 Vali Loss: 4.838 Vali Acc: 0.520 Test Loss: 4.838 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7597529888153076
Epoch: 9, Steps: 35 | Train Loss: 2.863 Vali Loss: 5.247 Vali Acc: 0.580 Test Loss: 5.247 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7307212352752686
Epoch: 10, Steps: 35 | Train Loss: 3.637 Vali Loss: 13.410 Vali Acc: 0.470 Test Loss: 13.410 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.651935338973999
Epoch: 11, Steps: 35 | Train Loss: 4.788 Vali Loss: 6.379 Vali Acc: 0.520 Test Loss: 6.379 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.443711757659912
Epoch: 12, Steps: 35 | Train Loss: 3.605 Vali Loss: 9.531 Vali Acc: 0.490 Test Loss: 9.531 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.523077964782715
Epoch: 13, Steps: 35 | Train Loss: 6.512 Vali Loss: 14.011 Vali Acc: 0.520 Test Loss: 14.011 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6752262115478516
Epoch: 14, Steps: 35 | Train Loss: 3.696 Vali Loss: 9.989 Vali Acc: 0.480 Test Loss: 9.989 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 859922
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.690977334976196
Epoch: 1, Steps: 35 | Train Loss: 1.217 Vali Loss: 2.327 Vali Acc: 0.530 Test Loss: 2.327 Test Acc: 0.530
Validation loss decreased (inf --> -0.529977).  Saving model ...
Epoch: 2 cost time: 2.6763906478881836
Epoch: 2, Steps: 35 | Train Loss: 1.523 Vali Loss: 1.291 Vali Acc: 0.580 Test Loss: 1.291 Test Acc: 0.580
Validation loss decreased (-0.529977 --> -0.579987).  Saving model ...
Epoch: 3 cost time: 2.7375919818878174
Epoch: 3, Steps: 35 | Train Loss: 1.474 Vali Loss: 2.861 Vali Acc: 0.510 Test Loss: 2.861 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5875673294067383
Epoch: 4, Steps: 35 | Train Loss: 1.808 Vali Loss: 5.235 Vali Acc: 0.480 Test Loss: 5.235 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5360796451568604
Epoch: 5, Steps: 35 | Train Loss: 1.929 Vali Loss: 2.462 Vali Acc: 0.630 Test Loss: 2.462 Test Acc: 0.630
Validation loss decreased (-0.579987 --> -0.629975).  Saving model ...
Epoch: 6 cost time: 2.7138640880584717
Epoch: 6, Steps: 35 | Train Loss: 1.940 Vali Loss: 2.498 Vali Acc: 0.570 Test Loss: 2.498 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.640103340148926
Epoch: 7, Steps: 35 | Train Loss: 1.140 Vali Loss: 5.148 Vali Acc: 0.510 Test Loss: 5.148 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6898844242095947
Epoch: 8, Steps: 35 | Train Loss: 0.908 Vali Loss: 4.875 Vali Acc: 0.520 Test Loss: 4.875 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7568271160125732
Epoch: 9, Steps: 35 | Train Loss: 1.795 Vali Loss: 9.630 Vali Acc: 0.490 Test Loss: 9.630 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7304039001464844
Epoch: 10, Steps: 35 | Train Loss: 1.582 Vali Loss: 6.203 Vali Acc: 0.530 Test Loss: 6.203 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.791712760925293
Epoch: 11, Steps: 35 | Train Loss: 1.761 Vali Loss: 2.777 Vali Acc: 0.550 Test Loss: 2.777 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1039130687713623
Epoch: 12, Steps: 35 | Train Loss: 2.836 Vali Loss: 3.667 Vali Acc: 0.520 Test Loss: 3.667 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8217263221740723
Epoch: 13, Steps: 35 | Train Loss: 1.450 Vali Loss: 8.574 Vali Acc: 0.490 Test Loss: 8.574 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.749399423599243
Epoch: 14, Steps: 35 | Train Loss: 2.286 Vali Loss: 4.657 Vali Acc: 0.520 Test Loss: 4.657 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.878657817840576
Epoch: 15, Steps: 35 | Train Loss: 2.191 Vali Loss: 4.336 Vali Acc: 0.520 Test Loss: 4.336 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 675858
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.380208492279053
Epoch: 1, Steps: 35 | Train Loss: 1.232 Vali Loss: 2.082 Vali Acc: 0.560 Test Loss: 2.082 Test Acc: 0.560
Validation loss decreased (inf --> -0.559979).  Saving model ...
Epoch: 2 cost time: 2.669624090194702
Epoch: 2, Steps: 35 | Train Loss: 1.785 Vali Loss: 1.551 Vali Acc: 0.600 Test Loss: 1.551 Test Acc: 0.600
Validation loss decreased (-0.559979 --> -0.599984).  Saving model ...
Epoch: 3 cost time: 2.5307512283325195
Epoch: 3, Steps: 35 | Train Loss: 1.857 Vali Loss: 3.095 Vali Acc: 0.480 Test Loss: 3.095 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0491015911102295
Epoch: 4, Steps: 35 | Train Loss: 1.749 Vali Loss: 1.768 Vali Acc: 0.530 Test Loss: 1.768 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2691218852996826
Epoch: 5, Steps: 35 | Train Loss: 1.360 Vali Loss: 4.344 Vali Acc: 0.500 Test Loss: 4.344 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8504526615142822
Epoch: 6, Steps: 35 | Train Loss: 2.980 Vali Loss: 2.080 Vali Acc: 0.420 Test Loss: 2.080 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7686681747436523
Epoch: 7, Steps: 35 | Train Loss: 2.146 Vali Loss: 3.380 Vali Acc: 0.540 Test Loss: 3.380 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8189146518707275
Epoch: 8, Steps: 35 | Train Loss: 1.927 Vali Loss: 5.037 Vali Acc: 0.490 Test Loss: 5.037 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.777338981628418
Epoch: 9, Steps: 35 | Train Loss: 1.814 Vali Loss: 10.054 Vali Acc: 0.470 Test Loss: 10.054 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.64990496635437
Epoch: 10, Steps: 35 | Train Loss: 1.883 Vali Loss: 6.568 Vali Acc: 0.520 Test Loss: 6.568 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0792226791381836
Epoch: 11, Steps: 35 | Train Loss: 3.650 Vali Loss: 9.934 Vali Acc: 0.490 Test Loss: 9.934 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8952057361602783
Epoch: 12, Steps: 35 | Train Loss: 1.181 Vali Loss: 4.452 Vali Acc: 0.620 Test Loss: 4.452 Test Acc: 0.620
Validation loss decreased (-0.599984 --> -0.619955).  Saving model ...
Epoch: 13 cost time: 2.7102324962615967
Epoch: 13, Steps: 35 | Train Loss: 1.565 Vali Loss: 6.487 Vali Acc: 0.490 Test Loss: 6.487 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5816586017608643
Epoch: 14, Steps: 35 | Train Loss: 0.737 Vali Loss: 4.690 Vali Acc: 0.550 Test Loss: 4.690 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7824268341064453
Epoch: 15, Steps: 35 | Train Loss: 1.491 Vali Loss: 9.737 Vali Acc: 0.440 Test Loss: 9.737 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7058427333831787
Epoch: 16, Steps: 35 | Train Loss: 1.776 Vali Loss: 6.486 Vali Acc: 0.570 Test Loss: 6.486 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6891772747039795
Epoch: 17, Steps: 35 | Train Loss: 1.366 Vali Loss: 6.952 Vali Acc: 0.460 Test Loss: 6.952 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.831122875213623
Epoch: 18, Steps: 35 | Train Loss: 1.916 Vali Loss: 20.962 Vali Acc: 0.490 Test Loss: 20.962 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0226807594299316
Epoch: 19, Steps: 35 | Train Loss: 1.289 Vali Loss: 9.173 Vali Acc: 0.420 Test Loss: 9.173 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.818814754486084
Epoch: 20, Steps: 35 | Train Loss: 2.925 Vali Loss: 11.700 Vali Acc: 0.450 Test Loss: 11.700 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6580305099487305
Epoch: 21, Steps: 35 | Train Loss: 1.480 Vali Loss: 9.262 Vali Acc: 0.450 Test Loss: 9.262 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6526124477386475
Epoch: 22, Steps: 35 | Train Loss: 2.874 Vali Loss: 11.242 Vali Acc: 0.520 Test Loss: 11.242 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 675858
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.580868244171143
Epoch: 1, Steps: 35 | Train Loss: 1.132 Vali Loss: 2.730 Vali Acc: 0.490 Test Loss: 2.730 Test Acc: 0.490
Validation loss decreased (inf --> -0.489973).  Saving model ...
Epoch: 2 cost time: 2.639970302581787
Epoch: 2, Steps: 35 | Train Loss: 1.421 Vali Loss: 1.781 Vali Acc: 0.470 Test Loss: 1.781 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4779465198516846
Epoch: 3, Steps: 35 | Train Loss: 2.095 Vali Loss: 4.733 Vali Acc: 0.440 Test Loss: 4.733 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.64682674407959
Epoch: 4, Steps: 35 | Train Loss: 2.046 Vali Loss: 4.342 Vali Acc: 0.460 Test Loss: 4.342 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7358198165893555
Epoch: 5, Steps: 35 | Train Loss: 2.190 Vali Loss: 2.637 Vali Acc: 0.540 Test Loss: 2.637 Test Acc: 0.540
Validation loss decreased (-0.489973 --> -0.539974).  Saving model ...
Epoch: 6 cost time: 2.6217000484466553
Epoch: 6, Steps: 35 | Train Loss: 1.998 Vali Loss: 7.264 Vali Acc: 0.500 Test Loss: 7.264 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7145321369171143
Epoch: 7, Steps: 35 | Train Loss: 1.300 Vali Loss: 4.497 Vali Acc: 0.510 Test Loss: 4.497 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8178465366363525
Epoch: 8, Steps: 35 | Train Loss: 1.995 Vali Loss: 3.846 Vali Acc: 0.520 Test Loss: 3.846 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8356618881225586
Epoch: 9, Steps: 35 | Train Loss: 2.008 Vali Loss: 13.562 Vali Acc: 0.500 Test Loss: 13.562 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.896198034286499
Epoch: 10, Steps: 35 | Train Loss: 2.425 Vali Loss: 5.891 Vali Acc: 0.510 Test Loss: 5.891 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5579631328582764
Epoch: 11, Steps: 35 | Train Loss: 1.816 Vali Loss: 4.338 Vali Acc: 0.540 Test Loss: 4.338 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.662363052368164
Epoch: 12, Steps: 35 | Train Loss: 1.876 Vali Loss: 5.977 Vali Acc: 0.470 Test Loss: 5.977 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6736032962799072
Epoch: 13, Steps: 35 | Train Loss: 1.766 Vali Loss: 6.707 Vali Acc: 0.500 Test Loss: 6.707 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.422030210494995
Epoch: 14, Steps: 35 | Train Loss: 1.537 Vali Loss: 11.307 Vali Acc: 0.470 Test Loss: 11.307 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.375373125076294
Epoch: 15, Steps: 35 | Train Loss: 2.069 Vali Loss: 10.751 Vali Acc: 0.520 Test Loss: 10.751 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 675858
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.478638648986816
Epoch: 1, Steps: 35 | Train Loss: 1.006 Vali Loss: 2.087 Vali Acc: 0.520 Test Loss: 2.087 Test Acc: 0.520
Validation loss decreased (inf --> -0.519979).  Saving model ...
Epoch: 2 cost time: 2.3820884227752686
Epoch: 2, Steps: 35 | Train Loss: 1.344 Vali Loss: 1.671 Vali Acc: 0.540 Test Loss: 1.671 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539983).  Saving model ...
Epoch: 3 cost time: 2.29325795173645
Epoch: 3, Steps: 35 | Train Loss: 2.081 Vali Loss: 3.374 Vali Acc: 0.620 Test Loss: 3.374 Test Acc: 0.620
Validation loss decreased (-0.539983 --> -0.619966).  Saving model ...
Epoch: 4 cost time: 2.3869364261627197
Epoch: 4, Steps: 35 | Train Loss: 2.102 Vali Loss: 2.744 Vali Acc: 0.540 Test Loss: 2.744 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2745361328125
Epoch: 5, Steps: 35 | Train Loss: 1.304 Vali Loss: 2.832 Vali Acc: 0.470 Test Loss: 2.832 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.516270399093628
Epoch: 6, Steps: 35 | Train Loss: 2.594 Vali Loss: 4.115 Vali Acc: 0.500 Test Loss: 4.115 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6966500282287598
Epoch: 7, Steps: 35 | Train Loss: 2.730 Vali Loss: 4.102 Vali Acc: 0.520 Test Loss: 4.102 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.607708692550659
Epoch: 8, Steps: 35 | Train Loss: 1.816 Vali Loss: 3.439 Vali Acc: 0.510 Test Loss: 3.439 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5556769371032715
Epoch: 9, Steps: 35 | Train Loss: 1.763 Vali Loss: 5.337 Vali Acc: 0.510 Test Loss: 5.337 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.419808864593506
Epoch: 10, Steps: 35 | Train Loss: 2.441 Vali Loss: 7.599 Vali Acc: 0.470 Test Loss: 7.599 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6553397178649902
Epoch: 11, Steps: 35 | Train Loss: 1.666 Vali Loss: 6.402 Vali Acc: 0.470 Test Loss: 6.402 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.524521827697754
Epoch: 12, Steps: 35 | Train Loss: 2.210 Vali Loss: 4.078 Vali Acc: 0.530 Test Loss: 4.078 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6338634490966797
Epoch: 13, Steps: 35 | Train Loss: 1.511 Vali Loss: 8.797 Vali Acc: 0.510 Test Loss: 8.797 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 675858
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.155934572219849
Epoch: 1, Steps: 35 | Train Loss: 1.572 Vali Loss: 2.506 Vali Acc: 0.590 Test Loss: 2.506 Test Acc: 0.590
Validation loss decreased (inf --> -0.589975).  Saving model ...
Epoch: 2 cost time: 2.7769975662231445
Epoch: 2, Steps: 35 | Train Loss: 1.755 Vali Loss: 1.483 Vali Acc: 0.540 Test Loss: 1.483 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.303345203399658
Epoch: 3, Steps: 35 | Train Loss: 1.993 Vali Loss: 3.357 Vali Acc: 0.460 Test Loss: 3.357 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7911767959594727
Epoch: 4, Steps: 35 | Train Loss: 2.620 Vali Loss: 3.199 Vali Acc: 0.480 Test Loss: 3.199 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.898254156112671
Epoch: 5, Steps: 35 | Train Loss: 1.749 Vali Loss: 7.350 Vali Acc: 0.510 Test Loss: 7.350 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.951960563659668
Epoch: 6, Steps: 35 | Train Loss: 2.473 Vali Loss: 1.911 Vali Acc: 0.530 Test Loss: 1.911 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7614638805389404
Epoch: 7, Steps: 35 | Train Loss: 1.797 Vali Loss: 6.364 Vali Acc: 0.450 Test Loss: 6.364 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7636003494262695
Epoch: 8, Steps: 35 | Train Loss: 1.431 Vali Loss: 4.981 Vali Acc: 0.530 Test Loss: 4.981 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7680327892303467
Epoch: 9, Steps: 35 | Train Loss: 2.698 Vali Loss: 5.653 Vali Acc: 0.540 Test Loss: 5.653 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5639889240264893
Epoch: 10, Steps: 35 | Train Loss: 2.205 Vali Loss: 6.017 Vali Acc: 0.470 Test Loss: 6.017 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.678657293319702
Epoch: 11, Steps: 35 | Train Loss: 3.507 Vali Loss: 8.873 Vali Acc: 0.470 Test Loss: 8.873 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 544786
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.301604747772217
Epoch: 1, Steps: 35 | Train Loss: 1.433 Vali Loss: 2.286 Vali Acc: 0.580 Test Loss: 2.286 Test Acc: 0.580
Validation loss decreased (inf --> -0.579977).  Saving model ...
Epoch: 2 cost time: 2.4446702003479004
Epoch: 2, Steps: 35 | Train Loss: 1.722 Vali Loss: 2.226 Vali Acc: 0.460 Test Loss: 2.226 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4229791164398193
Epoch: 3, Steps: 35 | Train Loss: 2.171 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.679171323776245
Epoch: 4, Steps: 35 | Train Loss: 2.390 Vali Loss: 4.259 Vali Acc: 0.480 Test Loss: 4.259 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5947208404541016
Epoch: 5, Steps: 35 | Train Loss: 2.114 Vali Loss: 5.134 Vali Acc: 0.480 Test Loss: 5.134 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5655953884124756
Epoch: 6, Steps: 35 | Train Loss: 1.958 Vali Loss: 5.114 Vali Acc: 0.470 Test Loss: 5.114 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5692431926727295
Epoch: 7, Steps: 35 | Train Loss: 1.971 Vali Loss: 6.992 Vali Acc: 0.500 Test Loss: 6.992 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9004569053649902
Epoch: 8, Steps: 35 | Train Loss: 1.520 Vali Loss: 3.249 Vali Acc: 0.550 Test Loss: 3.249 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.678030490875244
Epoch: 9, Steps: 35 | Train Loss: 2.305 Vali Loss: 14.141 Vali Acc: 0.500 Test Loss: 14.141 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6069812774658203
Epoch: 10, Steps: 35 | Train Loss: 2.668 Vali Loss: 4.761 Vali Acc: 0.530 Test Loss: 4.761 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9880456924438477
Epoch: 11, Steps: 35 | Train Loss: 2.928 Vali Loss: 5.548 Vali Acc: 0.550 Test Loss: 5.548 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 544786
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.167770862579346
Epoch: 1, Steps: 35 | Train Loss: 1.295 Vali Loss: 1.537 Vali Acc: 0.550 Test Loss: 1.537 Test Acc: 0.550
Validation loss decreased (inf --> -0.549985).  Saving model ...
Epoch: 2 cost time: 2.5953121185302734
Epoch: 2, Steps: 35 | Train Loss: 1.472 Vali Loss: 3.167 Vali Acc: 0.470 Test Loss: 3.167 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4434404373168945
Epoch: 3, Steps: 35 | Train Loss: 2.091 Vali Loss: 2.787 Vali Acc: 0.420 Test Loss: 2.787 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.326124906539917
Epoch: 4, Steps: 35 | Train Loss: 2.910 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.422116279602051
Epoch: 5, Steps: 35 | Train Loss: 1.563 Vali Loss: 1.755 Vali Acc: 0.520 Test Loss: 1.755 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4682564735412598
Epoch: 6, Steps: 35 | Train Loss: 2.580 Vali Loss: 4.140 Vali Acc: 0.550 Test Loss: 4.140 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5217230319976807
Epoch: 7, Steps: 35 | Train Loss: 2.152 Vali Loss: 4.716 Vali Acc: 0.460 Test Loss: 4.716 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5033910274505615
Epoch: 8, Steps: 35 | Train Loss: 2.475 Vali Loss: 3.212 Vali Acc: 0.510 Test Loss: 3.212 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6929314136505127
Epoch: 9, Steps: 35 | Train Loss: 1.252 Vali Loss: 8.007 Vali Acc: 0.510 Test Loss: 8.007 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6039376258850098
Epoch: 10, Steps: 35 | Train Loss: 2.742 Vali Loss: 3.511 Vali Acc: 0.580 Test Loss: 3.511 Test Acc: 0.580
Validation loss decreased (-0.549985 --> -0.579965).  Saving model ...
Epoch: 11 cost time: 2.300184965133667
Epoch: 11, Steps: 35 | Train Loss: 3.001 Vali Loss: 4.752 Vali Acc: 0.490 Test Loss: 4.752 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.268278121948242
Epoch: 12, Steps: 35 | Train Loss: 3.645 Vali Loss: 17.772 Vali Acc: 0.500 Test Loss: 17.772 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.151123046875
Epoch: 13, Steps: 35 | Train Loss: 3.019 Vali Loss: 7.051 Vali Acc: 0.520 Test Loss: 7.051 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4483628273010254
Epoch: 14, Steps: 35 | Train Loss: 1.484 Vali Loss: 6.153 Vali Acc: 0.450 Test Loss: 6.153 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5288522243499756
Epoch: 15, Steps: 35 | Train Loss: 1.684 Vali Loss: 10.572 Vali Acc: 0.460 Test Loss: 10.572 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8041532039642334
Epoch: 16, Steps: 35 | Train Loss: 3.814 Vali Loss: 10.395 Vali Acc: 0.510 Test Loss: 10.395 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8549702167510986
Epoch: 17, Steps: 35 | Train Loss: 2.172 Vali Loss: 10.885 Vali Acc: 0.500 Test Loss: 10.885 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7847037315368652
Epoch: 18, Steps: 35 | Train Loss: 1.223 Vali Loss: 11.266 Vali Acc: 0.500 Test Loss: 11.266 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7372539043426514
Epoch: 19, Steps: 35 | Train Loss: 1.571 Vali Loss: 9.351 Vali Acc: 0.520 Test Loss: 9.351 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5521016120910645
Epoch: 20, Steps: 35 | Train Loss: 2.279 Vali Loss: 10.522 Vali Acc: 0.470 Test Loss: 10.522 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 544786
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.940648078918457
Epoch: 1, Steps: 35 | Train Loss: 1.207 Vali Loss: 1.352 Vali Acc: 0.490 Test Loss: 1.352 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 2.1532371044158936
Epoch: 2, Steps: 35 | Train Loss: 1.486 Vali Loss: 1.996 Vali Acc: 0.420 Test Loss: 1.996 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1967756748199463
Epoch: 3, Steps: 35 | Train Loss: 2.253 Vali Loss: 2.347 Vali Acc: 0.480 Test Loss: 2.347 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1250805854797363
Epoch: 4, Steps: 35 | Train Loss: 1.752 Vali Loss: 3.240 Vali Acc: 0.480 Test Loss: 3.240 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2328591346740723
Epoch: 5, Steps: 35 | Train Loss: 1.301 Vali Loss: 5.757 Vali Acc: 0.520 Test Loss: 5.757 Test Acc: 0.520
Validation loss decreased (-0.489986 --> -0.519942).  Saving model ...
Epoch: 6 cost time: 2.407811164855957
Epoch: 6, Steps: 35 | Train Loss: 1.709 Vali Loss: 3.444 Vali Acc: 0.410 Test Loss: 3.444 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.196540594100952
Epoch: 7, Steps: 35 | Train Loss: 2.016 Vali Loss: 6.016 Vali Acc: 0.490 Test Loss: 6.016 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2423315048217773
Epoch: 8, Steps: 35 | Train Loss: 1.917 Vali Loss: 5.338 Vali Acc: 0.460 Test Loss: 5.338 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3072168827056885
Epoch: 9, Steps: 35 | Train Loss: 2.809 Vali Loss: 4.608 Vali Acc: 0.540 Test Loss: 4.608 Test Acc: 0.540
Validation loss decreased (-0.519942 --> -0.539954).  Saving model ...
Epoch: 10 cost time: 2.434119701385498
Epoch: 10, Steps: 35 | Train Loss: 2.060 Vali Loss: 3.583 Vali Acc: 0.530 Test Loss: 3.583 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4512572288513184
Epoch: 11, Steps: 35 | Train Loss: 1.687 Vali Loss: 7.798 Vali Acc: 0.510 Test Loss: 7.798 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3387022018432617
Epoch: 12, Steps: 35 | Train Loss: 1.919 Vali Loss: 4.428 Vali Acc: 0.530 Test Loss: 4.428 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3428378105163574
Epoch: 13, Steps: 35 | Train Loss: 1.665 Vali Loss: 7.856 Vali Acc: 0.520 Test Loss: 7.856 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3499794006347656
Epoch: 14, Steps: 35 | Train Loss: 1.815 Vali Loss: 5.398 Vali Acc: 0.450 Test Loss: 5.398 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2239067554473877
Epoch: 15, Steps: 35 | Train Loss: 1.297 Vali Loss: 6.245 Vali Acc: 0.530 Test Loss: 6.245 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.117659568786621
Epoch: 16, Steps: 35 | Train Loss: 2.156 Vali Loss: 5.066 Vali Acc: 0.530 Test Loss: 5.066 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1244988441467285
Epoch: 17, Steps: 35 | Train Loss: 2.303 Vali Loss: 8.099 Vali Acc: 0.550 Test Loss: 8.099 Test Acc: 0.550
Validation loss decreased (-0.539954 --> -0.549919).  Saving model ...
Epoch: 18 cost time: 2.2532613277435303
Epoch: 18, Steps: 35 | Train Loss: 2.397 Vali Loss: 7.170 Vali Acc: 0.540 Test Loss: 7.170 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.142861843109131
Epoch: 19, Steps: 35 | Train Loss: 2.225 Vali Loss: 5.841 Vali Acc: 0.540 Test Loss: 5.841 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2940638065338135
Epoch: 20, Steps: 35 | Train Loss: 1.428 Vali Loss: 6.458 Vali Acc: 0.510 Test Loss: 6.458 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.285616636276245
Epoch: 21, Steps: 35 | Train Loss: 1.535 Vali Loss: 5.212 Vali Acc: 0.550 Test Loss: 5.212 Test Acc: 0.550
Validation loss decreased (-0.549919 --> -0.549948).  Saving model ...
Epoch: 22 cost time: 2.4645943641662598
Epoch: 22, Steps: 35 | Train Loss: 3.731 Vali Loss: 8.296 Vali Acc: 0.490 Test Loss: 8.296 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2249021530151367
Epoch: 23, Steps: 35 | Train Loss: 1.581 Vali Loss: 7.960 Vali Acc: 0.500 Test Loss: 7.960 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3026838302612305
Epoch: 24, Steps: 35 | Train Loss: 2.451 Vali Loss: 9.381 Vali Acc: 0.480 Test Loss: 9.381 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2211811542510986
Epoch: 25, Steps: 35 | Train Loss: 1.042 Vali Loss: 6.060 Vali Acc: 0.560 Test Loss: 6.060 Test Acc: 0.560
Validation loss decreased (-0.549948 --> -0.559939).  Saving model ...
Epoch: 26 cost time: 2.212778091430664
Epoch: 26, Steps: 35 | Train Loss: 2.537 Vali Loss: 8.616 Vali Acc: 0.500 Test Loss: 8.616 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2551844120025635
Epoch: 27, Steps: 35 | Train Loss: 1.900 Vali Loss: 7.272 Vali Acc: 0.510 Test Loss: 7.272 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5364468097686768
Epoch: 28, Steps: 35 | Train Loss: 3.014 Vali Loss: 8.941 Vali Acc: 0.560 Test Loss: 8.941 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6345863342285156
Epoch: 29, Steps: 35 | Train Loss: 1.873 Vali Loss: 7.452 Vali Acc: 0.460 Test Loss: 7.452 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1957459449768066
Epoch: 30, Steps: 35 | Train Loss: 1.531 Vali Loss: 7.329 Vali Acc: 0.490 Test Loss: 7.329 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.299558401107788
Epoch: 31, Steps: 35 | Train Loss: 2.108 Vali Loss: 17.225 Vali Acc: 0.480 Test Loss: 17.225 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3842074871063232
Epoch: 32, Steps: 35 | Train Loss: 2.416 Vali Loss: 11.498 Vali Acc: 0.460 Test Loss: 11.498 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4213624000549316
Epoch: 33, Steps: 35 | Train Loss: 1.173 Vali Loss: 13.130 Vali Acc: 0.510 Test Loss: 13.130 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.460284471511841
Epoch: 34, Steps: 35 | Train Loss: 1.721 Vali Loss: 8.885 Vali Acc: 0.530 Test Loss: 8.885 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.551157236099243
Epoch: 35, Steps: 35 | Train Loss: 0.971 Vali Loss: 9.527 Vali Acc: 0.530 Test Loss: 9.527 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 544786
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.112274646759033
Epoch: 1, Steps: 35 | Train Loss: 1.197 Vali Loss: 2.157 Vali Acc: 0.510 Test Loss: 2.157 Test Acc: 0.510
Validation loss decreased (inf --> -0.509978).  Saving model ...
Epoch: 2 cost time: 2.6384832859039307
Epoch: 2, Steps: 35 | Train Loss: 1.880 Vali Loss: 2.649 Vali Acc: 0.500 Test Loss: 2.649 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4482386112213135
Epoch: 3, Steps: 35 | Train Loss: 2.402 Vali Loss: 5.323 Vali Acc: 0.470 Test Loss: 5.323 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4929168224334717
Epoch: 4, Steps: 35 | Train Loss: 2.037 Vali Loss: 5.543 Vali Acc: 0.500 Test Loss: 5.543 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.405209541320801
Epoch: 5, Steps: 35 | Train Loss: 2.049 Vali Loss: 4.521 Vali Acc: 0.500 Test Loss: 4.521 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4265191555023193
Epoch: 6, Steps: 35 | Train Loss: 2.045 Vali Loss: 11.448 Vali Acc: 0.470 Test Loss: 11.448 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.623108386993408
Epoch: 7, Steps: 35 | Train Loss: 2.168 Vali Loss: 2.526 Vali Acc: 0.570 Test Loss: 2.526 Test Acc: 0.570
Validation loss decreased (-0.509978 --> -0.569975).  Saving model ...
Epoch: 8 cost time: 2.6060450077056885
Epoch: 8, Steps: 35 | Train Loss: 1.721 Vali Loss: 4.545 Vali Acc: 0.460 Test Loss: 4.545 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6652543544769287
Epoch: 9, Steps: 35 | Train Loss: 1.642 Vali Loss: 2.550 Vali Acc: 0.490 Test Loss: 2.550 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.799901008605957
Epoch: 10, Steps: 35 | Train Loss: 0.893 Vali Loss: 8.753 Vali Acc: 0.510 Test Loss: 8.753 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.553178071975708
Epoch: 11, Steps: 35 | Train Loss: 1.263 Vali Loss: 5.349 Vali Acc: 0.460 Test Loss: 5.349 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.651944637298584
Epoch: 12, Steps: 35 | Train Loss: 1.848 Vali Loss: 6.314 Vali Acc: 0.520 Test Loss: 6.314 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6712656021118164
Epoch: 13, Steps: 35 | Train Loss: 2.007 Vali Loss: 7.019 Vali Acc: 0.480 Test Loss: 7.019 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6129064559936523
Epoch: 14, Steps: 35 | Train Loss: 1.296 Vali Loss: 7.267 Vali Acc: 0.470 Test Loss: 7.267 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5435433387756348
Epoch: 15, Steps: 35 | Train Loss: 1.845 Vali Loss: 5.382 Vali Acc: 0.520 Test Loss: 5.382 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5138893127441406
Epoch: 16, Steps: 35 | Train Loss: 0.344 Vali Loss: 6.183 Vali Acc: 0.500 Test Loss: 6.183 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5895285606384277
Epoch: 17, Steps: 35 | Train Loss: 1.660 Vali Loss: 8.402 Vali Acc: 0.470 Test Loss: 8.402 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 479250
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.347632884979248
Epoch: 1, Steps: 35 | Train Loss: 1.155 Vali Loss: 1.396 Vali Acc: 0.500 Test Loss: 1.396 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 2.4332334995269775
Epoch: 2, Steps: 35 | Train Loss: 2.380 Vali Loss: 2.330 Vali Acc: 0.490 Test Loss: 2.330 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3546066284179688
Epoch: 3, Steps: 35 | Train Loss: 1.995 Vali Loss: 2.423 Vali Acc: 0.490 Test Loss: 2.423 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.545743465423584
Epoch: 4, Steps: 35 | Train Loss: 2.031 Vali Loss: 1.808 Vali Acc: 0.540 Test Loss: 1.808 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539982).  Saving model ...
Epoch: 5 cost time: 2.5492894649505615
Epoch: 5, Steps: 35 | Train Loss: 1.464 Vali Loss: 3.276 Vali Acc: 0.520 Test Loss: 3.276 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3107473850250244
Epoch: 6, Steps: 35 | Train Loss: 2.094 Vali Loss: 4.066 Vali Acc: 0.460 Test Loss: 4.066 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3738362789154053
Epoch: 7, Steps: 35 | Train Loss: 2.055 Vali Loss: 3.102 Vali Acc: 0.590 Test Loss: 3.102 Test Acc: 0.590
Validation loss decreased (-0.539982 --> -0.589969).  Saving model ...
Epoch: 8 cost time: 2.3576016426086426
Epoch: 8, Steps: 35 | Train Loss: 2.041 Vali Loss: 5.841 Vali Acc: 0.470 Test Loss: 5.841 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.371377468109131
Epoch: 9, Steps: 35 | Train Loss: 2.004 Vali Loss: 6.024 Vali Acc: 0.490 Test Loss: 6.024 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3211185932159424
Epoch: 10, Steps: 35 | Train Loss: 2.932 Vali Loss: 6.079 Vali Acc: 0.520 Test Loss: 6.079 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.607086658477783
Epoch: 11, Steps: 35 | Train Loss: 1.366 Vali Loss: 7.124 Vali Acc: 0.530 Test Loss: 7.124 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2689692974090576
Epoch: 12, Steps: 35 | Train Loss: 1.272 Vali Loss: 11.448 Vali Acc: 0.470 Test Loss: 11.448 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.274627447128296
Epoch: 13, Steps: 35 | Train Loss: 1.649 Vali Loss: 6.424 Vali Acc: 0.530 Test Loss: 6.424 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5681471824645996
Epoch: 14, Steps: 35 | Train Loss: 2.235 Vali Loss: 6.731 Vali Acc: 0.510 Test Loss: 6.731 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6818830966949463
Epoch: 15, Steps: 35 | Train Loss: 1.200 Vali Loss: 12.024 Vali Acc: 0.510 Test Loss: 12.024 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4562301635742188
Epoch: 16, Steps: 35 | Train Loss: 1.339 Vali Loss: 5.209 Vali Acc: 0.560 Test Loss: 5.209 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.53824782371521
Epoch: 17, Steps: 35 | Train Loss: 1.415 Vali Loss: 18.601 Vali Acc: 0.470 Test Loss: 18.601 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 479250
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.262181520462036
Epoch: 1, Steps: 35 | Train Loss: 1.189 Vali Loss: 1.434 Vali Acc: 0.530 Test Loss: 1.434 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 2.320040464401245
Epoch: 2, Steps: 35 | Train Loss: 2.290 Vali Loss: 2.883 Vali Acc: 0.490 Test Loss: 2.883 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.222935914993286
Epoch: 3, Steps: 35 | Train Loss: 2.195 Vali Loss: 3.254 Vali Acc: 0.480 Test Loss: 3.254 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.313295841217041
Epoch: 4, Steps: 35 | Train Loss: 2.670 Vali Loss: 2.486 Vali Acc: 0.550 Test Loss: 2.486 Test Acc: 0.550
Validation loss decreased (-0.529986 --> -0.549975).  Saving model ...
Epoch: 5 cost time: 2.3557467460632324
Epoch: 5, Steps: 35 | Train Loss: 1.365 Vali Loss: 5.754 Vali Acc: 0.510 Test Loss: 5.754 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.295184373855591
Epoch: 6, Steps: 35 | Train Loss: 1.939 Vali Loss: 3.253 Vali Acc: 0.550 Test Loss: 3.253 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.445155382156372
Epoch: 7, Steps: 35 | Train Loss: 2.279 Vali Loss: 4.660 Vali Acc: 0.500 Test Loss: 4.660 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4534225463867188
Epoch: 8, Steps: 35 | Train Loss: 3.461 Vali Loss: 6.115 Vali Acc: 0.470 Test Loss: 6.115 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3904497623443604
Epoch: 9, Steps: 35 | Train Loss: 2.187 Vali Loss: 4.890 Vali Acc: 0.500 Test Loss: 4.890 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4046413898468018
Epoch: 10, Steps: 35 | Train Loss: 4.192 Vali Loss: 9.817 Vali Acc: 0.490 Test Loss: 9.817 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.382291078567505
Epoch: 11, Steps: 35 | Train Loss: 1.976 Vali Loss: 8.626 Vali Acc: 0.530 Test Loss: 8.626 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.26847505569458
Epoch: 12, Steps: 35 | Train Loss: 1.671 Vali Loss: 16.417 Vali Acc: 0.490 Test Loss: 16.417 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4150681495666504
Epoch: 13, Steps: 35 | Train Loss: 2.885 Vali Loss: 11.649 Vali Acc: 0.500 Test Loss: 11.649 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.493955373764038
Epoch: 14, Steps: 35 | Train Loss: 2.325 Vali Loss: 7.332 Vali Acc: 0.450 Test Loss: 7.332 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 479250
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.346909523010254
Epoch: 1, Steps: 35 | Train Loss: 1.133 Vali Loss: 1.520 Vali Acc: 0.530 Test Loss: 1.520 Test Acc: 0.530
Validation loss decreased (inf --> -0.529985).  Saving model ...
Epoch: 2 cost time: 2.3138861656188965
Epoch: 2, Steps: 35 | Train Loss: 1.676 Vali Loss: 1.622 Vali Acc: 0.520 Test Loss: 1.622 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.243727922439575
Epoch: 3, Steps: 35 | Train Loss: 2.053 Vali Loss: 3.971 Vali Acc: 0.430 Test Loss: 3.971 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3045852184295654
Epoch: 4, Steps: 35 | Train Loss: 2.441 Vali Loss: 2.256 Vali Acc: 0.490 Test Loss: 2.256 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3780064582824707
Epoch: 5, Steps: 35 | Train Loss: 1.955 Vali Loss: 6.167 Vali Acc: 0.510 Test Loss: 6.167 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4672634601593018
Epoch: 6, Steps: 35 | Train Loss: 1.592 Vali Loss: 3.710 Vali Acc: 0.550 Test Loss: 3.710 Test Acc: 0.550
Validation loss decreased (-0.529985 --> -0.549963).  Saving model ...
Epoch: 7 cost time: 2.2737178802490234
Epoch: 7, Steps: 35 | Train Loss: 1.516 Vali Loss: 5.113 Vali Acc: 0.480 Test Loss: 5.113 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.441509962081909
Epoch: 8, Steps: 35 | Train Loss: 3.324 Vali Loss: 4.965 Vali Acc: 0.490 Test Loss: 4.965 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2527430057525635
Epoch: 9, Steps: 35 | Train Loss: 2.400 Vali Loss: 7.233 Vali Acc: 0.480 Test Loss: 7.233 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.026026964187622
Epoch: 10, Steps: 35 | Train Loss: 1.577 Vali Loss: 5.729 Vali Acc: 0.480 Test Loss: 5.729 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1268458366394043
Epoch: 11, Steps: 35 | Train Loss: 1.312 Vali Loss: 6.157 Vali Acc: 0.490 Test Loss: 6.157 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1176247596740723
Epoch: 12, Steps: 35 | Train Loss: 1.418 Vali Loss: 8.243 Vali Acc: 0.480 Test Loss: 8.243 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1386826038360596
Epoch: 13, Steps: 35 | Train Loss: 1.460 Vali Loss: 6.853 Vali Acc: 0.470 Test Loss: 6.853 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4571027755737305
Epoch: 14, Steps: 35 | Train Loss: 2.099 Vali Loss: 8.269 Vali Acc: 0.480 Test Loss: 8.269 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.30025053024292
Epoch: 15, Steps: 35 | Train Loss: 1.885 Vali Loss: 5.060 Vali Acc: 0.530 Test Loss: 5.060 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6609840393066406
Epoch: 16, Steps: 35 | Train Loss: 2.559 Vali Loss: 4.789 Vali Acc: 0.530 Test Loss: 4.789 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 479250
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.255258083343506
Epoch: 1, Steps: 35 | Train Loss: 1.087 Vali Loss: 2.827 Vali Acc: 0.450 Test Loss: 2.827 Test Acc: 0.450
Validation loss decreased (inf --> -0.449972).  Saving model ...
Epoch: 2 cost time: 2.4769325256347656
Epoch: 2, Steps: 35 | Train Loss: 2.052 Vali Loss: 2.108 Vali Acc: 0.470 Test Loss: 2.108 Test Acc: 0.470
Validation loss decreased (-0.449972 --> -0.469979).  Saving model ...
Epoch: 3 cost time: 2.327493667602539
Epoch: 3, Steps: 35 | Train Loss: 1.959 Vali Loss: 2.125 Vali Acc: 0.510 Test Loss: 2.125 Test Acc: 0.510
Validation loss decreased (-0.469979 --> -0.509979).  Saving model ...
Epoch: 4 cost time: 2.371102809906006
Epoch: 4, Steps: 35 | Train Loss: 1.617 Vali Loss: 5.945 Vali Acc: 0.510 Test Loss: 5.945 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5462591648101807
Epoch: 5, Steps: 35 | Train Loss: 3.077 Vali Loss: 3.685 Vali Acc: 0.540 Test Loss: 3.685 Test Acc: 0.540
Validation loss decreased (-0.509979 --> -0.539963).  Saving model ...
Epoch: 6 cost time: 2.506221294403076
Epoch: 6, Steps: 35 | Train Loss: 2.512 Vali Loss: 3.623 Vali Acc: 0.540 Test Loss: 3.623 Test Acc: 0.540
Validation loss decreased (-0.539963 --> -0.539964).  Saving model ...
Epoch: 7 cost time: 2.380342960357666
Epoch: 7, Steps: 35 | Train Loss: 1.745 Vali Loss: 2.110 Vali Acc: 0.470 Test Loss: 2.110 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4205222129821777
Epoch: 8, Steps: 35 | Train Loss: 1.435 Vali Loss: 3.162 Vali Acc: 0.480 Test Loss: 3.162 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.501767635345459
Epoch: 9, Steps: 35 | Train Loss: 1.830 Vali Loss: 4.029 Vali Acc: 0.490 Test Loss: 4.029 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5731871128082275
Epoch: 10, Steps: 35 | Train Loss: 1.306 Vali Loss: 3.371 Vali Acc: 0.520 Test Loss: 3.371 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.38379168510437
Epoch: 11, Steps: 35 | Train Loss: 3.813 Vali Loss: 13.427 Vali Acc: 0.500 Test Loss: 13.427 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3712234497070312
Epoch: 12, Steps: 35 | Train Loss: 1.900 Vali Loss: 13.954 Vali Acc: 0.510 Test Loss: 13.954 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3865156173706055
Epoch: 13, Steps: 35 | Train Loss: 2.037 Vali Loss: 13.232 Vali Acc: 0.490 Test Loss: 13.232 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.426544666290283
Epoch: 14, Steps: 35 | Train Loss: 1.433 Vali Loss: 5.001 Vali Acc: 0.510 Test Loss: 5.001 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4744553565979004
Epoch: 15, Steps: 35 | Train Loss: 1.028 Vali Loss: 8.903 Vali Acc: 0.470 Test Loss: 8.903 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3523528575897217
Epoch: 16, Steps: 35 | Train Loss: 1.439 Vali Loss: 9.427 Vali Acc: 0.450 Test Loss: 9.427 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 446482
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.328092575073242
Epoch: 1, Steps: 35 | Train Loss: 1.067 Vali Loss: 2.506 Vali Acc: 0.460 Test Loss: 2.506 Test Acc: 0.460
Validation loss decreased (inf --> -0.459975).  Saving model ...
Epoch: 2 cost time: 2.4480066299438477
Epoch: 2, Steps: 35 | Train Loss: 1.944 Vali Loss: 2.521 Vali Acc: 0.480 Test Loss: 2.521 Test Acc: 0.480
Validation loss decreased (-0.459975 --> -0.479975).  Saving model ...
Epoch: 3 cost time: 2.3628692626953125
Epoch: 3, Steps: 35 | Train Loss: 2.229 Vali Loss: 1.785 Vali Acc: 0.580 Test Loss: 1.785 Test Acc: 0.580
Validation loss decreased (-0.479975 --> -0.579982).  Saving model ...
Epoch: 4 cost time: 2.573650360107422
Epoch: 4, Steps: 35 | Train Loss: 1.582 Vali Loss: 2.254 Vali Acc: 0.580 Test Loss: 2.254 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5879130363464355
Epoch: 5, Steps: 35 | Train Loss: 2.108 Vali Loss: 5.023 Vali Acc: 0.490 Test Loss: 5.023 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5297791957855225
Epoch: 6, Steps: 35 | Train Loss: 1.803 Vali Loss: 4.302 Vali Acc: 0.490 Test Loss: 4.302 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.498873472213745
Epoch: 7, Steps: 35 | Train Loss: 1.356 Vali Loss: 8.453 Vali Acc: 0.500 Test Loss: 8.453 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.621004581451416
Epoch: 8, Steps: 35 | Train Loss: 2.158 Vali Loss: 5.025 Vali Acc: 0.520 Test Loss: 5.025 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8434667587280273
Epoch: 9, Steps: 35 | Train Loss: 1.976 Vali Loss: 4.106 Vali Acc: 0.490 Test Loss: 4.106 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3417508602142334
Epoch: 10, Steps: 35 | Train Loss: 2.741 Vali Loss: 5.118 Vali Acc: 0.540 Test Loss: 5.118 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4730522632598877
Epoch: 11, Steps: 35 | Train Loss: 2.885 Vali Loss: 10.043 Vali Acc: 0.470 Test Loss: 10.043 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.293958902359009
Epoch: 12, Steps: 35 | Train Loss: 3.213 Vali Loss: 4.024 Vali Acc: 0.550 Test Loss: 4.024 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.293121576309204
Epoch: 13, Steps: 35 | Train Loss: 2.585 Vali Loss: 5.650 Vali Acc: 0.530 Test Loss: 5.650 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 446482
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.468061685562134
Epoch: 1, Steps: 35 | Train Loss: 0.996 Vali Loss: 1.712 Vali Acc: 0.480 Test Loss: 1.712 Test Acc: 0.480
Validation loss decreased (inf --> -0.479983).  Saving model ...
Epoch: 2 cost time: 2.548569679260254
Epoch: 2, Steps: 35 | Train Loss: 1.945 Vali Loss: 2.466 Vali Acc: 0.410 Test Loss: 2.466 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.324105978012085
Epoch: 3, Steps: 35 | Train Loss: 2.176 Vali Loss: 3.254 Vali Acc: 0.520 Test Loss: 3.254 Test Acc: 0.520
Validation loss decreased (-0.479983 --> -0.519967).  Saving model ...
Epoch: 4 cost time: 2.416813373565674
Epoch: 4, Steps: 35 | Train Loss: 1.663 Vali Loss: 2.787 Vali Acc: 0.480 Test Loss: 2.787 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.584538459777832
Epoch: 5, Steps: 35 | Train Loss: 1.768 Vali Loss: 5.287 Vali Acc: 0.510 Test Loss: 5.287 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.300609827041626
Epoch: 6, Steps: 35 | Train Loss: 1.954 Vali Loss: 2.418 Vali Acc: 0.540 Test Loss: 2.418 Test Acc: 0.540
Validation loss decreased (-0.519967 --> -0.539976).  Saving model ...
Epoch: 7 cost time: 1.9906854629516602
Epoch: 7, Steps: 35 | Train Loss: 2.963 Vali Loss: 6.543 Vali Acc: 0.500 Test Loss: 6.543 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.244814395904541
Epoch: 8, Steps: 35 | Train Loss: 2.671 Vali Loss: 2.814 Vali Acc: 0.520 Test Loss: 2.814 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.223345994949341
Epoch: 9, Steps: 35 | Train Loss: 1.339 Vali Loss: 6.638 Vali Acc: 0.500 Test Loss: 6.638 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.492130994796753
Epoch: 10, Steps: 35 | Train Loss: 2.602 Vali Loss: 7.015 Vali Acc: 0.500 Test Loss: 7.015 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.382131576538086
Epoch: 11, Steps: 35 | Train Loss: 2.549 Vali Loss: 8.042 Vali Acc: 0.450 Test Loss: 8.042 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.306562662124634
Epoch: 12, Steps: 35 | Train Loss: 1.934 Vali Loss: 8.222 Vali Acc: 0.510 Test Loss: 8.222 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.377903461456299
Epoch: 13, Steps: 35 | Train Loss: 2.016 Vali Loss: 7.449 Vali Acc: 0.530 Test Loss: 7.449 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.486278533935547
Epoch: 14, Steps: 35 | Train Loss: 1.543 Vali Loss: 5.351 Vali Acc: 0.510 Test Loss: 5.351 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4303250312805176
Epoch: 15, Steps: 35 | Train Loss: 0.914 Vali Loss: 5.884 Vali Acc: 0.540 Test Loss: 5.884 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.642504930496216
Epoch: 16, Steps: 35 | Train Loss: 3.128 Vali Loss: 8.512 Vali Acc: 0.460 Test Loss: 8.512 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 446482
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.061340093612671
Epoch: 1, Steps: 35 | Train Loss: 0.923 Vali Loss: 1.594 Vali Acc: 0.460 Test Loss: 1.594 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 2.1561784744262695
Epoch: 2, Steps: 35 | Train Loss: 2.155 Vali Loss: 1.917 Vali Acc: 0.490 Test Loss: 1.917 Test Acc: 0.490
Validation loss decreased (-0.459984 --> -0.489981).  Saving model ...
Epoch: 3 cost time: 2.071082592010498
Epoch: 3, Steps: 35 | Train Loss: 1.221 Vali Loss: 3.833 Vali Acc: 0.490 Test Loss: 3.833 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1771481037139893
Epoch: 4, Steps: 35 | Train Loss: 2.494 Vali Loss: 3.138 Vali Acc: 0.480 Test Loss: 3.138 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.507049083709717
Epoch: 5, Steps: 35 | Train Loss: 1.613 Vali Loss: 3.693 Vali Acc: 0.470 Test Loss: 3.693 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6060781478881836
Epoch: 6, Steps: 35 | Train Loss: 2.837 Vali Loss: 5.400 Vali Acc: 0.500 Test Loss: 5.400 Test Acc: 0.500
Validation loss decreased (-0.489981 --> -0.499946).  Saving model ...
Epoch: 7 cost time: 2.7775979042053223
Epoch: 7, Steps: 35 | Train Loss: 1.849 Vali Loss: 4.831 Vali Acc: 0.430 Test Loss: 4.831 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6704928874969482
Epoch: 8, Steps: 35 | Train Loss: 2.538 Vali Loss: 5.056 Vali Acc: 0.510 Test Loss: 5.056 Test Acc: 0.510
Validation loss decreased (-0.499946 --> -0.509949).  Saving model ...
Epoch: 9 cost time: 2.383002281188965
Epoch: 9, Steps: 35 | Train Loss: 1.776 Vali Loss: 5.035 Vali Acc: 0.490 Test Loss: 5.035 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.473501682281494
Epoch: 10, Steps: 35 | Train Loss: 2.306 Vali Loss: 12.805 Vali Acc: 0.490 Test Loss: 12.805 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5221383571624756
Epoch: 11, Steps: 35 | Train Loss: 3.573 Vali Loss: 6.834 Vali Acc: 0.370 Test Loss: 6.834 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2939870357513428
Epoch: 12, Steps: 35 | Train Loss: 1.564 Vali Loss: 4.456 Vali Acc: 0.510 Test Loss: 4.456 Test Acc: 0.510
Validation loss decreased (-0.509949 --> -0.509955).  Saving model ...
Epoch: 13 cost time: 2.4650802612304688
Epoch: 13, Steps: 35 | Train Loss: 1.131 Vali Loss: 8.848 Vali Acc: 0.490 Test Loss: 8.848 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6316823959350586
Epoch: 14, Steps: 35 | Train Loss: 3.812 Vali Loss: 5.031 Vali Acc: 0.450 Test Loss: 5.031 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2264838218688965
Epoch: 15, Steps: 35 | Train Loss: 2.419 Vali Loss: 8.704 Vali Acc: 0.460 Test Loss: 8.704 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2944600582122803
Epoch: 16, Steps: 35 | Train Loss: 1.568 Vali Loss: 10.762 Vali Acc: 0.500 Test Loss: 10.762 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.332036018371582
Epoch: 17, Steps: 35 | Train Loss: 2.752 Vali Loss: 6.254 Vali Acc: 0.480 Test Loss: 6.254 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2574634552001953
Epoch: 18, Steps: 35 | Train Loss: 2.503 Vali Loss: 6.744 Vali Acc: 0.420 Test Loss: 6.744 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5429646968841553
Epoch: 19, Steps: 35 | Train Loss: 1.286 Vali Loss: 12.020 Vali Acc: 0.500 Test Loss: 12.020 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6179277896881104
Epoch: 20, Steps: 35 | Train Loss: 3.385 Vali Loss: 9.814 Vali Acc: 0.520 Test Loss: 9.814 Test Acc: 0.520
Validation loss decreased (-0.509955 --> -0.519902).  Saving model ...
Epoch: 21 cost time: 2.231806516647339
Epoch: 21, Steps: 35 | Train Loss: 3.018 Vali Loss: 11.988 Vali Acc: 0.430 Test Loss: 11.988 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2900493144989014
Epoch: 22, Steps: 35 | Train Loss: 3.778 Vali Loss: 15.230 Vali Acc: 0.470 Test Loss: 15.230 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2807226181030273
Epoch: 23, Steps: 35 | Train Loss: 3.508 Vali Loss: 8.180 Vali Acc: 0.480 Test Loss: 8.180 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2630276679992676
Epoch: 24, Steps: 35 | Train Loss: 1.554 Vali Loss: 7.160 Vali Acc: 0.470 Test Loss: 7.160 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.553685426712036
Epoch: 25, Steps: 35 | Train Loss: 1.749 Vali Loss: 8.494 Vali Acc: 0.480 Test Loss: 8.494 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5972321033477783
Epoch: 26, Steps: 35 | Train Loss: 1.813 Vali Loss: 7.721 Vali Acc: 0.480 Test Loss: 7.721 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.4691057205200195
Epoch: 27, Steps: 35 | Train Loss: 1.668 Vali Loss: 5.970 Vali Acc: 0.530 Test Loss: 5.970 Test Acc: 0.530
Validation loss decreased (-0.519902 --> -0.529940).  Saving model ...
Epoch: 28 cost time: 2.3552260398864746
Epoch: 28, Steps: 35 | Train Loss: 0.854 Vali Loss: 11.910 Vali Acc: 0.510 Test Loss: 11.910 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2637455463409424
Epoch: 29, Steps: 35 | Train Loss: 1.659 Vali Loss: 8.038 Vali Acc: 0.510 Test Loss: 8.038 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0469021797180176
Epoch: 30, Steps: 35 | Train Loss: 2.066 Vali Loss: 10.517 Vali Acc: 0.510 Test Loss: 10.517 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2274744510650635
Epoch: 31, Steps: 35 | Train Loss: 1.701 Vali Loss: 13.488 Vali Acc: 0.460 Test Loss: 13.488 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.304910182952881
Epoch: 32, Steps: 35 | Train Loss: 2.168 Vali Loss: 6.523 Vali Acc: 0.510 Test Loss: 6.523 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1625277996063232
Epoch: 33, Steps: 35 | Train Loss: 0.774 Vali Loss: 6.967 Vali Acc: 0.550 Test Loss: 6.967 Test Acc: 0.550
Validation loss decreased (-0.529940 --> -0.549930).  Saving model ...
Epoch: 34 cost time: 2.489447832107544
Epoch: 34, Steps: 35 | Train Loss: 1.035 Vali Loss: 10.090 Vali Acc: 0.500 Test Loss: 10.090 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4202728271484375
Epoch: 35, Steps: 35 | Train Loss: 2.685 Vali Loss: 9.963 Vali Acc: 0.460 Test Loss: 9.963 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.454782009124756
Epoch: 36, Steps: 35 | Train Loss: 1.865 Vali Loss: 7.587 Vali Acc: 0.550 Test Loss: 7.587 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6162562370300293
Epoch: 37, Steps: 35 | Train Loss: 1.068 Vali Loss: 13.808 Vali Acc: 0.520 Test Loss: 13.808 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.53481388092041
Epoch: 38, Steps: 35 | Train Loss: 1.097 Vali Loss: 9.480 Vali Acc: 0.520 Test Loss: 9.480 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.348423957824707
Epoch: 39, Steps: 35 | Train Loss: 1.525 Vali Loss: 10.009 Vali Acc: 0.520 Test Loss: 10.009 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.386685848236084
Epoch: 40, Steps: 35 | Train Loss: 1.348 Vali Loss: 8.665 Vali Acc: 0.540 Test Loss: 8.665 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.5445899963378906
Epoch: 41, Steps: 35 | Train Loss: 1.131 Vali Loss: 12.071 Vali Acc: 0.520 Test Loss: 12.071 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.2756245136260986
Epoch: 42, Steps: 35 | Train Loss: 1.367 Vali Loss: 16.541 Vali Acc: 0.480 Test Loss: 16.541 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.487276077270508
Epoch: 43, Steps: 35 | Train Loss: 1.816 Vali Loss: 17.959 Vali Acc: 0.490 Test Loss: 17.959 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 446482
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.471024513244629
Epoch: 1, Steps: 35 | Train Loss: 1.815 Vali Loss: 1.521 Vali Acc: 0.510 Test Loss: 1.521 Test Acc: 0.510
Validation loss decreased (inf --> -0.509985).  Saving model ...
Epoch: 2 cost time: 2.341493606567383
Epoch: 2, Steps: 35 | Train Loss: 1.609 Vali Loss: 3.215 Vali Acc: 0.460 Test Loss: 3.215 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.551846981048584
Epoch: 3, Steps: 35 | Train Loss: 2.567 Vali Loss: 4.066 Vali Acc: 0.560 Test Loss: 4.066 Test Acc: 0.560
Validation loss decreased (-0.509985 --> -0.559959).  Saving model ...
Epoch: 4 cost time: 2.457667112350464
Epoch: 4, Steps: 35 | Train Loss: 1.699 Vali Loss: 2.631 Vali Acc: 0.550 Test Loss: 2.631 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.415285587310791
Epoch: 5, Steps: 35 | Train Loss: 1.489 Vali Loss: 7.040 Vali Acc: 0.480 Test Loss: 7.040 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4483561515808105
Epoch: 6, Steps: 35 | Train Loss: 2.420 Vali Loss: 5.375 Vali Acc: 0.480 Test Loss: 5.375 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4235546588897705
Epoch: 7, Steps: 35 | Train Loss: 2.373 Vali Loss: 5.111 Vali Acc: 0.440 Test Loss: 5.111 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4023237228393555
Epoch: 8, Steps: 35 | Train Loss: 2.513 Vali Loss: 7.629 Vali Acc: 0.460 Test Loss: 7.629 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.253093719482422
Epoch: 9, Steps: 35 | Train Loss: 1.203 Vali Loss: 3.278 Vali Acc: 0.580 Test Loss: 3.278 Test Acc: 0.580
Validation loss decreased (-0.559959 --> -0.579967).  Saving model ...
Epoch: 10 cost time: 2.409339427947998
Epoch: 10, Steps: 35 | Train Loss: 0.921 Vali Loss: 8.209 Vali Acc: 0.460 Test Loss: 8.209 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.365246534347534
Epoch: 11, Steps: 35 | Train Loss: 1.767 Vali Loss: 7.963 Vali Acc: 0.500 Test Loss: 7.963 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.351209878921509
Epoch: 12, Steps: 35 | Train Loss: 1.995 Vali Loss: 7.084 Vali Acc: 0.540 Test Loss: 7.084 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.387972593307495
Epoch: 13, Steps: 35 | Train Loss: 2.221 Vali Loss: 8.534 Vali Acc: 0.500 Test Loss: 8.534 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.420762538909912
Epoch: 14, Steps: 35 | Train Loss: 1.445 Vali Loss: 5.784 Vali Acc: 0.480 Test Loss: 5.784 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4309580326080322
Epoch: 15, Steps: 35 | Train Loss: 1.438 Vali Loss: 11.182 Vali Acc: 0.470 Test Loss: 11.182 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5542256832122803
Epoch: 16, Steps: 35 | Train Loss: 1.023 Vali Loss: 6.674 Vali Acc: 0.580 Test Loss: 6.674 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5390772819519043
Epoch: 17, Steps: 35 | Train Loss: 1.456 Vali Loss: 6.638 Vali Acc: 0.460 Test Loss: 6.638 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.437950611114502
Epoch: 18, Steps: 35 | Train Loss: 1.422 Vali Loss: 9.437 Vali Acc: 0.520 Test Loss: 9.437 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.457582712173462
Epoch: 19, Steps: 35 | Train Loss: 0.773 Vali Loss: 7.960 Vali Acc: 0.470 Test Loss: 7.960 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 430098
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.268967866897583
Epoch: 1, Steps: 35 | Train Loss: 1.785 Vali Loss: 1.665 Vali Acc: 0.490 Test Loss: 1.665 Test Acc: 0.490
Validation loss decreased (inf --> -0.489983).  Saving model ...
Epoch: 2 cost time: 2.4074389934539795
Epoch: 2, Steps: 35 | Train Loss: 1.664 Vali Loss: 3.783 Vali Acc: 0.530 Test Loss: 3.783 Test Acc: 0.530
Validation loss decreased (-0.489983 --> -0.529962).  Saving model ...
Epoch: 3 cost time: 2.413910150527954
Epoch: 3, Steps: 35 | Train Loss: 2.060 Vali Loss: 2.110 Vali Acc: 0.530 Test Loss: 2.110 Test Acc: 0.530
Validation loss decreased (-0.529962 --> -0.529979).  Saving model ...
Epoch: 4 cost time: 2.3406410217285156
Epoch: 4, Steps: 35 | Train Loss: 3.154 Vali Loss: 2.858 Vali Acc: 0.480 Test Loss: 2.858 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3934478759765625
Epoch: 5, Steps: 35 | Train Loss: 1.622 Vali Loss: 3.156 Vali Acc: 0.480 Test Loss: 3.156 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3869807720184326
Epoch: 6, Steps: 35 | Train Loss: 1.516 Vali Loss: 5.342 Vali Acc: 0.510 Test Loss: 5.342 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2923736572265625
Epoch: 7, Steps: 35 | Train Loss: 3.181 Vali Loss: 7.567 Vali Acc: 0.510 Test Loss: 7.567 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.429461717605591
Epoch: 8, Steps: 35 | Train Loss: 2.129 Vali Loss: 3.316 Vali Acc: 0.500 Test Loss: 3.316 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.293475866317749
Epoch: 9, Steps: 35 | Train Loss: 3.015 Vali Loss: 3.902 Vali Acc: 0.540 Test Loss: 3.902 Test Acc: 0.540
Validation loss decreased (-0.529979 --> -0.539961).  Saving model ...
Epoch: 10 cost time: 2.277020215988159
Epoch: 10, Steps: 35 | Train Loss: 1.376 Vali Loss: 4.640 Vali Acc: 0.510 Test Loss: 4.640 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.297229528427124
Epoch: 11, Steps: 35 | Train Loss: 2.154 Vali Loss: 6.587 Vali Acc: 0.540 Test Loss: 6.587 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.332956075668335
Epoch: 12, Steps: 35 | Train Loss: 2.297 Vali Loss: 10.043 Vali Acc: 0.460 Test Loss: 10.043 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3563601970672607
Epoch: 13, Steps: 35 | Train Loss: 1.810 Vali Loss: 6.352 Vali Acc: 0.460 Test Loss: 6.352 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5557169914245605
Epoch: 14, Steps: 35 | Train Loss: 3.318 Vali Loss: 10.687 Vali Acc: 0.470 Test Loss: 10.687 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7139780521392822
Epoch: 15, Steps: 35 | Train Loss: 2.081 Vali Loss: 7.382 Vali Acc: 0.490 Test Loss: 7.382 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4115822315216064
Epoch: 16, Steps: 35 | Train Loss: 2.521 Vali Loss: 6.043 Vali Acc: 0.520 Test Loss: 6.043 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4449050426483154
Epoch: 17, Steps: 35 | Train Loss: 1.273 Vali Loss: 7.183 Vali Acc: 0.530 Test Loss: 7.183 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5887155532836914
Epoch: 18, Steps: 35 | Train Loss: 0.961 Vali Loss: 8.112 Vali Acc: 0.560 Test Loss: 8.112 Test Acc: 0.560
Validation loss decreased (-0.539961 --> -0.559919).  Saving model ...
Epoch: 19 cost time: 2.535240650177002
Epoch: 19, Steps: 35 | Train Loss: 2.825 Vali Loss: 8.893 Vali Acc: 0.520 Test Loss: 8.893 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4628965854644775
Epoch: 20, Steps: 35 | Train Loss: 1.266 Vali Loss: 7.059 Vali Acc: 0.540 Test Loss: 7.059 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5260841846466064
Epoch: 21, Steps: 35 | Train Loss: 2.508 Vali Loss: 7.961 Vali Acc: 0.520 Test Loss: 7.961 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3303256034851074
Epoch: 22, Steps: 35 | Train Loss: 1.422 Vali Loss: 10.481 Vali Acc: 0.550 Test Loss: 10.481 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3978636264801025
Epoch: 23, Steps: 35 | Train Loss: 2.408 Vali Loss: 8.956 Vali Acc: 0.550 Test Loss: 8.956 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3537352085113525
Epoch: 24, Steps: 35 | Train Loss: 1.371 Vali Loss: 6.035 Vali Acc: 0.620 Test Loss: 6.035 Test Acc: 0.620
Validation loss decreased (-0.559919 --> -0.619940).  Saving model ...
Epoch: 25 cost time: 2.45171856880188
Epoch: 25, Steps: 35 | Train Loss: 1.417 Vali Loss: 6.185 Vali Acc: 0.610 Test Loss: 6.185 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4046742916107178
Epoch: 26, Steps: 35 | Train Loss: 0.516 Vali Loss: 5.567 Vali Acc: 0.570 Test Loss: 5.567 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6805174350738525
Epoch: 27, Steps: 35 | Train Loss: 0.760 Vali Loss: 6.967 Vali Acc: 0.580 Test Loss: 6.967 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.639887571334839
Epoch: 28, Steps: 35 | Train Loss: 1.453 Vali Loss: 12.473 Vali Acc: 0.510 Test Loss: 12.473 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6378955841064453
Epoch: 29, Steps: 35 | Train Loss: 1.279 Vali Loss: 8.649 Vali Acc: 0.540 Test Loss: 8.649 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7635838985443115
Epoch: 30, Steps: 35 | Train Loss: 1.688 Vali Loss: 8.061 Vali Acc: 0.560 Test Loss: 8.061 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.761186361312866
Epoch: 31, Steps: 35 | Train Loss: 1.718 Vali Loss: 8.262 Vali Acc: 0.530 Test Loss: 8.262 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.8787784576416016
Epoch: 32, Steps: 35 | Train Loss: 1.263 Vali Loss: 10.694 Vali Acc: 0.530 Test Loss: 10.694 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.7751271724700928
Epoch: 33, Steps: 35 | Train Loss: 1.083 Vali Loss: 7.763 Vali Acc: 0.570 Test Loss: 7.763 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.601236343383789
Epoch: 34, Steps: 35 | Train Loss: 1.620 Vali Loss: 13.013 Vali Acc: 0.470 Test Loss: 13.013 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 430098
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.207952976226807
Epoch: 1, Steps: 35 | Train Loss: 1.604 Vali Loss: 2.881 Vali Acc: 0.480 Test Loss: 2.881 Test Acc: 0.480
Validation loss decreased (inf --> -0.479971).  Saving model ...
Epoch: 2 cost time: 2.400923013687134
Epoch: 2, Steps: 35 | Train Loss: 2.102 Vali Loss: 3.895 Vali Acc: 0.510 Test Loss: 3.895 Test Acc: 0.510
Validation loss decreased (-0.479971 --> -0.509961).  Saving model ...
Epoch: 3 cost time: 2.3333237171173096
Epoch: 3, Steps: 35 | Train Loss: 2.384 Vali Loss: 1.965 Vali Acc: 0.590 Test Loss: 1.965 Test Acc: 0.590
Validation loss decreased (-0.509961 --> -0.589980).  Saving model ...
Epoch: 4 cost time: 2.25087833404541
Epoch: 4, Steps: 35 | Train Loss: 2.346 Vali Loss: 7.357 Vali Acc: 0.500 Test Loss: 7.357 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.279066562652588
Epoch: 5, Steps: 35 | Train Loss: 3.647 Vali Loss: 3.607 Vali Acc: 0.520 Test Loss: 3.607 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.435488700866699
Epoch: 6, Steps: 35 | Train Loss: 2.789 Vali Loss: 5.574 Vali Acc: 0.480 Test Loss: 5.574 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.322572708129883
Epoch: 7, Steps: 35 | Train Loss: 2.649 Vali Loss: 5.475 Vali Acc: 0.480 Test Loss: 5.475 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.113779067993164
Epoch: 8, Steps: 35 | Train Loss: 2.108 Vali Loss: 7.575 Vali Acc: 0.450 Test Loss: 7.575 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.322579860687256
Epoch: 9, Steps: 35 | Train Loss: 2.454 Vali Loss: 2.782 Vali Acc: 0.500 Test Loss: 2.782 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.29097318649292
Epoch: 10, Steps: 35 | Train Loss: 1.746 Vali Loss: 4.211 Vali Acc: 0.560 Test Loss: 4.211 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3287341594696045
Epoch: 11, Steps: 35 | Train Loss: 2.297 Vali Loss: 17.594 Vali Acc: 0.490 Test Loss: 17.594 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4092280864715576
Epoch: 12, Steps: 35 | Train Loss: 2.428 Vali Loss: 5.577 Vali Acc: 0.510 Test Loss: 5.577 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7441272735595703
Epoch: 13, Steps: 35 | Train Loss: 3.070 Vali Loss: 9.213 Vali Acc: 0.440 Test Loss: 9.213 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 430098
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.164535760879517
Epoch: 1, Steps: 35 | Train Loss: 1.308 Vali Loss: 2.315 Vali Acc: 0.500 Test Loss: 2.315 Test Acc: 0.500
Validation loss decreased (inf --> -0.499977).  Saving model ...
Epoch: 2 cost time: 2.1741695404052734
Epoch: 2, Steps: 35 | Train Loss: 1.703 Vali Loss: 2.250 Vali Acc: 0.420 Test Loss: 2.250 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.062774181365967
Epoch: 3, Steps: 35 | Train Loss: 2.079 Vali Loss: 3.520 Vali Acc: 0.540 Test Loss: 3.520 Test Acc: 0.540
Validation loss decreased (-0.499977 --> -0.539965).  Saving model ...
Epoch: 4 cost time: 2.140493154525757
Epoch: 4, Steps: 35 | Train Loss: 1.998 Vali Loss: 3.029 Vali Acc: 0.510 Test Loss: 3.029 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0637643337249756
Epoch: 5, Steps: 35 | Train Loss: 2.473 Vali Loss: 11.027 Vali Acc: 0.510 Test Loss: 11.027 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1862905025482178
Epoch: 6, Steps: 35 | Train Loss: 2.369 Vali Loss: 5.343 Vali Acc: 0.450 Test Loss: 5.343 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1148488521575928
Epoch: 7, Steps: 35 | Train Loss: 2.369 Vali Loss: 4.741 Vali Acc: 0.440 Test Loss: 4.741 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0702128410339355
Epoch: 8, Steps: 35 | Train Loss: 2.836 Vali Loss: 13.323 Vali Acc: 0.450 Test Loss: 13.323 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.08095645904541
Epoch: 9, Steps: 35 | Train Loss: 2.852 Vali Loss: 6.003 Vali Acc: 0.480 Test Loss: 6.003 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2225940227508545
Epoch: 10, Steps: 35 | Train Loss: 2.498 Vali Loss: 4.505 Vali Acc: 0.540 Test Loss: 4.505 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2549595832824707
Epoch: 11, Steps: 35 | Train Loss: 2.607 Vali Loss: 7.591 Vali Acc: 0.470 Test Loss: 7.591 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.175865888595581
Epoch: 12, Steps: 35 | Train Loss: 1.647 Vali Loss: 6.895 Vali Acc: 0.460 Test Loss: 6.895 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1832549571990967
Epoch: 13, Steps: 35 | Train Loss: 1.572 Vali Loss: 4.844 Vali Acc: 0.560 Test Loss: 4.844 Test Acc: 0.560
Validation loss decreased (-0.539965 --> -0.559952).  Saving model ...
Epoch: 14 cost time: 2.3296737670898438
Epoch: 14, Steps: 35 | Train Loss: 1.532 Vali Loss: 7.212 Vali Acc: 0.520 Test Loss: 7.212 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2425003051757812
Epoch: 15, Steps: 35 | Train Loss: 1.690 Vali Loss: 6.819 Vali Acc: 0.470 Test Loss: 6.819 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1812236309051514
Epoch: 16, Steps: 35 | Train Loss: 1.658 Vali Loss: 4.921 Vali Acc: 0.500 Test Loss: 4.921 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0914835929870605
Epoch: 17, Steps: 35 | Train Loss: 2.833 Vali Loss: 10.659 Vali Acc: 0.450 Test Loss: 10.659 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.040135145187378
Epoch: 18, Steps: 35 | Train Loss: 2.880 Vali Loss: 7.496 Vali Acc: 0.480 Test Loss: 7.496 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.036832094192505
Epoch: 19, Steps: 35 | Train Loss: 2.392 Vali Loss: 4.945 Vali Acc: 0.440 Test Loss: 4.945 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.109189033508301
Epoch: 20, Steps: 35 | Train Loss: 1.470 Vali Loss: 8.047 Vali Acc: 0.470 Test Loss: 8.047 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0556347370147705
Epoch: 21, Steps: 35 | Train Loss: 2.037 Vali Loss: 6.842 Vali Acc: 0.500 Test Loss: 6.842 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0808675289154053
Epoch: 22, Steps: 35 | Train Loss: 1.327 Vali Loss: 7.081 Vali Acc: 0.470 Test Loss: 7.081 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3728275299072266
Epoch: 23, Steps: 35 | Train Loss: 1.847 Vali Loss: 10.462 Vali Acc: 0.510 Test Loss: 10.462 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 430098
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.362873554229736
Epoch: 1, Steps: 35 | Train Loss: 1.168 Vali Loss: 2.188 Vali Acc: 0.490 Test Loss: 2.188 Test Acc: 0.490
Validation loss decreased (inf --> -0.489978).  Saving model ...
Epoch: 2 cost time: 2.4292895793914795
Epoch: 2, Steps: 35 | Train Loss: 1.512 Vali Loss: 4.765 Vali Acc: 0.510 Test Loss: 4.765 Test Acc: 0.510
Validation loss decreased (-0.489978 --> -0.509952).  Saving model ...
Epoch: 3 cost time: 2.514281749725342
Epoch: 3, Steps: 35 | Train Loss: 2.483 Vali Loss: 3.679 Vali Acc: 0.460 Test Loss: 3.679 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.598659038543701
Epoch: 4, Steps: 35 | Train Loss: 1.385 Vali Loss: 4.372 Vali Acc: 0.490 Test Loss: 4.372 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.44709849357605
Epoch: 5, Steps: 35 | Train Loss: 3.114 Vali Loss: 3.062 Vali Acc: 0.460 Test Loss: 3.062 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.429980516433716
Epoch: 6, Steps: 35 | Train Loss: 2.009 Vali Loss: 5.075 Vali Acc: 0.490 Test Loss: 5.075 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.394038438796997
Epoch: 7, Steps: 35 | Train Loss: 1.007 Vali Loss: 4.035 Vali Acc: 0.530 Test Loss: 4.035 Test Acc: 0.530
Validation loss decreased (-0.509952 --> -0.529960).  Saving model ...
Epoch: 8 cost time: 2.5059549808502197
Epoch: 8, Steps: 35 | Train Loss: 1.358 Vali Loss: 6.388 Vali Acc: 0.510 Test Loss: 6.388 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6570615768432617
Epoch: 9, Steps: 35 | Train Loss: 1.220 Vali Loss: 8.001 Vali Acc: 0.410 Test Loss: 8.001 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5305683612823486
Epoch: 10, Steps: 35 | Train Loss: 1.879 Vali Loss: 3.796 Vali Acc: 0.550 Test Loss: 3.796 Test Acc: 0.550
Validation loss decreased (-0.529960 --> -0.549962).  Saving model ...
Epoch: 11 cost time: 2.5229969024658203
Epoch: 11, Steps: 35 | Train Loss: 3.233 Vali Loss: 17.317 Vali Acc: 0.450 Test Loss: 17.317 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.675912618637085
Epoch: 12, Steps: 35 | Train Loss: 2.865 Vali Loss: 6.123 Vali Acc: 0.540 Test Loss: 6.123 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6431334018707275
Epoch: 13, Steps: 35 | Train Loss: 1.933 Vali Loss: 5.184 Vali Acc: 0.530 Test Loss: 5.184 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6041650772094727
Epoch: 14, Steps: 35 | Train Loss: 1.187 Vali Loss: 4.087 Vali Acc: 0.530 Test Loss: 4.087 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6659164428710938
Epoch: 15, Steps: 35 | Train Loss: 1.461 Vali Loss: 14.471 Vali Acc: 0.490 Test Loss: 14.471 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.801518678665161
Epoch: 16, Steps: 35 | Train Loss: 2.120 Vali Loss: 17.995 Vali Acc: 0.450 Test Loss: 17.995 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6432836055755615
Epoch: 17, Steps: 35 | Train Loss: 1.498 Vali Loss: 5.009 Vali Acc: 0.530 Test Loss: 5.009 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5784199237823486
Epoch: 18, Steps: 35 | Train Loss: 1.044 Vali Loss: 4.956 Vali Acc: 0.470 Test Loss: 4.956 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5380988121032715
Epoch: 19, Steps: 35 | Train Loss: 1.004 Vali Loss: 7.995 Vali Acc: 0.530 Test Loss: 7.995 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.608675956726074
Epoch: 20, Steps: 35 | Train Loss: 1.509 Vali Loss: 12.263 Vali Acc: 0.510 Test Loss: 12.263 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 421906
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.132336139678955
Epoch: 1, Steps: 35 | Train Loss: 1.012 Vali Loss: 1.726 Vali Acc: 0.500 Test Loss: 1.726 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 2.3257710933685303
Epoch: 2, Steps: 35 | Train Loss: 1.177 Vali Loss: 4.915 Vali Acc: 0.500 Test Loss: 4.915 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.250214099884033
Epoch: 3, Steps: 35 | Train Loss: 1.999 Vali Loss: 1.554 Vali Acc: 0.500 Test Loss: 1.554 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 2.508399724960327
Epoch: 4, Steps: 35 | Train Loss: 1.871 Vali Loss: 2.409 Vali Acc: 0.530 Test Loss: 2.409 Test Acc: 0.530
Validation loss decreased (-0.499984 --> -0.529976).  Saving model ...
Epoch: 5 cost time: 2.27276611328125
Epoch: 5, Steps: 35 | Train Loss: 2.313 Vali Loss: 3.251 Vali Acc: 0.550 Test Loss: 3.251 Test Acc: 0.550
Validation loss decreased (-0.529976 --> -0.549967).  Saving model ...
Epoch: 6 cost time: 2.130943775177002
Epoch: 6, Steps: 35 | Train Loss: 2.066 Vali Loss: 5.329 Vali Acc: 0.490 Test Loss: 5.329 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3332111835479736
Epoch: 7, Steps: 35 | Train Loss: 2.091 Vali Loss: 2.836 Vali Acc: 0.580 Test Loss: 2.836 Test Acc: 0.580
Validation loss decreased (-0.549967 --> -0.579972).  Saving model ...
Epoch: 8 cost time: 2.239474058151245
Epoch: 8, Steps: 35 | Train Loss: 3.034 Vali Loss: 4.636 Vali Acc: 0.480 Test Loss: 4.636 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3240966796875
Epoch: 9, Steps: 35 | Train Loss: 1.334 Vali Loss: 5.177 Vali Acc: 0.460 Test Loss: 5.177 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3784267902374268
Epoch: 10, Steps: 35 | Train Loss: 1.894 Vali Loss: 7.227 Vali Acc: 0.470 Test Loss: 7.227 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6060619354248047
Epoch: 11, Steps: 35 | Train Loss: 2.717 Vali Loss: 5.959 Vali Acc: 0.560 Test Loss: 5.959 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.497833251953125
Epoch: 12, Steps: 35 | Train Loss: 1.102 Vali Loss: 7.839 Vali Acc: 0.480 Test Loss: 7.839 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.46335768699646
Epoch: 13, Steps: 35 | Train Loss: 1.364 Vali Loss: 6.910 Vali Acc: 0.500 Test Loss: 6.910 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.568148612976074
Epoch: 14, Steps: 35 | Train Loss: 2.494 Vali Loss: 4.437 Vali Acc: 0.580 Test Loss: 4.437 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6725857257843018
Epoch: 15, Steps: 35 | Train Loss: 1.409 Vali Loss: 16.737 Vali Acc: 0.500 Test Loss: 16.737 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9441192150115967
Epoch: 16, Steps: 35 | Train Loss: 1.240 Vali Loss: 5.746 Vali Acc: 0.580 Test Loss: 5.746 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8966729640960693
Epoch: 17, Steps: 35 | Train Loss: 3.358 Vali Loss: 5.728 Vali Acc: 0.530 Test Loss: 5.728 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 421906
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0947229862213135
Epoch: 1, Steps: 35 | Train Loss: 1.052 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
Validation loss decreased (inf --> -0.519986).  Saving model ...
Epoch: 2 cost time: 2.3986942768096924
Epoch: 2, Steps: 35 | Train Loss: 1.197 Vali Loss: 1.965 Vali Acc: 0.500 Test Loss: 1.965 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2991814613342285
Epoch: 3, Steps: 35 | Train Loss: 1.974 Vali Loss: 2.299 Vali Acc: 0.490 Test Loss: 2.299 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.33359956741333
Epoch: 4, Steps: 35 | Train Loss: 1.542 Vali Loss: 2.018 Vali Acc: 0.530 Test Loss: 2.018 Test Acc: 0.530
Validation loss decreased (-0.519986 --> -0.529980).  Saving model ...
Epoch: 5 cost time: 2.705587387084961
Epoch: 5, Steps: 35 | Train Loss: 2.618 Vali Loss: 4.589 Vali Acc: 0.470 Test Loss: 4.589 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.262986898422241
Epoch: 6, Steps: 35 | Train Loss: 2.264 Vali Loss: 5.139 Vali Acc: 0.460 Test Loss: 5.139 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2111737728118896
Epoch: 7, Steps: 35 | Train Loss: 1.760 Vali Loss: 4.921 Vali Acc: 0.550 Test Loss: 4.921 Test Acc: 0.550
Validation loss decreased (-0.529980 --> -0.549951).  Saving model ...
Epoch: 8 cost time: 2.2911429405212402
Epoch: 8, Steps: 35 | Train Loss: 3.679 Vali Loss: 3.855 Vali Acc: 0.500 Test Loss: 3.855 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.191744327545166
Epoch: 9, Steps: 35 | Train Loss: 2.573 Vali Loss: 8.445 Vali Acc: 0.470 Test Loss: 8.445 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.460536003112793
Epoch: 10, Steps: 35 | Train Loss: 2.334 Vali Loss: 7.948 Vali Acc: 0.500 Test Loss: 7.948 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.048365354537964
Epoch: 11, Steps: 35 | Train Loss: 2.336 Vali Loss: 7.652 Vali Acc: 0.450 Test Loss: 7.652 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.028761386871338
Epoch: 12, Steps: 35 | Train Loss: 1.416 Vali Loss: 14.660 Vali Acc: 0.480 Test Loss: 14.660 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.271021842956543
Epoch: 13, Steps: 35 | Train Loss: 1.869 Vali Loss: 4.365 Vali Acc: 0.480 Test Loss: 4.365 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2982070446014404
Epoch: 14, Steps: 35 | Train Loss: 1.571 Vali Loss: 5.033 Vali Acc: 0.530 Test Loss: 5.033 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2336061000823975
Epoch: 15, Steps: 35 | Train Loss: 1.475 Vali Loss: 13.428 Vali Acc: 0.470 Test Loss: 13.428 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3010377883911133
Epoch: 16, Steps: 35 | Train Loss: 1.481 Vali Loss: 14.616 Vali Acc: 0.510 Test Loss: 14.616 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3627870082855225
Epoch: 17, Steps: 35 | Train Loss: 1.646 Vali Loss: 11.094 Vali Acc: 0.480 Test Loss: 11.094 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 421906
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.994441270828247
Epoch: 1, Steps: 35 | Train Loss: 1.050 Vali Loss: 1.646 Vali Acc: 0.530 Test Loss: 1.646 Test Acc: 0.530
Validation loss decreased (inf --> -0.529984).  Saving model ...
Epoch: 2 cost time: 2.0625710487365723
Epoch: 2, Steps: 35 | Train Loss: 1.748 Vali Loss: 2.856 Vali Acc: 0.480 Test Loss: 2.856 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9886784553527832
Epoch: 3, Steps: 35 | Train Loss: 2.153 Vali Loss: 2.122 Vali Acc: 0.460 Test Loss: 2.122 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0417027473449707
Epoch: 4, Steps: 35 | Train Loss: 1.949 Vali Loss: 3.043 Vali Acc: 0.520 Test Loss: 3.043 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.117875814437866
Epoch: 5, Steps: 35 | Train Loss: 3.177 Vali Loss: 3.290 Vali Acc: 0.470 Test Loss: 3.290 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1358447074890137
Epoch: 6, Steps: 35 | Train Loss: 2.430 Vali Loss: 5.861 Vali Acc: 0.530 Test Loss: 5.861 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3929860591888428
Epoch: 7, Steps: 35 | Train Loss: 1.632 Vali Loss: 3.227 Vali Acc: 0.500 Test Loss: 3.227 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1360089778900146
Epoch: 8, Steps: 35 | Train Loss: 1.989 Vali Loss: 6.656 Vali Acc: 0.500 Test Loss: 6.656 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3335225582122803
Epoch: 9, Steps: 35 | Train Loss: 1.974 Vali Loss: 9.640 Vali Acc: 0.440 Test Loss: 9.640 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3580098152160645
Epoch: 10, Steps: 35 | Train Loss: 2.614 Vali Loss: 7.314 Vali Acc: 0.460 Test Loss: 7.314 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3899807929992676
Epoch: 11, Steps: 35 | Train Loss: 3.018 Vali Loss: 7.431 Vali Acc: 0.470 Test Loss: 7.431 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 421906
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.334303855895996
Epoch: 1, Steps: 35 | Train Loss: 0.948 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
Validation loss decreased (inf --> -0.519988).  Saving model ...
Epoch: 2 cost time: 2.255824089050293
Epoch: 2, Steps: 35 | Train Loss: 1.079 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
Validation loss decreased (-0.519988 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.185786724090576
Epoch: 3, Steps: 35 | Train Loss: 0.931 Vali Loss: 1.054 Vali Acc: 0.520 Test Loss: 1.054 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2376503944396973
Epoch: 4, Steps: 35 | Train Loss: 0.870 Vali Loss: 3.600 Vali Acc: 0.480 Test Loss: 3.600 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.182451009750366
Epoch: 5, Steps: 35 | Train Loss: 1.535 Vali Loss: 1.451 Vali Acc: 0.500 Test Loss: 1.451 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.196972131729126
Epoch: 6, Steps: 35 | Train Loss: 0.911 Vali Loss: 2.113 Vali Acc: 0.480 Test Loss: 2.113 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.513746500015259
Epoch: 7, Steps: 35 | Train Loss: 1.294 Vali Loss: 3.166 Vali Acc: 0.430 Test Loss: 3.166 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3011577129364014
Epoch: 8, Steps: 35 | Train Loss: 1.413 Vali Loss: 2.384 Vali Acc: 0.530 Test Loss: 2.384 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4388415813446045
Epoch: 9, Steps: 35 | Train Loss: 0.662 Vali Loss: 2.446 Vali Acc: 0.440 Test Loss: 2.446 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.399883508682251
Epoch: 10, Steps: 35 | Train Loss: 1.490 Vali Loss: 1.900 Vali Acc: 0.570 Test Loss: 1.900 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569981).  Saving model ...
Epoch: 11 cost time: 2.3930270671844482
Epoch: 11, Steps: 35 | Train Loss: 0.978 Vali Loss: 4.124 Vali Acc: 0.540 Test Loss: 4.124 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.456458568572998
Epoch: 12, Steps: 35 | Train Loss: 0.649 Vali Loss: 3.745 Vali Acc: 0.520 Test Loss: 3.745 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.668520927429199
Epoch: 13, Steps: 35 | Train Loss: 1.673 Vali Loss: 2.415 Vali Acc: 0.510 Test Loss: 2.415 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4387638568878174
Epoch: 14, Steps: 35 | Train Loss: 0.770 Vali Loss: 3.463 Vali Acc: 0.550 Test Loss: 3.463 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.469080686569214
Epoch: 15, Steps: 35 | Train Loss: 0.863 Vali Loss: 2.344 Vali Acc: 0.520 Test Loss: 2.344 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3359081745147705
Epoch: 16, Steps: 35 | Train Loss: 0.739 Vali Loss: 2.655 Vali Acc: 0.540 Test Loss: 2.655 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4803991317749023
Epoch: 17, Steps: 35 | Train Loss: 0.500 Vali Loss: 2.708 Vali Acc: 0.600 Test Loss: 2.708 Test Acc: 0.600
Validation loss decreased (-0.569981 --> -0.599973).  Saving model ...
Epoch: 18 cost time: 2.362179756164551
Epoch: 18, Steps: 35 | Train Loss: 0.591 Vali Loss: 4.351 Vali Acc: 0.470 Test Loss: 4.351 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4652678966522217
Epoch: 19, Steps: 35 | Train Loss: 0.785 Vali Loss: 3.267 Vali Acc: 0.490 Test Loss: 3.267 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.52921986579895
Epoch: 20, Steps: 35 | Train Loss: 0.669 Vali Loss: 5.066 Vali Acc: 0.500 Test Loss: 5.066 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.509887933731079
Epoch: 21, Steps: 35 | Train Loss: 1.403 Vali Loss: 5.878 Vali Acc: 0.450 Test Loss: 5.878 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.332473039627075
Epoch: 22, Steps: 35 | Train Loss: 1.491 Vali Loss: 6.349 Vali Acc: 0.500 Test Loss: 6.349 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.359259843826294
Epoch: 23, Steps: 35 | Train Loss: 0.368 Vali Loss: 3.956 Vali Acc: 0.580 Test Loss: 3.956 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.455568552017212
Epoch: 24, Steps: 35 | Train Loss: 1.375 Vali Loss: 4.777 Vali Acc: 0.520 Test Loss: 4.777 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.4132158756256104
Epoch: 25, Steps: 35 | Train Loss: 0.650 Vali Loss: 5.292 Vali Acc: 0.510 Test Loss: 5.292 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6232004165649414
Epoch: 26, Steps: 35 | Train Loss: 0.701 Vali Loss: 3.049 Vali Acc: 0.590 Test Loss: 3.049 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.836738109588623
Epoch: 27, Steps: 35 | Train Loss: 0.326 Vali Loss: 3.008 Vali Acc: 0.560 Test Loss: 3.008 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 336018
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.779867172241211
Epoch: 1, Steps: 35 | Train Loss: 0.938 Vali Loss: 1.093 Vali Acc: 0.460 Test Loss: 1.093 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 2.369143486022949
Epoch: 2, Steps: 35 | Train Loss: 1.242 Vali Loss: 1.201 Vali Acc: 0.510 Test Loss: 1.201 Test Acc: 0.510
Validation loss decreased (-0.459989 --> -0.509988).  Saving model ...
Epoch: 3 cost time: 2.437892198562622
Epoch: 3, Steps: 35 | Train Loss: 1.163 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
Validation loss decreased (-0.509988 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 2.258192539215088
Epoch: 4, Steps: 35 | Train Loss: 1.083 Vali Loss: 2.021 Vali Acc: 0.460 Test Loss: 2.021 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.308835744857788
Epoch: 5, Steps: 35 | Train Loss: 1.030 Vali Loss: 1.642 Vali Acc: 0.460 Test Loss: 1.642 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.307934522628784
Epoch: 6, Steps: 35 | Train Loss: 1.737 Vali Loss: 7.030 Vali Acc: 0.500 Test Loss: 7.030 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4197559356689453
Epoch: 7, Steps: 35 | Train Loss: 1.150 Vali Loss: 3.187 Vali Acc: 0.430 Test Loss: 3.187 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.508207082748413
Epoch: 8, Steps: 35 | Train Loss: 1.458 Vali Loss: 2.679 Vali Acc: 0.500 Test Loss: 2.679 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7652838230133057
Epoch: 9, Steps: 35 | Train Loss: 0.956 Vali Loss: 2.185 Vali Acc: 0.460 Test Loss: 2.185 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3750717639923096
Epoch: 10, Steps: 35 | Train Loss: 1.256 Vali Loss: 1.987 Vali Acc: 0.530 Test Loss: 1.987 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.714381694793701
Epoch: 11, Steps: 35 | Train Loss: 1.437 Vali Loss: 2.709 Vali Acc: 0.450 Test Loss: 2.709 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7484211921691895
Epoch: 12, Steps: 35 | Train Loss: 0.921 Vali Loss: 2.157 Vali Acc: 0.540 Test Loss: 2.157 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8094594478607178
Epoch: 13, Steps: 35 | Train Loss: 1.275 Vali Loss: 2.857 Vali Acc: 0.520 Test Loss: 2.857 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 336018
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.3895509243011475
Epoch: 1, Steps: 35 | Train Loss: 0.914 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 2.30952787399292
Epoch: 2, Steps: 35 | Train Loss: 1.084 Vali Loss: 0.960 Vali Acc: 0.480 Test Loss: 0.960 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2127685546875
Epoch: 3, Steps: 35 | Train Loss: 1.429 Vali Loss: 1.582 Vali Acc: 0.460 Test Loss: 1.582 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.311772584915161
Epoch: 4, Steps: 35 | Train Loss: 1.179 Vali Loss: 1.885 Vali Acc: 0.390 Test Loss: 1.885 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4510598182678223
Epoch: 5, Steps: 35 | Train Loss: 1.278 Vali Loss: 1.388 Vali Acc: 0.510 Test Loss: 1.388 Test Acc: 0.510
Validation loss decreased (-0.499989 --> -0.509986).  Saving model ...
Epoch: 6 cost time: 2.4659829139709473
Epoch: 6, Steps: 35 | Train Loss: 1.191 Vali Loss: 1.545 Vali Acc: 0.500 Test Loss: 1.545 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4609551429748535
Epoch: 7, Steps: 35 | Train Loss: 1.274 Vali Loss: 1.423 Vali Acc: 0.600 Test Loss: 1.423 Test Acc: 0.600
Validation loss decreased (-0.509986 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 2.630704164505005
Epoch: 8, Steps: 35 | Train Loss: 1.715 Vali Loss: 3.605 Vali Acc: 0.490 Test Loss: 3.605 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6929471492767334
Epoch: 9, Steps: 35 | Train Loss: 1.397 Vali Loss: 2.250 Vali Acc: 0.510 Test Loss: 2.250 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4138691425323486
Epoch: 10, Steps: 35 | Train Loss: 1.958 Vali Loss: 4.576 Vali Acc: 0.490 Test Loss: 4.576 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3611385822296143
Epoch: 11, Steps: 35 | Train Loss: 1.420 Vali Loss: 3.611 Vali Acc: 0.500 Test Loss: 3.611 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3273372650146484
Epoch: 12, Steps: 35 | Train Loss: 1.348 Vali Loss: 2.471 Vali Acc: 0.500 Test Loss: 2.471 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3774616718292236
Epoch: 13, Steps: 35 | Train Loss: 1.339 Vali Loss: 2.426 Vali Acc: 0.490 Test Loss: 2.426 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.557371139526367
Epoch: 14, Steps: 35 | Train Loss: 1.166 Vali Loss: 3.539 Vali Acc: 0.490 Test Loss: 3.539 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6295154094696045
Epoch: 15, Steps: 35 | Train Loss: 1.482 Vali Loss: 3.592 Vali Acc: 0.490 Test Loss: 3.592 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.570535182952881
Epoch: 16, Steps: 35 | Train Loss: 1.277 Vali Loss: 5.217 Vali Acc: 0.500 Test Loss: 5.217 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7986161708831787
Epoch: 17, Steps: 35 | Train Loss: 1.944 Vali Loss: 5.523 Vali Acc: 0.460 Test Loss: 5.523 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 336018
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.1235222816467285
Epoch: 1, Steps: 35 | Train Loss: 0.842 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.4809956550598145
Epoch: 2, Steps: 35 | Train Loss: 1.070 Vali Loss: 1.137 Vali Acc: 0.530 Test Loss: 1.137 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 2.230598211288452
Epoch: 3, Steps: 35 | Train Loss: 1.373 Vali Loss: 1.574 Vali Acc: 0.520 Test Loss: 1.574 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.025554895401001
Epoch: 4, Steps: 35 | Train Loss: 1.709 Vali Loss: 3.985 Vali Acc: 0.460 Test Loss: 3.985 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.229858636856079
Epoch: 5, Steps: 35 | Train Loss: 1.420 Vali Loss: 2.515 Vali Acc: 0.440 Test Loss: 2.515 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2771341800689697
Epoch: 6, Steps: 35 | Train Loss: 1.782 Vali Loss: 5.966 Vali Acc: 0.490 Test Loss: 5.966 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.111701488494873
Epoch: 7, Steps: 35 | Train Loss: 1.328 Vali Loss: 3.401 Vali Acc: 0.500 Test Loss: 3.401 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3150808811187744
Epoch: 8, Steps: 35 | Train Loss: 1.328 Vali Loss: 1.912 Vali Acc: 0.510 Test Loss: 1.912 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.319898843765259
Epoch: 9, Steps: 35 | Train Loss: 0.958 Vali Loss: 1.920 Vali Acc: 0.460 Test Loss: 1.920 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3466875553131104
Epoch: 10, Steps: 35 | Train Loss: 1.710 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3236775398254395
Epoch: 11, Steps: 35 | Train Loss: 1.265 Vali Loss: 2.254 Vali Acc: 0.520 Test Loss: 2.254 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4265754222869873
Epoch: 12, Steps: 35 | Train Loss: 1.346 Vali Loss: 4.851 Vali Acc: 0.500 Test Loss: 4.851 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 336018
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8264966011047363
Epoch: 1, Steps: 35 | Train Loss: 1.247 Vali Loss: 1.459 Vali Acc: 0.490 Test Loss: 1.459 Test Acc: 0.490
Validation loss decreased (inf --> -0.489985).  Saving model ...
Epoch: 2 cost time: 2.204160213470459
Epoch: 2, Steps: 35 | Train Loss: 1.250 Vali Loss: 1.360 Vali Acc: 0.540 Test Loss: 1.360 Test Acc: 0.540
Validation loss decreased (-0.489985 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 2.259488105773926
Epoch: 3, Steps: 35 | Train Loss: 1.743 Vali Loss: 1.392 Vali Acc: 0.430 Test Loss: 1.392 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3877224922180176
Epoch: 4, Steps: 35 | Train Loss: 1.117 Vali Loss: 1.154 Vali Acc: 0.520 Test Loss: 1.154 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.884310722351074
Epoch: 5, Steps: 35 | Train Loss: 1.278 Vali Loss: 1.975 Vali Acc: 0.520 Test Loss: 1.975 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.724780321121216
Epoch: 6, Steps: 35 | Train Loss: 1.619 Vali Loss: 2.715 Vali Acc: 0.520 Test Loss: 2.715 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5551791191101074
Epoch: 7, Steps: 35 | Train Loss: 0.953 Vali Loss: 2.684 Vali Acc: 0.510 Test Loss: 2.684 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5928359031677246
Epoch: 8, Steps: 35 | Train Loss: 1.045 Vali Loss: 1.498 Vali Acc: 0.520 Test Loss: 1.498 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.530526876449585
Epoch: 9, Steps: 35 | Train Loss: 0.919 Vali Loss: 4.194 Vali Acc: 0.470 Test Loss: 4.194 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4064316749572754
Epoch: 10, Steps: 35 | Train Loss: 1.107 Vali Loss: 2.846 Vali Acc: 0.490 Test Loss: 2.846 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5870537757873535
Epoch: 11, Steps: 35 | Train Loss: 1.327 Vali Loss: 1.643 Vali Acc: 0.510 Test Loss: 1.643 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.440613269805908
Epoch: 12, Steps: 35 | Train Loss: 1.155 Vali Loss: 5.598 Vali Acc: 0.510 Test Loss: 5.598 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 270482
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.567268371582031
Epoch: 1, Steps: 35 | Train Loss: 1.146 Vali Loss: 1.120 Vali Acc: 0.440 Test Loss: 1.120 Test Acc: 0.440
Validation loss decreased (inf --> -0.439989).  Saving model ...
Epoch: 2 cost time: 2.6996359825134277
Epoch: 2, Steps: 35 | Train Loss: 1.077 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.439989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 2.6450388431549072
Epoch: 3, Steps: 35 | Train Loss: 1.223 Vali Loss: 1.446 Vali Acc: 0.550 Test Loss: 1.446 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.571103572845459
Epoch: 4, Steps: 35 | Train Loss: 1.192 Vali Loss: 1.603 Vali Acc: 0.450 Test Loss: 1.603 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2791004180908203
Epoch: 5, Steps: 35 | Train Loss: 1.114 Vali Loss: 1.771 Vali Acc: 0.510 Test Loss: 1.771 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.375558376312256
Epoch: 6, Steps: 35 | Train Loss: 1.302 Vali Loss: 3.268 Vali Acc: 0.500 Test Loss: 3.268 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4197778701782227
Epoch: 7, Steps: 35 | Train Loss: 1.401 Vali Loss: 5.245 Vali Acc: 0.510 Test Loss: 5.245 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2288200855255127
Epoch: 8, Steps: 35 | Train Loss: 1.325 Vali Loss: 1.878 Vali Acc: 0.500 Test Loss: 1.878 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.276684522628784
Epoch: 9, Steps: 35 | Train Loss: 0.873 Vali Loss: 2.059 Vali Acc: 0.470 Test Loss: 2.059 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.327442169189453
Epoch: 10, Steps: 35 | Train Loss: 1.860 Vali Loss: 3.710 Vali Acc: 0.480 Test Loss: 3.710 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.227724552154541
Epoch: 11, Steps: 35 | Train Loss: 1.591 Vali Loss: 2.693 Vali Acc: 0.550 Test Loss: 2.693 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.125391721725464
Epoch: 12, Steps: 35 | Train Loss: 0.918 Vali Loss: 2.296 Vali Acc: 0.530 Test Loss: 2.296 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 270482
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.276660203933716
Epoch: 1, Steps: 35 | Train Loss: 1.128 Vali Loss: 1.244 Vali Acc: 0.390 Test Loss: 1.244 Test Acc: 0.390
Validation loss decreased (inf --> -0.389988).  Saving model ...
Epoch: 2 cost time: 2.4999547004699707
Epoch: 2, Steps: 35 | Train Loss: 1.053 Vali Loss: 1.125 Vali Acc: 0.490 Test Loss: 1.125 Test Acc: 0.490
Validation loss decreased (-0.389988 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 2.5229804515838623
Epoch: 3, Steps: 35 | Train Loss: 1.348 Vali Loss: 1.731 Vali Acc: 0.440 Test Loss: 1.731 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3565120697021484
Epoch: 4, Steps: 35 | Train Loss: 0.868 Vali Loss: 2.022 Vali Acc: 0.460 Test Loss: 2.022 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3224427700042725
Epoch: 5, Steps: 35 | Train Loss: 1.519 Vali Loss: 1.622 Vali Acc: 0.490 Test Loss: 1.622 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.280069351196289
Epoch: 6, Steps: 35 | Train Loss: 1.258 Vali Loss: 4.113 Vali Acc: 0.500 Test Loss: 4.113 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499959).  Saving model ...
Epoch: 7 cost time: 2.305194139480591
Epoch: 7, Steps: 35 | Train Loss: 1.261 Vali Loss: 3.137 Vali Acc: 0.540 Test Loss: 3.137 Test Acc: 0.540
Validation loss decreased (-0.499959 --> -0.539969).  Saving model ...
Epoch: 8 cost time: 2.389134645462036
Epoch: 8, Steps: 35 | Train Loss: 1.268 Vali Loss: 1.988 Vali Acc: 0.500 Test Loss: 1.988 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.543325424194336
Epoch: 9, Steps: 35 | Train Loss: 1.362 Vali Loss: 1.544 Vali Acc: 0.510 Test Loss: 1.544 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.617798328399658
Epoch: 10, Steps: 35 | Train Loss: 0.844 Vali Loss: 2.074 Vali Acc: 0.480 Test Loss: 2.074 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8055689334869385
Epoch: 11, Steps: 35 | Train Loss: 1.216 Vali Loss: 2.183 Vali Acc: 0.480 Test Loss: 2.183 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.775526523590088
Epoch: 12, Steps: 35 | Train Loss: 1.417 Vali Loss: 3.837 Vali Acc: 0.510 Test Loss: 3.837 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6724319458007812
Epoch: 13, Steps: 35 | Train Loss: 1.319 Vali Loss: 3.663 Vali Acc: 0.530 Test Loss: 3.663 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6565487384796143
Epoch: 14, Steps: 35 | Train Loss: 1.267 Vali Loss: 4.997 Vali Acc: 0.470 Test Loss: 4.997 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8162128925323486
Epoch: 15, Steps: 35 | Train Loss: 0.679 Vali Loss: 3.153 Vali Acc: 0.510 Test Loss: 3.153 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5126583576202393
Epoch: 16, Steps: 35 | Train Loss: 1.138 Vali Loss: 4.038 Vali Acc: 0.460 Test Loss: 4.038 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5261147022247314
Epoch: 17, Steps: 35 | Train Loss: 1.310 Vali Loss: 4.778 Vali Acc: 0.510 Test Loss: 4.778 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 270482
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.005734205245972
Epoch: 1, Steps: 35 | Train Loss: 1.081 Vali Loss: 1.523 Vali Acc: 0.390 Test Loss: 1.523 Test Acc: 0.390
Validation loss decreased (inf --> -0.389985).  Saving model ...
Epoch: 2 cost time: 2.2537641525268555
Epoch: 2, Steps: 35 | Train Loss: 1.140 Vali Loss: 0.889 Vali Acc: 0.580 Test Loss: 0.889 Test Acc: 0.580
Validation loss decreased (-0.389985 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 2.321028232574463
Epoch: 3, Steps: 35 | Train Loss: 1.494 Vali Loss: 1.218 Vali Acc: 0.450 Test Loss: 1.218 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3512299060821533
Epoch: 4, Steps: 35 | Train Loss: 1.140 Vali Loss: 1.485 Vali Acc: 0.480 Test Loss: 1.485 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0529820919036865
Epoch: 5, Steps: 35 | Train Loss: 1.233 Vali Loss: 2.287 Vali Acc: 0.520 Test Loss: 2.287 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9973082542419434
Epoch: 6, Steps: 35 | Train Loss: 1.130 Vali Loss: 1.311 Vali Acc: 0.530 Test Loss: 1.311 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.207486152648926
Epoch: 7, Steps: 35 | Train Loss: 1.596 Vali Loss: 3.807 Vali Acc: 0.490 Test Loss: 3.807 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.103039264678955
Epoch: 8, Steps: 35 | Train Loss: 1.846 Vali Loss: 1.689 Vali Acc: 0.560 Test Loss: 1.689 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9827299118041992
Epoch: 9, Steps: 35 | Train Loss: 1.135 Vali Loss: 1.541 Vali Acc: 0.530 Test Loss: 1.541 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9228055477142334
Epoch: 10, Steps: 35 | Train Loss: 1.283 Vali Loss: 2.652 Vali Acc: 0.530 Test Loss: 2.652 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8489599227905273
Epoch: 11, Steps: 35 | Train Loss: 1.645 Vali Loss: 4.038 Vali Acc: 0.530 Test Loss: 4.038 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.068105697631836
Epoch: 12, Steps: 35 | Train Loss: 1.686 Vali Loss: 3.699 Vali Acc: 0.510 Test Loss: 3.699 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 270482
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.265759468078613
Epoch: 1, Steps: 35 | Train Loss: 0.984 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.104790210723877
Epoch: 2, Steps: 35 | Train Loss: 0.994 Vali Loss: 1.767 Vali Acc: 0.520 Test Loss: 1.767 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3408002853393555
Epoch: 3, Steps: 35 | Train Loss: 1.022 Vali Loss: 1.233 Vali Acc: 0.530 Test Loss: 1.233 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.092172622680664
Epoch: 4, Steps: 35 | Train Loss: 0.904 Vali Loss: 1.742 Vali Acc: 0.510 Test Loss: 1.742 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.171759605407715
Epoch: 5, Steps: 35 | Train Loss: 1.190 Vali Loss: 1.528 Vali Acc: 0.460 Test Loss: 1.528 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.261779546737671
Epoch: 6, Steps: 35 | Train Loss: 1.368 Vali Loss: 5.597 Vali Acc: 0.490 Test Loss: 5.597 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2576966285705566
Epoch: 7, Steps: 35 | Train Loss: 1.207 Vali Loss: 3.317 Vali Acc: 0.510 Test Loss: 3.317 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1387312412261963
Epoch: 8, Steps: 35 | Train Loss: 1.509 Vali Loss: 4.037 Vali Acc: 0.520 Test Loss: 4.037 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.117483139038086
Epoch: 9, Steps: 35 | Train Loss: 1.518 Vali Loss: 3.828 Vali Acc: 0.500 Test Loss: 3.828 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1399853229522705
Epoch: 10, Steps: 35 | Train Loss: 0.798 Vali Loss: 2.063 Vali Acc: 0.540 Test Loss: 2.063 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539979).  Saving model ...
Epoch: 11 cost time: 2.1506755352020264
Epoch: 11, Steps: 35 | Train Loss: 0.908 Vali Loss: 4.618 Vali Acc: 0.490 Test Loss: 4.618 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.089822769165039
Epoch: 12, Steps: 35 | Train Loss: 1.159 Vali Loss: 1.644 Vali Acc: 0.550 Test Loss: 1.644 Test Acc: 0.550
Validation loss decreased (-0.539979 --> -0.549984).  Saving model ...
Epoch: 13 cost time: 2.1534738540649414
Epoch: 13, Steps: 35 | Train Loss: 0.672 Vali Loss: 4.559 Vali Acc: 0.460 Test Loss: 4.559 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2097649574279785
Epoch: 14, Steps: 35 | Train Loss: 1.460 Vali Loss: 2.742 Vali Acc: 0.570 Test Loss: 2.742 Test Acc: 0.570
Validation loss decreased (-0.549984 --> -0.569973).  Saving model ...
Epoch: 15 cost time: 2.3356404304504395
Epoch: 15, Steps: 35 | Train Loss: 1.227 Vali Loss: 4.480 Vali Acc: 0.510 Test Loss: 4.480 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2922210693359375
Epoch: 16, Steps: 35 | Train Loss: 1.366 Vali Loss: 2.451 Vali Acc: 0.500 Test Loss: 2.451 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3864822387695312
Epoch: 17, Steps: 35 | Train Loss: 0.957 Vali Loss: 4.609 Vali Acc: 0.480 Test Loss: 4.609 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.545259714126587
Epoch: 18, Steps: 35 | Train Loss: 0.507 Vali Loss: 4.815 Vali Acc: 0.480 Test Loss: 4.815 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5551650524139404
Epoch: 19, Steps: 35 | Train Loss: 1.146 Vali Loss: 4.542 Vali Acc: 0.500 Test Loss: 4.542 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.14955735206604
Epoch: 20, Steps: 35 | Train Loss: 0.521 Vali Loss: 2.827 Vali Acc: 0.560 Test Loss: 2.827 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2499377727508545
Epoch: 21, Steps: 35 | Train Loss: 0.641 Vali Loss: 3.014 Vali Acc: 0.540 Test Loss: 3.014 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.40035343170166
Epoch: 22, Steps: 35 | Train Loss: 0.300 Vali Loss: 4.429 Vali Acc: 0.500 Test Loss: 4.429 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0212438106536865
Epoch: 23, Steps: 35 | Train Loss: 1.451 Vali Loss: 9.102 Vali Acc: 0.460 Test Loss: 9.102 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1436049938201904
Epoch: 24, Steps: 35 | Train Loss: 0.365 Vali Loss: 5.077 Vali Acc: 0.460 Test Loss: 5.077 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 237714
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.54825758934021
Epoch: 1, Steps: 35 | Train Loss: 0.979 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.1796700954437256
Epoch: 2, Steps: 35 | Train Loss: 0.906 Vali Loss: 1.586 Vali Acc: 0.440 Test Loss: 1.586 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2069027423858643
Epoch: 3, Steps: 35 | Train Loss: 1.128 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0862679481506348
Epoch: 4, Steps: 35 | Train Loss: 1.816 Vali Loss: 3.296 Vali Acc: 0.490 Test Loss: 3.296 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3064401149749756
Epoch: 5, Steps: 35 | Train Loss: 1.356 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4627530574798584
Epoch: 6, Steps: 35 | Train Loss: 1.534 Vali Loss: 3.128 Vali Acc: 0.510 Test Loss: 3.128 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5309019088745117
Epoch: 7, Steps: 35 | Train Loss: 0.933 Vali Loss: 1.777 Vali Acc: 0.540 Test Loss: 1.777 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539982).  Saving model ...
Epoch: 8 cost time: 2.23260235786438
Epoch: 8, Steps: 35 | Train Loss: 0.920 Vali Loss: 1.989 Vali Acc: 0.490 Test Loss: 1.989 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1045584678649902
Epoch: 9, Steps: 35 | Train Loss: 1.675 Vali Loss: 3.552 Vali Acc: 0.490 Test Loss: 3.552 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2057037353515625
Epoch: 10, Steps: 35 | Train Loss: 0.789 Vali Loss: 2.045 Vali Acc: 0.510 Test Loss: 2.045 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0888867378234863
Epoch: 11, Steps: 35 | Train Loss: 0.945 Vali Loss: 4.273 Vali Acc: 0.530 Test Loss: 4.273 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.024702787399292
Epoch: 12, Steps: 35 | Train Loss: 1.115 Vali Loss: 1.972 Vali Acc: 0.510 Test Loss: 1.972 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.997169017791748
Epoch: 13, Steps: 35 | Train Loss: 1.031 Vali Loss: 5.877 Vali Acc: 0.410 Test Loss: 5.877 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.284119129180908
Epoch: 14, Steps: 35 | Train Loss: 1.038 Vali Loss: 3.839 Vali Acc: 0.510 Test Loss: 3.839 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.401104688644409
Epoch: 15, Steps: 35 | Train Loss: 1.617 Vali Loss: 3.576 Vali Acc: 0.550 Test Loss: 3.576 Test Acc: 0.550
Validation loss decreased (-0.539982 --> -0.549964).  Saving model ...
Epoch: 16 cost time: 2.3635900020599365
Epoch: 16, Steps: 35 | Train Loss: 0.599 Vali Loss: 6.636 Vali Acc: 0.490 Test Loss: 6.636 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.335477828979492
Epoch: 17, Steps: 35 | Train Loss: 0.670 Vali Loss: 7.300 Vali Acc: 0.500 Test Loss: 7.300 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.582058906555176
Epoch: 18, Steps: 35 | Train Loss: 0.944 Vali Loss: 7.567 Vali Acc: 0.500 Test Loss: 7.567 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.572711229324341
Epoch: 19, Steps: 35 | Train Loss: 0.785 Vali Loss: 6.725 Vali Acc: 0.490 Test Loss: 6.725 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2562336921691895
Epoch: 20, Steps: 35 | Train Loss: 0.868 Vali Loss: 8.021 Vali Acc: 0.510 Test Loss: 8.021 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6001360416412354
Epoch: 21, Steps: 35 | Train Loss: 0.660 Vali Loss: 6.426 Vali Acc: 0.500 Test Loss: 6.426 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.26476788520813
Epoch: 22, Steps: 35 | Train Loss: 1.226 Vali Loss: 4.991 Vali Acc: 0.490 Test Loss: 4.991 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0186522006988525
Epoch: 23, Steps: 35 | Train Loss: 0.748 Vali Loss: 7.757 Vali Acc: 0.470 Test Loss: 7.757 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.067625045776367
Epoch: 24, Steps: 35 | Train Loss: 1.275 Vali Loss: 9.925 Vali Acc: 0.540 Test Loss: 9.925 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1816368103027344
Epoch: 25, Steps: 35 | Train Loss: 1.117 Vali Loss: 8.946 Vali Acc: 0.530 Test Loss: 8.946 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 237714
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.058657646179199
Epoch: 1, Steps: 35 | Train Loss: 0.948 Vali Loss: 0.825 Vali Acc: 0.530 Test Loss: 0.825 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.1851937770843506
Epoch: 2, Steps: 35 | Train Loss: 0.869 Vali Loss: 1.368 Vali Acc: 0.460 Test Loss: 1.368 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.198054075241089
Epoch: 3, Steps: 35 | Train Loss: 1.131 Vali Loss: 1.779 Vali Acc: 0.490 Test Loss: 1.779 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3190560340881348
Epoch: 4, Steps: 35 | Train Loss: 0.896 Vali Loss: 1.662 Vali Acc: 0.500 Test Loss: 1.662 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4505765438079834
Epoch: 5, Steps: 35 | Train Loss: 1.033 Vali Loss: 1.300 Vali Acc: 0.510 Test Loss: 1.300 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.276493549346924
Epoch: 6, Steps: 35 | Train Loss: 1.038 Vali Loss: 3.108 Vali Acc: 0.440 Test Loss: 3.108 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.184518337249756
Epoch: 7, Steps: 35 | Train Loss: 1.249 Vali Loss: 2.050 Vali Acc: 0.480 Test Loss: 2.050 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9668290615081787
Epoch: 8, Steps: 35 | Train Loss: 1.371 Vali Loss: 2.402 Vali Acc: 0.490 Test Loss: 2.402 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0830349922180176
Epoch: 9, Steps: 35 | Train Loss: 1.315 Vali Loss: 2.261 Vali Acc: 0.480 Test Loss: 2.261 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0712499618530273
Epoch: 10, Steps: 35 | Train Loss: 1.054 Vali Loss: 2.198 Vali Acc: 0.530 Test Loss: 2.198 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.058530569076538
Epoch: 11, Steps: 35 | Train Loss: 0.884 Vali Loss: 6.076 Vali Acc: 0.500 Test Loss: 6.076 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 237714
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.13996148109436
Epoch: 1, Steps: 35 | Train Loss: 0.915 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.3633856773376465
Epoch: 2, Steps: 35 | Train Loss: 1.009 Vali Loss: 1.457 Vali Acc: 0.530 Test Loss: 1.457 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529985).  Saving model ...
Epoch: 3 cost time: 2.34543776512146
Epoch: 3, Steps: 35 | Train Loss: 1.090 Vali Loss: 1.242 Vali Acc: 0.460 Test Loss: 1.242 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3497395515441895
Epoch: 4, Steps: 35 | Train Loss: 1.473 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.271681308746338
Epoch: 5, Steps: 35 | Train Loss: 1.014 Vali Loss: 1.141 Vali Acc: 0.530 Test Loss: 1.141 Test Acc: 0.530
Validation loss decreased (-0.529985 --> -0.529989).  Saving model ...
Epoch: 6 cost time: 2.3021299839019775
Epoch: 6, Steps: 35 | Train Loss: 1.388 Vali Loss: 2.359 Vali Acc: 0.420 Test Loss: 2.359 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2008213996887207
Epoch: 7, Steps: 35 | Train Loss: 1.240 Vali Loss: 1.371 Vali Acc: 0.510 Test Loss: 1.371 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2209460735321045
Epoch: 8, Steps: 35 | Train Loss: 1.250 Vali Loss: 1.545 Vali Acc: 0.510 Test Loss: 1.545 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.217095136642456
Epoch: 9, Steps: 35 | Train Loss: 1.093 Vali Loss: 1.707 Vali Acc: 0.510 Test Loss: 1.707 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.517245054244995
Epoch: 10, Steps: 35 | Train Loss: 1.344 Vali Loss: 2.701 Vali Acc: 0.520 Test Loss: 2.701 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4649300575256348
Epoch: 11, Steps: 35 | Train Loss: 1.109 Vali Loss: 3.278 Vali Acc: 0.500 Test Loss: 3.278 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5766305923461914
Epoch: 12, Steps: 35 | Train Loss: 1.881 Vali Loss: 3.463 Vali Acc: 0.470 Test Loss: 3.463 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4779438972473145
Epoch: 13, Steps: 35 | Train Loss: 1.560 Vali Loss: 2.446 Vali Acc: 0.440 Test Loss: 2.446 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5519297122955322
Epoch: 14, Steps: 35 | Train Loss: 1.388 Vali Loss: 2.033 Vali Acc: 0.510 Test Loss: 2.033 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6536405086517334
Epoch: 15, Steps: 35 | Train Loss: 1.291 Vali Loss: 1.650 Vali Acc: 0.460 Test Loss: 1.650 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 237714
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.088974952697754
Epoch: 1, Steps: 35 | Train Loss: 0.974 Vali Loss: 0.785 Vali Acc: 0.580 Test Loss: 0.785 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 2.0274906158447266
Epoch: 2, Steps: 35 | Train Loss: 1.228 Vali Loss: 1.486 Vali Acc: 0.520 Test Loss: 1.486 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.056105136871338
Epoch: 3, Steps: 35 | Train Loss: 1.004 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1699743270874023
Epoch: 4, Steps: 35 | Train Loss: 1.163 Vali Loss: 1.993 Vali Acc: 0.550 Test Loss: 1.993 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2710580825805664
Epoch: 5, Steps: 35 | Train Loss: 0.945 Vali Loss: 2.361 Vali Acc: 0.530 Test Loss: 2.361 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3823697566986084
Epoch: 6, Steps: 35 | Train Loss: 0.995 Vali Loss: 1.211 Vali Acc: 0.560 Test Loss: 1.211 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.291344165802002
Epoch: 7, Steps: 35 | Train Loss: 0.814 Vali Loss: 2.274 Vali Acc: 0.500 Test Loss: 2.274 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2556779384613037
Epoch: 8, Steps: 35 | Train Loss: 0.930 Vali Loss: 1.595 Vali Acc: 0.500 Test Loss: 1.595 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.199747323989868
Epoch: 9, Steps: 35 | Train Loss: 1.286 Vali Loss: 2.125 Vali Acc: 0.520 Test Loss: 2.125 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.343771457672119
Epoch: 10, Steps: 35 | Train Loss: 0.652 Vali Loss: 1.729 Vali Acc: 0.540 Test Loss: 1.729 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2410731315612793
Epoch: 11, Steps: 35 | Train Loss: 2.488 Vali Loss: 2.202 Vali Acc: 0.500 Test Loss: 2.202 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 221330
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9071500301361084
Epoch: 1, Steps: 35 | Train Loss: 0.988 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.026893138885498
Epoch: 2, Steps: 35 | Train Loss: 1.229 Vali Loss: 1.728 Vali Acc: 0.470 Test Loss: 1.728 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1229331493377686
Epoch: 3, Steps: 35 | Train Loss: 1.244 Vali Loss: 1.788 Vali Acc: 0.510 Test Loss: 1.788 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1585605144500732
Epoch: 4, Steps: 35 | Train Loss: 1.740 Vali Loss: 2.703 Vali Acc: 0.460 Test Loss: 2.703 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1306235790252686
Epoch: 5, Steps: 35 | Train Loss: 1.166 Vali Loss: 2.082 Vali Acc: 0.530 Test Loss: 2.082 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3561415672302246
Epoch: 6, Steps: 35 | Train Loss: 1.028 Vali Loss: 2.356 Vali Acc: 0.430 Test Loss: 2.356 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3110785484313965
Epoch: 7, Steps: 35 | Train Loss: 1.105 Vali Loss: 2.991 Vali Acc: 0.480 Test Loss: 2.991 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.092557191848755
Epoch: 8, Steps: 35 | Train Loss: 0.951 Vali Loss: 1.411 Vali Acc: 0.550 Test Loss: 1.411 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549986).  Saving model ...
Epoch: 9 cost time: 2.2778806686401367
Epoch: 9, Steps: 35 | Train Loss: 1.802 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.186047077178955
Epoch: 10, Steps: 35 | Train Loss: 1.119 Vali Loss: 3.118 Vali Acc: 0.480 Test Loss: 3.118 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2437050342559814
Epoch: 11, Steps: 35 | Train Loss: 1.858 Vali Loss: 2.517 Vali Acc: 0.520 Test Loss: 2.517 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1514933109283447
Epoch: 12, Steps: 35 | Train Loss: 0.836 Vali Loss: 4.512 Vali Acc: 0.510 Test Loss: 4.512 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1203699111938477
Epoch: 13, Steps: 35 | Train Loss: 1.140 Vali Loss: 3.046 Vali Acc: 0.480 Test Loss: 3.046 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.930011510848999
Epoch: 14, Steps: 35 | Train Loss: 0.963 Vali Loss: 5.626 Vali Acc: 0.520 Test Loss: 5.626 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0783560276031494
Epoch: 15, Steps: 35 | Train Loss: 0.771 Vali Loss: 3.070 Vali Acc: 0.540 Test Loss: 3.070 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.021374225616455
Epoch: 16, Steps: 35 | Train Loss: 0.602 Vali Loss: 4.821 Vali Acc: 0.470 Test Loss: 4.821 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1030514240264893
Epoch: 17, Steps: 35 | Train Loss: 1.243 Vali Loss: 5.058 Vali Acc: 0.490 Test Loss: 5.058 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1749322414398193
Epoch: 18, Steps: 35 | Train Loss: 1.017 Vali Loss: 4.783 Vali Acc: 0.500 Test Loss: 4.783 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 221330
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.167295217514038
Epoch: 1, Steps: 35 | Train Loss: 0.938 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.17804217338562
Epoch: 2, Steps: 35 | Train Loss: 1.144 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.113670587539673
Epoch: 3, Steps: 35 | Train Loss: 1.079 Vali Loss: 1.380 Vali Acc: 0.460 Test Loss: 1.380 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0653698444366455
Epoch: 4, Steps: 35 | Train Loss: 0.994 Vali Loss: 3.723 Vali Acc: 0.510 Test Loss: 3.723 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.967108964920044
Epoch: 5, Steps: 35 | Train Loss: 1.099 Vali Loss: 2.477 Vali Acc: 0.560 Test Loss: 2.477 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559975).  Saving model ...
Epoch: 6 cost time: 1.9788527488708496
Epoch: 6, Steps: 35 | Train Loss: 1.167 Vali Loss: 2.730 Vali Acc: 0.520 Test Loss: 2.730 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9588723182678223
Epoch: 7, Steps: 35 | Train Loss: 0.959 Vali Loss: 4.115 Vali Acc: 0.470 Test Loss: 4.115 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9648830890655518
Epoch: 8, Steps: 35 | Train Loss: 1.096 Vali Loss: 1.469 Vali Acc: 0.520 Test Loss: 1.469 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9878830909729004
Epoch: 9, Steps: 35 | Train Loss: 1.224 Vali Loss: 2.892 Vali Acc: 0.490 Test Loss: 2.892 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0195698738098145
Epoch: 10, Steps: 35 | Train Loss: 0.907 Vali Loss: 2.359 Vali Acc: 0.490 Test Loss: 2.359 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.145840883255005
Epoch: 11, Steps: 35 | Train Loss: 0.985 Vali Loss: 2.092 Vali Acc: 0.450 Test Loss: 2.092 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0135722160339355
Epoch: 12, Steps: 35 | Train Loss: 0.907 Vali Loss: 4.139 Vali Acc: 0.530 Test Loss: 4.139 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0972402095794678
Epoch: 13, Steps: 35 | Train Loss: 0.862 Vali Loss: 4.296 Vali Acc: 0.560 Test Loss: 4.296 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0232481956481934
Epoch: 14, Steps: 35 | Train Loss: 0.920 Vali Loss: 3.425 Vali Acc: 0.490 Test Loss: 3.425 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1233253479003906
Epoch: 15, Steps: 35 | Train Loss: 1.097 Vali Loss: 4.385 Vali Acc: 0.500 Test Loss: 4.385 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 221330
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.6363301277160645
Epoch: 1, Steps: 35 | Train Loss: 0.940 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.12728214263916
Epoch: 2, Steps: 35 | Train Loss: 1.055 Vali Loss: 1.176 Vali Acc: 0.470 Test Loss: 1.176 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.051345109939575
Epoch: 3, Steps: 35 | Train Loss: 0.960 Vali Loss: 1.595 Vali Acc: 0.460 Test Loss: 1.595 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0600881576538086
Epoch: 4, Steps: 35 | Train Loss: 1.162 Vali Loss: 1.493 Vali Acc: 0.460 Test Loss: 1.493 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1850414276123047
Epoch: 5, Steps: 35 | Train Loss: 1.123 Vali Loss: 1.843 Vali Acc: 0.540 Test Loss: 1.843 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539982).  Saving model ...
Epoch: 6 cost time: 2.02936053276062
Epoch: 6, Steps: 35 | Train Loss: 1.085 Vali Loss: 2.223 Vali Acc: 0.500 Test Loss: 2.223 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2379233837127686
Epoch: 7, Steps: 35 | Train Loss: 1.261 Vali Loss: 3.629 Vali Acc: 0.500 Test Loss: 3.629 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1724343299865723
Epoch: 8, Steps: 35 | Train Loss: 1.360 Vali Loss: 2.054 Vali Acc: 0.510 Test Loss: 2.054 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1938931941986084
Epoch: 9, Steps: 35 | Train Loss: 1.218 Vali Loss: 2.008 Vali Acc: 0.540 Test Loss: 2.008 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3497474193573
Epoch: 10, Steps: 35 | Train Loss: 1.073 Vali Loss: 2.268 Vali Acc: 0.520 Test Loss: 2.268 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.379972219467163
Epoch: 11, Steps: 35 | Train Loss: 0.848 Vali Loss: 1.715 Vali Acc: 0.590 Test Loss: 1.715 Test Acc: 0.590
Validation loss decreased (-0.539982 --> -0.589983).  Saving model ...
Epoch: 12 cost time: 2.3985531330108643
Epoch: 12, Steps: 35 | Train Loss: 1.099 Vali Loss: 2.161 Vali Acc: 0.570 Test Loss: 2.161 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3331644535064697
Epoch: 13, Steps: 35 | Train Loss: 1.243 Vali Loss: 2.987 Vali Acc: 0.470 Test Loss: 2.987 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3359789848327637
Epoch: 14, Steps: 35 | Train Loss: 1.579 Vali Loss: 2.795 Vali Acc: 0.570 Test Loss: 2.795 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.007235527038574
Epoch: 15, Steps: 35 | Train Loss: 1.010 Vali Loss: 2.636 Vali Acc: 0.530 Test Loss: 2.636 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.065197467803955
Epoch: 16, Steps: 35 | Train Loss: 0.980 Vali Loss: 3.800 Vali Acc: 0.490 Test Loss: 3.800 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1182684898376465
Epoch: 17, Steps: 35 | Train Loss: 1.428 Vali Loss: 2.891 Vali Acc: 0.470 Test Loss: 2.891 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9940593242645264
Epoch: 18, Steps: 35 | Train Loss: 1.395 Vali Loss: 4.664 Vali Acc: 0.450 Test Loss: 4.664 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.121037483215332
Epoch: 19, Steps: 35 | Train Loss: 1.343 Vali Loss: 2.366 Vali Acc: 0.470 Test Loss: 2.366 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.238027811050415
Epoch: 20, Steps: 35 | Train Loss: 1.022 Vali Loss: 2.762 Vali Acc: 0.450 Test Loss: 2.762 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4061691761016846
Epoch: 21, Steps: 35 | Train Loss: 1.814 Vali Loss: 3.607 Vali Acc: 0.510 Test Loss: 3.607 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 221330
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.265763282775879
Epoch: 1, Steps: 35 | Train Loss: 0.893 Vali Loss: 1.546 Vali Acc: 0.480 Test Loss: 1.546 Test Acc: 0.480
Validation loss decreased (inf --> -0.479985).  Saving model ...
Epoch: 2 cost time: 2.1419970989227295
Epoch: 2, Steps: 35 | Train Loss: 1.009 Vali Loss: 1.217 Vali Acc: 0.470 Test Loss: 1.217 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.112258195877075
Epoch: 3, Steps: 35 | Train Loss: 0.935 Vali Loss: 1.616 Vali Acc: 0.510 Test Loss: 1.616 Test Acc: 0.510
Validation loss decreased (-0.479985 --> -0.509984).  Saving model ...
Epoch: 4 cost time: 1.971423864364624
Epoch: 4, Steps: 35 | Train Loss: 1.040 Vali Loss: 2.649 Vali Acc: 0.510 Test Loss: 2.649 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.006807327270508
Epoch: 5, Steps: 35 | Train Loss: 0.961 Vali Loss: 4.162 Vali Acc: 0.500 Test Loss: 4.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9481112957000732
Epoch: 6, Steps: 35 | Train Loss: 1.233 Vali Loss: 1.993 Vali Acc: 0.490 Test Loss: 1.993 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.203207015991211
Epoch: 7, Steps: 35 | Train Loss: 0.858 Vali Loss: 3.024 Vali Acc: 0.490 Test Loss: 3.024 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9452733993530273
Epoch: 8, Steps: 35 | Train Loss: 0.672 Vali Loss: 2.648 Vali Acc: 0.520 Test Loss: 2.648 Test Acc: 0.520
Validation loss decreased (-0.509984 --> -0.519974).  Saving model ...
Epoch: 9 cost time: 2.1637065410614014
Epoch: 9, Steps: 35 | Train Loss: 1.126 Vali Loss: 2.080 Vali Acc: 0.530 Test Loss: 2.080 Test Acc: 0.530
Validation loss decreased (-0.519974 --> -0.529979).  Saving model ...
Epoch: 10 cost time: 2.099552869796753
Epoch: 10, Steps: 35 | Train Loss: 1.010 Vali Loss: 1.964 Vali Acc: 0.570 Test Loss: 1.964 Test Acc: 0.570
Validation loss decreased (-0.529979 --> -0.569980).  Saving model ...
Epoch: 11 cost time: 2.2087907791137695
Epoch: 11, Steps: 35 | Train Loss: 0.894 Vali Loss: 3.215 Vali Acc: 0.480 Test Loss: 3.215 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0225937366485596
Epoch: 12, Steps: 35 | Train Loss: 1.266 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.195211172103882
Epoch: 13, Steps: 35 | Train Loss: 0.890 Vali Loss: 2.006 Vali Acc: 0.510 Test Loss: 2.006 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.029731035232544
Epoch: 14, Steps: 35 | Train Loss: 0.716 Vali Loss: 2.730 Vali Acc: 0.510 Test Loss: 2.730 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0716826915740967
Epoch: 15, Steps: 35 | Train Loss: 0.495 Vali Loss: 3.673 Vali Acc: 0.550 Test Loss: 3.673 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.321793794631958
Epoch: 16, Steps: 35 | Train Loss: 1.292 Vali Loss: 4.517 Vali Acc: 0.510 Test Loss: 4.517 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3487560749053955
Epoch: 17, Steps: 35 | Train Loss: 1.051 Vali Loss: 4.249 Vali Acc: 0.510 Test Loss: 4.249 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1252975463867188
Epoch: 18, Steps: 35 | Train Loss: 0.704 Vali Loss: 2.105 Vali Acc: 0.600 Test Loss: 2.105 Test Acc: 0.600
Validation loss decreased (-0.569980 --> -0.599979).  Saving model ...
Epoch: 19 cost time: 2.134795904159546
Epoch: 19, Steps: 35 | Train Loss: 0.821 Vali Loss: 3.777 Vali Acc: 0.520 Test Loss: 3.777 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0397377014160156
Epoch: 20, Steps: 35 | Train Loss: 0.762 Vali Loss: 4.321 Vali Acc: 0.540 Test Loss: 4.321 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.060030221939087
Epoch: 21, Steps: 35 | Train Loss: 1.070 Vali Loss: 3.465 Vali Acc: 0.510 Test Loss: 3.465 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9389762878417969
Epoch: 22, Steps: 35 | Train Loss: 0.463 Vali Loss: 3.693 Vali Acc: 0.550 Test Loss: 3.693 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0639514923095703
Epoch: 23, Steps: 35 | Train Loss: 0.973 Vali Loss: 4.812 Vali Acc: 0.550 Test Loss: 4.812 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1722185611724854
Epoch: 24, Steps: 35 | Train Loss: 1.031 Vali Loss: 4.556 Vali Acc: 0.500 Test Loss: 4.556 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.07222843170166
Epoch: 25, Steps: 35 | Train Loss: 0.468 Vali Loss: 4.121 Vali Acc: 0.530 Test Loss: 4.121 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2110342979431152
Epoch: 26, Steps: 35 | Train Loss: 0.562 Vali Loss: 5.229 Vali Acc: 0.540 Test Loss: 5.229 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1463003158569336
Epoch: 27, Steps: 35 | Train Loss: 0.420 Vali Loss: 9.705 Vali Acc: 0.480 Test Loss: 9.705 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.119385004043579
Epoch: 28, Steps: 35 | Train Loss: 0.802 Vali Loss: 4.421 Vali Acc: 0.480 Test Loss: 4.421 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 213138
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4421639442443848
Epoch: 1, Steps: 35 | Train Loss: 0.872 Vali Loss: 1.640 Vali Acc: 0.460 Test Loss: 1.640 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 1.727311611175537
Epoch: 2, Steps: 35 | Train Loss: 0.964 Vali Loss: 1.167 Vali Acc: 0.560 Test Loss: 1.167 Test Acc: 0.560
Validation loss decreased (-0.459984 --> -0.559988).  Saving model ...
Epoch: 3 cost time: 1.671032190322876
Epoch: 3, Steps: 35 | Train Loss: 0.869 Vali Loss: 1.459 Vali Acc: 0.530 Test Loss: 1.459 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8949928283691406
Epoch: 4, Steps: 35 | Train Loss: 0.785 Vali Loss: 1.460 Vali Acc: 0.410 Test Loss: 1.460 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.052564859390259
Epoch: 5, Steps: 35 | Train Loss: 1.090 Vali Loss: 1.875 Vali Acc: 0.600 Test Loss: 1.875 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599981).  Saving model ...
Epoch: 6 cost time: 2.1085011959075928
Epoch: 6, Steps: 35 | Train Loss: 1.534 Vali Loss: 4.325 Vali Acc: 0.500 Test Loss: 4.325 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0813345909118652
Epoch: 7, Steps: 35 | Train Loss: 1.024 Vali Loss: 2.667 Vali Acc: 0.460 Test Loss: 2.667 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0629377365112305
Epoch: 8, Steps: 35 | Train Loss: 1.056 Vali Loss: 3.424 Vali Acc: 0.540 Test Loss: 3.424 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.04695725440979
Epoch: 9, Steps: 35 | Train Loss: 2.072 Vali Loss: 2.220 Vali Acc: 0.520 Test Loss: 2.220 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0334184169769287
Epoch: 10, Steps: 35 | Train Loss: 1.211 Vali Loss: 7.643 Vali Acc: 0.470 Test Loss: 7.643 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0554187297821045
Epoch: 11, Steps: 35 | Train Loss: 1.752 Vali Loss: 3.344 Vali Acc: 0.530 Test Loss: 3.344 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0247931480407715
Epoch: 12, Steps: 35 | Train Loss: 1.432 Vali Loss: 5.112 Vali Acc: 0.500 Test Loss: 5.112 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.657390832901001
Epoch: 13, Steps: 35 | Train Loss: 0.806 Vali Loss: 3.012 Vali Acc: 0.570 Test Loss: 3.012 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8451175689697266
Epoch: 14, Steps: 35 | Train Loss: 1.149 Vali Loss: 3.550 Vali Acc: 0.530 Test Loss: 3.550 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7591607570648193
Epoch: 15, Steps: 35 | Train Loss: 0.684 Vali Loss: 5.036 Vali Acc: 0.540 Test Loss: 5.036 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 213138
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7014944553375244
Epoch: 1, Steps: 35 | Train Loss: 0.860 Vali Loss: 1.595 Vali Acc: 0.470 Test Loss: 1.595 Test Acc: 0.470
Validation loss decreased (inf --> -0.469984).  Saving model ...
Epoch: 2 cost time: 1.986553430557251
Epoch: 2, Steps: 35 | Train Loss: 1.038 Vali Loss: 1.214 Vali Acc: 0.620 Test Loss: 1.214 Test Acc: 0.620
Validation loss decreased (-0.469984 --> -0.619988).  Saving model ...
Epoch: 3 cost time: 1.9386861324310303
Epoch: 3, Steps: 35 | Train Loss: 0.900 Vali Loss: 1.204 Vali Acc: 0.490 Test Loss: 1.204 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9522814750671387
Epoch: 4, Steps: 35 | Train Loss: 1.072 Vali Loss: 2.999 Vali Acc: 0.520 Test Loss: 2.999 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.216033458709717
Epoch: 5, Steps: 35 | Train Loss: 1.013 Vali Loss: 1.338 Vali Acc: 0.570 Test Loss: 1.338 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.962369680404663
Epoch: 6, Steps: 35 | Train Loss: 1.422 Vali Loss: 2.234 Vali Acc: 0.450 Test Loss: 2.234 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9669644832611084
Epoch: 7, Steps: 35 | Train Loss: 1.703 Vali Loss: 2.119 Vali Acc: 0.410 Test Loss: 2.119 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.960035800933838
Epoch: 8, Steps: 35 | Train Loss: 0.905 Vali Loss: 2.955 Vali Acc: 0.470 Test Loss: 2.955 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9528920650482178
Epoch: 9, Steps: 35 | Train Loss: 0.975 Vali Loss: 2.697 Vali Acc: 0.440 Test Loss: 2.697 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.947373628616333
Epoch: 10, Steps: 35 | Train Loss: 1.419 Vali Loss: 2.752 Vali Acc: 0.500 Test Loss: 2.752 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8234734535217285
Epoch: 11, Steps: 35 | Train Loss: 1.682 Vali Loss: 3.294 Vali Acc: 0.460 Test Loss: 3.294 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9814589023590088
Epoch: 12, Steps: 35 | Train Loss: 1.126 Vali Loss: 4.454 Vali Acc: 0.500 Test Loss: 4.454 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 213138
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.170290470123291
Epoch: 1, Steps: 35 | Train Loss: 0.835 Vali Loss: 1.369 Vali Acc: 0.470 Test Loss: 1.369 Test Acc: 0.470
Validation loss decreased (inf --> -0.469986).  Saving model ...
Epoch: 2 cost time: 2.261699676513672
Epoch: 2, Steps: 35 | Train Loss: 0.925 Vali Loss: 1.239 Vali Acc: 0.650 Test Loss: 1.239 Test Acc: 0.650
Validation loss decreased (-0.469986 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 2.0027968883514404
Epoch: 3, Steps: 35 | Train Loss: 0.895 Vali Loss: 0.899 Vali Acc: 0.540 Test Loss: 0.899 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7975313663482666
Epoch: 4, Steps: 35 | Train Loss: 0.973 Vali Loss: 3.525 Vali Acc: 0.510 Test Loss: 3.525 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6896989345550537
Epoch: 5, Steps: 35 | Train Loss: 1.181 Vali Loss: 1.748 Vali Acc: 0.600 Test Loss: 1.748 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5811200141906738
Epoch: 6, Steps: 35 | Train Loss: 1.441 Vali Loss: 2.504 Vali Acc: 0.490 Test Loss: 2.504 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.87569260597229
Epoch: 7, Steps: 35 | Train Loss: 1.208 Vali Loss: 1.945 Vali Acc: 0.490 Test Loss: 1.945 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8708438873291016
Epoch: 8, Steps: 35 | Train Loss: 1.246 Vali Loss: 2.139 Vali Acc: 0.490 Test Loss: 2.139 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9517724514007568
Epoch: 9, Steps: 35 | Train Loss: 1.337 Vali Loss: 2.461 Vali Acc: 0.510 Test Loss: 2.461 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1307590007781982
Epoch: 10, Steps: 35 | Train Loss: 1.257 Vali Loss: 1.972 Vali Acc: 0.490 Test Loss: 1.972 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.332113742828369
Epoch: 11, Steps: 35 | Train Loss: 1.848 Vali Loss: 5.246 Vali Acc: 0.510 Test Loss: 5.246 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0190746784210205
Epoch: 12, Steps: 35 | Train Loss: 2.048 Vali Loss: 1.723 Vali Acc: 0.510 Test Loss: 1.723 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 213138
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.736912250518799
Epoch: 1, Steps: 35 | Train Loss: 0.943 Vali Loss: 1.888 Vali Acc: 0.490 Test Loss: 1.888 Test Acc: 0.490
Validation loss decreased (inf --> -0.489981).  Saving model ...
Epoch: 2 cost time: 1.8226947784423828
Epoch: 2, Steps: 35 | Train Loss: 1.356 Vali Loss: 1.169 Vali Acc: 0.510 Test Loss: 1.169 Test Acc: 0.510
Validation loss decreased (-0.489981 --> -0.509988).  Saving model ...
Epoch: 3 cost time: 1.8864030838012695
Epoch: 3, Steps: 35 | Train Loss: 1.437 Vali Loss: 1.763 Vali Acc: 0.490 Test Loss: 1.763 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2061407566070557
Epoch: 4, Steps: 35 | Train Loss: 1.375 Vali Loss: 2.039 Vali Acc: 0.530 Test Loss: 2.039 Test Acc: 0.530
Validation loss decreased (-0.509988 --> -0.529980).  Saving model ...
Epoch: 5 cost time: 2.3500936031341553
Epoch: 5, Steps: 35 | Train Loss: 1.094 Vali Loss: 1.388 Vali Acc: 0.530 Test Loss: 1.388 Test Acc: 0.530
Validation loss decreased (-0.529980 --> -0.529986).  Saving model ...
Epoch: 6 cost time: 2.3008995056152344
Epoch: 6, Steps: 35 | Train Loss: 1.016 Vali Loss: 2.148 Vali Acc: 0.550 Test Loss: 2.148 Test Acc: 0.550
Validation loss decreased (-0.529986 --> -0.549979).  Saving model ...
Epoch: 7 cost time: 2.2297537326812744
Epoch: 7, Steps: 35 | Train Loss: 0.964 Vali Loss: 2.136 Vali Acc: 0.560 Test Loss: 2.136 Test Acc: 0.560
Validation loss decreased (-0.549979 --> -0.559979).  Saving model ...
Epoch: 8 cost time: 2.2352123260498047
Epoch: 8, Steps: 35 | Train Loss: 0.870 Vali Loss: 3.534 Vali Acc: 0.530 Test Loss: 3.534 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.24236798286438
Epoch: 9, Steps: 35 | Train Loss: 1.077 Vali Loss: 3.279 Vali Acc: 0.570 Test Loss: 3.279 Test Acc: 0.570
Validation loss decreased (-0.559979 --> -0.569967).  Saving model ...
Epoch: 10 cost time: 2.235095262527466
Epoch: 10, Steps: 35 | Train Loss: 1.449 Vali Loss: 7.246 Vali Acc: 0.490 Test Loss: 7.246 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.23433780670166
Epoch: 11, Steps: 35 | Train Loss: 1.029 Vali Loss: 2.505 Vali Acc: 0.500 Test Loss: 2.505 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2156453132629395
Epoch: 12, Steps: 35 | Train Loss: 1.045 Vali Loss: 2.350 Vali Acc: 0.510 Test Loss: 2.350 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.968332290649414
Epoch: 13, Steps: 35 | Train Loss: 1.866 Vali Loss: 5.280 Vali Acc: 0.450 Test Loss: 5.280 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8967010974884033
Epoch: 14, Steps: 35 | Train Loss: 0.792 Vali Loss: 3.797 Vali Acc: 0.500 Test Loss: 3.797 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0660831928253174
Epoch: 15, Steps: 35 | Train Loss: 0.817 Vali Loss: 3.093 Vali Acc: 0.480 Test Loss: 3.093 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.099669933319092
Epoch: 16, Steps: 35 | Train Loss: 1.064 Vali Loss: 2.798 Vali Acc: 0.540 Test Loss: 2.798 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9421780109405518
Epoch: 17, Steps: 35 | Train Loss: 0.640 Vali Loss: 2.878 Vali Acc: 0.510 Test Loss: 2.878 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.136507272720337
Epoch: 18, Steps: 35 | Train Loss: 1.579 Vali Loss: 8.227 Vali Acc: 0.510 Test Loss: 8.227 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2715930938720703
Epoch: 19, Steps: 35 | Train Loss: 1.176 Vali Loss: 6.587 Vali Acc: 0.520 Test Loss: 6.587 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 209042
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8592541217803955
Epoch: 1, Steps: 35 | Train Loss: 0.959 Vali Loss: 1.775 Vali Acc: 0.480 Test Loss: 1.775 Test Acc: 0.480
Validation loss decreased (inf --> -0.479982).  Saving model ...
Epoch: 2 cost time: 2.118492603302002
Epoch: 2, Steps: 35 | Train Loss: 1.408 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
Validation loss decreased (-0.479982 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.8569920063018799
Epoch: 3, Steps: 35 | Train Loss: 1.342 Vali Loss: 1.675 Vali Acc: 0.530 Test Loss: 1.675 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9875283241271973
Epoch: 4, Steps: 35 | Train Loss: 1.335 Vali Loss: 1.914 Vali Acc: 0.510 Test Loss: 1.914 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0206778049468994
Epoch: 5, Steps: 35 | Train Loss: 1.257 Vali Loss: 1.609 Vali Acc: 0.530 Test Loss: 1.609 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9915876388549805
Epoch: 6, Steps: 35 | Train Loss: 1.227 Vali Loss: 2.331 Vali Acc: 0.480 Test Loss: 2.331 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1794607639312744
Epoch: 7, Steps: 35 | Train Loss: 1.176 Vali Loss: 2.063 Vali Acc: 0.520 Test Loss: 2.063 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1823065280914307
Epoch: 8, Steps: 35 | Train Loss: 1.358 Vali Loss: 2.096 Vali Acc: 0.470 Test Loss: 2.096 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1457505226135254
Epoch: 9, Steps: 35 | Train Loss: 1.078 Vali Loss: 2.626 Vali Acc: 0.540 Test Loss: 2.626 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9800598621368408
Epoch: 10, Steps: 35 | Train Loss: 1.333 Vali Loss: 1.929 Vali Acc: 0.490 Test Loss: 1.929 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9416048526763916
Epoch: 11, Steps: 35 | Train Loss: 0.847 Vali Loss: 3.704 Vali Acc: 0.450 Test Loss: 3.704 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.074049949645996
Epoch: 12, Steps: 35 | Train Loss: 1.543 Vali Loss: 3.480 Vali Acc: 0.460 Test Loss: 3.480 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 209042
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.883010149002075
Epoch: 1, Steps: 35 | Train Loss: 0.956 Vali Loss: 2.191 Vali Acc: 0.460 Test Loss: 2.191 Test Acc: 0.460
Validation loss decreased (inf --> -0.459978).  Saving model ...
Epoch: 2 cost time: 2.026978015899658
Epoch: 2, Steps: 35 | Train Loss: 1.224 Vali Loss: 2.187 Vali Acc: 0.530 Test Loss: 2.187 Test Acc: 0.530
Validation loss decreased (-0.459978 --> -0.529978).  Saving model ...
Epoch: 3 cost time: 2.1757190227508545
Epoch: 3, Steps: 35 | Train Loss: 1.249 Vali Loss: 1.924 Vali Acc: 0.510 Test Loss: 1.924 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9993269443511963
Epoch: 4, Steps: 35 | Train Loss: 1.502 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
Validation loss decreased (-0.529978 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 2.053297996520996
Epoch: 5, Steps: 35 | Train Loss: 1.353 Vali Loss: 2.640 Vali Acc: 0.520 Test Loss: 2.640 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2197272777557373
Epoch: 6, Steps: 35 | Train Loss: 1.879 Vali Loss: 2.250 Vali Acc: 0.420 Test Loss: 2.250 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.078226327896118
Epoch: 7, Steps: 35 | Train Loss: 1.271 Vali Loss: 1.781 Vali Acc: 0.450 Test Loss: 1.781 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2003021240234375
Epoch: 8, Steps: 35 | Train Loss: 1.094 Vali Loss: 2.201 Vali Acc: 0.430 Test Loss: 2.201 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.098447561264038
Epoch: 9, Steps: 35 | Train Loss: 1.225 Vali Loss: 3.063 Vali Acc: 0.540 Test Loss: 3.063 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1963582038879395
Epoch: 10, Steps: 35 | Train Loss: 1.412 Vali Loss: 2.465 Vali Acc: 0.560 Test Loss: 2.465 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559975).  Saving model ...
Epoch: 11 cost time: 2.0576727390289307
Epoch: 11, Steps: 35 | Train Loss: 1.461 Vali Loss: 5.026 Vali Acc: 0.470 Test Loss: 5.026 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9591779708862305
Epoch: 12, Steps: 35 | Train Loss: 1.880 Vali Loss: 3.981 Vali Acc: 0.470 Test Loss: 3.981 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8825535774230957
Epoch: 13, Steps: 35 | Train Loss: 1.556 Vali Loss: 4.292 Vali Acc: 0.490 Test Loss: 4.292 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7453691959381104
Epoch: 14, Steps: 35 | Train Loss: 1.438 Vali Loss: 3.088 Vali Acc: 0.530 Test Loss: 3.088 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8806288242340088
Epoch: 15, Steps: 35 | Train Loss: 1.501 Vali Loss: 6.445 Vali Acc: 0.460 Test Loss: 6.445 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9660985469818115
Epoch: 16, Steps: 35 | Train Loss: 2.159 Vali Loss: 3.287 Vali Acc: 0.540 Test Loss: 3.287 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.150582790374756
Epoch: 17, Steps: 35 | Train Loss: 0.720 Vali Loss: 3.652 Vali Acc: 0.510 Test Loss: 3.652 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1032767295837402
Epoch: 18, Steps: 35 | Train Loss: 1.545 Vali Loss: 6.181 Vali Acc: 0.480 Test Loss: 6.181 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9914319515228271
Epoch: 19, Steps: 35 | Train Loss: 1.130 Vali Loss: 4.297 Vali Acc: 0.480 Test Loss: 4.297 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.11487078666687
Epoch: 20, Steps: 35 | Train Loss: 2.008 Vali Loss: 3.129 Vali Acc: 0.510 Test Loss: 3.129 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 209042
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.3668160438537598
Epoch: 1, Steps: 35 | Train Loss: 1.069 Vali Loss: 1.682 Vali Acc: 0.500 Test Loss: 1.682 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 1.9756128787994385
Epoch: 2, Steps: 35 | Train Loss: 1.452 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 1.8907685279846191
Epoch: 3, Steps: 35 | Train Loss: 1.299 Vali Loss: 1.952 Vali Acc: 0.460 Test Loss: 1.952 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.054460287094116
Epoch: 4, Steps: 35 | Train Loss: 1.381 Vali Loss: 1.776 Vali Acc: 0.520 Test Loss: 1.776 Test Acc: 0.520
Validation loss decreased (-0.509990 --> -0.519982).  Saving model ...
Epoch: 5 cost time: 2.0134027004241943
Epoch: 5, Steps: 35 | Train Loss: 1.082 Vali Loss: 2.064 Vali Acc: 0.510 Test Loss: 2.064 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.18623685836792
Epoch: 6, Steps: 35 | Train Loss: 0.889 Vali Loss: 2.668 Vali Acc: 0.490 Test Loss: 2.668 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.023237466812134
Epoch: 7, Steps: 35 | Train Loss: 1.378 Vali Loss: 1.261 Vali Acc: 0.460 Test Loss: 1.261 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1424243450164795
Epoch: 8, Steps: 35 | Train Loss: 0.824 Vali Loss: 2.027 Vali Acc: 0.530 Test Loss: 2.027 Test Acc: 0.530
Validation loss decreased (-0.519982 --> -0.529980).  Saving model ...
Epoch: 9 cost time: 2.201279401779175
Epoch: 9, Steps: 35 | Train Loss: 0.860 Vali Loss: 1.777 Vali Acc: 0.530 Test Loss: 1.777 Test Acc: 0.530
Validation loss decreased (-0.529980 --> -0.529982).  Saving model ...
Epoch: 10 cost time: 2.3043367862701416
Epoch: 10, Steps: 35 | Train Loss: 1.134 Vali Loss: 4.607 Vali Acc: 0.490 Test Loss: 4.607 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9936203956604004
Epoch: 11, Steps: 35 | Train Loss: 1.325 Vali Loss: 2.180 Vali Acc: 0.430 Test Loss: 2.180 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0595526695251465
Epoch: 12, Steps: 35 | Train Loss: 2.374 Vali Loss: 3.558 Vali Acc: 0.480 Test Loss: 3.558 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.958847999572754
Epoch: 13, Steps: 35 | Train Loss: 1.410 Vali Loss: 2.322 Vali Acc: 0.490 Test Loss: 2.322 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8330774307250977
Epoch: 14, Steps: 35 | Train Loss: 1.097 Vali Loss: 3.079 Vali Acc: 0.500 Test Loss: 3.079 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9385483264923096
Epoch: 15, Steps: 35 | Train Loss: 1.298 Vali Loss: 2.448 Vali Acc: 0.450 Test Loss: 2.448 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8422834873199463
Epoch: 16, Steps: 35 | Train Loss: 1.110 Vali Loss: 1.927 Vali Acc: 0.510 Test Loss: 1.927 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9899218082427979
Epoch: 17, Steps: 35 | Train Loss: 1.399 Vali Loss: 5.583 Vali Acc: 0.500 Test Loss: 5.583 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2409963607788086
Epoch: 18, Steps: 35 | Train Loss: 1.366 Vali Loss: 2.722 Vali Acc: 0.520 Test Loss: 2.722 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.211766481399536
Epoch: 19, Steps: 35 | Train Loss: 1.141 Vali Loss: 3.492 Vali Acc: 0.460 Test Loss: 3.492 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_ETSformer_UEA_ftM_sl3000_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 209042
model size : 1.42MB
