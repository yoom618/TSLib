Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.965658187866211
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.121 Vali Acc: 0.420 Test Loss: 1.121 Test Acc: 0.420
Validation loss decreased (inf --> -0.420279).  Saving model ...
Epoch: 2 cost time: 1.9549620151519775
Epoch: 2, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.815 Vali Acc: 0.696 Test Loss: 0.815 Test Acc: 0.696
Validation loss decreased (-0.420279 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 2.2228150367736816
Epoch: 3, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
Validation loss decreased (-0.695644 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 2.1871721744537354
Epoch: 4, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8735394477844238
Epoch: 5, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 2.2238144874572754
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
Validation loss decreased (-0.818835 --> -0.862314).  Saving model ...
Epoch: 7 cost time: 2.390820026397705
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.428513765335083
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2528514862060547
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.862 Test Loss: 0.587 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.164705753326416
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.877 Test Loss: 0.574 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876806).  Saving model ...
Epoch: 11 cost time: 2.1577165126800537
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.870 Test Loss: 0.596 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.055999994277954
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.877 Test Loss: 0.614 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0837082862854004
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.862 Test Loss: 0.605 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.14613676071167
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.862 Test Loss: 0.625 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.893584966659546
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0187928676605225
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.862 Test Loss: 0.643 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8104157447814941
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.862 Test Loss: 0.657 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.216885805130005
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.848 Test Loss: 0.662 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.43772554397583
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.862 Test Loss: 0.663 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0485668182373047
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.862 Test Loss: 0.669 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 5685820
model size : 31.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.0935633182525635
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.101 Vali Acc: 0.507 Test Loss: 1.101 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 1.9291062355041504
Epoch: 2, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
Validation loss decreased (-0.507235 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 2.0398104190826416
Epoch: 3, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
Validation loss decreased (-0.731876 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 1.794318437576294
Epoch: 4, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8912065029144287
Epoch: 5, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.5654420852661133
Epoch: 6, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8362386226654053
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.848 Test Loss: 0.664 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847819).  Saving model ...
Epoch: 8 cost time: 1.6978485584259033
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.826 Test Loss: 0.698 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8009121417999268
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.165924549102783
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
Validation loss decreased (-0.847819 --> -0.847820).  Saving model ...
Epoch: 11 cost time: 2.2518181800842285
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.867330551147461
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.03902268409729
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0579464435577393
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.848 Test Loss: 0.633 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.056950330734253
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0279459953308105
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.848 Test Loss: 0.630 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.136723756790161
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.848 Test Loss: 0.641 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8029086589813232
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.848 Test Loss: 0.651 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8182666301727295
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.848 Test Loss: 0.649 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0307822227478027
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.848 Test Loss: 0.654 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 5685820
model size : 31.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.209446430206299
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.069 Vali Acc: 0.565 Test Loss: 1.069 Test Acc: 0.565
Validation loss decreased (inf --> -0.565207).  Saving model ...
Epoch: 2 cost time: 1.7536709308624268
Epoch: 2, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.733 Vali Acc: 0.754 Test Loss: 0.733 Test Acc: 0.754
Validation loss decreased (-0.565207 --> -0.753616).  Saving model ...
Epoch: 3 cost time: 1.9469149112701416
Epoch: 3, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.509 Vali Acc: 0.804 Test Loss: 0.509 Test Acc: 0.804
Validation loss decreased (-0.753616 --> -0.804343).  Saving model ...
Epoch: 4 cost time: 2.1351165771484375
Epoch: 4, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9346067905426025
Epoch: 5, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 1.561258316040039
Epoch: 6, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 2.23836350440979
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 2.2363672256469727
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.372638702392578
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 2.06193470954895
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.877 Test Loss: 0.533 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876806).  Saving model ...
Epoch: 11 cost time: 2.2388386726379395
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.862 Test Loss: 0.561 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1092422008514404
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.862 Test Loss: 0.584 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7085576057434082
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8656377792358398
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.855 Test Loss: 0.582 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6974375247955322
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.821366548538208
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.862 Test Loss: 0.572 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.795034646987915
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.862 Test Loss: 0.581 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9295203685760498
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.862 Test Loss: 0.588 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.862623929977417
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9953973293304443
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.862 Test Loss: 0.590 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 5685820
model size : 31.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.882437229156494
Epoch: 1, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.003 Vali Acc: 0.652 Test Loss: 1.003 Test Acc: 0.652
Validation loss decreased (inf --> -0.652164).  Saving model ...
Epoch: 2 cost time: 1.7366299629211426
Epoch: 2, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
Validation loss decreased (-0.652164 --> -0.818834).  Saving model ...
Epoch: 3 cost time: 1.7420964241027832
Epoch: 3, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4921865463256836
Epoch: 4, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.9692163467407227
Epoch: 5, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7471861839294434
Epoch: 6, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 1.5509943962097168
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4885494709014893
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5957868099212646
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7122211456298828
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0072689056396484
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 1.7909104824066162
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.6202154159545898
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 1.6517441272735596
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5345733165740967
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.862 Test Loss: 0.483 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6864221096038818
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8797979354858398
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6127314567565918
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5770926475524902
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5619206428527832
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6448993682861328
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7813990116119385
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6845736503601074
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 5685820
model size : 31.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.4966347217559814
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 2.3901422023773193
Epoch: 2, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.809 Vali Acc: 0.688 Test Loss: 0.809 Test Acc: 0.688
Validation loss decreased (-0.499989 --> -0.688398).  Saving model ...
Epoch: 3 cost time: 2.025498867034912
Epoch: 3, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
Validation loss decreased (-0.688398 --> -0.811588).  Saving model ...
Epoch: 4 cost time: 2.0858442783355713
Epoch: 4, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.632 Vali Acc: 0.855 Test Loss: 0.632 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855066).  Saving model ...
Epoch: 5 cost time: 1.818350076675415
Epoch: 5, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869560).  Saving model ...
Epoch: 6 cost time: 2.043423891067505
Epoch: 6, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7894842624664307
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6618244647979736
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.841 Test Loss: 0.698 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8498749732971191
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.826 Test Loss: 0.677 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7881920337677002
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8428318500518799
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8703346252441406
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.753845453262329
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.826 Test Loss: 0.753 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7935261726379395
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.826 Test Loss: 0.744 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8662528991699219
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 3588668
model size : 23.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.258101224899292
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.094 Vali Acc: 0.529 Test Loss: 1.094 Test Acc: 0.529
Validation loss decreased (inf --> -0.528975).  Saving model ...
Epoch: 2 cost time: 1.8109521865844727
Epoch: 2, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.795 Vali Acc: 0.725 Test Loss: 0.795 Test Acc: 0.725
Validation loss decreased (-0.528975 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 1.6236600875854492
Epoch: 3, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
Validation loss decreased (-0.724630 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 1.6427655220031738
Epoch: 4, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 1.8014652729034424
Epoch: 5, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 1.8175725936889648
Epoch: 6, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.705918550491333
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8356542587280273
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7254598140716553
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.848 Test Loss: 0.643 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8570365905761719
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.841 Test Loss: 0.666 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9001481533050537
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.833 Test Loss: 0.684 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9913008213043213
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8345675468444824
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.90714430809021
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0366268157958984
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3588668
model size : 23.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.436562538146973
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.072 Vali Acc: 0.543 Test Loss: 1.072 Test Acc: 0.543
Validation loss decreased (inf --> -0.543468).  Saving model ...
Epoch: 2 cost time: 1.682819128036499
Epoch: 2, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.750 Vali Acc: 0.725 Test Loss: 0.750 Test Acc: 0.725
Validation loss decreased (-0.543468 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 1.9176180362701416
Epoch: 3, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.724630 --> -0.818835).  Saving model ...
Epoch: 4 cost time: 1.9216411113739014
Epoch: 4, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 5 cost time: 2.333369493484497
Epoch: 5, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 2.2886574268341064
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 2.2352583408355713
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9072926044464111
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.848 Test Loss: 0.587 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8426032066345215
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.798219919204712
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.081862211227417
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.074159860610962
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.253584384918213
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2551722526550293
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.289130210876465
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4949684143066406
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 3588668
model size : 23.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.511531591415405
Epoch: 1, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.018 Vali Acc: 0.609 Test Loss: 1.018 Test Acc: 0.609
Validation loss decreased (inf --> -0.608685).  Saving model ...
Epoch: 2 cost time: 1.628269910812378
Epoch: 2, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
Validation loss decreased (-0.608685 --> -0.775356).  Saving model ...
Epoch: 3 cost time: 1.7542147636413574
Epoch: 3, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
Validation loss decreased (-0.775356 --> -0.855068).  Saving model ...
Epoch: 4 cost time: 1.6601178646087646
Epoch: 4, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7829456329345703
Epoch: 5, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 2.114056348800659
Epoch: 6, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 2.3457839488983154
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2750167846679688
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9237260818481445
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1853935718536377
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1404359340667725
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0106990337371826
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.855 Test Loss: 0.495 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.839341163635254
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.162525177001953
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.862 Test Loss: 0.507 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0905508995056152
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0793702602386475
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869560).  Saving model ...
Epoch: 17 cost time: 2.2626290321350098
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6600077152252197
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7842793464660645
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6308152675628662
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8600966930389404
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1871776580810547
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1898820400238037
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6325786113739014
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7381401062011719
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7038629055023193
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 3588668
model size : 23.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.007408380508423
Epoch: 1, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.039 Vali Acc: 0.616 Test Loss: 1.039 Test Acc: 0.616
Validation loss decreased (inf --> -0.615932).  Saving model ...
Epoch: 2 cost time: 2.047405958175659
Epoch: 2, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
Validation loss decreased (-0.615932 --> -0.746370).  Saving model ...
Epoch: 3 cost time: 1.953664779663086
Epoch: 3, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.804 Vali Acc: 0.768 Test Loss: 0.804 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768108).  Saving model ...
Epoch: 4 cost time: 2.0148847103118896
Epoch: 4, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.755 Vali Acc: 0.732 Test Loss: 0.755 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9432487487792969
Epoch: 5, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.799 Vali Acc: 0.768 Test Loss: 0.799 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768108).  Saving model ...
Epoch: 6 cost time: 2.4166598320007324
Epoch: 6, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 2.166900396347046
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.848 Test Loss: 0.652 Test Acc: 0.848
Validation loss decreased (-0.775355 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 2.3875575065612793
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0189566612243652
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0889742374420166
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.797 Test Loss: 0.772 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1534316539764404
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.804 Test Loss: 0.785 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.060117721557617
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.797 Test Loss: 0.806 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0081965923309326
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.797 Test Loss: 0.803 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9953985214233398
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.797 Test Loss: 0.796 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.225653886795044
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.804 Test Loss: 0.793 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2669074535369873
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.793 Vali Acc: 0.812 Test Loss: 0.793 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.998077630996704
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.812 Test Loss: 0.795 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 2540092
model size : 19.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.38536810874939
Epoch: 1, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.033 Vali Acc: 0.630 Test Loss: 1.033 Test Acc: 0.630
Validation loss decreased (inf --> -0.630424).  Saving model ...
Epoch: 2 cost time: 2.379040479660034
Epoch: 2, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.690 Vali Acc: 0.761 Test Loss: 0.690 Test Acc: 0.761
Validation loss decreased (-0.630424 --> -0.760863).  Saving model ...
Epoch: 3 cost time: 1.9410083293914795
Epoch: 3, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.761 Vali Acc: 0.768 Test Loss: 0.761 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768108).  Saving model ...
Epoch: 4 cost time: 1.9493043422698975
Epoch: 4, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.744 Vali Acc: 0.739 Test Loss: 0.744 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.027646541595459
Epoch: 5, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.917078971862793
Epoch: 6, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.756 Vali Acc: 0.768 Test Loss: 0.756 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.315608263015747
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.826 Test Loss: 0.647 Test Acc: 0.826
Validation loss decreased (-0.775355 --> -0.826080).  Saving model ...
Epoch: 8 cost time: 2.337244749069214
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3400745391845703
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.804 Test Loss: 0.740 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.631166458129883
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.797 Test Loss: 0.732 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.796971082687378
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.804 Test Loss: 0.744 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.140583038330078
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.804 Test Loss: 0.770 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1852266788482666
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.812 Test Loss: 0.775 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.08132266998291
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.804 Test Loss: 0.771 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0456161499023438
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1387557983398438
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.415203094482422
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 2540092
model size : 19.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.928499698638916
Epoch: 1, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.013 Vali Acc: 0.638 Test Loss: 1.013 Test Acc: 0.638
Validation loss decreased (inf --> -0.637671).  Saving model ...
Epoch: 2 cost time: 2.263727903366089
Epoch: 2, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
Validation loss decreased (-0.637671 --> -0.775356).  Saving model ...
Epoch: 3 cost time: 2.056072950363159
Epoch: 3, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.725 Vali Acc: 0.804 Test Loss: 0.725 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804341).  Saving model ...
Epoch: 4 cost time: 2.194469451904297
Epoch: 4, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.621 Vali Acc: 0.768 Test Loss: 0.621 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5083224773406982
Epoch: 5, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.684 Vali Acc: 0.812 Test Loss: 0.684 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 2.1451833248138428
Epoch: 6, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4183995723724365
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 1.8341097831726074
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9999468326568604
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1552083492279053
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.804 Test Loss: 0.642 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6683032512664795
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3478519916534424
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0730533599853516
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.826 Test Loss: 0.671 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0081892013549805
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0561676025390625
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1931681632995605
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4594578742980957
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 2540092
model size : 19.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.816687822341919
Epoch: 1, Steps: 9 | Train Loss: 1.272 Vali Loss: 0.975 Vali Acc: 0.688 Test Loss: 0.975 Test Acc: 0.688
Validation loss decreased (inf --> -0.688396).  Saving model ...
Epoch: 2 cost time: 2.5798823833465576
Epoch: 2, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
Validation loss decreased (-0.688396 --> -0.804342).  Saving model ...
Epoch: 3 cost time: 2.6479337215423584
Epoch: 3, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 2.1667661666870117
Epoch: 4, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 2.2153406143188477
Epoch: 5, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 2.1941046714782715
Epoch: 6, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7883026599884033
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8617100715637207
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.888416051864624
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.862 Test Loss: 0.554 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 1.96807861328125
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3907198905944824
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6889779567718506
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8373069763183594
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.855 Test Loss: 0.541 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9424116611480713
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.862 Test Loss: 0.540 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 15 cost time: 2.4495675563812256
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 2.5669355392456055
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2542672157287598
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 2.5916149616241455
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1775543689727783
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 2.211230993270874
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.870 Test Loss: 0.537 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.298058032989502
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 22 cost time: 2.367952823638916
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.15446400642395
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 24 cost time: 1.8947134017944336
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3478403091430664
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.877 Test Loss: 0.535 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 26 cost time: 1.900240421295166
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7604637145996094
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1844701766967773
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.957362174987793
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4690768718719482
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.6176865100860596
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.4056193828582764
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.018062114715576
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.877 Test Loss: 0.541 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.3688721656799316
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.884 Test Loss: 0.533 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 2.046814441680908
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.884 Test Loss: 0.534 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.034287691116333
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.884 Test Loss: 0.535 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.065250873565674
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.884 Test Loss: 0.538 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.184004545211792
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.884 Test Loss: 0.543 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.3202078342437744
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.884 Test Loss: 0.547 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.3007001876831055
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.884 Test Loss: 0.546 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.1612722873687744
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.884 Test Loss: 0.546 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.462986946105957
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.884 Test Loss: 0.544 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.685530424118042
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.884 Test Loss: 0.541 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.6370201110839844
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.884 Test Loss: 0.541 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2540092
model size : 19.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.810057640075684
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.101 Vali Acc: 0.558 Test Loss: 1.101 Test Acc: 0.558
Validation loss decreased (inf --> -0.557960).  Saving model ...
Epoch: 2 cost time: 2.306264638900757
Epoch: 2, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.735 Vali Acc: 0.717 Test Loss: 0.735 Test Acc: 0.717
Validation loss decreased (-0.557960 --> -0.717384).  Saving model ...
Epoch: 3 cost time: 2.5100862979888916
Epoch: 3, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
Validation loss decreased (-0.717384 --> -0.760862).  Saving model ...
Epoch: 4 cost time: 2.181265354156494
Epoch: 4, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.760862 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 2.2373547554016113
Epoch: 5, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.855 Test Loss: 0.534 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 6 cost time: 2.429222345352173
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.547293186187744
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.538285970687866
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.826 Test Loss: 0.646 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.551254987716675
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3901641368865967
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4001247882843018
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.848 Test Loss: 0.665 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4189248085021973
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.848 Test Loss: 0.680 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.68357253074646
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.841 Test Loss: 0.690 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.019031524658203
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.607264280319214
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.826 Test Loss: 0.703 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 2015804
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.793700695037842
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.100 Vali Acc: 0.565 Test Loss: 1.100 Test Acc: 0.565
Validation loss decreased (inf --> -0.565206).  Saving model ...
Epoch: 2 cost time: 2.0006563663482666
Epoch: 2, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.732 Vali Acc: 0.710 Test Loss: 0.732 Test Acc: 0.710
Validation loss decreased (-0.565206 --> -0.710138).  Saving model ...
Epoch: 3 cost time: 2.5406367778778076
Epoch: 3, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 2.306121826171875
Epoch: 4, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
Validation loss decreased (-0.724630 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 2.648650646209717
Epoch: 5, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
Validation loss decreased (-0.818836 --> -0.869560).  Saving model ...
Epoch: 6 cost time: 2.608628749847412
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5461082458496094
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.381010055541992
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.446110248565674
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.826 Test Loss: 0.638 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5283961296081543
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.290311574935913
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5500869750976562
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.848 Test Loss: 0.645 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6024057865142822
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.848 Test Loss: 0.662 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.596320629119873
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.848 Test Loss: 0.677 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1630358695983887
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.848 Test Loss: 0.675 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 2015804
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.8097498416900635
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.073 Vali Acc: 0.580 Test Loss: 1.073 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 2.0072340965270996
Epoch: 2, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.579699 --> -0.717384).  Saving model ...
Epoch: 3 cost time: 1.7524981498718262
Epoch: 3, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.747 Vali Acc: 0.725 Test Loss: 0.747 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 1.9514954090118408
Epoch: 4, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
Validation loss decreased (-0.724630 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 1.9134159088134766
Epoch: 5, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
Validation loss decreased (-0.826082 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 2.1373138427734375
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.389413595199585
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4880154132843018
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.42521071434021
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5542643070220947
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3134381771087646
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4454047679901123
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2173826694488525
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.197309970855713
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1617815494537354
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.826 Test Loss: 0.608 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2015804
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.466716766357422
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.010 Vali Acc: 0.616 Test Loss: 1.010 Test Acc: 0.616
Validation loss decreased (inf --> -0.615932).  Saving model ...
Epoch: 2 cost time: 1.7998321056365967
Epoch: 2, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.630 Vali Acc: 0.768 Test Loss: 0.630 Test Acc: 0.768
Validation loss decreased (-0.615932 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 1.6185338497161865
Epoch: 3, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.671 Vali Acc: 0.797 Test Loss: 0.671 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797095).  Saving model ...
Epoch: 4 cost time: 1.8859295845031738
Epoch: 4, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 5 cost time: 1.727424144744873
Epoch: 5, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.536 Vali Acc: 0.826 Test Loss: 0.536 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 2.3945810794830322
Epoch: 6, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 2.245318651199341
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 2.388162612915039
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8601129055023193
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1399025917053223
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1064467430114746
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1468629837036133
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.113161325454712
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.020085096359253
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 2.4312686920166016
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 2.241680145263672
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.870 Test Loss: 0.520 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2973227500915527
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.155242443084717
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.287292957305908
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3052327632904053
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.279487371444702
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 22 cost time: 2.1708967685699463
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 23 cost time: 1.9305901527404785
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.877 Test Loss: 0.523 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8018662929534912
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.877 Test Loss: 0.521 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.995490312576294
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.877 Test Loss: 0.528 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8091545104980469
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.877 Test Loss: 0.530 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1181349754333496
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.877 Test Loss: 0.532 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9346575736999512
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8108885288238525
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7707176208496094
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.118943214416504
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2962284088134766
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2015804
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.012547016143799
Epoch: 1, Steps: 9 | Train Loss: 1.315 Vali Loss: 0.997 Vali Acc: 0.667 Test Loss: 0.997 Test Acc: 0.667
Validation loss decreased (inf --> -0.666657).  Saving model ...
Epoch: 2 cost time: 2.4836573600769043
Epoch: 2, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.719 Vali Acc: 0.696 Test Loss: 0.719 Test Acc: 0.696
Validation loss decreased (-0.666657 --> -0.695645).  Saving model ...
Epoch: 3 cost time: 2.5107533931732178
Epoch: 3, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.652 Vali Acc: 0.797 Test Loss: 0.652 Test Acc: 0.797
Validation loss decreased (-0.695645 --> -0.797095).  Saving model ...
Epoch: 4 cost time: 1.9447193145751953
Epoch: 4, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7641727924346924
Epoch: 5, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.7617290019989014
Epoch: 6, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8295488357543945
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.812 Test Loss: 0.624 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6273984909057617
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2939915657043457
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7047781944274902
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.031334638595581
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3472983837127686
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.826 Test Loss: 0.686 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3935787677764893
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5521647930145264
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.819 Test Loss: 0.699 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1957874298095703
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 1753660
model size : 16.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.6240739822387695
Epoch: 1, Steps: 9 | Train Loss: 1.309 Vali Loss: 0.989 Vali Acc: 0.652 Test Loss: 0.989 Test Acc: 0.652
Validation loss decreased (inf --> -0.652164).  Saving model ...
Epoch: 2 cost time: 1.9864251613616943
Epoch: 2, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
Validation loss decreased (-0.652164 --> -0.731877).  Saving model ...
Epoch: 3 cost time: 1.5785105228424072
Epoch: 3, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.680 Vali Acc: 0.768 Test Loss: 0.680 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 1.895230770111084
Epoch: 4, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775357).  Saving model ...
Epoch: 5 cost time: 1.7608563899993896
Epoch: 5, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
Validation loss decreased (-0.775357 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 2.035367727279663
Epoch: 6, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.102656364440918
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7898950576782227
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0511767864227295
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0324981212615967
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2437450885772705
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1931746006011963
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3537306785583496
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.841 Test Loss: 0.646 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0261757373809814
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.833 Test Loss: 0.637 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.048231363296509
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1753660
model size : 16.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.201934814453125
Epoch: 1, Steps: 9 | Train Loss: 1.329 Vali Loss: 0.984 Vali Acc: 0.674 Test Loss: 0.984 Test Acc: 0.674
Validation loss decreased (inf --> -0.673903).  Saving model ...
Epoch: 2 cost time: 2.581644296646118
Epoch: 2, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
Validation loss decreased (-0.673903 --> -0.717384).  Saving model ...
Epoch: 3 cost time: 2.126912832260132
Epoch: 3, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.670 Vali Acc: 0.768 Test Loss: 0.670 Test Acc: 0.768
Validation loss decreased (-0.717384 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 1.829071283340454
Epoch: 4, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 5 cost time: 1.799119472503662
Epoch: 5, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
Validation loss decreased (-0.768110 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 2.0577752590179443
Epoch: 6, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.072995662689209
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.624345541000366
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4598121643066406
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.515763759613037
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 2.4275405406951904
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3986079692840576
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2960705757141113
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.092069387435913
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0137486457824707
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0932648181915283
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9949100017547607
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9307997226715088
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.856980562210083
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1956379413604736
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1753660
model size : 16.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.685823917388916
Epoch: 1, Steps: 9 | Train Loss: 1.325 Vali Loss: 0.963 Vali Acc: 0.659 Test Loss: 0.963 Test Acc: 0.659
Validation loss decreased (inf --> -0.659411).  Saving model ...
Epoch: 2 cost time: 1.7768397331237793
Epoch: 2, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.613 Vali Acc: 0.768 Test Loss: 0.613 Test Acc: 0.768
Validation loss decreased (-0.659411 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 2.1136178970336914
Epoch: 3, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 1.907439947128296
Epoch: 4, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.467 Vali Acc: 0.812 Test Loss: 0.467 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811590).  Saving model ...
Epoch: 5 cost time: 1.6477866172790527
Epoch: 5, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.811590 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 1.9188103675842285
Epoch: 6, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869562).  Saving model ...
Epoch: 7 cost time: 1.603973388671875
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8723630905151367
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.237515926361084
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 2.421510934829712
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 11 cost time: 2.67962384223938
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.373272180557251
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8499691486358643
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.802269697189331
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.884 Test Loss: 0.480 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8235056400299072
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.884 Test Loss: 0.488 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.302628755569458
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.520934820175171
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5302674770355225
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4373366832733154
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.877 Test Loss: 0.497 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4571285247802734
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.877 Test Loss: 0.496 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 1753660
model size : 16.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.373682737350464
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.185 Vali Acc: 0.493 Test Loss: 1.185 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 2.4853320121765137
Epoch: 2, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
Validation loss decreased (-0.492742 --> -0.760862).  Saving model ...
Epoch: 3 cost time: 2.5890612602233887
Epoch: 3, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.651 Vali Acc: 0.768 Test Loss: 0.651 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 2.566660165786743
Epoch: 4, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
Validation loss decreased (-0.768109 --> -0.811589).  Saving model ...
Epoch: 5 cost time: 2.7133450508117676
Epoch: 5, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.840 Vali Acc: 0.797 Test Loss: 0.840 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2296035289764404
Epoch: 6, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.810 Vali Acc: 0.732 Test Loss: 0.810 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.406500816345215
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.681 Vali Acc: 0.812 Test Loss: 0.681 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3633275032043457
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 2.344377279281616
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.862 Test Loss: 0.643 Test Acc: 0.862
Validation loss decreased (-0.840573 --> -0.862312).  Saving model ...
Epoch: 10 cost time: 2.4386799335479736
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.855 Test Loss: 0.664 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.673057794570923
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6568591594696045
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.551225185394287
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.357761859893799
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.833 Test Loss: 0.729 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7670626640319824
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.826 Test Loss: 0.735 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9422106742858887
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.826 Test Loss: 0.740 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4490833282470703
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.841 Test Loss: 0.747 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4011311531066895
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.841 Test Loss: 0.752 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.316734552383423
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.841 Test Loss: 0.761 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1622588
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.045487403869629
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.157 Vali Acc: 0.507 Test Loss: 1.157 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 2.144404888153076
Epoch: 2, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.720 Vali Acc: 0.703 Test Loss: 0.720 Test Acc: 0.703
Validation loss decreased (-0.507235 --> -0.702891).  Saving model ...
Epoch: 3 cost time: 2.383445978164673
Epoch: 3, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.629 Vali Acc: 0.790 Test Loss: 0.629 Test Acc: 0.790
Validation loss decreased (-0.702891 --> -0.789849).  Saving model ...
Epoch: 4 cost time: 2.279233694076538
Epoch: 4, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 1.8902018070220947
Epoch: 5, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.776 Vali Acc: 0.812 Test Loss: 0.776 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1658036708831787
Epoch: 6, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.804 Vali Acc: 0.732 Test Loss: 0.804 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.190765380859375
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2143819332122803
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.096144437789917
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.833 Test Loss: 0.618 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.8136870861053467
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7737691402435303
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.051222324371338
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.804 Test Loss: 0.700 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.549161195755005
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.819 Test Loss: 0.701 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.167584180831909
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2507717609405518
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2437121868133545
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.072036027908325
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.812 Test Loss: 0.724 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.227221727371216
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.812 Test Loss: 0.726 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.305246114730835
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.812 Test Loss: 0.733 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 1622588
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.007110357284546
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.106 Vali Acc: 0.529 Test Loss: 1.106 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 1.9769980907440186
Epoch: 2, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
Validation loss decreased (-0.528974 --> -0.731877).  Saving model ...
Epoch: 3 cost time: 2.408190965652466
Epoch: 3, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.579 Vali Acc: 0.790 Test Loss: 0.579 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789849).  Saving model ...
Epoch: 4 cost time: 2.155907154083252
Epoch: 4, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 2.387909412384033
Epoch: 5, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.185784339904785
Epoch: 6, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.770 Vali Acc: 0.746 Test Loss: 0.770 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.176325798034668
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.047658920288086
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.907867670059204
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9623513221740723
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3252055644989014
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1333441734313965
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.50740122795105
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.316213369369507
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 1622588
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.881462812423706
Epoch: 1, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.016 Vali Acc: 0.580 Test Loss: 1.016 Test Acc: 0.580
Validation loss decreased (inf --> -0.579700).  Saving model ...
Epoch: 2 cost time: 2.1790740489959717
Epoch: 2, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.625 Vali Acc: 0.797 Test Loss: 0.625 Test Acc: 0.797
Validation loss decreased (-0.579700 --> -0.797095).  Saving model ...
Epoch: 3 cost time: 1.7586123943328857
Epoch: 3, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826082).  Saving model ...
Epoch: 4 cost time: 2.1165101528167725
Epoch: 4, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840574).  Saving model ...
Epoch: 5 cost time: 1.9132044315338135
Epoch: 5, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1321487426757812
Epoch: 6, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.715 Vali Acc: 0.819 Test Loss: 0.715 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.207747459411621
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 8 cost time: 2.108351469039917
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.746208667755127
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 1.6342031955718994
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.870 Test Loss: 0.558 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9125049114227295
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 1.7766528129577637
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0491549968719482
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.341867446899414
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.227858543395996
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3656790256500244
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.870 Test Loss: 0.517 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.223607063293457
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1525650024414062
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.870 Test Loss: 0.523 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.272324800491333
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8718924522399902
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.129129648208618
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1622588
model size : 15.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.54328727722168
Epoch: 1, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.168 Vali Acc: 0.543 Test Loss: 1.168 Test Acc: 0.543
Validation loss decreased (inf --> -0.543467).  Saving model ...
Epoch: 2 cost time: 1.7322287559509277
Epoch: 2, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
Validation loss decreased (-0.543467 --> -0.739122).  Saving model ...
Epoch: 3 cost time: 1.8184380531311035
Epoch: 3, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
Validation loss decreased (-0.739122 --> -0.811588).  Saving model ...
Epoch: 4 cost time: 2.016812562942505
Epoch: 4, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 2.0484416484832764
Epoch: 5, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 2.142810344696045
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0350141525268555
Epoch: 7, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 2.5394556522369385
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.521 Vali Acc: 0.790 Test Loss: 0.521 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.411102056503296
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7869033813476562
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1020045280456543
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1215548515319824
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8400938510894775
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.848 Test Loss: 0.607 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9446959495544434
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5593245029449463
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.098965644836426
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.046816825866699
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.848 Test Loss: 0.621 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 2580796
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.0105509757995605
Epoch: 1, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.162 Vali Acc: 0.601 Test Loss: 1.162 Test Acc: 0.601
Validation loss decreased (inf --> -0.601438).  Saving model ...
Epoch: 2 cost time: 1.7883665561676025
Epoch: 2, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.806 Vali Acc: 0.732 Test Loss: 0.806 Test Acc: 0.732
Validation loss decreased (-0.601438 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 1.968869686126709
Epoch: 3, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
Validation loss decreased (-0.731876 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 2.129624366760254
Epoch: 4, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2299420833587646
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 1.8612589836120605
Epoch: 6, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 2.1571295261383057
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0767436027526855
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1560747623443604
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.010101318359375
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2955009937286377
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2970919609069824
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.05037260055542
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4117908477783203
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.862 Test Loss: 0.567 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862313).  Saving model ...
Epoch: 15 cost time: 2.6155004501342773
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.241272211074829
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7957851886749268
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9497125148773193
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2269632816314697
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2821011543273926
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3984146118164062
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2908544540405273
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.318469524383545
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.17559814453125
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.848 Test Loss: 0.574 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 2580796
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.065791130065918
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.151 Vali Acc: 0.609 Test Loss: 1.151 Test Acc: 0.609
Validation loss decreased (inf --> -0.608684).  Saving model ...
Epoch: 2 cost time: 1.7197580337524414
Epoch: 2, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.804 Vali Acc: 0.754 Test Loss: 0.804 Test Acc: 0.754
Validation loss decreased (-0.608684 --> -0.753615).  Saving model ...
Epoch: 3 cost time: 1.8948936462402344
Epoch: 3, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
Validation loss decreased (-0.753615 --> -0.847820).  Saving model ...
Epoch: 4 cost time: 2.3557729721069336
Epoch: 4, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3022544384002686
Epoch: 5, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 6 cost time: 2.257899284362793
Epoch: 6, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 2.231696367263794
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.047961473464966
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7750952243804932
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.192652463912964
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5896756649017334
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5434775352478027
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0010762214660645
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.848 Test Loss: 0.514 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1619813442230225
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2065787315368652
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.11637806892395
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 2580796
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.554907321929932
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.115 Vali Acc: 0.630 Test Loss: 1.115 Test Acc: 0.630
Validation loss decreased (inf --> -0.630424).  Saving model ...
Epoch: 2 cost time: 1.6887469291687012
Epoch: 2, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.766 Vali Acc: 0.775 Test Loss: 0.766 Test Acc: 0.775
Validation loss decreased (-0.630424 --> -0.775355).  Saving model ...
Epoch: 3 cost time: 1.633530855178833
Epoch: 3, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
Validation loss decreased (-0.775355 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 1.7536170482635498
Epoch: 4, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9705324172973633
Epoch: 5, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 1.8703842163085938
Epoch: 6, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 1.4454092979431152
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 1.5599443912506104
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9534003734588623
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.870 Test Loss: 0.532 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0700554847717285
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.870 Test Loss: 0.486 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9584760665893555
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9450311660766602
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9950435161590576
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0304112434387207
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1134839057922363
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.25233793258667
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3347673416137695
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.877 Test Loss: 0.472 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2580796
model size : 14.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.400319814682007
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.262 Vali Acc: 0.449 Test Loss: 1.262 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 0.871638298034668
Epoch: 2, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.912 Vali Acc: 0.659 Test Loss: 0.912 Test Acc: 0.659
Validation loss decreased (-0.449263 --> -0.659411).  Saving model ...
Epoch: 3 cost time: 0.9394338130950928
Epoch: 3, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
Validation loss decreased (-0.659411 --> -0.804341).  Saving model ...
Epoch: 4 cost time: 0.9278988838195801
Epoch: 4, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.654 Vali Acc: 0.725 Test Loss: 0.654 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8823018074035645
Epoch: 5, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 0.9677212238311768
Epoch: 6, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.683 Vali Acc: 0.754 Test Loss: 0.683 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9139266014099121
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.818834 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 0.9428529739379883
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9455394744873047
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.631 Vali Acc: 0.797 Test Loss: 0.631 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.938176155090332
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9514164924621582
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9690415859222412
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.848 Test Loss: 0.573 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9625308513641357
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9305167198181152
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9400615692138672
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9189426898956299
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9008073806762695
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1532220
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.954644680023193
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.260 Vali Acc: 0.464 Test Loss: 1.260 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 2.252939224243164
Epoch: 2, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.906 Vali Acc: 0.659 Test Loss: 0.906 Test Acc: 0.659
Validation loss decreased (-0.463756 --> -0.659411).  Saving model ...
Epoch: 3 cost time: 1.9603848457336426
Epoch: 3, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.634 Vali Acc: 0.826 Test Loss: 0.634 Test Acc: 0.826
Validation loss decreased (-0.659411 --> -0.826081).  Saving model ...
Epoch: 4 cost time: 1.8855183124542236
Epoch: 4, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.643 Vali Acc: 0.746 Test Loss: 0.643 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7014763355255127
Epoch: 5, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 1.691443920135498
Epoch: 6, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7603676319122314
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
Validation loss decreased (-0.826081 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.5427603721618652
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.952035665512085
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0526702404022217
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0476443767547607
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.288055181503296
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.476501226425171
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4375455379486084
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.715872049331665
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.077176332473755
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2313168048858643
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.826 Test Loss: 0.618 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1532220
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9017040729522705
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.247 Vali Acc: 0.478 Test Loss: 1.247 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 1.7003259658813477
Epoch: 2, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.892 Vali Acc: 0.667 Test Loss: 0.892 Test Acc: 0.667
Validation loss decreased (-0.478248 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 1.8645987510681152
Epoch: 3, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
Validation loss decreased (-0.666658 --> -0.811588).  Saving model ...
Epoch: 4 cost time: 1.6133949756622314
Epoch: 4, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.629 Vali Acc: 0.754 Test Loss: 0.629 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8069052696228027
Epoch: 5, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 2.2024593353271484
Epoch: 6, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.840782642364502
Epoch: 7, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.8839483261108398
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.666912317276001
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8542661666870117
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1188395023345947
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2167625427246094
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0523433685302734
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3032233715057373
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.421846628189087
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1758625507354736
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.74149751663208
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1532220
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6477560997009277
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.188 Vali Acc: 0.543 Test Loss: 1.188 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 1.5683858394622803
Epoch: 2, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.810 Vali Acc: 0.725 Test Loss: 0.810 Test Acc: 0.725
Validation loss decreased (-0.543466 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 1.682856559753418
Epoch: 3, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.724630 --> -0.818835).  Saving model ...
Epoch: 4 cost time: 1.8091959953308105
Epoch: 4, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.526 Vali Acc: 0.797 Test Loss: 0.526 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8318092823028564
Epoch: 5, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 1.5883116722106934
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6404697895050049
Epoch: 7, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.483 Vali Acc: 0.790 Test Loss: 0.483 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.885706901550293
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 9 cost time: 1.925936222076416
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9530797004699707
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 2.0521419048309326
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 2.287036418914795
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.220942258834839
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 2.1691994667053223
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 2.0454587936401367
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.949258804321289
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1648833751678467
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8674652576446533
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0190398693084717
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9143545627593994
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9321331977844238
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.770536184310913
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8547537326812744
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.816551923751831
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9777610301971436
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1532220
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.69573974609375
Epoch: 1, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.174 Vali Acc: 0.457 Test Loss: 1.174 Test Acc: 0.457
Validation loss decreased (inf --> -0.456510).  Saving model ...
Epoch: 2 cost time: 1.9670541286468506
Epoch: 2, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.880 Vali Acc: 0.638 Test Loss: 0.880 Test Acc: 0.638
Validation loss decreased (-0.456510 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 1.588547706604004
Epoch: 3, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
Validation loss decreased (-0.637672 --> -0.804341).  Saving model ...
Epoch: 4 cost time: 1.3144981861114502
Epoch: 4, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
Validation loss decreased (-0.804341 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.8350694179534912
Epoch: 5, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8650767803192139
Epoch: 6, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8934276103973389
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 8 cost time: 2.2948973178863525
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.540456533432007
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.460049629211426
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1382179260253906
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9214558601379395
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6556270122528076
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.888047695159912
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.848 Test Loss: 0.617 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.987128496170044
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9797215461730957
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.848 Test Loss: 0.624 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.682729959487915
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1007932
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.558895826339722
Epoch: 1, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.165 Vali Acc: 0.478 Test Loss: 1.165 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 1.8608722686767578
Epoch: 2, Steps: 9 | Train Loss: 0.886 Vali Loss: 0.861 Vali Acc: 0.623 Test Loss: 0.861 Test Acc: 0.623
Validation loss decreased (-0.478249 --> -0.623180).  Saving model ...
Epoch: 3 cost time: 1.919611930847168
Epoch: 3, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.623180 --> -0.826081).  Saving model ...
Epoch: 4 cost time: 1.887603759765625
Epoch: 4, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.637115716934204
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4426913261413574
Epoch: 6, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8894774913787842
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 1.7700653076171875
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7828338146209717
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.729449987411499
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.841 Test Loss: 0.636 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6940391063690186
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6420249938964844
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5684168338775635
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8273978233337402
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.848 Test Loss: 0.598 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6812896728515625
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6548175811767578
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7062454223632812
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1007932
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.580791473388672
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.152 Vali Acc: 0.507 Test Loss: 1.152 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 1.8125851154327393
Epoch: 2, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.839 Vali Acc: 0.681 Test Loss: 0.839 Test Acc: 0.681
Validation loss decreased (-0.507235 --> -0.681151).  Saving model ...
Epoch: 3 cost time: 2.0073275566101074
Epoch: 3, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.681151 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 1.8371102809906006
Epoch: 4, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 1.9755373001098633
Epoch: 5, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.077817916870117
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8871946334838867
Epoch: 7, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 1.6372253894805908
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5588607788085938
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6712334156036377
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6324646472930908
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.855 Test Loss: 0.556 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6206395626068115
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5535285472869873
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7053089141845703
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6810386180877686
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.855 Test Loss: 0.556 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.788074254989624
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8827488422393799
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1007932
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.8841612339019775
Epoch: 1, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.106 Vali Acc: 0.594 Test Loss: 1.106 Test Acc: 0.594
Validation loss decreased (inf --> -0.594192).  Saving model ...
Epoch: 2 cost time: 1.9121999740600586
Epoch: 2, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.764 Vali Acc: 0.732 Test Loss: 0.764 Test Acc: 0.732
Validation loss decreased (-0.594192 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 1.5054736137390137
Epoch: 3, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.731876 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.5309672355651855
Epoch: 4, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 1.7528810501098633
Epoch: 5, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5961167812347412
Epoch: 6, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.080765962600708
Epoch: 7, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 2.005845069885254
Epoch: 8, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.476 Vali Acc: 0.804 Test Loss: 0.476 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4811651706695557
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 10 cost time: 1.701991319656372
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.637033462524414
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 1.670534372329712
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.7721703052520752
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 1.566683053970337
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4370508193969727
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5387794971466064
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 17 cost time: 1.5386135578155518
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0016305446624756
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7453417778015137
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4269726276397705
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 1.555934190750122
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6973369121551514
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8198845386505127
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.917809247970581
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6202282905578613
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6870944499969482
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5151257514953613
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6511948108673096
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0926196575164795
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.870 Test Loss: 0.477 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5743982791900635
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.877 Test Loss: 0.477 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 31 cost time: 2.0921971797943115
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9994394779205322
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8831090927124023
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9709513187408447
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0904641151428223
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6966753005981445
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3565332889556885
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5247738361358643
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6625981330871582
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6309514045715332
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.884 Test Loss: 0.477 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 41 cost time: 1.3685722351074219
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.837254285812378
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4774181842803955
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6786606311798096
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.0364990234375
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.884 Test Loss: 0.488 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.9191715717315674
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 47 cost time: 1.9195969104766846
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.891 Test Loss: 0.487 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8390450477600098
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.884 Test Loss: 0.491 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5357096195220947
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7483654022216797
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.891 Test Loss: 0.492 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.7424867153167725
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.891 Test Loss: 0.491 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.697084665298462
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.891 Test Loss: 0.491 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.8695285320281982
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.891 Test Loss: 0.491 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.6037917137145996
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.5086309909820557
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.648015022277832
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.891 Test Loss: 0.489 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1007932
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.066991567611694
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 1.577913761138916
Epoch: 2, Steps: 9 | Train Loss: 0.880 Vali Loss: 0.886 Vali Acc: 0.652 Test Loss: 0.886 Test Acc: 0.652
Validation loss decreased (-0.485495 --> -0.652165).  Saving model ...
Epoch: 3 cost time: 1.5039563179016113
Epoch: 3, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.683 Vali Acc: 0.819 Test Loss: 0.683 Test Acc: 0.819
Validation loss decreased (-0.652165 --> -0.818834).  Saving model ...
Epoch: 4 cost time: 1.7755279541015625
Epoch: 4, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 2.1284701824188232
Epoch: 5, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.669 Vali Acc: 0.725 Test Loss: 0.669 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1568098068237305
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9445838928222656
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 8 cost time: 1.880486249923706
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7577788829803467
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.790 Test Loss: 0.651 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.074125289916992
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.622 Vali Acc: 0.804 Test Loss: 0.622 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0697734355926514
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.002562999725342
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3960697650909424
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.548903703689575
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.804 Test Loss: 0.663 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2042675018310547
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3879377841949463
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4258289337158203
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.812 Test Loss: 0.676 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 745788
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.360981225967407
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.204 Vali Acc: 0.507 Test Loss: 1.204 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 1.7152783870697021
Epoch: 2, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.864 Vali Acc: 0.681 Test Loss: 0.864 Test Acc: 0.681
Validation loss decreased (-0.507234 --> -0.681151).  Saving model ...
Epoch: 3 cost time: 1.9191875457763672
Epoch: 3, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.665 Vali Acc: 0.826 Test Loss: 0.665 Test Acc: 0.826
Validation loss decreased (-0.681151 --> -0.826080).  Saving model ...
Epoch: 4 cost time: 1.5166971683502197
Epoch: 4, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
Validation loss decreased (-0.826080 --> -0.862313).  Saving model ...
Epoch: 5 cost time: 1.2514162063598633
Epoch: 5, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8535380363464355
Epoch: 6, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9840364456176758
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7664783000946045
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.829188585281372
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.812 Test Loss: 0.614 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9918956756591797
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8532822132110596
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7794795036315918
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.826 Test Loss: 0.608 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6337926387786865
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.819 Test Loss: 0.615 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9470012187957764
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 745788
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.1825385093688965
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.173 Vali Acc: 0.536 Test Loss: 1.173 Test Acc: 0.536
Validation loss decreased (inf --> -0.536220).  Saving model ...
Epoch: 2 cost time: 1.8854327201843262
Epoch: 2, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
Validation loss decreased (-0.536220 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 1.7378473281860352
Epoch: 3, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
Validation loss decreased (-0.731876 --> -0.826081).  Saving model ...
Epoch: 4 cost time: 2.1181905269622803
Epoch: 4, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 2.0587422847747803
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7018210887908936
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6521663665771484
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.990020513534546
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.096496105194092
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5357277393341064
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4972703456878662
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5740084648132324
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8152382373809814
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9141523838043213
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.963108777999878
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.833 Test Loss: 0.608 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3660171031951904
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8255105018615723
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 745788
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.277384519577026
Epoch: 1, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.117 Vali Acc: 0.580 Test Loss: 1.117 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 1.610353708267212
Epoch: 2, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
Validation loss decreased (-0.579699 --> -0.782601).  Saving model ...
Epoch: 3 cost time: 1.6160154342651367
Epoch: 3, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.583 Vali Acc: 0.848 Test Loss: 0.583 Test Acc: 0.848
Validation loss decreased (-0.782601 --> -0.847820).  Saving model ...
Epoch: 4 cost time: 1.742412805557251
Epoch: 4, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 1.8140676021575928
Epoch: 5, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7751410007476807
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4925146102905273
Epoch: 7, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.556551218032837
Epoch: 8, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.512049913406372
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.500493049621582
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.424694299697876
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 1.371622085571289
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6423847675323486
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8900864124298096
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 1.4869379997253418
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7296457290649414
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7484138011932373
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.630171298980713
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6600334644317627
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7683281898498535
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8565785884857178
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9143357276916504
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7214181423187256
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.862 Test Loss: 0.508 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7357146739959717
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.862 Test Loss: 0.510 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 745788
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.497486114501953
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.203 Vali Acc: 0.384 Test Loss: 1.203 Test Acc: 0.384
Validation loss decreased (inf --> -0.384046).  Saving model ...
Epoch: 2 cost time: 1.848459005355835
Epoch: 2, Steps: 9 | Train Loss: 0.914 Vali Loss: 0.855 Vali Acc: 0.696 Test Loss: 0.855 Test Acc: 0.696
Validation loss decreased (-0.384046 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 1.8452820777893066
Epoch: 3, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (-0.695644 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 1.7724220752716064
Epoch: 4, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.903233528137207
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.406402349472046
Epoch: 6, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9762649536132812
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.597205400466919
Epoch: 8, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.7723207473754883
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 2.040003538131714
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0614376068115234
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2210845947265625
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5354528427124023
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.826 Test Loss: 0.629 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7040777206420898
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.826 Test Loss: 0.621 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9045841693878174
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.826 Test Loss: 0.630 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2462005615234375
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8038456439971924
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.826 Test Loss: 0.643 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.761970043182373
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5273661613464355
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 614716
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.286810398101807
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.197 Vali Acc: 0.391 Test Loss: 1.197 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 1.8482911586761475
Epoch: 2, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.391292 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 1.5231242179870605
Epoch: 3, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
Validation loss decreased (-0.717383 --> -0.862313).  Saving model ...
Epoch: 4 cost time: 1.8994264602661133
Epoch: 4, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9113545417785645
Epoch: 5, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8801116943359375
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1025431156158447
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1838855743408203
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8819880485534668
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7718565464019775
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4041213989257812
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.663266658782959
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.812 Test Loss: 0.611 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1535115242004395
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.826 Test Loss: 0.607 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 614716
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.401682138442993
Epoch: 1, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.191 Vali Acc: 0.384 Test Loss: 1.191 Test Acc: 0.384
Validation loss decreased (inf --> -0.384046).  Saving model ...
Epoch: 2 cost time: 1.7173726558685303
Epoch: 2, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.837 Vali Acc: 0.710 Test Loss: 0.837 Test Acc: 0.710
Validation loss decreased (-0.384046 --> -0.710137).  Saving model ...
Epoch: 3 cost time: 1.7221283912658691
Epoch: 3, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
Validation loss decreased (-0.710137 --> -0.855067).  Saving model ...
Epoch: 4 cost time: 1.7116706371307373
Epoch: 4, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7503993511199951
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.211775302886963
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 1.8955771923065186
Epoch: 7, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.788071870803833
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.803070068359375
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 1.8842058181762695
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9328112602233887
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.96065092086792
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0378096103668213
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.100614070892334
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.855 Test Loss: 0.578 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6339750289916992
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6745314598083496
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.64520263671875
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.848 Test Loss: 0.589 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8584179878234863
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1809256076812744
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.848 Test Loss: 0.597 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 614716
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.390613794326782
Epoch: 1, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.158 Vali Acc: 0.522 Test Loss: 1.158 Test Acc: 0.522
Validation loss decreased (inf --> -0.521728).  Saving model ...
Epoch: 2 cost time: 1.5400302410125732
Epoch: 2, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.789 Vali Acc: 0.739 Test Loss: 0.789 Test Acc: 0.739
Validation loss decreased (-0.521728 --> -0.739123).  Saving model ...
Epoch: 3 cost time: 1.8338255882263184
Epoch: 3, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.739123 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 1.669133186340332
Epoch: 4, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.9119117259979248
Epoch: 5, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1732945442199707
Epoch: 6, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 1.8252036571502686
Epoch: 7, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.488 Vali Acc: 0.812 Test Loss: 0.488 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8285975456237793
Epoch: 8, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7890501022338867
Epoch: 9, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2692184448242188
Epoch: 10, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884053).  Saving model ...
Epoch: 11 cost time: 1.9581151008605957
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1581485271453857
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1057074069976807
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0658788681030273
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.877 Test Loss: 0.502 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8192594051361084
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9099268913269043
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.866652011871338
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7537496089935303
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.877 Test Loss: 0.503 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8611524105072021
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7251999378204346
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 614716
model size : 7.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.855545997619629
Epoch: 1, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.189 Vali Acc: 0.478 Test Loss: 1.189 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 2.079820156097412
Epoch: 2, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.785 Vali Acc: 0.804 Test Loss: 0.785 Test Acc: 0.804
Validation loss decreased (-0.478249 --> -0.804340).  Saving model ...
Epoch: 3 cost time: 2.2363743782043457
Epoch: 3, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.654 Vali Acc: 0.790 Test Loss: 0.654 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7616798877716064
Epoch: 4, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.589 Vali Acc: 0.790 Test Loss: 0.589 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8279390335083008
Epoch: 5, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 1.9122052192687988
Epoch: 6, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 1.7767753601074219
Epoch: 7, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7574527263641357
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0417327880859375
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7691965103149414
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.790 Test Loss: 0.640 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5602996349334717
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7589976787567139
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9480679035186768
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.435072422027588
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.797 Test Loss: 0.636 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6250462532043457
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.797 Test Loss: 0.664 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.810530424118042
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 549180
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.533947229385376
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.734908103942871
Epoch: 2, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.774 Vali Acc: 0.797 Test Loss: 0.774 Test Acc: 0.797
Validation loss decreased (-0.499988 --> -0.797094).  Saving model ...
Epoch: 3 cost time: 1.7166016101837158
Epoch: 3, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811588).  Saving model ...
Epoch: 4 cost time: 1.6958308219909668
Epoch: 4, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8021650314331055
Epoch: 5, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 1.938162088394165
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.7378184795379639
Epoch: 7, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.884211778640747
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8665523529052734
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3007922172546387
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.812 Test Loss: 0.613 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8340411186218262
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4799306392669678
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5571997165679932
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.859811782836914
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.797 Test Loss: 0.614 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9791648387908936
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.797 Test Loss: 0.631 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8432886600494385
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 549180
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.37311315536499
Epoch: 1, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.156 Vali Acc: 0.572 Test Loss: 1.156 Test Acc: 0.572
Validation loss decreased (inf --> -0.572452).  Saving model ...
Epoch: 2 cost time: 1.7478513717651367
Epoch: 2, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.758 Vali Acc: 0.797 Test Loss: 0.758 Test Acc: 0.797
Validation loss decreased (-0.572452 --> -0.797094).  Saving model ...
Epoch: 3 cost time: 1.6495873928070068
Epoch: 3, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 1.8438746929168701
Epoch: 4, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 5 cost time: 1.7765800952911377
Epoch: 5, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.907317876815796
Epoch: 6, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.9551002979278564
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 1.8617172241210938
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.87211012840271
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6226611137390137
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2058422565460205
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1228387355804443
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0020394325256348
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.202655792236328
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8815498352050781
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.888239860534668
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1056089401245117
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 549180
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9928841590881348
Epoch: 1, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.120 Vali Acc: 0.630 Test Loss: 1.120 Test Acc: 0.630
Validation loss decreased (inf --> -0.630424).  Saving model ...
Epoch: 2 cost time: 1.9155521392822266
Epoch: 2, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
Validation loss decreased (-0.630424 --> -0.818833).  Saving model ...
Epoch: 3 cost time: 1.503685712814331
Epoch: 3, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 1.5216305255889893
Epoch: 4, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 1.9749584197998047
Epoch: 5, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7622597217559814
Epoch: 6, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 7 cost time: 1.7023870944976807
Epoch: 7, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.001528263092041
Epoch: 8, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7280762195587158
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 1.696124792098999
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 1.5543146133422852
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.58766770362854
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.877 Test Loss: 0.507 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 1.4729795455932617
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.870 Test Loss: 0.505 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4951908588409424
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.027212381362915
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8338031768798828
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0002219676971436
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.047621488571167
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.964839220046997
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.811643362045288
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9793620109558105
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0811896324157715
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 549180
model size : 7.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.641623258590698
Epoch: 1, Steps: 9 | Train Loss: 1.407 Vali Loss: 1.284 Vali Acc: 0.413 Test Loss: 1.284 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 1.8631606101989746
Epoch: 2, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.045 Vali Acc: 0.616 Test Loss: 1.045 Test Acc: 0.616
Validation loss decreased (-0.413031 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 1.950739860534668
Epoch: 3, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.846 Vali Acc: 0.696 Test Loss: 0.846 Test Acc: 0.696
Validation loss decreased (-0.615932 --> -0.695644).  Saving model ...
Epoch: 4 cost time: 2.0199594497680664
Epoch: 4, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.747 Vali Acc: 0.754 Test Loss: 0.747 Test Acc: 0.754
Validation loss decreased (-0.695644 --> -0.753616).  Saving model ...
Epoch: 5 cost time: 1.6938366889953613
Epoch: 5, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
Validation loss decreased (-0.753616 --> -0.811588).  Saving model ...
Epoch: 6 cost time: 1.536632776260376
Epoch: 6, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.647 Vali Acc: 0.797 Test Loss: 0.647 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.557499647140503
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.3033390045166016
Epoch: 8, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.607 Vali Acc: 0.826 Test Loss: 0.607 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4885234832763672
Epoch: 9, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5791866779327393
Epoch: 10, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5844509601593018
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 1.7718791961669922
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0356993675231934
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.804 Test Loss: 0.593 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2629401683807373
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 15 cost time: 1.9990406036376953
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9582607746124268
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8931853771209717
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9007587432861328
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7286241054534912
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862313).  Saving model ...
Epoch: 20 cost time: 1.7907674312591553
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.820664644241333
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7751109600067139
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.862 Test Loss: 0.587 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0704333782196045
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.862 Test Loss: 0.588 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2232308387756348
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9644534587860107
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9637129306793213
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.848 Test Loss: 0.581 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.04984450340271
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.079191207885742
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1184985637664795
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.862 Test Loss: 0.590 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1224892
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.411315441131592
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.279 Vali Acc: 0.449 Test Loss: 1.279 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 2.090771436691284
Epoch: 2, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.037 Vali Acc: 0.623 Test Loss: 1.037 Test Acc: 0.623
Validation loss decreased (-0.449263 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 2.162400245666504
Epoch: 3, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.835 Vali Acc: 0.717 Test Loss: 0.835 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 1.7547731399536133
Epoch: 4, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.741 Vali Acc: 0.746 Test Loss: 0.741 Test Acc: 0.746
Validation loss decreased (-0.717383 --> -0.746369).  Saving model ...
Epoch: 5 cost time: 1.6737453937530518
Epoch: 5, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
Validation loss decreased (-0.746369 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 1.5757791996002197
Epoch: 6, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.620 Vali Acc: 0.819 Test Loss: 0.620 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.412621259689331
Epoch: 7, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.6413908004760742
Epoch: 8, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.6446516513824463
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8653175830841064
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8095703125
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 1.6623711585998535
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6782066822052002
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9317421913146973
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.14382004737854
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6051955223083496
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.76704740524292
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6874744892120361
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.890855312347412
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 20 cost time: 1.646852731704712
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5562114715576172
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5945475101470947
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7311761379241943
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 24 cost time: 1.68025803565979
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.692965030670166
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6591548919677734
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.848 Test Loss: 0.549 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.542250156402588
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7446410655975342
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7300872802734375
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.855 Test Loss: 0.548 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8024137020111084
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 31 cost time: 1.7688770294189453
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7319061756134033
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5468580722808838
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.737757921218872
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.855 Test Loss: 0.546 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6839520931243896
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.862 Test Loss: 0.544 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 36 cost time: 1.868323802947998
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7713425159454346
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7709121704101562
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9224622249603271
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 40 cost time: 1.5778398513793945
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 41 cost time: 2.1099789142608643
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.092524290084839
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.1709985733032227
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 44 cost time: 2.1052005290985107
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 45 cost time: 1.5768303871154785
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5467860698699951
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6723239421844482
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4237651824951172
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.667574167251587
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.870 Test Loss: 0.545 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6671185493469238
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.672835111618042
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4448895454406738
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.7667882442474365
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.5350837707519531
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1224892
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9477906227111816
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.274 Vali Acc: 0.464 Test Loss: 1.274 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 1.5786595344543457
Epoch: 2, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.025 Vali Acc: 0.609 Test Loss: 1.025 Test Acc: 0.609
Validation loss decreased (-0.463755 --> -0.608685).  Saving model ...
Epoch: 3 cost time: 1.4721472263336182
Epoch: 3, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
Validation loss decreased (-0.608685 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 1.708059310913086
Epoch: 4, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.721 Vali Acc: 0.768 Test Loss: 0.721 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 1.6053059101104736
Epoch: 5, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804342).  Saving model ...
Epoch: 6 cost time: 1.7324411869049072
Epoch: 6, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5931169986724854
Epoch: 7, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.440199375152588
Epoch: 8, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5715057849884033
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.420257806777954
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 1.6399784088134766
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5273735523223877
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6160523891448975
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.508 Vali Acc: 0.826 Test Loss: 0.508 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8673110008239746
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4333055019378662
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5215442180633545
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.397294044494629
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3926656246185303
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.54140305519104
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.605247974395752
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 1.6275827884674072
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5610816478729248
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7893364429473877
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 1.6299309730529785
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6790986061096191
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 26 cost time: 1.9428026676177979
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 27 cost time: 1.889965295791626
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 28 cost time: 1.693033218383789
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7405519485473633
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4321374893188477
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 31 cost time: 1.6241159439086914
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6340758800506592
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 33 cost time: 1.4393599033355713
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 34 cost time: 1.305746078491211
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 35 cost time: 1.5366020202636719
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 36 cost time: 1.408604383468628
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.44978666305542
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.877 Test Loss: 0.497 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3788044452667236
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.884 Test Loss: 0.495 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 39 cost time: 1.517561435699463
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.614452838897705
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.778792381286621
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.685189962387085
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4607563018798828
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2342216968536377
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.870 Test Loss: 0.491 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6683785915374756
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5103464126586914
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.877 Test Loss: 0.490 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7769184112548828
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.9205436706542969
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.884 Test Loss: 0.490 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 49 cost time: 1.871729850769043
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3811426162719727
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.877 Test Loss: 0.489 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.496659755706787
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.877 Test Loss: 0.486 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4611396789550781
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2449085712432861
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.6549997329711914
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.884 Test Loss: 0.487 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 55 cost time: 2.003997564315796
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.884 Test Loss: 0.486 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 56 cost time: 1.754335880279541
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.884 Test Loss: 0.486 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7151386737823486
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 58 cost time: 1.7721965312957764
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 59 cost time: 1.7355480194091797
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.7812345027923584
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 61 cost time: 1.942234754562378
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 62 cost time: 1.9955739974975586
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.891 Test Loss: 0.480 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 63 cost time: 1.7108690738677979
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.891 Test Loss: 0.480 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.672945261001587
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.891 Test Loss: 0.480 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 65 cost time: 1.625952959060669
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.83902907371521
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.4874095916748047
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.578115463256836
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.891 Test Loss: 0.484 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.6183981895446777
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.891 Test Loss: 0.484 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.6275322437286377
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.6356103420257568
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.891 Test Loss: 0.486 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.5095741748809814
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.4446115493774414
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.3629364967346191
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.891 Test Loss: 0.482 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1224892
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.664661407470703
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.248 Vali Acc: 0.522 Test Loss: 1.248 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 1.4126291275024414
Epoch: 2, Steps: 9 | Train Loss: 1.038 Vali Loss: 0.983 Vali Acc: 0.609 Test Loss: 0.983 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 1.5078935623168945
Epoch: 3, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
Validation loss decreased (-0.608686 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 1.3964715003967285
Epoch: 4, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.661 Vali Acc: 0.790 Test Loss: 0.661 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 1.6432995796203613
Epoch: 5, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811589).  Saving model ...
Epoch: 6 cost time: 1.5748088359832764
Epoch: 6, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.5497300624847412
Epoch: 7, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.627896785736084
Epoch: 8, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 1.6565032005310059
Epoch: 9, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 1.61397385597229
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 1.6329989433288574
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5471010208129883
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5941236019134521
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4780032634735107
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.508763313293457
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 1.4475524425506592
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 1.703791856765747
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4045233726501465
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2658987045288086
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5181796550750732
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4351296424865723
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 22 cost time: 1.4852683544158936
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7181823253631592
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 1.5013341903686523
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4567365646362305
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.899 Test Loss: 0.414 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 1.4834673404693604
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.899 Test Loss: 0.412 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 1.5566933155059814
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 1.4907186031341553
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5360453128814697
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5970194339752197
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4340968132019043
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5083777904510498
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3774795532226562
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4366323947906494
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.899 Test Loss: 0.412 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5934803485870361
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.65641188621521
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.899 Test Loss: 0.421 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6153271198272705
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.899 Test Loss: 0.421 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1224892
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.617542028427124
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.285 Vali Acc: 0.413 Test Loss: 1.285 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 1.711291790008545
Epoch: 2, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.053 Vali Acc: 0.551 Test Loss: 1.053 Test Acc: 0.551
Validation loss decreased (-0.413031 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 1.5846478939056396
Epoch: 3, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.894 Vali Acc: 0.659 Test Loss: 0.894 Test Acc: 0.659
Validation loss decreased (-0.550714 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 1.6956188678741455
Epoch: 4, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.754 Vali Acc: 0.739 Test Loss: 0.754 Test Acc: 0.739
Validation loss decreased (-0.659411 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 1.7159647941589355
Epoch: 5, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.7416110038757324
Epoch: 6, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.701 Vali Acc: 0.739 Test Loss: 0.701 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8269855976104736
Epoch: 7, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 1.5423874855041504
Epoch: 8, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.675 Vali Acc: 0.775 Test Loss: 0.675 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.765951156616211
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.669 Vali Acc: 0.768 Test Loss: 0.669 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7703781127929688
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.4099092483520508
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.617 Vali Acc: 0.797 Test Loss: 0.617 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.972090482711792
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8914604187011719
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0890095233917236
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7518949508666992
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.790 Test Loss: 0.647 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8162336349487305
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6914012432098389
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.53178071975708
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.797 Test Loss: 0.674 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.787933349609375
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.812 Test Loss: 0.668 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0048933029174805
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.804 Test Loss: 0.674 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 700604
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9841115474700928
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.303 Vali Acc: 0.399 Test Loss: 1.303 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 1.5355827808380127
Epoch: 2, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.063 Vali Acc: 0.572 Test Loss: 1.063 Test Acc: 0.572
Validation loss decreased (-0.398538 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 1.7012238502502441
Epoch: 3, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.902 Vali Acc: 0.674 Test Loss: 0.902 Test Acc: 0.674
Validation loss decreased (-0.572453 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 1.4699556827545166
Epoch: 4, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.763 Vali Acc: 0.746 Test Loss: 0.763 Test Acc: 0.746
Validation loss decreased (-0.673904 --> -0.746369).  Saving model ...
Epoch: 5 cost time: 1.4505431652069092
Epoch: 5, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.746369 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.3388874530792236
Epoch: 6, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.692 Vali Acc: 0.739 Test Loss: 0.692 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.621403694152832
Epoch: 7, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.664 Vali Acc: 0.790 Test Loss: 0.664 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 1.7322022914886475
Epoch: 8, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7997336387634277
Epoch: 9, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.643 Vali Acc: 0.797 Test Loss: 0.643 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.3571488857269287
Epoch: 10, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 1.2693359851837158
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.590 Vali Acc: 0.819 Test Loss: 0.590 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.35121488571167
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.804 Test Loss: 0.630 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2197871208190918
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4232137203216553
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.819 Test Loss: 0.637 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5261147022247314
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.586798906326294
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.826 Test Loss: 0.614 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4696853160858154
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840573).  Saving model ...
Epoch: 18 cost time: 1.5502424240112305
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7303996086120605
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.598249912261963
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.679495096206665
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.826 Test Loss: 0.630 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.659146785736084
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6840100288391113
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.826 Test Loss: 0.622 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5356495380401611
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.532238483428955
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7120685577392578
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.369521141052246
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 700604
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.042089223861694
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.286 Vali Acc: 0.413 Test Loss: 1.286 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 1.9792962074279785
Epoch: 2, Steps: 9 | Train Loss: 1.105 Vali Loss: 1.039 Vali Acc: 0.601 Test Loss: 1.039 Test Acc: 0.601
Validation loss decreased (-0.413031 --> -0.601439).  Saving model ...
Epoch: 3 cost time: 1.629101276397705
Epoch: 3, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.878 Vali Acc: 0.645 Test Loss: 0.878 Test Acc: 0.645
Validation loss decreased (-0.601439 --> -0.644919).  Saving model ...
Epoch: 4 cost time: 1.4665117263793945
Epoch: 4, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.733 Vali Acc: 0.754 Test Loss: 0.733 Test Acc: 0.754
Validation loss decreased (-0.644919 --> -0.753616).  Saving model ...
Epoch: 5 cost time: 1.726292371749878
Epoch: 5, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782602).  Saving model ...
Epoch: 6 cost time: 1.2494666576385498
Epoch: 6, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.655 Vali Acc: 0.754 Test Loss: 0.655 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6528284549713135
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.3589377403259277
Epoch: 8, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
Validation loss decreased (-0.782603 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 1.6217942237854004
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7238342761993408
Epoch: 10, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.6166112422943115
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5919296741485596
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6906695365905762
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5270776748657227
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.835892677307129
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6623361110687256
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5756175518035889
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6566519737243652
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7483937740325928
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.855 Test Loss: 0.562 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6819097995758057
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 21 cost time: 1.884211778640747
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.862 Test Loss: 0.554 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 22 cost time: 1.7390267848968506
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.862 Test Loss: 0.550 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 23 cost time: 1.5599842071533203
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.862 Test Loss: 0.549 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 24 cost time: 1.546680212020874
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.870 Test Loss: 0.552 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 25 cost time: 1.3112506866455078
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.870 Test Loss: 0.546 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 26 cost time: 1.3956055641174316
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 27 cost time: 1.545318365097046
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.390918254852295
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.870 Test Loss: 0.554 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4024572372436523
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.870 Test Loss: 0.555 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6917622089385986
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3832917213439941
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4220919609069824
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7104969024658203
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9294672012329102
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.870 Test Loss: 0.546 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.864755392074585
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.870 Test Loss: 0.545 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7447328567504883
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 37 cost time: 1.6412084102630615
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 38 cost time: 1.5963244438171387
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.527890682220459
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6692991256713867
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6599204540252686
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.8024191856384277
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.870 Test Loss: 0.546 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6646246910095215
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.870 Test Loss: 0.545 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.6897222995758057
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.870 Test Loss: 0.545 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.758781909942627
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.5525884628295898
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6207551956176758
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 700604
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4419994354248047
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.267 Vali Acc: 0.493 Test Loss: 1.267 Test Acc: 0.493
Validation loss decreased (inf --> -0.492741).  Saving model ...
Epoch: 2 cost time: 1.3734257221221924
Epoch: 2, Steps: 9 | Train Loss: 1.088 Vali Loss: 0.993 Vali Acc: 0.652 Test Loss: 0.993 Test Acc: 0.652
Validation loss decreased (-0.492741 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 1.2752304077148438
Epoch: 3, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.829 Vali Acc: 0.703 Test Loss: 0.829 Test Acc: 0.703
Validation loss decreased (-0.652164 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 1.2938315868377686
Epoch: 4, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.677 Vali Acc: 0.804 Test Loss: 0.677 Test Acc: 0.804
Validation loss decreased (-0.702890 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 1.3022396564483643
Epoch: 5, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 1.1309869289398193
Epoch: 6, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.3025133609771729
Epoch: 7, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.3171145915985107
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 1.3657190799713135
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3341753482818604
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5086774826049805
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3934392929077148
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5145595073699951
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4905102252960205
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4969451427459717
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4023501873016357
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.471 Vali Acc: 0.862 Test Loss: 0.471 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.5250523090362549
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.574944257736206
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4370331764221191
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 1.440359354019165
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 1.6176989078521729
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 1.5007615089416504
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.877 Test Loss: 0.458 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 23 cost time: 1.5620708465576172
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7049672603607178
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5176959037780762
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 1.5181703567504883
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 27 cost time: 1.4664716720581055
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.594580888748169
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4600129127502441
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4857087135314941
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 31 cost time: 1.573085069656372
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 32 cost time: 1.412904977798462
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 33 cost time: 1.5687317848205566
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.884 Test Loss: 0.457 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 34 cost time: 1.2952184677124023
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 1.5044889450073242
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.884 Test Loss: 0.458 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5670161247253418
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.891 Test Loss: 0.453 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 37 cost time: 1.5111808776855469
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.891 Test Loss: 0.447 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 38 cost time: 1.4944403171539307
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.891 Test Loss: 0.447 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 39 cost time: 1.489297866821289
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.891 Test Loss: 0.450 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4642269611358643
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.891 Test Loss: 0.453 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.495072364807129
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.891 Test Loss: 0.457 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4508497714996338
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.891 Test Loss: 0.458 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7097678184509277
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.891 Test Loss: 0.458 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.177189588546753
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.891 Test Loss: 0.461 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5085043907165527
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.891 Test Loss: 0.460 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.345851182937622
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.891 Test Loss: 0.456 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4148759841918945
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.891 Test Loss: 0.456 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.6141808032989502
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.899 Test Loss: 0.455 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 49 cost time: 1.4935352802276611
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.899 Test Loss: 0.456 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4723632335662842
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.899 Test Loss: 0.454 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 51 cost time: 1.6465680599212646
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.899 Test Loss: 0.456 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4906280040740967
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.899 Test Loss: 0.453 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 53 cost time: 1.4557361602783203
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.899 Test Loss: 0.449 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 54 cost time: 1.488971471786499
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.899 Test Loss: 0.450 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3150136470794678
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.899 Test Loss: 0.452 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.5286216735839844
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.899 Test Loss: 0.451 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5660502910614014
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.899 Test Loss: 0.452 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.552109956741333
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.899 Test Loss: 0.452 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.6653568744659424
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.899 Test Loss: 0.454 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.5277142524719238
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.899 Test Loss: 0.456 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6177380084991455
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.899 Test Loss: 0.458 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.4731700420379639
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.899 Test Loss: 0.459 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.6386969089508057
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.899 Test Loss: 0.460 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 700604
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7758491039276123
Epoch: 1, Steps: 9 | Train Loss: 1.508 Vali Loss: 1.345 Vali Acc: 0.312 Test Loss: 1.345 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.4650547504425049
Epoch: 2, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.098 Vali Acc: 0.551 Test Loss: 1.098 Test Acc: 0.551
Validation loss decreased (-0.311581 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 1.419480323791504
Epoch: 3, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.918 Vali Acc: 0.667 Test Loss: 0.918 Test Acc: 0.667
Validation loss decreased (-0.550714 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.421006202697754
Epoch: 4, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.753 Vali Acc: 0.739 Test Loss: 0.753 Test Acc: 0.739
Validation loss decreased (-0.666657 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 1.5825374126434326
Epoch: 5, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.742 Vali Acc: 0.739 Test Loss: 0.742 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 1.4409592151641846
Epoch: 6, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.663 Vali Acc: 0.804 Test Loss: 0.663 Test Acc: 0.804
Validation loss decreased (-0.739123 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 1.434147596359253
Epoch: 7, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.639 Vali Acc: 0.768 Test Loss: 0.639 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4421970844268799
Epoch: 8, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.54832124710083
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.612 Vali Acc: 0.797 Test Loss: 0.612 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5531048774719238
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.641 Vali Acc: 0.790 Test Loss: 0.641 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4674348831176758
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.623 Vali Acc: 0.790 Test Loss: 0.623 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5742087364196777
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5292675495147705
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.768 Test Loss: 0.679 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.427175760269165
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2602152824401855
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4318263530731201
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.671 Vali Acc: 0.775 Test Loss: 0.671 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 438460
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.007998704910278
Epoch: 1, Steps: 9 | Train Loss: 1.517 Vali Loss: 1.333 Vali Acc: 0.355 Test Loss: 1.333 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.7679009437561035
Epoch: 2, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.084 Vali Acc: 0.594 Test Loss: 1.084 Test Acc: 0.594
Validation loss decreased (-0.355059 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 1.3276374340057373
Epoch: 3, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.893 Vali Acc: 0.674 Test Loss: 0.893 Test Acc: 0.674
Validation loss decreased (-0.594192 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 1.4383025169372559
Epoch: 4, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
Validation loss decreased (-0.673904 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 1.3616859912872314
Epoch: 5, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.716 Vali Acc: 0.754 Test Loss: 0.716 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8583197593688965
Epoch: 6, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
Validation loss decreased (-0.782601 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.5547776222229004
Epoch: 7, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.601 Vali Acc: 0.790 Test Loss: 0.601 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.435014247894287
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4729998111724854
Epoch: 9, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3302507400512695
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.797 Test Loss: 0.603 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5370972156524658
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.5854525566101074
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.797 Test Loss: 0.614 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9161412715911865
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.768 Test Loss: 0.650 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.398543357849121
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2964327335357666
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5662775039672852
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.389650821685791
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.790 Test Loss: 0.654 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5597753524780273
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6074984073638916
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6188466548919678
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.797 Test Loss: 0.657 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.484694242477417
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.667 Vali Acc: 0.790 Test Loss: 0.667 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 438460
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.885296583175659
Epoch: 1, Steps: 9 | Train Loss: 1.498 Vali Loss: 1.313 Vali Acc: 0.406 Test Loss: 1.313 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.6067595481872559
Epoch: 2, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.054 Vali Acc: 0.609 Test Loss: 1.054 Test Acc: 0.609
Validation loss decreased (-0.405784 --> -0.608685).  Saving model ...
Epoch: 3 cost time: 1.420513391494751
Epoch: 3, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.862 Vali Acc: 0.710 Test Loss: 0.862 Test Acc: 0.710
Validation loss decreased (-0.608685 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 1.3565051555633545
Epoch: 4, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.705 Vali Acc: 0.797 Test Loss: 0.705 Test Acc: 0.797
Validation loss decreased (-0.710136 --> -0.797094).  Saving model ...
Epoch: 5 cost time: 1.6175882816314697
Epoch: 5, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5177984237670898
Epoch: 6, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.622 Vali Acc: 0.819 Test Loss: 0.622 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.583305835723877
Epoch: 7, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.441730260848999
Epoch: 8, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.5776300430297852
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6205947399139404
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4632537364959717
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 1.7108335494995117
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5844531059265137
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4920008182525635
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.797 Test Loss: 0.597 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3677773475646973
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4994566440582275
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.442840337753296
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5313899517059326
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.804 Test Loss: 0.596 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7713673114776611
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 20 cost time: 1.7394006252288818
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6617321968078613
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.790 Test Loss: 0.606 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6205995082855225
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.427109718322754
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4748544692993164
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6292285919189453
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.571246862411499
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5098066329956055
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5610711574554443
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5826072692871094
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 438460
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9859750270843506
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.275 Vali Acc: 0.507 Test Loss: 1.275 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 1.4867827892303467
Epoch: 2, Steps: 9 | Train Loss: 1.110 Vali Loss: 0.991 Vali Acc: 0.645 Test Loss: 0.991 Test Acc: 0.645
Validation loss decreased (-0.507234 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 1.5548546314239502
Epoch: 3, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
Validation loss decreased (-0.644918 --> -0.789847).  Saving model ...
Epoch: 4 cost time: 1.4360880851745605
Epoch: 4, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
Validation loss decreased (-0.789847 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 1.4059138298034668
Epoch: 5, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.571488857269287
Epoch: 6, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 1.3847613334655762
Epoch: 7, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5560250282287598
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 1.4987232685089111
Epoch: 9, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.538201093673706
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.607196569442749
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 1.4950506687164307
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.45560622215271
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4202797412872314
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3656268119812012
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3343851566314697
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 1.6540746688842773
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6015725135803223
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 1.5693109035491943
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 1.4099161624908447
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.862 Test Loss: 0.483 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4977877140045166
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4427940845489502
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4285926818847656
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3761320114135742
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4141452312469482
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2678372859954834
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5903527736663818
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5805134773254395
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 29 cost time: 1.417860746383667
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.577930212020874
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.863358736038208
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.877 Test Loss: 0.483 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7033796310424805
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7812676429748535
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 34 cost time: 1.639784812927246
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 35 cost time: 1.4006266593933105
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.884 Test Loss: 0.473 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3551719188690186
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.336643934249878
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.526294469833374
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5096426010131836
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.884 Test Loss: 0.470 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 40 cost time: 1.3557162284851074
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 41 cost time: 1.5564558506011963
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6535899639129639
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5423355102539062
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.884 Test Loss: 0.468 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6362929344177246
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.5725092887878418
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4901518821716309
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898546).  Saving model ...
Epoch: 47 cost time: 1.5961904525756836
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 48 cost time: 1.4211995601654053
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4321341514587402
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.515223741531372
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4856209754943848
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.899 Test Loss: 0.467 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.4907417297363281
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.899 Test Loss: 0.468 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3541555404663086
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.899 Test Loss: 0.465 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.2737107276916504
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 55 cost time: 1.270151138305664
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5737147331237793
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.5148048400878906
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.4087092876434326
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.4479954242706299
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.899 Test Loss: 0.465 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.4973669052124023
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.899 Test Loss: 0.463 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.5367803573608398
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.4362645149230957
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.899 Test Loss: 0.461 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.524512529373169
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.491955280303955
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 438460
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.201047420501709
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.277 Vali Acc: 0.406 Test Loss: 1.277 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.7162201404571533
Epoch: 2, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.051 Vali Acc: 0.594 Test Loss: 1.051 Test Acc: 0.594
Validation loss decreased (-0.405784 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 1.709502935409546
Epoch: 3, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.594192 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 1.5679619312286377
Epoch: 4, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.752 Vali Acc: 0.761 Test Loss: 0.752 Test Acc: 0.761
Validation loss decreased (-0.724629 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 1.5896086692810059
Epoch: 5, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.720 Vali Acc: 0.754 Test Loss: 0.720 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.866685390472412
Epoch: 6, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.648 Vali Acc: 0.790 Test Loss: 0.648 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789849).  Saving model ...
Epoch: 7 cost time: 1.6512291431427002
Epoch: 7, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8354194164276123
Epoch: 8, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.7837979793548584
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 1.7818233966827393
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6448986530303955
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9049601554870605
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7507970333099365
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.675 Vali Acc: 0.826 Test Loss: 0.675 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7635395526885986
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.646 Vali Acc: 0.812 Test Loss: 0.646 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5970180034637451
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8743259906768799
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.683 Vali Acc: 0.812 Test Loss: 0.683 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5737762451171875
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5720243453979492
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.819 Test Loss: 0.685 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8536341190338135
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.819 Test Loss: 0.687 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 307388
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.828608989715576
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.270 Vali Acc: 0.435 Test Loss: 1.270 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 1.378448724746704
Epoch: 2, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.039 Vali Acc: 0.587 Test Loss: 1.039 Test Acc: 0.587
Validation loss decreased (-0.434770 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 1.4697225093841553
Epoch: 3, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.866 Vali Acc: 0.710 Test Loss: 0.866 Test Acc: 0.710
Validation loss decreased (-0.586946 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 1.3938961029052734
Epoch: 4, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
Validation loss decreased (-0.710136 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 1.3642752170562744
Epoch: 5, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.701 Vali Acc: 0.768 Test Loss: 0.701 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1780898571014404
Epoch: 6, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.632 Vali Acc: 0.797 Test Loss: 0.632 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.2377681732177734
Epoch: 7, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 1.211775541305542
Epoch: 8, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.3253068923950195
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3999660015106201
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 1.3160934448242188
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.352186918258667
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2205216884613037
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5030395984649658
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5163443088531494
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6048767566680908
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.819 Test Loss: 0.649 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5344741344451904
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6426746845245361
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6005966663360596
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7124156951904297
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 307388
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.695119619369507
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.260 Vali Acc: 0.464 Test Loss: 1.260 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 1.6276116371154785
Epoch: 2, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.017 Vali Acc: 0.616 Test Loss: 1.017 Test Acc: 0.616
Validation loss decreased (-0.463756 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 1.6360106468200684
Epoch: 3, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.842 Vali Acc: 0.732 Test Loss: 0.842 Test Acc: 0.732
Validation loss decreased (-0.615932 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 1.5922985076904297
Epoch: 4, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.720 Vali Acc: 0.790 Test Loss: 0.720 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 1.4903485774993896
Epoch: 5, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.674 Vali Acc: 0.761 Test Loss: 0.674 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5694007873535156
Epoch: 6, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 1.4042353630065918
Epoch: 7, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.465430736541748
Epoch: 8, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 1.826812744140625
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.761915683746338
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6679778099060059
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.526472568511963
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7076737880706787
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6918718814849854
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7476236820220947
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.790 Test Loss: 0.594 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6386871337890625
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.804 Test Loss: 0.595 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6506710052490234
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.707216739654541
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 307388
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.081278324127197
Epoch: 1, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.230 Vali Acc: 0.529 Test Loss: 1.230 Test Acc: 0.529
Validation loss decreased (inf --> -0.528973).  Saving model ...
Epoch: 2 cost time: 1.5824015140533447
Epoch: 2, Steps: 9 | Train Loss: 1.059 Vali Loss: 0.965 Vali Acc: 0.659 Test Loss: 0.965 Test Acc: 0.659
Validation loss decreased (-0.528973 --> -0.659411).  Saving model ...
Epoch: 3 cost time: 1.497769832611084
Epoch: 3, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.784 Vali Acc: 0.754 Test Loss: 0.784 Test Acc: 0.754
Validation loss decreased (-0.659411 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 1.6415379047393799
Epoch: 4, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.684 Vali Acc: 0.790 Test Loss: 0.684 Test Acc: 0.790
Validation loss decreased (-0.753615 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 1.6514151096343994
Epoch: 5, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 6 cost time: 1.4741551876068115
Epoch: 6, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 1.6817371845245361
Epoch: 7, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 1.669158935546875
Epoch: 8, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.4918620586395264
Epoch: 9, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6263525485992432
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 1.5599884986877441
Epoch: 11, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.5992555618286133
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.502831220626831
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.3593530654907227
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.405540943145752
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 1.3226335048675537
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3962454795837402
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 1.4766871929168701
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4371943473815918
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7549378871917725
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4232852458953857
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.439894437789917
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3380367755889893
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2827975749969482
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4336740970611572
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.534153699874878
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.414325475692749
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 307388
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7408554553985596
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.276 Vali Acc: 0.370 Test Loss: 1.276 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.5020694732666016
Epoch: 2, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.061 Vali Acc: 0.587 Test Loss: 1.061 Test Acc: 0.587
Validation loss decreased (-0.369552 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 1.44301438331604
Epoch: 3, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.856 Vali Acc: 0.659 Test Loss: 0.856 Test Acc: 0.659
Validation loss decreased (-0.586946 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 1.2283210754394531
Epoch: 4, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.746 Vali Acc: 0.754 Test Loss: 0.746 Test Acc: 0.754
Validation loss decreased (-0.659412 --> -0.753616).  Saving model ...
Epoch: 5 cost time: 1.3141136169433594
Epoch: 5, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.677 Vali Acc: 0.768 Test Loss: 0.677 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 6 cost time: 1.4657235145568848
Epoch: 6, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.633 Vali Acc: 0.797 Test Loss: 0.633 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.5025625228881836
Epoch: 7, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 1.3542866706848145
Epoch: 8, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 1.5486152172088623
Epoch: 9, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 1.6535804271697998
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.604 Vali Acc: 0.804 Test Loss: 0.604 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.42124342918396
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.627 Vali Acc: 0.790 Test Loss: 0.627 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.501326560974121
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.597254991531372
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.314894676208496
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.660 Vali Acc: 0.819 Test Loss: 0.660 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4413278102874756
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.804 Test Loss: 0.660 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3608059883117676
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4882903099060059
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.819 Test Loss: 0.690 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5268669128417969
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.804 Test Loss: 0.691 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5045251846313477
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 241852
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.941488027572632
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.277 Vali Acc: 0.399 Test Loss: 1.277 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 1.4124846458435059
Epoch: 2, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.053 Vali Acc: 0.572 Test Loss: 1.053 Test Acc: 0.572
Validation loss decreased (-0.398538 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 1.5324184894561768
Epoch: 3, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.850 Vali Acc: 0.681 Test Loss: 0.850 Test Acc: 0.681
Validation loss decreased (-0.572453 --> -0.681151).  Saving model ...
Epoch: 4 cost time: 1.3379647731781006
Epoch: 4, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.681151 --> -0.775355).  Saving model ...
Epoch: 5 cost time: 1.4018073081970215
Epoch: 5, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.656 Vali Acc: 0.768 Test Loss: 0.656 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6091837882995605
Epoch: 6, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 1.5251226425170898
Epoch: 7, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.5497772693634033
Epoch: 8, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.588 Vali Acc: 0.804 Test Loss: 0.588 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8448865413665771
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 1.7377519607543945
Epoch: 10, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8177762031555176
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.775386095046997
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.790 Test Loss: 0.635 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.798671007156372
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.790 Test Loss: 0.641 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5277159214019775
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4736862182617188
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5248537063598633
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.797 Test Loss: 0.637 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7354857921600342
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7962126731872559
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6111807823181152
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.797 Test Loss: 0.652 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 241852
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.72219181060791
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.275 Vali Acc: 0.420 Test Loss: 1.275 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.5169875621795654
Epoch: 2, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.038 Vali Acc: 0.623 Test Loss: 1.038 Test Acc: 0.623
Validation loss decreased (-0.420277 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 1.4615375995635986
Epoch: 3, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.827 Vali Acc: 0.710 Test Loss: 0.827 Test Acc: 0.710
Validation loss decreased (-0.623178 --> -0.710137).  Saving model ...
Epoch: 4 cost time: 1.6207585334777832
Epoch: 4, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.707 Vali Acc: 0.768 Test Loss: 0.707 Test Acc: 0.768
Validation loss decreased (-0.710137 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 1.5681991577148438
Epoch: 5, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.632 Vali Acc: 0.790 Test Loss: 0.632 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 6 cost time: 1.573246717453003
Epoch: 6, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4848625659942627
Epoch: 7, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.5507023334503174
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 1.433424949645996
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4602570533752441
Epoch: 10, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.505120038986206
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6224360466003418
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4433033466339111
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.350525140762329
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.590198278427124
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4979445934295654
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.797 Test Loss: 0.594 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4731626510620117
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.797 Test Loss: 0.618 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6130881309509277
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4562768936157227
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.331860065460205
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 241852
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.880856990814209
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.247 Vali Acc: 0.478 Test Loss: 1.247 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 1.409059762954712
Epoch: 2, Steps: 9 | Train Loss: 1.046 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
Validation loss decreased (-0.478248 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.370509386062622
Epoch: 3, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
Validation loss decreased (-0.666657 --> -0.775355).  Saving model ...
Epoch: 4 cost time: 1.4231059551239014
Epoch: 4, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
Validation loss decreased (-0.775355 --> -0.840573).  Saving model ...
Epoch: 5 cost time: 1.4409587383270264
Epoch: 5, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 6 cost time: 1.5690100193023682
Epoch: 6, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 7 cost time: 1.4359140396118164
Epoch: 7, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5615622997283936
Epoch: 8, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4550068378448486
Epoch: 9, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.422234058380127
Epoch: 10, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3631470203399658
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5860378742218018
Epoch: 12, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.459561824798584
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5139312744140625
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2990832328796387
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.4144141674041748
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.3091869354248047
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4886674880981445
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4562690258026123
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5645697116851807
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.5307855606079102
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3535401821136475
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.384099006652832
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.431734323501587
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.276973009109497
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3504223823547363
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.34926438331604
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4631385803222656
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5701119899749756
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5027520656585693
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 241852
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.327862739562988
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.244 Vali Acc: 0.442 Test Loss: 1.244 Test Acc: 0.442
Validation loss decreased (inf --> -0.442017).  Saving model ...
Epoch: 2 cost time: 1.5997774600982666
Epoch: 2, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.006 Vali Acc: 0.681 Test Loss: 1.006 Test Acc: 0.681
Validation loss decreased (-0.442017 --> -0.681149).  Saving model ...
Epoch: 3 cost time: 1.7154898643493652
Epoch: 3, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.837 Vali Acc: 0.696 Test Loss: 0.837 Test Acc: 0.696
Validation loss decreased (-0.681149 --> -0.695644).  Saving model ...
Epoch: 4 cost time: 1.5123658180236816
Epoch: 4, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.737 Vali Acc: 0.732 Test Loss: 0.737 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 1.8919792175292969
Epoch: 5, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804342).  Saving model ...
Epoch: 6 cost time: 1.724083423614502
Epoch: 6, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5399434566497803
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.555281162261963
Epoch: 8, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5325417518615723
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.598 Vali Acc: 0.797 Test Loss: 0.598 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.322943925857544
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.551180362701416
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3346292972564697
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4481956958770752
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.633 Vali Acc: 0.812 Test Loss: 0.633 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5797967910766602
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.812 Test Loss: 0.642 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3886182308197021
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5895988941192627
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.812 Test Loss: 0.656 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6233105659484863
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 209084
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.767132043838501
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.245 Vali Acc: 0.435 Test Loss: 1.245 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 1.6052930355072021
Epoch: 2, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.001 Vali Acc: 0.688 Test Loss: 1.001 Test Acc: 0.688
Validation loss decreased (-0.434770 --> -0.688396).  Saving model ...
Epoch: 3 cost time: 1.5208728313446045
Epoch: 3, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
Validation loss decreased (-0.688396 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 1.7871575355529785
Epoch: 4, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.724629 --> -0.775355).  Saving model ...
Epoch: 5 cost time: 1.515091896057129
Epoch: 5, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804342).  Saving model ...
Epoch: 6 cost time: 1.79736328125
Epoch: 6, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.632 Vali Acc: 0.790 Test Loss: 0.632 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7070152759552002
Epoch: 7, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.838318109512329
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.736510992050171
Epoch: 9, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.579 Vali Acc: 0.804 Test Loss: 0.579 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9100277423858643
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6951320171356201
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6629364490509033
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.812 Test Loss: 0.619 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6158432960510254
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.797 Test Loss: 0.615 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.781235694885254
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.790 Test Loss: 0.622 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5944197177886963
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.790 Test Loss: 0.626 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5254781246185303
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.790 Test Loss: 0.636 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4507567882537842
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 209084
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7684614658355713
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.251 Vali Acc: 0.449 Test Loss: 1.251 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 1.5827324390411377
Epoch: 2, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.001 Vali Acc: 0.688 Test Loss: 1.001 Test Acc: 0.688
Validation loss decreased (-0.449263 --> -0.688396).  Saving model ...
Epoch: 3 cost time: 1.426131248474121
Epoch: 3, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
Validation loss decreased (-0.688396 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 1.3614754676818848
Epoch: 4, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.723 Vali Acc: 0.761 Test Loss: 0.723 Test Acc: 0.761
Validation loss decreased (-0.746369 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 1.343092918395996
Epoch: 5, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 6 cost time: 1.434818983078003
Epoch: 6, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 1.3219170570373535
Epoch: 7, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.5166306495666504
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.595 Vali Acc: 0.797 Test Loss: 0.595 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5398828983306885
Epoch: 9, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.601978063583374
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3932905197143555
Epoch: 11, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3597157001495361
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3921852111816406
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.586 Vali Acc: 0.804 Test Loss: 0.586 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5763413906097412
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4338183403015137
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5092387199401855
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4034926891326904
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.614 Vali Acc: 0.797 Test Loss: 0.614 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 209084
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.619614362716675
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.242 Vali Acc: 0.471 Test Loss: 1.242 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 1.3753678798675537
Epoch: 2, Steps: 9 | Train Loss: 1.034 Vali Loss: 0.973 Vali Acc: 0.667 Test Loss: 0.973 Test Acc: 0.667
Validation loss decreased (-0.471002 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 1.3949229717254639
Epoch: 3, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
Validation loss decreased (-0.666657 --> -0.760862).  Saving model ...
Epoch: 4 cost time: 1.3387537002563477
Epoch: 4, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 1.3232510089874268
Epoch: 5, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 1.316157579421997
Epoch: 6, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.3734660148620605
Epoch: 7, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 1.3313934803009033
Epoch: 8, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2987439632415771
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5277116298675537
Epoch: 10, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6409709453582764
Epoch: 11, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.1991691589355469
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3724019527435303
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2793972492218018
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5232620239257812
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4043188095092773
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6501023769378662
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.299586296081543
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6543097496032715
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4943113327026367
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4390802383422852
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 209084
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.510647535324097
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.306 Vali Acc: 0.326 Test Loss: 1.306 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.2773067951202393
Epoch: 2, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.154 Vali Acc: 0.558 Test Loss: 1.154 Test Acc: 0.558
Validation loss decreased (-0.326074 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 1.4503002166748047
Epoch: 3, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.984 Vali Acc: 0.674 Test Loss: 0.984 Test Acc: 0.674
Validation loss decreased (-0.557959 --> -0.673903).  Saving model ...
Epoch: 4 cost time: 1.4395418167114258
Epoch: 4, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.869 Vali Acc: 0.703 Test Loss: 0.869 Test Acc: 0.703
Validation loss decreased (-0.673903 --> -0.702890).  Saving model ...
Epoch: 5 cost time: 1.145338535308838
Epoch: 5, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
Validation loss decreased (-0.702890 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 1.4289584159851074
Epoch: 6, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
Validation loss decreased (-0.760862 --> -0.811587).  Saving model ...
Epoch: 7 cost time: 1.3535940647125244
Epoch: 7, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.653 Vali Acc: 0.790 Test Loss: 0.653 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5295791625976562
Epoch: 8, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.5477423667907715
Epoch: 9, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 1.5826075077056885
Epoch: 10, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6950664520263672
Epoch: 11, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2843420505523682
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7217991352081299
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4962372779846191
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5796802043914795
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.512787103652954
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7411267757415771
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 1.828958511352539
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5764367580413818
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.585587978363037
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8154897689819336
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4917638301849365
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6065943241119385
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5925242900848389
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6742842197418213
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6974706649780273
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7218677997589111
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 596092
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.206755638122559
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.293 Vali Acc: 0.370 Test Loss: 1.293 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.5414493083953857
Epoch: 2, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.136 Vali Acc: 0.565 Test Loss: 1.136 Test Acc: 0.565
Validation loss decreased (-0.369552 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 1.4198675155639648
Epoch: 3, Steps: 9 | Train Loss: 0.956 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
Validation loss decreased (-0.565206 --> -0.739121).  Saving model ...
Epoch: 4 cost time: 1.4277424812316895
Epoch: 4, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.843 Vali Acc: 0.746 Test Loss: 0.843 Test Acc: 0.746
Validation loss decreased (-0.739121 --> -0.746368).  Saving model ...
Epoch: 5 cost time: 1.5017530918121338
Epoch: 5, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.723 Vali Acc: 0.804 Test Loss: 0.723 Test Acc: 0.804
Validation loss decreased (-0.746368 --> -0.804341).  Saving model ...
Epoch: 6 cost time: 1.29697847366333
Epoch: 6, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.5351142883300781
Epoch: 7, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.619 Vali Acc: 0.797 Test Loss: 0.619 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.309833288192749
Epoch: 8, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 1.4371609687805176
Epoch: 9, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 1.319359302520752
Epoch: 10, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6516482830047607
Epoch: 11, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2906548976898193
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2952489852905273
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4354116916656494
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.355745553970337
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4887194633483887
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3039872646331787
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3717310428619385
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3739817142486572
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 20 cost time: 1.4936318397521973
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4629106521606445
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.435645341873169
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 1.2991833686828613
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5666990280151367
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.522078037261963
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3459887504577637
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.387821912765503
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3712260723114014
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5754845142364502
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 1.3607065677642822
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 1.2612392902374268
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 32 cost time: 1.3515102863311768
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.472377061843872
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3966450691223145
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4594144821166992
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.575526237487793
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4845378398895264
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4063286781311035
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5237207412719727
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.539259910583496
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 41 cost time: 1.4084579944610596
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 42 cost time: 1.6564576625823975
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 43 cost time: 1.4765055179595947
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4991974830627441
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3643798828125
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 46 cost time: 1.4245026111602783
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4276316165924072
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5246849060058594
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.414376974105835
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 50 cost time: 1.5056793689727783
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4392945766448975
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 52 cost time: 1.4978783130645752
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.415107250213623
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.573164463043213
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3272595405578613
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.3086881637573242
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.4735612869262695
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.5383720397949219
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.5071406364440918
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.5030794143676758
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.5072109699249268
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 596092
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.474350452423096
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.295 Vali Acc: 0.348 Test Loss: 1.295 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.354569673538208
Epoch: 2, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.134 Vali Acc: 0.601 Test Loss: 1.134 Test Acc: 0.601
Validation loss decreased (-0.347813 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 1.5601515769958496
Epoch: 3, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.958 Vali Acc: 0.717 Test Loss: 0.958 Test Acc: 0.717
Validation loss decreased (-0.601438 --> -0.717382).  Saving model ...
Epoch: 4 cost time: 1.7552156448364258
Epoch: 4, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.836 Vali Acc: 0.768 Test Loss: 0.836 Test Acc: 0.768
Validation loss decreased (-0.717382 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 1.5392520427703857
Epoch: 5, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.714 Vali Acc: 0.812 Test Loss: 0.714 Test Acc: 0.812
Validation loss decreased (-0.768108 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 1.5489609241485596
Epoch: 6, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 1.5292975902557373
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5966413021087646
Epoch: 8, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.493908166885376
Epoch: 9, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.510 Vali Acc: 0.862 Test Loss: 0.510 Test Acc: 0.862
Validation loss decreased (-0.833327 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 1.3542497158050537
Epoch: 10, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6167221069335938
Epoch: 11, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5355751514434814
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.5717494487762451
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4373257160186768
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4582889080047607
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.431166648864746
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.3146371841430664
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 1.4386522769927979
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 1.5081918239593506
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6597442626953125
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.520277976989746
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 1.7135426998138428
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7291264533996582
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.588735818862915
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6990149021148682
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5537991523742676
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.580725908279419
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.285078525543213
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6216890811920166
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5103557109832764
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.35994553565979
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 596092
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.755047082901001
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.279 Vali Acc: 0.449 Test Loss: 1.279 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 1.592313289642334
Epoch: 2, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.100 Vali Acc: 0.623 Test Loss: 1.100 Test Acc: 0.623
Validation loss decreased (-0.449263 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 1.5042383670806885
Epoch: 3, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.922 Vali Acc: 0.703 Test Loss: 0.922 Test Acc: 0.703
Validation loss decreased (-0.623177 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 1.479429006576538
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
Validation loss decreased (-0.702889 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 1.3982951641082764
Epoch: 5, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.681 Vali Acc: 0.833 Test Loss: 0.681 Test Acc: 0.833
Validation loss decreased (-0.782601 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.4929959774017334
Epoch: 6, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.826 Test Loss: 0.594 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4704711437225342
Epoch: 7, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 1.5526337623596191
Epoch: 8, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4620835781097412
Epoch: 9, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
Validation loss decreased (-0.847820 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 1.469322681427002
Epoch: 10, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5901038646697998
Epoch: 11, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 1.5058467388153076
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 1.5675537586212158
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.386 Vali Acc: 0.913 Test Loss: 0.386 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 1.7123472690582275
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5637223720550537
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9020154476165771
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.380 Vali Acc: 0.906 Test Loss: 0.380 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7684109210968018
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.340 Vali Acc: 0.913 Test Loss: 0.340 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 1.5726287364959717
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 19 cost time: 1.563364028930664
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.354 Vali Acc: 0.920 Test Loss: 0.354 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7076380252838135
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.913 Test Loss: 0.350 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5812571048736572
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.913 Test Loss: 0.349 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6101276874542236
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.357 Vali Acc: 0.920 Test Loss: 0.357 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9378509521484375
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.334 Vali Acc: 0.920 Test Loss: 0.334 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 1.5537760257720947
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4834020137786865
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6360654830932617
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.913 Test Loss: 0.353 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5986566543579102
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.913 Test Loss: 0.357 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6222493648529053
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.920 Test Loss: 0.347 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.456651210784912
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5978190898895264
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.345 Vali Acc: 0.920 Test Loss: 0.345 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5557808876037598
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 32 cost time: 1.3982148170471191
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 33 cost time: 1.5173516273498535
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.920 Test Loss: 0.346 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5306899547576904
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.913 Test Loss: 0.354 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5307531356811523
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.920 Test Loss: 0.345 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.533761978149414
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.345 Vali Acc: 0.928 Test Loss: 0.345 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.451289176940918
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5477385520935059
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6194355487823486
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.928 Test Loss: 0.361 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.737504482269287
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.928 Test Loss: 0.364 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.033750057220459
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.928 Test Loss: 0.363 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7961220741271973
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.928 Test Loss: 0.357 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 596092
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5368142127990723
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.333 Vali Acc: 0.391 Test Loss: 1.333 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.4057300090789795
Epoch: 2, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.168 Vali Acc: 0.529 Test Loss: 1.168 Test Acc: 0.529
Validation loss decreased (-0.391291 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 1.518216848373413
Epoch: 3, Steps: 9 | Train Loss: 0.949 Vali Loss: 1.028 Vali Acc: 0.616 Test Loss: 1.028 Test Acc: 0.616
Validation loss decreased (-0.528974 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.5351381301879883
Epoch: 4, Steps: 9 | Train Loss: 0.713 Vali Loss: 0.873 Vali Acc: 0.710 Test Loss: 0.873 Test Acc: 0.710
Validation loss decreased (-0.615932 --> -0.710136).  Saving model ...
Epoch: 5 cost time: 1.8299870491027832
Epoch: 5, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.776 Vali Acc: 0.761 Test Loss: 0.776 Test Acc: 0.761
Validation loss decreased (-0.710136 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 1.55979585647583
Epoch: 6, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 1.4801030158996582
Epoch: 7, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.667 Vali Acc: 0.761 Test Loss: 0.667 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7191977500915527
Epoch: 8, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.6589381694793701
Epoch: 9, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.620 Vali Acc: 0.790 Test Loss: 0.620 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4747183322906494
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 1.5444955825805664
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.5590941905975342
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5329139232635498
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.557147741317749
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5818157196044922
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.5512611865997314
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5019643306732178
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3369481563568115
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.550882339477539
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4886555671691895
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5536839962005615
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4106106758117676
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6058809757232666
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.826 Test Loss: 0.508 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4878442287445068
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5533576011657715
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 333948
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.159826993942261
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.325 Vali Acc: 0.413 Test Loss: 1.325 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.5864009857177734
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (-0.413030 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 1.4592270851135254
Epoch: 3, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.017 Vali Acc: 0.645 Test Loss: 1.017 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 1.6627192497253418
Epoch: 4, Steps: 9 | Train Loss: 0.705 Vali Loss: 0.865 Vali Acc: 0.710 Test Loss: 0.865 Test Acc: 0.710
Validation loss decreased (-0.644917 --> -0.710136).  Saving model ...
Epoch: 5 cost time: 1.6528301239013672
Epoch: 5, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
Validation loss decreased (-0.710136 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.5997614860534668
Epoch: 6, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 1.4626867771148682
Epoch: 7, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 1.66497802734375
Epoch: 8, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.6114425659179688
Epoch: 9, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5747456550598145
Epoch: 10, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 1.6607742309570312
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.489640235900879
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6293246746063232
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6248581409454346
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 1.786104679107666
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.683518409729004
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4985663890838623
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6212248802185059
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.716655969619751
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6488213539123535
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 1.5567350387573242
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 1.7101337909698486
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.698725938796997
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.78887939453125
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5740547180175781
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6979091167449951
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.518580436706543
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4714691638946533
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6448826789855957
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.438838005065918
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.589158535003662
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 333948
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9192283153533936
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.300 Vali Acc: 0.449 Test Loss: 1.300 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 1.563077449798584
Epoch: 2, Steps: 9 | Train Loss: 1.201 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
Validation loss decreased (-0.449262 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.6070921421051025
Epoch: 3, Steps: 9 | Train Loss: 0.938 Vali Loss: 0.984 Vali Acc: 0.703 Test Loss: 0.984 Test Acc: 0.703
Validation loss decreased (-0.543467 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 1.5954639911651611
Epoch: 4, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.838 Vali Acc: 0.746 Test Loss: 0.838 Test Acc: 0.746
Validation loss decreased (-0.702889 --> -0.746368).  Saving model ...
Epoch: 5 cost time: 1.463066816329956
Epoch: 5, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.742 Vali Acc: 0.797 Test Loss: 0.742 Test Acc: 0.797
Validation loss decreased (-0.746368 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 1.505626916885376
Epoch: 6, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.666 Vali Acc: 0.819 Test Loss: 0.666 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.3537907600402832
Epoch: 7, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5398499965667725
Epoch: 8, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.5759384632110596
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 1.4579687118530273
Epoch: 10, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 1.521824836730957
Epoch: 11, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.496 Vali Acc: 0.884 Test Loss: 0.496 Test Acc: 0.884
Validation loss decreased (-0.840575 --> -0.884053).  Saving model ...
Epoch: 12 cost time: 1.358381748199463
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.652287483215332
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3348686695098877
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 15 cost time: 1.8430168628692627
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.469 Vali Acc: 0.877 Test Loss: 0.469 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4135196208953857
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7401256561279297
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5561387538909912
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.459 Vali Acc: 0.884 Test Loss: 0.459 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 19 cost time: 1.491316795349121
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.452 Vali Acc: 0.891 Test Loss: 0.452 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 1.3436901569366455
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6986801624298096
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4320850372314453
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5278594493865967
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4771647453308105
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6376936435699463
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.518970251083374
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.256791591644287
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4940741062164307
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8255815505981445
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 333948
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.676978588104248
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.250 Vali Acc: 0.529 Test Loss: 1.250 Test Acc: 0.529
Validation loss decreased (inf --> -0.528973).  Saving model ...
Epoch: 2 cost time: 1.45066499710083
Epoch: 2, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.075 Vali Acc: 0.616 Test Loss: 1.075 Test Acc: 0.616
Validation loss decreased (-0.528973 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 1.306044578552246
Epoch: 3, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.917 Vali Acc: 0.754 Test Loss: 0.917 Test Acc: 0.754
Validation loss decreased (-0.615931 --> -0.753614).  Saving model ...
Epoch: 4 cost time: 1.4241943359375
Epoch: 4, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.778 Vali Acc: 0.812 Test Loss: 0.778 Test Acc: 0.812
Validation loss decreased (-0.753614 --> -0.811586).  Saving model ...
Epoch: 5 cost time: 1.2959225177764893
Epoch: 5, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 1.2832489013671875
Epoch: 6, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 1.2965335845947266
Epoch: 7, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4828739166259766
Epoch: 8, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 1.4006876945495605
Epoch: 9, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 1.3403632640838623
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5387423038482666
Epoch: 11, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884053).  Saving model ...
Epoch: 12 cost time: 1.4598033428192139
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3174598217010498
Epoch: 13, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 1.324491024017334
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 1.5525929927825928
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 1.4017853736877441
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3217098712921143
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4521543979644775
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.44537353515625
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.509526252746582
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.537451982498169
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.404 Vali Acc: 0.913 Test Loss: 0.404 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 22 cost time: 1.473987340927124
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.518040657043457
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6337788105010986
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4992895126342773
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5816428661346436
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3661725521087646
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.527334451675415
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3375694751739502
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2517070770263672
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3076605796813965
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 333948
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.290430068969727
Epoch: 1, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.296 Vali Acc: 0.355 Test Loss: 1.296 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 1.322162389755249
Epoch: 2, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.148 Vali Acc: 0.551 Test Loss: 1.148 Test Acc: 0.551
Validation loss decreased (-0.355060 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 1.6785101890563965
Epoch: 3, Steps: 9 | Train Loss: 0.929 Vali Loss: 0.979 Vali Acc: 0.696 Test Loss: 0.979 Test Acc: 0.696
Validation loss decreased (-0.550713 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 1.372032642364502
Epoch: 4, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.854 Vali Acc: 0.696 Test Loss: 0.854 Test Acc: 0.696
Validation loss decreased (-0.695642 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 1.3016409873962402
Epoch: 5, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.752 Vali Acc: 0.754 Test Loss: 0.752 Test Acc: 0.754
Validation loss decreased (-0.695644 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 1.3964333534240723
Epoch: 6, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 1.5390148162841797
Epoch: 7, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.632 Vali Acc: 0.790 Test Loss: 0.632 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 1.5376496315002441
Epoch: 8, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
Validation loss decreased (-0.789849 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.4186804294586182
Epoch: 9, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4674906730651855
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5171394348144531
Epoch: 11, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6726763248443604
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6832187175750732
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7949950695037842
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6531262397766113
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7132642269134521
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5440256595611572
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.626190185546875
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 202876
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8720293045043945
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.291 Vali Acc: 0.377 Test Loss: 1.291 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 1.425856351852417
Epoch: 2, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.140 Vali Acc: 0.587 Test Loss: 1.140 Test Acc: 0.587
Validation loss decreased (-0.376799 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 1.3248474597930908
Epoch: 3, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.968 Vali Acc: 0.696 Test Loss: 0.968 Test Acc: 0.696
Validation loss decreased (-0.586945 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 1.353666067123413
Epoch: 4, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.844 Vali Acc: 0.717 Test Loss: 0.844 Test Acc: 0.717
Validation loss decreased (-0.695642 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 1.410681962966919
Epoch: 5, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
Validation loss decreased (-0.717383 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.4126553535461426
Epoch: 6, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.4874472618103027
Epoch: 7, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.615 Vali Acc: 0.804 Test Loss: 0.615 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 1.3482544422149658
Epoch: 8, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.558 Vali Acc: 0.862 Test Loss: 0.558 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862313).  Saving model ...
Epoch: 9 cost time: 1.388868808746338
Epoch: 9, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3441784381866455
Epoch: 10, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5548820495605469
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5120561122894287
Epoch: 12, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4468867778778076
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4510397911071777
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6255970001220703
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5638444423675537
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5579535961151123
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5031156539916992
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 202876
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.745469808578491
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.296 Vali Acc: 0.377 Test Loss: 1.296 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 1.3956336975097656
Epoch: 2, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.137 Vali Acc: 0.609 Test Loss: 1.137 Test Acc: 0.609
Validation loss decreased (-0.376799 --> -0.608684).  Saving model ...
Epoch: 3 cost time: 1.287684440612793
Epoch: 3, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.966 Vali Acc: 0.674 Test Loss: 0.966 Test Acc: 0.674
Validation loss decreased (-0.608684 --> -0.673903).  Saving model ...
Epoch: 4 cost time: 1.4368469715118408
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.841 Vali Acc: 0.725 Test Loss: 0.841 Test Acc: 0.725
Validation loss decreased (-0.673903 --> -0.724629).  Saving model ...
Epoch: 5 cost time: 1.4458198547363281
Epoch: 5, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.730 Vali Acc: 0.790 Test Loss: 0.730 Test Acc: 0.790
Validation loss decreased (-0.724629 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 1.5588717460632324
Epoch: 6, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4996275901794434
Epoch: 7, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.614 Vali Acc: 0.804 Test Loss: 0.614 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 1.3898160457611084
Epoch: 8, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.804342 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.5075337886810303
Epoch: 9, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7113449573516846
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.603057622909546
Epoch: 11, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5732309818267822
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 1.597311019897461
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.570755958557129
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.390986442565918
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 1.398815393447876
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4716899394989014
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3484749794006348
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3650729656219482
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3678882122039795
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.464 Vali Acc: 0.877 Test Loss: 0.464 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 1.3753178119659424
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4835467338562012
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5371067523956299
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6897828578948975
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4794256687164307
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4575343132019043
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4498538970947266
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.476055383682251
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3293132781982422
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.513524055480957
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 202876
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8137974739074707
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.267 Vali Acc: 0.471 Test Loss: 1.267 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 1.3967983722686768
Epoch: 2, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.092 Vali Acc: 0.623 Test Loss: 1.092 Test Acc: 0.623
Validation loss decreased (-0.471002 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 1.3034374713897705
Epoch: 3, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.917 Vali Acc: 0.732 Test Loss: 0.917 Test Acc: 0.732
Validation loss decreased (-0.623177 --> -0.731875).  Saving model ...
Epoch: 4 cost time: 1.3530910015106201
Epoch: 4, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 1.5491929054260254
Epoch: 5, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.685 Vali Acc: 0.797 Test Loss: 0.685 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 6 cost time: 1.2953193187713623
Epoch: 6, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 1.3993258476257324
Epoch: 7, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.3787145614624023
Epoch: 8, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.3459811210632324
Epoch: 9, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 1.1793835163116455
Epoch: 10, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1966824531555176
Epoch: 11, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.27186918258667
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1911568641662598
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.220536470413208
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 1.3043816089630127
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.4879190921783447
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 1.2910635471343994
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.472 Vali Acc: 0.877 Test Loss: 0.472 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.305023431777954
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4116239547729492
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4180924892425537
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 1.191627025604248
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2948369979858398
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4030253887176514
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.431135654449463
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 1.3260900974273682
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.613755226135254
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.884 Test Loss: 0.446 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3642909526824951
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2861526012420654
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3534290790557861
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 30 cost time: 1.2967607975006104
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 31 cost time: 1.2461895942687988
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 32 cost time: 1.345454454421997
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.222001075744629
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.884 Test Loss: 0.439 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2809522151947021
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4511933326721191
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 36 cost time: 1.2709596157073975
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3287544250488281
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4324629306793213
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5433979034423828
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2866194248199463
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.447256326675415
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4682486057281494
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.491816759109497
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.298900842666626
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3625500202178955
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.891 Test Loss: 0.423 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 202876
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.746920585632324
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.296 Vali Acc: 0.406 Test Loss: 1.296 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.2829139232635498
Epoch: 2, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.147 Vali Acc: 0.565 Test Loss: 1.147 Test Acc: 0.565
Validation loss decreased (-0.405784 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 1.447838306427002
Epoch: 3, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.976 Vali Acc: 0.659 Test Loss: 0.976 Test Acc: 0.659
Validation loss decreased (-0.565206 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 1.4066345691680908
Epoch: 4, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.822 Vali Acc: 0.761 Test Loss: 0.822 Test Acc: 0.761
Validation loss decreased (-0.659411 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 1.7810540199279785
Epoch: 5, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.745 Vali Acc: 0.761 Test Loss: 0.745 Test Acc: 0.761
Validation loss decreased (-0.760861 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 1.5066511631011963
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.669 Vali Acc: 0.775 Test Loss: 0.669 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775356).  Saving model ...
Epoch: 7 cost time: 1.6119515895843506
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 1.3166296482086182
Epoch: 8, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.6412336826324463
Epoch: 9, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 1.4836373329162598
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3242616653442383
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.569577693939209
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6751134395599365
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2217187881469727
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4037203788757324
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.4071621894836426
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4128644466400146
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.276670217514038
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4163405895233154
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5539031028747559
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7190158367156982
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4011287689208984
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5252196788787842
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 1.4613053798675537
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.536 Vali Acc: 0.826 Test Loss: 0.536 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4798378944396973
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5326032638549805
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5062804222106934
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 28 cost time: 1.620225429534912
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.403684377670288
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6800622940063477
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6126315593719482
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6686017513275146
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3951702117919922
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.274489164352417
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3965973854064941
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.385911464691162
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3899919986724854
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 137340
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.073310375213623
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.284 Vali Acc: 0.442 Test Loss: 1.284 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 1.4317119121551514
Epoch: 2, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.131 Vali Acc: 0.572 Test Loss: 1.131 Test Acc: 0.572
Validation loss decreased (-0.442016 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 1.788069725036621
Epoch: 3, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.957 Vali Acc: 0.659 Test Loss: 0.957 Test Acc: 0.659
Validation loss decreased (-0.572452 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 1.470125675201416
Epoch: 4, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.803 Vali Acc: 0.761 Test Loss: 0.803 Test Acc: 0.761
Validation loss decreased (-0.659411 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 1.4041266441345215
Epoch: 5, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 1.7143573760986328
Epoch: 6, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.647 Vali Acc: 0.797 Test Loss: 0.647 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.4529743194580078
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 1.711252212524414
Epoch: 8, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4453072547912598
Epoch: 9, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 1.423283338546753
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5680859088897705
Epoch: 11, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5158412456512451
Epoch: 12, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.862396001815796
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4554779529571533
Epoch: 14, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5261101722717285
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.453512191772461
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7098114490509033
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3422913551330566
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.561192274093628
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.402029037475586
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.381450891494751
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.53497314453125
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6227869987487793
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.546828269958496
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4310998916625977
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 137340
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6992478370666504
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.278 Vali Acc: 0.486 Test Loss: 1.278 Test Acc: 0.486
Validation loss decreased (inf --> -0.485494).  Saving model ...
Epoch: 2 cost time: 1.4912824630737305
Epoch: 2, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.118 Vali Acc: 0.594 Test Loss: 1.118 Test Acc: 0.594
Validation loss decreased (-0.485494 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 1.5047199726104736
Epoch: 3, Steps: 9 | Train Loss: 0.916 Vali Loss: 0.944 Vali Acc: 0.703 Test Loss: 0.944 Test Acc: 0.703
Validation loss decreased (-0.594192 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 1.43746018409729
Epoch: 4, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
Validation loss decreased (-0.702889 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 1.4033548831939697
Epoch: 5, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.698 Vali Acc: 0.812 Test Loss: 0.698 Test Acc: 0.812
Validation loss decreased (-0.760862 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 1.371337890625
Epoch: 6, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 1.4953272342681885
Epoch: 7, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 1.5749859809875488
Epoch: 8, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5266618728637695
Epoch: 9, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4669616222381592
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.3918588161468506
Epoch: 11, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7103478908538818
Epoch: 12, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4950916767120361
Epoch: 13, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 1.2676310539245605
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5102148056030273
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.4083280563354492
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.426642656326294
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3543500900268555
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4520022869110107
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3175032138824463
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.338062047958374
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.419877052307129
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4719688892364502
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.3166816234588623
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6735572814941406
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.702115535736084
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7578034400939941
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 28 cost time: 1.5746433734893799
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7265112400054932
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6036288738250732
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8466651439666748
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.567521333694458
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 33 cost time: 1.6004133224487305
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5842502117156982
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8424501419067383
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.785238265991211
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4410853385925293
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5083935260772705
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6158089637756348
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5763347148895264
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.48870849609375
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6394176483154297
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 137340
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7647509574890137
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.285 Vali Acc: 0.457 Test Loss: 1.285 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 1.3450286388397217
Epoch: 2, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.100 Vali Acc: 0.630 Test Loss: 1.100 Test Acc: 0.630
Validation loss decreased (-0.456509 --> -0.630424).  Saving model ...
Epoch: 3 cost time: 1.44514799118042
Epoch: 3, Steps: 9 | Train Loss: 0.917 Vali Loss: 0.918 Vali Acc: 0.710 Test Loss: 0.918 Test Acc: 0.710
Validation loss decreased (-0.630424 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 1.4337193965911865
Epoch: 4, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
Validation loss decreased (-0.710136 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 1.2244393825531006
Epoch: 5, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
Validation loss decreased (-0.782601 --> -0.840573).  Saving model ...
Epoch: 6 cost time: 1.331066370010376
Epoch: 6, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2769336700439453
Epoch: 7, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.548 Vali Acc: 0.862 Test Loss: 0.548 Test Acc: 0.862
Validation loss decreased (-0.840573 --> -0.862313).  Saving model ...
Epoch: 8 cost time: 1.3241500854492188
Epoch: 8, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.347965955734253
Epoch: 9, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3760297298431396
Epoch: 10, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5464963912963867
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3495769500732422
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2719521522521973
Epoch: 13, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1780550479888916
Epoch: 14, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.2364614009857178
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 1.2188169956207275
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2743597030639648
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 1.1731116771697998
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 1.3453986644744873
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 20 cost time: 1.3772656917572021
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 1.3036425113677979
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4061510562896729
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5313055515289307
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 1.3666701316833496
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3903050422668457
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4586172103881836
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 1.2930834293365479
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 28 cost time: 1.258167028427124
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.316009283065796
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.446138858795166
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.362421989440918
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.29783034324646
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2532894611358643
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2985703945159912
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2700471878051758
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2229745388031006
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2313768863677979
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 137340
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.383453369140625
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.325 Vali Acc: 0.297 Test Loss: 1.325 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.6245849132537842
Epoch: 2, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
Validation loss decreased (-0.297088 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.6543965339660645
Epoch: 3, Steps: 9 | Train Loss: 0.972 Vali Loss: 0.988 Vali Acc: 0.703 Test Loss: 0.988 Test Acc: 0.703
Validation loss decreased (-0.499988 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 1.7669997215270996
Epoch: 4, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
Validation loss decreased (-0.702889 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 1.3808200359344482
Epoch: 5, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.735 Vali Acc: 0.797 Test Loss: 0.735 Test Acc: 0.797
Validation loss decreased (-0.717383 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 1.797224998474121
Epoch: 6, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.682 Vali Acc: 0.768 Test Loss: 0.682 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.621919870376587
Epoch: 7, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.68375563621521
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.797094 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 2.0309972763061523
Epoch: 9, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 1.8531177043914795
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8808012008666992
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5681214332580566
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3386075496673584
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3783752918243408
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4044115543365479
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4030425548553467
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.548 Vali Acc: 0.804 Test Loss: 0.548 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4057037830352783
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5997202396392822
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5686626434326172
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 104572
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.504006862640381
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.322 Vali Acc: 0.275 Test Loss: 1.322 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.5408108234405518
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
Validation loss decreased (-0.275349 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 1.1956813335418701
Epoch: 3, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.984 Vali Acc: 0.688 Test Loss: 0.984 Test Acc: 0.688
Validation loss decreased (-0.485496 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 1.471083402633667
Epoch: 4, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.860 Vali Acc: 0.739 Test Loss: 0.860 Test Acc: 0.739
Validation loss decreased (-0.688396 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 1.3738987445831299
Epoch: 5, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.723 Vali Acc: 0.797 Test Loss: 0.723 Test Acc: 0.797
Validation loss decreased (-0.739122 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 1.3150200843811035
Epoch: 6, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.661 Vali Acc: 0.790 Test Loss: 0.661 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6269209384918213
Epoch: 7, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 1.641808271408081
Epoch: 8, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
Validation loss decreased (-0.797095 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 1.583141803741455
Epoch: 9, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5406389236450195
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6155052185058594
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4627492427825928
Epoch: 12, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4143242835998535
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3374841213226318
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2630677223205566
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4003005027770996
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.338318109512329
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3286349773406982
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 104572
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.896866798400879
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.309 Vali Acc: 0.312 Test Loss: 1.309 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.4774153232574463
Epoch: 2, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.140 Vali Acc: 0.507 Test Loss: 1.140 Test Acc: 0.507
Validation loss decreased (-0.311581 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.4008700847625732
Epoch: 3, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
Validation loss decreased (-0.507235 --> -0.724628).  Saving model ...
Epoch: 4 cost time: 1.3682615756988525
Epoch: 4, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.836 Vali Acc: 0.761 Test Loss: 0.836 Test Acc: 0.761
Validation loss decreased (-0.724628 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 1.4690556526184082
Epoch: 5, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.703 Vali Acc: 0.790 Test Loss: 0.703 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 1.4937198162078857
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.642 Vali Acc: 0.812 Test Loss: 0.642 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 1.6558246612548828
Epoch: 7, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.6303822994232178
Epoch: 8, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.546 Vali Acc: 0.848 Test Loss: 0.546 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 1.7815592288970947
Epoch: 9, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5799510478973389
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 1.5503394603729248
Epoch: 11, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.6129765510559082
Epoch: 12, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.5384116172790527
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3212144374847412
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3436362743377686
Epoch: 15, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6213903427124023
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4213805198669434
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5808403491973877
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.52598237991333
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4483866691589355
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6862030029296875
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6044161319732666
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 23 cost time: 1.4998176097869873
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6060500144958496
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5350658893585205
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4249837398529053
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.556626796722412
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2921788692474365
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3998584747314453
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 30 cost time: 1.3520197868347168
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.855 Test Loss: 0.529 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6902203559875488
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5867996215820312
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5772902965545654
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5902843475341797
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.405555009841919
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3773198127746582
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3080809116363525
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4296016693115234
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4840073585510254
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.862 Test Loss: 0.529 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 104572
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4425554275512695
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.295 Vali Acc: 0.449 Test Loss: 1.295 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 1.330967664718628
Epoch: 2, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.111 Vali Acc: 0.601 Test Loss: 1.111 Test Acc: 0.601
Validation loss decreased (-0.449262 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 1.2789885997772217
Epoch: 3, Steps: 9 | Train Loss: 0.927 Vali Loss: 0.929 Vali Acc: 0.739 Test Loss: 0.929 Test Acc: 0.739
Validation loss decreased (-0.601438 --> -0.739121).  Saving model ...
Epoch: 4 cost time: 1.3423593044281006
Epoch: 4, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.812 Vali Acc: 0.768 Test Loss: 0.812 Test Acc: 0.768
Validation loss decreased (-0.739121 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 1.4604108333587646
Epoch: 5, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.768108 --> -0.804341).  Saving model ...
Epoch: 6 cost time: 1.4377458095550537
Epoch: 6, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 1.340895652770996
Epoch: 7, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3891472816467285
Epoch: 8, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 1.3920273780822754
Epoch: 9, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.530400037765503
Epoch: 10, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 1.3952200412750244
Epoch: 11, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2194087505340576
Epoch: 12, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 1.2417957782745361
Epoch: 13, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.401566505432129
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.3474831581115723
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 1.3187541961669922
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 1.398305892944336
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2395875453948975
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2928471565246582
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3396344184875488
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3481879234313965
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5229637622833252
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3484487533569336
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6169497966766357
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5331218242645264
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.301095724105835
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 104572
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.192908525466919
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.3263635635375977
Epoch: 2, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.209 Vali Acc: 0.536 Test Loss: 1.209 Test Acc: 0.536
Validation loss decreased (-0.297088 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 1.536989688873291
Epoch: 3, Steps: 9 | Train Loss: 0.912 Vali Loss: 1.011 Vali Acc: 0.638 Test Loss: 1.011 Test Acc: 0.638
Validation loss decreased (-0.536220 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 1.6198022365570068
Epoch: 4, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.870 Vali Acc: 0.754 Test Loss: 0.870 Test Acc: 0.754
Validation loss decreased (-0.637671 --> -0.753614).  Saving model ...
Epoch: 5 cost time: 1.7639193534851074
Epoch: 5, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.775 Vali Acc: 0.725 Test Loss: 0.775 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.546050786972046
Epoch: 6, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.692 Vali Acc: 0.797 Test Loss: 0.692 Test Acc: 0.797
Validation loss decreased (-0.753614 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.5739572048187256
Epoch: 7, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.620 Vali Acc: 0.812 Test Loss: 0.620 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.5470428466796875
Epoch: 8, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.8074746131896973
Epoch: 9, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.608 Vali Acc: 0.804 Test Loss: 0.608 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6960012912750244
Epoch: 10, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6363346576690674
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.6477351188659668
Epoch: 12, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.401606798171997
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.605616569519043
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.535344123840332
Epoch: 15, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7309365272521973
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.755810022354126
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.556 Vali Acc: 0.848 Test Loss: 0.556 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 1.8866832256317139
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4458644390106201
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5355188846588135
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7904059886932373
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.747196912765503
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8319971561431885
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6587800979614258
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.613542079925537
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6041724681854248
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5385258197784424
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 88188
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.264127492904663
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.354 Vali Acc: 0.319 Test Loss: 1.354 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.6240084171295166
Epoch: 2, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.197 Vali Acc: 0.551 Test Loss: 1.197 Test Acc: 0.551
Validation loss decreased (-0.318827 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 1.4436242580413818
Epoch: 3, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.998 Vali Acc: 0.652 Test Loss: 0.998 Test Acc: 0.652
Validation loss decreased (-0.550713 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.533499002456665
Epoch: 4, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.856 Vali Acc: 0.732 Test Loss: 0.856 Test Acc: 0.732
Validation loss decreased (-0.652164 --> -0.731875).  Saving model ...
Epoch: 5 cost time: 1.3738114833831787
Epoch: 5, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.763 Vali Acc: 0.725 Test Loss: 0.763 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2779381275177002
Epoch: 6, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
Validation loss decreased (-0.731875 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 1.4753057956695557
Epoch: 7, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 1.5726869106292725
Epoch: 8, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 1.621185302734375
Epoch: 9, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6755425930023193
Epoch: 10, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5367121696472168
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.260840892791748
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5669379234313965
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5673108100891113
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6145296096801758
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5846478939056396
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6624236106872559
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.544471025466919
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7065646648406982
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.080326557159424
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.812124490737915
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 88188
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6415152549743652
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.347 Vali Acc: 0.312 Test Loss: 1.347 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.3824858665466309
Epoch: 2, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.179 Vali Acc: 0.601 Test Loss: 1.179 Test Acc: 0.601
Validation loss decreased (-0.311581 --> -0.601437).  Saving model ...
Epoch: 3 cost time: 1.4854028224945068
Epoch: 3, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.983 Vali Acc: 0.630 Test Loss: 0.983 Test Acc: 0.630
Validation loss decreased (-0.601437 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.1515326499938965
Epoch: 4, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
Validation loss decreased (-0.630425 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 1.6003637313842773
Epoch: 5, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
Validation loss decreased (-0.760861 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 1.3307487964630127
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 1.597243070602417
Epoch: 7, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.3940668106079102
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 1.5799765586853027
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.441533088684082
Epoch: 10, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.369837999343872
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5622715950012207
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 1.361616849899292
Epoch: 13, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3772823810577393
Epoch: 14, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4499375820159912
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.351837158203125
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5778563022613525
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5023441314697266
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 1.4256434440612793
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.383415937423706
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4258089065551758
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4374713897705078
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4428904056549072
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 1.4811735153198242
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.318845272064209
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4016821384429932
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5771331787109375
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4787261486053467
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.313082218170166
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4268817901611328
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4429168701171875
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7016782760620117
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4898748397827148
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 88188
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.731703758239746
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.325 Vali Acc: 0.304 Test Loss: 1.325 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 1.6121275424957275
Epoch: 2, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.137 Vali Acc: 0.601 Test Loss: 1.137 Test Acc: 0.601
Validation loss decreased (-0.304335 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 1.553389310836792
Epoch: 3, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.946 Vali Acc: 0.696 Test Loss: 0.946 Test Acc: 0.696
Validation loss decreased (-0.601438 --> -0.695643).  Saving model ...
Epoch: 4 cost time: 1.4674484729766846
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.793 Vali Acc: 0.790 Test Loss: 0.793 Test Acc: 0.790
Validation loss decreased (-0.695643 --> -0.789847).  Saving model ...
Epoch: 5 cost time: 1.3984019756317139
Epoch: 5, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 6 cost time: 1.7199840545654297
Epoch: 6, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 1.5284092426300049
Epoch: 7, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 1.547433614730835
Epoch: 8, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.37593674659729
Epoch: 9, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 1.7587714195251465
Epoch: 10, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6045811176300049
Epoch: 11, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 1.48594069480896
Epoch: 12, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4479336738586426
Epoch: 13, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.412292242050171
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.499 Vali Acc: 0.862 Test Loss: 0.499 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.4363033771514893
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4486451148986816
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.313204050064087
Epoch: 17, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4225447177886963
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4790518283843994
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.812 Test Loss: 0.474 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5792100429534912
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5132863521575928
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7043702602386475
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.631502628326416
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4565072059631348
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 88188
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.904080390930176
Epoch: 1, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.359 Vali Acc: 0.319 Test Loss: 1.359 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.5880260467529297
Epoch: 2, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.258 Vali Acc: 0.478 Test Loss: 1.258 Test Acc: 0.478
Validation loss decreased (-0.318827 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.5124499797821045
Epoch: 3, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.156 Vali Acc: 0.587 Test Loss: 1.156 Test Acc: 0.587
Validation loss decreased (-0.478248 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 1.5199146270751953
Epoch: 4, Steps: 9 | Train Loss: 0.943 Vali Loss: 1.058 Vali Acc: 0.623 Test Loss: 1.058 Test Acc: 0.623
Validation loss decreased (-0.586945 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.4770395755767822
Epoch: 5, Steps: 9 | Train Loss: 0.775 Vali Loss: 0.982 Vali Acc: 0.652 Test Loss: 0.982 Test Acc: 0.652
Validation loss decreased (-0.623178 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 1.5040390491485596
Epoch: 6, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.874 Vali Acc: 0.725 Test Loss: 0.874 Test Acc: 0.725
Validation loss decreased (-0.652164 --> -0.724629).  Saving model ...
Epoch: 7 cost time: 1.46561861038208
Epoch: 7, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5318503379821777
Epoch: 8, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.788 Vali Acc: 0.688 Test Loss: 0.788 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4157869815826416
Epoch: 9, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.711 Vali Acc: 0.797 Test Loss: 0.711 Test Acc: 0.797
Validation loss decreased (-0.724629 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 1.3409755229949951
Epoch: 10, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3605272769927979
Epoch: 11, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4491002559661865
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
Validation loss decreased (-0.797094 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.5008697509765625
Epoch: 13, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1814258098602295
Epoch: 14, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.319326639175415
Epoch: 15, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3780639171600342
Epoch: 16, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.534 Vali Acc: 0.797 Test Loss: 0.534 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2633202075958252
Epoch: 17, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 1.5435748100280762
Epoch: 18, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 1.3287150859832764
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6646063327789307
Epoch: 20, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.519632339477539
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6154255867004395
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6112825870513916
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.812 Test Loss: 0.495 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5627422332763672
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4610106945037842
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.446993350982666
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4164693355560303
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3708951473236084
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 293980
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9284167289733887
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.365 Vali Acc: 0.312 Test Loss: 1.365 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.2349629402160645
Epoch: 2, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.262 Vali Acc: 0.449 Test Loss: 1.262 Test Acc: 0.449
Validation loss decreased (-0.311581 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.2942159175872803
Epoch: 3, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.160 Vali Acc: 0.558 Test Loss: 1.160 Test Acc: 0.558
Validation loss decreased (-0.449263 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 1.3148250579833984
Epoch: 4, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.062 Vali Acc: 0.594 Test Loss: 1.062 Test Acc: 0.594
Validation loss decreased (-0.557959 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 1.3057260513305664
Epoch: 5, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.987 Vali Acc: 0.630 Test Loss: 0.987 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.3157575130462646
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.876 Vali Acc: 0.703 Test Loss: 0.876 Test Acc: 0.703
Validation loss decreased (-0.630425 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 1.2910828590393066
Epoch: 7, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
Validation loss decreased (-0.702890 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 1.507516622543335
Epoch: 8, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.784 Vali Acc: 0.696 Test Loss: 0.784 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6683928966522217
Epoch: 9, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.704 Vali Acc: 0.768 Test Loss: 0.704 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.7826404571533203
Epoch: 10, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5591492652893066
Epoch: 11, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.665 Vali Acc: 0.739 Test Loss: 0.665 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5151395797729492
Epoch: 12, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 1.6274616718292236
Epoch: 13, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.6103003025054932
Epoch: 14, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.551588773727417
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.6534018516540527
Epoch: 16, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7408254146575928
Epoch: 17, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 18 cost time: 1.6587951183319092
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.7078602313995361
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7369403839111328
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9368140697479248
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.484 Vali Acc: 0.812 Test Loss: 0.484 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.685187578201294
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.580583095550537
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.812 Test Loss: 0.476 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.681575059890747
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.483 Vali Acc: 0.812 Test Loss: 0.483 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.552819013595581
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.481 Vali Acc: 0.804 Test Loss: 0.481 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8397808074951172
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.804 Test Loss: 0.472 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.471808671951294
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5922355651855469
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 29 cost time: 1.4978697299957275
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5255711078643799
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.457 Vali Acc: 0.812 Test Loss: 0.457 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5048270225524902
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5621848106384277
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.455 Vali Acc: 0.819 Test Loss: 0.455 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5018584728240967
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.819 Test Loss: 0.447 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.328099250793457
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.485910415649414
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6514711380004883
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6638729572296143
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.817094326019287
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 293980
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.200871467590332
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.370 Vali Acc: 0.319 Test Loss: 1.370 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.2477593421936035
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.261 Vali Acc: 0.478 Test Loss: 1.261 Test Acc: 0.478
Validation loss decreased (-0.318827 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.2940342426300049
Epoch: 3, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.156 Vali Acc: 0.565 Test Loss: 1.156 Test Acc: 0.565
Validation loss decreased (-0.478248 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.1942169666290283
Epoch: 4, Steps: 9 | Train Loss: 0.937 Vali Loss: 1.061 Vali Acc: 0.580 Test Loss: 1.061 Test Acc: 0.580
Validation loss decreased (-0.565206 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 1.1364502906799316
Epoch: 5, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.981 Vali Acc: 0.616 Test Loss: 0.981 Test Acc: 0.616
Validation loss decreased (-0.579700 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 1.1964900493621826
Epoch: 6, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.871 Vali Acc: 0.688 Test Loss: 0.871 Test Acc: 0.688
Validation loss decreased (-0.615932 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 1.3578646183013916
Epoch: 7, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.816 Vali Acc: 0.725 Test Loss: 0.816 Test Acc: 0.725
Validation loss decreased (-0.688397 --> -0.724630).  Saving model ...
Epoch: 8 cost time: 1.2647087574005127
Epoch: 8, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.776 Vali Acc: 0.703 Test Loss: 0.776 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2884492874145508
Epoch: 9, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 1.233520269393921
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.4195799827575684
Epoch: 11, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.659 Vali Acc: 0.754 Test Loss: 0.659 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 12 cost time: 1.21639084815979
Epoch: 12, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.267289638519287
Epoch: 13, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3507325649261475
Epoch: 14, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.194772720336914
Epoch: 15, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 1.2646996974945068
Epoch: 16, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.524 Vali Acc: 0.790 Test Loss: 0.524 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.39127516746521
Epoch: 17, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 1.322105884552002
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.494 Vali Acc: 0.812 Test Loss: 0.494 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.3975741863250732
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 1.2246863842010498
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.480 Vali Acc: 0.797 Test Loss: 0.480 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2824254035949707
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.483 Vali Acc: 0.797 Test Loss: 0.483 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3192768096923828
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.471 Vali Acc: 0.804 Test Loss: 0.471 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4175055027008057
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 1.338951587677002
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.477 Vali Acc: 0.804 Test Loss: 0.477 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.159618616104126
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.483 Vali Acc: 0.797 Test Loss: 0.483 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2585110664367676
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.804 Test Loss: 0.463 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3150088787078857
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4443390369415283
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.804 Test Loss: 0.437 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4226531982421875
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.445 Vali Acc: 0.812 Test Loss: 0.445 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2560324668884277
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.804 Test Loss: 0.454 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3338255882263184
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.804 Test Loss: 0.460 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3500940799713135
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.456 Vali Acc: 0.804 Test Loss: 0.456 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3694093227386475
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.446 Vali Acc: 0.797 Test Loss: 0.446 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 293980
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6021125316619873
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.367 Vali Acc: 0.370 Test Loss: 1.367 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.1149005889892578
Epoch: 2, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.250 Vali Acc: 0.478 Test Loss: 1.250 Test Acc: 0.478
Validation loss decreased (-0.369552 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.2726373672485352
Epoch: 3, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.132 Vali Acc: 0.580 Test Loss: 1.132 Test Acc: 0.580
Validation loss decreased (-0.478248 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.2608072757720947
Epoch: 4, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.027 Vali Acc: 0.616 Test Loss: 1.027 Test Acc: 0.616
Validation loss decreased (-0.579699 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.4520673751831055
Epoch: 5, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.953 Vali Acc: 0.652 Test Loss: 0.953 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 1.1452956199645996
Epoch: 6, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
Validation loss decreased (-0.652164 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 1.2281038761138916
Epoch: 7, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.772 Vali Acc: 0.768 Test Loss: 0.772 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 1.4423317909240723
Epoch: 8, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.735 Vali Acc: 0.725 Test Loss: 0.735 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3990354537963867
Epoch: 9, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.663 Vali Acc: 0.768 Test Loss: 0.663 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.5552258491516113
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.539250373840332
Epoch: 11, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 1.557267427444458
Epoch: 12, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 1.3606386184692383
Epoch: 13, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.453946590423584
Epoch: 14, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 1.512249231338501
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.408984899520874
Epoch: 16, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 1.4655561447143555
Epoch: 17, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 1.5453598499298096
Epoch: 18, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 1.4986646175384521
Epoch: 19, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4378061294555664
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 1.5438745021820068
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.383 Vali Acc: 0.906 Test Loss: 0.383 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 22 cost time: 1.3602044582366943
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 23 cost time: 1.2488305568695068
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 1.699730396270752
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3850712776184082
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3758268356323242
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 27 cost time: 1.6210541725158691
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.452652931213379
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.505448818206787
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 1.4130396842956543
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 31 cost time: 1.3857076168060303
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5051488876342773
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 33 cost time: 1.7252306938171387
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 34 cost time: 1.4087224006652832
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5603108406066895
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 36 cost time: 1.5088386535644531
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.920 Test Loss: 0.327 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5075128078460693
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.377335786819458
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4117913246154785
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3556239604949951
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 41 cost time: 1.2928566932678223
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.920 Test Loss: 0.311 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3121817111968994
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3844621181488037
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.913 Test Loss: 0.316 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4798600673675537
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.4985623359680176
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.7191781997680664
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4840734004974365
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.422579050064087
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.4365148544311523
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2244927883148193
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.920 Test Loss: 0.309 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 293980
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4778027534484863
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.326 Vali Acc: 0.384 Test Loss: 1.326 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.3431670665740967
Epoch: 2, Steps: 9 | Train Loss: 1.291 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.384045 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.3003244400024414
Epoch: 3, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.129 Vali Acc: 0.630 Test Loss: 1.129 Test Acc: 0.630
Validation loss decreased (-0.499988 --> -0.630423).  Saving model ...
Epoch: 4 cost time: 1.4526617527008057
Epoch: 4, Steps: 9 | Train Loss: 0.918 Vali Loss: 1.019 Vali Acc: 0.674 Test Loss: 1.019 Test Acc: 0.674
Validation loss decreased (-0.630423 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 1.3689916133880615
Epoch: 5, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.930 Vali Acc: 0.674 Test Loss: 0.930 Test Acc: 0.674
Validation loss decreased (-0.673903 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.5179493427276611
Epoch: 6, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
Validation loss decreased (-0.673904 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 1.4397728443145752
Epoch: 7, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
Validation loss decreased (-0.717383 --> -0.760862).  Saving model ...
Epoch: 8 cost time: 1.4012999534606934
Epoch: 8, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.725 Vali Acc: 0.761 Test Loss: 0.725 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 1.5075786113739014
Epoch: 9, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.672 Vali Acc: 0.804 Test Loss: 0.672 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 1.503974437713623
Epoch: 10, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840573).  Saving model ...
Epoch: 11 cost time: 1.4166450500488281
Epoch: 11, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6692273616790771
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 1.4768214225769043
Epoch: 13, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4036595821380615
Epoch: 14, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 1.5689311027526855
Epoch: 15, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 1.4237525463104248
Epoch: 16, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4741055965423584
Epoch: 17, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.498657464981079
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4544615745544434
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4477925300598145
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4670155048370361
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3924541473388672
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.517167091369629
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2927849292755127
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5029997825622559
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 162908
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.733783721923828
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.330 Vali Acc: 0.406 Test Loss: 1.330 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.4341909885406494
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.230 Vali Acc: 0.536 Test Loss: 1.230 Test Acc: 0.536
Validation loss decreased (-0.405784 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 1.4349355697631836
Epoch: 3, Steps: 9 | Train Loss: 1.057 Vali Loss: 1.129 Vali Acc: 0.616 Test Loss: 1.129 Test Acc: 0.616
Validation loss decreased (-0.536220 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.2826197147369385
Epoch: 4, Steps: 9 | Train Loss: 0.910 Vali Loss: 1.020 Vali Acc: 0.645 Test Loss: 1.020 Test Acc: 0.645
Validation loss decreased (-0.615931 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 1.3316919803619385
Epoch: 5, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.934 Vali Acc: 0.703 Test Loss: 0.934 Test Acc: 0.703
Validation loss decreased (-0.644917 --> -0.702889).  Saving model ...
Epoch: 6 cost time: 1.3414101600646973
Epoch: 6, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.868 Vali Acc: 0.688 Test Loss: 0.868 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5013985633850098
Epoch: 7, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
Validation loss decreased (-0.702889 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 1.4410717487335205
Epoch: 8, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.726 Vali Acc: 0.797 Test Loss: 0.726 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797094).  Saving model ...
Epoch: 9 cost time: 1.3511290550231934
Epoch: 9, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.675 Vali Acc: 0.797 Test Loss: 0.675 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.2435543537139893
Epoch: 10, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 1.2792999744415283
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.598 Vali Acc: 0.797 Test Loss: 0.598 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3744113445281982
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1503682136535645
Epoch: 13, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 1.1111540794372559
Epoch: 14, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 1.2432968616485596
Epoch: 15, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.061967134475708
Epoch: 16, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 1.1572966575622559
Epoch: 17, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2464587688446045
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.247636079788208
Epoch: 19, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.230621576309204
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.305182695388794
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.248668909072876
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 1.212092638015747
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.358823299407959
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2366104125976562
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.364922285079956
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1949222087860107
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 1.3554439544677734
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3837499618530273
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2412142753601074
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.249049186706543
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2453229427337646
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2222120761871338
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2873070240020752
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3618121147155762
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 1.50227952003479
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 37 cost time: 1.350280523300171
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2579009532928467
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2377517223358154
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1437687873840332
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1760563850402832
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3564751148223877
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.315589427947998
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2714056968688965
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 45 cost time: 1.046290636062622
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1705896854400635
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.156432867050171
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1668305397033691
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2631688117980957
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.397998332977295
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 51 cost time: 1.344113826751709
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 52 cost time: 1.3092443943023682
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3317298889160156
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2496633529663086
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2678022384643555
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.4455540180206299
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.4987196922302246
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.4009547233581543
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 59 cost time: 1.438291072845459
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 60 cost time: 1.5130236148834229
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.36055326461792
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2561750411987305
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.430649995803833
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.4062738418579102
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 65 cost time: 1.357762336730957
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 66 cost time: 1.1869418621063232
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 67 cost time: 1.1523547172546387
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 68 cost time: 1.2910420894622803
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2463221549987793
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2187330722808838
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.291724443435669
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.2429876327514648
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.4189653396606445
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.361128807067871
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 75 cost time: 1.251495361328125
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.2563605308532715
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 77 cost time: 1.0801599025726318
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 78 cost time: 1.1428380012512207
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 79 cost time: 1.1543514728546143
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.3349545001983643
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.4146173000335693
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.3678991794586182
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.3641610145568848
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.2986321449279785
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.2838964462280273
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.4004626274108887
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 87 cost time: 1.4147486686706543
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 88 cost time: 1.2742078304290771
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 89 cost time: 1.2660210132598877
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.884 Test Loss: 0.409 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.3546080589294434
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 91 cost time: 1.2683584690093994
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.2992668151855469
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 93 cost time: 1.3084161281585693
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 94 cost time: 1.1849114894866943
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 95 cost time: 1.2284247875213623
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 96 cost time: 1.171759843826294
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 97 cost time: 1.2533700466156006
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 98 cost time: 1.320279836654663
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 99 cost time: 1.2639129161834717
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.2020087242126465
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 162908
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.70019268989563
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.321 Vali Acc: 0.428 Test Loss: 1.321 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 1.2124292850494385
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.221 Vali Acc: 0.551 Test Loss: 1.221 Test Acc: 0.551
Validation loss decreased (-0.427523 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 1.4201557636260986
Epoch: 3, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.118 Vali Acc: 0.601 Test Loss: 1.118 Test Acc: 0.601
Validation loss decreased (-0.550712 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 1.371232032775879
Epoch: 4, Steps: 9 | Train Loss: 0.918 Vali Loss: 1.011 Vali Acc: 0.696 Test Loss: 1.011 Test Acc: 0.696
Validation loss decreased (-0.601438 --> -0.695642).  Saving model ...
Epoch: 5 cost time: 1.5152628421783447
Epoch: 5, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.926 Vali Acc: 0.710 Test Loss: 0.926 Test Acc: 0.710
Validation loss decreased (-0.695642 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 1.3183763027191162
Epoch: 6, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.862 Vali Acc: 0.732 Test Loss: 0.862 Test Acc: 0.732
Validation loss decreased (-0.710136 --> -0.731875).  Saving model ...
Epoch: 7 cost time: 1.3556320667266846
Epoch: 7, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.778 Vali Acc: 0.790 Test Loss: 0.778 Test Acc: 0.790
Validation loss decreased (-0.731875 --> -0.789847).  Saving model ...
Epoch: 8 cost time: 1.5627250671386719
Epoch: 8, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.722 Vali Acc: 0.797 Test Loss: 0.722 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 9 cost time: 1.450495958328247
Epoch: 9, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.3427314758300781
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.3716042041778564
Epoch: 11, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 1.3818340301513672
Epoch: 12, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 1.2331814765930176
Epoch: 13, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5322306156158447
Epoch: 14, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4093308448791504
Epoch: 15, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.2861337661743164
Epoch: 16, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2942144870758057
Epoch: 17, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.261824607849121
Epoch: 18, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.3358869552612305
Epoch: 19, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.2166101932525635
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 1.2652359008789062
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4280133247375488
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4061319828033447
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5724773406982422
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.513345718383789
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.410 Vali Acc: 0.841 Test Loss: 0.410 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5960123538970947
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4126431941986084
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.418 Vali Acc: 0.826 Test Loss: 0.418 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.660006046295166
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4774158000946045
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 1.4738852977752686
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5537488460540771
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.841 Test Loss: 0.398 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.450490951538086
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3252232074737549
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.841 Test Loss: 0.397 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3165228366851807
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3740172386169434
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2829277515411377
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.841 Test Loss: 0.392 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3355441093444824
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.389 Vali Acc: 0.848 Test Loss: 0.389 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 38 cost time: 1.5206480026245117
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.841 Test Loss: 0.387 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3577072620391846
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.841 Test Loss: 0.388 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3653438091278076
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.390 Vali Acc: 0.841 Test Loss: 0.390 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1838717460632324
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.390 Vali Acc: 0.841 Test Loss: 0.390 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3538875579833984
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.391 Vali Acc: 0.841 Test Loss: 0.391 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2603845596313477
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.841 Test Loss: 0.384 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3594739437103271
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 45 cost time: 1.3628909587860107
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.352848768234253
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 47 cost time: 1.3296372890472412
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 48 cost time: 1.3565723896026611
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 49 cost time: 1.2594337463378906
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.848 Test Loss: 0.381 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3278224468231201
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 51 cost time: 1.2948119640350342
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2247989177703857
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 53 cost time: 1.4241151809692383
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 54 cost time: 1.3338727951049805
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.293569564819336
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.4322547912597656
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 57 cost time: 1.3538355827331543
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3212933540344238
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 59 cost time: 1.430795431137085
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4933640956878662
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3539197444915771
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2743144035339355
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.365 Vali Acc: 0.862 Test Loss: 0.365 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.4256823062896729
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 64 cost time: 1.4915475845336914
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 65 cost time: 1.4273037910461426
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1775996685028076
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.3961741924285889
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 68 cost time: 1.465101957321167
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3173351287841797
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.6378633975982666
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.3302218914031982
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.4103796482086182
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.454643964767456
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.4234099388122559
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.5293843746185303
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.4789824485778809
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.540879726409912
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 162908
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2375690937042236
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.303 Vali Acc: 0.457 Test Loss: 1.303 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 1.6513164043426514
Epoch: 2, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.194 Vali Acc: 0.572 Test Loss: 1.194 Test Acc: 0.572
Validation loss decreased (-0.456509 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 1.294785499572754
Epoch: 3, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.085 Vali Acc: 0.630 Test Loss: 1.085 Test Acc: 0.630
Validation loss decreased (-0.572452 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 1.2652785778045654
Epoch: 4, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.980 Vali Acc: 0.659 Test Loss: 0.980 Test Acc: 0.659
Validation loss decreased (-0.630424 --> -0.659410).  Saving model ...
Epoch: 5 cost time: 1.238692283630371
Epoch: 5, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.893 Vali Acc: 0.717 Test Loss: 0.893 Test Acc: 0.717
Validation loss decreased (-0.659410 --> -0.717382).  Saving model ...
Epoch: 6 cost time: 1.2986195087432861
Epoch: 6, Steps: 9 | Train Loss: 0.663 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 1.2646336555480957
Epoch: 7, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 1.3259289264678955
Epoch: 8, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 1.2646584510803223
Epoch: 9, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
Validation loss decreased (-0.804341 --> -0.855066).  Saving model ...
Epoch: 10 cost time: 1.1866455078125
Epoch: 10, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869559).  Saving model ...
Epoch: 11 cost time: 1.270634412765503
Epoch: 11, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 1.3192436695098877
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2337136268615723
Epoch: 13, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884053).  Saving model ...
Epoch: 14 cost time: 1.347290277481079
Epoch: 14, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4905707836151123
Epoch: 15, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 1.3712108135223389
Epoch: 16, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 1.4741945266723633
Epoch: 17, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.410 Vali Acc: 0.884 Test Loss: 0.410 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3370254039764404
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.394 Vali Acc: 0.891 Test Loss: 0.394 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 1.3568201065063477
Epoch: 19, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 1.4274415969848633
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 1.334909200668335
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3291702270507812
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2607803344726562
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.356288194656372
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 1.2802019119262695
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.288684606552124
Epoch: 26, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.340 Vali Acc: 0.913 Test Loss: 0.340 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 27 cost time: 1.2284924983978271
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1543822288513184
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.293213129043579
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.214383602142334
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1993253231048584
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3082804679870605
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1362078189849854
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1127259731292725
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.332 Vali Acc: 0.899 Test Loss: 0.332 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1471924781799316
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.051572561264038
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.899 Test Loss: 0.328 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 162908
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2014236450195312
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.366 Vali Acc: 0.261 Test Loss: 1.366 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.1342246532440186
Epoch: 2, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.266 Vali Acc: 0.464 Test Loss: 1.266 Test Acc: 0.464
Validation loss decreased (-0.260856 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.2137858867645264
Epoch: 3, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.153 Vali Acc: 0.529 Test Loss: 1.153 Test Acc: 0.529
Validation loss decreased (-0.463755 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.2842249870300293
Epoch: 4, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.043 Vali Acc: 0.616 Test Loss: 1.043 Test Acc: 0.616
Validation loss decreased (-0.528974 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.3064568042755127
Epoch: 5, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.943 Vali Acc: 0.674 Test Loss: 0.943 Test Acc: 0.674
Validation loss decreased (-0.615932 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.1087617874145508
Epoch: 6, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.863 Vali Acc: 0.703 Test Loss: 0.863 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 1.1730127334594727
Epoch: 7, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.785 Vali Acc: 0.746 Test Loss: 0.785 Test Acc: 0.746
Validation loss decreased (-0.702890 --> -0.746369).  Saving model ...
Epoch: 8 cost time: 1.1753840446472168
Epoch: 8, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.728 Vali Acc: 0.768 Test Loss: 0.728 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 1.3016893863677979
Epoch: 9, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 1.1507277488708496
Epoch: 10, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 1.284484624862671
Epoch: 11, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.625 Vali Acc: 0.768 Test Loss: 0.625 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.247765064239502
Epoch: 12, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 1.1142802238464355
Epoch: 13, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.320124864578247
Epoch: 14, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.591 Vali Acc: 0.826 Test Loss: 0.591 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1628470420837402
Epoch: 15, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 1.1198687553405762
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.1714048385620117
Epoch: 17, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 1.2474262714385986
Epoch: 18, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 19 cost time: 1.1956233978271484
Epoch: 19, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.060448408126831
Epoch: 20, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2589201927185059
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 22 cost time: 1.2533667087554932
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.301682472229004
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 24 cost time: 1.255086898803711
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 25 cost time: 1.2685387134552002
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.826 Test Loss: 0.520 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.331831693649292
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3316500186920166
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.277289628982544
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4504921436309814
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1321115493774414
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1750807762145996
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1948184967041016
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2289953231811523
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1459147930145264
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 97372
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.208172082901001
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.364 Vali Acc: 0.297 Test Loss: 1.364 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.157618761062622
Epoch: 2, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.260 Vali Acc: 0.471 Test Loss: 1.260 Test Acc: 0.471
Validation loss decreased (-0.297088 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 1.2856385707855225
Epoch: 3, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.145 Vali Acc: 0.558 Test Loss: 1.145 Test Acc: 0.558
Validation loss decreased (-0.471002 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.066009283065796
Epoch: 4, Steps: 9 | Train Loss: 1.010 Vali Loss: 1.036 Vali Acc: 0.630 Test Loss: 1.036 Test Acc: 0.630
Validation loss decreased (-0.557960 --> -0.630424).  Saving model ...
Epoch: 5 cost time: 1.1996502876281738
Epoch: 5, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.630424 --> -0.724628).  Saving model ...
Epoch: 6 cost time: 1.128993272781372
Epoch: 6, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
Validation loss decreased (-0.724628 --> -0.724629).  Saving model ...
Epoch: 7 cost time: 1.2162315845489502
Epoch: 7, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.779 Vali Acc: 0.768 Test Loss: 0.779 Test Acc: 0.768
Validation loss decreased (-0.724629 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 1.1771235466003418
Epoch: 8, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 1.191596508026123
Epoch: 9, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2711751461029053
Epoch: 10, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.639 Vali Acc: 0.790 Test Loss: 0.639 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.290639877319336
Epoch: 11, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.623 Vali Acc: 0.790 Test Loss: 0.623 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.2310748100280762
Epoch: 12, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 1.0726253986358643
Epoch: 13, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.1793835163116455
Epoch: 14, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 1.2053890228271484
Epoch: 15, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.559 Vali Acc: 0.790 Test Loss: 0.559 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2883963584899902
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 1.38531494140625
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3583354949951172
Epoch: 18, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.369621753692627
Epoch: 19, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2571749687194824
Epoch: 20, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2027456760406494
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.291560411453247
Epoch: 22, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1500685214996338
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1626992225646973
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3021433353424072
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.508 Vali Acc: 0.812 Test Loss: 0.508 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3521323204040527
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 97372
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7039425373077393
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.357 Vali Acc: 0.268 Test Loss: 1.357 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.0762078762054443
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.251 Vali Acc: 0.493 Test Loss: 1.251 Test Acc: 0.493
Validation loss decreased (-0.268102 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 1.0891845226287842
Epoch: 3, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
Validation loss decreased (-0.492741 --> -0.543467).  Saving model ...
Epoch: 4 cost time: 1.0694565773010254
Epoch: 4, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.023 Vali Acc: 0.630 Test Loss: 1.023 Test Acc: 0.630
Validation loss decreased (-0.543467 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.3457109928131104
Epoch: 5, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.925 Vali Acc: 0.696 Test Loss: 0.925 Test Acc: 0.696
Validation loss decreased (-0.630425 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 1.2285771369934082
Epoch: 6, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
Validation loss decreased (-0.695643 --> -0.746368).  Saving model ...
Epoch: 7 cost time: 1.1592371463775635
Epoch: 7, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.767 Vali Acc: 0.754 Test Loss: 0.767 Test Acc: 0.754
Validation loss decreased (-0.746368 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 1.0787353515625
Epoch: 8, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.708 Vali Acc: 0.819 Test Loss: 0.708 Test Acc: 0.819
Validation loss decreased (-0.753616 --> -0.818833).  Saving model ...
Epoch: 9 cost time: 1.2073066234588623
Epoch: 9, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.660 Vali Acc: 0.804 Test Loss: 0.660 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3995954990386963
Epoch: 10, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 1.1995525360107422
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3865022659301758
Epoch: 12, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3704404830932617
Epoch: 13, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3938651084899902
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2815818786621094
Epoch: 15, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.332080602645874
Epoch: 16, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.2674760818481445
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.346160650253296
Epoch: 18, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4215261936187744
Epoch: 19, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 1.415867567062378
Epoch: 20, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3384544849395752
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3712551593780518
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3317172527313232
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2986164093017578
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2993316650390625
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2037465572357178
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.226257085800171
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2426421642303467
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2807567119598389
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 97372
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1840085983276367
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.357 Vali Acc: 0.290 Test Loss: 1.357 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 1.3516688346862793
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.244 Vali Acc: 0.507 Test Loss: 1.244 Test Acc: 0.507
Validation loss decreased (-0.289842 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 1.2454512119293213
Epoch: 3, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.115 Vali Acc: 0.616 Test Loss: 1.115 Test Acc: 0.616
Validation loss decreased (-0.507234 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.2744321823120117
Epoch: 4, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.003 Vali Acc: 0.652 Test Loss: 1.003 Test Acc: 0.652
Validation loss decreased (-0.615931 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 1.246534824371338
Epoch: 5, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.902 Vali Acc: 0.732 Test Loss: 0.902 Test Acc: 0.732
Validation loss decreased (-0.652164 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 1.268411636352539
Epoch: 6, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
Validation loss decreased (-0.731875 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 1.3364176750183105
Epoch: 7, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
Validation loss decreased (-0.739122 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 1.3749167919158936
Epoch: 8, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.685 Vali Acc: 0.804 Test Loss: 0.685 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 1.3081669807434082
Epoch: 9, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 1.3245024681091309
Epoch: 10, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2380774021148682
Epoch: 11, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 1.4536266326904297
Epoch: 12, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 1.383570671081543
Epoch: 13, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.2879796028137207
Epoch: 14, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.495 Vali Acc: 0.870 Test Loss: 0.495 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 1.2870376110076904
Epoch: 15, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2138609886169434
Epoch: 16, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.374516487121582
Epoch: 17, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1436357498168945
Epoch: 18, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2873365879058838
Epoch: 19, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.381347417831421
Epoch: 20, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 1.2786762714385986
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4258460998535156
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2253177165985107
Epoch: 23, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.2450029850006104
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 1.4199621677398682
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4866764545440674
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 27 cost time: 1.3799149990081787
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 1.210212230682373
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4687438011169434
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2796292304992676
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.36104416847229
Epoch: 31, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3208026885986328
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5729327201843262
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 34 cost time: 1.3124134540557861
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3041810989379883
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4435110092163086
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4183881282806396
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3623173236846924
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.500281572341919
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3676812648773193
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3839738368988037
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2847881317138672
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1608319282531738
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 97372
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.333338737487793
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.423 Vali Acc: 0.254 Test Loss: 1.423 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.2891061305999756
Epoch: 2, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.312 Vali Acc: 0.326 Test Loss: 1.312 Test Acc: 0.326
Validation loss decreased (-0.253609 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 1.341968059539795
Epoch: 3, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.187 Vali Acc: 0.543 Test Loss: 1.187 Test Acc: 0.543
Validation loss decreased (-0.326074 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.2116572856903076
Epoch: 4, Steps: 9 | Train Loss: 0.943 Vali Loss: 1.093 Vali Acc: 0.551 Test Loss: 1.093 Test Acc: 0.551
Validation loss decreased (-0.543466 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 1.3028192520141602
Epoch: 5, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.996 Vali Acc: 0.609 Test Loss: 0.996 Test Acc: 0.609
Validation loss decreased (-0.550714 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.1660876274108887
Epoch: 6, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.894 Vali Acc: 0.681 Test Loss: 0.894 Test Acc: 0.681
Validation loss decreased (-0.608686 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 1.2341225147247314
Epoch: 7, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
Validation loss decreased (-0.681150 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 1.2624988555908203
Epoch: 8, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 1.2402570247650146
Epoch: 9, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.731 Vali Acc: 0.754 Test Loss: 0.731 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 1.3484587669372559
Epoch: 10, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 1.3055365085601807
Epoch: 11, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.689 Vali Acc: 0.754 Test Loss: 0.689 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3526062965393066
Epoch: 12, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.3125548362731934
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3079628944396973
Epoch: 14, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.633 Vali Acc: 0.768 Test Loss: 0.633 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3782525062561035
Epoch: 15, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.592 Vali Acc: 0.797 Test Loss: 0.592 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 1.2065823078155518
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 1.337144374847412
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2285113334655762
Epoch: 18, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.578 Vali Acc: 0.804 Test Loss: 0.578 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 1.170194149017334
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.587 Vali Acc: 0.797 Test Loss: 0.587 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2843518257141113
Epoch: 20, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.609 Vali Acc: 0.790 Test Loss: 0.609 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2562992572784424
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1443164348602295
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 23 cost time: 1.2548058032989502
Epoch: 23, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2343132495880127
Epoch: 24, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 25 cost time: 1.232361078262329
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.238542079925537
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1790313720703125
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.229107141494751
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1698071956634521
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3362312316894531
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1591954231262207
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3428747653961182
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1297767162322998
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.224069356918335
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.597 Vali Acc: 0.812 Test Loss: 0.597 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 64604
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.146148204803467
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.400 Vali Acc: 0.312 Test Loss: 1.400 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.1953680515289307
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.293 Vali Acc: 0.362 Test Loss: 1.293 Test Acc: 0.362
Validation loss decreased (-0.311580 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 1.2121360301971436
Epoch: 3, Steps: 9 | Train Loss: 1.124 Vali Loss: 1.170 Vali Acc: 0.565 Test Loss: 1.170 Test Acc: 0.565
Validation loss decreased (-0.362306 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.2884595394134521
Epoch: 4, Steps: 9 | Train Loss: 0.947 Vali Loss: 1.076 Vali Acc: 0.594 Test Loss: 1.076 Test Acc: 0.594
Validation loss decreased (-0.565206 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 1.2898035049438477
Epoch: 5, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.983 Vali Acc: 0.630 Test Loss: 0.983 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.2523345947265625
Epoch: 6, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.882 Vali Acc: 0.717 Test Loss: 0.882 Test Acc: 0.717
Validation loss decreased (-0.630425 --> -0.717382).  Saving model ...
Epoch: 7 cost time: 1.2758946418762207
Epoch: 7, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
Validation loss decreased (-0.717382 --> -0.739122).  Saving model ...
Epoch: 8 cost time: 1.165489912033081
Epoch: 8, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.778 Vali Acc: 0.725 Test Loss: 0.778 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2525112628936768
Epoch: 9, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.715 Vali Acc: 0.754 Test Loss: 0.715 Test Acc: 0.754
Validation loss decreased (-0.739122 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 1.1103832721710205
Epoch: 10, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 1.1836416721343994
Epoch: 11, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.667 Vali Acc: 0.761 Test Loss: 0.667 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 12 cost time: 1.2438075542449951
Epoch: 12, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.597 Vali Acc: 0.790 Test Loss: 0.597 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 1.1787993907928467
Epoch: 13, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3682386875152588
Epoch: 14, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.373769998550415
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 1.3416578769683838
Epoch: 16, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2757775783538818
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3442339897155762
Epoch: 18, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 1.322843313217163
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.24885892868042
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3967945575714111
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2945663928985596
Epoch: 22, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 1.443124771118164
Epoch: 23, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4084136486053467
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.551 Vali Acc: 0.804 Test Loss: 0.551 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3409314155578613
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2925679683685303
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.301999568939209
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1620850563049316
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3781414031982422
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.547 Vali Acc: 0.797 Test Loss: 0.547 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.302156686782837
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3216397762298584
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3927483558654785
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 64604
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.347447395324707
Epoch: 1, Steps: 9 | Train Loss: 1.444 Vali Loss: 1.371 Vali Acc: 0.348 Test Loss: 1.371 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 1.3150782585144043
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (-0.347812 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 1.2404868602752686
Epoch: 3, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.147 Vali Acc: 0.551 Test Loss: 1.147 Test Acc: 0.551
Validation loss decreased (-0.427524 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.4324631690979004
Epoch: 4, Steps: 9 | Train Loss: 0.952 Vali Loss: 1.052 Vali Acc: 0.616 Test Loss: 1.052 Test Acc: 0.616
Validation loss decreased (-0.550713 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.2365374565124512
Epoch: 5, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.963 Vali Acc: 0.652 Test Loss: 0.963 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 1.2726755142211914
Epoch: 6, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
Validation loss decreased (-0.652164 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 1.2118055820465088
Epoch: 7, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.717383 --> -0.760862).  Saving model ...
Epoch: 8 cost time: 1.1944212913513184
Epoch: 8, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 1.1712532043457031
Epoch: 9, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.704 Vali Acc: 0.754 Test Loss: 0.704 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3291511535644531
Epoch: 10, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2903764247894287
Epoch: 11, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.646 Vali Acc: 0.768 Test Loss: 0.646 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4650988578796387
Epoch: 12, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.306750774383545
Epoch: 13, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.604 Vali Acc: 0.790 Test Loss: 0.604 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.372671365737915
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4492442607879639
Epoch: 15, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 1.4483840465545654
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.560 Vali Acc: 0.790 Test Loss: 0.560 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.445742130279541
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 1.5058259963989258
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.1781141757965088
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 1.2769265174865723
Epoch: 20, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4375042915344238
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.145235538482666
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1894862651824951
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.234628677368164
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 25 cost time: 1.213730812072754
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.195103406906128
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1514954566955566
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1211357116699219
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 29 cost time: 1.221287727355957
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.812 Test Loss: 0.513 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 30 cost time: 1.2012059688568115
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4430196285247803
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4659779071807861
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5069866180419922
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2244842052459717
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 35 cost time: 1.4973888397216797
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.506 Vali Acc: 0.804 Test Loss: 0.506 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.551600694656372
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.506 Vali Acc: 0.804 Test Loss: 0.506 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4811744689941406
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.500 Vali Acc: 0.804 Test Loss: 0.500 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3253657817840576
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.500 Vali Acc: 0.804 Test Loss: 0.500 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.339801549911499
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3698573112487793
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.501 Vali Acc: 0.812 Test Loss: 0.501 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 41 cost time: 1.3708512783050537
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.493 Vali Acc: 0.804 Test Loss: 0.493 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.37422513961792
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 43 cost time: 1.350640058517456
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.812 Test Loss: 0.486 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 44 cost time: 1.3017563819885254
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 45 cost time: 1.43733811378479
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 46 cost time: 1.327378273010254
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 47 cost time: 1.5356407165527344
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 48 cost time: 1.487349033355713
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 49 cost time: 1.2597019672393799
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 50 cost time: 1.162013292312622
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0948925018310547
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2820758819580078
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2399191856384277
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.3567922115325928
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2142372131347656
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2796657085418701
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 57 cost time: 1.437988042831421
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3190853595733643
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.2356879711151123
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 60 cost time: 1.2250392436981201
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.5341625213623047
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2735662460327148
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 63 cost time: 1.2955446243286133
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2518839836120605
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 65 cost time: 1.3515267372131348
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3725426197052002
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1798481941223145
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.402061939239502
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.3488481044769287
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.3429653644561768
Epoch: 70, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.3083248138427734
Epoch: 71, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.2956178188323975
Epoch: 72, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 73 cost time: 1.1823580265045166
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 74 cost time: 1.1895666122436523
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 75 cost time: 1.2335681915283203
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.249497652053833
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.1885707378387451
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.2441329956054688
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.0450754165649414
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.164090633392334
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.1327970027923584
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.2400596141815186
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.2079524993896484
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.203413963317871
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 64604
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1655426025390625
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.357 Vali Acc: 0.362 Test Loss: 1.357 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.2792854309082031
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.362305 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.2536306381225586
Epoch: 3, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.126 Vali Acc: 0.558 Test Loss: 1.126 Test Acc: 0.558
Validation loss decreased (-0.499988 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.2891161441802979
Epoch: 4, Steps: 9 | Train Loss: 0.924 Vali Loss: 1.024 Vali Acc: 0.594 Test Loss: 1.024 Test Acc: 0.594
Validation loss decreased (-0.557960 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 1.3024561405181885
Epoch: 5, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.931 Vali Acc: 0.674 Test Loss: 0.931 Test Acc: 0.674
Validation loss decreased (-0.594193 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.6082127094268799
Epoch: 6, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.841 Vali Acc: 0.761 Test Loss: 0.841 Test Acc: 0.761
Validation loss decreased (-0.673904 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 1.2717628479003906
Epoch: 7, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.761 Vali Acc: 0.790 Test Loss: 0.761 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789847).  Saving model ...
Epoch: 8 cost time: 1.3123595714569092
Epoch: 8, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.719 Vali Acc: 0.797 Test Loss: 0.719 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 9 cost time: 1.2853331565856934
Epoch: 9, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.36167573928833
Epoch: 10, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
Validation loss decreased (-0.797094 --> -0.840573).  Saving model ...
Epoch: 11 cost time: 1.3869082927703857
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2119925022125244
Epoch: 12, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4649107456207275
Epoch: 13, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 1.3460123538970947
Epoch: 14, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.239152193069458
Epoch: 15, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.2781486511230469
Epoch: 16, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 17 cost time: 1.3599562644958496
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.833 Test Loss: 0.496 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3460643291473389
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3683626651763916
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.312671184539795
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.065211296081543
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1199307441711426
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 1.021148681640625
Epoch: 23, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 1.1996700763702393
Epoch: 24, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5032014846801758
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4847469329833984
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2465569972991943
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.223252773284912
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3062231540679932
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3764569759368896
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.410 Vali Acc: 0.862 Test Loss: 0.410 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.317704439163208
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.302565336227417
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7386667728424072
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 64604
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3238935470581055
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.1752474308013916
Epoch: 2, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.313 Vali Acc: 0.355 Test Loss: 1.313 Test Acc: 0.355
Validation loss decreased (-0.275348 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.1117420196533203
Epoch: 3, Steps: 9 | Train Loss: 1.161 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.355059 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2393031120300293
Epoch: 4, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.077 Vali Acc: 0.580 Test Loss: 1.077 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 1.1163527965545654
Epoch: 5, Steps: 9 | Train Loss: 0.799 Vali Loss: 1.000 Vali Acc: 0.616 Test Loss: 1.000 Test Acc: 0.616
Validation loss decreased (-0.579699 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 0.9835507869720459
Epoch: 6, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.902 Vali Acc: 0.659 Test Loss: 0.902 Test Acc: 0.659
Validation loss decreased (-0.615932 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 1.1145646572113037
Epoch: 7, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.826 Vali Acc: 0.725 Test Loss: 0.826 Test Acc: 0.725
Validation loss decreased (-0.659411 --> -0.724629).  Saving model ...
Epoch: 8 cost time: 1.0188207626342773
Epoch: 8, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 1.2708289623260498
Epoch: 9, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.718 Vali Acc: 0.768 Test Loss: 0.718 Test Acc: 0.768
Validation loss decreased (-0.724630 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.194962978363037
Epoch: 10, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.2476472854614258
Epoch: 11, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 1.1698501110076904
Epoch: 12, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.621 Vali Acc: 0.797 Test Loss: 0.621 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 1.2458300590515137
Epoch: 13, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.2142460346221924
Epoch: 14, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.596 Vali Acc: 0.790 Test Loss: 0.596 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2756321430206299
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.375173807144165
Epoch: 16, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1725342273712158
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.185755968093872
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.563 Vali Acc: 0.804 Test Loss: 0.563 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2032835483551025
Epoch: 19, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.185391902923584
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.165797233581543
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.152190923690796
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.196746826171875
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 48220
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1279709339141846
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.408 Vali Acc: 0.261 Test Loss: 1.408 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 1.0722277164459229
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.309 Vali Acc: 0.370 Test Loss: 1.309 Test Acc: 0.370
Validation loss decreased (-0.260855 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 1.0952746868133545
Epoch: 3, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.188 Vali Acc: 0.529 Test Loss: 1.188 Test Acc: 0.529
Validation loss decreased (-0.369552 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.077901840209961
Epoch: 4, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.070 Vali Acc: 0.609 Test Loss: 1.070 Test Acc: 0.609
Validation loss decreased (-0.528974 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 1.124263048171997
Epoch: 5, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.995 Vali Acc: 0.630 Test Loss: 0.995 Test Acc: 0.630
Validation loss decreased (-0.608685 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.0532963275909424
Epoch: 6, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.899 Vali Acc: 0.688 Test Loss: 0.899 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 1.041175127029419
Epoch: 7, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.818 Vali Acc: 0.710 Test Loss: 0.818 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 8 cost time: 1.111417531967163
Epoch: 8, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 1.0296101570129395
Epoch: 9, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 1.0491104125976562
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
Validation loss decreased (-0.739123 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 1.1223700046539307
Epoch: 11, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1912956237792969
Epoch: 12, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 1.1436841487884521
Epoch: 13, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 1.090881109237671
Epoch: 14, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.586 Vali Acc: 0.797 Test Loss: 0.586 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1186456680297852
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1574747562408447
Epoch: 16, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.579 Vali Acc: 0.797 Test Loss: 0.579 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.116440773010254
Epoch: 17, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2390997409820557
Epoch: 18, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1204097270965576
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.554 Vali Acc: 0.804 Test Loss: 0.554 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.186047077178955
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1863901615142822
Epoch: 21, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 22 cost time: 1.1838891506195068
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.551 Vali Acc: 0.804 Test Loss: 0.551 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.166640281677246
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 24 cost time: 1.1500651836395264
Epoch: 24, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 25 cost time: 0.9709649085998535
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 26 cost time: 0.9038496017456055
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0091831684112549
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0625426769256592
Epoch: 28, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1489264965057373
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0315515995025635
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 31 cost time: 1.1492342948913574
Epoch: 31, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1711688041687012
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.154458999633789
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.564 Vali Acc: 0.826 Test Loss: 0.564 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.100146770477295
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.136714220046997
Epoch: 35, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.104525089263916
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2621936798095703
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 1.2423467636108398
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3007616996765137
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2027528285980225
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0407683849334717
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 42 cost time: 1.0842220783233643
Epoch: 42, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1471376419067383
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2065892219543457
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2106122970581055
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1523611545562744
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1704347133636475
Epoch: 47, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.826 Test Loss: 0.555 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2622098922729492
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0927233695983887
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0890445709228516
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.002413272857666
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 48220
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.971810817718506
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.402 Vali Acc: 0.254 Test Loss: 1.402 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.0729999542236328
Epoch: 2, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.303 Vali Acc: 0.384 Test Loss: 1.303 Test Acc: 0.384
Validation loss decreased (-0.253609 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.058487892150879
Epoch: 3, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.182 Vali Acc: 0.543 Test Loss: 1.182 Test Acc: 0.543
Validation loss decreased (-0.384045 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.0366313457489014
Epoch: 4, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.064 Vali Acc: 0.601 Test Loss: 1.064 Test Acc: 0.601
Validation loss decreased (-0.543466 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 0.9552555084228516
Epoch: 5, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.986 Vali Acc: 0.623 Test Loss: 0.986 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.1507048606872559
Epoch: 6, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.1128580570220947
Epoch: 7, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
Validation loss decreased (-0.666658 --> -0.739122).  Saving model ...
Epoch: 8 cost time: 1.3555729389190674
Epoch: 8, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.758 Vali Acc: 0.754 Test Loss: 0.758 Test Acc: 0.754
Validation loss decreased (-0.739122 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 1.1208980083465576
Epoch: 9, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2829711437225342
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.1495997905731201
Epoch: 11, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1148037910461426
Epoch: 12, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.1461429595947266
Epoch: 13, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.574 Vali Acc: 0.797 Test Loss: 0.574 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.0394446849822998
Epoch: 14, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.581 Vali Acc: 0.797 Test Loss: 0.581 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1516685485839844
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.119037389755249
Epoch: 16, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1269824504852295
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 1.1709818840026855
Epoch: 18, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.546 Vali Acc: 0.790 Test Loss: 0.546 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0713443756103516
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.541 Vali Acc: 0.790 Test Loss: 0.541 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0687222480773926
Epoch: 20, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.199767827987671
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1468157768249512
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1424767971038818
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.797 Test Loss: 0.534 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0898635387420654
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.538 Vali Acc: 0.790 Test Loss: 0.538 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1152629852294922
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.503 Vali Acc: 0.797 Test Loss: 0.503 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1394567489624023
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.513 Vali Acc: 0.797 Test Loss: 0.513 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1224358081817627
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.797 Test Loss: 0.531 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 48220
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3025076389312744
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.367 Vali Acc: 0.348 Test Loss: 1.367 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 1.0965831279754639
Epoch: 2, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.259 Vali Acc: 0.449 Test Loss: 1.259 Test Acc: 0.449
Validation loss decreased (-0.347812 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.2701904773712158
Epoch: 3, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.449263 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.0541000366210938
Epoch: 4, Steps: 9 | Train Loss: 0.963 Vali Loss: 1.019 Vali Acc: 0.652 Test Loss: 1.019 Test Acc: 0.652
Validation loss decreased (-0.572452 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 1.251715898513794
Epoch: 5, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.939 Vali Acc: 0.674 Test Loss: 0.939 Test Acc: 0.674
Validation loss decreased (-0.652164 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.1672112941741943
Epoch: 6, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
Validation loss decreased (-0.673904 --> -0.724629).  Saving model ...
Epoch: 7 cost time: 1.2348778247833252
Epoch: 7, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
Validation loss decreased (-0.724629 --> -0.746369).  Saving model ...
Epoch: 8 cost time: 1.1045591831207275
Epoch: 8, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746370).  Saving model ...
Epoch: 9 cost time: 1.1544244289398193
Epoch: 9, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.683 Vali Acc: 0.754 Test Loss: 0.683 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 1.2545676231384277
Epoch: 10, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 1.1802635192871094
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.2252211570739746
Epoch: 12, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.180973768234253
Epoch: 13, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.1554369926452637
Epoch: 14, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.553 Vali Acc: 0.804 Test Loss: 0.553 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0179576873779297
Epoch: 15, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.0863044261932373
Epoch: 16, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 17 cost time: 1.0786387920379639
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0819354057312012
Epoch: 18, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 1.0082778930664062
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.0266563892364502
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 1.1507337093353271
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0687720775604248
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.209502935409546
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1340117454528809
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2169604301452637
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.468 Vali Acc: 0.819 Test Loss: 0.468 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1402487754821777
Epoch: 26, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 1.1270735263824463
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.143463373184204
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.086076259613037
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.135648488998413
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 31 cost time: 1.0438189506530762
Epoch: 31, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 32 cost time: 1.0771667957305908
Epoch: 32, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 33 cost time: 1.0807294845581055
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 34 cost time: 1.1905536651611328
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1266281604766846
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.454 Vali Acc: 0.826 Test Loss: 0.454 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.042320728302002
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0814716815948486
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0010411739349365
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0354163646697998
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0188946723937988
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 41 cost time: 1.1050546169281006
Epoch: 41, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 42 cost time: 1.080120325088501
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0754282474517822
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0544769763946533
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.062488317489624
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2377235889434814
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 47 cost time: 1.046971321105957
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 48 cost time: 1.0948774814605713
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 49 cost time: 1.039362907409668
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 50 cost time: 1.0290732383728027
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1253752708435059
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 52 cost time: 1.1157138347625732
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0646727085113525
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 54 cost time: 1.0654959678649902
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 55 cost time: 1.2668278217315674
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2428042888641357
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 57 cost time: 1.3022406101226807
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 58 cost time: 1.1090917587280273
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1784818172454834
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1357979774475098
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.127446174621582
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.139824628829956
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 63 cost time: 0.9997198581695557
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 64 cost time: 1.1043853759765625
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 65 cost time: 1.0828437805175781
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 66 cost time: 1.2633225917816162
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 67 cost time: 1.2157790660858154
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 68 cost time: 1.2038540840148926
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2788136005401611
Epoch: 69, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 70 cost time: 1.1051537990570068
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.175205945968628
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0532073974609375
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.0911674499511719
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.1090338230133057
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.1806588172912598
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.1614315509796143
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.1705656051635742
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.1125690937042236
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.295130729675293
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 80 cost time: 1.1929969787597656
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 81 cost time: 1.1019392013549805
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1407990455627441
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.1522495746612549
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.1849653720855713
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.0789213180541992
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.1299405097961426
Epoch: 86, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.1389508247375488
Epoch: 87, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.899 Test Loss: 0.367 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 88 cost time: 1.0756471157073975
Epoch: 88, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.899 Test Loss: 0.367 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.0687589645385742
Epoch: 89, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.369 Vali Acc: 0.899 Test Loss: 0.369 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.2525463104248047
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.3166351318359375
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.1278090476989746
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.290297269821167
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.110278844833374
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.016944408416748
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.0582916736602783
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.1974217891693115
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 48220
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3300936222076416
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.373 Vali Acc: 0.312 Test Loss: 1.373 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.179548740386963
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.279 Vali Acc: 0.449 Test Loss: 1.279 Test Acc: 0.449
Validation loss decreased (-0.311580 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.3993580341339111
Epoch: 3, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.160 Vali Acc: 0.565 Test Loss: 1.160 Test Acc: 0.565
Validation loss decreased (-0.449263 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.1501994132995605
Epoch: 4, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.047 Vali Acc: 0.616 Test Loss: 1.047 Test Acc: 0.616
Validation loss decreased (-0.565206 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.0924186706542969
Epoch: 5, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.954 Vali Acc: 0.681 Test Loss: 0.954 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 1.1626837253570557
Epoch: 6, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.864 Vali Acc: 0.696 Test Loss: 0.864 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 1.1568200588226318
Epoch: 7, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.804 Vali Acc: 0.725 Test Loss: 0.804 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 8 cost time: 1.1104063987731934
Epoch: 8, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
Validation loss decreased (-0.724630 --> -0.775355).  Saving model ...
Epoch: 9 cost time: 1.1990137100219727
Epoch: 9, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.718 Vali Acc: 0.732 Test Loss: 0.718 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.243293285369873
Epoch: 10, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.671 Vali Acc: 0.790 Test Loss: 0.671 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 1.1534368991851807
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.658 Vali Acc: 0.790 Test Loss: 0.658 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 12 cost time: 1.3273093700408936
Epoch: 12, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.626 Vali Acc: 0.775 Test Loss: 0.626 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1664564609527588
Epoch: 13, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.597 Vali Acc: 0.812 Test Loss: 0.597 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 1.1276564598083496
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3777685165405273
Epoch: 15, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3361210823059082
Epoch: 16, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3371634483337402
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2879109382629395
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 19 cost time: 1.2527081966400146
Epoch: 19, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 20 cost time: 1.1892547607421875
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 21 cost time: 1.2734899520874023
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3491461277008057
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2820744514465332
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2518181800842285
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2508249282836914
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1326286792755127
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.596 Vali Acc: 0.804 Test Loss: 0.596 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2734060287475586
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1234400272369385
Epoch: 28, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2358174324035645
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2015280723571777
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 40028
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.429969310760498
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.358 Vali Acc: 0.304 Test Loss: 1.358 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.0282716751098633
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.262 Vali Acc: 0.478 Test Loss: 1.262 Test Acc: 0.478
Validation loss decreased (-0.304334 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.119504690170288
Epoch: 3, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.145 Vali Acc: 0.580 Test Loss: 1.145 Test Acc: 0.580
Validation loss decreased (-0.478248 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.031177043914795
Epoch: 4, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.031 Vali Acc: 0.652 Test Loss: 1.031 Test Acc: 0.652
Validation loss decreased (-0.579699 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 1.0403506755828857
Epoch: 5, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.936 Vali Acc: 0.710 Test Loss: 0.936 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 1.103126049041748
Epoch: 6, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.854 Vali Acc: 0.696 Test Loss: 0.854 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1058785915374756
Epoch: 7, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
Validation loss decreased (-0.710136 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 1.2607386112213135
Epoch: 8, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.732 Vali Acc: 0.768 Test Loss: 0.732 Test Acc: 0.768
Validation loss decreased (-0.739123 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 1.2487902641296387
Epoch: 9, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.705 Vali Acc: 0.768 Test Loss: 0.705 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.2443273067474365
Epoch: 10, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.655 Vali Acc: 0.790 Test Loss: 0.655 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.2676658630371094
Epoch: 11, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 1.1654107570648193
Epoch: 12, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.209700345993042
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.0595440864562988
Epoch: 14, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 1.275465965270996
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.596 Vali Acc: 0.797 Test Loss: 0.596 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0555391311645508
Epoch: 16, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.228482961654663
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2379531860351562
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.594 Vali Acc: 0.797 Test Loss: 0.594 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0781798362731934
Epoch: 19, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.578 Vali Acc: 0.804 Test Loss: 0.578 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1491243839263916
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.567 Vali Acc: 0.804 Test Loss: 0.567 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4646821022033691
Epoch: 21, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.563 Vali Acc: 0.804 Test Loss: 0.563 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3945343494415283
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.44612455368042
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3555655479431152
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.563 Vali Acc: 0.804 Test Loss: 0.563 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 40028
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.342299699783325
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.353 Vali Acc: 0.312 Test Loss: 1.353 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.3144400119781494
Epoch: 2, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.253 Vali Acc: 0.507 Test Loss: 1.253 Test Acc: 0.507
Validation loss decreased (-0.311581 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 1.3126909732818604
Epoch: 3, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.134 Vali Acc: 0.565 Test Loss: 1.134 Test Acc: 0.565
Validation loss decreased (-0.507234 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.3948500156402588
Epoch: 4, Steps: 9 | Train Loss: 0.955 Vali Loss: 1.020 Vali Acc: 0.630 Test Loss: 1.020 Test Acc: 0.630
Validation loss decreased (-0.565206 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.1579880714416504
Epoch: 5, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.925 Vali Acc: 0.696 Test Loss: 0.925 Test Acc: 0.696
Validation loss decreased (-0.630425 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 1.1673405170440674
Epoch: 6, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.841 Vali Acc: 0.732 Test Loss: 0.841 Test Acc: 0.732
Validation loss decreased (-0.695643 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.1870062351226807
Epoch: 7, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.782 Vali Acc: 0.703 Test Loss: 0.782 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1766977310180664
Epoch: 8, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
Validation loss decreased (-0.731876 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 0.9988117218017578
Epoch: 9, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.690 Vali Acc: 0.768 Test Loss: 0.690 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.2928893566131592
Epoch: 10, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.1235673427581787
Epoch: 11, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 1.2002477645874023
Epoch: 12, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 1.2369909286499023
Epoch: 13, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.570 Vali Acc: 0.797 Test Loss: 0.570 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.2741379737854004
Epoch: 14, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 1.0796427726745605
Epoch: 15, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.571 Vali Acc: 0.797 Test Loss: 0.571 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2354364395141602
Epoch: 16, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 1.206700086593628
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2822418212890625
Epoch: 18, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3137781620025635
Epoch: 19, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.552 Vali Acc: 0.790 Test Loss: 0.552 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4633393287658691
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3999314308166504
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4933009147644043
Epoch: 22, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.546 Vali Acc: 0.797 Test Loss: 0.546 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3348274230957031
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 24 cost time: 1.4336657524108887
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 25 cost time: 1.1743717193603516
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.524 Vali Acc: 0.797 Test Loss: 0.524 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4257628917694092
Epoch: 26, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.297344446182251
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4409935474395752
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 29 cost time: 1.2679989337921143
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.797 Test Loss: 0.529 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3479318618774414
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 31 cost time: 1.3673367500305176
Epoch: 31, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 32 cost time: 1.1757073402404785
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3061296939849854
Epoch: 33, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.335862159729004
Epoch: 34, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2717888355255127
Epoch: 35, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2813098430633545
Epoch: 36, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.301222562789917
Epoch: 37, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 38 cost time: 1.2578332424163818
Epoch: 38, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1710319519042969
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 40 cost time: 1.1712331771850586
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.108116865158081
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.091996192932129
Epoch: 42, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 43 cost time: 1.0401854515075684
Epoch: 43, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3776390552520752
Epoch: 44, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.179548740386963
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2838752269744873
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1601958274841309
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1818389892578125
Epoch: 48, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 49 cost time: 1.2222440242767334
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.157438039779663
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 51 cost time: 1.2390973567962646
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2111670970916748
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2869048118591309
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.826 Test Loss: 0.549 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.181030511856079
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.146209955215454
Epoch: 55, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.4884188175201416
Epoch: 56, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2385635375976562
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2593894004821777
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.256594181060791
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.0519824028015137
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 40028
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1214699745178223
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.360 Vali Acc: 0.225 Test Loss: 1.360 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.045403003692627
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.250 Vali Acc: 0.536 Test Loss: 1.250 Test Acc: 0.536
Validation loss decreased (-0.224624 --> -0.536219).  Saving model ...
Epoch: 3 cost time: 1.1588454246520996
Epoch: 3, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.127 Vali Acc: 0.572 Test Loss: 1.127 Test Acc: 0.572
Validation loss decreased (-0.536219 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.162792444229126
Epoch: 4, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.010 Vali Acc: 0.645 Test Loss: 1.010 Test Acc: 0.645
Validation loss decreased (-0.572452 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 1.1237823963165283
Epoch: 5, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.913 Vali Acc: 0.688 Test Loss: 0.913 Test Acc: 0.688
Validation loss decreased (-0.644917 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 1.268364429473877
Epoch: 6, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.832 Vali Acc: 0.739 Test Loss: 0.832 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 1.2193570137023926
Epoch: 7, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.780 Vali Acc: 0.775 Test Loss: 0.780 Test Acc: 0.775
Validation loss decreased (-0.739122 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 1.1408495903015137
Epoch: 8, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 1.2530922889709473
Epoch: 9, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.687 Vali Acc: 0.804 Test Loss: 0.687 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 1.0684130191802979
Epoch: 10, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.643 Vali Acc: 0.812 Test Loss: 0.643 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.2244255542755127
Epoch: 11, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 1.201937198638916
Epoch: 12, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 1.0297422409057617
Epoch: 13, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1482248306274414
Epoch: 14, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 1.2320501804351807
Epoch: 15, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 1.3281593322753906
Epoch: 16, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3303585052490234
Epoch: 17, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.268164873123169
Epoch: 18, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 1.332399606704712
Epoch: 19, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 20 cost time: 1.2089378833770752
Epoch: 20, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1832449436187744
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 1.1741294860839844
Epoch: 22, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2085175514221191
Epoch: 23, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0941698551177979
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.08449387550354
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 1.1418094635009766
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.23561429977417
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1380367279052734
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.217083215713501
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 1.228142261505127
Epoch: 30, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0953779220581055
Epoch: 31, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 32 cost time: 1.0973365306854248
Epoch: 32, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.135498046875
Epoch: 33, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2729687690734863
Epoch: 34, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2719395160675049
Epoch: 35, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0449271202087402
Epoch: 36, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.280799150466919
Epoch: 37, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1703543663024902
Epoch: 38, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2347614765167236
Epoch: 39, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1991214752197266
Epoch: 40, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2142298221588135
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 40028
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.300584554672241
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.144 Vali Acc: 0.529 Test Loss: 1.144 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 1.384131669998169
Epoch: 2, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.715 Vali Acc: 0.754 Test Loss: 0.715 Test Acc: 0.754
Validation loss decreased (-0.528974 --> -0.753616).  Saving model ...
Epoch: 3 cost time: 1.1026506423950195
Epoch: 3, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 1.2063021659851074
Epoch: 4, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
Validation loss decreased (-0.797096 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 1.1516287326812744
Epoch: 5, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2700319290161133
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 1.1341946125030518
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1183795928955078
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.005612850189209
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9247250556945801
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1403143405914307
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9695618152618408
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0933072566986084
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1405086517333984
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0236918926239014
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.238603115081787
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 3057184
model size : 21.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0819950103759766
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.126 Vali Acc: 0.522 Test Loss: 1.126 Test Acc: 0.522
Validation loss decreased (inf --> -0.521728).  Saving model ...
Epoch: 2 cost time: 1.0091092586517334
Epoch: 2, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.699 Vali Acc: 0.746 Test Loss: 0.699 Test Acc: 0.746
Validation loss decreased (-0.521728 --> -0.746370).  Saving model ...
Epoch: 3 cost time: 1.1000878810882568
Epoch: 3, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775357).  Saving model ...
Epoch: 4 cost time: 1.176612138748169
Epoch: 4, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
Validation loss decreased (-0.775357 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 1.1068229675292969
Epoch: 5, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 6 cost time: 1.1507923603057861
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.105816125869751
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1514177322387695
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.176175832748413
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1279363632202148
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0480856895446777
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.848 Test Loss: 0.633 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1351656913757324
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.841 Test Loss: 0.646 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1339929103851318
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.848 Test Loss: 0.647 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1501812934875488
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.040144443511963
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 3057184
model size : 21.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8717215061187744
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.080 Vali Acc: 0.551 Test Loss: 1.080 Test Acc: 0.551
Validation loss decreased (inf --> -0.550714).  Saving model ...
Epoch: 2 cost time: 1.1625869274139404
Epoch: 2, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.678 Vali Acc: 0.761 Test Loss: 0.678 Test Acc: 0.761
Validation loss decreased (-0.550714 --> -0.760863).  Saving model ...
Epoch: 3 cost time: 1.1141371726989746
Epoch: 3, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.636 Vali Acc: 0.725 Test Loss: 0.636 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1532676219940186
Epoch: 4, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
Validation loss decreased (-0.760863 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 1.1501402854919434
Epoch: 5, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0991017818450928
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2065479755401611
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.2036597728729248
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 1.0702314376831055
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0041286945343018
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2887682914733887
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.862 Test Loss: 0.561 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1936943531036377
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.119386911392212
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1118764877319336
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.267099380493164
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3013267517089844
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.862 Test Loss: 0.552 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2377243041992188
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2280807495117188
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3057184
model size : 21.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.228421449661255
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.030 Vali Acc: 0.609 Test Loss: 1.030 Test Acc: 0.609
Validation loss decreased (inf --> -0.608685).  Saving model ...
Epoch: 2 cost time: 1.1406280994415283
Epoch: 2, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
Validation loss decreased (-0.608685 --> -0.775356).  Saving model ...
Epoch: 3 cost time: 1.0910325050354004
Epoch: 3, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.606 Vali Acc: 0.725 Test Loss: 0.606 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.025984764099121
Epoch: 4, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 1.0606756210327148
Epoch: 5, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 1.0431175231933594
Epoch: 6, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 7 cost time: 1.0952260494232178
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 1.034501075744629
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.877 Test Loss: 0.528 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 1.0564188957214355
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 1.0773639678955078
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2073862552642822
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1092910766601562
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0483906269073486
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1706998348236084
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1668381690979004
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9994215965270996
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0886969566345215
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0656347274780273
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9609763622283936
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.862 Test Loss: 0.551 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3057184
model size : 21.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9989562034606934
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 1.097952127456665
Epoch: 2, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.739 Vali Acc: 0.696 Test Loss: 0.739 Test Acc: 0.696
Validation loss decreased (-0.514481 --> -0.695645).  Saving model ...
Epoch: 3 cost time: 1.0713434219360352
Epoch: 3, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
Validation loss decreased (-0.695645 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 1.1323301792144775
Epoch: 4, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.588 Vali Acc: 0.855 Test Loss: 0.588 Test Acc: 0.855
Validation loss decreased (-0.797096 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.020890474319458
Epoch: 5, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.641 Vali Acc: 0.754 Test Loss: 0.641 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0996360778808594
Epoch: 6, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.099548101425171
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.862 Test Loss: 0.483 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.1322686672210693
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.862 Test Loss: 0.584 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0024683475494385
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0538692474365234
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9936439990997314
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.862 Test Loss: 0.615 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9525463581085205
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.862 Test Loss: 0.613 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2000105381011963
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.855 Test Loss: 0.631 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1098346710205078
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.862 Test Loss: 0.641 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.095031499862671
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.862 Test Loss: 0.646 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.064279556274414
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.862 Test Loss: 0.653 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.11859130859375
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.862 Test Loss: 0.661 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 2008608
model size : 17.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.183835506439209
Epoch: 1, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.123 Vali Acc: 0.536 Test Loss: 1.123 Test Acc: 0.536
Validation loss decreased (inf --> -0.536221).  Saving model ...
Epoch: 2 cost time: 1.0798430442810059
Epoch: 2, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.800 Vali Acc: 0.674 Test Loss: 0.800 Test Acc: 0.674
Validation loss decreased (-0.536221 --> -0.673905).  Saving model ...
Epoch: 3 cost time: 1.0325794219970703
Epoch: 3, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.673905 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.0529305934906006
Epoch: 4, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862313).  Saving model ...
Epoch: 5 cost time: 1.1090872287750244
Epoch: 5, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.614 Vali Acc: 0.768 Test Loss: 0.614 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.097425937652588
Epoch: 6, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.526 Vali Acc: 0.870 Test Loss: 0.526 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 7 cost time: 1.1740808486938477
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0448839664459229
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.877 Test Loss: 0.579 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 1.0770928859710693
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.870 Test Loss: 0.613 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.126448154449463
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0836083889007568
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.862 Test Loss: 0.591 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.18593168258667
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1627261638641357
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.870 Test Loss: 0.611 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1465117931365967
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.870 Test Loss: 0.621 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1260802745819092
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.870 Test Loss: 0.624 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1355762481689453
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2147786617279053
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.848 Test Loss: 0.632 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1049656867980957
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.855 Test Loss: 0.632 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2008608
model size : 17.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2588694095611572
Epoch: 1, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.090 Vali Acc: 0.551 Test Loss: 1.090 Test Acc: 0.551
Validation loss decreased (inf --> -0.550714).  Saving model ...
Epoch: 2 cost time: 1.2387592792510986
Epoch: 2, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
Validation loss decreased (-0.550714 --> -0.688398).  Saving model ...
Epoch: 3 cost time: 1.168217420578003
Epoch: 3, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.530 Vali Acc: 0.790 Test Loss: 0.530 Test Acc: 0.790
Validation loss decreased (-0.688398 --> -0.789850).  Saving model ...
Epoch: 4 cost time: 1.1546883583068848
Epoch: 4, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
Validation loss decreased (-0.789850 --> -0.884053).  Saving model ...
Epoch: 5 cost time: 1.1588170528411865
Epoch: 5, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.464 Vali Acc: 0.826 Test Loss: 0.464 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.206496000289917
Epoch: 6, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1838037967681885
Epoch: 7, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0932514667510986
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1734745502471924
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2322521209716797
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1032676696777344
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.877 Test Loss: 0.503 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1248903274536133
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.877 Test Loss: 0.509 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.054046630859375
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1468422412872314
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2008608
model size : 17.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1076676845550537
Epoch: 1, Steps: 9 | Train Loss: 1.285 Vali Loss: 1.019 Vali Acc: 0.609 Test Loss: 1.019 Test Acc: 0.609
Validation loss decreased (inf --> -0.608685).  Saving model ...
Epoch: 2 cost time: 1.0570404529571533
Epoch: 2, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.608685 --> -0.739123).  Saving model ...
Epoch: 3 cost time: 1.00347900390625
Epoch: 3, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.512 Vali Acc: 0.804 Test Loss: 0.512 Test Acc: 0.804
Validation loss decreased (-0.739123 --> -0.804343).  Saving model ...
Epoch: 4 cost time: 1.007908582687378
Epoch: 4, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
Validation loss decreased (-0.804343 --> -0.876807).  Saving model ...
Epoch: 5 cost time: 1.086719274520874
Epoch: 5, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.450 Vali Acc: 0.812 Test Loss: 0.450 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9706284999847412
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.111832618713379
Epoch: 7, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 1.1149845123291016
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9100611209869385
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9724633693695068
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9182827472686768
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.870 Test Loss: 0.538 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.924807071685791
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0977861881256104
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.877 Test Loss: 0.496 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0670948028564453
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.877 Test Loss: 0.506 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0336852073669434
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.870 Test Loss: 0.515 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9751250743865967
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9821817874908447
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2008608
model size : 17.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5089025497436523
Epoch: 1, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.034 Vali Acc: 0.601 Test Loss: 1.034 Test Acc: 0.601
Validation loss decreased (inf --> -0.601439).  Saving model ...
Epoch: 2 cost time: 0.9846038818359375
Epoch: 2, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
Validation loss decreased (-0.601439 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 1.1559884548187256
Epoch: 3, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1665012836456299
Epoch: 4, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.542 Vali Acc: 0.804 Test Loss: 0.542 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0823414325714111
Epoch: 5, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 1.111138105392456
Epoch: 6, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1895039081573486
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0321238040924072
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1131417751312256
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0666606426239014
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0966870784759521
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1738698482513428
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.826 Test Loss: 0.624 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.067411184310913
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0760676860809326
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0923688411712646
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1484320
model size : 15.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0673577785491943
Epoch: 1, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.018 Vali Acc: 0.601 Test Loss: 1.018 Test Acc: 0.601
Validation loss decreased (inf --> -0.601439).  Saving model ...
Epoch: 2 cost time: 1.0268173217773438
Epoch: 2, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.601439 --> -0.833327).  Saving model ...
Epoch: 3 cost time: 0.9885268211364746
Epoch: 3, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.0153489112854004
Epoch: 4, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1525208950042725
Epoch: 5, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 1.2013537883758545
Epoch: 6, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.078714370727539
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.114116907119751
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0793635845184326
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2157320976257324
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.053614854812622
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.848 Test Loss: 0.595 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1227116584777832
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9876179695129395
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1175580024719238
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0609822273254395
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1484320
model size : 15.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.927572011947632
Epoch: 1, Steps: 9 | Train Loss: 1.312 Vali Loss: 0.998 Vali Acc: 0.616 Test Loss: 0.998 Test Acc: 0.616
Validation loss decreased (inf --> -0.615932).  Saving model ...
Epoch: 2 cost time: 1.0195705890655518
Epoch: 2, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.615932 --> -0.840574).  Saving model ...
Epoch: 3 cost time: 1.0463142395019531
Epoch: 3, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0046720504760742
Epoch: 4, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0813829898834229
Epoch: 5, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 1.0772995948791504
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 1.1951375007629395
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.1715583801269531
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0698449611663818
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2091789245605469
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.117156982421875
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2825853824615479
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2029049396514893
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0837953090667725
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.862 Test Loss: 0.533 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3100166320800781
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.123037338256836
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0460529327392578
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1484320
model size : 15.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.122865915298462
Epoch: 1, Steps: 9 | Train Loss: 1.290 Vali Loss: 0.990 Vali Acc: 0.601 Test Loss: 0.990 Test Acc: 0.601
Validation loss decreased (inf --> -0.601439).  Saving model ...
Epoch: 2 cost time: 0.8990762233734131
Epoch: 2, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
Validation loss decreased (-0.601439 --> -0.855067).  Saving model ...
Epoch: 3 cost time: 0.9573569297790527
Epoch: 3, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9374995231628418
Epoch: 4, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8786239624023438
Epoch: 5, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 0.9885814189910889
Epoch: 6, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.531 Vali Acc: 0.855 Test Loss: 0.531 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9602260589599609
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1296017169952393
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9254732131958008
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 0.9965951442718506
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 1.0829761028289795
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0631349086761475
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.035383701324463
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1617858409881592
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0120813846588135
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1955852508544922
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0193793773651123
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0357708930969238
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.855 Test Loss: 0.557 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0896708965301514
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2266638278961182
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1484320
model size : 15.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.191394329071045
Epoch: 1, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
Validation loss decreased (inf --> -0.485496).  Saving model ...
Epoch: 2 cost time: 1.2970328330993652
Epoch: 2, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.648 Vali Acc: 0.797 Test Loss: 0.648 Test Acc: 0.797
Validation loss decreased (-0.485496 --> -0.797095).  Saving model ...
Epoch: 3 cost time: 1.144989013671875
Epoch: 3, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.175248146057129
Epoch: 4, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 1.1453857421875
Epoch: 5, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.117546796798706
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 1.0668179988861084
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.826 Test Loss: 0.628 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1557586193084717
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1255440711975098
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1295616626739502
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1920690536499023
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.093446969985962
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0755412578582764
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0822007656097412
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.826 Test Loss: 0.658 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1456732749938965
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1230542659759521
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1222176
model size : 14.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9089303016662598
Epoch: 1, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 1.0415451526641846
Epoch: 2, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.499989 --> -0.818834).  Saving model ...
Epoch: 3 cost time: 1.0564186573028564
Epoch: 3, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0718753337860107
Epoch: 4, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.164609432220459
Epoch: 5, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.584 Vali Acc: 0.790 Test Loss: 0.584 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1569397449493408
Epoch: 6, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847821).  Saving model ...
Epoch: 7 cost time: 1.3354244232177734
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.812 Test Loss: 0.671 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0581328868865967
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.848 Test Loss: 0.599 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1496107578277588
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1687638759613037
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.797 Test Loss: 0.778 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0152628421783447
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.790 Test Loss: 0.919 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.260650873184204
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.812 Test Loss: 0.844 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0556354522705078
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1348674297332764
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0681743621826172
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1176295280456543
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 1222176
model size : 14.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.048862934112549
Epoch: 1, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.057 Vali Acc: 0.551 Test Loss: 1.057 Test Acc: 0.551
Validation loss decreased (inf --> -0.550714).  Saving model ...
Epoch: 2 cost time: 1.141341209411621
Epoch: 2, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
Validation loss decreased (-0.550714 --> -0.818834).  Saving model ...
Epoch: 3 cost time: 1.1266040802001953
Epoch: 3, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2781195640563965
Epoch: 4, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840574).  Saving model ...
Epoch: 5 cost time: 1.184180736541748
Epoch: 5, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1245694160461426
Epoch: 6, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1962459087371826
Epoch: 7, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1764583587646484
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.0450873374938965
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.848 Test Loss: 0.600 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847820).  Saving model ...
Epoch: 10 cost time: 1.0741758346557617
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 1.0974059104919434
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0792911052703857
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.121870517730713
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 14 cost time: 1.2089717388153076
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0869669914245605
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1147747039794922
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.855 Test Loss: 0.565 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0700929164886475
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.161510944366455
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.123595952987671
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0681114196777344
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0043895244598389
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.862 Test Loss: 0.575 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9941482543945312
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9722590446472168
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.855 Test Loss: 0.575 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1222176
model size : 14.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8621575832366943
Epoch: 1, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.000 Vali Acc: 0.580 Test Loss: 1.000 Test Acc: 0.580
Validation loss decreased (inf --> -0.579700).  Saving model ...
Epoch: 2 cost time: 0.9459280967712402
Epoch: 2, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
Validation loss decreased (-0.579700 --> -0.826081).  Saving model ...
Epoch: 3 cost time: 0.9685933589935303
Epoch: 3, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826083).  Saving model ...
Epoch: 4 cost time: 0.9732890129089355
Epoch: 4, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
Validation loss decreased (-0.826083 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.1163852214813232
Epoch: 5, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.485 Vali Acc: 0.804 Test Loss: 0.485 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.011577844619751
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0010857582092285
Epoch: 7, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.068310022354126
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0467040538787842
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9814293384552002
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 1.0055227279663086
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0422394275665283
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 0.9995903968811035
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.970550537109375
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.862 Test Loss: 0.516 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0460169315338135
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.862 Test Loss: 0.521 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9928154945373535
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.966045618057251
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0428309440612793
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9142496585845947
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.862 Test Loss: 0.533 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.073291540145874
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.862 Test Loss: 0.537 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9528412818908691
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9463229179382324
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1222176
model size : 14.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0160531997680664
Epoch: 1, Steps: 9 | Train Loss: 1.281 Vali Loss: 0.998 Vali Acc: 0.587 Test Loss: 0.998 Test Acc: 0.587
Validation loss decreased (inf --> -0.586947).  Saving model ...
Epoch: 2 cost time: 0.9938135147094727
Epoch: 2, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
Validation loss decreased (-0.586947 --> -0.804341).  Saving model ...
Epoch: 3 cost time: 1.0567359924316406
Epoch: 3, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804343).  Saving model ...
Epoch: 4 cost time: 0.9793751239776611
Epoch: 4, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
Validation loss decreased (-0.804343 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 1.1485702991485596
Epoch: 5, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0710620880126953
Epoch: 6, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.687 Vali Acc: 0.841 Test Loss: 0.687 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1356236934661865
Epoch: 7, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.164405345916748
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.855 Test Loss: 0.615 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.082897663116455
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.833 Test Loss: 0.718 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1013493537902832
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.848 Test Loss: 0.610 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1139459609985352
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.833 Test Loss: 0.589 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0200750827789307
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0854730606079102
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0659914016723633
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1091104
model size : 13.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2871296405792236
Epoch: 1, Steps: 9 | Train Loss: 1.269 Vali Loss: 0.971 Vali Acc: 0.638 Test Loss: 0.971 Test Acc: 0.638
Validation loss decreased (inf --> -0.637671).  Saving model ...
Epoch: 2 cost time: 0.962195634841919
Epoch: 2, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.617 Vali Acc: 0.790 Test Loss: 0.617 Test Acc: 0.790
Validation loss decreased (-0.637671 --> -0.789849).  Saving model ...
Epoch: 3 cost time: 1.1260862350463867
Epoch: 3, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
Validation loss decreased (-0.789849 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.1230952739715576
Epoch: 4, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 1.0023624897003174
Epoch: 5, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0434479713439941
Epoch: 6, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.621 Vali Acc: 0.848 Test Loss: 0.621 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9371123313903809
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9974994659423828
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 9 cost time: 1.052682638168335
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.819 Test Loss: 0.727 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0476624965667725
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.862 Test Loss: 0.598 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.112220048904419
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.848 Test Loss: 0.595 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.033881664276123
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1256027221679688
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.848 Test Loss: 0.634 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0497257709503174
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.848 Test Loss: 0.631 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9530186653137207
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.862 Test Loss: 0.634 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.174056053161621
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.848 Test Loss: 0.638 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1653709411621094
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.855 Test Loss: 0.639 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1607213020324707
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.855 Test Loss: 0.641 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1091104
model size : 13.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.321779251098633
Epoch: 1, Steps: 9 | Train Loss: 1.271 Vali Loss: 0.950 Vali Acc: 0.638 Test Loss: 0.950 Test Acc: 0.638
Validation loss decreased (inf --> -0.637672).  Saving model ...
Epoch: 2 cost time: 1.037501573562622
Epoch: 2, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
Validation loss decreased (-0.637672 --> -0.789849).  Saving model ...
Epoch: 3 cost time: 1.0618886947631836
Epoch: 3, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
Validation loss decreased (-0.789849 --> -0.869561).  Saving model ...
Epoch: 4 cost time: 1.184291124343872
Epoch: 4, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9414498805999756
Epoch: 5, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1341052055358887
Epoch: 6, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.754 Test Loss: 0.712 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0413377285003662
Epoch: 7, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9837002754211426
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0123178958892822
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.862 Test Loss: 0.674 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9368798732757568
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9616799354553223
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9472191333770752
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0598950386047363
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1091104
model size : 13.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.091723918914795
Epoch: 1, Steps: 9 | Train Loss: 1.251 Vali Loss: 0.927 Vali Acc: 0.638 Test Loss: 0.927 Test Acc: 0.638
Validation loss decreased (inf --> -0.637672).  Saving model ...
Epoch: 2 cost time: 1.148292064666748
Epoch: 2, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.637672 --> -0.811588).  Saving model ...
Epoch: 3 cost time: 1.0693004131317139
Epoch: 3, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855068).  Saving model ...
Epoch: 4 cost time: 1.1191918849945068
Epoch: 4, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 1.251990795135498
Epoch: 5, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0904793739318848
Epoch: 6, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.607 Vali Acc: 0.812 Test Loss: 0.607 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9953484535217285
Epoch: 7, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 1.0156269073486328
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.855 Test Loss: 0.621 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.232243299484253
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.804 Test Loss: 0.565 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1302502155303955
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0230021476745605
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1364214420318604
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.848 Test Loss: 0.642 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0041077136993408
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0554614067077637
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.862 Test Loss: 0.582 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9981653690338135
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.862 Test Loss: 0.565 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0222265720367432
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.862 Test Loss: 0.561 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9771695137023926
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.862 Test Loss: 0.562 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1091104
model size : 13.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8924379348754883
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.144 Vali Acc: 0.558 Test Loss: 1.144 Test Acc: 0.558
Validation loss decreased (inf --> -0.557960).  Saving model ...
Epoch: 2 cost time: 1.0415253639221191
Epoch: 2, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.704 Vali Acc: 0.768 Test Loss: 0.704 Test Acc: 0.768
Validation loss decreased (-0.557960 --> -0.768109).  Saving model ...
Epoch: 3 cost time: 1.0533244609832764
Epoch: 3, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.687 Vali Acc: 0.725 Test Loss: 0.687 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.120732069015503
Epoch: 4, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.797 Test Loss: 0.550 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797096).  Saving model ...
Epoch: 5 cost time: 1.183727502822876
Epoch: 5, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.841 Test Loss: 0.631 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840573).  Saving model ...
Epoch: 6 cost time: 1.0932691097259521
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0319478511810303
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1364736557006836
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2586948871612549
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.675 Vali Acc: 0.855 Test Loss: 0.675 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855066).  Saving model ...
Epoch: 10 cost time: 1.1405589580535889
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.826 Test Loss: 0.729 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0937659740447998
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.14908766746521
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1217656135559082
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.819 Test Loss: 0.712 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1785674095153809
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.819 Test Loss: 0.718 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.238628625869751
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1418015956878662
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1845433712005615
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0780465602874756
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1797285079956055
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 1025568
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.978559732437134
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.105 Vali Acc: 0.601 Test Loss: 1.105 Test Acc: 0.601
Validation loss decreased (inf --> -0.601438).  Saving model ...
Epoch: 2 cost time: 1.0748677253723145
Epoch: 2, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
Validation loss decreased (-0.601438 --> -0.797095).  Saving model ...
Epoch: 3 cost time: 1.0677084922790527
Epoch: 3, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.049555778503418
Epoch: 4, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.580 Vali Acc: 0.790 Test Loss: 0.580 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9533004760742188
Epoch: 5, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.676 Vali Acc: 0.826 Test Loss: 0.676 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826080).  Saving model ...
Epoch: 6 cost time: 1.0659775733947754
Epoch: 6, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9445104598999023
Epoch: 7, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9457697868347168
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.646 Vali Acc: 0.819 Test Loss: 0.646 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.101264238357544
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0607314109802246
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.089 Vali Acc: 0.732 Test Loss: 1.089 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1640019416809082
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.790 Test Loss: 0.852 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.964848518371582
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.804 Test Loss: 0.705 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0356228351593018
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 14 cost time: 1.003605604171753
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.804 Test Loss: 0.682 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0397834777832031
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 1.0844111442565918
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.797 Test Loss: 0.818 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.124624252319336
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0758228302001953
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.826 Test Loss: 0.794 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0872831344604492
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.826 Test Loss: 0.784 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1843979358673096
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.826 Test Loss: 0.770 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1145412921905518
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.833 Test Loss: 0.759 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0941181182861328
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9871599674224854
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0287683010101318
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0054221153259277
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 1025568
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.940768241882324
Epoch: 1, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.075 Vali Acc: 0.601 Test Loss: 1.075 Test Acc: 0.601
Validation loss decreased (inf --> -0.601439).  Saving model ...
Epoch: 2 cost time: 1.0711309909820557
Epoch: 2, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.645 Vali Acc: 0.790 Test Loss: 0.645 Test Acc: 0.790
Validation loss decreased (-0.601439 --> -0.789849).  Saving model ...
Epoch: 3 cost time: 1.077371597290039
Epoch: 3, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.149115800857544
Epoch: 4, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0520904064178467
Epoch: 5, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.736 Vali Acc: 0.790 Test Loss: 0.736 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.125169277191162
Epoch: 6, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 1.0396091938018799
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.05128812789917
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.804 Test Loss: 0.502 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0129270553588867
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0805559158325195
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.862 Test Loss: 0.673 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862312).  Saving model ...
Epoch: 11 cost time: 1.025822401046753
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.819 Test Loss: 0.703 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.092790126800537
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.201648473739624
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2050962448120117
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0220603942871094
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0796067714691162
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0603952407836914
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0673589706420898
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0599429607391357
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.848 Test Loss: 0.622 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.164374828338623
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1025568
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8781485557556152
Epoch: 1, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.012 Vali Acc: 0.572 Test Loss: 1.012 Test Acc: 0.572
Validation loss decreased (inf --> -0.572454).  Saving model ...
Epoch: 2 cost time: 0.9494245052337646
Epoch: 2, Steps: 9 | Train Loss: 0.603 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
Validation loss decreased (-0.572454 --> -0.804341).  Saving model ...
Epoch: 3 cost time: 1.056577444076538
Epoch: 3, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.527 Vali Acc: 0.754 Test Loss: 0.527 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9227526187896729
Epoch: 4, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.503 Vali Acc: 0.819 Test Loss: 0.503 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 0.9595029354095459
Epoch: 5, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.677 Vali Acc: 0.790 Test Loss: 0.677 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9517707824707031
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 0.9365882873535156
Epoch: 7, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 1.0298471450805664
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0598723888397217
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9830203056335449
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0645606517791748
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0142264366149902
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9674942493438721
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2249383926391602
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9743461608886719
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1103665828704834
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0376055240631104
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.848 Test Loss: 0.514 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1025568
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0433356761932373
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 0.919658899307251
Epoch: 2, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.842 Vali Acc: 0.703 Test Loss: 0.842 Test Acc: 0.703
Validation loss decreased (-0.514481 --> -0.702890).  Saving model ...
Epoch: 3 cost time: 1.0419762134552002
Epoch: 3, Steps: 9 | Train Loss: 0.464 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
Validation loss decreased (-0.702890 --> -0.775356).  Saving model ...
Epoch: 4 cost time: 0.948937177658081
Epoch: 4, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 0.9554741382598877
Epoch: 5, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9521999359130859
Epoch: 6, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 0.9108901023864746
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 0.9611139297485352
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 0.9388201236724854
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9158947467803955
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0460715293884277
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8787655830383301
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8755683898925781
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8967204093933105
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9114658832550049
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.855 Test Loss: 0.594 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9492864608764648
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.855 Test Loss: 0.602 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9475748538970947
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.013890266418457
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.855 Test Loss: 0.615 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1397536
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.711265802383423
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.135 Vali Acc: 0.543 Test Loss: 1.135 Test Acc: 0.543
Validation loss decreased (inf --> -0.543467).  Saving model ...
Epoch: 2 cost time: 1.0509860515594482
Epoch: 2, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.814 Vali Acc: 0.746 Test Loss: 0.814 Test Acc: 0.746
Validation loss decreased (-0.543467 --> -0.746369).  Saving model ...
Epoch: 3 cost time: 0.942793607711792
Epoch: 3, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.602 Vali Acc: 0.768 Test Loss: 0.602 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768110).  Saving model ...
Epoch: 4 cost time: 1.1070492267608643
Epoch: 4, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 0.9870924949645996
Epoch: 5, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0029058456420898
Epoch: 6, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0133821964263916
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 1.1336209774017334
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.523 Vali Acc: 0.862 Test Loss: 0.523 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 1.0009448528289795
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9862887859344482
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.855 Test Loss: 0.562 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0319266319274902
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.855 Test Loss: 0.565 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0225515365600586
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.855 Test Loss: 0.575 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2380380630493164
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1294286251068115
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1567347049713135
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2446556091308594
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2075350284576416
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0273375511169434
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.855 Test Loss: 0.610 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1397536
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.985888719558716
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 0.9762773513793945
Epoch: 2, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.770 Vali Acc: 0.768 Test Loss: 0.770 Test Acc: 0.768
Validation loss decreased (-0.579699 --> -0.768108).  Saving model ...
Epoch: 3 cost time: 0.8525922298431396
Epoch: 3, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775357).  Saving model ...
Epoch: 4 cost time: 0.9429996013641357
Epoch: 4, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.512 Vali Acc: 0.862 Test Loss: 0.512 Test Acc: 0.862
Validation loss decreased (-0.775357 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 0.9482097625732422
Epoch: 5, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.561 Vali Acc: 0.754 Test Loss: 0.561 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9393215179443359
Epoch: 6, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0192475318908691
Epoch: 7, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.454 Vali Acc: 0.826 Test Loss: 0.454 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9701211452484131
Epoch: 8, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0501925945281982
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.098391056060791
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 0.934821605682373
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.103834629058838
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 1.108515977859497
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0758352279663086
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 15 cost time: 0.9299860000610352
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0530831813812256
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0919349193572998
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9601006507873535
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.877 Test Loss: 0.533 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9833378791809082
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.877 Test Loss: 0.537 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.98101806640625
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9952554702758789
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0677580833435059
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.877 Test Loss: 0.546 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9853839874267578
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.870 Test Loss: 0.548 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0837242603302002
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.877 Test Loss: 0.546 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1397536
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.926596164703369
Epoch: 1, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.066 Vali Acc: 0.630 Test Loss: 1.066 Test Acc: 0.630
Validation loss decreased (inf --> -0.630424).  Saving model ...
Epoch: 2 cost time: 1.0197997093200684
Epoch: 2, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
Validation loss decreased (-0.630424 --> -0.818833).  Saving model ...
Epoch: 3 cost time: 0.9691059589385986
Epoch: 3, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 0.9201152324676514
Epoch: 4, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869561).  Saving model ...
Epoch: 5 cost time: 0.9758954048156738
Epoch: 5, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0055627822875977
Epoch: 6, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9836175441741943
Epoch: 7, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0015788078308105
Epoch: 8, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.429 Vali Acc: 0.841 Test Loss: 0.429 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9611790180206299
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9798784255981445
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.965484619140625
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9994113445281982
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9837641716003418
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9921846389770508
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1397536
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.040299892425537
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.134 Vali Acc: 0.558 Test Loss: 1.134 Test Acc: 0.558
Validation loss decreased (inf --> -0.557960).  Saving model ...
Epoch: 2 cost time: 0.9355523586273193
Epoch: 2, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.770 Vali Acc: 0.819 Test Loss: 0.770 Test Acc: 0.819
Validation loss decreased (-0.557960 --> -0.818833).  Saving model ...
Epoch: 3 cost time: 0.9904460906982422
Epoch: 3, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.588 Vali Acc: 0.870 Test Loss: 0.588 Test Acc: 0.870
Validation loss decreased (-0.818833 --> -0.869559).  Saving model ...
Epoch: 4 cost time: 1.004981279373169
Epoch: 4, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9721078872680664
Epoch: 5, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.936382532119751
Epoch: 6, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9007997512817383
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.533 Vali Acc: 0.862 Test Loss: 0.533 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8558149337768555
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 0.9178638458251953
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9409503936767578
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0238683223724365
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9953861236572266
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9222729206085205
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.848 Test Loss: 0.550 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0430190563201904
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0438790321350098
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0954320430755615
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9892318248748779
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.848 Test Loss: 0.592 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9369833469390869
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.848 Test Loss: 0.588 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 873248
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.257289409637451
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.127 Vali Acc: 0.601 Test Loss: 1.127 Test Acc: 0.601
Validation loss decreased (inf --> -0.601438).  Saving model ...
Epoch: 2 cost time: 1.0799245834350586
Epoch: 2, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
Validation loss decreased (-0.601438 --> -0.811587).  Saving model ...
Epoch: 3 cost time: 1.1378445625305176
Epoch: 3, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.583 Vali Acc: 0.870 Test Loss: 0.583 Test Acc: 0.870
Validation loss decreased (-0.811587 --> -0.869559).  Saving model ...
Epoch: 4 cost time: 1.0341663360595703
Epoch: 4, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9660253524780273
Epoch: 5, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.540 Vali Acc: 0.862 Test Loss: 0.540 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2093479633331299
Epoch: 6, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1359889507293701
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 1.1528096199035645
Epoch: 8, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.170182704925537
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9325613975524902
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0090413093566895
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1419031620025635
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.870 Test Loss: 0.546 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9261419773101807
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.870 Test Loss: 0.551 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9919795989990234
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9286420345306396
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0774035453796387
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.862 Test Loss: 0.567 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0671520233154297
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.862 Test Loss: 0.584 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 873248
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.451090097427368
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.117 Vali Acc: 0.572 Test Loss: 1.117 Test Acc: 0.572
Validation loss decreased (inf --> -0.572453).  Saving model ...
Epoch: 2 cost time: 1.0278959274291992
Epoch: 2, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.747 Vali Acc: 0.812 Test Loss: 0.747 Test Acc: 0.812
Validation loss decreased (-0.572453 --> -0.811587).  Saving model ...
Epoch: 3 cost time: 0.9147214889526367
Epoch: 3, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 1.0545594692230225
Epoch: 4, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0430271625518799
Epoch: 5, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869560).  Saving model ...
Epoch: 6 cost time: 0.9156229496002197
Epoch: 6, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9308316707611084
Epoch: 7, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 1.0014286041259766
Epoch: 8, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1220834255218506
Epoch: 9, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.482 Vali Acc: 0.841 Test Loss: 0.482 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0814635753631592
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1523487567901611
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0943224430084229
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.506 Vali Acc: 0.862 Test Loss: 0.506 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0001370906829834
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1075291633605957
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9575791358947754
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.021087646484375
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.870 Test Loss: 0.517 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9867849349975586
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.877 Test Loss: 0.532 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 18 cost time: 1.025191307067871
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.877 Test Loss: 0.531 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 19 cost time: 0.9710099697113037
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1166801452636719
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9698679447174072
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.870 Test Loss: 0.524 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9210178852081299
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0942659378051758
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.870 Test Loss: 0.542 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0281364917755127
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.862 Test Loss: 0.544 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0452089309692383
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0249073505401611
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.037426233291626
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.870 Test Loss: 0.555 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.02048921585083
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.877 Test Loss: 0.552 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 873248
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.055438280105591
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.076 Vali Acc: 0.623 Test Loss: 1.076 Test Acc: 0.623
Validation loss decreased (inf --> -0.623178).  Saving model ...
Epoch: 2 cost time: 1.0641353130340576
Epoch: 2, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.705 Vali Acc: 0.804 Test Loss: 0.705 Test Acc: 0.804
Validation loss decreased (-0.623178 --> -0.804341).  Saving model ...
Epoch: 3 cost time: 1.0443918704986572
Epoch: 3, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.804341 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 0.9989790916442871
Epoch: 4, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 1.157639980316162
Epoch: 5, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.460 Vali Acc: 0.884 Test Loss: 0.460 Test Acc: 0.884
Validation loss decreased (-0.840575 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 1.088104009628296
Epoch: 6, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.429 Vali Acc: 0.819 Test Loss: 0.429 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9193847179412842
Epoch: 7, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9121968746185303
Epoch: 8, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 0.970261812210083
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9656975269317627
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0957789421081543
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0409667491912842
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0821762084960938
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2439825534820557
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9871892929077148
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0601787567138672
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0679244995117188
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0969021320343018
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 873248
model size : 8.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.175092935562134
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.180 Vali Acc: 0.384 Test Loss: 1.180 Test Acc: 0.384
Validation loss decreased (inf --> -0.384046).  Saving model ...
Epoch: 2 cost time: 0.9749267101287842
Epoch: 2, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.840 Vali Acc: 0.717 Test Loss: 0.840 Test Acc: 0.717
Validation loss decreased (-0.384046 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 0.9650509357452393
Epoch: 3, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.717383 --> -0.833327).  Saving model ...
Epoch: 4 cost time: 1.1391069889068604
Epoch: 4, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 0.9172611236572266
Epoch: 5, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0054738521575928
Epoch: 6, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.638 Vali Acc: 0.790 Test Loss: 0.638 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9788217544555664
Epoch: 7, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 8 cost time: 0.9056174755096436
Epoch: 8, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.877 Test Loss: 0.570 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876806).  Saving model ...
Epoch: 9 cost time: 0.9358327388763428
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0316624641418457
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9877474308013916
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.158189058303833
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.833 Test Loss: 0.595 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9967052936553955
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1365129947662354
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9451339244842529
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9497568607330322
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9465992450714111
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.038508415222168
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 611104
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2305736541748047
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.172 Vali Acc: 0.457 Test Loss: 1.172 Test Acc: 0.457
Validation loss decreased (inf --> -0.456510).  Saving model ...
Epoch: 2 cost time: 0.9356582164764404
Epoch: 2, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.831 Vali Acc: 0.717 Test Loss: 0.831 Test Acc: 0.717
Validation loss decreased (-0.456510 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 0.8873403072357178
Epoch: 3, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.717383 --> -0.833327).  Saving model ...
Epoch: 4 cost time: 1.0479533672332764
Epoch: 4, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 0.9636480808258057
Epoch: 5, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.061063528060913
Epoch: 6, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.637 Vali Acc: 0.790 Test Loss: 0.637 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9994962215423584
Epoch: 7, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0224847793579102
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.559 Vali Acc: 0.870 Test Loss: 0.559 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 1.0158958435058594
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.059666395187378
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2408623695373535
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0063750743865967
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0802600383758545
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0306642055511475
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9094350337982178
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8838605880737305
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9041063785552979
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9851565361022949
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 611104
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1374034881591797
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.132 Vali Acc: 0.529 Test Loss: 1.132 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 1.0252351760864258
Epoch: 2, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.779 Vali Acc: 0.768 Test Loss: 0.779 Test Acc: 0.768
Validation loss decreased (-0.528974 --> -0.768108).  Saving model ...
Epoch: 3 cost time: 0.9841198921203613
Epoch: 3, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
Validation loss decreased (-0.768108 --> -0.826081).  Saving model ...
Epoch: 4 cost time: 0.9802768230438232
Epoch: 4, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 0.8796706199645996
Epoch: 5, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1824383735656738
Epoch: 6, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.548 Vali Acc: 0.768 Test Loss: 0.548 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1238467693328857
Epoch: 7, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 8 cost time: 0.9466378688812256
Epoch: 8, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.480 Vali Acc: 0.855 Test Loss: 0.480 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0928115844726562
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.159843921661377
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9722681045532227
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0741052627563477
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9690256118774414
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0197312831878662
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9378635883331299
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0667469501495361
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.862 Test Loss: 0.530 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0370936393737793
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 611104
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.680290699005127
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.096 Vali Acc: 0.609 Test Loss: 1.096 Test Acc: 0.609
Validation loss decreased (inf --> -0.608685).  Saving model ...
Epoch: 2 cost time: 0.8389163017272949
Epoch: 2, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.728 Vali Acc: 0.812 Test Loss: 0.728 Test Acc: 0.812
Validation loss decreased (-0.608685 --> -0.811587).  Saving model ...
Epoch: 3 cost time: 0.8676156997680664
Epoch: 3, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818835).  Saving model ...
Epoch: 4 cost time: 0.8900580406188965
Epoch: 4, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 0.8924119472503662
Epoch: 5, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 1.0000882148742676
Epoch: 6, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0309758186340332
Epoch: 7, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9880695343017578
Epoch: 8, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.010685682296753
Epoch: 9, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9530024528503418
Epoch: 10, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8528308868408203
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 0.9917361736297607
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8931095600128174
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.944821834564209
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 0.8714938163757324
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9010584354400635
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9515211582183838
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9365818500518799
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9874229431152344
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.860023021697998
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9405593872070312
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9540698528289795
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9546117782592773
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.057755470275879
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 611104
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.961169958114624
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.206 Vali Acc: 0.471 Test Loss: 1.206 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 0.9296998977661133
Epoch: 2, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.858 Vali Acc: 0.703 Test Loss: 0.858 Test Acc: 0.703
Validation loss decreased (-0.471002 --> -0.702890).  Saving model ...
Epoch: 3 cost time: 0.9231686592102051
Epoch: 3, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.628 Vali Acc: 0.768 Test Loss: 0.628 Test Acc: 0.768
Validation loss decreased (-0.702890 --> -0.768110).  Saving model ...
Epoch: 4 cost time: 0.9281983375549316
Epoch: 4, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 0.974510669708252
Epoch: 5, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 0.9497768878936768
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.9399981498718262
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9413461685180664
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 0.9155287742614746
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.870 Test Loss: 0.568 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 0.9935297966003418
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0215728282928467
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9389853477478027
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.826 Test Loss: 0.595 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9578208923339844
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.005810260772705
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.826 Test Loss: 0.593 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0347363948822021
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.826 Test Loss: 0.592 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8797640800476074
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.826 Test Loss: 0.593 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.031322956085205
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8958086967468262
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.028855323791504
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 480032
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.812518835067749
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.182 Vali Acc: 0.493 Test Loss: 1.182 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 0.9580957889556885
Epoch: 2, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.832 Vali Acc: 0.732 Test Loss: 0.832 Test Acc: 0.732
Validation loss decreased (-0.492742 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 0.8467471599578857
Epoch: 3, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
Validation loss decreased (-0.731876 --> -0.775356).  Saving model ...
Epoch: 4 cost time: 0.9346466064453125
Epoch: 4, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 5 cost time: 0.9122765064239502
Epoch: 5, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 6 cost time: 0.8832597732543945
Epoch: 6, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 7 cost time: 1.011584997177124
Epoch: 7, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8964748382568359
Epoch: 8, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9099454879760742
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8208050727844238
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9215929508209229
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9179778099060059
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9554166793823242
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0385808944702148
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.848 Test Loss: 0.575 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0134921073913574
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.855 Test Loss: 0.575 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9103171825408936
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 480032
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9597387313842773
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.144 Vali Acc: 0.558 Test Loss: 1.144 Test Acc: 0.558
Validation loss decreased (inf --> -0.557960).  Saving model ...
Epoch: 2 cost time: 0.9511361122131348
Epoch: 2, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.770 Vali Acc: 0.783 Test Loss: 0.770 Test Acc: 0.783
Validation loss decreased (-0.557960 --> -0.782601).  Saving model ...
Epoch: 3 cost time: 0.9742915630340576
Epoch: 3, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.782601 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 0.9738521575927734
Epoch: 4, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 0.8949015140533447
Epoch: 5, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.474 Vali Acc: 0.797 Test Loss: 0.474 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9295437335968018
Epoch: 6, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 7 cost time: 0.8845341205596924
Epoch: 7, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.006734848022461
Epoch: 8, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.496 Vali Acc: 0.797 Test Loss: 0.496 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8641495704650879
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9313492774963379
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.932898998260498
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.877 Test Loss: 0.474 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 0.9552850723266602
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.958500862121582
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9192347526550293
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.886955976486206
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0630788803100586
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9509932994842529
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9045891761779785
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0418250560760498
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.870 Test Loss: 0.516 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9638166427612305
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9491446018218994
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 480032
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8020825386047363
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.101 Vali Acc: 0.558 Test Loss: 1.101 Test Acc: 0.558
Validation loss decreased (inf --> -0.557960).  Saving model ...
Epoch: 2 cost time: 0.8947832584381104
Epoch: 2, Steps: 9 | Train Loss: 0.834 Vali Loss: 0.717 Vali Acc: 0.790 Test Loss: 0.717 Test Acc: 0.790
Validation loss decreased (-0.557960 --> -0.789848).  Saving model ...
Epoch: 3 cost time: 0.8595876693725586
Epoch: 3, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826082).  Saving model ...
Epoch: 4 cost time: 0.9469616413116455
Epoch: 4, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 0.9154064655303955
Epoch: 5, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 0.9554610252380371
Epoch: 6, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8589158058166504
Epoch: 7, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8605916500091553
Epoch: 8, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.487 Vali Acc: 0.804 Test Loss: 0.487 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8407976627349854
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 0.9444658756256104
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 11 cost time: 0.8879587650299072
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 0.9398989677429199
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.862 Test Loss: 0.437 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8582680225372314
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9542980194091797
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8980343341827393
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9703400135040283
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0894808769226074
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.074758768081665
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9560918807983398
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0639660358428955
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0664892196655273
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 480032
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.906484842300415
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 1.0354161262512207
Epoch: 2, Steps: 9 | Train Loss: 0.828 Vali Loss: 0.838 Vali Acc: 0.688 Test Loss: 0.838 Test Acc: 0.688
Validation loss decreased (-0.514481 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 1.000641107559204
Epoch: 3, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.591 Vali Acc: 0.848 Test Loss: 0.591 Test Acc: 0.848
Validation loss decreased (-0.688397 --> -0.847820).  Saving model ...
Epoch: 4 cost time: 0.9124536514282227
Epoch: 4, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 1.032944679260254
Epoch: 5, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 6 cost time: 0.8622636795043945
Epoch: 6, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9787297248840332
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.797 Test Loss: 0.524 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.038135290145874
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8704268932342529
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9162442684173584
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8249740600585938
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0327870845794678
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9242763519287109
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9424488544464111
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0610442161560059
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 414496
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6937620639801025
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.138 Vali Acc: 0.551 Test Loss: 1.138 Test Acc: 0.551
Validation loss decreased (inf --> -0.550713).  Saving model ...
Epoch: 2 cost time: 0.9066448211669922
Epoch: 2, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
Validation loss decreased (-0.550713 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 0.9561910629272461
Epoch: 3, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
Validation loss decreased (-0.717383 --> -0.847820).  Saving model ...
Epoch: 4 cost time: 0.915508508682251
Epoch: 4, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8711845874786377
Epoch: 5, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 1.001856803894043
Epoch: 6, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 0.8964881896972656
Epoch: 7, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.909111499786377
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9160740375518799
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8290741443634033
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9528172016143799
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9761447906494141
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9655532836914062
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8845782279968262
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9523892402648926
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.848 Test Loss: 0.579 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8834860324859619
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.848 Test Loss: 0.581 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 414496
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1449131965637207
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.113 Vali Acc: 0.645 Test Loss: 1.113 Test Acc: 0.645
Validation loss decreased (inf --> -0.644916).  Saving model ...
Epoch: 2 cost time: 0.8954019546508789
Epoch: 2, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.778 Vali Acc: 0.725 Test Loss: 0.778 Test Acc: 0.725
Validation loss decreased (-0.644916 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 0.9041693210601807
Epoch: 3, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.541 Vali Acc: 0.848 Test Loss: 0.541 Test Acc: 0.848
Validation loss decreased (-0.724630 --> -0.847821).  Saving model ...
Epoch: 4 cost time: 0.8323318958282471
Epoch: 4, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 5 cost time: 0.9492027759552002
Epoch: 5, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.808788537979126
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 0.8294479846954346
Epoch: 7, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9786772727966309
Epoch: 8, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.484 Vali Acc: 0.819 Test Loss: 0.484 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.892432451248169
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8863699436187744
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8928267955780029
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1156058311462402
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9052839279174805
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9688868522644043
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8945231437683105
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.946681022644043
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 414496
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.005197525024414
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.087 Vali Acc: 0.623 Test Loss: 1.087 Test Acc: 0.623
Validation loss decreased (inf --> -0.623178).  Saving model ...
Epoch: 2 cost time: 0.9197671413421631
Epoch: 2, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.749 Vali Acc: 0.725 Test Loss: 0.749 Test Acc: 0.725
Validation loss decreased (-0.623178 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 0.8643922805786133
Epoch: 3, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
Validation loss decreased (-0.724630 --> -0.855067).  Saving model ...
Epoch: 4 cost time: 1.0837857723236084
Epoch: 4, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 5 cost time: 0.9888670444488525
Epoch: 5, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8966279029846191
Epoch: 6, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8790760040283203
Epoch: 7, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9437191486358643
Epoch: 8, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9388303756713867
Epoch: 9, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 10 cost time: 1.0235977172851562
Epoch: 10, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9304802417755127
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9639532566070557
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9673426151275635
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9480383396148682
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.019935131072998
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0360331535339355
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0028049945831299
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9418239593505859
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0068552494049072
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 414496
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1021106243133545
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (inf --> -0.572452).  Saving model ...
Epoch: 2 cost time: 1.0406825542449951
Epoch: 2, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.768 Vali Acc: 0.812 Test Loss: 0.768 Test Acc: 0.812
Validation loss decreased (-0.572452 --> -0.811587).  Saving model ...
Epoch: 3 cost time: 0.9195399284362793
Epoch: 3, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.570 Vali Acc: 0.855 Test Loss: 0.570 Test Acc: 0.855
Validation loss decreased (-0.811587 --> -0.855067).  Saving model ...
Epoch: 4 cost time: 0.9544587135314941
Epoch: 4, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0128107070922852
Epoch: 5, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9484236240386963
Epoch: 6, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 1.002528429031372
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0440647602081299
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.531 Vali Acc: 0.855 Test Loss: 0.531 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9490530490875244
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1191411018371582
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0652599334716797
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9859671592712402
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.848 Test Loss: 0.576 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0664129257202148
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9722363948822021
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9492757320404053
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.855 Test Loss: 0.582 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0344910621643066
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 381728
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8117268085479736
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.114 Vali Acc: 0.572 Test Loss: 1.114 Test Acc: 0.572
Validation loss decreased (inf --> -0.572453).  Saving model ...
Epoch: 2 cost time: 0.8956243991851807
Epoch: 2, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.747 Vali Acc: 0.841 Test Loss: 0.747 Test Acc: 0.841
Validation loss decreased (-0.572453 --> -0.840572).  Saving model ...
Epoch: 3 cost time: 0.935880184173584
Epoch: 3, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.548 Vali Acc: 0.855 Test Loss: 0.548 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855067).  Saving model ...
Epoch: 4 cost time: 0.9045326709747314
Epoch: 4, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 0.8770382404327393
Epoch: 5, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 0.895805835723877
Epoch: 6, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.466 Vali Acc: 0.884 Test Loss: 0.466 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884053).  Saving model ...
Epoch: 7 cost time: 1.0227141380310059
Epoch: 7, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8088028430938721
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9956040382385254
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8615543842315674
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.523 Vali Acc: 0.870 Test Loss: 0.523 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0191080570220947
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8874144554138184
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9992330074310303
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9687464237213135
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1492488384246826
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.862 Test Loss: 0.570 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9696962833404541
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 381728
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3627259731292725
Epoch: 1, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.094 Vali Acc: 0.623 Test Loss: 1.094 Test Acc: 0.623
Validation loss decreased (inf --> -0.623177).  Saving model ...
Epoch: 2 cost time: 0.9802427291870117
Epoch: 2, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.730 Vali Acc: 0.826 Test Loss: 0.730 Test Acc: 0.826
Validation loss decreased (-0.623177 --> -0.826080).  Saving model ...
Epoch: 3 cost time: 0.8280751705169678
Epoch: 3, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840574).  Saving model ...
Epoch: 4 cost time: 0.8212480545043945
Epoch: 4, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 0.8339214324951172
Epoch: 5, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9266481399536133
Epoch: 6, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 0.9191229343414307
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8054835796356201
Epoch: 8, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8898417949676514
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8828823566436768
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7777395248413086
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9062137603759766
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8438944816589355
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8294610977172852
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9208569526672363
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8802239894866943
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 381728
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8625879287719727
Epoch: 1, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.060 Vali Acc: 0.594 Test Loss: 1.060 Test Acc: 0.594
Validation loss decreased (inf --> -0.594192).  Saving model ...
Epoch: 2 cost time: 0.8746771812438965
Epoch: 2, Steps: 9 | Train Loss: 0.781 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
Validation loss decreased (-0.594192 --> -0.818833).  Saving model ...
Epoch: 3 cost time: 0.8475432395935059
Epoch: 3, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.507 Vali Acc: 0.862 Test Loss: 0.507 Test Acc: 0.862
Validation loss decreased (-0.818833 --> -0.862314).  Saving model ...
Epoch: 4 cost time: 0.8712785243988037
Epoch: 4, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8968544006347656
Epoch: 5, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9011693000793457
Epoch: 6, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8382949829101562
Epoch: 7, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8929827213287354
Epoch: 8, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8779017925262451
Epoch: 9, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9094157218933105
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8189043998718262
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 0.8916158676147461
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9319102764129639
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8974945545196533
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8966784477233887
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9754269123077393
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9591233730316162
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9486403465270996
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0230281352996826
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8984696865081787
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.860999584197998
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.862 Test Loss: 0.469 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 381728
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5585174560546875
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.261 Vali Acc: 0.449 Test Loss: 1.261 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 0.869696855545044
Epoch: 2, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.011 Vali Acc: 0.659 Test Loss: 1.011 Test Acc: 0.659
Validation loss decreased (-0.449263 --> -0.659410).  Saving model ...
Epoch: 3 cost time: 0.8551807403564453
Epoch: 3, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.836 Vali Acc: 0.754 Test Loss: 0.836 Test Acc: 0.754
Validation loss decreased (-0.659410 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 0.8891472816467285
Epoch: 4, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
Validation loss decreased (-0.753615 --> -0.811587).  Saving model ...
Epoch: 5 cost time: 0.8814246654510498
Epoch: 5, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.622 Vali Acc: 0.826 Test Loss: 0.622 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.8686902523040771
Epoch: 6, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840573).  Saving model ...
Epoch: 7 cost time: 0.8495290279388428
Epoch: 7, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9373359680175781
Epoch: 8, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8586559295654297
Epoch: 9, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9600486755371094
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9147553443908691
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7978148460388184
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9469130039215088
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9354884624481201
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9362733364105225
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.812 Test Loss: 0.668 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9869441986083984
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9184398651123047
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.01902437210083
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.833 Test Loss: 0.653 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 666016
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5629124641418457
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.249 Vali Acc: 0.457 Test Loss: 1.249 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 0.8640148639678955
Epoch: 2, Steps: 9 | Train Loss: 1.107 Vali Loss: 0.991 Vali Acc: 0.696 Test Loss: 0.991 Test Acc: 0.696
Validation loss decreased (-0.456509 --> -0.695642).  Saving model ...
Epoch: 3 cost time: 0.7655150890350342
Epoch: 3, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.813 Vali Acc: 0.790 Test Loss: 0.813 Test Acc: 0.790
Validation loss decreased (-0.695642 --> -0.789847).  Saving model ...
Epoch: 4 cost time: 0.7626638412475586
Epoch: 4, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 0.7551913261413574
Epoch: 5, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.7819647789001465
Epoch: 6, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8244926929473877
Epoch: 7, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8078529834747314
Epoch: 8, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.8461990356445312
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9059228897094727
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8544042110443115
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9173436164855957
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9073760509490967
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9602863788604736
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0120420455932617
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.812 Test Loss: 0.640 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8488485813140869
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9308407306671143
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.626 Vali Acc: 0.812 Test Loss: 0.626 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8965375423431396
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 666016
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0498695373535156
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.224 Vali Acc: 0.543 Test Loss: 1.224 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 0.9167447090148926
Epoch: 2, Steps: 9 | Train Loss: 1.079 Vali Loss: 0.952 Vali Acc: 0.746 Test Loss: 0.952 Test Acc: 0.746
Validation loss decreased (-0.543466 --> -0.746367).  Saving model ...
Epoch: 3 cost time: 0.9981045722961426
Epoch: 3, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
Validation loss decreased (-0.746367 --> -0.818833).  Saving model ...
Epoch: 4 cost time: 0.9682796001434326
Epoch: 4, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826081).  Saving model ...
Epoch: 5 cost time: 0.9441089630126953
Epoch: 5, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 6 cost time: 0.9104011058807373
Epoch: 6, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 7 cost time: 0.836512565612793
Epoch: 7, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.524 Vali Acc: 0.797 Test Loss: 0.524 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8949570655822754
Epoch: 8, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.8753013610839844
Epoch: 9, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9357869625091553
Epoch: 10, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9190330505371094
Epoch: 11, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9451510906219482
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8704631328582764
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8710753917694092
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9762692451477051
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9313874244689941
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8768758773803711
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0387980937957764
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.855 Test Loss: 0.549 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 666016
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.979639768600464
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.224 Vali Acc: 0.594 Test Loss: 1.224 Test Acc: 0.594
Validation loss decreased (inf --> -0.594191).  Saving model ...
Epoch: 2 cost time: 0.9794981479644775
Epoch: 2, Steps: 9 | Train Loss: 1.049 Vali Loss: 0.937 Vali Acc: 0.681 Test Loss: 0.937 Test Acc: 0.681
Validation loss decreased (-0.594191 --> -0.681150).  Saving model ...
Epoch: 3 cost time: 0.9171316623687744
Epoch: 3, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.751 Vali Acc: 0.826 Test Loss: 0.751 Test Acc: 0.826
Validation loss decreased (-0.681150 --> -0.826079).  Saving model ...
Epoch: 4 cost time: 0.8492598533630371
Epoch: 4, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.645 Vali Acc: 0.804 Test Loss: 0.645 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.011993169784546
Epoch: 5, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9703488349914551
Epoch: 6, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 1.014286994934082
Epoch: 7, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840575).  Saving model ...
Epoch: 8 cost time: 1.0525097846984863
Epoch: 8, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.059269666671753
Epoch: 9, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0084269046783447
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8648173809051514
Epoch: 11, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.886002779006958
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9309544563293457
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8651683330535889
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8194928169250488
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9300487041473389
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9056599140167236
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 666016
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9402730464935303
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.314 Vali Acc: 0.391 Test Loss: 1.314 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.0108232498168945
Epoch: 2, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.041 Vali Acc: 0.609 Test Loss: 1.041 Test Acc: 0.609
Validation loss decreased (-0.391291 --> -0.608685).  Saving model ...
Epoch: 3 cost time: 0.8882060050964355
Epoch: 3, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.862 Vali Acc: 0.732 Test Loss: 0.862 Test Acc: 0.732
Validation loss decreased (-0.608685 --> -0.731875).  Saving model ...
Epoch: 4 cost time: 0.852463960647583
Epoch: 4, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.731875 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 0.9335007667541504
Epoch: 5, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804342).  Saving model ...
Epoch: 6 cost time: 0.910897970199585
Epoch: 6, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 0.8959450721740723
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 0.957125186920166
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9646875858306885
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8644359111785889
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0392687320709229
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0936176776885986
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8637039661407471
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9965925216674805
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0470881462097168
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9872255325317383
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.946244478225708
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 403872
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.591017723083496
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.295 Vali Acc: 0.435 Test Loss: 1.295 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.8196957111358643
Epoch: 2, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.015 Vali Acc: 0.652 Test Loss: 1.015 Test Acc: 0.652
Validation loss decreased (-0.434770 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 0.8478124141693115
Epoch: 3, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.832 Vali Acc: 0.761 Test Loss: 0.832 Test Acc: 0.761
Validation loss decreased (-0.652164 --> -0.760861).  Saving model ...
Epoch: 4 cost time: 0.7993617057800293
Epoch: 4, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.691 Vali Acc: 0.790 Test Loss: 0.691 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 0.8381638526916504
Epoch: 5, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.7911739349365234
Epoch: 6, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8756332397460938
Epoch: 7, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 0.8423309326171875
Epoch: 8, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.566 Vali Acc: 0.804 Test Loss: 0.566 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7984268665313721
Epoch: 9, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8827433586120605
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8079876899719238
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0102729797363281
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0829071998596191
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8976826667785645
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9815499782562256
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.812 Test Loss: 0.611 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9998664855957031
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8900737762451172
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.826 Test Loss: 0.620 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 403872
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7812023162841797
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.280 Vali Acc: 0.457 Test Loss: 1.280 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 0.7655375003814697
Epoch: 2, Steps: 9 | Train Loss: 1.074 Vali Loss: 0.981 Vali Acc: 0.710 Test Loss: 0.981 Test Acc: 0.710
Validation loss decreased (-0.456509 --> -0.710135).  Saving model ...
Epoch: 3 cost time: 0.783332109451294
Epoch: 3, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.802 Vali Acc: 0.746 Test Loss: 0.802 Test Acc: 0.746
Validation loss decreased (-0.710135 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 0.8149392604827881
Epoch: 4, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
Validation loss decreased (-0.746369 --> -0.826080).  Saving model ...
Epoch: 5 cost time: 0.8236322402954102
Epoch: 5, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8036715984344482
Epoch: 6, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8281800746917725
Epoch: 7, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0093472003936768
Epoch: 8, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.9461727142333984
Epoch: 9, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9232208728790283
Epoch: 10, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 0.8478002548217773
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8395447731018066
Epoch: 12, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.8344013690948486
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8368878364562988
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7910876274108887
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7581753730773926
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9145736694335938
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9117190837860107
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8802595138549805
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9241433143615723
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8741414546966553
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9227569103240967
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 403872
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5359718799591064
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
Validation loss decreased (inf --> -0.514480).  Saving model ...
Epoch: 2 cost time: 0.9321756362915039
Epoch: 2, Steps: 9 | Train Loss: 1.039 Vali Loss: 0.945 Vali Acc: 0.688 Test Loss: 0.945 Test Acc: 0.688
Validation loss decreased (-0.514480 --> -0.688396).  Saving model ...
Epoch: 3 cost time: 0.8523790836334229
Epoch: 3, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.688396 --> -0.782601).  Saving model ...
Epoch: 4 cost time: 0.892266035079956
Epoch: 4, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.9368679523468018
Epoch: 5, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 0.9148695468902588
Epoch: 6, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.8441002368927002
Epoch: 7, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8574373722076416
Epoch: 8, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.8825283050537109
Epoch: 9, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7860565185546875
Epoch: 10, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8763365745544434
Epoch: 11, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7965645790100098
Epoch: 12, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7873084545135498
Epoch: 13, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.832242488861084
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9001102447509766
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8092911243438721
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9128844738006592
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9436943531036377
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 403872
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.882859945297241
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.245 Vali Acc: 0.435 Test Loss: 1.245 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.9891197681427002
Epoch: 2, Steps: 9 | Train Loss: 1.066 Vali Loss: 0.998 Vali Acc: 0.703 Test Loss: 0.998 Test Acc: 0.703
Validation loss decreased (-0.434770 --> -0.702889).  Saving model ...
Epoch: 3 cost time: 0.894554615020752
Epoch: 3, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.824 Vali Acc: 0.768 Test Loss: 0.824 Test Acc: 0.768
Validation loss decreased (-0.702889 --> -0.768108).  Saving model ...
Epoch: 4 cost time: 0.9426779747009277
Epoch: 4, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.674 Vali Acc: 0.797 Test Loss: 0.674 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 0.8611609935760498
Epoch: 5, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.8741507530212402
Epoch: 6, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.9161427021026611
Epoch: 7, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9085118770599365
Epoch: 8, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8535428047180176
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8774781227111816
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9427828788757324
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9184346199035645
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.579 Vali Acc: 0.826 Test Loss: 0.579 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0114779472351074
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8207087516784668
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8363051414489746
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8836941719055176
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 272800
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.629023790359497
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.244 Vali Acc: 0.457 Test Loss: 1.244 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 0.9756286144256592
Epoch: 2, Steps: 9 | Train Loss: 1.063 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.456509 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 0.8432168960571289
Epoch: 3, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.812 Vali Acc: 0.754 Test Loss: 0.812 Test Acc: 0.754
Validation loss decreased (-0.666657 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 0.9410712718963623
Epoch: 4, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
Validation loss decreased (-0.753615 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.8354077339172363
Epoch: 5, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.9449305534362793
Epoch: 6, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.998253583908081
Epoch: 7, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9706172943115234
Epoch: 8, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.543 Vali Acc: 0.804 Test Loss: 0.543 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9537203311920166
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.928736686706543
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.944831371307373
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9739363193511963
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9599881172180176
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9365701675415039
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.594 Vali Acc: 0.804 Test Loss: 0.594 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9371910095214844
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.901024341583252
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.587 Vali Acc: 0.797 Test Loss: 0.587 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 272800
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.984614133834839
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.233 Vali Acc: 0.507 Test Loss: 1.233 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 0.9680740833282471
Epoch: 2, Steps: 9 | Train Loss: 1.041 Vali Loss: 0.963 Vali Acc: 0.674 Test Loss: 0.963 Test Acc: 0.674
Validation loss decreased (-0.507234 --> -0.673903).  Saving model ...
Epoch: 3 cost time: 0.8838512897491455
Epoch: 3, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.673903 --> -0.775354).  Saving model ...
Epoch: 4 cost time: 0.964622974395752
Epoch: 4, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.775354 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 0.9849622249603271
Epoch: 5, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 0.8206806182861328
Epoch: 6, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.525 Vali Acc: 0.797 Test Loss: 0.525 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9065675735473633
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840575).  Saving model ...
Epoch: 8 cost time: 0.8013975620269775
Epoch: 8, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8571743965148926
Epoch: 9, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7986173629760742
Epoch: 10, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.508 Vali Acc: 0.797 Test Loss: 0.508 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7292165756225586
Epoch: 11, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9386966228485107
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8298299312591553
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.504 Vali Acc: 0.812 Test Loss: 0.504 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9802188873291016
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7918062210083008
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7959725856781006
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8386449813842773
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 272800
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.735382556915283
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.183 Vali Acc: 0.601 Test Loss: 1.183 Test Acc: 0.601
Validation loss decreased (inf --> -0.601437).  Saving model ...
Epoch: 2 cost time: 0.8680903911590576
Epoch: 2, Steps: 9 | Train Loss: 1.035 Vali Loss: 0.908 Vali Acc: 0.681 Test Loss: 0.908 Test Acc: 0.681
Validation loss decreased (-0.601437 --> -0.681150).  Saving model ...
Epoch: 3 cost time: 0.8807768821716309
Epoch: 3, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
Validation loss decreased (-0.681150 --> -0.811587).  Saving model ...
Epoch: 4 cost time: 0.8498430252075195
Epoch: 4, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.856757402420044
Epoch: 5, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7644081115722656
Epoch: 6, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855067).  Saving model ...
Epoch: 7 cost time: 0.7914912700653076
Epoch: 7, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7152931690216064
Epoch: 8, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6888482570648193
Epoch: 9, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.780897855758667
Epoch: 10, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 0.8295407295227051
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8001341819763184
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7927758693695068
Epoch: 13, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7683725357055664
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7936098575592041
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7983267307281494
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8888936042785645
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7852654457092285
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7935843467712402
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.900277853012085
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 272800
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0601863861083984
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.275 Vali Acc: 0.428 Test Loss: 1.275 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 0.9898247718811035
Epoch: 2, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.007 Vali Acc: 0.630 Test Loss: 1.007 Test Acc: 0.630
Validation loss decreased (-0.427523 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 0.8582901954650879
Epoch: 3, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.822 Vali Acc: 0.732 Test Loss: 0.822 Test Acc: 0.732
Validation loss decreased (-0.630425 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 0.9316580295562744
Epoch: 4, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
Validation loss decreased (-0.731876 --> -0.797094).  Saving model ...
Epoch: 5 cost time: 0.8030796051025391
Epoch: 5, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.632 Vali Acc: 0.790 Test Loss: 0.632 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8881776332855225
Epoch: 6, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 0.8880794048309326
Epoch: 7, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9898076057434082
Epoch: 8, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8482880592346191
Epoch: 9, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.573 Vali Acc: 0.804 Test Loss: 0.573 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8753395080566406
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9002513885498047
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.622 Vali Acc: 0.826 Test Loss: 0.622 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8937828540802002
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8939518928527832
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.604 Vali Acc: 0.790 Test Loss: 0.604 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8540840148925781
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.635 Vali Acc: 0.812 Test Loss: 0.635 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8849236965179443
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8894193172454834
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7627105712890625
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9102351665496826
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 207264
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.734781265258789
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.271 Vali Acc: 0.420 Test Loss: 1.271 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.8996484279632568
Epoch: 2, Steps: 9 | Train Loss: 1.095 Vali Loss: 0.998 Vali Acc: 0.638 Test Loss: 0.998 Test Acc: 0.638
Validation loss decreased (-0.420277 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 0.8632595539093018
Epoch: 3, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.810 Vali Acc: 0.754 Test Loss: 0.810 Test Acc: 0.754
Validation loss decreased (-0.637671 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 0.9338834285736084
Epoch: 4, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
Validation loss decreased (-0.753615 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.8941636085510254
Epoch: 5, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 6 cost time: 0.8587076663970947
Epoch: 6, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.597 Vali Acc: 0.804 Test Loss: 0.597 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8375382423400879
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8377504348754883
Epoch: 8, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 0.835237979888916
Epoch: 9, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.566 Vali Acc: 0.804 Test Loss: 0.566 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8565106391906738
Epoch: 10, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.551 Vali Acc: 0.804 Test Loss: 0.551 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8568077087402344
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 0.8759396076202393
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8966622352600098
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.804 Test Loss: 0.582 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9661321640014648
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9330704212188721
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7807772159576416
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8399679660797119
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.797 Test Loss: 0.618 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9795372486114502
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9685955047607422
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9660732746124268
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.790 Test Loss: 0.637 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9283697605133057
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 207264
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6813220977783203
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 0.8284542560577393
Epoch: 2, Steps: 9 | Train Loss: 1.078 Vali Loss: 0.966 Vali Acc: 0.674 Test Loss: 0.966 Test Acc: 0.674
Validation loss decreased (-0.485495 --> -0.673903).  Saving model ...
Epoch: 3 cost time: 0.7847297191619873
Epoch: 3, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
Validation loss decreased (-0.673903 --> -0.782601).  Saving model ...
Epoch: 4 cost time: 0.8809263706207275
Epoch: 4, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
Validation loss decreased (-0.782601 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 0.827324390411377
Epoch: 5, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.970477819442749
Epoch: 6, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.8099851608276367
Epoch: 7, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8545963764190674
Epoch: 8, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8803350925445557
Epoch: 9, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8396275043487549
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.00069260597229
Epoch: 11, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8814425468444824
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8547072410583496
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7580180168151855
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7607851028442383
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7426471710205078
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7340614795684814
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8106546401977539
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.848 Test Loss: 0.549 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 0.9764721393585205
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8565371036529541
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.835289716720581
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.848 Test Loss: 0.569 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8407847881317139
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8385918140411377
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9871184825897217
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8423395156860352
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.868882417678833
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 27 cost time: 0.8738193511962891
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9182746410369873
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.848 Test Loss: 0.578 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8620390892028809
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0823416709899902
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.848 Test Loss: 0.582 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9757692813873291
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9509215354919434
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9006819725036621
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9529376029968262
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8980648517608643
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8805451393127441
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 207264
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1093082427978516
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.219 Vali Acc: 0.536 Test Loss: 1.219 Test Acc: 0.536
Validation loss decreased (inf --> -0.536220).  Saving model ...
Epoch: 2 cost time: 0.9097018241882324
Epoch: 2, Steps: 9 | Train Loss: 1.035 Vali Loss: 0.941 Vali Acc: 0.652 Test Loss: 0.941 Test Acc: 0.652
Validation loss decreased (-0.536220 --> -0.652165).  Saving model ...
Epoch: 3 cost time: 0.9014472961425781
Epoch: 3, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.747 Vali Acc: 0.797 Test Loss: 0.747 Test Acc: 0.797
Validation loss decreased (-0.652165 --> -0.797094).  Saving model ...
Epoch: 4 cost time: 1.1803719997406006
Epoch: 4, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 0.93778395652771
Epoch: 5, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 6 cost time: 1.0716207027435303
Epoch: 6, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.9823629856109619
Epoch: 7, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8708157539367676
Epoch: 8, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8445513248443604
Epoch: 9, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.513 Vali Acc: 0.804 Test Loss: 0.513 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.864743709564209
Epoch: 10, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8981444835662842
Epoch: 11, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9525461196899414
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 0.8297059535980225
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8373231887817383
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8106973171234131
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8371164798736572
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8236932754516602
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.803861141204834
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0457794666290283
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 20 cost time: 0.8577711582183838
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8511447906494141
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8562233448028564
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8464951515197754
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0433168411254883
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9909489154815674
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.915501594543457
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8610780239105225
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9830410480499268
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8857676982879639
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 207264
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9215989112854004
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.275 Vali Acc: 0.464 Test Loss: 1.275 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 0.930309534072876
Epoch: 2, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.021 Vali Acc: 0.652 Test Loss: 1.021 Test Acc: 0.652
Validation loss decreased (-0.463755 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 0.8886585235595703
Epoch: 3, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.832 Vali Acc: 0.739 Test Loss: 0.832 Test Acc: 0.739
Validation loss decreased (-0.652164 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 0.9099514484405518
Epoch: 4, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.739122 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 0.9147155284881592
Epoch: 5, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9044411182403564
Epoch: 6, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.642 Vali Acc: 0.804 Test Loss: 0.642 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 0.8784925937652588
Epoch: 7, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 0.8238077163696289
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.617 Vali Acc: 0.797 Test Loss: 0.617 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9095091819763184
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 0.9251387119293213
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8535325527191162
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8195273876190186
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.624 Vali Acc: 0.812 Test Loss: 0.624 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8903391361236572
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.826 Test Loss: 0.620 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 0.9173970222473145
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8989167213439941
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7862038612365723
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8434669971466064
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.867431640625
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.674 Vali Acc: 0.797 Test Loss: 0.674 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8855381011962891
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8469645977020264
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8844785690307617
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.804 Test Loss: 0.682 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.823721170425415
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8908798694610596
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.790 Test Loss: 0.687 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 174496
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9042530059814453
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.273 Vali Acc: 0.442 Test Loss: 1.273 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.9186067581176758
Epoch: 2, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.009 Vali Acc: 0.638 Test Loss: 1.009 Test Acc: 0.638
Validation loss decreased (-0.442016 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 0.9333593845367432
Epoch: 3, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
Validation loss decreased (-0.637671 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 0.8981871604919434
Epoch: 4, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
Validation loss decreased (-0.739122 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 0.9311652183532715
Epoch: 5, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.646 Vali Acc: 0.775 Test Loss: 0.646 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8994693756103516
Epoch: 6, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.619 Vali Acc: 0.826 Test Loss: 0.619 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8940105438232422
Epoch: 7, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.561 Vali Acc: 0.826 Test Loss: 0.561 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 0.8790674209594727
Epoch: 8, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.993912935256958
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8919446468353271
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9763593673706055
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9327030181884766
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8216569423675537
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7877707481384277
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7981398105621338
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8591704368591309
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7461163997650146
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.804 Test Loss: 0.633 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 174496
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.784482479095459
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 0.8548405170440674
Epoch: 2, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.970 Vali Acc: 0.652 Test Loss: 0.970 Test Acc: 0.652
Validation loss decreased (-0.499988 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 0.8748164176940918
Epoch: 3, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.782 Vali Acc: 0.746 Test Loss: 0.782 Test Acc: 0.746
Validation loss decreased (-0.652164 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 0.8985631465911865
Epoch: 4, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.673 Vali Acc: 0.797 Test Loss: 0.673 Test Acc: 0.797
Validation loss decreased (-0.746369 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 0.9299490451812744
Epoch: 5, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.611 Vali Acc: 0.790 Test Loss: 0.611 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9783706665039062
Epoch: 6, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.587 Vali Acc: 0.797 Test Loss: 0.587 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 1.070251703262329
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 0.9182112216949463
Epoch: 8, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.551 Vali Acc: 0.790 Test Loss: 0.551 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7945308685302734
Epoch: 9, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.538 Vali Acc: 0.804 Test Loss: 0.538 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8492035865783691
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 0.9547438621520996
Epoch: 11, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.911013126373291
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8990163803100586
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8861179351806641
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 0.9599771499633789
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 0.8990380764007568
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 17 cost time: 0.9303758144378662
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7876684665679932
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9358208179473877
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8185548782348633
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8828275203704834
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9236831665039062
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8291656970977783
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9291870594024658
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9672551155090332
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.813377857208252
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.804 Test Loss: 0.586 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 174496
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6636877059936523
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.219 Vali Acc: 0.558 Test Loss: 1.219 Test Acc: 0.558
Validation loss decreased (inf --> -0.557959).  Saving model ...
Epoch: 2 cost time: 0.7719659805297852
Epoch: 2, Steps: 9 | Train Loss: 1.006 Vali Loss: 0.942 Vali Acc: 0.674 Test Loss: 0.942 Test Acc: 0.674
Validation loss decreased (-0.557959 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 0.8034510612487793
Epoch: 3, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.673904 --> -0.760862).  Saving model ...
Epoch: 4 cost time: 0.8374886512756348
Epoch: 4, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 0.7853255271911621
Epoch: 5, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.596 Vali Acc: 0.797 Test Loss: 0.596 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 6 cost time: 0.8366250991821289
Epoch: 6, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 0.8578712940216064
Epoch: 7, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 0.7399618625640869
Epoch: 8, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7901284694671631
Epoch: 9, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8061800003051758
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 0.8695380687713623
Epoch: 11, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.790 Test Loss: 0.544 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8558588027954102
Epoch: 12, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.540 Vali Acc: 0.797 Test Loss: 0.540 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8313190937042236
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8665473461151123
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.800562858581543
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8392975330352783
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.826 Test Loss: 0.555 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7663302421569824
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 0.8722274303436279
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.848 Test Loss: 0.542 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8540356159210205
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8491823673248291
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7955977916717529
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8302721977233887
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7967734336853027
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9324452877044678
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9064934253692627
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8959946632385254
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9614231586456299
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 174496
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4536449909210205
Epoch: 1, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.261 Vali Acc: 0.428 Test Loss: 1.261 Test Acc: 0.428
Validation loss decreased (inf --> -0.427524).  Saving model ...
Epoch: 2 cost time: 0.7677686214447021
Epoch: 2, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.010 Vali Acc: 0.623 Test Loss: 1.010 Test Acc: 0.623
Validation loss decreased (-0.427524 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 0.8291678428649902
Epoch: 3, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.836 Vali Acc: 0.725 Test Loss: 0.836 Test Acc: 0.725
Validation loss decreased (-0.623178 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 0.7889635562896729
Epoch: 4, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.682 Vali Acc: 0.790 Test Loss: 0.682 Test Acc: 0.790
Validation loss decreased (-0.724629 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 0.8107225894927979
Epoch: 5, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.661 Vali Acc: 0.739 Test Loss: 0.661 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7823688983917236
Epoch: 6, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 0.772150993347168
Epoch: 7, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.614 Vali Acc: 0.797 Test Loss: 0.614 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7544980049133301
Epoch: 8, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 0.8801760673522949
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.583 Vali Acc: 0.848 Test Loss: 0.583 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847820).  Saving model ...
Epoch: 10 cost time: 0.8377101421356201
Epoch: 10, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.804 Test Loss: 0.593 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8600385189056396
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8021049499511719
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8769218921661377
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8798084259033203
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8270096778869629
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.832648515701294
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.804 Test Loss: 0.595 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8014476299285889
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.812 Test Loss: 0.618 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8200070858001709
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8207910060882568
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 158112
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6621153354644775
Epoch: 1, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 0.7610697746276855
Epoch: 2, Steps: 9 | Train Loss: 1.053 Vali Loss: 0.997 Vali Acc: 0.645 Test Loss: 0.997 Test Acc: 0.645
Validation loss decreased (-0.485495 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 0.78702712059021
Epoch: 3, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.824 Vali Acc: 0.696 Test Loss: 0.824 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695644).  Saving model ...
Epoch: 4 cost time: 0.8991057872772217
Epoch: 4, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.695644 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 0.9032304286956787
Epoch: 5, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782602).  Saving model ...
Epoch: 6 cost time: 0.7937562465667725
Epoch: 6, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 0.8664865493774414
Epoch: 7, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.593 Vali Acc: 0.797 Test Loss: 0.593 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7865614891052246
Epoch: 8, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8233201503753662
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9154465198516846
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8136007785797119
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 0.9215493202209473
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 0.8744206428527832
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8364944458007812
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7380654811859131
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8953759670257568
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8682594299316406
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9565351009368896
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.826 Test Loss: 0.634 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0177931785583496
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8983078002929688
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0027616024017334
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.641 Vali Acc: 0.826 Test Loss: 0.641 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0360491275787354
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 158112
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.862579822540283
Epoch: 1, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.235 Vali Acc: 0.522 Test Loss: 1.235 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 0.8780231475830078
Epoch: 2, Steps: 9 | Train Loss: 1.020 Vali Loss: 0.967 Vali Acc: 0.652 Test Loss: 0.967 Test Acc: 0.652
Validation loss decreased (-0.521727 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 0.8379561901092529
Epoch: 3, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.795 Vali Acc: 0.739 Test Loss: 0.795 Test Acc: 0.739
Validation loss decreased (-0.652164 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 0.8316185474395752
Epoch: 4, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
Validation loss decreased (-0.739122 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 0.9238581657409668
Epoch: 5, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8449726104736328
Epoch: 6, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.8868510723114014
Epoch: 7, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.8290526866912842
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8443284034729004
Epoch: 9, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.8040401935577393
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8375837802886963
Epoch: 11, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 0.9678466320037842
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8642024993896484
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0395550727844238
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0114693641662598
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.848 Test Loss: 0.559 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9638381004333496
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9915213584899902
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9000670909881592
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.862 Test Loss: 0.575 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 0.8497998714447021
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7874019145965576
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.848 Test Loss: 0.550 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8771255016326904
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8774793148040771
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8741040229797363
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8503668308258057
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8570995330810547
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.848 Test Loss: 0.570 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9056992530822754
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.855 Test Loss: 0.591 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.868732213973999
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9133355617523193
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 158112
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4487528800964355
Epoch: 1, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.201 Vali Acc: 0.558 Test Loss: 1.201 Test Acc: 0.558
Validation loss decreased (inf --> -0.557959).  Saving model ...
Epoch: 2 cost time: 0.7868754863739014
Epoch: 2, Steps: 9 | Train Loss: 1.024 Vali Loss: 0.939 Vali Acc: 0.645 Test Loss: 0.939 Test Acc: 0.645
Validation loss decreased (-0.557959 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 0.7765302658081055
Epoch: 3, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
Validation loss decreased (-0.644918 --> -0.775355).  Saving model ...
Epoch: 4 cost time: 0.7499117851257324
Epoch: 4, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.637 Vali Acc: 0.804 Test Loss: 0.637 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 0.7554013729095459
Epoch: 5, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9072189331054688
Epoch: 6, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 0.7913210391998291
Epoch: 7, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.8256499767303467
Epoch: 8, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8642075061798096
Epoch: 9, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.7631428241729736
Epoch: 10, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8866438865661621
Epoch: 11, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7511873245239258
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.8358354568481445
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8251552581787109
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.754746675491333
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7618758678436279
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8451714515686035
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 0.9023938179016113
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8342044353485107
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9159348011016846
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8467340469360352
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7515890598297119
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8712832927703857
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.848 Test Loss: 0.551 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.883378267288208
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7992956638336182
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.808910608291626
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8396778106689453
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 158112
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.72407603263855
Epoch: 1, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.312 Vali Acc: 0.413 Test Loss: 1.312 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.8477544784545898
Epoch: 2, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.153 Vali Acc: 0.486 Test Loss: 1.153 Test Acc: 0.486
Validation loss decreased (-0.413030 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 0.8326737880706787
Epoch: 3, Steps: 9 | Train Loss: 0.880 Vali Loss: 1.002 Vali Acc: 0.623 Test Loss: 1.002 Test Acc: 0.623
Validation loss decreased (-0.485496 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.8029987812042236
Epoch: 4, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.878 Vali Acc: 0.696 Test Loss: 0.878 Test Acc: 0.696
Validation loss decreased (-0.623178 --> -0.695643).  Saving model ...
Epoch: 5 cost time: 0.7461299896240234
Epoch: 5, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.783 Vali Acc: 0.717 Test Loss: 0.783 Test Acc: 0.717
Validation loss decreased (-0.695643 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 0.7123310565948486
Epoch: 6, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.677 Vali Acc: 0.812 Test Loss: 0.677 Test Acc: 0.812
Validation loss decreased (-0.717383 --> -0.811587).  Saving model ...
Epoch: 7 cost time: 0.7366893291473389
Epoch: 7, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7644562721252441
Epoch: 8, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 0.7478115558624268
Epoch: 9, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 0.8656919002532959
Epoch: 10, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 0.8639814853668213
Epoch: 11, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 0.8508925437927246
Epoch: 12, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.8634195327758789
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8261544704437256
Epoch: 14, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7747325897216797
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8477506637573242
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8354783058166504
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.810643196105957
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7904155254364014
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7919502258300781
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7920677661895752
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.75406813621521
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 324832
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.801910877227783
Epoch: 1, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.302 Vali Acc: 0.399 Test Loss: 1.302 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 0.8663535118103027
Epoch: 2, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.139 Vali Acc: 0.529 Test Loss: 1.139 Test Acc: 0.529
Validation loss decreased (-0.398538 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 0.8573310375213623
Epoch: 3, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.983 Vali Acc: 0.616 Test Loss: 0.983 Test Acc: 0.616
Validation loss decreased (-0.528974 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 0.8160676956176758
Epoch: 4, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.862 Vali Acc: 0.681 Test Loss: 0.862 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 0.8126809597015381
Epoch: 5, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
Validation loss decreased (-0.681151 --> -0.746369).  Saving model ...
Epoch: 6 cost time: 0.8337831497192383
Epoch: 6, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.656 Vali Acc: 0.804 Test Loss: 0.656 Test Acc: 0.804
Validation loss decreased (-0.746369 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 0.8099169731140137
Epoch: 7, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9160411357879639
Epoch: 8, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 0.928072452545166
Epoch: 9, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.797041654586792
Epoch: 10, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9038381576538086
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 0.8207950592041016
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.519 Vali Acc: 0.833 Test Loss: 0.519 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 0.8725283145904541
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 0.836766242980957
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8303055763244629
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8901646137237549
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8357126712799072
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8357641696929932
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7899577617645264
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8566474914550781
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8712599277496338
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8634841442108154
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8726954460144043
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 324832
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6358230113983154
Epoch: 1, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.265 Vali Acc: 0.442 Test Loss: 1.265 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.8128056526184082
Epoch: 2, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.089 Vali Acc: 0.616 Test Loss: 1.089 Test Acc: 0.616
Validation loss decreased (-0.442016 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 0.7305407524108887
Epoch: 3, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.932 Vali Acc: 0.710 Test Loss: 0.932 Test Acc: 0.710
Validation loss decreased (-0.615931 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 0.8608272075653076
Epoch: 4, Steps: 9 | Train Loss: 0.644 Vali Loss: 0.806 Vali Acc: 0.797 Test Loss: 0.806 Test Acc: 0.797
Validation loss decreased (-0.710136 --> -0.797093).  Saving model ...
Epoch: 5 cost time: 0.836688756942749
Epoch: 5, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7911396026611328
Epoch: 6, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.613 Vali Acc: 0.826 Test Loss: 0.613 Test Acc: 0.826
Validation loss decreased (-0.797093 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8421926498413086
Epoch: 7, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.579 Vali Acc: 0.804 Test Loss: 0.579 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8039388656616211
Epoch: 8, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8972234725952148
Epoch: 9, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 0.76265549659729
Epoch: 10, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.860008955001831
Epoch: 11, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9333412647247314
Epoch: 12, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7746973037719727
Epoch: 13, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.870258092880249
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.840853214263916
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8584530353546143
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0452044010162354
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8517513275146484
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8762645721435547
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 324832
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.579929828643799
Epoch: 1, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.228 Vali Acc: 0.587 Test Loss: 1.228 Test Acc: 0.587
Validation loss decreased (inf --> -0.586944).  Saving model ...
Epoch: 2 cost time: 0.8094656467437744
Epoch: 2, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.046 Vali Acc: 0.645 Test Loss: 1.046 Test Acc: 0.645
Validation loss decreased (-0.586944 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 0.9050731658935547
Epoch: 3, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.889 Vali Acc: 0.703 Test Loss: 0.889 Test Acc: 0.703
Validation loss decreased (-0.644917 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 0.8402466773986816
Epoch: 4, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.766 Vali Acc: 0.797 Test Loss: 0.766 Test Acc: 0.797
Validation loss decreased (-0.702890 --> -0.797094).  Saving model ...
Epoch: 5 cost time: 0.842604398727417
Epoch: 5, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.675 Vali Acc: 0.790 Test Loss: 0.675 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8591220378875732
Epoch: 6, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
Validation loss decreased (-0.797094 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.9330179691314697
Epoch: 7, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.9235134124755859
Epoch: 8, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 0.8517274856567383
Epoch: 9, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 0.84383225440979
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9603629112243652
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8641617298126221
Epoch: 12, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8857591152191162
Epoch: 13, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 0.8888928890228271
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.797518253326416
Epoch: 15, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9232673645019531
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 0.9472525119781494
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 0.85251784324646
Epoch: 18, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8058464527130127
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.877422571182251
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7947819232940674
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7376065254211426
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7396912574768066
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6671299934387207
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7608065605163574
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7428390979766846
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8228411674499512
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 324832
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5773086547851562
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.348 Vali Acc: 0.290 Test Loss: 1.348 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 0.7483537197113037
Epoch: 2, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.169 Vali Acc: 0.551 Test Loss: 1.169 Test Acc: 0.551
Validation loss decreased (-0.289842 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 0.9063596725463867
Epoch: 3, Steps: 9 | Train Loss: 0.949 Vali Loss: 1.012 Vali Acc: 0.638 Test Loss: 1.012 Test Acc: 0.638
Validation loss decreased (-0.550713 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 0.7467856407165527
Epoch: 4, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.849 Vali Acc: 0.768 Test Loss: 0.849 Test Acc: 0.768
Validation loss decreased (-0.637671 --> -0.768107).  Saving model ...
Epoch: 5 cost time: 0.8716750144958496
Epoch: 5, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.733 Vali Acc: 0.804 Test Loss: 0.733 Test Acc: 0.804
Validation loss decreased (-0.768107 --> -0.804341).  Saving model ...
Epoch: 6 cost time: 0.8310277462005615
Epoch: 6, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.679 Vali Acc: 0.797 Test Loss: 0.679 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8069829940795898
Epoch: 7, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.589 Vali Acc: 0.819 Test Loss: 0.589 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 0.8215954303741455
Epoch: 8, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9011068344116211
Epoch: 9, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.8043215274810791
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.871070384979248
Epoch: 11, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9432599544525146
Epoch: 12, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.537 Vali Acc: 0.848 Test Loss: 0.537 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.73148512840271
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7674407958984375
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7528119087219238
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7922379970550537
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7501888275146484
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8678667545318604
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.520 Vali Acc: 0.826 Test Loss: 0.520 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7551124095916748
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7182283401489258
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7916975021362305
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8267362117767334
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 193760
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7922322750091553
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.331 Vali Acc: 0.377 Test Loss: 1.331 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.8300478458404541
Epoch: 2, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.143 Vali Acc: 0.565 Test Loss: 1.143 Test Acc: 0.565
Validation loss decreased (-0.376798 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 0.8860175609588623
Epoch: 3, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.976 Vali Acc: 0.659 Test Loss: 0.976 Test Acc: 0.659
Validation loss decreased (-0.565206 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 0.812103271484375
Epoch: 4, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
Validation loss decreased (-0.659411 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 0.9226665496826172
Epoch: 5, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
Validation loss decreased (-0.782601 --> -0.826080).  Saving model ...
Epoch: 6 cost time: 0.9486241340637207
Epoch: 6, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.648 Vali Acc: 0.797 Test Loss: 0.648 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1370012760162354
Epoch: 7, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.565 Vali Acc: 0.848 Test Loss: 0.565 Test Acc: 0.848
Validation loss decreased (-0.826080 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 1.009917974472046
Epoch: 8, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9283463954925537
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.9946746826171875
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8393769264221191
Epoch: 11, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9208333492279053
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7963848114013672
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8815395832061768
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8498311042785645
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.9105873107910156
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8270893096923828
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0663795471191406
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9890637397766113
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8515145778656006
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9580984115600586
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8458428382873535
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8750274181365967
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8549520969390869
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0284206867218018
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 193760
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7883758544921875
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.322 Vali Acc: 0.406 Test Loss: 1.322 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.8228662014007568
Epoch: 2, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.118 Vali Acc: 0.594 Test Loss: 1.118 Test Acc: 0.594
Validation loss decreased (-0.405784 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 0.7935395240783691
Epoch: 3, Steps: 9 | Train Loss: 0.916 Vali Loss: 0.942 Vali Acc: 0.696 Test Loss: 0.942 Test Acc: 0.696
Validation loss decreased (-0.594192 --> -0.695643).  Saving model ...
Epoch: 4 cost time: 0.8358581066131592
Epoch: 4, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.788 Vali Acc: 0.754 Test Loss: 0.788 Test Acc: 0.754
Validation loss decreased (-0.695643 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 0.7717969417572021
Epoch: 5, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.661 Vali Acc: 0.855 Test Loss: 0.661 Test Acc: 0.855
Validation loss decreased (-0.753615 --> -0.855066).  Saving model ...
Epoch: 6 cost time: 0.8169338703155518
Epoch: 6, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7824215888977051
Epoch: 7, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.532 Vali Acc: 0.855 Test Loss: 0.532 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 0.7934091091156006
Epoch: 8, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8352987766265869
Epoch: 9, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 0.7672486305236816
Epoch: 10, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7460148334503174
Epoch: 11, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6845347881317139
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 0.5995943546295166
Epoch: 13, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7248766422271729
Epoch: 14, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.457 Vali Acc: 0.819 Test Loss: 0.457 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7102696895599365
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7463502883911133
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7251839637756348
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7803423404693604
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.68546462059021
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.745025634765625
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7814121246337891
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8276903629302979
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 193760
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5076382160186768
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.312 Vali Acc: 0.406 Test Loss: 1.312 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.7691652774810791
Epoch: 2, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.087 Vali Acc: 0.601 Test Loss: 1.087 Test Acc: 0.601
Validation loss decreased (-0.405784 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.792773962020874
Epoch: 3, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.907 Vali Acc: 0.659 Test Loss: 0.907 Test Acc: 0.659
Validation loss decreased (-0.601438 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 0.7921950817108154
Epoch: 4, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
Validation loss decreased (-0.659411 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 0.8455977439880371
Epoch: 5, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840573).  Saving model ...
Epoch: 6 cost time: 0.804161787033081
Epoch: 6, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.7717032432556152
Epoch: 7, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 0.817371129989624
Epoch: 8, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.497 Vali Acc: 0.877 Test Loss: 0.497 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 9 cost time: 0.8373887538909912
Epoch: 9, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.458 Vali Acc: 0.877 Test Loss: 0.458 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 0.76784348487854
Epoch: 10, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8638782501220703
Epoch: 11, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7665500640869141
Epoch: 12, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8435726165771484
Epoch: 13, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8350064754486084
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.807682991027832
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.790679931640625
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7602190971374512
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.746166467666626
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7563061714172363
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 193760
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8132874965667725
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 0.8729193210601807
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.169 Vali Acc: 0.543 Test Loss: 1.169 Test Acc: 0.543
Validation loss decreased (-0.362305 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 0.8261401653289795
Epoch: 3, Steps: 9 | Train Loss: 0.903 Vali Loss: 0.986 Vali Acc: 0.688 Test Loss: 0.986 Test Acc: 0.688
Validation loss decreased (-0.543467 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 0.8028995990753174
Epoch: 4, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
Validation loss decreased (-0.688396 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 0.8805813789367676
Epoch: 5, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.719 Vali Acc: 0.790 Test Loss: 0.719 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 0.8617944717407227
Epoch: 6, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8309297561645508
Epoch: 7, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.604 Vali Acc: 0.848 Test Loss: 0.604 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 0.9179863929748535
Epoch: 8, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.593 Vali Acc: 0.804 Test Loss: 0.593 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9198083877563477
Epoch: 9, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.866246223449707
Epoch: 10, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9407224655151367
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.904792308807373
Epoch: 12, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9317338466644287
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8524174690246582
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9267439842224121
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9346120357513428
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8745982646942139
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 128224
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4779860973358154
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.340 Vali Acc: 0.355 Test Loss: 1.340 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.8449428081512451
Epoch: 2, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.162 Vali Acc: 0.558 Test Loss: 1.162 Test Acc: 0.558
Validation loss decreased (-0.355059 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 0.7829728126525879
Epoch: 3, Steps: 9 | Train Loss: 0.898 Vali Loss: 0.975 Vali Acc: 0.696 Test Loss: 0.975 Test Acc: 0.696
Validation loss decreased (-0.557959 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 0.7971467971801758
Epoch: 4, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.833 Vali Acc: 0.775 Test Loss: 0.833 Test Acc: 0.775
Validation loss decreased (-0.695642 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 0.7275917530059814
Epoch: 5, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.704 Vali Acc: 0.790 Test Loss: 0.704 Test Acc: 0.790
Validation loss decreased (-0.775354 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 0.7331433296203613
Epoch: 6, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 7 cost time: 0.7933962345123291
Epoch: 7, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
Validation loss decreased (-0.804341 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.7728893756866455
Epoch: 8, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8295040130615234
Epoch: 9, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.7989633083343506
Epoch: 10, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7241108417510986
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8391087055206299
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8946232795715332
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7435019016265869
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 0.8120195865631104
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.8923618793487549
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8333258628845215
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8534393310546875
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9198048114776611
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.817657470703125
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7793686389923096
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7924785614013672
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.557 Vali Acc: 0.833 Test Loss: 0.557 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7491540908813477
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7602887153625488
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7609527111053467
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 128224
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.3654704093933105
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.311 Vali Acc: 0.420 Test Loss: 1.311 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.7517044544219971
Epoch: 2, Steps: 9 | Train Loss: 1.157 Vali Loss: 1.123 Vali Acc: 0.601 Test Loss: 1.123 Test Acc: 0.601
Validation loss decreased (-0.420277 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.6538255214691162
Epoch: 3, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.932 Vali Acc: 0.754 Test Loss: 0.932 Test Acc: 0.754
Validation loss decreased (-0.601438 --> -0.753614).  Saving model ...
Epoch: 4 cost time: 0.8138933181762695
Epoch: 4, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.791 Vali Acc: 0.804 Test Loss: 0.791 Test Acc: 0.804
Validation loss decreased (-0.753614 --> -0.804340).  Saving model ...
Epoch: 5 cost time: 0.8245062828063965
Epoch: 5, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 0.8179197311401367
Epoch: 6, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.610 Vali Acc: 0.826 Test Loss: 0.610 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8161561489105225
Epoch: 7, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 0.8416836261749268
Epoch: 8, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8623533248901367
Epoch: 9, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.843419075012207
Epoch: 10, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8665766716003418
Epoch: 11, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8292782306671143
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.492 Vali Acc: 0.797 Test Loss: 0.492 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9029510021209717
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8788356781005859
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8319792747497559
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.482 Vali Acc: 0.819 Test Loss: 0.482 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7902626991271973
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8561575412750244
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 128224
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6149497032165527
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.297 Vali Acc: 0.435 Test Loss: 1.297 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 0.8690938949584961
Epoch: 2, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.096 Vali Acc: 0.601 Test Loss: 1.096 Test Acc: 0.601
Validation loss decreased (-0.434770 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.877593994140625
Epoch: 3, Steps: 9 | Train Loss: 0.891 Vali Loss: 0.908 Vali Acc: 0.688 Test Loss: 0.908 Test Acc: 0.688
Validation loss decreased (-0.601438 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 0.7412993907928467
Epoch: 4, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.767 Vali Acc: 0.783 Test Loss: 0.767 Test Acc: 0.783
Validation loss decreased (-0.688397 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 0.8015017509460449
Epoch: 5, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
Validation loss decreased (-0.782601 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 0.8361520767211914
Epoch: 6, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8653340339660645
Epoch: 7, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 0.7537760734558105
Epoch: 8, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 0.7809560298919678
Epoch: 9, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7859206199645996
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.759183406829834
Epoch: 11, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 0.7761468887329102
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8008537292480469
Epoch: 13, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8273630142211914
Epoch: 14, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.852487325668335
Epoch: 15, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7823894023895264
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7814807891845703
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7161810398101807
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7931759357452393
Epoch: 19, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7658939361572266
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9103381633758545
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 128224
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.615687847137451
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.263 Vali Acc: 0.478 Test Loss: 1.263 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 0.8345208168029785
Epoch: 2, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.102 Vali Acc: 0.616 Test Loss: 1.102 Test Acc: 0.616
Validation loss decreased (-0.478248 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 0.7992649078369141
Epoch: 3, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.942 Vali Acc: 0.732 Test Loss: 0.942 Test Acc: 0.732
Validation loss decreased (-0.615931 --> -0.731875).  Saving model ...
Epoch: 4 cost time: 0.8518564701080322
Epoch: 4, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.804 Vali Acc: 0.768 Test Loss: 0.804 Test Acc: 0.768
Validation loss decreased (-0.731875 --> -0.768108).  Saving model ...
Epoch: 5 cost time: 0.8383920192718506
Epoch: 5, Steps: 9 | Train Loss: 0.494 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8114702701568604
Epoch: 6, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (-0.768108 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 0.8103997707366943
Epoch: 7, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 8 cost time: 0.7375204563140869
Epoch: 8, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.550 Vali Acc: 0.862 Test Loss: 0.550 Test Acc: 0.862
Validation loss decreased (-0.818834 --> -0.862313).  Saving model ...
Epoch: 9 cost time: 0.7120020389556885
Epoch: 9, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7792274951934814
Epoch: 10, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.827862024307251
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8204338550567627
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.8585679531097412
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8553454875946045
Epoch: 14, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7994606494903564
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7802150249481201
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8400547504425049
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.85776686668396
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9529657363891602
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8719549179077148
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8680953979492188
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8857383728027344
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 95456
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6169044971466064
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.272 Vali Acc: 0.471 Test Loss: 1.272 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 0.8565895557403564
Epoch: 2, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.104 Vali Acc: 0.601 Test Loss: 1.104 Test Acc: 0.601
Validation loss decreased (-0.471002 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.851651668548584
Epoch: 3, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.939 Vali Acc: 0.703 Test Loss: 0.939 Test Acc: 0.703
Validation loss decreased (-0.601438 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 0.8834812641143799
Epoch: 4, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.702889 --> -0.782601).  Saving model ...
Epoch: 5 cost time: 0.8137576580047607
Epoch: 5, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
Validation loss decreased (-0.782601 --> -0.782601).  Saving model ...
Epoch: 6 cost time: 0.8529984951019287
Epoch: 6, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
Validation loss decreased (-0.782601 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8347952365875244
Epoch: 7, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.600 Vali Acc: 0.826 Test Loss: 0.600 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8215970993041992
Epoch: 8, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8622140884399414
Epoch: 9, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.530 Vali Acc: 0.855 Test Loss: 0.530 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 0.819359302520752
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8789515495300293
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 0.8658976554870605
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.520 Vali Acc: 0.862 Test Loss: 0.520 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.9277622699737549
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8636958599090576
Epoch: 14, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8223540782928467
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8834114074707031
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8767421245574951
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8002548217773438
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0321812629699707
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8472473621368408
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8405654430389404
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8429145812988281
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 95456
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.627568483352661
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 0.7706456184387207
Epoch: 2, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.078 Vali Acc: 0.645 Test Loss: 1.078 Test Acc: 0.645
Validation loss decreased (-0.485495 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 0.7423069477081299
Epoch: 3, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.907 Vali Acc: 0.717 Test Loss: 0.907 Test Acc: 0.717
Validation loss decreased (-0.644917 --> -0.717382).  Saving model ...
Epoch: 4 cost time: 0.7896826267242432
Epoch: 4, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.770 Vali Acc: 0.797 Test Loss: 0.770 Test Acc: 0.797
Validation loss decreased (-0.717382 --> -0.797094).  Saving model ...
Epoch: 5 cost time: 0.7524235248565674
Epoch: 5, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.688 Vali Acc: 0.790 Test Loss: 0.688 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8135058879852295
Epoch: 6, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.607 Vali Acc: 0.855 Test Loss: 0.607 Test Acc: 0.855
Validation loss decreased (-0.797094 --> -0.855066).  Saving model ...
Epoch: 7 cost time: 0.7847723960876465
Epoch: 7, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8529751300811768
Epoch: 8, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7822597026824951
Epoch: 9, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 0.7784104347229004
Epoch: 10, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8527171611785889
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7900905609130859
Epoch: 12, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7929131984710693
Epoch: 13, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7441360950469971
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7638652324676514
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7559688091278076
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8145842552185059
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8347690105438232
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7966666221618652
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.472 Vali Acc: 0.819 Test Loss: 0.472 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 95456
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7535908222198486
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.221 Vali Acc: 0.551 Test Loss: 1.221 Test Acc: 0.551
Validation loss decreased (inf --> -0.550712).  Saving model ...
Epoch: 2 cost time: 0.8360974788665771
Epoch: 2, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.550712 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 0.9505786895751953
Epoch: 3, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.863 Vali Acc: 0.717 Test Loss: 0.863 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 0.8445272445678711
Epoch: 4, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
Validation loss decreased (-0.717383 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 0.7846946716308594
Epoch: 5, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.634 Vali Acc: 0.833 Test Loss: 0.634 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.8775782585144043
Epoch: 6, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 7 cost time: 0.8380353450775146
Epoch: 7, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 0.8371424674987793
Epoch: 8, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.8490147590637207
Epoch: 9, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 0.7311372756958008
Epoch: 10, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.739713191986084
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6707730293273926
Epoch: 12, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.67228102684021
Epoch: 13, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8301870822906494
Epoch: 14, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8470466136932373
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9526488780975342
Epoch: 16, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9439601898193359
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0117466449737549
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9853689670562744
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 95456
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.728135585784912
Epoch: 1, Steps: 9 | Train Loss: 1.488 Vali Loss: 1.358 Vali Acc: 0.297 Test Loss: 1.358 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.94759202003479
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.297088 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 0.792971134185791
Epoch: 3, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.003 Vali Acc: 0.659 Test Loss: 1.003 Test Acc: 0.659
Validation loss decreased (-0.485495 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 0.7532949447631836
Epoch: 4, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.869 Vali Acc: 0.746 Test Loss: 0.869 Test Acc: 0.746
Validation loss decreased (-0.659410 --> -0.746368).  Saving model ...
Epoch: 5 cost time: 0.8127808570861816
Epoch: 5, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
Validation loss decreased (-0.746368 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 0.7799780368804932
Epoch: 6, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.675 Vali Acc: 0.790 Test Loss: 0.675 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 0.6852014064788818
Epoch: 7, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 0.772005558013916
Epoch: 8, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.7120621204376221
Epoch: 9, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.7227015495300293
Epoch: 10, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 0.635096549987793
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7496938705444336
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8265588283538818
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 0.9590351581573486
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8363792896270752
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8019623756408691
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8920514583587646
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8757517337799072
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.900517463684082
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0109834671020508
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 21 cost time: 0.8280959129333496
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8717770576477051
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8883273601531982
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8856978416442871
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8795390129089355
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8861949443817139
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.81211256980896
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.014718770980835
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8740561008453369
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9087214469909668
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.848 Test Loss: 0.540 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 79072
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6997194290161133
Epoch: 1, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.7891974449157715
Epoch: 2, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.333320 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 0.8370823860168457
Epoch: 3, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.980 Vali Acc: 0.688 Test Loss: 0.980 Test Acc: 0.688
Validation loss decreased (-0.514481 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 0.8143322467803955
Epoch: 4, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.688396 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 0.9168524742126465
Epoch: 5, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 0.8604986667633057
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.651 Vali Acc: 0.826 Test Loss: 0.651 Test Acc: 0.826
Validation loss decreased (-0.775355 --> -0.826080).  Saving model ...
Epoch: 7 cost time: 0.8445136547088623
Epoch: 7, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 0.8238663673400879
Epoch: 8, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.8793380260467529
Epoch: 9, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.9359469413757324
Epoch: 10, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 0.8273279666900635
Epoch: 11, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 0.8047835826873779
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.495 Vali Acc: 0.848 Test Loss: 0.495 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.7776708602905273
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8520727157592773
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 0.8298623561859131
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8139455318450928
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8361237049102783
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8685941696166992
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7677345275878906
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8499255180358887
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.837942361831665
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8805007934570312
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8529319763183594
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8519127368927002
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 79072
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.707592487335205
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.331 Vali Acc: 0.341 Test Loss: 1.331 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.7282922267913818
Epoch: 2, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.147 Vali Acc: 0.543 Test Loss: 1.147 Test Acc: 0.543
Validation loss decreased (-0.340566 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 0.7748377323150635
Epoch: 3, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
Validation loss decreased (-0.543467 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 0.7498774528503418
Epoch: 4, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.688396 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 0.776984691619873
Epoch: 5, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 6 cost time: 0.8392033576965332
Epoch: 6, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.775355 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8784744739532471
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.8314082622528076
Epoch: 8, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.8498697280883789
Epoch: 9, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.8546383380889893
Epoch: 10, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 0.8314089775085449
Epoch: 11, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 0.8709931373596191
Epoch: 12, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7676360607147217
Epoch: 13, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7930071353912354
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7945005893707275
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8784024715423584
Epoch: 16, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8132896423339844
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8777296543121338
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8568823337554932
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.842792272567749
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7968246936798096
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 79072
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4517714977264404
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.280 Vali Acc: 0.464 Test Loss: 1.280 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 0.7209656238555908
Epoch: 2, Steps: 9 | Train Loss: 1.164 Vali Loss: 1.082 Vali Acc: 0.594 Test Loss: 1.082 Test Acc: 0.594
Validation loss decreased (-0.463755 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 0.7393088340759277
Epoch: 3, Steps: 9 | Train Loss: 0.899 Vali Loss: 0.897 Vali Acc: 0.674 Test Loss: 0.897 Test Acc: 0.674
Validation loss decreased (-0.594192 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 0.8239407539367676
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
Validation loss decreased (-0.673904 --> -0.818833).  Saving model ...
Epoch: 5 cost time: 0.8496150970458984
Epoch: 5, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8722844123840332
Epoch: 6, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.580 Vali Acc: 0.848 Test Loss: 0.580 Test Acc: 0.848
Validation loss decreased (-0.818833 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 0.8161270618438721
Epoch: 7, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 0.7732360363006592
Epoch: 8, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.490 Vali Acc: 0.870 Test Loss: 0.490 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 0.9757421016693115
Epoch: 9, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 0.8708758354187012
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8458948135375977
Epoch: 11, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8527488708496094
Epoch: 12, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.798346757888794
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7751820087432861
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8790755271911621
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8561587333679199
Epoch: 16, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8590812683105469
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 0.9226922988891602
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.994539737701416
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9003546237945557
Epoch: 20, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9083423614501953
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.832134485244751
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7874689102172852
Epoch: 23, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8211538791656494
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7712986469268799
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8502206802368164
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8749935626983643
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 79072
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.730137348175049
Epoch: 1, Steps: 9 | Train Loss: 1.549 Vali Loss: 1.357 Vali Acc: 0.391 Test Loss: 1.357 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.8560945987701416
Epoch: 2, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.186 Vali Acc: 0.464 Test Loss: 1.186 Test Acc: 0.464
Validation loss decreased (-0.391291 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 0.8910226821899414
Epoch: 3, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.463756 --> -0.724628).  Saving model ...
Epoch: 4 cost time: 0.813201904296875
Epoch: 4, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.850 Vali Acc: 0.761 Test Loss: 0.850 Test Acc: 0.761
Validation loss decreased (-0.724628 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 0.892977237701416
Epoch: 5, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.722 Vali Acc: 0.812 Test Loss: 0.722 Test Acc: 0.812
Validation loss decreased (-0.760861 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 0.8136694431304932
Epoch: 6, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 0.8301658630371094
Epoch: 7, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 8 cost time: 0.8556511402130127
Epoch: 8, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.8152124881744385
Epoch: 9, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.526 Vali Acc: 0.833 Test Loss: 0.526 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8339624404907227
Epoch: 10, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8142149448394775
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7973954677581787
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.8647546768188477
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8556065559387207
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7907977104187012
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7919495105743408
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.886777400970459
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7865233421325684
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8265736103057861
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8039491176605225
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.753434419631958
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8749737739562988
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 70880
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.626913547515869
Epoch: 1, Steps: 9 | Train Loss: 1.540 Vali Loss: 1.341 Vali Acc: 0.370 Test Loss: 1.341 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.7803788185119629
Epoch: 2, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.158 Vali Acc: 0.471 Test Loss: 1.158 Test Acc: 0.471
Validation loss decreased (-0.369552 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 0.7885878086090088
Epoch: 3, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.972 Vali Acc: 0.761 Test Loss: 0.972 Test Acc: 0.761
Validation loss decreased (-0.471003 --> -0.760860).  Saving model ...
Epoch: 4 cost time: 0.8405585289001465
Epoch: 4, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.827 Vali Acc: 0.761 Test Loss: 0.827 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760861).  Saving model ...
Epoch: 5 cost time: 0.8069276809692383
Epoch: 5, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.699 Vali Acc: 0.819 Test Loss: 0.699 Test Acc: 0.819
Validation loss decreased (-0.760861 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 0.8281986713409424
Epoch: 6, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 0.8068902492523193
Epoch: 7, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 0.8096554279327393
Epoch: 8, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 0.9308755397796631
Epoch: 9, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 0.804480791091919
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8780310153961182
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8765964508056641
Epoch: 12, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.7963294982910156
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.825592041015625
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7885854244232178
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8118796348571777
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8760671615600586
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8140387535095215
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8503077030181885
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8610436916351318
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8436806201934814
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8306872844696045
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 70880
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5024359226226807
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.333 Vali Acc: 0.435 Test Loss: 1.333 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 0.9151043891906738
Epoch: 2, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
Validation loss decreased (-0.434769 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 0.7964508533477783
Epoch: 3, Steps: 9 | Train Loss: 0.913 Vali Loss: 0.940 Vali Acc: 0.768 Test Loss: 0.940 Test Acc: 0.768
Validation loss decreased (-0.514481 --> -0.768107).  Saving model ...
Epoch: 4 cost time: 0.9653403759002686
Epoch: 4, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
Validation loss decreased (-0.768107 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 0.955141544342041
Epoch: 5, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.676 Vali Acc: 0.812 Test Loss: 0.676 Test Acc: 0.812
Validation loss decreased (-0.775354 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 0.8733155727386475
Epoch: 6, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 0.8105180263519287
Epoch: 7, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.8364248275756836
Epoch: 8, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.8543503284454346
Epoch: 9, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 0.834282398223877
Epoch: 10, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 0.8921761512756348
Epoch: 11, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8343029022216797
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.78501296043396
Epoch: 13, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7860255241394043
Epoch: 14, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7598867416381836
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 0.7679274082183838
Epoch: 16, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 0.766270637512207
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.735353946685791
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8848884105682373
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7508058547973633
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7255444526672363
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.732367992401123
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.807866096496582
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 0.8587851524353027
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 0.8519144058227539
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9515581130981445
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7462959289550781
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 28 cost time: 0.8513917922973633
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.481 Vali Acc: 0.862 Test Loss: 0.481 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8298587799072266
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7964015007019043
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.475 Vali Acc: 0.877 Test Loss: 0.475 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7539069652557373
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7299239635467529
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8347053527832031
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9505562782287598
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9841396808624268
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9764583110809326
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.082216739654541
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 70880
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5574867725372314
Epoch: 1, Steps: 9 | Train Loss: 1.477 Vali Loss: 1.314 Vali Acc: 0.471 Test Loss: 1.314 Test Acc: 0.471
Validation loss decreased (inf --> -0.471001).  Saving model ...
Epoch: 2 cost time: 0.7862892150878906
Epoch: 2, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.094 Vali Acc: 0.580 Test Loss: 1.094 Test Acc: 0.580
Validation loss decreased (-0.471001 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 0.823195219039917
Epoch: 3, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.898 Vali Acc: 0.768 Test Loss: 0.898 Test Acc: 0.768
Validation loss decreased (-0.579699 --> -0.768107).  Saving model ...
Epoch: 4 cost time: 0.7999527454376221
Epoch: 4, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.754 Vali Acc: 0.812 Test Loss: 0.754 Test Acc: 0.812
Validation loss decreased (-0.768107 --> -0.811587).  Saving model ...
Epoch: 5 cost time: 0.8094818592071533
Epoch: 5, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.7879319190979004
Epoch: 6, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.8396635055541992
Epoch: 7, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.903841495513916
Epoch: 8, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.494 Vali Acc: 0.848 Test Loss: 0.494 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 0.7991847991943359
Epoch: 9, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 0.9292938709259033
Epoch: 10, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 0.7995882034301758
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 0.8480780124664307
Epoch: 12, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 13 cost time: 0.8896453380584717
Epoch: 13, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9053034782409668
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8353948593139648
Epoch: 15, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 0.8929684162139893
Epoch: 16, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8204517364501953
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8939590454101562
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8759102821350098
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.924201250076294
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9337329864501953
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8284738063812256
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8182671070098877
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8783471584320068
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7924668788909912
Epoch: 25, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 70880
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.628176212310791
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.250 Vali Acc: 0.442 Test Loss: 1.250 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 0.754967451095581
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.158 Vali Acc: 0.616 Test Loss: 1.158 Test Acc: 0.616
Validation loss decreased (-0.442016 --> -0.615930).  Saving model ...
Epoch: 3 cost time: 0.7900087833404541
Epoch: 3, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.063 Vali Acc: 0.659 Test Loss: 1.063 Test Acc: 0.659
Validation loss decreased (-0.615930 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 0.832507848739624
Epoch: 4, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.951 Vali Acc: 0.746 Test Loss: 0.951 Test Acc: 0.746
Validation loss decreased (-0.659410 --> -0.746367).  Saving model ...
Epoch: 5 cost time: 0.8035581111907959
Epoch: 5, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.863 Vali Acc: 0.768 Test Loss: 0.863 Test Acc: 0.768
Validation loss decreased (-0.746367 --> -0.768107).  Saving model ...
Epoch: 6 cost time: 0.9160420894622803
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.794 Vali Acc: 0.754 Test Loss: 0.794 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8134627342224121
Epoch: 7, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.716 Vali Acc: 0.804 Test Loss: 0.716 Test Acc: 0.804
Validation loss decreased (-0.768107 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.8021795749664307
Epoch: 8, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8736004829406738
Epoch: 9, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.624 Vali Acc: 0.768 Test Loss: 0.624 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9049227237701416
Epoch: 10, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8061673641204834
Epoch: 11, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7852489948272705
Epoch: 12, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.804341 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 0.7770876884460449
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.554 Vali Acc: 0.797 Test Loss: 0.554 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7483439445495605
Epoch: 14, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.729670524597168
Epoch: 15, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7335293292999268
Epoch: 16, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7834334373474121
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7754740715026855
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8001108169555664
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.697021484375
Epoch: 20, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.539 Vali Acc: 0.804 Test Loss: 0.539 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8013973236083984
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7707080841064453
Epoch: 22, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.804 Test Loss: 0.541 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 160384
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6743171215057373
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.242 Vali Acc: 0.457 Test Loss: 1.242 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 0.7452473640441895
Epoch: 2, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.148 Vali Acc: 0.601 Test Loss: 1.148 Test Acc: 0.601
Validation loss decreased (-0.456509 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.7546172142028809
Epoch: 3, Steps: 9 | Train Loss: 1.046 Vali Loss: 1.052 Vali Acc: 0.623 Test Loss: 1.052 Test Acc: 0.623
Validation loss decreased (-0.601438 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.7767291069030762
Epoch: 4, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.944 Vali Acc: 0.717 Test Loss: 0.944 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 0.82305908203125
Epoch: 5, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.860 Vali Acc: 0.761 Test Loss: 0.860 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.9328804016113281
Epoch: 6, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
Validation loss decreased (-0.760861 --> -0.775354).  Saving model ...
Epoch: 7 cost time: 0.8801975250244141
Epoch: 7, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.713 Vali Acc: 0.804 Test Loss: 0.713 Test Acc: 0.804
Validation loss decreased (-0.775354 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.8561201095581055
Epoch: 8, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.8457865715026855
Epoch: 9, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.623 Vali Acc: 0.804 Test Loss: 0.623 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.847769021987915
Epoch: 10, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 0.8073105812072754
Epoch: 11, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7836685180664062
Epoch: 12, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 0.8205356597900391
Epoch: 13, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7679123878479004
Epoch: 14, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8569350242614746
Epoch: 15, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8200006484985352
Epoch: 16, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 17 cost time: 0.8031234741210938
Epoch: 17, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7728221416473389
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8154878616333008
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9436867237091064
Epoch: 20, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8087649345397949
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7905700206756592
Epoch: 22, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7694861888885498
Epoch: 23, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7472953796386719
Epoch: 24, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8518924713134766
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.527 Vali Acc: 0.790 Test Loss: 0.527 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9082431793212891
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 160384
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7812514305114746
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.225 Vali Acc: 0.522 Test Loss: 1.225 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 0.7905428409576416
Epoch: 2, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.127 Vali Acc: 0.659 Test Loss: 1.127 Test Acc: 0.659
Validation loss decreased (-0.521727 --> -0.659409).  Saving model ...
Epoch: 3 cost time: 0.8590662479400635
Epoch: 3, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.028 Vali Acc: 0.659 Test Loss: 1.028 Test Acc: 0.659
Validation loss decreased (-0.659409 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 0.8924853801727295
Epoch: 4, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.920 Vali Acc: 0.732 Test Loss: 0.920 Test Acc: 0.732
Validation loss decreased (-0.659410 --> -0.731875).  Saving model ...
Epoch: 5 cost time: 0.911898136138916
Epoch: 5, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
Validation loss decreased (-0.731875 --> -0.782600).  Saving model ...
Epoch: 6 cost time: 0.8545763492584229
Epoch: 6, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
Validation loss decreased (-0.782600 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.7700526714324951
Epoch: 7, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.690 Vali Acc: 0.812 Test Loss: 0.690 Test Acc: 0.812
Validation loss decreased (-0.782601 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.8923532962799072
Epoch: 8, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.8497486114501953
Epoch: 9, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.7415471076965332
Epoch: 10, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 11 cost time: 0.87099289894104
Epoch: 11, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0237452983856201
Epoch: 12, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.515 Vali Acc: 0.862 Test Loss: 0.515 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 0.8846917152404785
Epoch: 13, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0125341415405273
Epoch: 14, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8324987888336182
Epoch: 15, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8662524223327637
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 0.7893068790435791
Epoch: 17, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7756080627441406
Epoch: 18, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.493 Vali Acc: 0.826 Test Loss: 0.493 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7036342620849609
Epoch: 19, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8108785152435303
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.489 Vali Acc: 0.826 Test Loss: 0.489 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7787909507751465
Epoch: 21, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.75642991065979
Epoch: 22, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7266952991485596
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.787564754486084
Epoch: 24, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6996607780456543
Epoch: 25, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7503547668457031
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 160384
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.618365526199341
Epoch: 1, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.217 Vali Acc: 0.543 Test Loss: 1.217 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 0.7527685165405273
Epoch: 2, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.112 Vali Acc: 0.645 Test Loss: 1.112 Test Acc: 0.645
Validation loss decreased (-0.543466 --> -0.644916).  Saving model ...
Epoch: 3 cost time: 0.773118257522583
Epoch: 3, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.012 Vali Acc: 0.681 Test Loss: 1.012 Test Acc: 0.681
Validation loss decreased (-0.644916 --> -0.681149).  Saving model ...
Epoch: 4 cost time: 0.7316067218780518
Epoch: 4, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.912 Vali Acc: 0.732 Test Loss: 0.912 Test Acc: 0.732
Validation loss decreased (-0.681149 --> -0.731875).  Saving model ...
Epoch: 5 cost time: 0.788853645324707
Epoch: 5, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.831 Vali Acc: 0.754 Test Loss: 0.831 Test Acc: 0.754
Validation loss decreased (-0.731875 --> -0.753615).  Saving model ...
Epoch: 6 cost time: 0.7959427833557129
Epoch: 6, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.8521554470062256
Epoch: 7, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.693 Vali Acc: 0.812 Test Loss: 0.693 Test Acc: 0.812
Validation loss decreased (-0.782601 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.7997307777404785
Epoch: 8, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.7171905040740967
Epoch: 9, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.7807745933532715
Epoch: 10, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 0.7373783588409424
Epoch: 11, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.565 Vali Acc: 0.804 Test Loss: 0.565 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.734799861907959
Epoch: 12, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.523 Vali Acc: 0.855 Test Loss: 0.523 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.6843836307525635
Epoch: 13, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6934881210327148
Epoch: 14, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7286951541900635
Epoch: 15, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.503 Vali Acc: 0.819 Test Loss: 0.503 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6869940757751465
Epoch: 16, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.708219051361084
Epoch: 17, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7346584796905518
Epoch: 18, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7633950710296631
Epoch: 19, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6713147163391113
Epoch: 20, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7525572776794434
Epoch: 21, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7147271633148193
Epoch: 22, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 160384
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4687130451202393
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.335 Vali Acc: 0.420 Test Loss: 1.335 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.6876516342163086
Epoch: 2, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.238 Vali Acc: 0.493 Test Loss: 1.238 Test Acc: 0.493
Validation loss decreased (-0.420277 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 0.7709126472473145
Epoch: 3, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.120 Vali Acc: 0.565 Test Loss: 1.120 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 0.7909815311431885
Epoch: 4, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.019 Vali Acc: 0.630 Test Loss: 1.019 Test Acc: 0.630
Validation loss decreased (-0.565206 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 0.7742297649383545
Epoch: 5, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.924 Vali Acc: 0.667 Test Loss: 0.924 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.763983964920044
Epoch: 6, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 0.7563254833221436
Epoch: 7, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
Validation loss decreased (-0.717383 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 0.7436022758483887
Epoch: 8, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 0.8080489635467529
Epoch: 9, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.796140193939209
Epoch: 10, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 0.8530094623565674
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 0.8392269611358643
Epoch: 12, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.851804256439209
Epoch: 13, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.006561517715454
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8834433555603027
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.910855770111084
Epoch: 16, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.547 Vali Acc: 0.812 Test Loss: 0.547 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9038712978363037
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8231339454650879
Epoch: 18, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.540 Vali Acc: 0.804 Test Loss: 0.540 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8554284572601318
Epoch: 19, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.893235445022583
Epoch: 20, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7851333618164062
Epoch: 21, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.790 Test Loss: 0.533 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 94848
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7139196395874023
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.341 Vali Acc: 0.420 Test Loss: 1.341 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 0.899350643157959
Epoch: 2, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.239 Vali Acc: 0.522 Test Loss: 1.239 Test Acc: 0.522
Validation loss decreased (-0.420276 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.8273673057556152
Epoch: 3, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.117 Vali Acc: 0.601 Test Loss: 1.117 Test Acc: 0.601
Validation loss decreased (-0.521727 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 0.8027403354644775
Epoch: 4, Steps: 9 | Train Loss: 0.898 Vali Loss: 1.014 Vali Acc: 0.609 Test Loss: 1.014 Test Acc: 0.609
Validation loss decreased (-0.601438 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 0.8079133033752441
Epoch: 5, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.918 Vali Acc: 0.659 Test Loss: 0.918 Test Acc: 0.659
Validation loss decreased (-0.608686 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 0.9024505615234375
Epoch: 6, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.832 Vali Acc: 0.732 Test Loss: 0.832 Test Acc: 0.732
Validation loss decreased (-0.659411 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 0.710789680480957
Epoch: 7, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
Validation loss decreased (-0.731876 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 0.8721449375152588
Epoch: 8, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
Validation loss decreased (-0.782601 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 0.8335657119750977
Epoch: 9, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 0.8033618927001953
Epoch: 10, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.619 Vali Acc: 0.826 Test Loss: 0.619 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.8483247756958008
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.867516040802002
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 0.7962119579315186
Epoch: 13, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0071682929992676
Epoch: 14, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 0.8318591117858887
Epoch: 15, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8878998756408691
Epoch: 16, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9138045310974121
Epoch: 17, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9355642795562744
Epoch: 18, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.537 Vali Acc: 0.797 Test Loss: 0.537 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8927133083343506
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.528 Vali Acc: 0.797 Test Loss: 0.528 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7584371566772461
Epoch: 20, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.565 Vali Acc: 0.804 Test Loss: 0.565 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8335347175598145
Epoch: 21, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.529 Vali Acc: 0.790 Test Loss: 0.529 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.85711669921875
Epoch: 22, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8173837661743164
Epoch: 23, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7231755256652832
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.790 Test Loss: 0.532 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 94848
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.456303834915161
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.329 Vali Acc: 0.435 Test Loss: 1.329 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 0.6964967250823975
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.221 Vali Acc: 0.565 Test Loss: 1.221 Test Acc: 0.565
Validation loss decreased (-0.434769 --> -0.565205).  Saving model ...
Epoch: 3 cost time: 0.7509827613830566
Epoch: 3, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.094 Vali Acc: 0.638 Test Loss: 1.094 Test Acc: 0.638
Validation loss decreased (-0.565205 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 0.8255751132965088
Epoch: 4, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.987 Vali Acc: 0.688 Test Loss: 0.987 Test Acc: 0.688
Validation loss decreased (-0.637670 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 0.7201321125030518
Epoch: 5, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
Validation loss decreased (-0.688396 --> -0.717382).  Saving model ...
Epoch: 6 cost time: 0.8188474178314209
Epoch: 6, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.804 Vali Acc: 0.761 Test Loss: 0.804 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 0.7608554363250732
Epoch: 7, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.722 Vali Acc: 0.804 Test Loss: 0.722 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.7730271816253662
Epoch: 8, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.666 Vali Acc: 0.804 Test Loss: 0.666 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 0.8027980327606201
Epoch: 9, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
Validation loss decreased (-0.804341 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.7747800350189209
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 0.7498340606689453
Epoch: 11, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 0.8444650173187256
Epoch: 12, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.8600265979766846
Epoch: 13, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.8154134750366211
Epoch: 14, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 0.9293310642242432
Epoch: 15, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9624853134155273
Epoch: 16, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 0.7634315490722656
Epoch: 17, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8372228145599365
Epoch: 18, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8327934741973877
Epoch: 19, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 20 cost time: 0.884634256362915
Epoch: 20, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7851459980010986
Epoch: 21, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8244593143463135
Epoch: 22, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 0.9105863571166992
Epoch: 23, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 0.8349902629852295
Epoch: 24, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7982771396636963
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8350720405578613
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8425610065460205
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8616020679473877
Epoch: 28, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8447356224060059
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8508975505828857
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.488 Vali Acc: 0.826 Test Loss: 0.488 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.772007942199707
Epoch: 31, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7937240600585938
Epoch: 32, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7710795402526855
Epoch: 33, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 94848
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6673660278320312
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.311 Vali Acc: 0.514 Test Loss: 1.311 Test Acc: 0.514
Validation loss decreased (inf --> -0.514480).  Saving model ...
Epoch: 2 cost time: 1.0844557285308838
Epoch: 2, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.193 Vali Acc: 0.609 Test Loss: 1.193 Test Acc: 0.609
Validation loss decreased (-0.514480 --> -0.608684).  Saving model ...
Epoch: 3 cost time: 1.0536777973175049
Epoch: 3, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.064 Vali Acc: 0.652 Test Loss: 1.064 Test Acc: 0.652
Validation loss decreased (-0.608684 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 0.9713518619537354
Epoch: 4, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.957 Vali Acc: 0.688 Test Loss: 0.957 Test Acc: 0.688
Validation loss decreased (-0.652163 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 0.8858253955841064
Epoch: 5, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.858 Vali Acc: 0.746 Test Loss: 0.858 Test Acc: 0.746
Validation loss decreased (-0.688396 --> -0.746368).  Saving model ...
Epoch: 6 cost time: 0.9088366031646729
Epoch: 6, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
Validation loss decreased (-0.746368 --> -0.797094).  Saving model ...
Epoch: 7 cost time: 0.880511999130249
Epoch: 7, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.705 Vali Acc: 0.826 Test Loss: 0.705 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826080).  Saving model ...
Epoch: 8 cost time: 0.8891558647155762
Epoch: 8, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.647 Vali Acc: 0.826 Test Loss: 0.647 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 9 cost time: 0.8117659091949463
Epoch: 9, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 0.8705277442932129
Epoch: 10, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8701083660125732
Epoch: 11, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 0.9182002544403076
Epoch: 12, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 1.010084867477417
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8379042148590088
Epoch: 14, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8345627784729004
Epoch: 15, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6733205318450928
Epoch: 16, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7790906429290771
Epoch: 17, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 0.7313637733459473
Epoch: 18, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8635475635528564
Epoch: 19, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.496 Vali Acc: 0.833 Test Loss: 0.496 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8185169696807861
Epoch: 20, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7831935882568359
Epoch: 21, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.861304521560669
Epoch: 22, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7921862602233887
Epoch: 23, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8458425998687744
Epoch: 24, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.479 Vali Acc: 0.812 Test Loss: 0.479 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8902425765991211
Epoch: 25, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9893226623535156
Epoch: 26, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 27 cost time: 0.8848369121551514
Epoch: 27, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.468 Vali Acc: 0.841 Test Loss: 0.468 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9375584125518799
Epoch: 28, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8197274208068848
Epoch: 29, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8976709842681885
Epoch: 30, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8672029972076416
Epoch: 31, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8232426643371582
Epoch: 32, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9252784252166748
Epoch: 33, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8168480396270752
Epoch: 34, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8257060050964355
Epoch: 35, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8005928993225098
Epoch: 36, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 37 cost time: 0.9207847118377686
Epoch: 37, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.792839527130127
Epoch: 38, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8608336448669434
Epoch: 39, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8777434825897217
Epoch: 40, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6741824150085449
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7690112590789795
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8081443309783936
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8070642948150635
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7645516395568848
Epoch: 45, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8332958221435547
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 94848
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.874701499938965
Epoch: 1, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.307 Vali Acc: 0.319 Test Loss: 1.307 Test Acc: 0.319
Validation loss decreased (inf --> -0.318828).  Saving model ...
Epoch: 2 cost time: 0.9466409683227539
Epoch: 2, Steps: 9 | Train Loss: 1.235 Vali Loss: 1.194 Vali Acc: 0.457 Test Loss: 1.194 Test Acc: 0.457
Validation loss decreased (-0.318828 --> -0.456510).  Saving model ...
Epoch: 3 cost time: 0.8929367065429688
Epoch: 3, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.082 Vali Acc: 0.609 Test Loss: 1.082 Test Acc: 0.609
Validation loss decreased (-0.456510 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 0.9831244945526123
Epoch: 4, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.987 Vali Acc: 0.681 Test Loss: 0.987 Test Acc: 0.681
Validation loss decreased (-0.608685 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 0.7885053157806396
Epoch: 5, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
Validation loss decreased (-0.681150 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 0.8879766464233398
Epoch: 6, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.802 Vali Acc: 0.797 Test Loss: 0.802 Test Acc: 0.797
Validation loss decreased (-0.739122 --> -0.797093).  Saving model ...
Epoch: 7 cost time: 0.85123610496521
Epoch: 7, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.727 Vali Acc: 0.797 Test Loss: 0.727 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 1.009819507598877
Epoch: 8, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.684 Vali Acc: 0.790 Test Loss: 0.684 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9438409805297852
Epoch: 9, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 0.9106440544128418
Epoch: 10, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.8422539234161377
Epoch: 11, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 0.9574055671691895
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.548 Vali Acc: 0.848 Test Loss: 0.548 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 0.9306838512420654
Epoch: 13, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8742108345031738
Epoch: 14, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8605332374572754
Epoch: 15, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8258938789367676
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7882828712463379
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8409392833709717
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8027443885803223
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7449345588684082
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8008880615234375
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.798663854598999
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 62080
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9611501693725586
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.305 Vali Acc: 0.319 Test Loss: 1.305 Test Acc: 0.319
Validation loss decreased (inf --> -0.318828).  Saving model ...
Epoch: 2 cost time: 1.1787912845611572
Epoch: 2, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.191 Vali Acc: 0.471 Test Loss: 1.191 Test Acc: 0.471
Validation loss decreased (-0.318828 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 0.9268927574157715
Epoch: 3, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.077 Vali Acc: 0.623 Test Loss: 1.077 Test Acc: 0.623
Validation loss decreased (-0.471003 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.8502538204193115
Epoch: 4, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.978 Vali Acc: 0.681 Test Loss: 0.978 Test Acc: 0.681
Validation loss decreased (-0.623178 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 0.8236920833587646
Epoch: 5, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.867 Vali Acc: 0.732 Test Loss: 0.867 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 0.8404800891876221
Epoch: 6, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.798 Vali Acc: 0.790 Test Loss: 0.798 Test Acc: 0.790
Validation loss decreased (-0.731875 --> -0.789847).  Saving model ...
Epoch: 7 cost time: 0.9244945049285889
Epoch: 7, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.725 Vali Acc: 0.797 Test Loss: 0.725 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 8 cost time: 0.865206241607666
Epoch: 8, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.678 Vali Acc: 0.797 Test Loss: 0.678 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 0.8823490142822266
Epoch: 9, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.629 Vali Acc: 0.826 Test Loss: 0.629 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 0.8801705837249756
Epoch: 10, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.594 Vali Acc: 0.826 Test Loss: 0.594 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 0.9248216152191162
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 0.8868231773376465
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7714724540710449
Epoch: 13, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.552 Vali Acc: 0.826 Test Loss: 0.552 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7066149711608887
Epoch: 14, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.539 Vali Acc: 0.826 Test Loss: 0.539 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8463304042816162
Epoch: 15, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.780329704284668
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.844611406326294
Epoch: 17, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7007858753204346
Epoch: 18, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8465242385864258
Epoch: 19, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7543556690216064
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7934722900390625
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 62080
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.757099151611328
Epoch: 1, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.293 Vali Acc: 0.355 Test Loss: 1.293 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 0.7924489974975586
Epoch: 2, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.179 Vali Acc: 0.543 Test Loss: 1.179 Test Acc: 0.543
Validation loss decreased (-0.355060 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.8351349830627441
Epoch: 3, Steps: 9 | Train Loss: 1.096 Vali Loss: 1.063 Vali Acc: 0.630 Test Loss: 1.063 Test Acc: 0.630
Validation loss decreased (-0.543466 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 0.7264378070831299
Epoch: 4, Steps: 9 | Train Loss: 0.923 Vali Loss: 0.962 Vali Acc: 0.703 Test Loss: 0.962 Test Acc: 0.703
Validation loss decreased (-0.630424 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 0.9351081848144531
Epoch: 5, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
Validation loss decreased (-0.702889 --> -0.746368).  Saving model ...
Epoch: 6 cost time: 0.7741551399230957
Epoch: 6, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.784 Vali Acc: 0.804 Test Loss: 0.784 Test Acc: 0.804
Validation loss decreased (-0.746368 --> -0.804340).  Saving model ...
Epoch: 7 cost time: 0.7182581424713135
Epoch: 7, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.715 Vali Acc: 0.790 Test Loss: 0.715 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7783169746398926
Epoch: 8, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.9342808723449707
Epoch: 9, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855066).  Saving model ...
Epoch: 10 cost time: 0.7983005046844482
Epoch: 10, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8824965953826904
Epoch: 11, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 0.744673490524292
Epoch: 12, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.9190182685852051
Epoch: 13, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7190225124359131
Epoch: 14, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 15 cost time: 0.7298645973205566
Epoch: 15, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7718324661254883
Epoch: 16, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7700095176696777
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 18 cost time: 0.7092840671539307
Epoch: 18, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.848 Test Loss: 0.492 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7951436042785645
Epoch: 19, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6974151134490967
Epoch: 20, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7501306533813477
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7924895286560059
Epoch: 22, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7277193069458008
Epoch: 23, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8725643157958984
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7491669654846191
Epoch: 25, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7895510196685791
Epoch: 26, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8462944030761719
Epoch: 27, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 62080
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4923040866851807
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.287 Vali Acc: 0.420 Test Loss: 1.287 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.8115782737731934
Epoch: 2, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.168 Vali Acc: 0.601 Test Loss: 1.168 Test Acc: 0.601
Validation loss decreased (-0.420277 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 0.7693712711334229
Epoch: 3, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.045 Vali Acc: 0.609 Test Loss: 1.045 Test Acc: 0.609
Validation loss decreased (-0.601438 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 0.8155391216278076
Epoch: 4, Steps: 9 | Train Loss: 0.902 Vali Loss: 0.940 Vali Acc: 0.674 Test Loss: 0.940 Test Acc: 0.674
Validation loss decreased (-0.608685 --> -0.673904).  Saving model ...
Epoch: 5 cost time: 0.7973616123199463
Epoch: 5, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.673904 --> -0.775354).  Saving model ...
Epoch: 6 cost time: 0.8519096374511719
Epoch: 6, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.774 Vali Acc: 0.804 Test Loss: 0.774 Test Acc: 0.804
Validation loss decreased (-0.775354 --> -0.804340).  Saving model ...
Epoch: 7 cost time: 0.9183914661407471
Epoch: 7, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.709 Vali Acc: 0.812 Test Loss: 0.709 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 8 cost time: 0.7334282398223877
Epoch: 8, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.942023515701294
Epoch: 9, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.611 Vali Acc: 0.848 Test Loss: 0.611 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 10 cost time: 0.7644481658935547
Epoch: 10, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7896397113800049
Epoch: 11, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.562 Vali Acc: 0.848 Test Loss: 0.562 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 0.7108585834503174
Epoch: 12, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.7075009346008301
Epoch: 13, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.541 Vali Acc: 0.848 Test Loss: 0.541 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7652277946472168
Epoch: 14, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7665023803710938
Epoch: 15, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8428161144256592
Epoch: 16, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8120038509368896
Epoch: 17, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8283121585845947
Epoch: 18, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7535419464111328
Epoch: 19, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8614733219146729
Epoch: 20, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8618848323822021
Epoch: 21, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7887067794799805
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 62080
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.546966314315796
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.329 Vali Acc: 0.304 Test Loss: 1.329 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 0.7923009395599365
Epoch: 2, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.304335 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 0.8624083995819092
Epoch: 3, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.129 Vali Acc: 0.601 Test Loss: 1.129 Test Acc: 0.601
Validation loss decreased (-0.485495 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 0.7944011688232422
Epoch: 4, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.019 Vali Acc: 0.659 Test Loss: 1.019 Test Acc: 0.659
Validation loss decreased (-0.601438 --> -0.659410).  Saving model ...
Epoch: 5 cost time: 0.8497986793518066
Epoch: 5, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.931 Vali Acc: 0.681 Test Loss: 0.931 Test Acc: 0.681
Validation loss decreased (-0.659410 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 0.8738338947296143
Epoch: 6, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.844 Vali Acc: 0.703 Test Loss: 0.844 Test Acc: 0.703
Validation loss decreased (-0.681150 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 0.7966065406799316
Epoch: 7, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.769 Vali Acc: 0.754 Test Loss: 0.769 Test Acc: 0.754
Validation loss decreased (-0.702890 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 0.7533984184265137
Epoch: 8, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 0.7137124538421631
Epoch: 9, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 0.71150803565979
Epoch: 10, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 0.6616759300231934
Epoch: 11, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 0.8524272441864014
Epoch: 12, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 0.7648377418518066
Epoch: 13, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.576 Vali Acc: 0.797 Test Loss: 0.576 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7269003391265869
Epoch: 14, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.681323766708374
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 0.7913415431976318
Epoch: 16, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.567 Vali Acc: 0.804 Test Loss: 0.567 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.767876148223877
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.564 Vali Acc: 0.790 Test Loss: 0.564 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7831358909606934
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.554 Vali Acc: 0.804 Test Loss: 0.554 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8052318096160889
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8023505210876465
Epoch: 20, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8693368434906006
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.558 Vali Acc: 0.797 Test Loss: 0.558 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8391103744506836
Epoch: 22, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8024017810821533
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.560 Vali Acc: 0.804 Test Loss: 0.560 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8189494609832764
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.574 Vali Acc: 0.797 Test Loss: 0.574 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7388396263122559
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.576 Vali Acc: 0.790 Test Loss: 0.576 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 45696
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.616354465484619
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.322 Vali Acc: 0.312 Test Loss: 1.322 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.8028368949890137
Epoch: 2, Steps: 9 | Train Loss: 1.260 Vali Loss: 1.231 Vali Acc: 0.551 Test Loss: 1.231 Test Acc: 0.551
Validation loss decreased (-0.311581 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 0.7970960140228271
Epoch: 3, Steps: 9 | Train Loss: 1.130 Vali Loss: 1.123 Vali Acc: 0.630 Test Loss: 1.123 Test Acc: 0.630
Validation loss decreased (-0.550712 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 0.7461273670196533
Epoch: 4, Steps: 9 | Train Loss: 0.943 Vali Loss: 1.009 Vali Acc: 0.703 Test Loss: 1.009 Test Acc: 0.703
Validation loss decreased (-0.630424 --> -0.702888).  Saving model ...
Epoch: 5 cost time: 0.9436535835266113
Epoch: 5, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.922 Vali Acc: 0.688 Test Loss: 0.922 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8441777229309082
Epoch: 6, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.836 Vali Acc: 0.746 Test Loss: 0.836 Test Acc: 0.746
Validation loss decreased (-0.702888 --> -0.746368).  Saving model ...
Epoch: 7 cost time: 0.9175562858581543
Epoch: 7, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.763 Vali Acc: 0.768 Test Loss: 0.763 Test Acc: 0.768
Validation loss decreased (-0.746368 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 0.7785041332244873
Epoch: 8, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
Validation loss decreased (-0.768108 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 0.84916090965271
Epoch: 9, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.673 Vali Acc: 0.797 Test Loss: 0.673 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 0.8915817737579346
Epoch: 10, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 0.9338827133178711
Epoch: 11, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 0.8504970073699951
Epoch: 12, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.9082791805267334
Epoch: 13, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 0.9852504730224609
Epoch: 14, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 0.8751161098480225
Epoch: 15, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8499274253845215
Epoch: 16, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9107370376586914
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9465515613555908
Epoch: 18, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.543 Vali Acc: 0.797 Test Loss: 0.543 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0141985416412354
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.797 Test Loss: 0.545 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8602867126464844
Epoch: 20, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.557 Vali Acc: 0.790 Test Loss: 0.557 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9057624340057373
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.797 Test Loss: 0.545 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9269289970397949
Epoch: 22, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.797 Test Loss: 0.543 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.099280834197998
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.543 Vali Acc: 0.797 Test Loss: 0.543 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9100794792175293
Epoch: 24, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 45696
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8482718467712402
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.310 Vali Acc: 0.406 Test Loss: 1.310 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.7709619998931885
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.216 Vali Acc: 0.565 Test Loss: 1.216 Test Acc: 0.565
Validation loss decreased (-0.405784 --> -0.565205).  Saving model ...
Epoch: 3 cost time: 0.6615374088287354
Epoch: 3, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.106 Vali Acc: 0.616 Test Loss: 1.106 Test Acc: 0.616
Validation loss decreased (-0.565205 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.7305655479431152
Epoch: 4, Steps: 9 | Train Loss: 0.955 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.615931 --> -0.724628).  Saving model ...
Epoch: 5 cost time: 0.7508573532104492
Epoch: 5, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.903 Vali Acc: 0.732 Test Loss: 0.903 Test Acc: 0.732
Validation loss decreased (-0.724628 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 0.7191486358642578
Epoch: 6, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.822 Vali Acc: 0.761 Test Loss: 0.822 Test Acc: 0.761
Validation loss decreased (-0.731875 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 0.735297441482544
Epoch: 7, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.753 Vali Acc: 0.746 Test Loss: 0.753 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6928048133850098
Epoch: 8, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
Validation loss decreased (-0.760861 --> -0.775355).  Saving model ...
Epoch: 9 cost time: 0.7907416820526123
Epoch: 9, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 0.7380852699279785
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 0.7286961078643799
Epoch: 11, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7220883369445801
Epoch: 12, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 0.8087418079376221
Epoch: 13, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 0.836785078048706
Epoch: 14, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.551 Vali Acc: 0.790 Test Loss: 0.551 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8128905296325684
Epoch: 15, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.541 Vali Acc: 0.804 Test Loss: 0.541 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9074242115020752
Epoch: 16, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 17 cost time: 0.7589676380157471
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.538 Vali Acc: 0.804 Test Loss: 0.538 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8686404228210449
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8046977519989014
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9555838108062744
Epoch: 20, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8449394702911377
Epoch: 21, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8223097324371338
Epoch: 22, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7814502716064453
Epoch: 23, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8118181228637695
Epoch: 24, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.812145471572876
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8412585258483887
Epoch: 26, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 45696
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.5005605220794678
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.281 Vali Acc: 0.478 Test Loss: 1.281 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 0.7746737003326416
Epoch: 2, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.176 Vali Acc: 0.594 Test Loss: 1.176 Test Acc: 0.594
Validation loss decreased (-0.478248 --> -0.594191).  Saving model ...
Epoch: 3 cost time: 0.7967820167541504
Epoch: 3, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.064 Vali Acc: 0.609 Test Loss: 1.064 Test Acc: 0.609
Validation loss decreased (-0.594191 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 0.8127593994140625
Epoch: 4, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
Validation loss decreased (-0.608685 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 0.7651729583740234
Epoch: 5, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.861 Vali Acc: 0.768 Test Loss: 0.861 Test Acc: 0.768
Validation loss decreased (-0.717382 --> -0.768107).  Saving model ...
Epoch: 6 cost time: 0.8030250072479248
Epoch: 6, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.787 Vali Acc: 0.804 Test Loss: 0.787 Test Acc: 0.804
Validation loss decreased (-0.768107 --> -0.804340).  Saving model ...
Epoch: 7 cost time: 0.706963300704956
Epoch: 7, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.724 Vali Acc: 0.804 Test Loss: 0.724 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.7687411308288574
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.668 Vali Acc: 0.841 Test Loss: 0.668 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.7109739780426025
Epoch: 9, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8713748455047607
Epoch: 10, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.597 Vali Acc: 0.826 Test Loss: 0.597 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8200159072875977
Epoch: 11, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7881321907043457
Epoch: 12, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.8943791389465332
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 0.8597207069396973
Epoch: 14, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.828057050704956
Epoch: 15, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 0.8040399551391602
Epoch: 16, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8887982368469238
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7926535606384277
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8184123039245605
Epoch: 19, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.798274040222168
Epoch: 20, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7867319583892822
Epoch: 21, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7670502662658691
Epoch: 22, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8040075302124023
Epoch: 23, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7674503326416016
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8304903507232666
Epoch: 25, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 45696
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.447157144546509
Epoch: 1, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.347 Vali Acc: 0.413 Test Loss: 1.347 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.8088381290435791
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.249 Vali Acc: 0.449 Test Loss: 1.249 Test Acc: 0.449
Validation loss decreased (-0.413030 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.8580656051635742
Epoch: 3, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.136 Vali Acc: 0.601 Test Loss: 1.136 Test Acc: 0.601
Validation loss decreased (-0.449263 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 0.9011445045471191
Epoch: 4, Steps: 9 | Train Loss: 0.966 Vali Loss: 1.024 Vali Acc: 0.674 Test Loss: 1.024 Test Acc: 0.674
Validation loss decreased (-0.601438 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 0.7950291633605957
Epoch: 5, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.935 Vali Acc: 0.681 Test Loss: 0.935 Test Acc: 0.681
Validation loss decreased (-0.673903 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 0.7847561836242676
Epoch: 6, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.843 Vali Acc: 0.710 Test Loss: 0.843 Test Acc: 0.710
Validation loss decreased (-0.681150 --> -0.710136).  Saving model ...
Epoch: 7 cost time: 0.7572710514068604
Epoch: 7, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.771 Vali Acc: 0.754 Test Loss: 0.771 Test Acc: 0.754
Validation loss decreased (-0.710136 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 0.7543070316314697
Epoch: 8, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.713 Vali Acc: 0.790 Test Loss: 0.713 Test Acc: 0.790
Validation loss decreased (-0.753615 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 0.7639033794403076
Epoch: 9, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.666 Vali Acc: 0.790 Test Loss: 0.666 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 0.7667331695556641
Epoch: 10, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.807509183883667
Epoch: 11, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 0.7682363986968994
Epoch: 12, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.595 Vali Acc: 0.797 Test Loss: 0.595 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8889365196228027
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.573 Vali Acc: 0.797 Test Loss: 0.573 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7905428409576416
Epoch: 14, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.571 Vali Acc: 0.797 Test Loss: 0.571 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7801933288574219
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.572 Vali Acc: 0.797 Test Loss: 0.572 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8522069454193115
Epoch: 16, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8536829948425293
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 18 cost time: 0.856330394744873
Epoch: 18, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.564 Vali Acc: 0.797 Test Loss: 0.564 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8528902530670166
Epoch: 19, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.569 Vali Acc: 0.804 Test Loss: 0.569 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8857419490814209
Epoch: 20, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 21 cost time: 0.8120148181915283
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.553 Vali Acc: 0.790 Test Loss: 0.553 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8694159984588623
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7560970783233643
Epoch: 23, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7811152935028076
Epoch: 24, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7512664794921875
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.813931941986084
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7154061794281006
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.564 Vali Acc: 0.790 Test Loss: 0.564 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7320530414581299
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.569 Vali Acc: 0.790 Test Loss: 0.569 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7655854225158691
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6958503723144531
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.573 Vali Acc: 0.797 Test Loss: 0.573 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 37504
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.6918065547943115
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.332 Vali Acc: 0.413 Test Loss: 1.332 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 0.8232433795928955
Epoch: 2, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.231 Vali Acc: 0.457 Test Loss: 1.231 Test Acc: 0.457
Validation loss decreased (-0.413030 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 0.8543274402618408
Epoch: 3, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.116 Vali Acc: 0.587 Test Loss: 1.116 Test Acc: 0.587
Validation loss decreased (-0.456509 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 0.8624026775360107
Epoch: 4, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.005 Vali Acc: 0.652 Test Loss: 1.005 Test Acc: 0.652
Validation loss decreased (-0.586945 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 0.8145403861999512
Epoch: 5, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.916 Vali Acc: 0.696 Test Loss: 0.916 Test Acc: 0.696
Validation loss decreased (-0.652164 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 0.763908863067627
Epoch: 6, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.827 Vali Acc: 0.725 Test Loss: 0.827 Test Acc: 0.725
Validation loss decreased (-0.695643 --> -0.724629).  Saving model ...
Epoch: 7 cost time: 0.7912826538085938
Epoch: 7, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
Validation loss decreased (-0.724629 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 0.7526628971099854
Epoch: 8, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.695 Vali Acc: 0.790 Test Loss: 0.695 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 0.804832935333252
Epoch: 9, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.8776042461395264
Epoch: 10, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.617 Vali Acc: 0.790 Test Loss: 0.617 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8003997802734375
Epoch: 11, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8157031536102295
Epoch: 12, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8084402084350586
Epoch: 13, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8067691326141357
Epoch: 14, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8227756023406982
Epoch: 15, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8127202987670898
Epoch: 16, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.558 Vali Acc: 0.790 Test Loss: 0.558 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8916506767272949
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8018805980682373
Epoch: 18, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.544 Vali Acc: 0.775 Test Loss: 0.544 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7456731796264648
Epoch: 19, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 37504
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.731642723083496
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.320 Vali Acc: 0.420 Test Loss: 1.320 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 0.8051660060882568
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.220 Vali Acc: 0.493 Test Loss: 1.220 Test Acc: 0.493
Validation loss decreased (-0.420277 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 0.8258519172668457
Epoch: 3, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.104 Vali Acc: 0.565 Test Loss: 1.104 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 0.8294157981872559
Epoch: 4, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.990 Vali Acc: 0.667 Test Loss: 0.990 Test Acc: 0.667
Validation loss decreased (-0.565206 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.83394455909729
Epoch: 5, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.901 Vali Acc: 0.710 Test Loss: 0.901 Test Acc: 0.710
Validation loss decreased (-0.666657 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 0.9409701824188232
Epoch: 6, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
Validation loss decreased (-0.710136 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 0.8973982334136963
Epoch: 7, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.745 Vali Acc: 0.768 Test Loss: 0.745 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 0.9087262153625488
Epoch: 8, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.684 Vali Acc: 0.797 Test Loss: 0.684 Test Acc: 0.797
Validation loss decreased (-0.768108 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 0.8263266086578369
Epoch: 9, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 0.8970162868499756
Epoch: 10, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.611 Vali Acc: 0.819 Test Loss: 0.611 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 0.90460205078125
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 0.8893935680389404
Epoch: 12, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 0.7945551872253418
Epoch: 13, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 0.9057567119598389
Epoch: 14, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 0.8544211387634277
Epoch: 15, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8156449794769287
Epoch: 16, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.902667760848999
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9218990802764893
Epoch: 18, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8898279666900635
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.540 Vali Acc: 0.797 Test Loss: 0.540 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8272650241851807
Epoch: 20, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 21 cost time: 0.8064885139465332
Epoch: 21, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.517 Vali Acc: 0.797 Test Loss: 0.517 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8790481090545654
Epoch: 22, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8440606594085693
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7841320037841797
Epoch: 24, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9000105857849121
Epoch: 25, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.519 Vali Acc: 0.804 Test Loss: 0.519 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0007216930389404
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.522 Vali Acc: 0.790 Test Loss: 0.522 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7124760150909424
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 28 cost time: 0.8576657772064209
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9042727947235107
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.511 Vali Acc: 0.790 Test Loss: 0.511 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8128762245178223
Epoch: 30, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.866278886795044
Epoch: 31, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 32 cost time: 0.8550193309783936
Epoch: 32, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8650543689727783
Epoch: 33, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.804 Test Loss: 0.512 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8505840301513672
Epoch: 34, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8738055229187012
Epoch: 35, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9120993614196777
Epoch: 36, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.529 Vali Acc: 0.804 Test Loss: 0.529 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.836294412612915
Epoch: 37, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8290057182312012
Epoch: 38, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.518 Vali Acc: 0.804 Test Loss: 0.518 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0390305519104004
Epoch: 39, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8624715805053711
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8918344974517822
Epoch: 41, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 37504
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.279308319091797
Epoch: 1, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.7958250045776367
Epoch: 2, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.182 Vali Acc: 0.572 Test Loss: 1.182 Test Acc: 0.572
Validation loss decreased (-0.499987 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 0.7424325942993164
Epoch: 3, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.064 Vali Acc: 0.616 Test Loss: 1.064 Test Acc: 0.616
Validation loss decreased (-0.572452 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.7866401672363281
Epoch: 4, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.950 Vali Acc: 0.710 Test Loss: 0.950 Test Acc: 0.710
Validation loss decreased (-0.615931 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 0.7436044216156006
Epoch: 5, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.862 Vali Acc: 0.761 Test Loss: 0.862 Test Acc: 0.761
Validation loss decreased (-0.710135 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.770606517791748
Epoch: 6, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
Validation loss decreased (-0.760861 --> -0.782601).  Saving model ...
Epoch: 7 cost time: 0.7962737083435059
Epoch: 7, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.714 Vali Acc: 0.804 Test Loss: 0.714 Test Acc: 0.804
Validation loss decreased (-0.782601 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 0.808246374130249
Epoch: 8, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 0.943228006362915
Epoch: 9, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8138623237609863
Epoch: 10, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 0.9520056247711182
Epoch: 11, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 0.8704533576965332
Epoch: 12, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 0.8817942142486572
Epoch: 13, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8403842449188232
Epoch: 14, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 15 cost time: 1.0293605327606201
Epoch: 15, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 0.8388431072235107
Epoch: 16, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9106991291046143
Epoch: 17, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9761714935302734
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8557193279266357
Epoch: 19, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.520 Vali Acc: 0.804 Test Loss: 0.520 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1000676155090332
Epoch: 20, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9548134803771973
Epoch: 21, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 22 cost time: 0.8493504524230957
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9363529682159424
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 24 cost time: 0.803825855255127
Epoch: 24, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.493 Vali Acc: 0.812 Test Loss: 0.493 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9060866832733154
Epoch: 25, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.490 Vali Acc: 0.812 Test Loss: 0.490 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.041560173034668
Epoch: 26, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8388934135437012
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.482 Vali Acc: 0.819 Test Loss: 0.482 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7708930969238281
Epoch: 28, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.482 Vali Acc: 0.819 Test Loss: 0.482 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7778472900390625
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.472 Vali Acc: 0.812 Test Loss: 0.472 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7585265636444092
Epoch: 30, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8224868774414062
Epoch: 31, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8219583034515381
Epoch: 32, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8407332897186279
Epoch: 33, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.457 Vali Acc: 0.812 Test Loss: 0.457 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 37504
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.683091163635254
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.334 Vali Acc: 0.377 Test Loss: 1.334 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 0.9480314254760742
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.376798 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 0.8685107231140137
Epoch: 3, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.095 Vali Acc: 0.616 Test Loss: 1.095 Test Acc: 0.616
Validation loss decreased (-0.514481 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.8570067882537842
Epoch: 4, Steps: 9 | Train Loss: 0.963 Vali Loss: 0.991 Vali Acc: 0.696 Test Loss: 0.991 Test Acc: 0.696
Validation loss decreased (-0.615931 --> -0.695642).  Saving model ...
Epoch: 5 cost time: 0.9444770812988281
Epoch: 5, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.903 Vali Acc: 0.754 Test Loss: 0.903 Test Acc: 0.754
Validation loss decreased (-0.695642 --> -0.753614).  Saving model ...
Epoch: 6 cost time: 0.8960452079772949
Epoch: 6, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1573739051818848
Epoch: 7, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.753614 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 0.9814691543579102
Epoch: 8, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.672 Vali Acc: 0.812 Test Loss: 0.672 Test Acc: 0.812
Validation loss decreased (-0.782601 --> -0.811587).  Saving model ...
Epoch: 9 cost time: 0.8269433975219727
Epoch: 9, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 0.9252092838287354
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 0.7849757671356201
Epoch: 11, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8243405818939209
Epoch: 12, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 0.7801637649536133
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.540 Vali Acc: 0.804 Test Loss: 0.540 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8167212009429932
Epoch: 14, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8458383083343506
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8319063186645508
Epoch: 16, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 0.8164727687835693
Epoch: 17, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8378586769104004
Epoch: 18, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.519 Vali Acc: 0.804 Test Loss: 0.519 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8280272483825684
Epoch: 19, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8412196636199951
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8299915790557861
Epoch: 21, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7244024276733398
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8911683559417725
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.520 Vali Acc: 0.804 Test Loss: 0.520 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8866767883300781
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9239864349365234
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9348165988922119
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 33408
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.647867441177368
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.334 Vali Acc: 0.283 Test Loss: 1.334 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.8899927139282227
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.211 Vali Acc: 0.543 Test Loss: 1.211 Test Acc: 0.543
Validation loss decreased (-0.282595 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.8626000881195068
Epoch: 3, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.094 Vali Acc: 0.601 Test Loss: 1.094 Test Acc: 0.601
Validation loss decreased (-0.543466 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 0.8036768436431885
Epoch: 4, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.988 Vali Acc: 0.674 Test Loss: 0.988 Test Acc: 0.674
Validation loss decreased (-0.601438 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 0.8322916030883789
Epoch: 5, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
Validation loss decreased (-0.673903 --> -0.724629).  Saving model ...
Epoch: 6 cost time: 0.8843259811401367
Epoch: 6, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.814 Vali Acc: 0.739 Test Loss: 0.814 Test Acc: 0.739
Validation loss decreased (-0.724629 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 0.8776566982269287
Epoch: 7, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.743 Vali Acc: 0.804 Test Loss: 0.743 Test Acc: 0.804
Validation loss decreased (-0.739122 --> -0.804340).  Saving model ...
Epoch: 8 cost time: 0.7848103046417236
Epoch: 8, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
Validation loss decreased (-0.804340 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.7342333793640137
Epoch: 9, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9533703327178955
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9030072689056396
Epoch: 11, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7872450351715088
Epoch: 12, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8070933818817139
Epoch: 13, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9155504703521729
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.542 Vali Acc: 0.797 Test Loss: 0.542 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9016022682189941
Epoch: 15, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7791457176208496
Epoch: 16, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.807546854019165
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7609841823577881
Epoch: 18, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 33408
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.614393472671509
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.343 Vali Acc: 0.326 Test Loss: 1.343 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 0.7940549850463867
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.215 Vali Acc: 0.565 Test Loss: 1.215 Test Acc: 0.565
Validation loss decreased (-0.326074 --> -0.565205).  Saving model ...
Epoch: 3 cost time: 0.8153655529022217
Epoch: 3, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.092 Vali Acc: 0.616 Test Loss: 1.092 Test Acc: 0.616
Validation loss decreased (-0.565205 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 0.8146677017211914
Epoch: 4, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.982 Vali Acc: 0.696 Test Loss: 0.982 Test Acc: 0.696
Validation loss decreased (-0.615931 --> -0.695642).  Saving model ...
Epoch: 5 cost time: 0.8683023452758789
Epoch: 5, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.895 Vali Acc: 0.761 Test Loss: 0.895 Test Acc: 0.761
Validation loss decreased (-0.695642 --> -0.760861).  Saving model ...
Epoch: 6 cost time: 0.86761474609375
Epoch: 6, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.803 Vali Acc: 0.746 Test Loss: 0.803 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9134066104888916
Epoch: 7, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.728 Vali Acc: 0.819 Test Loss: 0.728 Test Acc: 0.819
Validation loss decreased (-0.760861 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.778393030166626
Epoch: 8, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.659 Vali Acc: 0.841 Test Loss: 0.659 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840573).  Saving model ...
Epoch: 9 cost time: 0.8150897026062012
Epoch: 9, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8444509506225586
Epoch: 10, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.863999605178833
Epoch: 11, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7736694812774658
Epoch: 12, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 0.7701144218444824
Epoch: 13, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7499196529388428
Epoch: 14, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7824611663818359
Epoch: 15, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7581839561462402
Epoch: 16, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 17 cost time: 0.700714111328125
Epoch: 17, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7698266506195068
Epoch: 18, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7843291759490967
Epoch: 19, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.721017599105835
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7736620903015137
Epoch: 21, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7754135131835938
Epoch: 22, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.863476037979126
Epoch: 23, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8393411636352539
Epoch: 24, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8645079135894775
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8531699180603027
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 33408
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.4830024242401123
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.343 Vali Acc: 0.326 Test Loss: 1.343 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 0.7457427978515625
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.207 Vali Acc: 0.594 Test Loss: 1.207 Test Acc: 0.594
Validation loss decreased (-0.326074 --> -0.594191).  Saving model ...
Epoch: 3 cost time: 0.736691951751709
Epoch: 3, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.073 Vali Acc: 0.623 Test Loss: 1.073 Test Acc: 0.623
Validation loss decreased (-0.594191 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.7985243797302246
Epoch: 4, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.959 Vali Acc: 0.652 Test Loss: 0.959 Test Acc: 0.652
Validation loss decreased (-0.623178 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 0.7538089752197266
Epoch: 5, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.652164 --> -0.775354).  Saving model ...
Epoch: 6 cost time: 0.7727184295654297
Epoch: 6, Steps: 9 | Train Loss: 0.668 Vali Loss: 0.783 Vali Acc: 0.797 Test Loss: 0.783 Test Acc: 0.797
Validation loss decreased (-0.775354 --> -0.797094).  Saving model ...
Epoch: 7 cost time: 0.7283275127410889
Epoch: 7, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818833).  Saving model ...
Epoch: 8 cost time: 0.7698192596435547
Epoch: 8, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.648 Vali Acc: 0.862 Test Loss: 0.648 Test Acc: 0.862
Validation loss decreased (-0.818833 --> -0.862312).  Saving model ...
Epoch: 9 cost time: 0.7933361530303955
Epoch: 9, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7011833190917969
Epoch: 10, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7602193355560303
Epoch: 11, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7374820709228516
Epoch: 12, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7434518337249756
Epoch: 13, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7802591323852539
Epoch: 14, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7642111778259277
Epoch: 15, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8015046119689941
Epoch: 16, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7744338512420654
Epoch: 17, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6739137172698975
Epoch: 18, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.484 Vali Acc: 0.848 Test Loss: 0.484 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_ETSformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 33408
model size : 0.75MB
