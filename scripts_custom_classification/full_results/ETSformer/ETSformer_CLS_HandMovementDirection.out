Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.959268808364868
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.309 Vali Acc: 0.378 Test Loss: 1.309 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 3.0201194286346436
Epoch: 2, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.170 Vali Acc: 0.514 Test Loss: 1.170 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513502).  Saving model ...
Epoch: 3 cost time: 2.7756922245025635
Epoch: 3, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.372 Vali Acc: 0.541 Test Loss: 1.372 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540527).  Saving model ...
Epoch: 4 cost time: 2.845691204071045
Epoch: 4, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2280731201171875
Epoch: 5, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.894 Vali Acc: 0.514 Test Loss: 1.894 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1289448738098145
Epoch: 6, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.132 Vali Acc: 0.514 Test Loss: 2.132 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3266780376434326
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.738 Vali Acc: 0.419 Test Loss: 3.738 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.153618574142456
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.190 Vali Acc: 0.527 Test Loss: 3.190 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0736465454101562
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.198 Vali Acc: 0.608 Test Loss: 3.198 Test Acc: 0.608
Validation loss decreased (-0.540527 --> -0.608076).  Saving model ...
Epoch: 10 cost time: 2.9845454692840576
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 4.175 Vali Acc: 0.500 Test Loss: 4.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4188852310180664
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.758 Vali Acc: 0.500 Test Loss: 4.758 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1386666297912598
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.369 Vali Acc: 0.527 Test Loss: 4.369 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4230306148529053
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 5.322 Vali Acc: 0.459 Test Loss: 5.322 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1165547370910645
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.817 Vali Acc: 0.500 Test Loss: 4.817 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.515512228012085
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.289 Vali Acc: 0.446 Test Loss: 4.289 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8428008556365967
Epoch: 16, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.668 Vali Acc: 0.568 Test Loss: 4.668 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.399501323699951
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.887 Vali Acc: 0.541 Test Loss: 4.887 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.989530324935913
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.577 Vali Acc: 0.514 Test Loss: 4.577 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8928208351135254
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 6.145 Vali Acc: 0.473 Test Loss: 6.145 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 6108276
model size : 33.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.382567882537842
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.361 Vali Acc: 0.405 Test Loss: 1.361 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 3.394388198852539
Epoch: 2, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.403635025024414
Epoch: 3, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 3.0128273963928223
Epoch: 4, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.676 Vali Acc: 0.473 Test Loss: 1.676 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4963581562042236
Epoch: 5, Steps: 10 | Train Loss: 0.172 Vali Loss: 2.352 Vali Acc: 0.432 Test Loss: 2.352 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.208160877227783
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.658 Vali Acc: 0.459 Test Loss: 2.658 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.08880877494812
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.399 Vali Acc: 0.365 Test Loss: 3.399 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0130045413970947
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.529 Vali Acc: 0.297 Test Loss: 4.529 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0636584758758545
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.236 Vali Acc: 0.486 Test Loss: 3.236 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3140170574188232
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.635 Vali Acc: 0.459 Test Loss: 3.635 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1248066425323486
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.772 Vali Acc: 0.432 Test Loss: 3.772 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7411234378814697
Epoch: 12, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.529 Vali Acc: 0.473 Test Loss: 3.529 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8440146446228027
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.249 Vali Acc: 0.514 Test Loss: 4.249 Test Acc: 0.514
Validation loss decreased (-0.499986 --> -0.513471).  Saving model ...
Epoch: 14 cost time: 2.968864679336548
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.325 Vali Acc: 0.473 Test Loss: 4.325 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.256946563720703
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.428 Vali Acc: 0.432 Test Loss: 5.428 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.077012300491333
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.347 Vali Acc: 0.541 Test Loss: 5.347 Test Acc: 0.541
Validation loss decreased (-0.513471 --> -0.540487).  Saving model ...
Epoch: 17 cost time: 3.0356879234313965
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.302 Vali Acc: 0.541 Test Loss: 4.302 Test Acc: 0.541
Validation loss decreased (-0.540487 --> -0.540498).  Saving model ...
Epoch: 18 cost time: 2.745450973510742
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.415 Vali Acc: 0.500 Test Loss: 4.415 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.844536066055298
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 5.066 Vali Acc: 0.568 Test Loss: 5.066 Test Acc: 0.568
Validation loss decreased (-0.540498 --> -0.567517).  Saving model ...
Epoch: 20 cost time: 2.4675357341766357
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 5.333 Vali Acc: 0.527 Test Loss: 5.333 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5487825870513916
Epoch: 21, Steps: 10 | Train Loss: 0.204 Vali Loss: 7.996 Vali Acc: 0.392 Test Loss: 7.996 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.690960168838501
Epoch: 22, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.432 Vali Acc: 0.446 Test Loss: 5.432 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.786107063293457
Epoch: 23, Steps: 10 | Train Loss: 0.252 Vali Loss: 5.352 Vali Acc: 0.514 Test Loss: 5.352 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8729734420776367
Epoch: 24, Steps: 10 | Train Loss: 0.241 Vali Loss: 5.879 Vali Acc: 0.541 Test Loss: 5.879 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.851644992828369
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 7.148 Vali Acc: 0.500 Test Loss: 7.148 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.212977647781372
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 6.540 Vali Acc: 0.541 Test Loss: 6.540 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2963504791259766
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 10.384 Vali Acc: 0.378 Test Loss: 10.384 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.458559513092041
Epoch: 28, Steps: 10 | Train Loss: 0.130 Vali Loss: 7.908 Vali Acc: 0.486 Test Loss: 7.908 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.384871006011963
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 8.185 Vali Acc: 0.486 Test Loss: 8.185 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 6108276
model size : 33.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.039516925811768
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.384 Vali Acc: 0.365 Test Loss: 1.384 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.509061336517334
Epoch: 2, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.276 Vali Acc: 0.486 Test Loss: 1.276 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 2.8190910816192627
Epoch: 3, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 2.9761571884155273
Epoch: 4, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.671 Vali Acc: 0.473 Test Loss: 1.671 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1487021446228027
Epoch: 5, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.889 Vali Acc: 0.486 Test Loss: 1.889 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4728639125823975
Epoch: 6, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.369 Vali Acc: 0.459 Test Loss: 2.369 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4197261333465576
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.566 Vali Acc: 0.405 Test Loss: 2.566 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.461111307144165
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.672 Vali Acc: 0.554 Test Loss: 2.672 Test Acc: 0.554
Validation loss decreased (-0.499986 --> -0.554027).  Saving model ...
Epoch: 9 cost time: 2.434791326522827
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.713 Vali Acc: 0.473 Test Loss: 3.713 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.096881866455078
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.571 Vali Acc: 0.446 Test Loss: 3.571 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0928165912628174
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.576 Vali Acc: 0.432 Test Loss: 4.576 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7820048332214355
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.374 Vali Acc: 0.432 Test Loss: 3.374 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0906054973602295
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.427 Vali Acc: 0.473 Test Loss: 4.427 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1873137950897217
Epoch: 14, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.068 Vali Acc: 0.500 Test Loss: 4.068 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4730794429779053
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.446 Vali Acc: 0.405 Test Loss: 4.446 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.5630340576171875
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.489 Vali Acc: 0.514 Test Loss: 4.489 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3586127758026123
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.954 Vali Acc: 0.378 Test Loss: 5.954 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7434542179107666
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.400 Vali Acc: 0.554 Test Loss: 4.400 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 6108276
model size : 33.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.901921987533569
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.428 Vali Acc: 0.311 Test Loss: 1.428 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.0296249389648438
Epoch: 2, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.371 Vali Acc: 0.432 Test Loss: 1.371 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 3.051206350326538
Epoch: 3, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 2.3948302268981934
Epoch: 4, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.403 Vali Acc: 0.419 Test Loss: 1.403 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8480215072631836
Epoch: 5, Steps: 10 | Train Loss: 0.096 Vali Loss: 2.065 Vali Acc: 0.473 Test Loss: 2.065 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9598073959350586
Epoch: 6, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.791 Vali Acc: 0.446 Test Loss: 1.791 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9447951316833496
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.067 Vali Acc: 0.459 Test Loss: 2.067 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3697290420532227
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.186 Vali Acc: 0.486 Test Loss: 2.186 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.095494270324707
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.376 Vali Acc: 0.432 Test Loss: 2.376 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9563865661621094
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.307 Vali Acc: 0.432 Test Loss: 3.307 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1083285808563232
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.102 Vali Acc: 0.500 Test Loss: 3.102 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1574087142944336
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.262 Vali Acc: 0.405 Test Loss: 3.262 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0760416984558105
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.537 Vali Acc: 0.365 Test Loss: 3.537 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 6108276
model size : 33.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.686725616455078
Epoch: 1, Steps: 10 | Train Loss: 1.549 Vali Loss: 1.410 Vali Acc: 0.378 Test Loss: 1.410 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 3.2399141788482666
Epoch: 2, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.378364 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 3.0069472789764404
Epoch: 3, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527012).  Saving model ...
Epoch: 4 cost time: 3.3057329654693604
Epoch: 4, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.587 Vali Acc: 0.514 Test Loss: 1.587 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.07256817817688
Epoch: 5, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.447 Vali Acc: 0.365 Test Loss: 3.447 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5573532581329346
Epoch: 6, Steps: 10 | Train Loss: 0.177 Vali Loss: 2.378 Vali Acc: 0.473 Test Loss: 2.378 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.550706624984741
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.501 Vali Acc: 0.527 Test Loss: 2.501 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0573883056640625
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.414 Vali Acc: 0.608 Test Loss: 2.414 Test Acc: 0.608
Validation loss decreased (-0.527012 --> -0.608084).  Saving model ...
Epoch: 9 cost time: 3.2896053791046143
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.176 Vali Acc: 0.568 Test Loss: 3.176 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2978105545043945
Epoch: 10, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.958 Vali Acc: 0.459 Test Loss: 4.958 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6120357513427734
Epoch: 11, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.474 Vali Acc: 0.473 Test Loss: 3.474 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6614584922790527
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.289 Vali Acc: 0.473 Test Loss: 5.289 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2647013664245605
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.889 Vali Acc: 0.459 Test Loss: 4.889 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.239300489425659
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 5.457 Vali Acc: 0.473 Test Loss: 5.457 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1028497219085693
Epoch: 15, Steps: 10 | Train Loss: 0.300 Vali Loss: 6.925 Vali Acc: 0.446 Test Loss: 6.925 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.871838092803955
Epoch: 16, Steps: 10 | Train Loss: 0.101 Vali Loss: 5.713 Vali Acc: 0.500 Test Loss: 5.713 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.354552745819092
Epoch: 17, Steps: 10 | Train Loss: 0.205 Vali Loss: 6.314 Vali Acc: 0.405 Test Loss: 6.314 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.976736307144165
Epoch: 18, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.645 Vali Acc: 0.608 Test Loss: 4.645 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 4011124
model size : 25.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.606359958648682
Epoch: 1, Steps: 10 | Train Loss: 1.538 Vali Loss: 1.407 Vali Acc: 0.365 Test Loss: 1.407 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 3.149315118789673
Epoch: 2, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.288 Vali Acc: 0.486 Test Loss: 1.288 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.3859002590179443
Epoch: 3, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 2.829488754272461
Epoch: 4, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.648 Vali Acc: 0.486 Test Loss: 1.648 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.577299118041992
Epoch: 5, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.949 Vali Acc: 0.365 Test Loss: 2.949 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4836690425872803
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.175 Vali Acc: 0.365 Test Loss: 3.175 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.705366611480713
Epoch: 7, Steps: 10 | Train Loss: 0.186 Vali Loss: 2.753 Vali Acc: 0.486 Test Loss: 2.753 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.016486167907715
Epoch: 8, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.145 Vali Acc: 0.473 Test Loss: 3.145 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.814216375350952
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.075 Vali Acc: 0.486 Test Loss: 4.075 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7376487255096436
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 2.967 Vali Acc: 0.568 Test Loss: 2.967 Test Acc: 0.568
Validation loss decreased (-0.499985 --> -0.567538).  Saving model ...
Epoch: 11 cost time: 3.0132081508636475
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 6.108 Vali Acc: 0.365 Test Loss: 6.108 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7096924781799316
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 5.087 Vali Acc: 0.446 Test Loss: 5.087 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7405433654785156
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.240 Vali Acc: 0.568 Test Loss: 4.240 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.593888282775879
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.477 Vali Acc: 0.419 Test Loss: 5.477 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0743064880371094
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 5.921 Vali Acc: 0.446 Test Loss: 5.921 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2534103393554688
Epoch: 16, Steps: 10 | Train Loss: 0.168 Vali Loss: 4.545 Vali Acc: 0.514 Test Loss: 4.545 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1303064823150635
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.169 Vali Acc: 0.473 Test Loss: 6.169 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.669278383255005
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 8.363 Vali Acc: 0.446 Test Loss: 8.363 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.333543300628662
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.556 Vali Acc: 0.514 Test Loss: 4.556 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.574342727661133
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 7.355 Vali Acc: 0.486 Test Loss: 7.355 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4011124
model size : 25.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.130680084228516
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.432 Vali Acc: 0.324 Test Loss: 1.432 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 3.360771417617798
Epoch: 2, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.335 Vali Acc: 0.459 Test Loss: 1.335 Test Acc: 0.459
Validation loss decreased (-0.324310 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 3.371976137161255
Epoch: 3, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472958).  Saving model ...
Epoch: 4 cost time: 3.3457677364349365
Epoch: 4, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.655 Vali Acc: 0.514 Test Loss: 1.655 Test Acc: 0.514
Validation loss decreased (-0.472958 --> -0.513497).  Saving model ...
Epoch: 5 cost time: 3.6105387210845947
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 2.492 Vali Acc: 0.405 Test Loss: 2.492 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.385685682296753
Epoch: 6, Steps: 10 | Train Loss: 0.141 Vali Loss: 2.429 Vali Acc: 0.473 Test Loss: 2.429 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.894268035888672
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 2.803 Vali Acc: 0.459 Test Loss: 2.803 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.604555606842041
Epoch: 8, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.269 Vali Acc: 0.527 Test Loss: 2.269 Test Acc: 0.527
Validation loss decreased (-0.513497 --> -0.527004).  Saving model ...
Epoch: 9 cost time: 2.9335169792175293
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.249 Vali Acc: 0.473 Test Loss: 3.249 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9212803840637207
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.730 Vali Acc: 0.378 Test Loss: 5.730 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9039971828460693
Epoch: 11, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.017 Vali Acc: 0.459 Test Loss: 3.017 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4497697353363037
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.852 Vali Acc: 0.527 Test Loss: 2.852 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1011195182800293
Epoch: 13, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.308 Vali Acc: 0.459 Test Loss: 4.308 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0387516021728516
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.257 Vali Acc: 0.514 Test Loss: 3.257 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.334127187728882
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.925 Vali Acc: 0.473 Test Loss: 4.925 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1901302337646484
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.634 Vali Acc: 0.568 Test Loss: 3.634 Test Acc: 0.568
Validation loss decreased (-0.527004 --> -0.567531).  Saving model ...
Epoch: 17 cost time: 3.59849214553833
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.801 Vali Acc: 0.500 Test Loss: 5.801 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4676826000213623
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.357 Vali Acc: 0.486 Test Loss: 5.357 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.697270154953003
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.887 Vali Acc: 0.405 Test Loss: 5.887 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.980663299560547
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 8.099 Vali Acc: 0.405 Test Loss: 8.099 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.122840404510498
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 6.796 Vali Acc: 0.432 Test Loss: 6.796 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.515519618988037
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.728 Vali Acc: 0.473 Test Loss: 4.728 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.663754940032959
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 9.391 Vali Acc: 0.405 Test Loss: 9.391 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.5082192420959473
Epoch: 24, Steps: 10 | Train Loss: 0.220 Vali Loss: 6.091 Vali Acc: 0.432 Test Loss: 6.091 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.160731077194214
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 8.579 Vali Acc: 0.446 Test Loss: 8.579 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.855344533920288
Epoch: 26, Steps: 10 | Train Loss: 0.155 Vali Loss: 7.057 Vali Acc: 0.459 Test Loss: 7.057 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 4011124
model size : 25.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2415406703948975
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.445 Vali Acc: 0.311 Test Loss: 1.445 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 2.5504040718078613
Epoch: 2, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.350 Vali Acc: 0.405 Test Loss: 1.350 Test Acc: 0.405
Validation loss decreased (-0.310796 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 3.071680784225464
Epoch: 3, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.376 Vali Acc: 0.473 Test Loss: 1.376 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472959).  Saving model ...
Epoch: 4 cost time: 2.871993064880371
Epoch: 4, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.520 Vali Acc: 0.459 Test Loss: 1.520 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.961369752883911
Epoch: 5, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.821 Vali Acc: 0.459 Test Loss: 1.821 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0272927284240723
Epoch: 6, Steps: 10 | Train Loss: 0.108 Vali Loss: 2.434 Vali Acc: 0.351 Test Loss: 2.434 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9857823848724365
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.992 Vali Acc: 0.486 Test Loss: 1.992 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486467).  Saving model ...
Epoch: 8 cost time: 2.745704412460327
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.994 Vali Acc: 0.459 Test Loss: 1.994 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.967780113220215
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.890 Vali Acc: 0.378 Test Loss: 2.890 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7145071029663086
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.707 Vali Acc: 0.446 Test Loss: 2.707 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.005079746246338
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.936 Vali Acc: 0.486 Test Loss: 2.936 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.322619915008545
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.230 Vali Acc: 0.378 Test Loss: 4.230 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9531946182250977
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.275 Vali Acc: 0.365 Test Loss: 4.275 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.605879783630371
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.513 Vali Acc: 0.392 Test Loss: 3.513 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8642523288726807
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.503 Vali Acc: 0.486 Test Loss: 3.503 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4469306468963623
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.021 Vali Acc: 0.459 Test Loss: 4.021 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.884711503982544
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.621 Vali Acc: 0.378 Test Loss: 4.621 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 4011124
model size : 25.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.393749237060547
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.241 Vali Acc: 0.419 Test Loss: 1.241 Test Acc: 0.419
Validation loss decreased (inf --> -0.418907).  Saving model ...
Epoch: 2 cost time: 3.63948392868042
Epoch: 2, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.977 Vali Acc: 0.297 Test Loss: 1.977 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8442721366882324
Epoch: 3, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.592 Vali Acc: 0.419 Test Loss: 1.592 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4614148139953613
Epoch: 4, Steps: 10 | Train Loss: 0.196 Vali Loss: 2.421 Vali Acc: 0.446 Test Loss: 2.421 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445922).  Saving model ...
Epoch: 5 cost time: 3.2815423011779785
Epoch: 5, Steps: 10 | Train Loss: 0.160 Vali Loss: 2.346 Vali Acc: 0.568 Test Loss: 2.346 Test Acc: 0.568
Validation loss decreased (-0.445922 --> -0.567544).  Saving model ...
Epoch: 6 cost time: 3.4138190746307373
Epoch: 6, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.595 Vali Acc: 0.405 Test Loss: 3.595 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.414324998855591
Epoch: 7, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.758 Vali Acc: 0.432 Test Loss: 3.758 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.366945505142212
Epoch: 8, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.288 Vali Acc: 0.432 Test Loss: 3.288 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.506256103515625
Epoch: 9, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.137 Vali Acc: 0.473 Test Loss: 3.137 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1758525371551514
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.278 Vali Acc: 0.514 Test Loss: 3.278 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0911505222320557
Epoch: 11, Steps: 10 | Train Loss: 0.248 Vali Loss: 5.106 Vali Acc: 0.405 Test Loss: 5.106 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.830670118331909
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 5.036 Vali Acc: 0.514 Test Loss: 5.036 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8985536098480225
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.082 Vali Acc: 0.527 Test Loss: 4.082 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1019206047058105
Epoch: 14, Steps: 10 | Train Loss: 0.133 Vali Loss: 5.751 Vali Acc: 0.500 Test Loss: 5.751 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.371995449066162
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.435 Vali Acc: 0.446 Test Loss: 5.435 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2962548
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.483163356781006
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.296 Vali Acc: 0.392 Test Loss: 1.296 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.99923038482666
Epoch: 2, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.851 Vali Acc: 0.365 Test Loss: 1.851 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4442179203033447
Epoch: 3, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.527 Vali Acc: 0.473 Test Loss: 1.527 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472958).  Saving model ...
Epoch: 4 cost time: 3.320369243621826
Epoch: 4, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.979 Vali Acc: 0.392 Test Loss: 1.979 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.20930552482605
Epoch: 5, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.382 Vali Acc: 0.419 Test Loss: 2.382 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.349964141845703
Epoch: 6, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.339 Vali Acc: 0.405 Test Loss: 3.339 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.855599880218506
Epoch: 7, Steps: 10 | Train Loss: 0.176 Vali Loss: 2.552 Vali Acc: 0.527 Test Loss: 2.552 Test Acc: 0.527
Validation loss decreased (-0.472958 --> -0.527002).  Saving model ...
Epoch: 8 cost time: 3.4325225353240967
Epoch: 8, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.495 Vali Acc: 0.446 Test Loss: 3.495 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.132200241088867
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 2.934 Vali Acc: 0.473 Test Loss: 2.934 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.333167552947998
Epoch: 10, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.814 Vali Acc: 0.554 Test Loss: 2.814 Test Acc: 0.554
Validation loss decreased (-0.527002 --> -0.554026).  Saving model ...
Epoch: 11 cost time: 3.3067421913146973
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.392 Vali Acc: 0.419 Test Loss: 3.392 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2044517993927
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.837 Vali Acc: 0.432 Test Loss: 5.837 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1160693168640137
Epoch: 13, Steps: 10 | Train Loss: 0.203 Vali Loss: 5.055 Vali Acc: 0.500 Test Loss: 5.055 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1747756004333496
Epoch: 14, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.800 Vali Acc: 0.541 Test Loss: 3.800 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3092706203460693
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.840 Vali Acc: 0.473 Test Loss: 4.840 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9074203968048096
Epoch: 16, Steps: 10 | Train Loss: 0.169 Vali Loss: 8.633 Vali Acc: 0.432 Test Loss: 8.633 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.064951181411743
Epoch: 17, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.319 Vali Acc: 0.554 Test Loss: 4.319 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.666729688644409
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.213 Vali Acc: 0.473 Test Loss: 6.213 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2334368228912354
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.710 Vali Acc: 0.486 Test Loss: 4.710 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.101079225540161
Epoch: 20, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.831 Vali Acc: 0.446 Test Loss: 5.831 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2962548
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.630892753601074
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.329 Vali Acc: 0.351 Test Loss: 1.329 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 3.243525266647339
Epoch: 2, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.706 Vali Acc: 0.365 Test Loss: 1.706 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364848).  Saving model ...
Epoch: 3 cost time: 2.900341749191284
Epoch: 3, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.419 Vali Acc: 0.486 Test Loss: 1.419 Test Acc: 0.486
Validation loss decreased (-0.364848 --> -0.486472).  Saving model ...
Epoch: 4 cost time: 3.0362117290496826
Epoch: 4, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.712 Vali Acc: 0.473 Test Loss: 1.712 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6551353931427
Epoch: 5, Steps: 10 | Train Loss: 0.169 Vali Loss: 2.177 Vali Acc: 0.392 Test Loss: 2.177 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.099409341812134
Epoch: 6, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.897 Vali Acc: 0.378 Test Loss: 2.897 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2594187259674072
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 2.902 Vali Acc: 0.432 Test Loss: 2.902 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8476877212524414
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 2.553 Vali Acc: 0.459 Test Loss: 2.553 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.194640874862671
Epoch: 9, Steps: 10 | Train Loss: 0.145 Vali Loss: 2.968 Vali Acc: 0.554 Test Loss: 2.968 Test Acc: 0.554
Validation loss decreased (-0.486472 --> -0.554024).  Saving model ...
Epoch: 10 cost time: 2.3738341331481934
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 2.849 Vali Acc: 0.541 Test Loss: 2.849 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.20161509513855
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.082 Vali Acc: 0.500 Test Loss: 3.082 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5674197673797607
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.594 Vali Acc: 0.473 Test Loss: 4.594 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1469836235046387
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.669 Vali Acc: 0.486 Test Loss: 3.669 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2155749797821045
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.570 Vali Acc: 0.419 Test Loss: 5.570 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0805132389068604
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.098 Vali Acc: 0.459 Test Loss: 4.098 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.053917169570923
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.569 Vali Acc: 0.432 Test Loss: 6.569 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.720217227935791
Epoch: 17, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.213 Vali Acc: 0.419 Test Loss: 4.213 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.0319886207580566
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.529 Vali Acc: 0.486 Test Loss: 5.529 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.021578073501587
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.700 Vali Acc: 0.527 Test Loss: 5.700 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2962548
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.985893487930298
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.427 Vali Acc: 0.257 Test Loss: 1.427 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 2.730386734008789
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.553 Vali Acc: 0.419 Test Loss: 1.553 Test Acc: 0.419
Validation loss decreased (-0.256742 --> -0.418903).  Saving model ...
Epoch: 3 cost time: 2.5367681980133057
Epoch: 3, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.442 Vali Acc: 0.432 Test Loss: 1.442 Test Acc: 0.432
Validation loss decreased (-0.418903 --> -0.432418).  Saving model ...
Epoch: 4 cost time: 2.2787845134735107
Epoch: 4, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.469 Vali Acc: 0.459 Test Loss: 1.469 Test Acc: 0.459
Validation loss decreased (-0.432418 --> -0.459445).  Saving model ...
Epoch: 5 cost time: 2.5807836055755615
Epoch: 5, Steps: 10 | Train Loss: 0.158 Vali Loss: 2.098 Vali Acc: 0.446 Test Loss: 2.098 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.634945869445801
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 2.413 Vali Acc: 0.419 Test Loss: 2.413 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9211442470550537
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 2.090 Vali Acc: 0.486 Test Loss: 2.090 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486466).  Saving model ...
Epoch: 8 cost time: 2.956846237182617
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.732 Vali Acc: 0.365 Test Loss: 3.732 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7577052116394043
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 2.128 Vali Acc: 0.459 Test Loss: 2.128 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7174413204193115
Epoch: 10, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.031 Vali Acc: 0.514 Test Loss: 3.031 Test Acc: 0.514
Validation loss decreased (-0.486466 --> -0.513483).  Saving model ...
Epoch: 11 cost time: 2.7734375
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.896 Vali Acc: 0.459 Test Loss: 3.896 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0509886741638184
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.527 Vali Acc: 0.459 Test Loss: 3.527 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.247828483581543
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.386 Vali Acc: 0.473 Test Loss: 3.386 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0784835815429688
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.307 Vali Acc: 0.459 Test Loss: 4.307 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6858298778533936
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.290 Vali Acc: 0.392 Test Loss: 4.290 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6913959980010986
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.920 Vali Acc: 0.486 Test Loss: 3.920 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3881218433380127
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.082 Vali Acc: 0.432 Test Loss: 4.082 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.557865858078003
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.767 Vali Acc: 0.405 Test Loss: 4.767 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9364724159240723
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.185 Vali Acc: 0.405 Test Loss: 5.185 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4478023052215576
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.417 Vali Acc: 0.459 Test Loss: 5.417 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 2962548
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.776182174682617
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
Validation loss decreased (inf --> -0.432420).  Saving model ...
Epoch: 2 cost time: 3.2362990379333496
Epoch: 2, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 3.3220555782318115
Epoch: 3, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.269 Vali Acc: 0.568 Test Loss: 1.269 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567555).  Saving model ...
Epoch: 4 cost time: 3.319713592529297
Epoch: 4, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.850 Vali Acc: 0.541 Test Loss: 1.850 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4229307174682617
Epoch: 5, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.916 Vali Acc: 0.500 Test Loss: 1.916 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.634967803955078
Epoch: 6, Steps: 10 | Train Loss: 0.058 Vali Loss: 2.011 Vali Acc: 0.500 Test Loss: 2.011 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4393794536590576
Epoch: 7, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.312 Vali Acc: 0.595 Test Loss: 2.312 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594571).  Saving model ...
Epoch: 8 cost time: 3.0879557132720947
Epoch: 8, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.185 Vali Acc: 0.514 Test Loss: 3.185 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2562255859375
Epoch: 9, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.239 Vali Acc: 0.500 Test Loss: 3.239 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9655086994171143
Epoch: 10, Steps: 10 | Train Loss: 0.172 Vali Loss: 6.718 Vali Acc: 0.432 Test Loss: 6.718 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9358739852905273
Epoch: 11, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.471 Vali Acc: 0.541 Test Loss: 3.471 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0325751304626465
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.916 Vali Acc: 0.473 Test Loss: 3.916 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1043541431427
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.904 Vali Acc: 0.486 Test Loss: 4.904 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8909547328948975
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.210 Vali Acc: 0.581 Test Loss: 4.210 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.877180576324463
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.927 Vali Acc: 0.500 Test Loss: 5.927 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.894788980484009
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.718 Vali Acc: 0.500 Test Loss: 4.718 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.954760789871216
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.182 Vali Acc: 0.432 Test Loss: 7.182 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2438260
model size : 19.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.0232555866241455
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 2.552150011062622
Epoch: 2, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
Validation loss decreased (-0.364852 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 2.6295735836029053
Epoch: 3, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.366 Vali Acc: 0.554 Test Loss: 1.366 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554040).  Saving model ...
Epoch: 4 cost time: 3.239668607711792
Epoch: 4, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.768 Vali Acc: 0.514 Test Loss: 1.768 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.129459857940674
Epoch: 5, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.181 Vali Acc: 0.419 Test Loss: 2.181 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.772582769393921
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.465 Vali Acc: 0.392 Test Loss: 2.465 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5940117835998535
Epoch: 7, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.007 Vali Acc: 0.351 Test Loss: 4.007 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8754398822784424
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.354 Vali Acc: 0.459 Test Loss: 3.354 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8790977001190186
Epoch: 9, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.694 Vali Acc: 0.473 Test Loss: 3.694 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.930086374282837
Epoch: 10, Steps: 10 | Train Loss: 0.323 Vali Loss: 4.738 Vali Acc: 0.419 Test Loss: 4.738 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.964379072189331
Epoch: 11, Steps: 10 | Train Loss: 0.411 Vali Loss: 4.075 Vali Acc: 0.500 Test Loss: 4.075 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1365060806274414
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.486 Vali Acc: 0.500 Test Loss: 3.486 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.971964120864868
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.660 Vali Acc: 0.541 Test Loss: 3.660 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2438260
model size : 19.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.346990346908569
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.301 Vali Acc: 0.365 Test Loss: 1.301 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 2.8030197620391846
Epoch: 2, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.364852 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 2.803341865539551
Epoch: 3, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.873734474182129
Epoch: 4, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.722 Vali Acc: 0.459 Test Loss: 1.722 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.055885076522827
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.983 Vali Acc: 0.473 Test Loss: 1.983 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0089383125305176
Epoch: 6, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.297 Vali Acc: 0.473 Test Loss: 2.297 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.066580295562744
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 2.196 Vali Acc: 0.527 Test Loss: 2.196 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527005).  Saving model ...
Epoch: 8 cost time: 3.042736768722534
Epoch: 8, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.006 Vali Acc: 0.459 Test Loss: 3.006 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.068190336227417
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 2.906 Vali Acc: 0.432 Test Loss: 2.906 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.703387975692749
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.316 Vali Acc: 0.432 Test Loss: 3.316 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9269840717315674
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.248 Vali Acc: 0.446 Test Loss: 3.248 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.061863422393799
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.845 Vali Acc: 0.486 Test Loss: 3.845 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8099114894866943
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.752 Vali Acc: 0.527 Test Loss: 3.752 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7788283824920654
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.248 Vali Acc: 0.459 Test Loss: 4.248 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.153754472732544
Epoch: 15, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.256 Vali Acc: 0.419 Test Loss: 4.256 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9090094566345215
Epoch: 16, Steps: 10 | Train Loss: 0.262 Vali Loss: 5.607 Vali Acc: 0.514 Test Loss: 5.607 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8490564823150635
Epoch: 17, Steps: 10 | Train Loss: 0.292 Vali Loss: 5.888 Vali Acc: 0.405 Test Loss: 5.888 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2438260
model size : 19.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.163570165634155
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.308 Vali Acc: 0.351 Test Loss: 1.308 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 2.821256160736084
Epoch: 2, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.434 Vali Acc: 0.378 Test Loss: 1.434 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378364).  Saving model ...
Epoch: 3 cost time: 2.7406413555145264
Epoch: 3, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.392 Vali Acc: 0.446 Test Loss: 1.392 Test Acc: 0.446
Validation loss decreased (-0.378364 --> -0.445932).  Saving model ...
Epoch: 4 cost time: 2.412310838699341
Epoch: 4, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.582 Vali Acc: 0.446 Test Loss: 1.582 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.798499345779419
Epoch: 5, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.604 Vali Acc: 0.486 Test Loss: 1.604 Test Acc: 0.486
Validation loss decreased (-0.445932 --> -0.486470).  Saving model ...
Epoch: 6 cost time: 3.3352484703063965
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.294 Vali Acc: 0.419 Test Loss: 2.294 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7246787548065186
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.283 Vali Acc: 0.446 Test Loss: 2.283 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5415945053100586
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 2.365 Vali Acc: 0.419 Test Loss: 2.365 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7968668937683105
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.367 Vali Acc: 0.405 Test Loss: 2.367 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6844289302825928
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.199 Vali Acc: 0.432 Test Loss: 3.199 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8995368480682373
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.629 Vali Acc: 0.378 Test Loss: 3.629 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8408987522125244
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.582 Vali Acc: 0.351 Test Loss: 4.582 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.64433217048645
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.613 Vali Acc: 0.365 Test Loss: 4.613 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.792680025100708
Epoch: 14, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.204 Vali Acc: 0.405 Test Loss: 4.204 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6724953651428223
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.475 Vali Acc: 0.500 Test Loss: 4.475 Test Acc: 0.500
Validation loss decreased (-0.486470 --> -0.499955).  Saving model ...
Epoch: 16 cost time: 2.6198298931121826
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.019 Vali Acc: 0.419 Test Loss: 6.019 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.426713705062866
Epoch: 17, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.116 Vali Acc: 0.541 Test Loss: 4.116 Test Acc: 0.541
Validation loss decreased (-0.499955 --> -0.540499).  Saving model ...
Epoch: 18 cost time: 3.00639009475708
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.032 Vali Acc: 0.527 Test Loss: 4.032 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.578927516937256
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.300 Vali Acc: 0.459 Test Loss: 4.300 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.838043451309204
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.210 Vali Acc: 0.378 Test Loss: 6.210 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7560694217681885
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.716 Vali Acc: 0.459 Test Loss: 4.716 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.001154899597168
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.752 Vali Acc: 0.432 Test Loss: 4.752 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1413979530334473
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.444 Vali Acc: 0.405 Test Loss: 4.444 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.729264259338379
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.638 Vali Acc: 0.446 Test Loss: 5.638 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.886378049850464
Epoch: 25, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.831 Vali Acc: 0.581 Test Loss: 3.831 Test Acc: 0.581
Validation loss decreased (-0.540499 --> -0.581043).  Saving model ...
Epoch: 26 cost time: 2.7939229011535645
Epoch: 26, Steps: 10 | Train Loss: 0.178 Vali Loss: 8.074 Vali Acc: 0.378 Test Loss: 8.074 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4244794845581055
Epoch: 27, Steps: 10 | Train Loss: 0.296 Vali Loss: 5.302 Vali Acc: 0.527 Test Loss: 5.302 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3172593116760254
Epoch: 28, Steps: 10 | Train Loss: 0.159 Vali Loss: 5.124 Vali Acc: 0.514 Test Loss: 5.124 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1618456840515137
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.468 Vali Acc: 0.446 Test Loss: 7.468 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3031442165374756
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.248 Vali Acc: 0.446 Test Loss: 6.248 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.570770263671875
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 7.512 Vali Acc: 0.500 Test Loss: 7.512 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.533363103866577
Epoch: 32, Steps: 10 | Train Loss: 0.060 Vali Loss: 6.474 Vali Acc: 0.486 Test Loss: 6.474 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.652730941772461
Epoch: 33, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.615 Vali Acc: 0.446 Test Loss: 5.615 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.791886806488037
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.260 Vali Acc: 0.473 Test Loss: 8.260 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.6234829425811768
Epoch: 35, Steps: 10 | Train Loss: 0.032 Vali Loss: 9.154 Vali Acc: 0.432 Test Loss: 9.154 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2438260
model size : 19.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.872567892074585
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.301 Vali Acc: 0.473 Test Loss: 1.301 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 3.099689245223999
Epoch: 2, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 3.1221556663513184
Epoch: 3, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.565 Vali Acc: 0.419 Test Loss: 1.565 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0729804039001465
Epoch: 4, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.547 Vali Acc: 0.608 Test Loss: 1.547 Test Acc: 0.608
Validation loss decreased (-0.499987 --> -0.608093).  Saving model ...
Epoch: 5 cost time: 3.1656317710876465
Epoch: 5, Steps: 10 | Train Loss: 0.198 Vali Loss: 2.867 Vali Acc: 0.419 Test Loss: 2.867 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2317962646484375
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 2.549 Vali Acc: 0.500 Test Loss: 2.549 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.860469341278076
Epoch: 7, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.141 Vali Acc: 0.432 Test Loss: 3.141 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2002573013305664
Epoch: 8, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.966 Vali Acc: 0.500 Test Loss: 2.966 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3443148136138916
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.815 Vali Acc: 0.541 Test Loss: 2.815 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.18935227394104
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.352 Vali Acc: 0.527 Test Loss: 3.352 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1126997470855713
Epoch: 11, Steps: 10 | Train Loss: 0.222 Vali Loss: 6.179 Vali Acc: 0.486 Test Loss: 6.179 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1794614791870117
Epoch: 12, Steps: 10 | Train Loss: 0.241 Vali Loss: 5.200 Vali Acc: 0.459 Test Loss: 5.200 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.112605571746826
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.860 Vali Acc: 0.595 Test Loss: 3.860 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9472038745880127
Epoch: 14, Steps: 10 | Train Loss: 0.294 Vali Loss: 5.427 Vali Acc: 0.459 Test Loss: 5.427 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2176116
model size : 18.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.299591779708862
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.318 Vali Acc: 0.459 Test Loss: 1.318 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 3.0304479598999023
Epoch: 2, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.343 Vali Acc: 0.459 Test Loss: 1.343 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1044070720672607
Epoch: 3, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.585 Vali Acc: 0.405 Test Loss: 1.585 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.197612762451172
Epoch: 4, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.948 Vali Acc: 0.500 Test Loss: 1.948 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 3.1649234294891357
Epoch: 5, Steps: 10 | Train Loss: 0.257 Vali Loss: 2.244 Vali Acc: 0.500 Test Loss: 2.244 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9926512241363525
Epoch: 6, Steps: 10 | Train Loss: 0.164 Vali Loss: 2.396 Vali Acc: 0.500 Test Loss: 2.396 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8663995265960693
Epoch: 7, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.083 Vali Acc: 0.486 Test Loss: 3.083 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6836659908294678
Epoch: 8, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.275 Vali Acc: 0.446 Test Loss: 3.275 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7943103313446045
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.120 Vali Acc: 0.500 Test Loss: 3.120 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.566176414489746
Epoch: 10, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.637 Vali Acc: 0.500 Test Loss: 3.637 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4899985790252686
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.372 Vali Acc: 0.405 Test Loss: 4.372 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.693711996078491
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.048 Vali Acc: 0.581 Test Loss: 4.048 Test Acc: 0.581
Validation loss decreased (-0.499981 --> -0.581041).  Saving model ...
Epoch: 13 cost time: 2.7561328411102295
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.297 Vali Acc: 0.527 Test Loss: 3.297 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8589911460876465
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.510 Vali Acc: 0.500 Test Loss: 4.510 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.816422700881958
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.221 Vali Acc: 0.568 Test Loss: 4.221 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8624367713928223
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 5.569 Vali Acc: 0.500 Test Loss: 5.569 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7881455421447754
Epoch: 17, Steps: 10 | Train Loss: 0.295 Vali Loss: 4.616 Vali Acc: 0.514 Test Loss: 4.616 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0733203887939453
Epoch: 18, Steps: 10 | Train Loss: 0.277 Vali Loss: 6.004 Vali Acc: 0.514 Test Loss: 6.004 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.999990940093994
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 5.204 Vali Acc: 0.514 Test Loss: 5.204 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.600106954574585
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 6.221 Vali Acc: 0.473 Test Loss: 6.221 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5172784328460693
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.302 Vali Acc: 0.568 Test Loss: 5.302 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.4284310340881348
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.203 Vali Acc: 0.527 Test Loss: 5.203 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2176116
model size : 18.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.315276622772217
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.359 Vali Acc: 0.473 Test Loss: 1.359 Test Acc: 0.473
Validation loss decreased (inf --> -0.472959).  Saving model ...
Epoch: 2 cost time: 2.48390793800354
Epoch: 2, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.326 Vali Acc: 0.432 Test Loss: 1.326 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.234008312225342
Epoch: 3, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.493 Vali Acc: 0.446 Test Loss: 1.493 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7826380729675293
Epoch: 4, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.802 Vali Acc: 0.473 Test Loss: 1.802 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7423667907714844
Epoch: 5, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.712 Vali Acc: 0.527 Test Loss: 1.712 Test Acc: 0.527
Validation loss decreased (-0.472959 --> -0.527010).  Saving model ...
Epoch: 6 cost time: 3.039949655532837
Epoch: 6, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.171 Vali Acc: 0.459 Test Loss: 2.171 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9634132385253906
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 2.238 Vali Acc: 0.527 Test Loss: 2.238 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.10298490524292
Epoch: 8, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.715 Vali Acc: 0.419 Test Loss: 2.715 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3317203521728516
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.956 Vali Acc: 0.446 Test Loss: 2.956 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4676713943481445
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.738 Vali Acc: 0.500 Test Loss: 2.738 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9757206439971924
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.015 Vali Acc: 0.568 Test Loss: 3.015 Test Acc: 0.568
Validation loss decreased (-0.527010 --> -0.567537).  Saving model ...
Epoch: 12 cost time: 2.816337823867798
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.843 Vali Acc: 0.473 Test Loss: 3.843 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9666366577148438
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.199 Vali Acc: 0.432 Test Loss: 4.199 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.81359601020813
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.311 Vali Acc: 0.473 Test Loss: 4.311 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.287092685699463
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.942 Vali Acc: 0.419 Test Loss: 4.942 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8236334323883057
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 5.168 Vali Acc: 0.432 Test Loss: 5.168 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2825143337249756
Epoch: 17, Steps: 10 | Train Loss: 0.114 Vali Loss: 5.855 Vali Acc: 0.432 Test Loss: 5.855 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.240353584289551
Epoch: 18, Steps: 10 | Train Loss: 0.157 Vali Loss: 7.018 Vali Acc: 0.459 Test Loss: 7.018 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0036113262176514
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 5.583 Vali Acc: 0.500 Test Loss: 5.583 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.270061492919922
Epoch: 20, Steps: 10 | Train Loss: 0.138 Vali Loss: 5.121 Vali Acc: 0.486 Test Loss: 5.121 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4900968074798584
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 6.793 Vali Acc: 0.459 Test Loss: 6.793 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 2176116
model size : 18.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.112308025360107
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.427 Vali Acc: 0.446 Test Loss: 1.427 Test Acc: 0.446
Validation loss decreased (inf --> -0.445932).  Saving model ...
Epoch: 2 cost time: 3.310012102127075
Epoch: 2, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.340 Vali Acc: 0.405 Test Loss: 1.340 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2579469680786133
Epoch: 3, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.455 Vali Acc: 0.405 Test Loss: 1.455 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3174047470092773
Epoch: 4, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.574 Vali Acc: 0.446 Test Loss: 1.574 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3191964626312256
Epoch: 5, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.908 Vali Acc: 0.446 Test Loss: 1.908 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2885313034057617
Epoch: 6, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
Validation loss decreased (-0.445932 --> -0.527012).  Saving model ...
Epoch: 7 cost time: 2.970994710922241
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.936 Vali Acc: 0.527 Test Loss: 1.936 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4176442623138428
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 2.287 Vali Acc: 0.446 Test Loss: 2.287 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.494950771331787
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.368 Vali Acc: 0.432 Test Loss: 2.368 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2308614253997803
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.820 Vali Acc: 0.419 Test Loss: 2.820 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4885342121124268
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.919 Vali Acc: 0.419 Test Loss: 2.919 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2650277614593506
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.667 Vali Acc: 0.459 Test Loss: 3.667 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9898321628570557
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.735 Vali Acc: 0.365 Test Loss: 4.735 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8421432971954346
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.703 Vali Acc: 0.432 Test Loss: 3.703 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9686388969421387
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.148 Vali Acc: 0.432 Test Loss: 5.148 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.952974796295166
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.605 Vali Acc: 0.459 Test Loss: 4.605 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2176116
model size : 18.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.0556581020355225
Epoch: 1, Steps: 10 | Train Loss: 1.519 Vali Loss: 1.337 Vali Acc: 0.405 Test Loss: 1.337 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 4.078103542327881
Epoch: 2, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
Validation loss decreased (-0.405392 --> -0.581069).  Saving model ...
Epoch: 3 cost time: 3.4675912857055664
Epoch: 3, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.598 Vali Acc: 0.473 Test Loss: 1.598 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.804755449295044
Epoch: 4, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.991 Vali Acc: 0.446 Test Loss: 1.991 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.585439920425415
Epoch: 5, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.577 Vali Acc: 0.459 Test Loss: 2.577 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.762204170227051
Epoch: 6, Steps: 10 | Train Loss: 0.201 Vali Loss: 2.479 Vali Acc: 0.527 Test Loss: 2.479 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3193554878234863
Epoch: 7, Steps: 10 | Train Loss: 0.161 Vali Loss: 2.553 Vali Acc: 0.514 Test Loss: 2.553 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.363778591156006
Epoch: 8, Steps: 10 | Train Loss: 0.390 Vali Loss: 2.800 Vali Acc: 0.500 Test Loss: 2.800 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.052030563354492
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.605 Vali Acc: 0.459 Test Loss: 3.605 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8516933917999268
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.263 Vali Acc: 0.541 Test Loss: 4.263 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4581573009490967
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.995 Vali Acc: 0.486 Test Loss: 3.995 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6584980487823486
Epoch: 12, Steps: 10 | Train Loss: 0.194 Vali Loss: 4.526 Vali Acc: 0.514 Test Loss: 4.526 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2045044
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.120065689086914
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.390 Vali Acc: 0.405 Test Loss: 1.390 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 2.7438879013061523
Epoch: 2, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 2.734628200531006
Epoch: 3, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.589 Vali Acc: 0.486 Test Loss: 1.589 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8427793979644775
Epoch: 4, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.960 Vali Acc: 0.432 Test Loss: 1.960 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.856818199157715
Epoch: 5, Steps: 10 | Train Loss: 0.170 Vali Loss: 2.737 Vali Acc: 0.432 Test Loss: 2.737 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2588253021240234
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 2.110 Vali Acc: 0.446 Test Loss: 2.110 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8856306076049805
Epoch: 7, Steps: 10 | Train Loss: 0.136 Vali Loss: 2.785 Vali Acc: 0.500 Test Loss: 2.785 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1830050945281982
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 2.401 Vali Acc: 0.554 Test Loss: 2.401 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554030).  Saving model ...
Epoch: 9 cost time: 3.179661512374878
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.415 Vali Acc: 0.486 Test Loss: 3.415 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8497703075408936
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.442 Vali Acc: 0.500 Test Loss: 3.442 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8072397708892822
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.391 Vali Acc: 0.419 Test Loss: 3.391 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9793925285339355
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.649 Vali Acc: 0.473 Test Loss: 3.649 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.905904531478882
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 6.410 Vali Acc: 0.378 Test Loss: 6.410 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9104559421539307
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.999 Vali Acc: 0.419 Test Loss: 4.999 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7170603275299072
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 5.304 Vali Acc: 0.459 Test Loss: 5.304 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9903769493103027
Epoch: 16, Steps: 10 | Train Loss: 0.163 Vali Loss: 7.370 Vali Acc: 0.432 Test Loss: 7.370 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0902504920959473
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.337 Vali Acc: 0.554 Test Loss: 4.337 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.480895519256592
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.393 Vali Acc: 0.486 Test Loss: 4.393 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 2045044
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.544048547744751
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.426 Vali Acc: 0.405 Test Loss: 1.426 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 3.3972561359405518
Epoch: 2, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
Validation loss decreased (-0.405391 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 3.443899393081665
Epoch: 3, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.571 Vali Acc: 0.473 Test Loss: 1.571 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.378953456878662
Epoch: 4, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.899 Vali Acc: 0.432 Test Loss: 1.899 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3756415843963623
Epoch: 5, Steps: 10 | Train Loss: 0.173 Vali Loss: 2.651 Vali Acc: 0.459 Test Loss: 2.651 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6349587440490723
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 2.165 Vali Acc: 0.405 Test Loss: 2.165 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9000020027160645
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.465 Vali Acc: 0.486 Test Loss: 2.465 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0675790309906006
Epoch: 8, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.088 Vali Acc: 0.392 Test Loss: 3.088 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.106898307800293
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.977 Vali Acc: 0.473 Test Loss: 3.977 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.153564453125
Epoch: 10, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.668 Vali Acc: 0.500 Test Loss: 3.668 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8493845462799072
Epoch: 11, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.124 Vali Acc: 0.500 Test Loss: 3.124 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.702890396118164
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.708 Vali Acc: 0.392 Test Loss: 4.708 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2045044
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.746313095092773
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.487 Vali Acc: 0.405 Test Loss: 1.487 Test Acc: 0.405
Validation loss decreased (inf --> -0.405391).  Saving model ...
Epoch: 2 cost time: 2.750570297241211
Epoch: 2, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.380 Vali Acc: 0.419 Test Loss: 1.380 Test Acc: 0.419
Validation loss decreased (-0.405391 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 2.419631004333496
Epoch: 3, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.696 Vali Acc: 0.284 Test Loss: 1.696 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.283716917037964
Epoch: 4, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.520 Vali Acc: 0.419 Test Loss: 1.520 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7449207305908203
Epoch: 5, Steps: 10 | Train Loss: 0.168 Vali Loss: 2.511 Vali Acc: 0.378 Test Loss: 2.511 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2721328735351562
Epoch: 6, Steps: 10 | Train Loss: 0.177 Vali Loss: 2.009 Vali Acc: 0.514 Test Loss: 2.009 Test Acc: 0.514
Validation loss decreased (-0.418905 --> -0.513493).  Saving model ...
Epoch: 7 cost time: 2.2407631874084473
Epoch: 7, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.612 Vali Acc: 0.419 Test Loss: 2.612 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7719485759735107
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.390 Vali Acc: 0.378 Test Loss: 3.390 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1109187602996826
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.976 Vali Acc: 0.392 Test Loss: 2.976 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0007271766662598
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.365 Vali Acc: 0.486 Test Loss: 2.365 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0692639350891113
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.706 Vali Acc: 0.392 Test Loss: 3.706 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.104717493057251
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.804 Vali Acc: 0.446 Test Loss: 2.804 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.328350067138672
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.687 Vali Acc: 0.432 Test Loss: 3.687 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1167001724243164
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.636 Vali Acc: 0.459 Test Loss: 3.636 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2584517002105713
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.450 Vali Acc: 0.405 Test Loss: 4.450 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8986799716949463
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.308 Vali Acc: 0.392 Test Loss: 5.308 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 2045044
model size : 17.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.482886075973511
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (inf --> -0.486474).  Saving model ...
Epoch: 2 cost time: 2.544581413269043
Epoch: 2, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 3 cost time: 2.201181411743164
Epoch: 3, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.380 Vali Acc: 0.473 Test Loss: 1.380 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2843871116638184
Epoch: 4, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4297780990600586
Epoch: 5, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.511 Vali Acc: 0.541 Test Loss: 1.511 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2133941650390625
Epoch: 6, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.711 Vali Acc: 0.527 Test Loss: 1.711 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.077510356903076
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.691 Vali Acc: 0.486 Test Loss: 1.691 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.265488624572754
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.800 Vali Acc: 0.486 Test Loss: 1.800 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5355422496795654
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.082 Vali Acc: 0.473 Test Loss: 2.082 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0566351413726807
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.855 Vali Acc: 0.554 Test Loss: 1.855 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554036).  Saving model ...
Epoch: 11 cost time: 2.5747814178466797
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.180 Vali Acc: 0.459 Test Loss: 2.180 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5552749633789062
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.329 Vali Acc: 0.541 Test Loss: 2.329 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5448319911956787
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.208 Vali Acc: 0.541 Test Loss: 2.208 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.615539789199829
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.175 Vali Acc: 0.514 Test Loss: 2.175 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.624527931213379
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.969 Vali Acc: 0.554 Test Loss: 1.969 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4825541973114014
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.051 Vali Acc: 0.581 Test Loss: 2.051 Test Acc: 0.581
Validation loss decreased (-0.554036 --> -0.581061).  Saving model ...
Epoch: 17 cost time: 2.833409070968628
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.418 Vali Acc: 0.568 Test Loss: 2.418 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6896169185638428
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.486 Vali Acc: 0.514 Test Loss: 2.486 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.642180919647217
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.800 Vali Acc: 0.459 Test Loss: 3.800 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9760448932647705
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.938 Vali Acc: 0.473 Test Loss: 2.938 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0222575664520264
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.863 Vali Acc: 0.568 Test Loss: 2.863 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8580639362335205
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.737 Vali Acc: 0.500 Test Loss: 3.737 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6849966049194336
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.637 Vali Acc: 0.514 Test Loss: 4.637 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.584789514541626
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.298 Vali Acc: 0.500 Test Loss: 3.298 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.47688889503479
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.303 Vali Acc: 0.486 Test Loss: 3.303 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3673410415649414
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.164 Vali Acc: 0.554 Test Loss: 3.164 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2792052
model size : 15.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7177956104278564
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (inf --> -0.486474).  Saving model ...
Epoch: 2 cost time: 1.7283453941345215
Epoch: 2, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 2.010080337524414
Epoch: 3, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.565 Vali Acc: 0.419 Test Loss: 1.565 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1351747512817383
Epoch: 4, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.382 Vali Acc: 0.473 Test Loss: 1.382 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2960386276245117
Epoch: 5, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.511 Vali Acc: 0.486 Test Loss: 1.511 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.974820852279663
Epoch: 6, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.771923303604126
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.563 Vali Acc: 0.446 Test Loss: 1.563 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.099756956100464
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.673 Vali Acc: 0.486 Test Loss: 1.673 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8650224208831787
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.152 Vali Acc: 0.473 Test Loss: 2.152 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5079166889190674
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5276732444763184
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.319 Vali Acc: 0.500 Test Loss: 2.319 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6746370792388916
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.973 Vali Acc: 0.419 Test Loss: 2.973 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2792052
model size : 15.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.699477195739746
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.250 Vali Acc: 0.405 Test Loss: 1.250 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 2.7593119144439697
Epoch: 2, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
Validation loss decreased (-0.405393 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 2.5604820251464844
Epoch: 3, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.639 Vali Acc: 0.392 Test Loss: 1.639 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.559474229812622
Epoch: 4, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.364 Vali Acc: 0.459 Test Loss: 1.364 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.514028310775757
Epoch: 5, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.353 Vali Acc: 0.459 Test Loss: 1.353 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.482675313949585
Epoch: 6, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.611 Vali Acc: 0.473 Test Loss: 1.611 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.693066120147705
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.653 Vali Acc: 0.473 Test Loss: 1.653 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4445688724517822
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.627 Vali Acc: 0.500 Test Loss: 1.627 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2999889850616455
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.102 Vali Acc: 0.459 Test Loss: 2.102 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5466182231903076
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.066 Vali Acc: 0.486 Test Loss: 2.066 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.920680522918701
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.994 Vali Acc: 0.500 Test Loss: 1.994 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.673079490661621
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.922 Vali Acc: 0.473 Test Loss: 1.922 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 2792052
model size : 15.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.027921438217163
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.298 Vali Acc: 0.419 Test Loss: 1.298 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.9288372993469238
Epoch: 2, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 2.2970492839813232
Epoch: 3, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.676 Vali Acc: 0.351 Test Loss: 1.676 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6594126224517822
Epoch: 4, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.317 Vali Acc: 0.459 Test Loss: 1.317 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.623624563217163
Epoch: 5, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.369 Vali Acc: 0.432 Test Loss: 1.369 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1389923095703125
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.522 Vali Acc: 0.419 Test Loss: 1.522 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9783494472503662
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.573 Vali Acc: 0.405 Test Loss: 1.573 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.51849627494812
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.679 Vali Acc: 0.405 Test Loss: 1.679 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.267993927001953
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.836 Vali Acc: 0.405 Test Loss: 1.836 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5419766902923584
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.864 Vali Acc: 0.473 Test Loss: 1.864 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4029650688171387
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.015 Vali Acc: 0.432 Test Loss: 2.015 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.599865198135376
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.888 Vali Acc: 0.473 Test Loss: 1.888 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 2792052
model size : 15.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.801591634750366
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.468 Vali Acc: 0.446 Test Loss: 1.468 Test Acc: 0.446
Validation loss decreased (inf --> -0.445931).  Saving model ...
Epoch: 2 cost time: 2.4905033111572266
Epoch: 2, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.099 Vali Acc: 0.486 Test Loss: 1.099 Test Acc: 0.486
Validation loss decreased (-0.445931 --> -0.486476).  Saving model ...
Epoch: 3 cost time: 2.588085412979126
Epoch: 3, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.467 Vali Acc: 0.378 Test Loss: 1.467 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1436121463775635
Epoch: 4, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.334 Vali Acc: 0.473 Test Loss: 1.334 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3498423099517822
Epoch: 5, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.693 Vali Acc: 0.500 Test Loss: 1.693 Test Acc: 0.500
Validation loss decreased (-0.486476 --> -0.499983).  Saving model ...
Epoch: 6 cost time: 2.3527328968048096
Epoch: 6, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.681 Vali Acc: 0.527 Test Loss: 1.681 Test Acc: 0.527
Validation loss decreased (-0.499983 --> -0.527010).  Saving model ...
Epoch: 7 cost time: 2.476755380630493
Epoch: 7, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.744 Vali Acc: 0.514 Test Loss: 1.744 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5998921394348145
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.026 Vali Acc: 0.568 Test Loss: 2.026 Test Acc: 0.568
Validation loss decreased (-0.527010 --> -0.567547).  Saving model ...
Epoch: 9 cost time: 2.4268665313720703
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4533257484436035
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.859 Vali Acc: 0.541 Test Loss: 1.859 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8851256370544434
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.151 Vali Acc: 0.514 Test Loss: 2.151 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1466500759124756
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.993 Vali Acc: 0.514 Test Loss: 1.993 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.881469488143921
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.003 Vali Acc: 0.541 Test Loss: 2.003 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.984074831008911
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.010 Vali Acc: 0.514 Test Loss: 2.010 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.061695098876953
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.541 Test Loss: 2.015 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0563414096832275
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.989 Vali Acc: 0.527 Test Loss: 1.989 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.039839506149292
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.527 Test Loss: 1.976 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2002291679382324
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.527 Test Loss: 1.952 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1743476
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.872213840484619
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.434 Vali Acc: 0.446 Test Loss: 1.434 Test Acc: 0.446
Validation loss decreased (inf --> -0.445932).  Saving model ...
Epoch: 2 cost time: 1.8192996978759766
Epoch: 2, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.136 Vali Acc: 0.473 Test Loss: 1.136 Test Acc: 0.473
Validation loss decreased (-0.445932 --> -0.472962).  Saving model ...
Epoch: 3 cost time: 2.08748459815979
Epoch: 3, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.475 Vali Acc: 0.365 Test Loss: 1.475 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.149301528930664
Epoch: 4, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.001879930496216
Epoch: 5, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.522 Vali Acc: 0.500 Test Loss: 1.522 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.562030553817749
Epoch: 6, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.544 Vali Acc: 0.527 Test Loss: 1.544 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527012).  Saving model ...
Epoch: 7 cost time: 2.0191872119903564
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.708 Vali Acc: 0.514 Test Loss: 1.708 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4347939491271973
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.837 Vali Acc: 0.527 Test Loss: 1.837 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.127985954284668
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.933 Vali Acc: 0.405 Test Loss: 1.933 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.633873462677002
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.907 Vali Acc: 0.541 Test Loss: 1.907 Test Acc: 0.541
Validation loss decreased (-0.527012 --> -0.540521).  Saving model ...
Epoch: 11 cost time: 2.796011209487915
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.500 Test Loss: 1.822 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.41142201423645
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.514 Test Loss: 1.985 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6964378356933594
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.541 Test Loss: 1.873 Test Acc: 0.541
Validation loss decreased (-0.540521 --> -0.540522).  Saving model ...
Epoch: 14 cost time: 3.1673457622528076
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.500 Test Loss: 1.759 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0020639896392822
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.165379047393799
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.527 Test Loss: 1.833 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.739421844482422
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.541 Test Loss: 1.822 Test Acc: 0.541
Validation loss decreased (-0.540522 --> -0.540522).  Saving model ...
Epoch: 18 cost time: 2.566742420196533
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.514 Test Loss: 1.799 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6916213035583496
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.514 Test Loss: 1.802 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9934332370758057
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.541 Test Loss: 1.807 Test Acc: 0.541
Validation loss decreased (-0.540522 --> -0.540522).  Saving model ...
Epoch: 21 cost time: 2.2850918769836426
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.527 Test Loss: 1.814 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.59043025970459
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.527 Test Loss: 1.817 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5472466945648193
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.541 Test Loss: 1.815 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4602608680725098
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.541 Test Loss: 1.813 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.624220848083496
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.554 Test Loss: 1.820 Test Acc: 0.554
Validation loss decreased (-0.540522 --> -0.554036).  Saving model ...
Epoch: 26 cost time: 2.33376145362854
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.554 Test Loss: 1.823 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.765049457550049
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.554 Test Loss: 1.821 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.744372606277466
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.554 Test Loss: 1.825 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8853440284729004
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.541 Test Loss: 1.837 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.561730146408081
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.554 Test Loss: 1.826 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.979401111602783
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.554 Test Loss: 1.820 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.8250973224639893
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.554 Test Loss: 1.842 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.6042959690093994
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.541 Test Loss: 1.856 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.504354238510132
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.554 Test Loss: 1.854 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.652787446975708
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.554 Test Loss: 1.853 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1743476
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.676623344421387
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.427 Vali Acc: 0.432 Test Loss: 1.427 Test Acc: 0.432
Validation loss decreased (inf --> -0.432418).  Saving model ...
Epoch: 2 cost time: 2.1182806491851807
Epoch: 2, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.432418 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.921689510345459
Epoch: 3, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.472 Vali Acc: 0.392 Test Loss: 1.472 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.01806640625
Epoch: 4, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.7899439334869385
Epoch: 5, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.343 Vali Acc: 0.486 Test Loss: 1.343 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8591315746307373
Epoch: 6, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8972141742706299
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.899 Vali Acc: 0.446 Test Loss: 1.899 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.321852684020996
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.744 Vali Acc: 0.486 Test Loss: 1.744 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4933958053588867
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.895 Vali Acc: 0.446 Test Loss: 1.895 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.408939838409424
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.975 Vali Acc: 0.486 Test Loss: 1.975 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.175584316253662
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.817 Vali Acc: 0.500 Test Loss: 1.817 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.93357253074646
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.001 Vali Acc: 0.446 Test Loss: 2.001 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1955673694610596
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.486 Test Loss: 1.833 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4377520084381104
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.785 Vali Acc: 0.459 Test Loss: 1.785 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 1743476
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.330970525741577
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.457 Vali Acc: 0.446 Test Loss: 1.457 Test Acc: 0.446
Validation loss decreased (inf --> -0.445931).  Saving model ...
Epoch: 2 cost time: 2.4862310886383057
Epoch: 2, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4483678340911865
Epoch: 3, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.414 Vali Acc: 0.405 Test Loss: 1.414 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8535683155059814
Epoch: 4, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.888315200805664
Epoch: 5, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.372 Vali Acc: 0.432 Test Loss: 1.372 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.595283269882202
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.458 Vali Acc: 0.419 Test Loss: 1.458 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5795812606811523
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.565 Vali Acc: 0.446 Test Loss: 1.565 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5930848121643066
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.916 Vali Acc: 0.419 Test Loss: 1.916 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1959574222564697
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.733 Vali Acc: 0.459 Test Loss: 1.733 Test Acc: 0.459
Validation loss decreased (-0.445931 --> -0.459442).  Saving model ...
Epoch: 10 cost time: 2.0001986026763916
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.806 Vali Acc: 0.459 Test Loss: 1.806 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.801887035369873
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.419 Test Loss: 1.799 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8209373950958252
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.802 Vali Acc: 0.419 Test Loss: 1.802 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.440377712249756
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.432 Test Loss: 1.788 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4139697551727295
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.459 Test Loss: 1.791 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.122971296310425
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.432 Test Loss: 1.809 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7592918872833252
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.446 Test Loss: 1.815 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9365103244781494
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.446 Test Loss: 1.822 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8764219284057617
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.459 Test Loss: 1.815 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1148695945739746
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.473 Test Loss: 1.834 Test Acc: 0.473
Validation loss decreased (-0.459442 --> -0.472955).  Saving model ...
Epoch: 20 cost time: 2.26918625831604
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.473 Test Loss: 1.830 Test Acc: 0.473
Validation loss decreased (-0.472955 --> -0.472955).  Saving model ...
Epoch: 21 cost time: 2.1215391159057617
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.473 Test Loss: 1.826 Test Acc: 0.473
Validation loss decreased (-0.472955 --> -0.472955).  Saving model ...
Epoch: 22 cost time: 1.9180963039398193
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.459 Test Loss: 1.821 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.06701922416687
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.446 Test Loss: 1.822 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4625136852264404
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.432 Test Loss: 1.823 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7766563892364502
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.446 Test Loss: 1.826 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8090169429779053
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.473 Test Loss: 1.828 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6713860034942627
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.459 Test Loss: 1.830 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8878309726715088
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.446 Test Loss: 1.839 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8915479183197021
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.432 Test Loss: 1.853 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8828492164611816
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.473 Test Loss: 1.857 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.302732467651367
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.459 Test Loss: 1.859 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 1743476
model size : 11.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.875290870666504
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.256 Vali Acc: 0.405 Test Loss: 1.256 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 2.7851455211639404
Epoch: 2, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.129 Vali Acc: 0.486 Test Loss: 1.129 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 2.4394161701202393
Epoch: 3, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.412 Vali Acc: 0.446 Test Loss: 1.412 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.714164972305298
Epoch: 4, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527013).  Saving model ...
Epoch: 5 cost time: 2.766788959503174
Epoch: 5, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540526).  Saving model ...
Epoch: 6 cost time: 2.5031917095184326
Epoch: 6, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.753 Vali Acc: 0.459 Test Loss: 1.753 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5910398960113525
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.468 Vali Acc: 0.554 Test Loss: 1.468 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554039).  Saving model ...
Epoch: 8 cost time: 2.476933002471924
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6766583919525146
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.813 Vali Acc: 0.527 Test Loss: 1.813 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.425753116607666
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.806 Vali Acc: 0.541 Test Loss: 1.806 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3093109130859375
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.787 Vali Acc: 0.635 Test Loss: 1.787 Test Acc: 0.635
Validation loss decreased (-0.554039 --> -0.635117).  Saving model ...
Epoch: 12 cost time: 2.123460292816162
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.359 Vali Acc: 0.568 Test Loss: 2.359 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0956685543060303
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.717 Vali Acc: 0.608 Test Loss: 1.717 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4154508113861084
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.924 Vali Acc: 0.581 Test Loss: 1.924 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.878054618835449
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.115 Vali Acc: 0.581 Test Loss: 2.115 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2760512828826904
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.440 Vali Acc: 0.568 Test Loss: 2.440 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4200856685638428
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.429 Vali Acc: 0.527 Test Loss: 2.429 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4989593029022217
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.541 Test Loss: 2.337 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3076720237731934
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.514 Test Loss: 2.305 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4264330863952637
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.527 Test Loss: 2.271 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1126058101654053
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.222 Vali Acc: 0.527 Test Loss: 2.222 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1219188
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.8287694454193115
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.265 Vali Acc: 0.392 Test Loss: 1.265 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.0573983192443848
Epoch: 2, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.165 Vali Acc: 0.432 Test Loss: 1.165 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432421).  Saving model ...
Epoch: 3 cost time: 2.1980836391448975
Epoch: 3, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.368 Vali Acc: 0.419 Test Loss: 1.368 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2152836322784424
Epoch: 4, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.430 Vali Acc: 0.446 Test Loss: 1.430 Test Acc: 0.446
Validation loss decreased (-0.432421 --> -0.445932).  Saving model ...
Epoch: 5 cost time: 2.5511786937713623
Epoch: 5, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.465 Vali Acc: 0.486 Test Loss: 1.465 Test Acc: 0.486
Validation loss decreased (-0.445932 --> -0.486472).  Saving model ...
Epoch: 6 cost time: 2.0874264240264893
Epoch: 6, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.814 Vali Acc: 0.473 Test Loss: 1.814 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3376970291137695
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
Validation loss decreased (-0.486472 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 2.4707536697387695
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.761 Vali Acc: 0.541 Test Loss: 1.761 Test Acc: 0.541
Validation loss decreased (-0.499984 --> -0.540523).  Saving model ...
Epoch: 9 cost time: 2.686103105545044
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.856 Vali Acc: 0.486 Test Loss: 1.856 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4871928691864014
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.131 Vali Acc: 0.486 Test Loss: 2.131 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.338779926300049
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.852 Vali Acc: 0.581 Test Loss: 1.852 Test Acc: 0.581
Validation loss decreased (-0.540523 --> -0.581063).  Saving model ...
Epoch: 12 cost time: 2.1888649463653564
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.140 Vali Acc: 0.432 Test Loss: 2.140 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3199639320373535
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.415 Vali Acc: 0.405 Test Loss: 2.415 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7144782543182373
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.819 Vali Acc: 0.486 Test Loss: 2.819 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0558626651763916
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.513 Vali Acc: 0.486 Test Loss: 2.513 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3491504192352295
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.439 Vali Acc: 0.514 Test Loss: 2.439 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.598860502243042
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.715 Vali Acc: 0.473 Test Loss: 2.715 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7028470039367676
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.309 Vali Acc: 0.514 Test Loss: 2.309 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7148029804229736
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.527 Test Loss: 2.249 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.441810369491577
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.541 Test Loss: 2.223 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4365429878234863
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.541 Test Loss: 2.183 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1219188
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.04643988609314
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.281 Vali Acc: 0.392 Test Loss: 1.281 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 2.6629300117492676
Epoch: 2, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.9799373149871826
Epoch: 3, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.383 Vali Acc: 0.378 Test Loss: 1.383 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9891583919525146
Epoch: 4, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.277 Vali Acc: 0.541 Test Loss: 1.277 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 2.3723511695861816
Epoch: 5, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.397 Vali Acc: 0.541 Test Loss: 1.397 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7300362586975098
Epoch: 6, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1891849040985107
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.487 Vali Acc: 0.514 Test Loss: 1.487 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5385873317718506
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.528 Vali Acc: 0.514 Test Loss: 1.528 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9399187564849854
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3581159114837646
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.902 Vali Acc: 0.473 Test Loss: 1.902 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5109195709228516
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.527 Test Loss: 1.725 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7811143398284912
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.746 Vali Acc: 0.500 Test Loss: 1.746 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5809941291809082
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.473 Test Loss: 1.881 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.252427577972412
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.459 Test Loss: 1.738 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1219188
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.74036431312561
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.320 Vali Acc: 0.419 Test Loss: 1.320 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 2.4504802227020264
Epoch: 2, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.712242841720581
Epoch: 3, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.413 Vali Acc: 0.284 Test Loss: 1.413 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.245572090148926
Epoch: 4, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.335 Vali Acc: 0.459 Test Loss: 1.335 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 2.390392780303955
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.427 Vali Acc: 0.405 Test Loss: 1.427 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.665980815887451
Epoch: 6, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.361 Vali Acc: 0.486 Test Loss: 1.361 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486473).  Saving model ...
Epoch: 7 cost time: 2.121748208999634
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.755 Vali Acc: 0.459 Test Loss: 1.755 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.114337921142578
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.668 Vali Acc: 0.486 Test Loss: 1.668 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1042046546936035
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 2.4012787342071533
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.906 Vali Acc: 0.419 Test Loss: 1.906 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8663005828857422
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.838 Vali Acc: 0.419 Test Loss: 1.838 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.22187876701355
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.850 Vali Acc: 0.419 Test Loss: 1.850 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9475984573364258
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.796 Vali Acc: 0.459 Test Loss: 1.796 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2519402503967285
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.733 Vali Acc: 0.473 Test Loss: 1.733 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9613263607025146
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.473 Test Loss: 1.735 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1139354705810547
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.783 Vali Acc: 0.486 Test Loss: 1.783 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.200528383255005
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.473 Test Loss: 1.775 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.304964303970337
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.473 Test Loss: 1.760 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2377235889434814
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.486 Test Loss: 1.756 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 1219188
model size : 9.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.931038856506348
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.368 Vali Acc: 0.392 Test Loss: 1.368 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.408695697784424
Epoch: 2, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.192 Vali Acc: 0.446 Test Loss: 1.192 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 2.609064817428589
Epoch: 3, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5964932441711426
Epoch: 4, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.412 Vali Acc: 0.514 Test Loss: 1.412 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513499).  Saving model ...
Epoch: 5 cost time: 2.1826202869415283
Epoch: 5, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.403 Vali Acc: 0.554 Test Loss: 1.403 Test Acc: 0.554
Validation loss decreased (-0.513499 --> -0.554040).  Saving model ...
Epoch: 6 cost time: 2.343961238861084
Epoch: 6, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.621 Vali Acc: 0.554 Test Loss: 1.621 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3097829818725586
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.655 Vali Acc: 0.500 Test Loss: 1.655 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7461867332458496
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.049 Vali Acc: 0.473 Test Loss: 2.049 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7295079231262207
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.890 Vali Acc: 0.541 Test Loss: 1.890 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8557541370391846
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.031 Vali Acc: 0.500 Test Loss: 2.031 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.122697353363037
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.922 Vali Acc: 0.459 Test Loss: 1.922 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.277310848236084
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.920 Vali Acc: 0.473 Test Loss: 1.920 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4279773235321045
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.473 Test Loss: 1.968 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.358138084411621
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.459 Test Loss: 1.954 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.691523313522339
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.473 Test Loss: 1.913 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 957044
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.9835779666900635
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.365 Vali Acc: 0.365 Test Loss: 1.365 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.1388745307922363
Epoch: 2, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.249 Vali Acc: 0.405 Test Loss: 1.249 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 2.50673246383667
Epoch: 3, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.241 Vali Acc: 0.473 Test Loss: 1.241 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 2.2084360122680664
Epoch: 4, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 2.5163018703460693
Epoch: 5, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.356 Vali Acc: 0.541 Test Loss: 1.356 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540527).  Saving model ...
Epoch: 6 cost time: 2.43812894821167
Epoch: 6, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1393206119537354
Epoch: 7, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.409 Vali Acc: 0.568 Test Loss: 1.409 Test Acc: 0.568
Validation loss decreased (-0.540527 --> -0.567553).  Saving model ...
Epoch: 8 cost time: 2.2653138637542725
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.753 Vali Acc: 0.473 Test Loss: 1.753 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.444171667098999
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.856 Vali Acc: 0.541 Test Loss: 1.856 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.55460524559021
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.682 Vali Acc: 0.541 Test Loss: 1.682 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8900933265686035
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.636 Vali Acc: 0.473 Test Loss: 2.636 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0347084999084473
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.800 Vali Acc: 0.554 Test Loss: 1.800 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.327003002166748
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.108 Vali Acc: 0.527 Test Loss: 2.108 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.650294065475464
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.129 Vali Acc: 0.527 Test Loss: 2.129 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7537121772766113
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.021 Vali Acc: 0.554 Test Loss: 2.021 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.26578426361084
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.389 Vali Acc: 0.473 Test Loss: 2.389 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.338196277618408
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.756 Vali Acc: 0.486 Test Loss: 2.756 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 957044
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.186736106872559
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.368 Vali Acc: 0.338 Test Loss: 1.368 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.0028693675994873
Epoch: 2, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.307 Vali Acc: 0.338 Test Loss: 1.307 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 2.19891619682312
Epoch: 3, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.240 Vali Acc: 0.419 Test Loss: 1.240 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.647958517074585
Epoch: 4, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.9024040699005127
Epoch: 5, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 6 cost time: 2.3388442993164062
Epoch: 6, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.575 Vali Acc: 0.541 Test Loss: 1.575 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540525).  Saving model ...
Epoch: 7 cost time: 2.5517516136169434
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.641 Vali Acc: 0.554 Test Loss: 1.641 Test Acc: 0.554
Validation loss decreased (-0.540525 --> -0.554038).  Saving model ...
Epoch: 8 cost time: 2.0253958702087402
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.675 Vali Acc: 0.459 Test Loss: 1.675 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.039147138595581
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.831 Vali Acc: 0.459 Test Loss: 1.831 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9923789501190186
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.887 Vali Acc: 0.473 Test Loss: 1.887 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.575620651245117
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.066 Vali Acc: 0.459 Test Loss: 2.066 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1084372997283936
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8875324726104736
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.204 Vali Acc: 0.486 Test Loss: 2.204 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8924198150634766
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.093 Vali Acc: 0.486 Test Loss: 2.093 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.047834873199463
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.095 Vali Acc: 0.541 Test Loss: 2.095 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9856960773468018
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.527 Test Loss: 1.965 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0442984104156494
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.554 Test Loss: 1.983 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 957044
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.39216947555542
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.233833074569702
Epoch: 2, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
Validation loss decreased (-0.297283 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 2.1931710243225098
Epoch: 3, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
Validation loss decreased (-0.297284 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 2.2133448123931885
Epoch: 4, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.319 Vali Acc: 0.459 Test Loss: 1.319 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 2.122744083404541
Epoch: 5, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.311 Vali Acc: 0.446 Test Loss: 1.311 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.05021595954895
Epoch: 6, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.506 Vali Acc: 0.486 Test Loss: 1.506 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486471).  Saving model ...
Epoch: 7 cost time: 1.8507192134857178
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.513 Vali Acc: 0.541 Test Loss: 1.513 Test Acc: 0.541
Validation loss decreased (-0.486471 --> -0.540525).  Saving model ...
Epoch: 8 cost time: 2.116795301437378
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.280503273010254
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.336 Vali Acc: 0.378 Test Loss: 2.336 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.165799140930176
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.708 Vali Acc: 0.446 Test Loss: 1.708 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2350988388061523
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.994 Vali Acc: 0.473 Test Loss: 1.994 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.123295545578003
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.071 Vali Acc: 0.473 Test Loss: 2.071 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9937567710876465
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.203 Vali Acc: 0.459 Test Loss: 2.203 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8283123970031738
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.091 Vali Acc: 0.392 Test Loss: 2.091 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6606178283691406
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.961 Vali Acc: 0.459 Test Loss: 1.961 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.877164602279663
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.957 Vali Acc: 0.446 Test Loss: 1.957 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9423537254333496
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.057 Vali Acc: 0.419 Test Loss: 2.057 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 957044
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.751641750335693
Epoch: 1, Steps: 10 | Train Loss: 1.580 Vali Loss: 1.328 Vali Acc: 0.365 Test Loss: 1.328 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 2.1194210052490234
Epoch: 2, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.380 Vali Acc: 0.378 Test Loss: 1.380 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 2.2573790550231934
Epoch: 3, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.317 Vali Acc: 0.473 Test Loss: 1.317 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 2.552659034729004
Epoch: 4, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527013).  Saving model ...
Epoch: 5 cost time: 2.08638596534729
Epoch: 5, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.664 Vali Acc: 0.568 Test Loss: 1.664 Test Acc: 0.568
Validation loss decreased (-0.527013 --> -0.567551).  Saving model ...
Epoch: 6 cost time: 2.230559825897217
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.407 Vali Acc: 0.541 Test Loss: 1.407 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1829912662506104
Epoch: 7, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.296 Vali Acc: 0.581 Test Loss: 1.296 Test Acc: 0.581
Validation loss decreased (-0.567551 --> -0.581068).  Saving model ...
Epoch: 8 cost time: 2.1308531761169434
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.500 Vali Acc: 0.595 Test Loss: 1.500 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594580).  Saving model ...
Epoch: 9 cost time: 2.486309289932251
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.870 Vali Acc: 0.527 Test Loss: 1.870 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.669576644897461
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.041 Vali Acc: 0.527 Test Loss: 2.041 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6065478324890137
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.038 Vali Acc: 0.554 Test Loss: 2.038 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.31427264213562
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.853 Vali Acc: 0.581 Test Loss: 1.853 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.183892011642456
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.005 Vali Acc: 0.595 Test Loss: 2.005 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.014263868331909
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.097 Vali Acc: 0.581 Test Loss: 2.097 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.911426305770874
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.237 Vali Acc: 0.622 Test Loss: 2.237 Test Acc: 0.622
Validation loss decreased (-0.594580 --> -0.621599).  Saving model ...
Epoch: 16 cost time: 2.156177043914795
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.273 Vali Acc: 0.500 Test Loss: 2.273 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1266050338745117
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.128 Vali Acc: 0.595 Test Loss: 2.128 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4605259895324707
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.525 Vali Acc: 0.581 Test Loss: 2.525 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2653486728668213
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.502 Vali Acc: 0.554 Test Loss: 2.502 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.540095329284668
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.282 Vali Acc: 0.541 Test Loss: 2.282 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.476299285888672
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.656 Vali Acc: 0.500 Test Loss: 2.656 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.33772349357605
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.647 Vali Acc: 0.541 Test Loss: 3.647 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5357916355133057
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.307 Vali Acc: 0.459 Test Loss: 3.307 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1307246685028076
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.406 Vali Acc: 0.568 Test Loss: 3.406 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3324286937713623
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.524 Vali Acc: 0.473 Test Loss: 4.524 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 825972
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.729830265045166
Epoch: 1, Steps: 10 | Train Loss: 1.572 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 2.1964919567108154
Epoch: 2, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.376 Vali Acc: 0.405 Test Loss: 1.376 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.9099349975585938
Epoch: 3, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.1822309494018555
Epoch: 4, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.357 Vali Acc: 0.486 Test Loss: 1.357 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.240112066268921
Epoch: 5, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 2.119015693664551
Epoch: 6, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.797 Vali Acc: 0.473 Test Loss: 1.797 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9217100143432617
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.526 Vali Acc: 0.486 Test Loss: 1.526 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9095804691314697
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.516 Vali Acc: 0.486 Test Loss: 1.516 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0281713008880615
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
Validation loss decreased (-0.499982 --> -0.527010).  Saving model ...
Epoch: 10 cost time: 1.9641764163970947
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.743 Vali Acc: 0.432 Test Loss: 2.743 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7050533294677734
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.258 Vali Acc: 0.459 Test Loss: 2.258 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9034900665283203
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.956 Vali Acc: 0.554 Test Loss: 1.956 Test Acc: 0.554
Validation loss decreased (-0.527010 --> -0.554034).  Saving model ...
Epoch: 13 cost time: 1.8183963298797607
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.994 Vali Acc: 0.514 Test Loss: 1.994 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9269585609436035
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.523 Vali Acc: 0.446 Test Loss: 2.523 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.484847068786621
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0926501750946045
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.865 Vali Acc: 0.459 Test Loss: 2.865 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.323974370956421
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.488 Vali Acc: 0.527 Test Loss: 2.488 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4869940280914307
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.460 Vali Acc: 0.541 Test Loss: 2.460 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.333888053894043
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.606 Vali Acc: 0.527 Test Loss: 2.606 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.486511468887329
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.693 Vali Acc: 0.419 Test Loss: 3.693 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3855137825012207
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 2.793 Vali Acc: 0.500 Test Loss: 2.793 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.141193151473999
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.626 Vali Acc: 0.541 Test Loss: 2.626 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 825972
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.881772756576538
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.354 Vali Acc: 0.297 Test Loss: 1.354 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.314723253250122
Epoch: 2, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.347 Vali Acc: 0.419 Test Loss: 1.347 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 2.3265633583068848
Epoch: 3, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 2.0975263118743896
Epoch: 4, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.310 Vali Acc: 0.446 Test Loss: 1.310 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8882083892822266
Epoch: 5, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.596 Vali Acc: 0.473 Test Loss: 1.596 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472957).  Saving model ...
Epoch: 6 cost time: 1.9748127460479736
Epoch: 6, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.588 Vali Acc: 0.473 Test Loss: 1.588 Test Acc: 0.473
Validation loss decreased (-0.472957 --> -0.472957).  Saving model ...
Epoch: 7 cost time: 1.6929919719696045
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.900 Vali Acc: 0.473 Test Loss: 1.900 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8869483470916748
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
Validation loss decreased (-0.472957 --> -0.527011).  Saving model ...
Epoch: 9 cost time: 1.6374232769012451
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.684 Vali Acc: 0.514 Test Loss: 1.684 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5146684646606445
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.448 Vali Acc: 0.446 Test Loss: 2.448 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.701258659362793
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.414 Vali Acc: 0.486 Test Loss: 2.414 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.057565927505493
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.017 Vali Acc: 0.500 Test Loss: 2.017 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.189469337463379
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.786 Vali Acc: 0.486 Test Loss: 2.786 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1372873783111572
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.305 Vali Acc: 0.514 Test Loss: 2.305 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7678403854370117
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.530 Vali Acc: 0.500 Test Loss: 2.530 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1293888092041016
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.299 Vali Acc: 0.514 Test Loss: 2.299 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.173581123352051
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.783 Vali Acc: 0.486 Test Loss: 2.783 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3083088397979736
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.731 Vali Acc: 0.473 Test Loss: 2.731 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 825972
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.112837553024292
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.364 Vali Acc: 0.324 Test Loss: 1.364 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.9575583934783936
Epoch: 2, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.310 Vali Acc: 0.432 Test Loss: 1.310 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.735184907913208
Epoch: 3, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 2.3258697986602783
Epoch: 4, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.278 Vali Acc: 0.473 Test Loss: 1.278 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 2.1969099044799805
Epoch: 5, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.332 Vali Acc: 0.500 Test Loss: 1.332 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.092621326446533
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.635 Vali Acc: 0.486 Test Loss: 1.635 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9288051128387451
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.699 Vali Acc: 0.392 Test Loss: 1.699 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8385076522827148
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.577 Vali Acc: 0.459 Test Loss: 1.577 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7306311130523682
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.506 Vali Acc: 0.541 Test Loss: 1.506 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540525).  Saving model ...
Epoch: 10 cost time: 2.282949686050415
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.728 Vali Acc: 0.459 Test Loss: 1.728 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2437822818756104
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.642 Vali Acc: 0.486 Test Loss: 1.642 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8576829433441162
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.459 Test Loss: 1.799 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0428662300109863
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.486 Test Loss: 1.720 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.341338634490967
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.486 Test Loss: 1.746 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9554047584533691
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.459 Test Loss: 1.744 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8619537353515625
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.446 Test Loss: 1.737 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.976137638092041
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.459 Test Loss: 1.745 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4612319469451904
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.446 Test Loss: 1.767 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.586303234100342
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.446 Test Loss: 1.766 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 825972
model size : 8.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.7170188426971436
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 2.268627405166626
Epoch: 2, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.643 Vali Acc: 0.311 Test Loss: 1.643 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.374427318572998
Epoch: 3, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.270279884338379
Epoch: 4, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.627 Vali Acc: 0.432 Test Loss: 1.627 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5752997398376465
Epoch: 5, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.357 Vali Acc: 0.486 Test Loss: 1.357 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3739359378814697
Epoch: 6, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.257 Vali Acc: 0.568 Test Loss: 1.257 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567555).  Saving model ...
Epoch: 7 cost time: 2.061382293701172
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.377 Vali Acc: 0.622 Test Loss: 1.377 Test Acc: 0.622
Validation loss decreased (-0.567555 --> -0.621608).  Saving model ...
Epoch: 8 cost time: 2.2718138694763184
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.787 Vali Acc: 0.486 Test Loss: 1.787 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5107057094573975
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.898 Vali Acc: 0.554 Test Loss: 1.898 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.264772653579712
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.038 Vali Acc: 0.527 Test Loss: 2.038 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3233909606933594
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.982 Vali Acc: 0.527 Test Loss: 1.982 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3693175315856934
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.367 Vali Acc: 0.432 Test Loss: 2.367 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9986927509307861
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.096 Vali Acc: 0.486 Test Loss: 2.096 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0391669273376465
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.275 Vali Acc: 0.473 Test Loss: 2.275 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.213465929031372
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.503 Vali Acc: 0.514 Test Loss: 2.503 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1937766075134277
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.400 Vali Acc: 0.514 Test Loss: 2.400 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3080570697784424
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.428 Vali Acc: 0.527 Test Loss: 2.428 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 760436
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.71803617477417
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.255 Vali Acc: 0.446 Test Loss: 1.255 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 2.4212028980255127
Epoch: 2, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.631 Vali Acc: 0.311 Test Loss: 1.631 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.546113967895508
Epoch: 3, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.297 Vali Acc: 0.473 Test Loss: 1.297 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 2.466561794281006
Epoch: 4, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.806 Vali Acc: 0.419 Test Loss: 1.806 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.376300096511841
Epoch: 5, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.448 Vali Acc: 0.486 Test Loss: 1.448 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486472).  Saving model ...
Epoch: 6 cost time: 2.3152682781219482
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
Validation loss decreased (-0.486472 --> -0.527013).  Saving model ...
Epoch: 7 cost time: 2.3918378353118896
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.713 Vali Acc: 0.514 Test Loss: 1.713 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6506314277648926
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.187 Vali Acc: 0.459 Test Loss: 2.187 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5485689640045166
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.926 Vali Acc: 0.486 Test Loss: 1.926 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2032089233398438
Epoch: 10, Steps: 10 | Train Loss: 0.140 Vali Loss: 2.038 Vali Acc: 0.486 Test Loss: 2.038 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3710992336273193
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.059 Vali Acc: 0.473 Test Loss: 2.059 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0883426666259766
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 2.729 Vali Acc: 0.541 Test Loss: 2.729 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540513).  Saving model ...
Epoch: 13 cost time: 2.6257901191711426
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.970 Vali Acc: 0.459 Test Loss: 1.970 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8131470680236816
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.079 Vali Acc: 0.473 Test Loss: 2.079 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.679910182952881
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.135 Vali Acc: 0.486 Test Loss: 2.135 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6425368785858154
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.491 Vali Acc: 0.514 Test Loss: 2.491 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3679208755493164
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.486 Test Loss: 2.086 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.377722978591919
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.303 Vali Acc: 0.459 Test Loss: 2.303 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.543170928955078
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.393 Vali Acc: 0.500 Test Loss: 2.393 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6535139083862305
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.514 Test Loss: 2.345 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.506920337677002
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.500 Test Loss: 2.194 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3187952041625977
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.500 Test Loss: 2.164 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 760436
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.406742095947266
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.260 Vali Acc: 0.392 Test Loss: 1.260 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.8415744304656982
Epoch: 2, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.653 Vali Acc: 0.284 Test Loss: 1.653 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.000542163848877
Epoch: 3, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.511 Vali Acc: 0.378 Test Loss: 1.511 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8392138481140137
Epoch: 4, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.831 Vali Acc: 0.419 Test Loss: 1.831 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418901).  Saving model ...
Epoch: 5 cost time: 2.103729009628296
Epoch: 5, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.441 Vali Acc: 0.432 Test Loss: 1.441 Test Acc: 0.432
Validation loss decreased (-0.418901 --> -0.432418).  Saving model ...
Epoch: 6 cost time: 1.8652517795562744
Epoch: 6, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.391 Vali Acc: 0.473 Test Loss: 1.391 Test Acc: 0.473
Validation loss decreased (-0.432418 --> -0.472959).  Saving model ...
Epoch: 7 cost time: 2.0563836097717285
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.526 Vali Acc: 0.500 Test Loss: 1.526 Test Acc: 0.500
Validation loss decreased (-0.472959 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 2.0160036087036133
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.766 Vali Acc: 0.541 Test Loss: 1.766 Test Acc: 0.541
Validation loss decreased (-0.499985 --> -0.540523).  Saving model ...
Epoch: 9 cost time: 2.1778926849365234
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.610 Vali Acc: 0.527 Test Loss: 1.610 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.068013906478882
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.701 Vali Acc: 0.514 Test Loss: 1.701 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.782841682434082
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.208 Vali Acc: 0.514 Test Loss: 2.208 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9990360736846924
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0494678020477295
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.995 Vali Acc: 0.473 Test Loss: 1.995 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8094909191131592
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.154 Vali Acc: 0.514 Test Loss: 2.154 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7397468090057373
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.090 Vali Acc: 0.486 Test Loss: 2.090 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0282628536224365
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.219 Vali Acc: 0.459 Test Loss: 2.219 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.058305263519287
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.277 Vali Acc: 0.446 Test Loss: 2.277 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9514787197113037
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.446 Test Loss: 2.260 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 760436
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2085490226745605
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.299 Vali Acc: 0.351 Test Loss: 1.299 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.9836974143981934
Epoch: 2, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.571 Vali Acc: 0.270 Test Loss: 1.571 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0044562816619873
Epoch: 3, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.543 Vali Acc: 0.338 Test Loss: 1.543 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.171332836151123
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.752 Vali Acc: 0.405 Test Loss: 1.752 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405388).  Saving model ...
Epoch: 5 cost time: 1.9472026824951172
Epoch: 5, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.442 Vali Acc: 0.446 Test Loss: 1.442 Test Acc: 0.446
Validation loss decreased (-0.405388 --> -0.445932).  Saving model ...
Epoch: 6 cost time: 1.8466103076934814
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.395 Vali Acc: 0.432 Test Loss: 1.395 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.291949510574341
Epoch: 7, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.458 Vali Acc: 0.446 Test Loss: 1.458 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.284947633743286
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.809 Vali Acc: 0.432 Test Loss: 1.809 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.209946632385254
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.874 Vali Acc: 0.405 Test Loss: 1.874 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0645596981048584
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.798 Vali Acc: 0.432 Test Loss: 1.798 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9385218620300293
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.935 Vali Acc: 0.486 Test Loss: 1.935 Test Acc: 0.486
Validation loss decreased (-0.445932 --> -0.486467).  Saving model ...
Epoch: 12 cost time: 1.875389575958252
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.969 Vali Acc: 0.432 Test Loss: 1.969 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9534072875976562
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.007 Vali Acc: 0.459 Test Loss: 2.007 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.04060435295105
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.924 Vali Acc: 0.473 Test Loss: 1.924 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.880157470703125
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.928 Vali Acc: 0.432 Test Loss: 1.928 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7796409130096436
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.419 Test Loss: 1.856 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9252433776855469
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.459 Test Loss: 1.805 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.967846393585205
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.459 Test Loss: 1.815 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8362541198730469
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.432 Test Loss: 1.810 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9830920696258545
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.446 Test Loss: 1.813 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7976951599121094
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.486 Test Loss: 1.815 Test Acc: 0.486
Validation loss decreased (-0.486467 --> -0.486468).  Saving model ...
Epoch: 22 cost time: 1.9195787906646729
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.473 Test Loss: 1.827 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9435615539550781
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.459 Test Loss: 1.834 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.976872205734253
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.432 Test Loss: 1.828 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0322189331054688
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.432 Test Loss: 1.835 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.004316806793213
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.459 Test Loss: 1.848 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.692939281463623
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.459 Test Loss: 1.851 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9199767112731934
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.459 Test Loss: 1.854 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9733145236968994
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.446 Test Loss: 1.862 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.0882768630981445
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.459 Test Loss: 1.867 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.127351760864258
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.877 Vali Acc: 0.459 Test Loss: 1.877 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 760436
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.302011966705322
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.410 Vali Acc: 0.257 Test Loss: 1.410 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.063985586166382
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.251 Vali Acc: 0.365 Test Loss: 1.251 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.9638056755065918
Epoch: 3, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.2585506439208984
Epoch: 4, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4555153846740723
Epoch: 5, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.088357925415039
Epoch: 6, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.101486921310425
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.251 Vali Acc: 0.554 Test Loss: 1.251 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 2.444260358810425
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.381 Vali Acc: 0.514 Test Loss: 1.381 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6527230739593506
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.518 Vali Acc: 0.541 Test Loss: 1.518 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1997387409210205
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.414 Vali Acc: 0.486 Test Loss: 1.414 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.302093267440796
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4097907543182373
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.445 Vali Acc: 0.541 Test Loss: 1.445 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.273648738861084
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.318 Vali Acc: 0.595 Test Loss: 1.318 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594581).  Saving model ...
Epoch: 14 cost time: 2.5011463165283203
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.298 Vali Acc: 0.581 Test Loss: 1.298 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.62977933883667
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0674595832824707
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.568 Test Loss: 1.340 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2506589889526367
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.581 Test Loss: 1.332 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9435505867004395
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.568 Test Loss: 1.327 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.743032455444336
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.568 Test Loss: 1.339 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0351498126983643
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.581 Test Loss: 1.388 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6384928226470947
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.568 Test Loss: 1.398 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.033864736557007
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.568 Test Loss: 1.381 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.270564079284668
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.581 Test Loss: 1.385 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1330548
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.210735321044922
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.8881134986877441
Epoch: 2, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.244 Vali Acc: 0.432 Test Loss: 1.244 Test Acc: 0.432
Validation loss decreased (-0.270256 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.9952783584594727
Epoch: 3, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.8742833137512207
Epoch: 4, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.897564172744751
Epoch: 5, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.264 Vali Acc: 0.432 Test Loss: 1.264 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9576172828674316
Epoch: 6, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7947914600372314
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527014).  Saving model ...
Epoch: 8 cost time: 1.7761993408203125
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.405 Vali Acc: 0.554 Test Loss: 1.405 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554040).  Saving model ...
Epoch: 9 cost time: 1.9814958572387695
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.454 Vali Acc: 0.514 Test Loss: 1.454 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8669302463531494
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5105493068695068
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.350 Vali Acc: 0.554 Test Loss: 1.350 Test Acc: 0.554
Validation loss decreased (-0.554040 --> -0.554041).  Saving model ...
Epoch: 12 cost time: 1.7724623680114746
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.295 Vali Acc: 0.541 Test Loss: 1.295 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6660737991333008
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.320 Vali Acc: 0.554 Test Loss: 1.320 Test Acc: 0.554
Validation loss decreased (-0.554041 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 1.6301441192626953
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.568 Test Loss: 1.349 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567554).  Saving model ...
Epoch: 15 cost time: 1.7391796112060547
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
Validation loss decreased (-0.567554 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 1.8780274391174316
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.554 Test Loss: 1.346 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8918812274932861
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7205054759979248
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.568 Test Loss: 1.381 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8488125801086426
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.554 Test Loss: 1.394 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9247760772705078
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.554 Test Loss: 1.410 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9071972370147705
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.554 Test Loss: 1.414 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.058588981628418
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.568 Test Loss: 1.418 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.033250331878662
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.568 Test Loss: 1.431 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1435532569885254
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.554 Test Loss: 1.415 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8880231380462646
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.568 Test Loss: 1.426 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1330548
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.282526969909668
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.822960376739502
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.254 Vali Acc: 0.419 Test Loss: 1.254 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.6959812641143799
Epoch: 3, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.6979191303253174
Epoch: 4, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.142 Vali Acc: 0.473 Test Loss: 1.142 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8941831588745117
Epoch: 5, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.325 Vali Acc: 0.405 Test Loss: 1.325 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8167047500610352
Epoch: 6, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9770286083221436
Epoch: 7, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.742079257965088
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.452 Vali Acc: 0.473 Test Loss: 1.452 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8896822929382324
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.492 Vali Acc: 0.527 Test Loss: 1.492 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527012).  Saving model ...
Epoch: 10 cost time: 1.6205830574035645
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.317 Vali Acc: 0.486 Test Loss: 1.317 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8519742488861084
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.337 Vali Acc: 0.554 Test Loss: 1.337 Test Acc: 0.554
Validation loss decreased (-0.527012 --> -0.554041).  Saving model ...
Epoch: 12 cost time: 1.8874671459197998
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.278 Vali Acc: 0.541 Test Loss: 1.278 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8341715335845947
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9107441902160645
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.370 Vali Acc: 0.541 Test Loss: 1.370 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9475054740905762
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.554 Test Loss: 1.350 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3114826679229736
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8771350383758545
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.380 Vali Acc: 0.541 Test Loss: 1.380 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8148927688598633
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.377 Vali Acc: 0.541 Test Loss: 1.377 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0323305130004883
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.554 Test Loss: 1.401 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8029472827911377
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.541 Test Loss: 1.416 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8112037181854248
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.541 Test Loss: 1.427 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1330548
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.900604486465454
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.7474663257598877
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.284 Vali Acc: 0.378 Test Loss: 1.284 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 1.9380018711090088
Epoch: 3, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.7506401538848877
Epoch: 4, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.206 Vali Acc: 0.473 Test Loss: 1.206 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.863454818725586
Epoch: 5, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.399 Vali Acc: 0.297 Test Loss: 1.399 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6132819652557373
Epoch: 6, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.8865001201629639
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.281 Vali Acc: 0.486 Test Loss: 1.281 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.5533804893493652
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 1.8907802104949951
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.467 Vali Acc: 0.446 Test Loss: 1.467 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9878745079040527
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.461 Vali Acc: 0.500 Test Loss: 1.461 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9049432277679443
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9038004875183105
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.593 Vali Acc: 0.500 Test Loss: 1.593 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7916057109832764
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.783447504043579
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.521 Vali Acc: 0.473 Test Loss: 1.521 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.848724365234375
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.508 Vali Acc: 0.486 Test Loss: 1.508 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8156206607818604
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.473 Test Loss: 1.527 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.138123035430908
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.538 Vali Acc: 0.473 Test Loss: 1.538 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9243156909942627
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.473 Test Loss: 1.542 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1330548
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.4663310050964355
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.314 Vali Acc: 0.351 Test Loss: 1.314 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.8438496589660645
Epoch: 2, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.351338 --> -0.513502).  Saving model ...
Epoch: 3 cost time: 2.2153775691986084
Epoch: 3, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.110 Vali Acc: 0.486 Test Loss: 1.110 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0463335514068604
Epoch: 4, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
Validation loss decreased (-0.513502 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 1.908665418624878
Epoch: 5, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.812260389328003
Epoch: 6, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8477370738983154
Epoch: 7, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0177149772644043
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.069692373275757
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.266 Vali Acc: 0.541 Test Loss: 1.266 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1836764812469482
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.384 Vali Acc: 0.541 Test Loss: 1.384 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9880805015563965
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.388 Vali Acc: 0.581 Test Loss: 1.388 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8235270977020264
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.581 Test Loss: 1.352 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9389960765838623
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9291355609893799
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.395 Vali Acc: 0.581 Test Loss: 1.395 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 806260
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.27158784866333
Epoch: 1, Steps: 10 | Train Loss: 1.554 Vali Loss: 1.349 Vali Acc: 0.284 Test Loss: 1.349 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.832871913909912
Epoch: 2, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 1.7367777824401855
Epoch: 3, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.8249166011810303
Epoch: 4, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 1.8335740566253662
Epoch: 5, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9164559841156006
Epoch: 6, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7766637802124023
Epoch: 7, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8187298774719238
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.134 Vali Acc: 0.554 Test Loss: 1.134 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.90964937210083
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8710241317749023
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.583 Vali Acc: 0.541 Test Loss: 1.583 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9231514930725098
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.092154026031494
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.511 Vali Acc: 0.541 Test Loss: 1.511 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1636087894439697
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.899383783340454
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 806260
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.898885488510132
Epoch: 1, Steps: 10 | Train Loss: 1.528 Vali Loss: 1.346 Vali Acc: 0.270 Test Loss: 1.346 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.7553009986877441
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.270257 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.7587201595306396
Epoch: 3, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.189 Vali Acc: 0.405 Test Loss: 1.189 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8593974113464355
Epoch: 4, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.729813575744629
Epoch: 5, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.824573278427124
Epoch: 6, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.207 Vali Acc: 0.459 Test Loss: 1.207 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9499328136444092
Epoch: 7, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9277193546295166
Epoch: 8, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8649370670318604
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.391 Vali Acc: 0.446 Test Loss: 1.391 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8013215065002441
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.666 Vali Acc: 0.473 Test Loss: 1.666 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8647286891937256
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.468 Vali Acc: 0.486 Test Loss: 1.468 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8477036952972412
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.704 Vali Acc: 0.486 Test Loss: 1.704 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8705182075500488
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.614 Vali Acc: 0.459 Test Loss: 1.614 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7302260398864746
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.607 Vali Acc: 0.473 Test Loss: 1.607 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 806260
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9930286407470703
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.5927724838256836
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.280 Vali Acc: 0.446 Test Loss: 1.280 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.7996556758880615
Epoch: 3, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7138354778289795
Epoch: 4, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.247 Vali Acc: 0.527 Test Loss: 1.247 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.8124821186065674
Epoch: 5, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.329 Vali Acc: 0.432 Test Loss: 1.329 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8596243858337402
Epoch: 6, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8759119510650635
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7344801425933838
Epoch: 8, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1803576946258545
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.419 Vali Acc: 0.473 Test Loss: 1.419 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9427950382232666
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.687 Vali Acc: 0.378 Test Loss: 1.687 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6239264011383057
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.620 Vali Acc: 0.419 Test Loss: 1.620 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.84415864944458
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7239024639129639
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.615 Vali Acc: 0.459 Test Loss: 1.615 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6940369606018066
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.589 Vali Acc: 0.459 Test Loss: 1.589 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 806260
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.375079393386841
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.412 Vali Acc: 0.257 Test Loss: 1.412 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.935023546218872
Epoch: 2, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.374 Vali Acc: 0.392 Test Loss: 1.374 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 2.2003793716430664
Epoch: 3, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.391878 --> -0.540530).  Saving model ...
Epoch: 4 cost time: 2.01314115524292
Epoch: 4, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.046975612640381
Epoch: 5, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8877453804016113
Epoch: 6, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7030141353607178
Epoch: 7, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.014953136444092
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.143 Vali Acc: 0.608 Test Loss: 1.143 Test Acc: 0.608
Validation loss decreased (-0.540530 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 2.036069393157959
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.277 Vali Acc: 0.568 Test Loss: 1.277 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0754473209381104
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.450 Vali Acc: 0.568 Test Loss: 1.450 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.15966796875
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.115178346633911
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.607 Vali Acc: 0.568 Test Loss: 1.607 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8770177364349365
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.594 Vali Acc: 0.500 Test Loss: 1.594 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6617364883422852
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.878 Vali Acc: 0.541 Test Loss: 1.878 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8442506790161133
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.608 Vali Acc: 0.446 Test Loss: 1.608 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.069011926651001
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.892 Vali Acc: 0.541 Test Loss: 1.892 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.076805353164673
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.624 Vali Acc: 0.527 Test Loss: 1.624 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.924412727355957
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.613 Vali Acc: 0.541 Test Loss: 1.613 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 544116
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.0857884883880615
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.394 Vali Acc: 0.257 Test Loss: 1.394 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.5675833225250244
Epoch: 2, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.373 Vali Acc: 0.378 Test Loss: 1.373 Test Acc: 0.378
Validation loss decreased (-0.256743 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.7032313346862793
Epoch: 3, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.378365 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.6914160251617432
Epoch: 4, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8637137413024902
Epoch: 5, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6216742992401123
Epoch: 6, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7373814582824707
Epoch: 7, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7859296798706055
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.191 Vali Acc: 0.527 Test Loss: 1.191 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7007546424865723
Epoch: 9, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7982559204101562
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8330650329589844
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.651 Vali Acc: 0.486 Test Loss: 1.651 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8633842468261719
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7635281085968018
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.912 Vali Acc: 0.432 Test Loss: 1.912 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 544116
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.626891374588013
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.2501285076141357
Epoch: 2, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.426 Vali Acc: 0.378 Test Loss: 1.426 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378364).  Saving model ...
Epoch: 3 cost time: 1.9007418155670166
Epoch: 3, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.378364 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.0000224113464355
Epoch: 4, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.293 Vali Acc: 0.446 Test Loss: 1.293 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3443503379821777
Epoch: 5, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1839568614959717
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.222 Vali Acc: 0.473 Test Loss: 1.222 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.954930067062378
Epoch: 7, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6310462951660156
Epoch: 8, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 1.9430017471313477
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.426 Vali Acc: 0.500 Test Loss: 1.426 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.87882399559021
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.530 Vali Acc: 0.432 Test Loss: 1.530 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0153210163116455
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.684 Vali Acc: 0.405 Test Loss: 1.684 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0957748889923096
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6488680839538574
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.822 Vali Acc: 0.432 Test Loss: 1.822 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.749110460281372
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.627 Vali Acc: 0.500 Test Loss: 1.627 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8948090076446533
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.680 Vali Acc: 0.459 Test Loss: 1.680 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9087634086608887
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.770 Vali Acc: 0.446 Test Loss: 1.770 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9293718338012695
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.755 Vali Acc: 0.486 Test Loss: 1.755 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.149442434310913
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.432 Test Loss: 1.710 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 544116
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.60908842086792
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.344 Vali Acc: 0.270 Test Loss: 1.344 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.4366083145141602
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.385 Vali Acc: 0.459 Test Loss: 1.385 Test Acc: 0.459
Validation loss decreased (-0.270257 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.4708528518676758
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6938416957855225
Epoch: 4, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.370 Vali Acc: 0.405 Test Loss: 1.370 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6677234172821045
Epoch: 5, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.301 Vali Acc: 0.378 Test Loss: 1.301 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6148862838745117
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.3994557857513428
Epoch: 7, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.404 Vali Acc: 0.324 Test Loss: 1.404 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7737901210784912
Epoch: 8, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.358 Vali Acc: 0.432 Test Loss: 1.358 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6004161834716797
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.452 Vali Acc: 0.446 Test Loss: 1.452 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5216810703277588
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.335 Vali Acc: 0.446 Test Loss: 1.335 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7013018131256104
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.765 Vali Acc: 0.338 Test Loss: 1.765 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9223392009735107
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.558 Vali Acc: 0.432 Test Loss: 1.558 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6992864608764648
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.671 Vali Acc: 0.419 Test Loss: 1.671 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5166471004486084
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.566 Vali Acc: 0.486 Test Loss: 1.566 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5213298797607422
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.648 Vali Acc: 0.419 Test Loss: 1.648 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5428078174591064
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.446 Test Loss: 1.541 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 544116
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2966978549957275
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.0456502437591553
Epoch: 2, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.140 Vali Acc: 0.459 Test Loss: 1.140 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459448).  Saving model ...
Epoch: 3 cost time: 1.9874658584594727
Epoch: 3, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
Validation loss decreased (-0.459448 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 2.152550220489502
Epoch: 4, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9053971767425537
Epoch: 5, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 2.3649792671203613
Epoch: 6, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.205305814743042
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9120237827301025
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.464 Vali Acc: 0.541 Test Loss: 1.464 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9571568965911865
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.748 Vali Acc: 0.500 Test Loss: 1.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.809680461883545
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.513 Vali Acc: 0.568 Test Loss: 1.513 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9649436473846436
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.426 Vali Acc: 0.486 Test Loss: 1.426 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8160183429718018
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.007516860961914
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.507 Vali Acc: 0.541 Test Loss: 1.507 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9548332691192627
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.436 Vali Acc: 0.541 Test Loss: 1.436 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6943845748901367
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.473 Test Loss: 1.515 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 413044
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.017210006713867
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.346 Vali Acc: 0.378 Test Loss: 1.346 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.7435894012451172
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.143 Vali Acc: 0.446 Test Loss: 1.143 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445935).  Saving model ...
Epoch: 3 cost time: 1.8087036609649658
Epoch: 3, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.445935 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.6851131916046143
Epoch: 4, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6339294910430908
Epoch: 5, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.087 Vali Acc: 0.527 Test Loss: 1.087 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.699467420578003
Epoch: 6, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.257 Vali Acc: 0.473 Test Loss: 1.257 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4385011196136475
Epoch: 7, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.637174129486084
Epoch: 8, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.463 Vali Acc: 0.486 Test Loss: 1.463 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8593237400054932
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.690 Vali Acc: 0.432 Test Loss: 1.690 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6944255828857422
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.425 Vali Acc: 0.554 Test Loss: 1.425 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554040).  Saving model ...
Epoch: 11 cost time: 1.7291977405548096
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.537 Vali Acc: 0.446 Test Loss: 1.537 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6693975925445557
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.458 Vali Acc: 0.514 Test Loss: 1.458 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.552957534790039
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7159135341644287
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.430 Vali Acc: 0.527 Test Loss: 1.430 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7940011024475098
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.551 Vali Acc: 0.446 Test Loss: 1.551 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8046331405639648
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.755828857421875
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.541 Test Loss: 1.465 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9895403385162354
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.514 Test Loss: 1.518 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.612684965133667
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.500 Test Loss: 1.526 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6166114807128906
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.514 Test Loss: 1.526 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 413044
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.956054925918579
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.382 Vali Acc: 0.311 Test Loss: 1.382 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.7346234321594238
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.6215224266052246
Epoch: 3, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6675682067871094
Epoch: 4, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.213 Vali Acc: 0.446 Test Loss: 1.213 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6433231830596924
Epoch: 5, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.101074695587158
Epoch: 6, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.289 Vali Acc: 0.459 Test Loss: 1.289 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5702476501464844
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.5117194652557373
Epoch: 8, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.476 Vali Acc: 0.432 Test Loss: 1.476 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6929473876953125
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.528 Vali Acc: 0.446 Test Loss: 1.528 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.705467700958252
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.493 Vali Acc: 0.392 Test Loss: 1.493 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.649360179901123
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.675 Vali Acc: 0.446 Test Loss: 1.675 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.649590253829956
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.619 Vali Acc: 0.446 Test Loss: 1.619 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7232191562652588
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.613 Vali Acc: 0.459 Test Loss: 1.613 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9842278957366943
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.585 Vali Acc: 0.432 Test Loss: 1.585 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6438696384429932
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.686 Vali Acc: 0.446 Test Loss: 1.686 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6369495391845703
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.446 Test Loss: 1.644 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4320886135101318
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.486 Test Loss: 1.613 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 413044
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8315560817718506
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.374 Vali Acc: 0.351 Test Loss: 1.374 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.4054532051086426
Epoch: 2, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.5607154369354248
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.285 Vali Acc: 0.351 Test Loss: 1.285 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6795411109924316
Epoch: 4, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.243 Vali Acc: 0.432 Test Loss: 1.243 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7098331451416016
Epoch: 5, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5747346878051758
Epoch: 6, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6730749607086182
Epoch: 7, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.256 Vali Acc: 0.473 Test Loss: 1.256 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5951128005981445
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.502 Vali Acc: 0.365 Test Loss: 1.502 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6193342208862305
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.560 Vali Acc: 0.378 Test Loss: 1.560 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6426146030426025
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.476 Vali Acc: 0.473 Test Loss: 1.476 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5324921607971191
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.403 Vali Acc: 0.514 Test Loss: 1.403 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513499).  Saving model ...
Epoch: 12 cost time: 1.6966872215270996
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.705 Vali Acc: 0.419 Test Loss: 1.705 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6318747997283936
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.551 Vali Acc: 0.419 Test Loss: 1.551 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7092902660369873
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.677 Vali Acc: 0.419 Test Loss: 1.677 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7033107280731201
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.625 Vali Acc: 0.432 Test Loss: 1.625 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7133009433746338
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.660 Vali Acc: 0.446 Test Loss: 1.660 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8223357200622559
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.677 Vali Acc: 0.459 Test Loss: 1.677 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6909258365631104
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.432 Test Loss: 1.674 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4598593711853027
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.694 Vali Acc: 0.459 Test Loss: 1.694 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.616079568862915
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.432 Test Loss: 1.673 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6555054187774658
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.432 Test Loss: 1.682 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 413044
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.284548044204712
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.369 Vali Acc: 0.324 Test Loss: 1.369 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.127704620361328
Epoch: 2, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
Validation loss decreased (-0.324311 --> -0.567556).  Saving model ...
Epoch: 3 cost time: 2.035881996154785
Epoch: 3, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.058 Vali Acc: 0.541 Test Loss: 1.058 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8415074348449707
Epoch: 4, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8609898090362549
Epoch: 5, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8039443492889404
Epoch: 6, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.255 Vali Acc: 0.514 Test Loss: 1.255 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.048025131225586
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.028472661972046
Epoch: 8, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1920697689056396
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.295 Vali Acc: 0.527 Test Loss: 1.295 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.197657823562622
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.436 Vali Acc: 0.595 Test Loss: 1.436 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594580).  Saving model ...
Epoch: 11 cost time: 1.9985077381134033
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.438 Vali Acc: 0.541 Test Loss: 1.438 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9347681999206543
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.554 Vali Acc: 0.541 Test Loss: 1.554 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7423100471496582
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7714347839355469
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.462 Vali Acc: 0.568 Test Loss: 1.462 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8042097091674805
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.461 Vali Acc: 0.568 Test Loss: 1.461 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7427756786346436
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.595 Test Loss: 1.363 Test Acc: 0.595
Validation loss decreased (-0.594580 --> -0.594581).  Saving model ...
Epoch: 17 cost time: 1.9790120124816895
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.595 Test Loss: 1.399 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7818100452423096
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.581 Test Loss: 1.444 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7685561180114746
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.595 Test Loss: 1.445 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7414765357971191
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.595 Test Loss: 1.444 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.746978521347046
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.595 Test Loss: 1.430 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7042224407196045
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.595 Test Loss: 1.445 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9691290855407715
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.595 Test Loss: 1.464 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9588987827301025
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.595 Test Loss: 1.457 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1299707889556885
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.595 Test Loss: 1.470 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.018982410430908
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.595 Test Loss: 1.480 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 347508
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.942793130874634
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.8667700290679932
Epoch: 2, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
Validation loss decreased (-0.270256 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 1.9922378063201904
Epoch: 3, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3981549739837646
Epoch: 4, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.6132214069366455
Epoch: 5, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.705268144607544
Epoch: 6, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.343 Vali Acc: 0.419 Test Loss: 1.343 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8175859451293945
Epoch: 7, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.786160945892334
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6763081550598145
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.424 Vali Acc: 0.473 Test Loss: 1.424 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9723420143127441
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.484 Vali Acc: 0.527 Test Loss: 1.484 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8874695301055908
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.894702672958374
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.443 Vali Acc: 0.554 Test Loss: 1.443 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7087817192077637
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.458 Vali Acc: 0.527 Test Loss: 1.458 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6039178371429443
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.596 Vali Acc: 0.486 Test Loss: 1.596 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6310043334960938
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.503 Vali Acc: 0.514 Test Loss: 1.503 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 347508
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.050241947174072
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.394 Vali Acc: 0.351 Test Loss: 1.394 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 2.083427667617798
Epoch: 2, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
Validation loss decreased (-0.351337 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 2.0201735496520996
Epoch: 3, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.129 Vali Acc: 0.459 Test Loss: 1.129 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.179725170135498
Epoch: 4, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.9760560989379883
Epoch: 5, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.137 Vali Acc: 0.459 Test Loss: 1.137 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9221153259277344
Epoch: 6, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.357 Vali Acc: 0.419 Test Loss: 1.357 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.903813362121582
Epoch: 7, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.229 Vali Acc: 0.514 Test Loss: 1.229 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.8340392112731934
Epoch: 8, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7663490772247314
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6876592636108398
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.429 Vali Acc: 0.514 Test Loss: 1.429 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8689401149749756
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.401 Vali Acc: 0.486 Test Loss: 1.401 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9145445823669434
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.382 Vali Acc: 0.514 Test Loss: 1.382 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0661654472351074
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.400 Vali Acc: 0.514 Test Loss: 1.400 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.071471929550171
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.467 Vali Acc: 0.486 Test Loss: 1.467 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8964173793792725
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.426 Vali Acc: 0.541 Test Loss: 1.426 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540526).  Saving model ...
Epoch: 16 cost time: 1.6620066165924072
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.491 Vali Acc: 0.514 Test Loss: 1.491 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.903888463973999
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8847758769989014
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.501 Vali Acc: 0.486 Test Loss: 1.501 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.126572608947754
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7144324779510498
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.500 Test Loss: 1.530 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.794973611831665
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.514 Test Loss: 1.530 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9972972869873047
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.571 Vali Acc: 0.473 Test Loss: 1.571 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1188509464263916
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.486 Test Loss: 1.567 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8719291687011719
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.023939371109009
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.486 Test Loss: 1.608 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 347508
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8782479763031006
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.377 Vali Acc: 0.351 Test Loss: 1.377 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.7121257781982422
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
Validation loss decreased (-0.351338 --> -0.527014).  Saving model ...
Epoch: 3 cost time: 1.5720007419586182
Epoch: 3, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8137292861938477
Epoch: 4, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.329 Vali Acc: 0.432 Test Loss: 1.329 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7115817070007324
Epoch: 5, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.311 Vali Acc: 0.459 Test Loss: 1.311 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5617895126342773
Epoch: 6, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.339 Vali Acc: 0.419 Test Loss: 1.339 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.698972463607788
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.344 Vali Acc: 0.473 Test Loss: 1.344 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9547216892242432
Epoch: 8, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6670033931732178
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.466 Vali Acc: 0.459 Test Loss: 1.466 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6025028228759766
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.495 Vali Acc: 0.486 Test Loss: 1.495 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7454912662506104
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.545 Vali Acc: 0.446 Test Loss: 1.545 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0241305828094482
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.518 Vali Acc: 0.432 Test Loss: 1.518 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 347508
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.007597208023071
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.326 Vali Acc: 0.351 Test Loss: 1.326 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.5618438720703125
Epoch: 2, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.220 Vali Acc: 0.446 Test Loss: 1.220 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.4695076942443848
Epoch: 3, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
Validation loss decreased (-0.445934 --> -0.581070).  Saving model ...
Epoch: 4 cost time: 1.5140857696533203
Epoch: 4, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.208 Vali Acc: 0.419 Test Loss: 1.208 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6483094692230225
Epoch: 5, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.834911823272705
Epoch: 6, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.290 Vali Acc: 0.541 Test Loss: 1.290 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.942800521850586
Epoch: 7, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.315 Vali Acc: 0.554 Test Loss: 1.315 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8530018329620361
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9023642539978027
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.385 Vali Acc: 0.514 Test Loss: 1.385 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8892505168914795
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.375 Vali Acc: 0.527 Test Loss: 1.375 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0216922760009766
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.317 Vali Acc: 0.608 Test Loss: 1.317 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608095).  Saving model ...
Epoch: 12 cost time: 1.9226298332214355
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.324241876602173
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.568 Test Loss: 1.378 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9199213981628418
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.365 Vali Acc: 0.554 Test Loss: 1.365 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9393978118896484
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.541 Test Loss: 1.413 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8945791721343994
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9358558654785156
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.568 Test Loss: 1.395 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5710608959197998
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.568 Test Loss: 1.410 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.035540819168091
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.568 Test Loss: 1.437 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5616703033447266
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.568 Test Loss: 1.439 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7977051734924316
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.554 Test Loss: 1.416 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 314740
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.03711724281311
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.309 Vali Acc: 0.405 Test Loss: 1.309 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.643390417098999
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.214 Vali Acc: 0.405 Test Loss: 1.214 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.6468548774719238
Epoch: 3, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.405393 --> -0.567556).  Saving model ...
Epoch: 4 cost time: 1.8763389587402344
Epoch: 4, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.202 Vali Acc: 0.419 Test Loss: 1.202 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8184423446655273
Epoch: 5, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.201 Vali Acc: 0.446 Test Loss: 1.201 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8152892589569092
Epoch: 6, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.314 Vali Acc: 0.473 Test Loss: 1.314 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8615200519561768
Epoch: 7, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9154043197631836
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.268 Vali Acc: 0.514 Test Loss: 1.268 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.729874610900879
Epoch: 9, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6972601413726807
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.535 Vali Acc: 0.473 Test Loss: 1.535 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6768739223480225
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.401 Vali Acc: 0.541 Test Loss: 1.401 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6914443969726562
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.487 Vali Acc: 0.541 Test Loss: 1.487 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5328526496887207
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.638 Vali Acc: 0.486 Test Loss: 1.638 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 314740
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9707765579223633
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.7159454822540283
Epoch: 2, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.9030203819274902
Epoch: 3, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.177 Vali Acc: 0.541 Test Loss: 1.177 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.8101658821105957
Epoch: 4, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.258 Vali Acc: 0.392 Test Loss: 1.258 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7276771068572998
Epoch: 5, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.533649206161499
Epoch: 6, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.338 Vali Acc: 0.446 Test Loss: 1.338 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5398480892181396
Epoch: 7, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6590838432312012
Epoch: 8, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.389 Vali Acc: 0.459 Test Loss: 1.389 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5877211093902588
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.393 Vali Acc: 0.459 Test Loss: 1.393 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.569798231124878
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.573 Vali Acc: 0.459 Test Loss: 1.573 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7021076679229736
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5816025733947754
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.570 Vali Acc: 0.486 Test Loss: 1.570 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7337119579315186
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.717 Vali Acc: 0.405 Test Loss: 1.717 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 314740
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.772326707839966
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.345 Vali Acc: 0.405 Test Loss: 1.345 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.5367236137390137
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.296 Vali Acc: 0.459 Test Loss: 1.296 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.5360262393951416
Epoch: 3, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.249 Vali Acc: 0.459 Test Loss: 1.249 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.7468466758728027
Epoch: 4, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7857677936553955
Epoch: 5, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.86203932762146
Epoch: 6, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.7721385955810547
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.318 Vali Acc: 0.432 Test Loss: 1.318 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.905684471130371
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.496 Vali Acc: 0.378 Test Loss: 1.496 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7155718803405762
Epoch: 9, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.490 Vali Acc: 0.392 Test Loss: 1.490 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9169790744781494
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527013).  Saving model ...
Epoch: 11 cost time: 1.651472568511963
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.499 Vali Acc: 0.432 Test Loss: 1.499 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7537341117858887
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.611 Vali Acc: 0.432 Test Loss: 1.611 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9167444705963135
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.768 Vali Acc: 0.459 Test Loss: 1.768 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7851247787475586
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.739 Vali Acc: 0.514 Test Loss: 1.739 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0117545127868652
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.998 Vali Acc: 0.405 Test Loss: 1.998 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.58414626121521
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.794 Vali Acc: 0.432 Test Loss: 1.794 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5387656688690186
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.500 Test Loss: 1.630 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6745984554290771
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.486 Test Loss: 1.748 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5375759601593018
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.459 Test Loss: 1.794 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7019670009613037
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.758 Vali Acc: 0.486 Test Loss: 1.758 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 314740
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.870528221130371
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.382 Vali Acc: 0.338 Test Loss: 1.382 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5662121772766113
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.283 Vali Acc: 0.365 Test Loss: 1.283 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.443779706954956
Epoch: 3, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.5894265174865723
Epoch: 4, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.5283315181732178
Epoch: 5, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.6207082271575928
Epoch: 6, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.6841697692871094
Epoch: 7, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6637718677520752
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 1.7373566627502441
Epoch: 9, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7266287803649902
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.456669807434082
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.244 Vali Acc: 0.541 Test Loss: 1.244 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6072213649749756
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4748787879943848
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.360 Vali Acc: 0.514 Test Loss: 1.360 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5975377559661865
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.538 Vali Acc: 0.527 Test Loss: 1.538 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.521512746810913
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.425 Vali Acc: 0.514 Test Loss: 1.425 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4515376091003418
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6479721069335938
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5253417491912842
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5491182804107666
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.512042760848999
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.500 Test Loss: 1.521 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 648948
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.0720038414001465
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.538194179534912
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.283 Vali Acc: 0.378 Test Loss: 1.283 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 1.6934688091278076
Epoch: 3, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 1.6634430885314941
Epoch: 4, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.6137614250183105
Epoch: 5, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.097 Vali Acc: 0.486 Test Loss: 1.097 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486476).  Saving model ...
Epoch: 6 cost time: 1.564054250717163
Epoch: 6, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
Validation loss decreased (-0.486476 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.4804327487945557
Epoch: 7, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.164 Vali Acc: 0.473 Test Loss: 1.164 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6796185970306396
Epoch: 8, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.6007895469665527
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5459980964660645
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.4835917949676514
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.265 Vali Acc: 0.514 Test Loss: 1.265 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.692525863647461
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.338 Vali Acc: 0.514 Test Loss: 1.338 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.605088233947754
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.298 Vali Acc: 0.541 Test Loss: 1.298 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.632927656173706
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.438927412033081
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.403 Vali Acc: 0.514 Test Loss: 1.403 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4448285102844238
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.414 Vali Acc: 0.527 Test Loss: 1.414 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.511479139328003
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.522 Vali Acc: 0.500 Test Loss: 1.522 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4446640014648438
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4073357582092285
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.501 Vali Acc: 0.527 Test Loss: 1.501 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5391671657562256
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 648948
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.111137628555298
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.5480010509490967
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.7150933742523193
Epoch: 3, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.191 Vali Acc: 0.459 Test Loss: 1.191 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 1.6721961498260498
Epoch: 4, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.175 Vali Acc: 0.432 Test Loss: 1.175 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5527825355529785
Epoch: 5, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.6253297328948975
Epoch: 6, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.593869924545288
Epoch: 7, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.160 Vali Acc: 0.459 Test Loss: 1.160 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7321457862854004
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.3445377349853516
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4974040985107422
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.516946792602539
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3608365058898926
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.514 Vali Acc: 0.459 Test Loss: 1.514 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4543087482452393
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.322 Vali Acc: 0.473 Test Loss: 1.322 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4776148796081543
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.531832218170166
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.341 Vali Acc: 0.473 Test Loss: 1.341 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5527119636535645
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.486 Vali Acc: 0.459 Test Loss: 1.486 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5135395526885986
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.394 Vali Acc: 0.473 Test Loss: 1.394 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.538804292678833
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.377 Vali Acc: 0.446 Test Loss: 1.377 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 648948
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6882433891296387
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.362 Vali Acc: 0.324 Test Loss: 1.362 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.6810214519500732
Epoch: 2, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.318 Vali Acc: 0.365 Test Loss: 1.318 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.4268410205841064
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.291 Vali Acc: 0.378 Test Loss: 1.291 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.539574146270752
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.246 Vali Acc: 0.392 Test Loss: 1.246 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.6503922939300537
Epoch: 5, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.6786677837371826
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.284 Vali Acc: 0.351 Test Loss: 1.284 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4555141925811768
Epoch: 7, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.245 Vali Acc: 0.432 Test Loss: 1.245 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5645458698272705
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7042350769042969
Epoch: 9, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.319 Vali Acc: 0.432 Test Loss: 1.319 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5163345336914062
Epoch: 10, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.6279804706573486
Epoch: 11, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.450 Vali Acc: 0.446 Test Loss: 1.450 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6537830829620361
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.495 Vali Acc: 0.378 Test Loss: 1.495 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6534993648529053
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5258104801177979
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6265881061553955
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.460 Vali Acc: 0.486 Test Loss: 1.460 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5064914226531982
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.533 Vali Acc: 0.486 Test Loss: 1.533 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5792601108551025
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.448 Vali Acc: 0.514 Test Loss: 1.448 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513499).  Saving model ...
Epoch: 18 cost time: 1.5448358058929443
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.71830153465271
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.502 Vali Acc: 0.459 Test Loss: 1.502 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6671712398529053
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.459 Vali Acc: 0.541 Test Loss: 1.459 Test Acc: 0.541
Validation loss decreased (-0.513499 --> -0.540526).  Saving model ...
Epoch: 21 cost time: 1.4862399101257324
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.572920560836792
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.530 Vali Acc: 0.459 Test Loss: 1.530 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5637149810791016
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5900764465332031
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.709158182144165
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.43180513381958
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.518 Vali Acc: 0.486 Test Loss: 1.518 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3978259563446045
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.515 Vali Acc: 0.486 Test Loss: 1.515 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4770328998565674
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.514 Test Loss: 1.520 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.48008131980896
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.542 Vali Acc: 0.500 Test Loss: 1.542 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5548362731933594
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.559 Vali Acc: 0.486 Test Loss: 1.559 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 648948
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.3419671058654785
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.458 Vali Acc: 0.284 Test Loss: 1.458 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.7799365520477295
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.283769 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.77040696144104
Epoch: 3, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.241 Vali Acc: 0.473 Test Loss: 1.241 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.7997171878814697
Epoch: 4, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.90081787109375
Epoch: 5, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.161 Vali Acc: 0.405 Test Loss: 1.161 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9516069889068604
Epoch: 6, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.136 Vali Acc: 0.459 Test Loss: 1.136 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7929532527923584
Epoch: 7, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.171 Vali Acc: 0.446 Test Loss: 1.171 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.617616891860962
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.8980648517608643
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.053187131881714
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.232961654663086
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.294 Vali Acc: 0.486 Test Loss: 1.294 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0405328273773193
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.399 Vali Acc: 0.486 Test Loss: 1.399 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.077167510986328
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 14 cost time: 2.0723562240600586
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540527).  Saving model ...
Epoch: 15 cost time: 1.7300357818603516
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.350 Vali Acc: 0.514 Test Loss: 1.350 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0400078296661377
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7908754348754883
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.445 Vali Acc: 0.473 Test Loss: 1.445 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6462340354919434
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.420 Vali Acc: 0.500 Test Loss: 1.420 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.550644874572754
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.461 Vali Acc: 0.514 Test Loss: 1.461 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.488124132156372
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5799548625946045
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.447 Vali Acc: 0.486 Test Loss: 1.447 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6021728515625
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.447 Vali Acc: 0.514 Test Loss: 1.447 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8214306831359863
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7868590354919434
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.514 Test Loss: 1.465 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 386804
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2973363399505615
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.435 Vali Acc: 0.297 Test Loss: 1.435 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5739960670471191
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.4924657344818115
Epoch: 3, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.237 Vali Acc: 0.446 Test Loss: 1.237 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.513617992401123
Epoch: 4, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.6025965213775635
Epoch: 5, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.9077115058898926
Epoch: 6, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.4780819416046143
Epoch: 7, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8383018970489502
Epoch: 8, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8421351909637451
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6872398853302002
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8758854866027832
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.345 Vali Acc: 0.514 Test Loss: 1.345 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513500).  Saving model ...
Epoch: 12 cost time: 1.7127902507781982
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.426 Vali Acc: 0.459 Test Loss: 1.426 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4766008853912354
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.367 Vali Acc: 0.541 Test Loss: 1.367 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540527).  Saving model ...
Epoch: 14 cost time: 1.6770730018615723
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5837137699127197
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.432 Vali Acc: 0.486 Test Loss: 1.432 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6283934116363525
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.461 Vali Acc: 0.514 Test Loss: 1.461 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5855648517608643
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.514 Vali Acc: 0.514 Test Loss: 1.514 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6707231998443604
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.454 Vali Acc: 0.554 Test Loss: 1.454 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 19 cost time: 1.4570870399475098
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.521 Vali Acc: 0.568 Test Loss: 1.521 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567552).  Saving model ...
Epoch: 20 cost time: 1.672898292541504
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.498 Vali Acc: 0.514 Test Loss: 1.498 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4110026359558105
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.483 Vali Acc: 0.541 Test Loss: 1.483 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5653529167175293
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.511 Vali Acc: 0.568 Test Loss: 1.511 Test Acc: 0.568
Validation loss decreased (-0.567552 --> -0.567552).  Saving model ...
Epoch: 23 cost time: 1.6887905597686768
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.563 Vali Acc: 0.514 Test Loss: 1.563 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4290432929992676
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.551 Vali Acc: 0.554 Test Loss: 1.551 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5509514808654785
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.555 Vali Acc: 0.541 Test Loss: 1.555 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6550729274749756
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.583 Vali Acc: 0.514 Test Loss: 1.583 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6314048767089844
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.609 Vali Acc: 0.541 Test Loss: 1.609 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8454563617706299
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.627 Vali Acc: 0.527 Test Loss: 1.627 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.667536973953247
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7114934921264648
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.514 Test Loss: 1.596 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7033956050872803
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6390135288238525
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.527 Test Loss: 1.627 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 386804
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.4264044761657715
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.421 Vali Acc: 0.324 Test Loss: 1.421 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.670907735824585
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5803158283233643
Epoch: 3, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.232 Vali Acc: 0.419 Test Loss: 1.232 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.7145004272460938
Epoch: 4, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.200 Vali Acc: 0.432 Test Loss: 1.200 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.7569692134857178
Epoch: 5, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.432420 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.750075101852417
Epoch: 6, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 1.622635841369629
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.122 Vali Acc: 0.419 Test Loss: 1.122 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6182832717895508
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.266 Vali Acc: 0.473 Test Loss: 1.266 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5249474048614502
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.782365083694458
Epoch: 10, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.6712098121643066
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6934330463409424
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.319 Vali Acc: 0.486 Test Loss: 1.319 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6756296157836914
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 14 cost time: 1.5340981483459473
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4879724979400635
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.283 Vali Acc: 0.514 Test Loss: 1.283 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.503171682357788
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4802215099334717
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.314 Vali Acc: 0.541 Test Loss: 1.314 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4562249183654785
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.254 Vali Acc: 0.527 Test Loss: 1.254 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6038784980773926
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8040447235107422
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.289 Vali Acc: 0.554 Test Loss: 1.289 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 21 cost time: 1.6955657005310059
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.298 Vali Acc: 0.527 Test Loss: 1.298 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7149841785430908
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8690996170043945
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.405 Vali Acc: 0.514 Test Loss: 1.405 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7339773178100586
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6402158737182617
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.334 Vali Acc: 0.541 Test Loss: 1.334 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.809361219406128
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.350 Vali Acc: 0.514 Test Loss: 1.350 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6901588439941406
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.383 Vali Acc: 0.541 Test Loss: 1.383 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5696663856506348
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.697601556777954
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.514 Test Loss: 1.371 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7675895690917969
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.541 Test Loss: 1.374 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 386804
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.472705602645874
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.398 Vali Acc: 0.257 Test Loss: 1.398 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.6625134944915771
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.357 Vali Acc: 0.297 Test Loss: 1.357 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.5952298641204834
Epoch: 3, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5448851585388184
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.275 Vali Acc: 0.351 Test Loss: 1.275 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5697095394134521
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.4173243045806885
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.363051414489746
Epoch: 7, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.207 Vali Acc: 0.405 Test Loss: 1.207 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4794902801513672
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.337 Vali Acc: 0.459 Test Loss: 1.337 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6032013893127441
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.265 Vali Acc: 0.432 Test Loss: 1.265 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6439177989959717
Epoch: 10, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.391634464263916
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.325 Vali Acc: 0.446 Test Loss: 1.325 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6299724578857422
Epoch: 12, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.485 Vali Acc: 0.432 Test Loss: 1.485 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.724743366241455
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.340 Vali Acc: 0.459 Test Loss: 1.340 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.466698169708252
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3740613460540771
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.416 Vali Acc: 0.514 Test Loss: 1.416 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.671116828918457
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.478 Vali Acc: 0.486 Test Loss: 1.478 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.547396183013916
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.403 Vali Acc: 0.527 Test Loss: 1.403 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7797772884368896
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.456 Vali Acc: 0.473 Test Loss: 1.456 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6587731838226318
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.482 Vali Acc: 0.486 Test Loss: 1.482 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6994290351867676
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 386804
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.050169467926025
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.271 Vali Acc: 0.378 Test Loss: 1.271 Test Acc: 0.378
Validation loss decreased (inf --> -0.378366).  Saving model ...
Epoch: 2 cost time: 1.8872861862182617
Epoch: 2, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
Validation loss decreased (-0.378366 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 1.5238115787506104
Epoch: 3, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 1.4852914810180664
Epoch: 4, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.4732553958892822
Epoch: 5, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.057 Vali Acc: 0.527 Test Loss: 1.057 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.4342329502105713
Epoch: 6, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.039 Vali Acc: 0.568 Test Loss: 1.039 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.652958869934082
Epoch: 7, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9207851886749268
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.124 Vali Acc: 0.473 Test Loss: 1.124 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.588724136352539
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4955112934112549
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.293 Vali Acc: 0.514 Test Loss: 1.293 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4796380996704102
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5564486980438232
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.251 Vali Acc: 0.514 Test Loss: 1.251 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8226675987243652
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.319 Vali Acc: 0.568 Test Loss: 1.319 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.767284631729126
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7705068588256836
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7851979732513428
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 255732
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.974776029586792
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.587552785873413
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.8266220092773438
Epoch: 3, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 1.6406781673431396
Epoch: 4, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 1.800935983657837
Epoch: 5, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.083 Vali Acc: 0.486 Test Loss: 1.083 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6735589504241943
Epoch: 6, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
Validation loss decreased (-0.499989 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 1.605473279953003
Epoch: 7, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7116515636444092
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.62223482131958
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.681183099746704
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.360 Vali Acc: 0.486 Test Loss: 1.360 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5745174884796143
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6716747283935547
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.226 Vali Acc: 0.581 Test Loss: 1.226 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6683976650238037
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.325 Vali Acc: 0.554 Test Loss: 1.325 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.589336633682251
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.750446081161499
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.387 Vali Acc: 0.541 Test Loss: 1.387 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5483646392822266
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 255732
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9819507598876953
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.297 Vali Acc: 0.378 Test Loss: 1.297 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.720350742340088
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.243 Vali Acc: 0.419 Test Loss: 1.243 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.402494192123413
Epoch: 3, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.411672830581665
Epoch: 4, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.185 Vali Acc: 0.446 Test Loss: 1.185 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6968038082122803
Epoch: 5, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.107 Vali Acc: 0.446 Test Loss: 1.107 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445935).  Saving model ...
Epoch: 6 cost time: 1.3458974361419678
Epoch: 6, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
Validation loss decreased (-0.445935 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.6228876113891602
Epoch: 7, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.5891013145446777
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4657189846038818
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4541747570037842
Epoch: 10, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.811307430267334
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.316 Vali Acc: 0.514 Test Loss: 1.316 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4773616790771484
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.218 Vali Acc: 0.527 Test Loss: 1.218 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5480904579162598
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.324 Vali Acc: 0.486 Test Loss: 1.324 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6679489612579346
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6659071445465088
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.356 Vali Acc: 0.514 Test Loss: 1.356 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5446226596832275
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.399 Vali Acc: 0.500 Test Loss: 1.399 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4892706871032715
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.425 Vali Acc: 0.486 Test Loss: 1.425 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 255732
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6335906982421875
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.308 Vali Acc: 0.446 Test Loss: 1.308 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.3937740325927734
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5595438480377197
Epoch: 3, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 1.4658780097961426
Epoch: 4, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.182 Vali Acc: 0.446 Test Loss: 1.182 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4937479496002197
Epoch: 5, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.4432094097137451
Epoch: 6, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.5517592430114746
Epoch: 7, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5910730361938477
Epoch: 8, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.203 Vali Acc: 0.419 Test Loss: 1.203 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6587328910827637
Epoch: 9, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.103 Vali Acc: 0.514 Test Loss: 1.103 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.649961233139038
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5878889560699463
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5882480144500732
Epoch: 12, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4396483898162842
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6973206996917725
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.319 Vali Acc: 0.514 Test Loss: 1.319 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6373722553253174
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.386 Vali Acc: 0.500 Test Loss: 1.386 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5402376651763916
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 255732
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.050790071487427
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.324 Vali Acc: 0.446 Test Loss: 1.324 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.790018081665039
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.5741770267486572
Epoch: 3, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 1.5694341659545898
Epoch: 4, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4566776752471924
Epoch: 5, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 1.5885658264160156
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5826122760772705
Epoch: 7, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.6111576557159424
Epoch: 8, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5730094909667969
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.614311933517456
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.237 Vali Acc: 0.527 Test Loss: 1.237 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.600275993347168
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.493227243423462
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.255 Vali Acc: 0.514 Test Loss: 1.255 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6907494068145752
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6797068119049072
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.657365083694458
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6122097969055176
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.375 Vali Acc: 0.500 Test Loss: 1.375 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.506986141204834
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.345 Vali Acc: 0.527 Test Loss: 1.345 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 190196
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7146129608154297
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.4123015403747559
Epoch: 2, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.232 Vali Acc: 0.405 Test Loss: 1.232 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.4130887985229492
Epoch: 3, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.620469570159912
Epoch: 4, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.148 Vali Acc: 0.486 Test Loss: 1.148 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.4851384162902832
Epoch: 5, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.070 Vali Acc: 0.514 Test Loss: 1.070 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 1.542546272277832
Epoch: 6, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5789809226989746
Epoch: 7, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.109 Vali Acc: 0.459 Test Loss: 1.109 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7404520511627197
Epoch: 8, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.123 Vali Acc: 0.446 Test Loss: 1.123 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5726733207702637
Epoch: 9, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6759719848632812
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.520129680633545
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4951252937316895
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3934454917907715
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.326 Vali Acc: 0.486 Test Loss: 1.326 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.37367844581604
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.597945213317871
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 190196
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.0875468254089355
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.341 Vali Acc: 0.338 Test Loss: 1.341 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5721135139465332
Epoch: 2, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.255 Vali Acc: 0.405 Test Loss: 1.255 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.4112441539764404
Epoch: 3, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.187 Vali Acc: 0.446 Test Loss: 1.187 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.5298712253570557
Epoch: 4, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.459324836730957
Epoch: 5, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 1.5689451694488525
Epoch: 6, Steps: 10 | Train Loss: 0.523 Vali Loss: 1.128 Vali Acc: 0.459 Test Loss: 1.128 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4428150653839111
Epoch: 7, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.142 Vali Acc: 0.473 Test Loss: 1.142 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4333691596984863
Epoch: 8, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.137 Vali Acc: 0.446 Test Loss: 1.137 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4497482776641846
Epoch: 9, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4729194641113281
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6396756172180176
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.529240369796753
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4213178157806396
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.319 Vali Acc: 0.459 Test Loss: 1.319 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5695087909698486
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.622899055480957
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.363 Vali Acc: 0.432 Test Loss: 1.363 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5988574028015137
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.373 Vali Acc: 0.486 Test Loss: 1.373 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.470120906829834
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.443 Vali Acc: 0.486 Test Loss: 1.443 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6414239406585693
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.722928762435913
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.459 Vali Acc: 0.514 Test Loss: 1.459 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5714921951293945
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3048481941223145
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.498 Vali Acc: 0.514 Test Loss: 1.498 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 190196
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.244423151016235
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.7890546321868896
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.6992125511169434
Epoch: 3, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.245 Vali Acc: 0.392 Test Loss: 1.245 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6407504081726074
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.72761869430542
Epoch: 5, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.188 Vali Acc: 0.446 Test Loss: 1.188 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5872485637664795
Epoch: 6, Steps: 10 | Train Loss: 0.680 Vali Loss: 1.206 Vali Acc: 0.392 Test Loss: 1.206 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6426081657409668
Epoch: 7, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.230 Vali Acc: 0.365 Test Loss: 1.230 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5786020755767822
Epoch: 8, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.187 Vali Acc: 0.446 Test Loss: 1.187 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5158464908599854
Epoch: 9, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.225 Vali Acc: 0.459 Test Loss: 1.225 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 1.5962400436401367
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.228 Vali Acc: 0.446 Test Loss: 1.228 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4901845455169678
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7891454696655273
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.710268259048462
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.339 Vali Acc: 0.419 Test Loss: 1.339 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6456568241119385
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.360 Vali Acc: 0.432 Test Loss: 1.360 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9421889781951904
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.391 Vali Acc: 0.473 Test Loss: 1.391 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472959).  Saving model ...
Epoch: 16 cost time: 1.5432958602905273
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.428 Vali Acc: 0.432 Test Loss: 1.428 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9283993244171143
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.477 Vali Acc: 0.459 Test Loss: 1.477 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.770761489868164
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.471 Vali Acc: 0.446 Test Loss: 1.471 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7101316452026367
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.455 Vali Acc: 0.486 Test Loss: 1.455 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486472).  Saving model ...
Epoch: 20 cost time: 1.814622163772583
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.477 Vali Acc: 0.432 Test Loss: 1.477 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.778045654296875
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.478 Vali Acc: 0.446 Test Loss: 1.478 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7824780941009521
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.529 Vali Acc: 0.446 Test Loss: 1.529 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7579071521759033
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.537 Vali Acc: 0.446 Test Loss: 1.537 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0468437671661377
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.556 Vali Acc: 0.446 Test Loss: 1.556 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1718246936798096
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.588 Vali Acc: 0.419 Test Loss: 1.588 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.91274094581604
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.584 Vali Acc: 0.432 Test Loss: 1.584 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8937866687774658
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.624 Vali Acc: 0.446 Test Loss: 1.624 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.1112470626831055
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.627 Vali Acc: 0.432 Test Loss: 1.627 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0017828941345215
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.629 Vali Acc: 0.419 Test Loss: 1.629 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 190196
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7323780059814453
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.472 Vali Acc: 0.243 Test Loss: 1.472 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.5375874042510986
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.251 Vali Acc: 0.446 Test Loss: 1.251 Test Acc: 0.446
Validation loss decreased (-0.243229 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.6394188404083252
Epoch: 3, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.5095624923706055
Epoch: 4, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.709778070449829
Epoch: 5, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.7724685668945312
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7587411403656006
Epoch: 7, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.345 Vali Acc: 0.446 Test Loss: 1.345 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.551072120666504
Epoch: 8, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7046787738800049
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.234 Vali Acc: 0.554 Test Loss: 1.234 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.5855743885040283
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.506 Vali Acc: 0.486 Test Loss: 1.506 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6793596744537354
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5565812587738037
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.520 Vali Acc: 0.473 Test Loss: 1.520 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.605947732925415
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.487 Vali Acc: 0.514 Test Loss: 1.487 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.694058895111084
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.466 Vali Acc: 0.514 Test Loss: 1.466 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5974245071411133
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.519 Vali Acc: 0.514 Test Loss: 1.519 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5317115783691406
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.598 Vali Acc: 0.514 Test Loss: 1.598 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6448042392730713
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.524 Vali Acc: 0.527 Test Loss: 1.524 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.702477216720581
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.617 Vali Acc: 0.541 Test Loss: 1.617 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.593660593032837
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.585 Vali Acc: 0.500 Test Loss: 1.585 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 157428
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.0085883140563965
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.475 Vali Acc: 0.243 Test Loss: 1.475 Test Acc: 0.243
Validation loss decreased (inf --> -0.243228).  Saving model ...
Epoch: 2 cost time: 1.4895267486572266
Epoch: 2, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
Validation loss decreased (-0.243228 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.5561888217926025
Epoch: 3, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.239 Vali Acc: 0.419 Test Loss: 1.239 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6367034912109375
Epoch: 4, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.167 Vali Acc: 0.432 Test Loss: 1.167 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6260137557983398
Epoch: 5, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.132 Vali Acc: 0.473 Test Loss: 1.132 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 1.7092087268829346
Epoch: 6, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.421346664428711
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.300 Vali Acc: 0.459 Test Loss: 1.300 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9318337440490723
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.3296303749084473
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5996108055114746
Epoch: 10, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.500 Vali Acc: 0.432 Test Loss: 1.500 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5903823375701904
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.277 Vali Acc: 0.541 Test Loss: 1.277 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4429681301116943
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.538 Vali Acc: 0.432 Test Loss: 1.538 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5832138061523438
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.463 Vali Acc: 0.486 Test Loss: 1.463 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7898590564727783
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.776723861694336
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.559 Vali Acc: 0.500 Test Loss: 1.559 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6760330200195312
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.534 Vali Acc: 0.500 Test Loss: 1.534 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7680652141571045
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7733254432678223
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 157428
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.986238718032837
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.458 Vali Acc: 0.297 Test Loss: 1.458 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5360329151153564
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
Validation loss decreased (-0.297283 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.872781753540039
Epoch: 3, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.690161943435669
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.190 Vali Acc: 0.446 Test Loss: 1.190 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5787863731384277
Epoch: 5, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.169 Vali Acc: 0.486 Test Loss: 1.169 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.9017925262451172
Epoch: 6, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.205 Vali Acc: 0.568 Test Loss: 1.205 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.7797966003417969
Epoch: 7, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.267 Vali Acc: 0.473 Test Loss: 1.267 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8401589393615723
Epoch: 8, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7222809791564941
Epoch: 9, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7524597644805908
Epoch: 10, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.432 Vali Acc: 0.486 Test Loss: 1.432 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6777753829956055
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8413259983062744
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6947453022003174
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.372 Vali Acc: 0.446 Test Loss: 1.372 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7582969665527344
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.379 Vali Acc: 0.486 Test Loss: 1.379 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5185554027557373
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.455 Vali Acc: 0.500 Test Loss: 1.455 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.591629981994629
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.460 Vali Acc: 0.514 Test Loss: 1.460 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 157428
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.850017547607422
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.432 Vali Acc: 0.284 Test Loss: 1.432 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.5120527744293213
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.315 Vali Acc: 0.432 Test Loss: 1.315 Test Acc: 0.432
Validation loss decreased (-0.283769 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.5838053226470947
Epoch: 3, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.315 Vali Acc: 0.351 Test Loss: 1.315 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.558791160583496
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.267 Vali Acc: 0.365 Test Loss: 1.267 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3152389526367188
Epoch: 5, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.230 Vali Acc: 0.473 Test Loss: 1.230 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.4097015857696533
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5271944999694824
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.275 Vali Acc: 0.405 Test Loss: 1.275 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.528090000152588
Epoch: 8, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.4906532764434814
Epoch: 9, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7007660865783691
Epoch: 10, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.343 Vali Acc: 0.432 Test Loss: 1.343 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4204888343811035
Epoch: 11, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.209 Vali Acc: 0.527 Test Loss: 1.209 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.5112636089324951
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4384255409240723
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.346 Vali Acc: 0.459 Test Loss: 1.346 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5849215984344482
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6408817768096924
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.370 Vali Acc: 0.514 Test Loss: 1.370 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.494271993637085
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.386 Vali Acc: 0.473 Test Loss: 1.386 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6117959022521973
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.477 Vali Acc: 0.486 Test Loss: 1.477 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7146539688110352
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5809028148651123
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.473 Vali Acc: 0.459 Test Loss: 1.473 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5192105770111084
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.468 Vali Acc: 0.514 Test Loss: 1.468 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5156636238098145
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.493 Vali Acc: 0.473 Test Loss: 1.493 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 157428
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.555874824523926
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.375 Vali Acc: 0.351 Test Loss: 1.375 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.4394259452819824
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.191 Vali Acc: 0.595 Test Loss: 1.191 Test Acc: 0.595
Validation loss decreased (-0.351338 --> -0.594583).  Saving model ...
Epoch: 3 cost time: 1.5597259998321533
Epoch: 3, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.49601149559021
Epoch: 4, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.559342384338379
Epoch: 5, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5750541687011719
Epoch: 6, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5719413757324219
Epoch: 7, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.74800705909729
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.143 Vali Acc: 0.473 Test Loss: 1.143 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.641108512878418
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6753301620483398
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.190 Vali Acc: 0.581 Test Loss: 1.190 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8506793975830078
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.294 Vali Acc: 0.527 Test Loss: 1.294 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5963287353515625
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 141044
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.103957176208496
Epoch: 1, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.7204744815826416
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
Validation loss decreased (-0.324311 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 1.5829212665557861
Epoch: 3, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 1.568852424621582
Epoch: 4, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7715075016021729
Epoch: 5, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4942667484283447
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.6672677993774414
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.492244005203247
Epoch: 8, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.170 Vali Acc: 0.446 Test Loss: 1.170 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.687591552734375
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6410131454467773
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5541670322418213
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.372 Vali Acc: 0.486 Test Loss: 1.372 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.788517951965332
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.361 Vali Acc: 0.541 Test Loss: 1.361 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8527185916900635
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.335 Vali Acc: 0.541 Test Loss: 1.335 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6521415710449219
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.451 Vali Acc: 0.473 Test Loss: 1.451 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.897005319595337
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.422 Vali Acc: 0.514 Test Loss: 1.422 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9065680503845215
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.481 Vali Acc: 0.527 Test Loss: 1.481 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 141044
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7748305797576904
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.6448585987091064
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.231 Vali Acc: 0.473 Test Loss: 1.231 Test Acc: 0.473
Validation loss decreased (-0.297284 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.4589955806732178
Epoch: 3, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 1.4966344833374023
Epoch: 4, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4914495944976807
Epoch: 5, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4716379642486572
Epoch: 6, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.61885404586792
Epoch: 7, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.127 Vali Acc: 0.446 Test Loss: 1.127 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6587626934051514
Epoch: 8, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.133 Vali Acc: 0.459 Test Loss: 1.133 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.692225694656372
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7496259212493896
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.74725341796875
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.573214054107666
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6545093059539795
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 141044
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.727668285369873
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.419 Vali Acc: 0.230 Test Loss: 1.419 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.4759199619293213
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
Validation loss decreased (-0.229716 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5877010822296143
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.5488896369934082
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.496206521987915
Epoch: 5, Steps: 10 | Train Loss: 0.810 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6874873638153076
Epoch: 6, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.189 Vali Acc: 0.446 Test Loss: 1.189 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7274911403656006
Epoch: 7, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.248 Vali Acc: 0.459 Test Loss: 1.248 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7509512901306152
Epoch: 8, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.283 Vali Acc: 0.378 Test Loss: 1.283 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.447019338607788
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.271 Vali Acc: 0.419 Test Loss: 1.271 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.513634443283081
Epoch: 10, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.314 Vali Acc: 0.432 Test Loss: 1.314 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6580958366394043
Epoch: 11, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.349 Vali Acc: 0.405 Test Loss: 1.349 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4362812042236328
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.390 Vali Acc: 0.459 Test Loss: 1.390 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5771033763885498
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.371 Vali Acc: 0.473 Test Loss: 1.371 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7231426239013672
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.433 Vali Acc: 0.432 Test Loss: 1.433 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 141044
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.376885890960693
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.294 Vali Acc: 0.419 Test Loss: 1.294 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.894697666168213
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.8943934440612793
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 2.031740665435791
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.631420612335205
Epoch: 5, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.086 Vali Acc: 0.608 Test Loss: 1.086 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 1.7700695991516113
Epoch: 6, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.070 Vali Acc: 0.595 Test Loss: 1.070 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8335318565368652
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.061 Vali Acc: 0.514 Test Loss: 1.061 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6082630157470703
Epoch: 8, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8104920387268066
Epoch: 9, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7558071613311768
Epoch: 10, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8502497673034668
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.171 Vali Acc: 0.568 Test Loss: 1.171 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.68674635887146
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.205 Vali Acc: 0.568 Test Loss: 1.205 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.551698923110962
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.276 Vali Acc: 0.581 Test Loss: 1.276 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7313435077667236
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.272 Vali Acc: 0.581 Test Loss: 1.272 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6668379306793213
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.329 Vali Acc: 0.568 Test Loss: 1.329 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 320436
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5764074325561523
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.351 Vali Acc: 0.405 Test Loss: 1.351 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.4985909461975098
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.5251665115356445
Epoch: 3, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.6344561576843262
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.5825588703155518
Epoch: 5, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.147 Vali Acc: 0.473 Test Loss: 1.147 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6154365539550781
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.5213537216186523
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5300281047821045
Epoch: 8, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.7128448486328125
Epoch: 9, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.5625948905944824
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7304749488830566
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.7066080570220947
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7667853832244873
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.326 Vali Acc: 0.514 Test Loss: 1.326 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.517219066619873
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.392 Vali Acc: 0.514 Test Loss: 1.392 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7828147411346436
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.364 Vali Acc: 0.541 Test Loss: 1.364 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8375558853149414
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.454 Vali Acc: 0.541 Test Loss: 1.454 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7001330852508545
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.362 Vali Acc: 0.500 Test Loss: 1.362 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7224574089050293
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.753847599029541
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6179249286651611
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.745007038116455
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.470 Vali Acc: 0.514 Test Loss: 1.470 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 320436
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8398244380950928
Epoch: 1, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.358 Vali Acc: 0.338 Test Loss: 1.358 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.5384154319763184
Epoch: 2, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.4555158615112305
Epoch: 3, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.255 Vali Acc: 0.432 Test Loss: 1.255 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.5663843154907227
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.394968032836914
Epoch: 5, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.184 Vali Acc: 0.419 Test Loss: 1.184 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.622859239578247
Epoch: 6, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7508602142333984
Epoch: 7, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.168 Vali Acc: 0.459 Test Loss: 1.168 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5786793231964111
Epoch: 8, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.647690773010254
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.173 Vali Acc: 0.473 Test Loss: 1.173 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6112287044525146
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.3887007236480713
Epoch: 11, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4767637252807617
Epoch: 12, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.349 Vali Acc: 0.500 Test Loss: 1.349 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6793558597564697
Epoch: 13, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.426 Vali Acc: 0.473 Test Loss: 1.426 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6295971870422363
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.461 Vali Acc: 0.446 Test Loss: 1.461 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5907089710235596
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.513 Vali Acc: 0.459 Test Loss: 1.513 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.522737979888916
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.638 Vali Acc: 0.473 Test Loss: 1.638 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8178362846374512
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.519 Vali Acc: 0.473 Test Loss: 1.519 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6369361877441406
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.675 Vali Acc: 0.446 Test Loss: 1.675 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.513258457183838
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.611 Vali Acc: 0.459 Test Loss: 1.611 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6806347370147705
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.770 Vali Acc: 0.432 Test Loss: 1.770 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 320436
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9934613704681396
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.360 Vali Acc: 0.378 Test Loss: 1.360 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.6449902057647705
Epoch: 2, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.323 Vali Acc: 0.446 Test Loss: 1.323 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.5311100482940674
Epoch: 3, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.7048745155334473
Epoch: 4, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.282 Vali Acc: 0.459 Test Loss: 1.282 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.571425199508667
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.5674707889556885
Epoch: 6, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5346505641937256
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.222 Vali Acc: 0.419 Test Loss: 1.222 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5312845706939697
Epoch: 8, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6844487190246582
Epoch: 9, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.223 Vali Acc: 0.473 Test Loss: 1.223 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6919136047363281
Epoch: 10, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 1.6606078147888184
Epoch: 11, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.447279930114746
Epoch: 12, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.759744644165039
Epoch: 13, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.333 Vali Acc: 0.446 Test Loss: 1.333 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6449205875396729
Epoch: 14, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.385 Vali Acc: 0.486 Test Loss: 1.385 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5714268684387207
Epoch: 15, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.405 Vali Acc: 0.419 Test Loss: 1.405 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5502521991729736
Epoch: 16, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.466 Vali Acc: 0.446 Test Loss: 1.466 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6711599826812744
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.359 Vali Acc: 0.486 Test Loss: 1.359 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.659250259399414
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.512 Vali Acc: 0.473 Test Loss: 1.512 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5126996040344238
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.538 Vali Acc: 0.459 Test Loss: 1.538 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7045958042144775
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.659 Vali Acc: 0.432 Test Loss: 1.659 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 320436
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.1177978515625
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.5203895568847656
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.729642629623413
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.6276271343231201
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.212 Vali Acc: 0.432 Test Loss: 1.212 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.718991756439209
Epoch: 5, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.4681153297424316
Epoch: 6, Steps: 10 | Train Loss: 0.706 Vali Loss: 1.154 Vali Acc: 0.473 Test Loss: 1.154 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6471426486968994
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.4890108108520508
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3279802799224854
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.57547926902771
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4904625415802002
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4990696907043457
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.243 Vali Acc: 0.541 Test Loss: 1.243 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 1.5362403392791748
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4204251766204834
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.288 Vali Acc: 0.486 Test Loss: 1.288 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5158607959747314
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5740911960601807
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.448 Vali Acc: 0.554 Test Loss: 1.448 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 1.529604196548462
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5705368518829346
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.425 Vali Acc: 0.541 Test Loss: 1.425 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.594024896621704
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6634182929992676
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
Validation loss decreased (-0.554040 --> -0.554040).  Saving model ...
Epoch: 21 cost time: 1.64992094039917
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.489 Vali Acc: 0.541 Test Loss: 1.489 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.608595609664917
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.475 Vali Acc: 0.554 Test Loss: 1.475 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4452674388885498
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7494661808013916
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.545 Vali Acc: 0.527 Test Loss: 1.545 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.825199842453003
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.535 Vali Acc: 0.541 Test Loss: 1.535 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6560935974121094
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.565 Vali Acc: 0.527 Test Loss: 1.565 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8301496505737305
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.601 Vali Acc: 0.541 Test Loss: 1.601 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5276145935058594
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6025378704071045
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.631 Vali Acc: 0.541 Test Loss: 1.631 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7052011489868164
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.645 Vali Acc: 0.527 Test Loss: 1.645 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 189364
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.1846067905426025
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.404 Vali Acc: 0.284 Test Loss: 1.404 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.8212337493896484
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.6532402038574219
Epoch: 3, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.391878 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.4604828357696533
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.228 Vali Acc: 0.446 Test Loss: 1.228 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.689882516860962
Epoch: 5, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.6101696491241455
Epoch: 6, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5945236682891846
Epoch: 7, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 1.636390209197998
Epoch: 8, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6581737995147705
Epoch: 9, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.2697279453277588
Epoch: 10, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6029088497161865
Epoch: 11, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.148 Vali Acc: 0.581 Test Loss: 1.148 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.3591809272766113
Epoch: 12, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4982061386108398
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5481595993041992
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.329 Vali Acc: 0.486 Test Loss: 1.329 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4179961681365967
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5302083492279053
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5185363292694092
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6748642921447754
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.390 Vali Acc: 0.541 Test Loss: 1.390 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6995742321014404
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.453 Vali Acc: 0.568 Test Loss: 1.453 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5757009983062744
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.454 Vali Acc: 0.554 Test Loss: 1.454 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.586071491241455
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.507 Vali Acc: 0.514 Test Loss: 1.507 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 189364
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9171266555786133
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.5472173690795898
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.344 Vali Acc: 0.351 Test Loss: 1.344 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.512665033340454
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
Validation loss decreased (-0.351338 --> -0.554041).  Saving model ...
Epoch: 4 cost time: 1.5178911685943604
Epoch: 4, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5169777870178223
Epoch: 5, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
Validation loss decreased (-0.554041 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.6250462532043457
Epoch: 6, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5394206047058105
Epoch: 7, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3595786094665527
Epoch: 8, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4012136459350586
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.157 Vali Acc: 0.581 Test Loss: 1.157 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.4665844440460205
Epoch: 10, Steps: 10 | Train Loss: 0.353 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4512574672698975
Epoch: 11, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4422080516815186
Epoch: 12, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2356572151184082
Epoch: 13, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.241 Vali Acc: 0.527 Test Loss: 1.241 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.594468593597412
Epoch: 14, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.359 Vali Acc: 0.486 Test Loss: 1.359 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5110602378845215
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.448 Vali Acc: 0.514 Test Loss: 1.448 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3418591022491455
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.527 Vali Acc: 0.486 Test Loss: 1.527 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.399418830871582
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7146737575531006
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.525 Vali Acc: 0.514 Test Loss: 1.525 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.47990083694458
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.517 Vali Acc: 0.541 Test Loss: 1.517 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 189364
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.80910325050354
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.6468417644500732
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.344 Vali Acc: 0.351 Test Loss: 1.344 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.3363044261932373
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.5750012397766113
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.282 Vali Acc: 0.432 Test Loss: 1.282 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.5149586200714111
Epoch: 5, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.271 Vali Acc: 0.459 Test Loss: 1.271 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.3767621517181396
Epoch: 6, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4655828475952148
Epoch: 7, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4608759880065918
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5615501403808594
Epoch: 9, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.654533863067627
Epoch: 10, Steps: 10 | Train Loss: 0.525 Vali Loss: 1.334 Vali Acc: 0.432 Test Loss: 1.334 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.448662519454956
Epoch: 11, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.288 Vali Acc: 0.459 Test Loss: 1.288 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4405066967010498
Epoch: 12, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.373 Vali Acc: 0.392 Test Loss: 1.373 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5101821422576904
Epoch: 13, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.359 Vali Acc: 0.432 Test Loss: 1.359 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6133573055267334
Epoch: 14, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.558 Vali Acc: 0.351 Test Loss: 1.558 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5529019832611084
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.550 Vali Acc: 0.365 Test Loss: 1.550 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 189364
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.892488956451416
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.4740400314331055
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.330 Vali Acc: 0.378 Test Loss: 1.330 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.531095027923584
Epoch: 3, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.207 Vali Acc: 0.446 Test Loss: 1.207 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.4895329475402832
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.3788080215454102
Epoch: 5, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2890682220458984
Epoch: 6, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.3848042488098145
Epoch: 7, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.5763189792633057
Epoch: 8, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3907897472381592
Epoch: 9, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 1.290161371231079
Epoch: 10, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7420551776885986
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.210 Vali Acc: 0.554 Test Loss: 1.210 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.840930700302124
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4106929302215576
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.260 Vali Acc: 0.527 Test Loss: 1.260 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6464731693267822
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.306 Vali Acc: 0.541 Test Loss: 1.306 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5005605220794678
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.375 Vali Acc: 0.554 Test Loss: 1.375 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6332361698150635
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7446362972259521
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.459 Vali Acc: 0.595 Test Loss: 1.459 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594580).  Saving model ...
Epoch: 18 cost time: 1.7816851139068604
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.460 Vali Acc: 0.554 Test Loss: 1.460 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.659118890762329
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.565 Vali Acc: 0.568 Test Loss: 1.565 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5133414268493652
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.524 Vali Acc: 0.541 Test Loss: 1.524 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.655141830444336
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.555 Vali Acc: 0.541 Test Loss: 1.555 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6619775295257568
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.572 Vali Acc: 0.541 Test Loss: 1.572 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.617330551147461
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6061997413635254
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.634 Vali Acc: 0.541 Test Loss: 1.634 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2789993286132812
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.632 Vali Acc: 0.554 Test Loss: 1.632 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5244529247283936
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.624 Vali Acc: 0.541 Test Loss: 1.624 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4708638191223145
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.641 Vali Acc: 0.541 Test Loss: 1.641 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 123828
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.562221050262451
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.4198827743530273
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.339 Vali Acc: 0.365 Test Loss: 1.339 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.50993013381958
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.364851 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.5228664875030518
Epoch: 4, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.259 Vali Acc: 0.405 Test Loss: 1.259 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5581812858581543
Epoch: 5, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.592064619064331
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.6068310737609863
Epoch: 7, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5499658584594727
Epoch: 8, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7294979095458984
Epoch: 9, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5069782733917236
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5883064270019531
Epoch: 11, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4848887920379639
Epoch: 12, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 1.3846831321716309
Epoch: 13, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.265 Vali Acc: 0.514 Test Loss: 1.265 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4600870609283447
Epoch: 14, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.297 Vali Acc: 0.527 Test Loss: 1.297 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5305795669555664
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.353 Vali Acc: 0.554 Test Loss: 1.353 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.33583664894104
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.422 Vali Acc: 0.554 Test Loss: 1.422 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4157037734985352
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5128121376037598
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.472 Vali Acc: 0.554 Test Loss: 1.472 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6595630645751953
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.590 Vali Acc: 0.514 Test Loss: 1.590 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4960072040557861
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.547 Vali Acc: 0.554 Test Loss: 1.547 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8169448375701904
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.580 Vali Acc: 0.554 Test Loss: 1.580 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6569013595581055
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.598 Vali Acc: 0.554 Test Loss: 1.598 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 123828
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.954958438873291
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.391 Vali Acc: 0.311 Test Loss: 1.391 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.6776659488677979
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.365 Vali Acc: 0.311 Test Loss: 1.365 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.5167644023895264
Epoch: 3, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.272 Vali Acc: 0.405 Test Loss: 1.272 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.2930212020874023
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.295 Vali Acc: 0.392 Test Loss: 1.295 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.473198413848877
Epoch: 5, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3372607231140137
Epoch: 6, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6315488815307617
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5985825061798096
Epoch: 8, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7505736351013184
Epoch: 9, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6220169067382812
Epoch: 10, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.447235345840454
Epoch: 11, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.235 Vali Acc: 0.527 Test Loss: 1.235 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.2492995262145996
Epoch: 12, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5570237636566162
Epoch: 13, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.328 Vali Acc: 0.473 Test Loss: 1.328 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4936161041259766
Epoch: 14, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3105487823486328
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4769797325134277
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.422 Vali Acc: 0.473 Test Loss: 1.422 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3560540676116943
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4999723434448242
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.475 Vali Acc: 0.446 Test Loss: 1.475 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.558297872543335
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.674 Vali Acc: 0.500 Test Loss: 1.674 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4749641418457031
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.572 Vali Acc: 0.500 Test Loss: 1.572 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3222277164459229
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.598 Vali Acc: 0.486 Test Loss: 1.598 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 123828
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.085983753204346
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.413 Vali Acc: 0.311 Test Loss: 1.413 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.5714788436889648
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.409 Vali Acc: 0.311 Test Loss: 1.409 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.4431960582733154
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.330 Vali Acc: 0.338 Test Loss: 1.330 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 1.6138172149658203
Epoch: 4, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.351 Vali Acc: 0.365 Test Loss: 1.351 Test Acc: 0.365
Validation loss decreased (-0.337825 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.5784804821014404
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.292 Vali Acc: 0.351 Test Loss: 1.292 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6733832359313965
Epoch: 6, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.284 Vali Acc: 0.365 Test Loss: 1.284 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 1.5968539714813232
Epoch: 7, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 8 cost time: 1.8408176898956299
Epoch: 8, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.317 Vali Acc: 0.351 Test Loss: 1.317 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7057154178619385
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 10 cost time: 1.5193560123443604
Epoch: 10, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.291 Vali Acc: 0.351 Test Loss: 1.291 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5944018363952637
Epoch: 11, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.289 Vali Acc: 0.432 Test Loss: 1.289 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 1.8042752742767334
Epoch: 12, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.315 Vali Acc: 0.419 Test Loss: 1.315 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6382310390472412
Epoch: 13, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.348 Vali Acc: 0.446 Test Loss: 1.348 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445932).  Saving model ...
Epoch: 14 cost time: 1.6212916374206543
Epoch: 14, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.399 Vali Acc: 0.392 Test Loss: 1.399 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5088655948638916
Epoch: 15, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.413 Vali Acc: 0.432 Test Loss: 1.413 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3574225902557373
Epoch: 16, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.506 Vali Acc: 0.392 Test Loss: 1.506 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4714531898498535
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.600 Vali Acc: 0.378 Test Loss: 1.600 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.596489429473877
Epoch: 18, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.601 Vali Acc: 0.419 Test Loss: 1.601 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.496572494506836
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.638 Vali Acc: 0.446 Test Loss: 1.638 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6654911041259766
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.637 Vali Acc: 0.405 Test Loss: 1.637 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.545382022857666
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.676 Vali Acc: 0.419 Test Loss: 1.676 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4417641162872314
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.698 Vali Acc: 0.405 Test Loss: 1.698 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6219496726989746
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.739 Vali Acc: 0.378 Test Loss: 1.739 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 123828
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.901691436767578
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.380 Vali Acc: 0.311 Test Loss: 1.380 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.5141210556030273
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.300 Vali Acc: 0.392 Test Loss: 1.300 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5811877250671387
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.243 Vali Acc: 0.419 Test Loss: 1.243 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.4138495922088623
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.565129041671753
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.201 Vali Acc: 0.405 Test Loss: 1.201 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4500000476837158
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.5034747123718262
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.4523940086364746
Epoch: 8, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.4349169731140137
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.195 Vali Acc: 0.446 Test Loss: 1.195 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4434564113616943
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.200 Vali Acc: 0.514 Test Loss: 1.200 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.3610844612121582
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.243 Vali Acc: 0.541 Test Loss: 1.243 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 1.4743902683258057
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.314 Vali Acc: 0.514 Test Loss: 1.314 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5825119018554688
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.352 Vali Acc: 0.500 Test Loss: 1.352 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.454840898513794
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.374 Vali Acc: 0.514 Test Loss: 1.374 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4101459980010986
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.324 Vali Acc: 0.541 Test Loss: 1.324 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5481889247894287
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.563 Vali Acc: 0.514 Test Loss: 1.563 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5232977867126465
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.476 Vali Acc: 0.514 Test Loss: 1.476 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4302139282226562
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.572 Vali Acc: 0.514 Test Loss: 1.572 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2783446311950684
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.594 Vali Acc: 0.568 Test Loss: 1.594 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567552).  Saving model ...
Epoch: 20 cost time: 1.278214454650879
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4828755855560303
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.572 Vali Acc: 0.541 Test Loss: 1.572 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4495856761932373
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.578 Vali Acc: 0.527 Test Loss: 1.578 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3936407566070557
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.595 Vali Acc: 0.514 Test Loss: 1.595 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3997817039489746
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3859429359436035
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.703 Vali Acc: 0.514 Test Loss: 1.703 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.408247470855713
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.694 Vali Acc: 0.514 Test Loss: 1.694 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6020267009735107
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.738 Vali Acc: 0.514 Test Loss: 1.738 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.407226800918579
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.770 Vali Acc: 0.527 Test Loss: 1.770 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3017024993896484
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.748 Vali Acc: 0.527 Test Loss: 1.748 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 91060
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.914869546890259
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.372 Vali Acc: 0.216 Test Loss: 1.372 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.501246690750122
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.297 Vali Acc: 0.392 Test Loss: 1.297 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5061795711517334
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.622628927230835
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.6088433265686035
Epoch: 5, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.198 Vali Acc: 0.446 Test Loss: 1.198 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7140305042266846
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.5692555904388428
Epoch: 7, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4004802703857422
Epoch: 8, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4304540157318115
Epoch: 9, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.4377028942108154
Epoch: 10, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3337175846099854
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2887248992919922
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.349987506866455
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.427 Vali Acc: 0.486 Test Loss: 1.427 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3666484355926514
Epoch: 14, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.328 Vali Acc: 0.541 Test Loss: 1.328 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540527).  Saving model ...
Epoch: 15 cost time: 1.3968815803527832
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
Validation loss decreased (-0.540527 --> -0.581068).  Saving model ...
Epoch: 16 cost time: 1.3396315574645996
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.537 Vali Acc: 0.486 Test Loss: 1.537 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.502835988998413
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.440 Vali Acc: 0.541 Test Loss: 1.440 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4242815971374512
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.534 Vali Acc: 0.514 Test Loss: 1.534 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3026752471923828
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.509 Vali Acc: 0.527 Test Loss: 1.509 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5455026626586914
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6079983711242676
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.558 Vali Acc: 0.527 Test Loss: 1.558 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5258240699768066
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.517 Vali Acc: 0.541 Test Loss: 1.517 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.541292667388916
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.89078950881958
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.556 Vali Acc: 0.514 Test Loss: 1.556 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7739109992980957
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.645 Vali Acc: 0.541 Test Loss: 1.645 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 91060
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.493158340454102
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.6572506427764893
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.339 Vali Acc: 0.378 Test Loss: 1.339 Test Acc: 0.378
Validation loss decreased (-0.256743 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.5503513813018799
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.290 Vali Acc: 0.486 Test Loss: 1.290 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.7898244857788086
Epoch: 4, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.281 Vali Acc: 0.419 Test Loss: 1.281 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3219757080078125
Epoch: 5, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.239 Vali Acc: 0.432 Test Loss: 1.239 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5286610126495361
Epoch: 6, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.5911924839019775
Epoch: 7, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6064467430114746
Epoch: 8, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 1.6244783401489258
Epoch: 9, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6769695281982422
Epoch: 10, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7223496437072754
Epoch: 11, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.247 Vali Acc: 0.486 Test Loss: 1.247 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6609697341918945
Epoch: 12, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.310 Vali Acc: 0.486 Test Loss: 1.310 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.699235439300537
Epoch: 13, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.389 Vali Acc: 0.446 Test Loss: 1.389 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5946433544158936
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.848374366760254
Epoch: 15, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.361 Vali Acc: 0.486 Test Loss: 1.361 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7966270446777344
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.580 Vali Acc: 0.432 Test Loss: 1.580 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6288323402404785
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.542 Vali Acc: 0.459 Test Loss: 1.542 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6814441680908203
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.560 Vali Acc: 0.446 Test Loss: 1.560 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 91060
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.515622615814209
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.4644701480865479
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.6220512390136719
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.319 Vali Acc: 0.432 Test Loss: 1.319 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.5340964794158936
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.310 Vali Acc: 0.419 Test Loss: 1.310 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4396462440490723
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5651485919952393
Epoch: 6, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.3719849586486816
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.248 Vali Acc: 0.405 Test Loss: 1.248 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3259661197662354
Epoch: 8, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.277 Vali Acc: 0.432 Test Loss: 1.277 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4258835315704346
Epoch: 9, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.256 Vali Acc: 0.419 Test Loss: 1.256 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3997149467468262
Epoch: 10, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 11 cost time: 1.4775207042694092
Epoch: 11, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.246 Vali Acc: 0.514 Test Loss: 1.246 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 12 cost time: 1.3792665004730225
Epoch: 12, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.303 Vali Acc: 0.446 Test Loss: 1.303 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3918144702911377
Epoch: 13, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.422 Vali Acc: 0.405 Test Loss: 1.422 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3420023918151855
Epoch: 14, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.339 Vali Acc: 0.473 Test Loss: 1.339 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4003996849060059
Epoch: 15, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.383 Vali Acc: 0.459 Test Loss: 1.383 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3274345397949219
Epoch: 16, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.464 Vali Acc: 0.446 Test Loss: 1.464 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3466517925262451
Epoch: 17, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.483 Vali Acc: 0.473 Test Loss: 1.483 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.40087890625
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4183237552642822
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.497 Vali Acc: 0.459 Test Loss: 1.497 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4107511043548584
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.562 Vali Acc: 0.459 Test Loss: 1.562 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4317171573638916
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.631 Vali Acc: 0.459 Test Loss: 1.631 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 91060
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7859506607055664
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.5453035831451416
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.4443588256835938
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.697685718536377
Epoch: 4, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7079992294311523
Epoch: 5, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.7385838031768799
Epoch: 6, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5423479080200195
Epoch: 7, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.5708160400390625
Epoch: 8, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.097 Vali Acc: 0.446 Test Loss: 1.097 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.609950304031372
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.127 Vali Acc: 0.514 Test Loss: 1.127 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7064063549041748
Epoch: 10, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.572373390197754
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6419923305511475
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.306 Vali Acc: 0.527 Test Loss: 1.306 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7212810516357422
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.272 Vali Acc: 0.568 Test Loss: 1.272 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 1.5620629787445068
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.723278522491455
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.411 Vali Acc: 0.527 Test Loss: 1.411 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8208436965942383
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.393 Vali Acc: 0.473 Test Loss: 1.393 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.709122896194458
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.470 Vali Acc: 0.554 Test Loss: 1.470 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7582690715789795
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.440 Vali Acc: 0.527 Test Loss: 1.440 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5104339122772217
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.557 Vali Acc: 0.541 Test Loss: 1.557 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8527417182922363
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.515 Vali Acc: 0.486 Test Loss: 1.515 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6967790126800537
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.631 Vali Acc: 0.541 Test Loss: 1.631 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5757043361663818
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.561 Vali Acc: 0.486 Test Loss: 1.561 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.660344123840332
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 74676
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.032957315444946
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.332 Vali Acc: 0.338 Test Loss: 1.332 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 1.525273084640503
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.337825 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.469911813735962
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.299468994140625
Epoch: 4, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.437136173248291
Epoch: 5, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.7091448307037354
Epoch: 6, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.459822177886963
Epoch: 7, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.5334413051605225
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.119 Vali Acc: 0.473 Test Loss: 1.119 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4450807571411133
Epoch: 9, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4749269485473633
Epoch: 10, Steps: 10 | Train Loss: 0.292 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3660869598388672
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4125072956085205
Epoch: 12, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.360 Vali Acc: 0.459 Test Loss: 1.360 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3580641746520996
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.49318528175354
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.283 Vali Acc: 0.486 Test Loss: 1.283 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4110054969787598
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.452 Vali Acc: 0.486 Test Loss: 1.452 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3093736171722412
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.424 Vali Acc: 0.446 Test Loss: 1.424 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5362842082977295
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.550 Vali Acc: 0.473 Test Loss: 1.550 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 74676
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4977195262908936
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.361 Vali Acc: 0.297 Test Loss: 1.361 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.4484484195709229
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.296 Vali Acc: 0.419 Test Loss: 1.296 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.4670822620391846
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2305831909179688
Epoch: 4, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.218 Vali Acc: 0.405 Test Loss: 1.218 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5597691535949707
Epoch: 5, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.5869064331054688
Epoch: 6, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.3424701690673828
Epoch: 7, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3735477924346924
Epoch: 8, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.302480697631836
Epoch: 9, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4879496097564697
Epoch: 10, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3998796939849854
Epoch: 11, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5598912239074707
Epoch: 12, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.295 Vali Acc: 0.473 Test Loss: 1.295 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5242829322814941
Epoch: 13, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4213132858276367
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 15 cost time: 1.4515705108642578
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.366201639175415
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.516 Vali Acc: 0.432 Test Loss: 1.516 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3346009254455566
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.577 Vali Acc: 0.473 Test Loss: 1.577 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3737068176269531
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.487 Vali Acc: 0.473 Test Loss: 1.487 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3340296745300293
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.657 Vali Acc: 0.473 Test Loss: 1.657 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3032801151275635
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.592 Vali Acc: 0.486 Test Loss: 1.592 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3079802989959717
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.628 Vali Acc: 0.473 Test Loss: 1.628 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3128936290740967
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.727 Vali Acc: 0.459 Test Loss: 1.727 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3900985717773438
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.682 Vali Acc: 0.473 Test Loss: 1.682 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.378166675567627
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.737 Vali Acc: 0.459 Test Loss: 1.737 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 74676
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.848337411880493
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.392 Vali Acc: 0.365 Test Loss: 1.392 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.6076438426971436
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.335 Vali Acc: 0.432 Test Loss: 1.335 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.5750696659088135
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.323 Vali Acc: 0.405 Test Loss: 1.323 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4397082328796387
Epoch: 4, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.287 Vali Acc: 0.378 Test Loss: 1.287 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6596040725708008
Epoch: 5, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.305 Vali Acc: 0.405 Test Loss: 1.305 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5961012840270996
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.6512749195098877
Epoch: 7, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.294 Vali Acc: 0.419 Test Loss: 1.294 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7215349674224854
Epoch: 8, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.204 Vali Acc: 0.459 Test Loss: 1.204 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 1.9704854488372803
Epoch: 9, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8429441452026367
Epoch: 10, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.236 Vali Acc: 0.432 Test Loss: 1.236 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8262112140655518
Epoch: 11, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.311 Vali Acc: 0.432 Test Loss: 1.311 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6188647747039795
Epoch: 12, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.656033992767334
Epoch: 13, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.329 Vali Acc: 0.446 Test Loss: 1.329 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5280451774597168
Epoch: 14, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.340 Vali Acc: 0.419 Test Loss: 1.340 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6496737003326416
Epoch: 15, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.391 Vali Acc: 0.446 Test Loss: 1.391 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.574373483657837
Epoch: 16, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.445 Vali Acc: 0.459 Test Loss: 1.445 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.552534818649292
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.618 Vali Acc: 0.365 Test Loss: 1.618 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3306801319122314
Epoch: 18, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.528 Vali Acc: 0.419 Test Loss: 1.528 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 74676
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.759666681289673
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.5588455200195312
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.364 Vali Acc: 0.365 Test Loss: 1.364 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5953433513641357
Epoch: 3, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.339 Vali Acc: 0.297 Test Loss: 1.339 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.562072515487671
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.256 Vali Acc: 0.378 Test Loss: 1.256 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.4461843967437744
Epoch: 5, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.199 Vali Acc: 0.446 Test Loss: 1.199 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.6833786964416504
Epoch: 6, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5123474597930908
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.171 Vali Acc: 0.486 Test Loss: 1.171 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.3888647556304932
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4651401042938232
Epoch: 9, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.249 Vali Acc: 0.446 Test Loss: 1.249 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5829710960388184
Epoch: 10, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4940226078033447
Epoch: 11, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4918975830078125
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.381 Vali Acc: 0.486 Test Loss: 1.381 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.44179105758667
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.335 Vali Acc: 0.514 Test Loss: 1.335 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513500).  Saving model ...
Epoch: 14 cost time: 1.511981725692749
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.439 Vali Acc: 0.473 Test Loss: 1.439 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.487433671951294
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.324 Vali Acc: 0.527 Test Loss: 1.324 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527014).  Saving model ...
Epoch: 16 cost time: 1.361598014831543
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.510 Vali Acc: 0.486 Test Loss: 1.510 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3940794467926025
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.634 Vali Acc: 0.486 Test Loss: 1.634 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.449692964553833
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.562 Vali Acc: 0.486 Test Loss: 1.562 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5231497287750244
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.633 Vali Acc: 0.486 Test Loss: 1.633 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.521003246307373
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.592 Vali Acc: 0.459 Test Loss: 1.592 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4919712543487549
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.651 Vali Acc: 0.527 Test Loss: 1.651 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5203230381011963
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.660 Vali Acc: 0.459 Test Loss: 1.660 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.504518985748291
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.683 Vali Acc: 0.554 Test Loss: 1.683 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554037).  Saving model ...
Epoch: 24 cost time: 1.4605071544647217
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.684 Vali Acc: 0.541 Test Loss: 1.684 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4203336238861084
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.696 Vali Acc: 0.473 Test Loss: 1.696 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5840325355529785
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.693 Vali Acc: 0.527 Test Loss: 1.693 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4750919342041016
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.738 Vali Acc: 0.500 Test Loss: 1.738 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5730187892913818
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.733 Vali Acc: 0.500 Test Loss: 1.733 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5197455883026123
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.717 Vali Acc: 0.541 Test Loss: 1.717 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.469674825668335
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.772 Vali Acc: 0.514 Test Loss: 1.772 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6432580947875977
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.547971248626709
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.820 Vali Acc: 0.486 Test Loss: 1.820 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5605721473693848
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.830 Vali Acc: 0.486 Test Loss: 1.830 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 66484
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.872493267059326
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.435 Vali Acc: 0.216 Test Loss: 1.435 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.5762057304382324
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.364 Vali Acc: 0.378 Test Loss: 1.364 Test Acc: 0.378
Validation loss decreased (-0.216202 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.6127450466156006
Epoch: 3, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.340 Vali Acc: 0.297 Test Loss: 1.340 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5406887531280518
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.6647710800170898
Epoch: 5, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.204 Vali Acc: 0.459 Test Loss: 1.204 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.4545483589172363
Epoch: 6, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.206 Vali Acc: 0.446 Test Loss: 1.206 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7657170295715332
Epoch: 7, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.693549394607544
Epoch: 8, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.6808388233184814
Epoch: 9, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8136940002441406
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4998815059661865
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 1.5725510120391846
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6476168632507324
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.350 Vali Acc: 0.473 Test Loss: 1.350 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4536771774291992
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5143201351165771
Epoch: 15, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.537566900253296
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.519 Vali Acc: 0.473 Test Loss: 1.519 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5328278541564941
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.648 Vali Acc: 0.473 Test Loss: 1.648 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.760143756866455
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.529 Vali Acc: 0.446 Test Loss: 1.529 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5647902488708496
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.644 Vali Acc: 0.500 Test Loss: 1.644 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.70318603515625
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.597 Vali Acc: 0.486 Test Loss: 1.597 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.047628402709961
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 66484
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.043655633926392
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.422 Vali Acc: 0.216 Test Loss: 1.422 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.559532642364502
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.6382262706756592
Epoch: 3, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.322 Vali Acc: 0.338 Test Loss: 1.322 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.532585620880127
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.5349130630493164
Epoch: 5, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.217 Vali Acc: 0.446 Test Loss: 1.217 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.549149990081787
Epoch: 6, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.601785659790039
Epoch: 7, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.4836235046386719
Epoch: 8, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.5834834575653076
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5871078968048096
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7954461574554443
Epoch: 11, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9010493755340576
Epoch: 12, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9350922107696533
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3636693954467773
Epoch: 14, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.550 Vali Acc: 0.405 Test Loss: 1.550 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.412593126296997
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5697875022888184
Epoch: 16, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.523 Vali Acc: 0.486 Test Loss: 1.523 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5519771575927734
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.632 Vali Acc: 0.432 Test Loss: 1.632 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.526341438293457
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.621 Vali Acc: 0.446 Test Loss: 1.621 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 66484
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5527329444885254
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.4352056980133057
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.338 Vali Acc: 0.392 Test Loss: 1.338 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.6155154705047607
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.319 Vali Acc: 0.392 Test Loss: 1.319 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.6911756992340088
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.296 Vali Acc: 0.432 Test Loss: 1.296 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.499056100845337
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.697587251663208
Epoch: 6, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.269 Vali Acc: 0.405 Test Loss: 1.269 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6347463130950928
Epoch: 7, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.250 Vali Acc: 0.459 Test Loss: 1.250 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.5405404567718506
Epoch: 8, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.6134529113769531
Epoch: 9, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.246 Vali Acc: 0.514 Test Loss: 1.246 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 1.501727819442749
Epoch: 10, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3770086765289307
Epoch: 11, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.273 Vali Acc: 0.486 Test Loss: 1.273 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.675218105316162
Epoch: 12, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.340 Vali Acc: 0.432 Test Loss: 1.340 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5967433452606201
Epoch: 13, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.341 Vali Acc: 0.446 Test Loss: 1.341 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5945391654968262
Epoch: 14, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.452 Vali Acc: 0.446 Test Loss: 1.452 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.602022647857666
Epoch: 15, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.382 Vali Acc: 0.473 Test Loss: 1.382 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3812475204467773
Epoch: 16, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.473 Vali Acc: 0.446 Test Loss: 1.473 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.549231767654419
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.556 Vali Acc: 0.432 Test Loss: 1.556 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4027338027954102
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.605 Vali Acc: 0.432 Test Loss: 1.605 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4065697193145752
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.671 Vali Acc: 0.419 Test Loss: 1.671 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 66484
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.0008461475372314
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.417 Vali Acc: 0.392 Test Loss: 1.417 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.6769325733184814
Epoch: 2, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.545 Vali Acc: 0.405 Test Loss: 1.545 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405390).  Saving model ...
Epoch: 3 cost time: 1.8836522102355957
Epoch: 3, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.480 Vali Acc: 0.473 Test Loss: 1.480 Test Acc: 0.473
Validation loss decreased (-0.405390 --> -0.472958).  Saving model ...
Epoch: 4 cost time: 1.6805906295776367
Epoch: 4, Steps: 10 | Train Loss: 0.315 Vali Loss: 2.342 Vali Acc: 0.338 Test Loss: 2.342 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8778986930847168
Epoch: 5, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.901 Vali Acc: 0.378 Test Loss: 1.901 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.849557876586914
Epoch: 6, Steps: 10 | Train Loss: 0.187 Vali Loss: 2.952 Vali Acc: 0.432 Test Loss: 2.952 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6717150211334229
Epoch: 7, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.148 Vali Acc: 0.527 Test Loss: 3.148 Test Acc: 0.527
Validation loss decreased (-0.472958 --> -0.526996).  Saving model ...
Epoch: 8 cost time: 1.620690107345581
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.664 Vali Acc: 0.486 Test Loss: 2.664 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.977884292602539
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.470 Vali Acc: 0.473 Test Loss: 3.470 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8484411239624023
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.726 Vali Acc: 0.473 Test Loss: 3.726 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7753245830535889
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 5.352 Vali Acc: 0.392 Test Loss: 5.352 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7894558906555176
Epoch: 12, Steps: 10 | Train Loss: 0.186 Vali Loss: 4.109 Vali Acc: 0.446 Test Loss: 4.109 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0441129207611084
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.576 Vali Acc: 0.446 Test Loss: 4.576 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8394646644592285
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.016 Vali Acc: 0.419 Test Loss: 5.016 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6276705265045166
Epoch: 15, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.007 Vali Acc: 0.459 Test Loss: 4.007 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8090307712554932
Epoch: 16, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.843 Vali Acc: 0.419 Test Loss: 5.843 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7506227493286133
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.606 Vali Acc: 0.486 Test Loss: 5.606 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 3472444
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9111502170562744
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.456 Vali Acc: 0.378 Test Loss: 1.456 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 1.573481798171997
Epoch: 2, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.540 Vali Acc: 0.378 Test Loss: 1.540 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6741628646850586
Epoch: 3, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.524 Vali Acc: 0.392 Test Loss: 1.524 Test Acc: 0.392
Validation loss decreased (-0.378364 --> -0.391877).  Saving model ...
Epoch: 4 cost time: 1.6521644592285156
Epoch: 4, Steps: 10 | Train Loss: 0.211 Vali Loss: 2.361 Vali Acc: 0.351 Test Loss: 2.361 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6552278995513916
Epoch: 5, Steps: 10 | Train Loss: 0.187 Vali Loss: 2.308 Vali Acc: 0.405 Test Loss: 2.308 Test Acc: 0.405
Validation loss decreased (-0.391877 --> -0.405382).  Saving model ...
Epoch: 6 cost time: 1.6040310859680176
Epoch: 6, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.712 Vali Acc: 0.392 Test Loss: 3.712 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6378452777862549
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 2.616 Vali Acc: 0.459 Test Loss: 2.616 Test Acc: 0.459
Validation loss decreased (-0.405382 --> -0.459433).  Saving model ...
Epoch: 8 cost time: 1.629434585571289
Epoch: 8, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.328 Vali Acc: 0.446 Test Loss: 2.328 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6251225471496582
Epoch: 9, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.114 Vali Acc: 0.459 Test Loss: 3.114 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6843233108520508
Epoch: 10, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.528 Vali Acc: 0.459 Test Loss: 3.528 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5285921096801758
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.005 Vali Acc: 0.514 Test Loss: 3.005 Test Acc: 0.514
Validation loss decreased (-0.459433 --> -0.513483).  Saving model ...
Epoch: 12 cost time: 1.8468456268310547
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.871 Vali Acc: 0.486 Test Loss: 3.871 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7248387336730957
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 7.103 Vali Acc: 0.432 Test Loss: 7.103 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8515725135803223
Epoch: 14, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.822 Vali Acc: 0.486 Test Loss: 3.822 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7490313053131104
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.866 Vali Acc: 0.392 Test Loss: 5.866 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5944347381591797
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.552 Vali Acc: 0.514 Test Loss: 5.552 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.957726240158081
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 5.850 Vali Acc: 0.446 Test Loss: 5.850 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5714657306671143
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 6.658 Vali Acc: 0.405 Test Loss: 6.658 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.503981590270996
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.323 Vali Acc: 0.459 Test Loss: 5.323 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.602994680404663
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.118 Vali Acc: 0.486 Test Loss: 5.118 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6345374584197998
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.167 Vali Acc: 0.459 Test Loss: 6.167 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 3472444
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2308573722839355
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.512 Vali Acc: 0.338 Test Loss: 1.512 Test Acc: 0.338
Validation loss decreased (inf --> -0.337823).  Saving model ...
Epoch: 2 cost time: 1.4142160415649414
Epoch: 2, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.502 Vali Acc: 0.459 Test Loss: 1.502 Test Acc: 0.459
Validation loss decreased (-0.337823 --> -0.459444).  Saving model ...
Epoch: 3 cost time: 1.4138059616088867
Epoch: 3, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.630 Vali Acc: 0.419 Test Loss: 1.630 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.423985242843628
Epoch: 4, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.026 Vali Acc: 0.365 Test Loss: 2.026 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4692840576171875
Epoch: 5, Steps: 10 | Train Loss: 0.179 Vali Loss: 2.686 Vali Acc: 0.338 Test Loss: 2.686 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3562390804290771
Epoch: 6, Steps: 10 | Train Loss: 0.177 Vali Loss: 2.045 Vali Acc: 0.473 Test Loss: 2.045 Test Acc: 0.473
Validation loss decreased (-0.459444 --> -0.472953).  Saving model ...
Epoch: 7 cost time: 1.4614636898040771
Epoch: 7, Steps: 10 | Train Loss: 0.089 Vali Loss: 2.514 Vali Acc: 0.473 Test Loss: 2.514 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4035773277282715
Epoch: 8, Steps: 10 | Train Loss: 0.228 Vali Loss: 2.663 Vali Acc: 0.459 Test Loss: 2.663 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4066412448883057
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.647 Vali Acc: 0.365 Test Loss: 3.647 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.623669147491455
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.004 Vali Acc: 0.473 Test Loss: 3.004 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5144426822662354
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.081 Vali Acc: 0.459 Test Loss: 3.081 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4150004386901855
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.622 Vali Acc: 0.419 Test Loss: 3.622 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.420513391494751
Epoch: 13, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.394 Vali Acc: 0.473 Test Loss: 3.394 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.584507942199707
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.937 Vali Acc: 0.514 Test Loss: 4.937 Test Acc: 0.514
Validation loss decreased (-0.472953 --> -0.513464).  Saving model ...
Epoch: 15 cost time: 1.6532096862792969
Epoch: 15, Steps: 10 | Train Loss: 0.340 Vali Loss: 4.206 Vali Acc: 0.405 Test Loss: 4.206 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5572772026062012
Epoch: 16, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.306 Vali Acc: 0.446 Test Loss: 4.306 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4908111095428467
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.325 Vali Acc: 0.500 Test Loss: 4.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.479142665863037
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.519 Vali Acc: 0.473 Test Loss: 5.519 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4460787773132324
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 6.467 Vali Acc: 0.419 Test Loss: 6.467 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4680826663970947
Epoch: 20, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.708 Vali Acc: 0.473 Test Loss: 4.708 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5297634601593018
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.511 Vali Acc: 0.514 Test Loss: 4.511 Test Acc: 0.514
Validation loss decreased (-0.513464 --> -0.513468).  Saving model ...
Epoch: 22 cost time: 1.3632092475891113
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 7.825 Vali Acc: 0.405 Test Loss: 7.825 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4755983352661133
Epoch: 23, Steps: 10 | Train Loss: 0.277 Vali Loss: 7.174 Vali Acc: 0.473 Test Loss: 7.174 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6459007263183594
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.905 Vali Acc: 0.392 Test Loss: 5.905 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.545727014541626
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.519 Vali Acc: 0.500 Test Loss: 6.519 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5230984687805176
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 8.430 Vali Acc: 0.432 Test Loss: 8.430 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4432296752929688
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.686 Vali Acc: 0.392 Test Loss: 6.686 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5787057876586914
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.869 Vali Acc: 0.378 Test Loss: 7.869 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6306025981903076
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 7.449 Vali Acc: 0.500 Test Loss: 7.449 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5077931880950928
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 7.962 Vali Acc: 0.392 Test Loss: 7.962 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4225363731384277
Epoch: 31, Steps: 10 | Train Loss: 0.080 Vali Loss: 6.968 Vali Acc: 0.527 Test Loss: 6.968 Test Acc: 0.527
Validation loss decreased (-0.513468 --> -0.526957).  Saving model ...
Epoch: 32 cost time: 1.4217524528503418
Epoch: 32, Steps: 10 | Train Loss: 0.219 Vali Loss: 8.117 Vali Acc: 0.432 Test Loss: 8.117 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6611742973327637
Epoch: 33, Steps: 10 | Train Loss: 0.227 Vali Loss: 8.737 Vali Acc: 0.459 Test Loss: 8.737 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7450499534606934
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.828 Vali Acc: 0.514 Test Loss: 6.828 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4482274055480957
Epoch: 35, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.262 Vali Acc: 0.432 Test Loss: 8.262 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3647518157958984
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 11.973 Vali Acc: 0.419 Test Loss: 11.973 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5176255702972412
Epoch: 37, Steps: 10 | Train Loss: 0.247 Vali Loss: 8.444 Vali Acc: 0.486 Test Loss: 8.444 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5746595859527588
Epoch: 38, Steps: 10 | Train Loss: 0.093 Vali Loss: 8.589 Vali Acc: 0.486 Test Loss: 8.589 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.424790859222412
Epoch: 39, Steps: 10 | Train Loss: 0.108 Vali Loss: 9.389 Vali Acc: 0.446 Test Loss: 9.389 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5122454166412354
Epoch: 40, Steps: 10 | Train Loss: 0.162 Vali Loss: 8.029 Vali Acc: 0.514 Test Loss: 8.029 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4614136219024658
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 10.404 Vali Acc: 0.392 Test Loss: 10.404 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 3472444
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.484013319015503
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.551 Vali Acc: 0.284 Test Loss: 1.551 Test Acc: 0.284
Validation loss decreased (inf --> -0.283768).  Saving model ...
Epoch: 2 cost time: 1.5354371070861816
Epoch: 2, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.418 Vali Acc: 0.392 Test Loss: 1.418 Test Acc: 0.392
Validation loss decreased (-0.283768 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.3749659061431885
Epoch: 3, Steps: 10 | Train Loss: 0.912 Vali Loss: 2.058 Vali Acc: 0.297 Test Loss: 2.058 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4502842426300049
Epoch: 4, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.598 Vali Acc: 0.365 Test Loss: 1.598 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.408881425857544
Epoch: 5, Steps: 10 | Train Loss: 0.255 Vali Loss: 2.203 Vali Acc: 0.324 Test Loss: 2.203 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5533738136291504
Epoch: 6, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.799 Vali Acc: 0.365 Test Loss: 1.799 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.632413387298584
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 2.140 Vali Acc: 0.419 Test Loss: 2.140 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418898).  Saving model ...
Epoch: 8 cost time: 1.4939658641815186
Epoch: 8, Steps: 10 | Train Loss: 0.061 Vali Loss: 2.242 Vali Acc: 0.405 Test Loss: 2.242 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6059017181396484
Epoch: 9, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.451 Vali Acc: 0.405 Test Loss: 2.451 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4275319576263428
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.697 Vali Acc: 0.432 Test Loss: 2.697 Test Acc: 0.432
Validation loss decreased (-0.418898 --> -0.432405).  Saving model ...
Epoch: 11 cost time: 1.4797134399414062
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.481 Vali Acc: 0.405 Test Loss: 3.481 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.469655990600586
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 2.836 Vali Acc: 0.419 Test Loss: 2.836 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4234023094177246
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.663 Vali Acc: 0.378 Test Loss: 3.663 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4875106811523438
Epoch: 14, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.677 Vali Acc: 0.459 Test Loss: 4.677 Test Acc: 0.459
Validation loss decreased (-0.432405 --> -0.459413).  Saving model ...
Epoch: 15 cost time: 1.4334187507629395
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.149 Vali Acc: 0.392 Test Loss: 4.149 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.489234447479248
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.374 Vali Acc: 0.419 Test Loss: 4.374 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4113233089447021
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.079 Vali Acc: 0.392 Test Loss: 4.079 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3484292030334473
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.631 Vali Acc: 0.419 Test Loss: 4.631 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.515355110168457
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.607 Vali Acc: 0.392 Test Loss: 4.607 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5304760932922363
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.462 Vali Acc: 0.378 Test Loss: 5.462 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5023021697998047
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.075 Vali Acc: 0.432 Test Loss: 5.075 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5295894145965576
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.150 Vali Acc: 0.419 Test Loss: 5.150 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4071323871612549
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.015 Vali Acc: 0.392 Test Loss: 6.015 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.473902702331543
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 6.719 Vali Acc: 0.486 Test Loss: 6.719 Test Acc: 0.486
Validation loss decreased (-0.459413 --> -0.486419).  Saving model ...
Epoch: 25 cost time: 1.4943232536315918
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.620 Vali Acc: 0.432 Test Loss: 5.620 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4019951820373535
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.574 Vali Acc: 0.527 Test Loss: 5.574 Test Acc: 0.527
Validation loss decreased (-0.486419 --> -0.526971).  Saving model ...
Epoch: 27 cost time: 1.2457482814788818
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.476 Vali Acc: 0.473 Test Loss: 4.476 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4441657066345215
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.109 Vali Acc: 0.405 Test Loss: 4.109 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5831468105316162
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.799 Vali Acc: 0.446 Test Loss: 6.799 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4210963249206543
Epoch: 30, Steps: 10 | Train Loss: 0.179 Vali Loss: 6.912 Vali Acc: 0.432 Test Loss: 6.912 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4248762130737305
Epoch: 31, Steps: 10 | Train Loss: 0.088 Vali Loss: 5.484 Vali Acc: 0.473 Test Loss: 5.484 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5037429332733154
Epoch: 32, Steps: 10 | Train Loss: 0.141 Vali Loss: 7.570 Vali Acc: 0.351 Test Loss: 7.570 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.61110258102417
Epoch: 33, Steps: 10 | Train Loss: 0.193 Vali Loss: 6.745 Vali Acc: 0.432 Test Loss: 6.745 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3298790454864502
Epoch: 34, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.176 Vali Acc: 0.378 Test Loss: 6.176 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4500906467437744
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 6.803 Vali Acc: 0.338 Test Loss: 6.803 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3758766651153564
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 7.090 Vali Acc: 0.365 Test Loss: 7.090 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 3472444
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.806987762451172
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.215 Vali Acc: 0.419 Test Loss: 1.215 Test Acc: 0.419
Validation loss decreased (inf --> -0.418907).  Saving model ...
Epoch: 2 cost time: 1.7545809745788574
Epoch: 2, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.311 Vali Acc: 0.473 Test Loss: 1.311 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.6524548530578613
Epoch: 3, Steps: 10 | Train Loss: 0.387 Vali Loss: 1.484 Vali Acc: 0.486 Test Loss: 1.484 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486472).  Saving model ...
Epoch: 4 cost time: 1.6160809993743896
Epoch: 4, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
Validation loss decreased (-0.486472 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 1.6980187892913818
Epoch: 5, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.953 Vali Acc: 0.500 Test Loss: 1.953 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6857795715332031
Epoch: 6, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.388 Vali Acc: 0.459 Test Loss: 2.388 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7357776165008545
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.907 Vali Acc: 0.405 Test Loss: 2.907 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7669782638549805
Epoch: 8, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.224 Vali Acc: 0.419 Test Loss: 4.224 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7423629760742188
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.256 Vali Acc: 0.446 Test Loss: 3.256 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6698708534240723
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.038 Vali Acc: 0.432 Test Loss: 3.038 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6716248989105225
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.915 Vali Acc: 0.432 Test Loss: 3.915 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4882957935333252
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.925 Vali Acc: 0.432 Test Loss: 3.925 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.683621883392334
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.071 Vali Acc: 0.473 Test Loss: 7.071 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.589751958847046
Epoch: 14, Steps: 10 | Train Loss: 0.256 Vali Loss: 4.963 Vali Acc: 0.473 Test Loss: 4.963 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 2423868
model size : 19.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.906707525253296
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.236 Vali Acc: 0.405 Test Loss: 1.236 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 1.6224486827850342
Epoch: 2, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.256 Vali Acc: 0.459 Test Loss: 1.256 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.7063627243041992
Epoch: 3, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.525 Vali Acc: 0.486 Test Loss: 1.525 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486471).  Saving model ...
Epoch: 4 cost time: 1.8012611865997314
Epoch: 4, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.816 Vali Acc: 0.459 Test Loss: 1.816 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8382799625396729
Epoch: 5, Steps: 10 | Train Loss: 0.132 Vali Loss: 2.167 Vali Acc: 0.432 Test Loss: 2.167 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.72953200340271
Epoch: 6, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.951 Vali Acc: 0.473 Test Loss: 1.951 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.668919563293457
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.685 Vali Acc: 0.419 Test Loss: 2.685 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8158228397369385
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.815 Vali Acc: 0.351 Test Loss: 2.815 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8558309078216553
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.347 Vali Acc: 0.405 Test Loss: 3.347 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8720605373382568
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.934 Vali Acc: 0.459 Test Loss: 3.934 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.750838041305542
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.536 Vali Acc: 0.432 Test Loss: 3.536 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7302684783935547
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 2.740 Vali Acc: 0.514 Test Loss: 2.740 Test Acc: 0.514
Validation loss decreased (-0.486471 --> -0.513486).  Saving model ...
Epoch: 13 cost time: 1.5536024570465088
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.724 Vali Acc: 0.432 Test Loss: 3.724 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7405242919921875
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.472 Vali Acc: 0.500 Test Loss: 4.472 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5336604118347168
Epoch: 15, Steps: 10 | Train Loss: 0.133 Vali Loss: 7.309 Vali Acc: 0.311 Test Loss: 7.309 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5288732051849365
Epoch: 16, Steps: 10 | Train Loss: 0.193 Vali Loss: 5.049 Vali Acc: 0.541 Test Loss: 5.049 Test Acc: 0.541
Validation loss decreased (-0.513486 --> -0.540490).  Saving model ...
Epoch: 17 cost time: 1.5623512268066406
Epoch: 17, Steps: 10 | Train Loss: 0.146 Vali Loss: 4.604 Vali Acc: 0.446 Test Loss: 4.604 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7195894718170166
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.620 Vali Acc: 0.486 Test Loss: 4.620 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6566572189331055
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 8.694 Vali Acc: 0.446 Test Loss: 8.694 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7824773788452148
Epoch: 20, Steps: 10 | Train Loss: 0.302 Vali Loss: 5.372 Vali Acc: 0.514 Test Loss: 5.372 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5560648441314697
Epoch: 21, Steps: 10 | Train Loss: 0.133 Vali Loss: 7.828 Vali Acc: 0.351 Test Loss: 7.828 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4718868732452393
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.446 Vali Acc: 0.500 Test Loss: 6.446 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.481384515762329
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.638 Vali Acc: 0.432 Test Loss: 5.638 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.845444679260254
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 6.137 Vali Acc: 0.473 Test Loss: 6.137 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6064989566802979
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 7.643 Vali Acc: 0.405 Test Loss: 7.643 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.929187297821045
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.453 Vali Acc: 0.459 Test Loss: 6.453 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 2423868
model size : 19.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5716629028320312
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.263 Vali Acc: 0.405 Test Loss: 1.263 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 1.578221321105957
Epoch: 2, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.5089185237884521
Epoch: 3, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.452 Vali Acc: 0.459 Test Loss: 1.452 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4495816230773926
Epoch: 4, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.841 Vali Acc: 0.365 Test Loss: 1.841 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5098936557769775
Epoch: 5, Steps: 10 | Train Loss: 0.188 Vali Loss: 2.193 Vali Acc: 0.432 Test Loss: 2.193 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5136442184448242
Epoch: 6, Steps: 10 | Train Loss: 0.136 Vali Loss: 2.511 Vali Acc: 0.338 Test Loss: 2.511 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5280606746673584
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.730 Vali Acc: 0.473 Test Loss: 1.730 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2434711456298828
Epoch: 8, Steps: 10 | Train Loss: 0.108 Vali Loss: 2.537 Vali Acc: 0.392 Test Loss: 2.537 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5677528381347656
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 2.279 Vali Acc: 0.446 Test Loss: 2.279 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5503275394439697
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.963 Vali Acc: 0.446 Test Loss: 2.963 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4391207695007324
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.922 Vali Acc: 0.459 Test Loss: 2.922 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4775328636169434
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.423 Vali Acc: 0.446 Test Loss: 3.423 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 2423868
model size : 19.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.509040355682373
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.325 Vali Acc: 0.351 Test Loss: 1.325 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.3103625774383545
Epoch: 2, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.391 Vali Acc: 0.419 Test Loss: 1.391 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.399993658065796
Epoch: 3, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.422 Vali Acc: 0.378 Test Loss: 1.422 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.331763744354248
Epoch: 4, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.612 Vali Acc: 0.446 Test Loss: 1.612 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445930).  Saving model ...
Epoch: 5 cost time: 1.38090181350708
Epoch: 5, Steps: 10 | Train Loss: 0.190 Vali Loss: 2.328 Vali Acc: 0.392 Test Loss: 2.328 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3801615238189697
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.931 Vali Acc: 0.419 Test Loss: 1.931 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3511412143707275
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.821 Vali Acc: 0.378 Test Loss: 1.821 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5346264839172363
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.000 Vali Acc: 0.419 Test Loss: 3.000 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4578814506530762
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 2.288 Vali Acc: 0.459 Test Loss: 2.288 Test Acc: 0.459
Validation loss decreased (-0.445930 --> -0.459437).  Saving model ...
Epoch: 10 cost time: 1.273054599761963
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.498 Vali Acc: 0.405 Test Loss: 2.498 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4291727542877197
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.556 Vali Acc: 0.432 Test Loss: 2.556 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2813494205474854
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.321 Vali Acc: 0.365 Test Loss: 3.321 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5307371616363525
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.463 Vali Acc: 0.405 Test Loss: 3.463 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5483007431030273
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.865 Vali Acc: 0.392 Test Loss: 3.865 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4460692405700684
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.107 Vali Acc: 0.378 Test Loss: 4.107 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4139277935028076
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.591 Vali Acc: 0.459 Test Loss: 3.591 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4796531200408936
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.493 Vali Acc: 0.459 Test Loss: 3.493 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4750468730926514
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.373 Vali Acc: 0.446 Test Loss: 4.373 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4742608070373535
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.933 Vali Acc: 0.486 Test Loss: 3.933 Test Acc: 0.486
Validation loss decreased (-0.459437 --> -0.486447).  Saving model ...
Epoch: 20 cost time: 1.570277452468872
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.039 Vali Acc: 0.500 Test Loss: 4.039 Test Acc: 0.500
Validation loss decreased (-0.486447 --> -0.499960).  Saving model ...
Epoch: 21 cost time: 1.3305363655090332
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.674 Vali Acc: 0.392 Test Loss: 5.674 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4822041988372803
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.228 Vali Acc: 0.473 Test Loss: 5.228 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4399776458740234
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.914 Vali Acc: 0.446 Test Loss: 5.914 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4082834720611572
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.962 Vali Acc: 0.473 Test Loss: 6.962 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4358086585998535
Epoch: 25, Steps: 10 | Train Loss: 0.249 Vali Loss: 7.666 Vali Acc: 0.405 Test Loss: 7.666 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.337831735610962
Epoch: 26, Steps: 10 | Train Loss: 0.138 Vali Loss: 6.376 Vali Acc: 0.446 Test Loss: 6.376 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4020586013793945
Epoch: 27, Steps: 10 | Train Loss: 0.183 Vali Loss: 6.271 Vali Acc: 0.432 Test Loss: 6.271 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.285980224609375
Epoch: 28, Steps: 10 | Train Loss: 0.164 Vali Loss: 7.593 Vali Acc: 0.432 Test Loss: 7.593 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3445050716400146
Epoch: 29, Steps: 10 | Train Loss: 0.224 Vali Loss: 8.601 Vali Acc: 0.378 Test Loss: 8.601 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3902885913848877
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 9.189 Vali Acc: 0.473 Test Loss: 9.189 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 2423868
model size : 19.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.483245611190796
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.773 Vali Acc: 0.270 Test Loss: 1.773 Test Acc: 0.270
Validation loss decreased (inf --> -0.270253).  Saving model ...
Epoch: 2 cost time: 1.6318223476409912
Epoch: 2, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.408 Vali Acc: 0.473 Test Loss: 1.408 Test Acc: 0.473
Validation loss decreased (-0.270253 --> -0.472959).  Saving model ...
Epoch: 3 cost time: 1.4583895206451416
Epoch: 3, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.811 Vali Acc: 0.419 Test Loss: 1.811 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.542294979095459
Epoch: 4, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.704 Vali Acc: 0.459 Test Loss: 1.704 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7428925037384033
Epoch: 5, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.838 Vali Acc: 0.459 Test Loss: 1.838 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4811546802520752
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 2.124 Vali Acc: 0.473 Test Loss: 2.124 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5803923606872559
Epoch: 7, Steps: 10 | Train Loss: 0.100 Vali Loss: 2.571 Vali Acc: 0.459 Test Loss: 2.571 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.702314853668213
Epoch: 8, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.457 Vali Acc: 0.392 Test Loss: 4.457 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.758042335510254
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 2.942 Vali Acc: 0.486 Test Loss: 2.942 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486457).  Saving model ...
Epoch: 10 cost time: 1.716001272201538
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 4.029 Vali Acc: 0.473 Test Loss: 4.029 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.741241216659546
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.628 Vali Acc: 0.514 Test Loss: 3.628 Test Acc: 0.514
Validation loss decreased (-0.486457 --> -0.513477).  Saving model ...
Epoch: 12 cost time: 1.6355321407318115
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.740 Vali Acc: 0.473 Test Loss: 3.740 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.565197229385376
Epoch: 13, Steps: 10 | Train Loss: 0.518 Vali Loss: 5.353 Vali Acc: 0.446 Test Loss: 5.353 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6599862575531006
Epoch: 14, Steps: 10 | Train Loss: 0.277 Vali Loss: 4.017 Vali Acc: 0.473 Test Loss: 4.017 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5380618572235107
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.222 Vali Acc: 0.392 Test Loss: 5.222 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5788085460662842
Epoch: 16, Steps: 10 | Train Loss: 0.136 Vali Loss: 5.015 Vali Acc: 0.473 Test Loss: 5.015 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6540896892547607
Epoch: 17, Steps: 10 | Train Loss: 0.403 Vali Loss: 5.191 Vali Acc: 0.527 Test Loss: 5.191 Test Acc: 0.527
Validation loss decreased (-0.513477 --> -0.526975).  Saving model ...
Epoch: 18 cost time: 1.3747553825378418
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 6.414 Vali Acc: 0.446 Test Loss: 6.414 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.598034143447876
Epoch: 19, Steps: 10 | Train Loss: 0.219 Vali Loss: 7.065 Vali Acc: 0.432 Test Loss: 7.065 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5968592166900635
Epoch: 20, Steps: 10 | Train Loss: 0.101 Vali Loss: 11.127 Vali Acc: 0.324 Test Loss: 11.127 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4619908332824707
Epoch: 21, Steps: 10 | Train Loss: 0.224 Vali Loss: 6.243 Vali Acc: 0.514 Test Loss: 6.243 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.541522741317749
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 7.142 Vali Acc: 0.473 Test Loss: 7.142 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.505267858505249
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.730 Vali Acc: 0.500 Test Loss: 6.730 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.529099941253662
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 8.593 Vali Acc: 0.459 Test Loss: 8.593 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5604603290557861
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.672 Vali Acc: 0.500 Test Loss: 6.672 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6349635124206543
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.949 Vali Acc: 0.500 Test Loss: 6.949 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4796862602233887
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 8.040 Vali Acc: 0.405 Test Loss: 8.040 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1899580
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.776270866394043
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.738 Vali Acc: 0.311 Test Loss: 1.738 Test Acc: 0.311
Validation loss decreased (inf --> -0.310793).  Saving model ...
Epoch: 2 cost time: 1.590238094329834
Epoch: 2, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.380 Vali Acc: 0.459 Test Loss: 1.380 Test Acc: 0.459
Validation loss decreased (-0.310793 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.5147535800933838
Epoch: 3, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.693 Vali Acc: 0.419 Test Loss: 1.693 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4610905647277832
Epoch: 4, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.818 Vali Acc: 0.378 Test Loss: 1.818 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6220908164978027
Epoch: 5, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.756 Vali Acc: 0.419 Test Loss: 1.756 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6088688373565674
Epoch: 6, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.332 Vali Acc: 0.459 Test Loss: 2.332 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4543426036834717
Epoch: 7, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.098 Vali Acc: 0.459 Test Loss: 3.098 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5020363330841064
Epoch: 8, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.219 Vali Acc: 0.432 Test Loss: 3.219 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4223101139068604
Epoch: 9, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.814 Vali Acc: 0.351 Test Loss: 3.814 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4218213558197021
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.009 Vali Acc: 0.419 Test Loss: 3.009 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4481539726257324
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.961 Vali Acc: 0.486 Test Loss: 3.961 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486447).  Saving model ...
Epoch: 12 cost time: 1.5653376579284668
Epoch: 12, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.454 Vali Acc: 0.432 Test Loss: 3.454 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.53334641456604
Epoch: 13, Steps: 10 | Train Loss: 0.266 Vali Loss: 5.084 Vali Acc: 0.405 Test Loss: 5.084 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4916274547576904
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.109 Vali Acc: 0.486 Test Loss: 4.109 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4833130836486816
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.683 Vali Acc: 0.459 Test Loss: 4.683 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4531443119049072
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.368 Vali Acc: 0.486 Test Loss: 5.368 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3982253074645996
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.105 Vali Acc: 0.459 Test Loss: 4.105 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.453429937362671
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.530 Vali Acc: 0.473 Test Loss: 4.530 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5859272480010986
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.338 Vali Acc: 0.446 Test Loss: 5.338 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.541943073272705
Epoch: 20, Steps: 10 | Train Loss: 0.360 Vali Loss: 7.387 Vali Acc: 0.419 Test Loss: 7.387 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4189262390136719
Epoch: 21, Steps: 10 | Train Loss: 0.333 Vali Loss: 6.353 Vali Acc: 0.405 Test Loss: 6.353 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 1899580
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4871699810028076
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.646 Vali Acc: 0.311 Test Loss: 1.646 Test Acc: 0.311
Validation loss decreased (inf --> -0.310794).  Saving model ...
Epoch: 2 cost time: 1.4847159385681152
Epoch: 2, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.339 Vali Acc: 0.446 Test Loss: 1.339 Test Acc: 0.446
Validation loss decreased (-0.310794 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.4131190776824951
Epoch: 3, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.367 Vali Acc: 0.459 Test Loss: 1.367 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.4323127269744873
Epoch: 4, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.558 Vali Acc: 0.459 Test Loss: 1.558 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4532558917999268
Epoch: 5, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.693 Vali Acc: 0.419 Test Loss: 1.693 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.468207836151123
Epoch: 6, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.880 Vali Acc: 0.500 Test Loss: 1.880 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499981).  Saving model ...
Epoch: 7 cost time: 1.6776535511016846
Epoch: 7, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.944 Vali Acc: 0.446 Test Loss: 1.944 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5245146751403809
Epoch: 8, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.319 Vali Acc: 0.365 Test Loss: 2.319 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.481391191482544
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.159 Vali Acc: 0.432 Test Loss: 3.159 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4761559963226318
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.711 Vali Acc: 0.446 Test Loss: 2.711 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3298256397247314
Epoch: 11, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.199 Vali Acc: 0.541 Test Loss: 3.199 Test Acc: 0.541
Validation loss decreased (-0.499981 --> -0.540509).  Saving model ...
Epoch: 12 cost time: 1.4090566635131836
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.912 Vali Acc: 0.554 Test Loss: 2.912 Test Acc: 0.554
Validation loss decreased (-0.540509 --> -0.554025).  Saving model ...
Epoch: 13 cost time: 1.4224519729614258
Epoch: 13, Steps: 10 | Train Loss: 0.373 Vali Loss: 4.183 Vali Acc: 0.473 Test Loss: 4.183 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4867503643035889
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.922 Vali Acc: 0.514 Test Loss: 3.922 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4017333984375
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.433 Vali Acc: 0.500 Test Loss: 4.433 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3901982307434082
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.608 Vali Acc: 0.419 Test Loss: 4.608 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4935767650604248
Epoch: 17, Steps: 10 | Train Loss: 0.104 Vali Loss: 5.010 Vali Acc: 0.432 Test Loss: 5.010 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4471676349639893
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 7.366 Vali Acc: 0.405 Test Loss: 7.366 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3507664203643799
Epoch: 19, Steps: 10 | Train Loss: 0.196 Vali Loss: 5.370 Vali Acc: 0.459 Test Loss: 5.370 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.461608648300171
Epoch: 20, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.373 Vali Acc: 0.446 Test Loss: 5.373 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3809525966644287
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 5.451 Vali Acc: 0.419 Test Loss: 5.451 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5228023529052734
Epoch: 22, Steps: 10 | Train Loss: 0.114 Vali Loss: 7.474 Vali Acc: 0.419 Test Loss: 7.474 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1899580
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7431485652923584
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.556 Vali Acc: 0.351 Test Loss: 1.556 Test Acc: 0.351
Validation loss decreased (inf --> -0.351336).  Saving model ...
Epoch: 2 cost time: 1.4235291481018066
Epoch: 2, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.375 Vali Acc: 0.432 Test Loss: 1.375 Test Acc: 0.432
Validation loss decreased (-0.351336 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.4819538593292236
Epoch: 3, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.418 Vali Acc: 0.419 Test Loss: 1.418 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.277601957321167
Epoch: 4, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.535 Vali Acc: 0.378 Test Loss: 1.535 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4007186889648438
Epoch: 5, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.604 Vali Acc: 0.446 Test Loss: 1.604 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445930).  Saving model ...
Epoch: 6 cost time: 1.2631194591522217
Epoch: 6, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.742 Vali Acc: 0.459 Test Loss: 1.742 Test Acc: 0.459
Validation loss decreased (-0.445930 --> -0.459442).  Saving model ...
Epoch: 7 cost time: 1.249572515487671
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.160 Vali Acc: 0.392 Test Loss: 2.160 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2868752479553223
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 2.591 Vali Acc: 0.365 Test Loss: 2.591 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2419826984405518
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.179 Vali Acc: 0.392 Test Loss: 2.179 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4620039463043213
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.722 Vali Acc: 0.459 Test Loss: 2.722 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.517045021057129
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.564 Vali Acc: 0.432 Test Loss: 2.564 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3926210403442383
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.709 Vali Acc: 0.432 Test Loss: 2.709 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3971209526062012
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.961 Vali Acc: 0.378 Test Loss: 2.961 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4672136306762695
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.780 Vali Acc: 0.432 Test Loss: 3.780 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3599529266357422
Epoch: 15, Steps: 10 | Train Loss: 0.153 Vali Loss: 5.492 Vali Acc: 0.324 Test Loss: 5.492 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3687758445739746
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.939 Vali Acc: 0.514 Test Loss: 3.939 Test Acc: 0.514
Validation loss decreased (-0.459442 --> -0.513474).  Saving model ...
Epoch: 17 cost time: 1.383296251296997
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.515 Vali Acc: 0.432 Test Loss: 3.515 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4972517490386963
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.338 Vali Acc: 0.446 Test Loss: 5.338 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5256431102752686
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.394 Vali Acc: 0.446 Test Loss: 4.394 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.337733507156372
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.547 Vali Acc: 0.473 Test Loss: 4.547 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3887269496917725
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 6.275 Vali Acc: 0.338 Test Loss: 6.275 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3992717266082764
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 5.502 Vali Acc: 0.392 Test Loss: 5.502 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.351116418838501
Epoch: 23, Steps: 10 | Train Loss: 0.058 Vali Loss: 5.153 Vali Acc: 0.446 Test Loss: 5.153 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.409050464630127
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 6.521 Vali Acc: 0.473 Test Loss: 6.521 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3006739616394043
Epoch: 25, Steps: 10 | Train Loss: 0.129 Vali Loss: 5.705 Vali Acc: 0.392 Test Loss: 5.705 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3009686470031738
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 8.640 Vali Acc: 0.351 Test Loss: 8.640 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1899580
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.518151044845581
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.404 Vali Acc: 0.338 Test Loss: 1.404 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.482558250427246
Epoch: 2, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.350 Vali Acc: 0.419 Test Loss: 1.350 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.4542615413665771
Epoch: 3, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.600 Vali Acc: 0.446 Test Loss: 1.600 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445930).  Saving model ...
Epoch: 4 cost time: 1.5131688117980957
Epoch: 4, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
Validation loss decreased (-0.445930 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 1.603667974472046
Epoch: 5, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.761 Vali Acc: 0.459 Test Loss: 1.761 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6426386833190918
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.434 Vali Acc: 0.473 Test Loss: 2.434 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6721179485321045
Epoch: 7, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.402 Vali Acc: 0.392 Test Loss: 3.402 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6190276145935059
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.838 Vali Acc: 0.459 Test Loss: 2.838 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6086034774780273
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.100 Vali Acc: 0.486 Test Loss: 4.100 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.500171422958374
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 2.606 Vali Acc: 0.568 Test Loss: 2.606 Test Acc: 0.568
Validation loss decreased (-0.499982 --> -0.567542).  Saving model ...
Epoch: 11 cost time: 1.6097702980041504
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.321 Vali Acc: 0.541 Test Loss: 3.321 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5069422721862793
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.395 Vali Acc: 0.446 Test Loss: 4.395 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4179904460906982
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.369 Vali Acc: 0.500 Test Loss: 4.369 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.576723337173462
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.642 Vali Acc: 0.446 Test Loss: 4.642 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5515148639678955
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.288 Vali Acc: 0.392 Test Loss: 4.288 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4516985416412354
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.990 Vali Acc: 0.392 Test Loss: 5.990 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5879383087158203
Epoch: 17, Steps: 10 | Train Loss: 0.251 Vali Loss: 4.849 Vali Acc: 0.500 Test Loss: 4.849 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4819557666778564
Epoch: 18, Steps: 10 | Train Loss: 0.238 Vali Loss: 5.028 Vali Acc: 0.500 Test Loss: 5.028 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5226218700408936
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.946 Vali Acc: 0.554 Test Loss: 4.946 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5785109996795654
Epoch: 20, Steps: 10 | Train Loss: 0.124 Vali Loss: 6.380 Vali Acc: 0.527 Test Loss: 6.380 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1637436
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8441150188446045
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.445 Vali Acc: 0.311 Test Loss: 1.445 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 1.480027198791504
Epoch: 2, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.347 Vali Acc: 0.446 Test Loss: 1.347 Test Acc: 0.446
Validation loss decreased (-0.310796 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.4658925533294678
Epoch: 3, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.610 Vali Acc: 0.405 Test Loss: 1.610 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.629443883895874
Epoch: 4, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.818 Vali Acc: 0.473 Test Loss: 1.818 Test Acc: 0.473
Validation loss decreased (-0.445932 --> -0.472955).  Saving model ...
Epoch: 5 cost time: 1.5971717834472656
Epoch: 5, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.794 Vali Acc: 0.432 Test Loss: 1.794 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6207849979400635
Epoch: 6, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.201 Vali Acc: 0.500 Test Loss: 2.201 Test Acc: 0.500
Validation loss decreased (-0.472955 --> -0.499978).  Saving model ...
Epoch: 7 cost time: 1.416229248046875
Epoch: 7, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.170 Vali Acc: 0.527 Test Loss: 2.170 Test Acc: 0.527
Validation loss decreased (-0.499978 --> -0.527005).  Saving model ...
Epoch: 8 cost time: 1.4025700092315674
Epoch: 8, Steps: 10 | Train Loss: 0.050 Vali Loss: 2.621 Vali Acc: 0.446 Test Loss: 2.621 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4603705406188965
Epoch: 9, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.751 Vali Acc: 0.405 Test Loss: 3.751 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.42867112159729
Epoch: 10, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.227 Vali Acc: 0.514 Test Loss: 3.227 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4740309715270996
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.474 Vali Acc: 0.378 Test Loss: 4.474 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.435495376586914
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 5.487 Vali Acc: 0.432 Test Loss: 5.487 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.340134859085083
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 5.201 Vali Acc: 0.378 Test Loss: 5.201 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3583953380584717
Epoch: 14, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.360 Vali Acc: 0.446 Test Loss: 4.360 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3441987037658691
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.266 Vali Acc: 0.405 Test Loss: 5.266 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5390865802764893
Epoch: 16, Steps: 10 | Train Loss: 0.103 Vali Loss: 6.800 Vali Acc: 0.378 Test Loss: 6.800 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.261744737625122
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.563 Vali Acc: 0.405 Test Loss: 5.563 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1637436
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.457252025604248
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.484 Vali Acc: 0.230 Test Loss: 1.484 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.3789398670196533
Epoch: 2, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.386 Vali Acc: 0.432 Test Loss: 1.386 Test Acc: 0.432
Validation loss decreased (-0.229715 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.3929717540740967
Epoch: 3, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.703 Vali Acc: 0.365 Test Loss: 1.703 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4270646572113037
Epoch: 4, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.672 Vali Acc: 0.446 Test Loss: 1.672 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445929).  Saving model ...
Epoch: 5 cost time: 1.3842487335205078
Epoch: 5, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.516 Vali Acc: 0.446 Test Loss: 1.516 Test Acc: 0.446
Validation loss decreased (-0.445929 --> -0.445931).  Saving model ...
Epoch: 6 cost time: 1.2737400531768799
Epoch: 6, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.538 Vali Acc: 0.432 Test Loss: 2.538 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3175179958343506
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.635 Vali Acc: 0.392 Test Loss: 2.635 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5081477165222168
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.580 Vali Acc: 0.473 Test Loss: 2.580 Test Acc: 0.473
Validation loss decreased (-0.445931 --> -0.472947).  Saving model ...
Epoch: 9 cost time: 1.417048454284668
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.643 Vali Acc: 0.473 Test Loss: 2.643 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3179435729980469
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.011 Vali Acc: 0.459 Test Loss: 3.011 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4059193134307861
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.554 Vali Acc: 0.514 Test Loss: 2.554 Test Acc: 0.514
Validation loss decreased (-0.472947 --> -0.513488).  Saving model ...
Epoch: 12 cost time: 1.4177098274230957
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.942 Vali Acc: 0.473 Test Loss: 2.942 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5017104148864746
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.918 Vali Acc: 0.405 Test Loss: 3.918 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4520227909088135
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.481 Vali Acc: 0.459 Test Loss: 3.481 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3769233226776123
Epoch: 15, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.608 Vali Acc: 0.486 Test Loss: 3.608 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3896214962005615
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 5.107 Vali Acc: 0.351 Test Loss: 5.107 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5014262199401855
Epoch: 17, Steps: 10 | Train Loss: 0.090 Vali Loss: 5.310 Vali Acc: 0.392 Test Loss: 5.310 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.361358880996704
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.381 Vali Acc: 0.473 Test Loss: 5.381 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4489316940307617
Epoch: 19, Steps: 10 | Train Loss: 0.244 Vali Loss: 8.317 Vali Acc: 0.432 Test Loss: 8.317 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5172224044799805
Epoch: 20, Steps: 10 | Train Loss: 0.162 Vali Loss: 6.185 Vali Acc: 0.432 Test Loss: 6.185 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4067494869232178
Epoch: 21, Steps: 10 | Train Loss: 0.110 Vali Loss: 11.690 Vali Acc: 0.284 Test Loss: 11.690 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1637436
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4398880004882812
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.424 Vali Acc: 0.243 Test Loss: 1.424 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.3439197540283203
Epoch: 2, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.466 Vali Acc: 0.365 Test Loss: 1.466 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364850).  Saving model ...
Epoch: 3 cost time: 1.1253080368041992
Epoch: 3, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.914 Vali Acc: 0.378 Test Loss: 1.914 Test Acc: 0.378
Validation loss decreased (-0.364850 --> -0.378359).  Saving model ...
Epoch: 4 cost time: 1.338411808013916
Epoch: 4, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.580 Vali Acc: 0.405 Test Loss: 1.580 Test Acc: 0.405
Validation loss decreased (-0.378359 --> -0.405390).  Saving model ...
Epoch: 5 cost time: 1.343409538269043
Epoch: 5, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
Validation loss decreased (-0.405390 --> -0.472958).  Saving model ...
Epoch: 6 cost time: 1.3006248474121094
Epoch: 6, Steps: 10 | Train Loss: 0.047 Vali Loss: 2.185 Vali Acc: 0.351 Test Loss: 2.185 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3532865047454834
Epoch: 7, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.868 Vali Acc: 0.405 Test Loss: 1.868 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1674726009368896
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.166 Vali Acc: 0.459 Test Loss: 2.166 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1509790420532227
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.028 Vali Acc: 0.419 Test Loss: 3.028 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4067997932434082
Epoch: 10, Steps: 10 | Train Loss: 0.102 Vali Loss: 2.651 Vali Acc: 0.514 Test Loss: 2.651 Test Acc: 0.514
Validation loss decreased (-0.472958 --> -0.513487).  Saving model ...
Epoch: 11 cost time: 1.3290681838989258
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.190 Vali Acc: 0.473 Test Loss: 3.190 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.234358787536621
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.107 Vali Acc: 0.459 Test Loss: 3.107 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5210049152374268
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.979 Vali Acc: 0.338 Test Loss: 3.979 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.470597743988037
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.147 Vali Acc: 0.473 Test Loss: 3.147 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.458836555480957
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.183 Vali Acc: 0.473 Test Loss: 3.183 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.455641269683838
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.333 Vali Acc: 0.365 Test Loss: 4.333 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3965048789978027
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.917 Vali Acc: 0.486 Test Loss: 4.917 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.268228530883789
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 5.505 Vali Acc: 0.324 Test Loss: 5.505 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3465466499328613
Epoch: 19, Steps: 10 | Train Loss: 0.220 Vali Loss: 4.546 Vali Acc: 0.486 Test Loss: 4.546 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3376991748809814
Epoch: 20, Steps: 10 | Train Loss: 0.151 Vali Loss: 5.526 Vali Acc: 0.527 Test Loss: 5.526 Test Acc: 0.527
Validation loss decreased (-0.513487 --> -0.526972).  Saving model ...
Epoch: 21 cost time: 1.320927619934082
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.506 Vali Acc: 0.432 Test Loss: 4.506 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2948694229125977
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.538 Vali Acc: 0.432 Test Loss: 5.538 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4639256000518799
Epoch: 23, Steps: 10 | Train Loss: 0.116 Vali Loss: 6.293 Vali Acc: 0.297 Test Loss: 6.293 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4448342323303223
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.352 Vali Acc: 0.419 Test Loss: 5.352 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5697612762451172
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.860 Vali Acc: 0.351 Test Loss: 6.860 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.511981725692749
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 6.084 Vali Acc: 0.486 Test Loss: 6.084 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2647197246551514
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 6.707 Vali Acc: 0.446 Test Loss: 6.707 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3134276866912842
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 6.098 Vali Acc: 0.486 Test Loss: 6.098 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4360077381134033
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.329 Vali Acc: 0.459 Test Loss: 6.329 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3984670639038086
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.967 Vali Acc: 0.473 Test Loss: 5.967 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1637436
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.398597478866577
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.298 Vali Acc: 0.392 Test Loss: 1.298 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.4738786220550537
Epoch: 2, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.848 Vali Acc: 0.324 Test Loss: 1.848 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2383501529693604
Epoch: 3, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.636 Vali Acc: 0.446 Test Loss: 1.636 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445930).  Saving model ...
Epoch: 4 cost time: 1.4726946353912354
Epoch: 4, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.637 Vali Acc: 0.473 Test Loss: 1.637 Test Acc: 0.473
Validation loss decreased (-0.445930 --> -0.472957).  Saving model ...
Epoch: 5 cost time: 1.430711269378662
Epoch: 5, Steps: 10 | Train Loss: 0.138 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
Validation loss decreased (-0.472957 --> -0.499978).  Saving model ...
Epoch: 6 cost time: 1.452244520187378
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 2.088 Vali Acc: 0.459 Test Loss: 2.088 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5641670227050781
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.533 Vali Acc: 0.500 Test Loss: 2.533 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4975767135620117
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.399 Vali Acc: 0.473 Test Loss: 3.399 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4091532230377197
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.033 Vali Acc: 0.446 Test Loss: 4.033 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5570812225341797
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.255 Vali Acc: 0.514 Test Loss: 3.255 Test Acc: 0.514
Validation loss decreased (-0.499978 --> -0.513481).  Saving model ...
Epoch: 11 cost time: 1.3341784477233887
Epoch: 11, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.442 Vali Acc: 0.541 Test Loss: 3.442 Test Acc: 0.541
Validation loss decreased (-0.513481 --> -0.540506).  Saving model ...
Epoch: 12 cost time: 1.5424606800079346
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 5.063 Vali Acc: 0.392 Test Loss: 5.063 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4760138988494873
Epoch: 13, Steps: 10 | Train Loss: 0.336 Vali Loss: 5.176 Vali Acc: 0.527 Test Loss: 5.176 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5423552989959717
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.129 Vali Acc: 0.432 Test Loss: 4.129 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.524144172668457
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.586 Vali Acc: 0.486 Test Loss: 4.586 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4669888019561768
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.815 Vali Acc: 0.459 Test Loss: 5.815 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6096148490905762
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 5.987 Vali Acc: 0.446 Test Loss: 5.987 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4311296939849854
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.071 Vali Acc: 0.500 Test Loss: 5.071 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4254953861236572
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.930 Vali Acc: 0.405 Test Loss: 4.930 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4376506805419922
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 6.297 Vali Acc: 0.405 Test Loss: 6.297 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.400092363357544
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 5.461 Vali Acc: 0.446 Test Loss: 5.461 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1506364
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.497488260269165
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.317 Vali Acc: 0.378 Test Loss: 1.317 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.525827169418335
Epoch: 2, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.712 Vali Acc: 0.365 Test Loss: 1.712 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5553431510925293
Epoch: 3, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.573 Vali Acc: 0.500 Test Loss: 1.573 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 1.3413634300231934
Epoch: 4, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.517 Vali Acc: 0.459 Test Loss: 1.517 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.476640224456787
Epoch: 5, Steps: 10 | Train Loss: 0.117 Vali Loss: 2.301 Vali Acc: 0.419 Test Loss: 2.301 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4311623573303223
Epoch: 6, Steps: 10 | Train Loss: 0.176 Vali Loss: 2.167 Vali Acc: 0.405 Test Loss: 2.167 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.519533634185791
Epoch: 7, Steps: 10 | Train Loss: 0.097 Vali Loss: 2.548 Vali Acc: 0.459 Test Loss: 2.548 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4575650691986084
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.689 Vali Acc: 0.419 Test Loss: 2.689 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5623152256011963
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.143 Vali Acc: 0.297 Test Loss: 4.143 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.602466106414795
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.380 Vali Acc: 0.324 Test Loss: 4.380 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4376311302185059
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.956 Vali Acc: 0.405 Test Loss: 3.956 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5042445659637451
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.071 Vali Acc: 0.378 Test Loss: 4.071 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5428757667541504
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.340 Vali Acc: 0.527 Test Loss: 4.340 Test Acc: 0.527
Validation loss decreased (-0.499984 --> -0.526984).  Saving model ...
Epoch: 14 cost time: 1.5747745037078857
Epoch: 14, Steps: 10 | Train Loss: 0.133 Vali Loss: 6.285 Vali Acc: 0.419 Test Loss: 6.285 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.544813632965088
Epoch: 15, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.618 Vali Acc: 0.514 Test Loss: 4.618 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4623239040374756
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 5.044 Vali Acc: 0.500 Test Loss: 5.044 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4090394973754883
Epoch: 17, Steps: 10 | Train Loss: 0.186 Vali Loss: 5.770 Vali Acc: 0.378 Test Loss: 5.770 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3872137069702148
Epoch: 18, Steps: 10 | Train Loss: 0.191 Vali Loss: 9.778 Vali Acc: 0.365 Test Loss: 9.778 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3282032012939453
Epoch: 19, Steps: 10 | Train Loss: 0.290 Vali Loss: 6.533 Vali Acc: 0.432 Test Loss: 6.533 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.539055585861206
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 8.779 Vali Acc: 0.432 Test Loss: 8.779 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6006572246551514
Epoch: 21, Steps: 10 | Train Loss: 0.123 Vali Loss: 6.195 Vali Acc: 0.432 Test Loss: 6.195 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4490506649017334
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 6.694 Vali Acc: 0.486 Test Loss: 6.694 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4596517086029053
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.094 Vali Acc: 0.473 Test Loss: 5.094 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1506364
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.260763645172119
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.358 Vali Acc: 0.405 Test Loss: 1.358 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.31221342086792
Epoch: 2, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.760 Vali Acc: 0.365 Test Loss: 1.760 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1834518909454346
Epoch: 3, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.898 Vali Acc: 0.486 Test Loss: 1.898 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486468).  Saving model ...
Epoch: 4 cost time: 1.3269405364990234
Epoch: 4, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.610 Vali Acc: 0.446 Test Loss: 1.610 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1490705013275146
Epoch: 5, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.646 Vali Acc: 0.486 Test Loss: 1.646 Test Acc: 0.486
Validation loss decreased (-0.486468 --> -0.486470).  Saving model ...
Epoch: 6 cost time: 1.2015936374664307
Epoch: 6, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.978 Vali Acc: 0.446 Test Loss: 1.978 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3177506923675537
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.722 Vali Acc: 0.432 Test Loss: 2.722 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3858468532562256
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.169 Vali Acc: 0.459 Test Loss: 2.169 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4727287292480469
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.835 Vali Acc: 0.486 Test Loss: 2.835 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.382277488708496
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.587 Vali Acc: 0.473 Test Loss: 2.587 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.39862060546875
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.346 Vali Acc: 0.432 Test Loss: 3.346 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4406838417053223
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.157 Vali Acc: 0.432 Test Loss: 3.157 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.374204397201538
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.231 Vali Acc: 0.419 Test Loss: 3.231 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4558343887329102
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.120 Vali Acc: 0.473 Test Loss: 4.120 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3755731582641602
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.844 Vali Acc: 0.514 Test Loss: 3.844 Test Acc: 0.514
Validation loss decreased (-0.486470 --> -0.513475).  Saving model ...
Epoch: 16 cost time: 1.6031067371368408
Epoch: 16, Steps: 10 | Train Loss: 0.390 Vali Loss: 4.688 Vali Acc: 0.432 Test Loss: 4.688 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3502936363220215
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.703 Vali Acc: 0.405 Test Loss: 4.703 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4327008724212646
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 7.714 Vali Acc: 0.351 Test Loss: 7.714 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3634593486785889
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 6.165 Vali Acc: 0.405 Test Loss: 6.165 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4847888946533203
Epoch: 20, Steps: 10 | Train Loss: 0.130 Vali Loss: 5.623 Vali Acc: 0.365 Test Loss: 5.623 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5233840942382812
Epoch: 21, Steps: 10 | Train Loss: 0.147 Vali Loss: 6.889 Vali Acc: 0.432 Test Loss: 6.889 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3184080123901367
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 5.127 Vali Acc: 0.486 Test Loss: 5.127 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4532115459442139
Epoch: 23, Steps: 10 | Train Loss: 0.255 Vali Loss: 7.033 Vali Acc: 0.419 Test Loss: 7.033 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.501720905303955
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 7.738 Vali Acc: 0.405 Test Loss: 7.738 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4051740169525146
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.047 Vali Acc: 0.446 Test Loss: 7.047 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1506364
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.353332757949829
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.356 Vali Acc: 0.432 Test Loss: 1.356 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.438572645187378
Epoch: 2, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.628 Vali Acc: 0.419 Test Loss: 1.628 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.339592695236206
Epoch: 3, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.736 Vali Acc: 0.514 Test Loss: 1.736 Test Acc: 0.514
Validation loss decreased (-0.432419 --> -0.513496).  Saving model ...
Epoch: 4 cost time: 1.2377994060516357
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.641 Vali Acc: 0.473 Test Loss: 1.641 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2963595390319824
Epoch: 5, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.900 Vali Acc: 0.459 Test Loss: 1.900 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3295085430145264
Epoch: 6, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.752 Vali Acc: 0.473 Test Loss: 1.752 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2693464756011963
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.298 Vali Acc: 0.446 Test Loss: 2.298 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.351454496383667
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 2.421 Vali Acc: 0.392 Test Loss: 2.421 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4064836502075195
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.500 Vali Acc: 0.419 Test Loss: 2.500 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1508536338806152
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.321 Vali Acc: 0.446 Test Loss: 2.321 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.257030725479126
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.463 Vali Acc: 0.419 Test Loss: 2.463 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2097744941711426
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.670 Vali Acc: 0.419 Test Loss: 2.670 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3457095623016357
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.713 Vali Acc: 0.378 Test Loss: 2.713 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1506364
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7332024574279785
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.4299676418304443
Epoch: 2, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.368 Vali Acc: 0.446 Test Loss: 1.368 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.5349981784820557
Epoch: 3, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.709 Vali Acc: 0.486 Test Loss: 1.709 Test Acc: 0.486
Validation loss decreased (-0.445932 --> -0.486469).  Saving model ...
Epoch: 4 cost time: 1.484586238861084
Epoch: 4, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.564 Vali Acc: 0.486 Test Loss: 1.564 Test Acc: 0.486
Validation loss decreased (-0.486469 --> -0.486471).  Saving model ...
Epoch: 5 cost time: 1.4920175075531006
Epoch: 5, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.044 Vali Acc: 0.432 Test Loss: 2.044 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3958618640899658
Epoch: 6, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.650 Vali Acc: 0.432 Test Loss: 2.650 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5725171566009521
Epoch: 7, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.093 Vali Acc: 0.500 Test Loss: 3.093 Test Acc: 0.500
Validation loss decreased (-0.486471 --> -0.499969).  Saving model ...
Epoch: 8 cost time: 1.500180721282959
Epoch: 8, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.209 Vali Acc: 0.486 Test Loss: 3.209 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4396693706512451
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 2.952 Vali Acc: 0.514 Test Loss: 2.952 Test Acc: 0.514
Validation loss decreased (-0.499969 --> -0.513484).  Saving model ...
Epoch: 10 cost time: 1.5315990447998047
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.428 Vali Acc: 0.459 Test Loss: 3.428 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.581193208694458
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.431 Vali Acc: 0.486 Test Loss: 3.431 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6260600090026855
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.928 Vali Acc: 0.473 Test Loss: 3.928 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5130836963653564
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.648 Vali Acc: 0.486 Test Loss: 4.648 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.473449468612671
Epoch: 14, Steps: 10 | Train Loss: 0.421 Vali Loss: 6.926 Vali Acc: 0.405 Test Loss: 6.926 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5101232528686523
Epoch: 15, Steps: 10 | Train Loss: 0.350 Vali Loss: 5.090 Vali Acc: 0.486 Test Loss: 5.090 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4238612651824951
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 5.538 Vali Acc: 0.459 Test Loss: 5.538 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4209108352661133
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.585 Vali Acc: 0.459 Test Loss: 6.585 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4149301052093506
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.814 Vali Acc: 0.392 Test Loss: 6.814 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.536102056503296
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.881 Vali Acc: 0.419 Test Loss: 7.881 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1440828
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.736816167831421
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.326 Vali Acc: 0.432 Test Loss: 1.326 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.582167387008667
Epoch: 2, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.385 Vali Acc: 0.446 Test Loss: 1.385 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.5352916717529297
Epoch: 3, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.482 Vali Acc: 0.486 Test Loss: 1.482 Test Acc: 0.486
Validation loss decreased (-0.445932 --> -0.486472).  Saving model ...
Epoch: 4 cost time: 1.4974563121795654
Epoch: 4, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.624 Vali Acc: 0.392 Test Loss: 1.624 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4388740062713623
Epoch: 5, Steps: 10 | Train Loss: 0.081 Vali Loss: 2.886 Vali Acc: 0.338 Test Loss: 2.886 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7489440441131592
Epoch: 6, Steps: 10 | Train Loss: 0.260 Vali Loss: 2.195 Vali Acc: 0.446 Test Loss: 2.195 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4196033477783203
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.464 Vali Acc: 0.405 Test Loss: 2.464 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6428554058074951
Epoch: 8, Steps: 10 | Train Loss: 0.114 Vali Loss: 2.684 Vali Acc: 0.527 Test Loss: 2.684 Test Acc: 0.527
Validation loss decreased (-0.486472 --> -0.527000).  Saving model ...
Epoch: 9 cost time: 1.6396188735961914
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.175 Vali Acc: 0.514 Test Loss: 3.175 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5416209697723389
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.643 Vali Acc: 0.473 Test Loss: 3.643 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.450801134109497
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.432 Vali Acc: 0.419 Test Loss: 3.432 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5719237327575684
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.463 Vali Acc: 0.473 Test Loss: 4.463 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4999396800994873
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.999 Vali Acc: 0.432 Test Loss: 4.999 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2938969135284424
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.884 Vali Acc: 0.419 Test Loss: 4.884 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4394054412841797
Epoch: 15, Steps: 10 | Train Loss: 0.262 Vali Loss: 6.542 Vali Acc: 0.378 Test Loss: 6.542 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6397888660430908
Epoch: 16, Steps: 10 | Train Loss: 0.284 Vali Loss: 5.547 Vali Acc: 0.500 Test Loss: 5.547 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3453969955444336
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 6.427 Vali Acc: 0.446 Test Loss: 6.427 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6606783866882324
Epoch: 18, Steps: 10 | Train Loss: 0.096 Vali Loss: 6.356 Vali Acc: 0.432 Test Loss: 6.356 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1440828
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.585437297821045
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.332 Vali Acc: 0.419 Test Loss: 1.332 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.5309784412384033
Epoch: 2, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.379 Vali Acc: 0.446 Test Loss: 1.379 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.618091106414795
Epoch: 3, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.384 Vali Acc: 0.473 Test Loss: 1.384 Test Acc: 0.473
Validation loss decreased (-0.445932 --> -0.472959).  Saving model ...
Epoch: 4 cost time: 1.6561062335968018
Epoch: 4, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.661 Vali Acc: 0.365 Test Loss: 1.661 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6259939670562744
Epoch: 5, Steps: 10 | Train Loss: 0.111 Vali Loss: 2.331 Vali Acc: 0.419 Test Loss: 2.331 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5320727825164795
Epoch: 6, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.878 Vali Acc: 0.473 Test Loss: 1.878 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.213611364364624
Epoch: 7, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.897 Vali Acc: 0.459 Test Loss: 1.897 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4362118244171143
Epoch: 8, Steps: 10 | Train Loss: 0.065 Vali Loss: 2.022 Vali Acc: 0.473 Test Loss: 2.022 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6539907455444336
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.519 Vali Acc: 0.419 Test Loss: 3.519 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5050017833709717
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.533 Vali Acc: 0.338 Test Loss: 3.533 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4998655319213867
Epoch: 11, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.698 Vali Acc: 0.419 Test Loss: 4.698 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4377970695495605
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.984 Vali Acc: 0.392 Test Loss: 4.984 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4480221271514893
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.261 Vali Acc: 0.500 Test Loss: 4.261 Test Acc: 0.500
Validation loss decreased (-0.472959 --> -0.499957).  Saving model ...
Epoch: 14 cost time: 1.5123910903930664
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.662 Vali Acc: 0.419 Test Loss: 5.662 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4413931369781494
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.886 Vali Acc: 0.527 Test Loss: 3.886 Test Acc: 0.527
Validation loss decreased (-0.499957 --> -0.526988).  Saving model ...
Epoch: 16 cost time: 1.421187162399292
Epoch: 16, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.078 Vali Acc: 0.527 Test Loss: 4.078 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.28641676902771
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.538 Vali Acc: 0.473 Test Loss: 4.538 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4871017932891846
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.674 Vali Acc: 0.486 Test Loss: 4.674 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5094926357269287
Epoch: 19, Steps: 10 | Train Loss: 0.260 Vali Loss: 5.820 Vali Acc: 0.486 Test Loss: 5.820 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4723114967346191
Epoch: 20, Steps: 10 | Train Loss: 0.226 Vali Loss: 8.497 Vali Acc: 0.311 Test Loss: 8.497 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4969851970672607
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 6.010 Vali Acc: 0.473 Test Loss: 6.010 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5352184772491455
Epoch: 22, Steps: 10 | Train Loss: 0.200 Vali Loss: 7.349 Vali Acc: 0.365 Test Loss: 7.349 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5165672302246094
Epoch: 23, Steps: 10 | Train Loss: 0.280 Vali Loss: 5.594 Vali Acc: 0.473 Test Loss: 5.594 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4222960472106934
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 6.516 Vali Acc: 0.432 Test Loss: 6.516 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5074586868286133
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.097 Vali Acc: 0.459 Test Loss: 6.097 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1440828
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1568939685821533
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.334 Vali Acc: 0.284 Test Loss: 1.334 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2129967212677002
Epoch: 2, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.417 Vali Acc: 0.365 Test Loss: 1.417 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.3200247287750244
Epoch: 3, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.419 Vali Acc: 0.419 Test Loss: 1.419 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.2958741188049316
Epoch: 4, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.595 Vali Acc: 0.351 Test Loss: 1.595 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2481768131256104
Epoch: 5, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.616 Vali Acc: 0.405 Test Loss: 1.616 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2859001159667969
Epoch: 6, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.942 Vali Acc: 0.459 Test Loss: 1.942 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459440).  Saving model ...
Epoch: 7 cost time: 1.1481869220733643
Epoch: 7, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.952 Vali Acc: 0.432 Test Loss: 1.952 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.271235704421997
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.289 Vali Acc: 0.392 Test Loss: 2.289 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.263333797454834
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.427 Vali Acc: 0.541 Test Loss: 2.427 Test Acc: 0.541
Validation loss decreased (-0.459440 --> -0.540516).  Saving model ...
Epoch: 10 cost time: 1.365058422088623
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.932 Vali Acc: 0.432 Test Loss: 2.932 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.22890305519104
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.775 Vali Acc: 0.405 Test Loss: 2.775 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2726249694824219
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.870 Vali Acc: 0.486 Test Loss: 2.870 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.415607213973999
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.326 Vali Acc: 0.432 Test Loss: 3.326 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4093072414398193
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.094 Vali Acc: 0.378 Test Loss: 4.094 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2974181175231934
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.560 Vali Acc: 0.365 Test Loss: 4.560 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3707008361816406
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.228 Vali Acc: 0.432 Test Loss: 4.228 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2886502742767334
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.831 Vali Acc: 0.378 Test Loss: 4.831 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4184753894805908
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.752 Vali Acc: 0.432 Test Loss: 4.752 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3325982093811035
Epoch: 19, Steps: 10 | Train Loss: 0.267 Vali Loss: 8.685 Vali Acc: 0.432 Test Loss: 8.685 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1440828
model size : 15.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1971077919006348
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.348 Vali Acc: 0.338 Test Loss: 1.348 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.2402148246765137
Epoch: 2, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.337 Vali Acc: 0.446 Test Loss: 1.337 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.1692960262298584
Epoch: 3, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.163640022277832
Epoch: 4, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.435 Vali Acc: 0.432 Test Loss: 1.435 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.225295066833496
Epoch: 5, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.507 Vali Acc: 0.459 Test Loss: 1.507 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.217242956161499
Epoch: 6, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.800 Vali Acc: 0.432 Test Loss: 1.800 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.106511116027832
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.732 Vali Acc: 0.486 Test Loss: 1.732 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.153278112411499
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.803 Vali Acc: 0.473 Test Loss: 1.803 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4915409088134766
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.867 Vali Acc: 0.500 Test Loss: 1.867 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3332784175872803
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.744 Vali Acc: 0.486 Test Loss: 1.744 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1983323097229004
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.085 Vali Acc: 0.432 Test Loss: 2.085 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2785661220550537
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.500 Test Loss: 1.854 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2160356044769287
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.888 Vali Acc: 0.500 Test Loss: 1.888 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 1605180
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.319992780685425
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.353 Vali Acc: 0.365 Test Loss: 1.353 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.2554457187652588
Epoch: 2, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.367 Vali Acc: 0.459 Test Loss: 1.367 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.309528112411499
Epoch: 3, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.219721794128418
Epoch: 4, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.385 Vali Acc: 0.459 Test Loss: 1.385 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1942083835601807
Epoch: 5, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.558 Vali Acc: 0.405 Test Loss: 1.558 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1409990787506104
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.687 Vali Acc: 0.419 Test Loss: 1.687 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9931111335754395
Epoch: 7, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.590 Vali Acc: 0.419 Test Loss: 1.590 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1873655319213867
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.630 Vali Acc: 0.500 Test Loss: 1.630 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499984).  Saving model ...
Epoch: 9 cost time: 1.1135034561157227
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.812 Vali Acc: 0.473 Test Loss: 1.812 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.183631181716919
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.799 Vali Acc: 0.514 Test Loss: 1.799 Test Acc: 0.514
Validation loss decreased (-0.499984 --> -0.513496).  Saving model ...
Epoch: 11 cost time: 1.1116807460784912
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.847 Vali Acc: 0.473 Test Loss: 1.847 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2791087627410889
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.486 Test Loss: 1.795 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2208433151245117
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.459 Test Loss: 1.855 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3535480499267578
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.473 Test Loss: 1.883 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1769285202026367
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.486 Test Loss: 1.862 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2597205638885498
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.459 Test Loss: 1.838 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1981494426727295
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.459 Test Loss: 1.841 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3354606628417969
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.459 Test Loss: 1.845 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.247828483581543
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.459 Test Loss: 1.846 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.274960994720459
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.459 Test Loss: 1.847 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 1605180
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1319072246551514
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.363 Vali Acc: 0.270 Test Loss: 1.363 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.0998504161834717
Epoch: 2, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.368 Vali Acc: 0.419 Test Loss: 1.368 Test Acc: 0.419
Validation loss decreased (-0.270257 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.118171215057373
Epoch: 3, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.1636533737182617
Epoch: 4, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.447 Vali Acc: 0.392 Test Loss: 1.447 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0576939582824707
Epoch: 5, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.674 Vali Acc: 0.365 Test Loss: 1.674 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.093163013458252
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.744 Vali Acc: 0.392 Test Loss: 1.744 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0862176418304443
Epoch: 7, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.664 Vali Acc: 0.365 Test Loss: 1.664 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1166346073150635
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.640 Vali Acc: 0.446 Test Loss: 1.640 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0219955444335938
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.838 Vali Acc: 0.459 Test Loss: 1.838 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1689167022705078
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.812 Vali Acc: 0.473 Test Loss: 1.812 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472955).  Saving model ...
Epoch: 11 cost time: 1.0395617485046387
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.022 Vali Acc: 0.419 Test Loss: 2.022 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0780251026153564
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.190 Vali Acc: 0.405 Test Loss: 2.190 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1369175910949707
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.951 Vali Acc: 0.486 Test Loss: 1.951 Test Acc: 0.486
Validation loss decreased (-0.472955 --> -0.486467).  Saving model ...
Epoch: 14 cost time: 1.1378905773162842
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.010 Vali Acc: 0.459 Test Loss: 2.010 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.10048508644104
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.000 Vali Acc: 0.446 Test Loss: 2.000 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0745680332183838
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.486 Test Loss: 1.905 Test Acc: 0.486
Validation loss decreased (-0.486467 --> -0.486467).  Saving model ...
Epoch: 17 cost time: 1.191141128540039
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.486 Test Loss: 1.863 Test Acc: 0.486
Validation loss decreased (-0.486467 --> -0.486468).  Saving model ...
Epoch: 18 cost time: 1.2029190063476562
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.473 Test Loss: 1.879 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.134274959564209
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.473 Test Loss: 1.880 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0698065757751465
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.473 Test Loss: 1.883 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0692219734191895
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.473 Test Loss: 1.890 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0776774883270264
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.486 Test Loss: 1.889 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.107314109802246
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.486 Test Loss: 1.900 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.061112642288208
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.486 Test Loss: 1.898 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0877187252044678
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.486 Test Loss: 1.897 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0820338726043701
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.473 Test Loss: 1.895 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.143916130065918
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.473 Test Loss: 1.903 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 1605180
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.97282338142395
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.331 Vali Acc: 0.257 Test Loss: 1.331 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0988943576812744
Epoch: 2, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.364 Vali Acc: 0.446 Test Loss: 1.364 Test Acc: 0.446
Validation loss decreased (-0.256743 --> -0.445932).  Saving model ...
Epoch: 3 cost time: 1.0848400592803955
Epoch: 3, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.342 Vali Acc: 0.405 Test Loss: 1.342 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0100476741790771
Epoch: 4, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.426 Vali Acc: 0.378 Test Loss: 1.426 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2043955326080322
Epoch: 5, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.336 Vali Acc: 0.446 Test Loss: 1.336 Test Acc: 0.446
Validation loss decreased (-0.445932 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.137845516204834
Epoch: 6, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.468 Vali Acc: 0.392 Test Loss: 1.468 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.199373483657837
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.630 Vali Acc: 0.392 Test Loss: 1.630 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1364431381225586
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.804 Vali Acc: 0.419 Test Loss: 1.804 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0949862003326416
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.825 Vali Acc: 0.459 Test Loss: 1.825 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459441).  Saving model ...
Epoch: 10 cost time: 1.1249194145202637
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.906 Vali Acc: 0.378 Test Loss: 1.906 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1409382820129395
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.978 Vali Acc: 0.392 Test Loss: 1.978 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1710941791534424
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.738 Vali Acc: 0.351 Test Loss: 2.738 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1840901374816895
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.367 Vali Acc: 0.378 Test Loss: 2.367 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0854089260101318
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.409 Vali Acc: 0.446 Test Loss: 2.409 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1412785053253174
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.645 Vali Acc: 0.405 Test Loss: 2.645 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1270310878753662
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.457 Vali Acc: 0.432 Test Loss: 2.457 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1175475120544434
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.348 Vali Acc: 0.419 Test Loss: 2.348 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0648622512817383
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.427 Vali Acc: 0.446 Test Loss: 2.427 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.064683437347412
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.374 Vali Acc: 0.446 Test Loss: 2.374 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 1605180
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1640875339508057
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.1001243591308594
Epoch: 2, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.297284 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.2541255950927734
Epoch: 3, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.313 Vali Acc: 0.486 Test Loss: 1.313 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.035611867904663
Epoch: 4, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.338 Vali Acc: 0.486 Test Loss: 1.338 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2918860912322998
Epoch: 5, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.678 Vali Acc: 0.405 Test Loss: 1.678 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.221609354019165
Epoch: 6, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.917 Vali Acc: 0.514 Test Loss: 1.917 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513494).  Saving model ...
Epoch: 7 cost time: 1.2821803092956543
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.838 Vali Acc: 0.432 Test Loss: 1.838 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1762657165527344
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.088 Vali Acc: 0.446 Test Loss: 2.088 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2819406986236572
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.971 Vali Acc: 0.419 Test Loss: 1.971 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1272664070129395
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.595 Vali Acc: 0.500 Test Loss: 2.595 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.225560188293457
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 2.732 Vali Acc: 0.446 Test Loss: 2.732 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.293760061264038
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.279 Vali Acc: 0.514 Test Loss: 2.279 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.233292579650879
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.270 Vali Acc: 0.541 Test Loss: 2.270 Test Acc: 0.541
Validation loss decreased (-0.513494 --> -0.540518).  Saving model ...
Epoch: 14 cost time: 1.1954987049102783
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.120 Vali Acc: 0.473 Test Loss: 3.120 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2480313777923584
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.613 Vali Acc: 0.514 Test Loss: 2.613 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1873855590820312
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.663 Vali Acc: 0.473 Test Loss: 2.663 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.235459327697754
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.498 Vali Acc: 0.473 Test Loss: 2.498 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1783170700073242
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.457 Vali Acc: 0.500 Test Loss: 2.457 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1628570556640625
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.486 Test Loss: 2.351 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.195199966430664
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.472 Vali Acc: 0.486 Test Loss: 2.472 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2788660526275635
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.486 Test Loss: 2.467 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3318698406219482
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.473 Test Loss: 2.402 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2019016742706299
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.473 Test Loss: 2.358 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 1080892
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9859328269958496
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.404 Vali Acc: 0.284 Test Loss: 1.404 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1755619049072266
Epoch: 2, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.326 Vali Acc: 0.405 Test Loss: 1.326 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.1673450469970703
Epoch: 3, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.308 Vali Acc: 0.486 Test Loss: 1.308 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.0975072383880615
Epoch: 4, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.368 Vali Acc: 0.405 Test Loss: 1.368 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2349317073822021
Epoch: 5, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.793 Vali Acc: 0.459 Test Loss: 1.793 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1619467735290527
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.771 Vali Acc: 0.419 Test Loss: 1.771 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2042877674102783
Epoch: 7, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.874 Vali Acc: 0.419 Test Loss: 1.874 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1317338943481445
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.118 Vali Acc: 0.432 Test Loss: 2.118 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1405348777770996
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.916 Vali Acc: 0.473 Test Loss: 1.916 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1712596416473389
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.088 Vali Acc: 0.473 Test Loss: 2.088 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.15291428565979
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.957 Vali Acc: 0.514 Test Loss: 1.957 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513494).  Saving model ...
Epoch: 12 cost time: 1.1536154747009277
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.707 Vali Acc: 0.392 Test Loss: 2.707 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.227297067642212
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.304 Vali Acc: 0.473 Test Loss: 2.304 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.188720703125
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.400 Vali Acc: 0.459 Test Loss: 2.400 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1026484966278076
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.280 Vali Acc: 0.500 Test Loss: 2.280 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1914854049682617
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.343 Vali Acc: 0.486 Test Loss: 2.343 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.043118953704834
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.230 Vali Acc: 0.500 Test Loss: 2.230 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.111964464187622
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.285 Vali Acc: 0.486 Test Loss: 2.285 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1750423908233643
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.123 Vali Acc: 0.527 Test Loss: 2.123 Test Acc: 0.527
Validation loss decreased (-0.513494 --> -0.527006).  Saving model ...
Epoch: 20 cost time: 1.223703384399414
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.514 Test Loss: 2.129 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2614848613739014
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.486 Test Loss: 2.149 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3016183376312256
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.486 Test Loss: 2.158 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.204824447631836
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.486 Test Loss: 2.171 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1205482482910156
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.180 Vali Acc: 0.473 Test Loss: 2.180 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1509246826171875
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.473 Test Loss: 2.183 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2807748317718506
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.473 Test Loss: 2.182 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1702423095703125
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.175 Vali Acc: 0.486 Test Loss: 2.175 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1349189281463623
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.486 Test Loss: 2.174 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2340185642242432
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.486 Test Loss: 2.174 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 1080892
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1193020343780518
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.408 Vali Acc: 0.311 Test Loss: 1.408 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.076982021331787
Epoch: 2, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.360 Vali Acc: 0.378 Test Loss: 1.360 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0199918746948242
Epoch: 3, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1093616485595703
Epoch: 4, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.411 Vali Acc: 0.405 Test Loss: 1.411 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0486419200897217
Epoch: 5, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.506 Vali Acc: 0.378 Test Loss: 1.506 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1160767078399658
Epoch: 6, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.687 Vali Acc: 0.459 Test Loss: 1.687 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459443).  Saving model ...
Epoch: 7 cost time: 1.0482509136199951
Epoch: 7, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.899 Vali Acc: 0.392 Test Loss: 1.899 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.08255934715271
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 2.498 Vali Acc: 0.378 Test Loss: 2.498 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.113462209701538
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.004 Vali Acc: 0.405 Test Loss: 2.004 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.127546787261963
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.962 Vali Acc: 0.392 Test Loss: 1.962 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1266803741455078
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.673 Vali Acc: 0.419 Test Loss: 2.673 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9219672679901123
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.163 Vali Acc: 0.419 Test Loss: 2.163 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9831302165985107
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.240 Vali Acc: 0.378 Test Loss: 2.240 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9036614894866943
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.482 Vali Acc: 0.378 Test Loss: 2.482 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0572683811187744
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.376 Vali Acc: 0.392 Test Loss: 2.376 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.082381248474121
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.201 Vali Acc: 0.419 Test Loss: 2.201 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 1080892
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9426724910736084
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.131312370300293
Epoch: 2, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.359 Vali Acc: 0.392 Test Loss: 1.359 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.0763616561889648
Epoch: 3, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.286 Vali Acc: 0.432 Test Loss: 1.286 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.1021251678466797
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.415 Vali Acc: 0.405 Test Loss: 1.415 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1056270599365234
Epoch: 5, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.330 Vali Acc: 0.392 Test Loss: 1.330 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0587921142578125
Epoch: 6, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.507 Vali Acc: 0.473 Test Loss: 1.507 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472958).  Saving model ...
Epoch: 7 cost time: 1.0498335361480713
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.711 Vali Acc: 0.365 Test Loss: 1.711 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0585987567901611
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.761 Vali Acc: 0.432 Test Loss: 1.761 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1332533359527588
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.957 Vali Acc: 0.351 Test Loss: 1.957 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0379865169525146
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.874 Vali Acc: 0.378 Test Loss: 1.874 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.00459623336792
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.924 Vali Acc: 0.392 Test Loss: 1.924 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0132606029510498
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.309 Vali Acc: 0.324 Test Loss: 2.309 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1263532638549805
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.961 Vali Acc: 0.419 Test Loss: 1.961 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.042898416519165
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.023 Vali Acc: 0.446 Test Loss: 2.023 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9489374160766602
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.168 Vali Acc: 0.338 Test Loss: 2.168 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1045665740966797
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.378 Test Loss: 1.921 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 1080892
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1187753677368164
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.1472821235656738
Epoch: 2, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.1252658367156982
Epoch: 3, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.345 Vali Acc: 0.446 Test Loss: 1.345 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.256176233291626
Epoch: 4, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.571 Vali Acc: 0.392 Test Loss: 1.571 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2916293144226074
Epoch: 5, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.425 Vali Acc: 0.473 Test Loss: 1.425 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.170088768005371
Epoch: 6, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.480 Vali Acc: 0.541 Test Loss: 1.480 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540526).  Saving model ...
Epoch: 7 cost time: 1.2341094017028809
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.884 Vali Acc: 0.473 Test Loss: 1.884 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.260918378829956
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.760 Vali Acc: 0.486 Test Loss: 1.760 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.292393445968628
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.113 Vali Acc: 0.527 Test Loss: 2.113 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1487743854522705
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.929 Vali Acc: 0.365 Test Loss: 2.929 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2012810707092285
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.303 Vali Acc: 0.486 Test Loss: 2.303 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2075881958007812
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.918 Vali Acc: 0.514 Test Loss: 1.918 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2608754634857178
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.257 Vali Acc: 0.419 Test Loss: 3.257 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.06369948387146
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.452 Vali Acc: 0.514 Test Loss: 2.452 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.162721872329712
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.295 Vali Acc: 0.486 Test Loss: 2.295 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.161816120147705
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.432 Vali Acc: 0.514 Test Loss: 2.432 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 818748
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0176868438720703
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.1023015975952148
Epoch: 2, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.326 Vali Acc: 0.405 Test Loss: 1.326 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0722262859344482
Epoch: 3, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.329 Vali Acc: 0.459 Test Loss: 1.329 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3093113899230957
Epoch: 4, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.528 Vali Acc: 0.365 Test Loss: 1.528 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2069439888000488
Epoch: 5, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472959).  Saving model ...
Epoch: 6 cost time: 1.2585818767547607
Epoch: 6, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.456 Vali Acc: 0.419 Test Loss: 1.456 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0977418422698975
Epoch: 7, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.826 Vali Acc: 0.446 Test Loss: 1.826 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2002112865447998
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.749 Vali Acc: 0.459 Test Loss: 1.749 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1664869785308838
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.730 Vali Acc: 0.500 Test Loss: 1.730 Test Acc: 0.500
Validation loss decreased (-0.472959 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 1.4466829299926758
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.784 Vali Acc: 0.473 Test Loss: 1.784 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3447458744049072
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.012 Vali Acc: 0.473 Test Loss: 2.012 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2802000045776367
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.875 Vali Acc: 0.486 Test Loss: 1.875 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3952701091766357
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.734 Vali Acc: 0.568 Test Loss: 1.734 Test Acc: 0.568
Validation loss decreased (-0.499983 --> -0.567550).  Saving model ...
Epoch: 14 cost time: 1.378157377243042
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.856 Vali Acc: 0.568 Test Loss: 1.856 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3393595218658447
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.893 Vali Acc: 0.541 Test Loss: 1.893 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2944436073303223
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.934 Vali Acc: 0.554 Test Loss: 1.934 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3479127883911133
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.190 Vali Acc: 0.541 Test Loss: 2.190 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4325990676879883
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.425 Vali Acc: 0.432 Test Loss: 2.425 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5130915641784668
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.568 Test Loss: 1.802 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5818519592285156
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.008 Vali Acc: 0.500 Test Loss: 2.008 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.542893409729004
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.376 Vali Acc: 0.473 Test Loss: 2.376 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6108827590942383
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.500 Test Loss: 2.190 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.478851556777954
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.541 Test Loss: 2.132 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 818748
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9857704639434814
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.296 Vali Acc: 0.432 Test Loss: 1.296 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.0995674133300781
Epoch: 2, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.372 Vali Acc: 0.378 Test Loss: 1.372 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2139153480529785
Epoch: 3, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.299 Vali Acc: 0.473 Test Loss: 1.299 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.1614818572998047
Epoch: 4, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.537 Vali Acc: 0.324 Test Loss: 1.537 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.124237060546875
Epoch: 5, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.436 Vali Acc: 0.459 Test Loss: 1.436 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.115577220916748
Epoch: 6, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.527 Vali Acc: 0.405 Test Loss: 1.527 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1926116943359375
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.002 Vali Acc: 0.351 Test Loss: 2.002 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1605744361877441
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.699 Vali Acc: 0.459 Test Loss: 1.699 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2877693176269531
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.798 Vali Acc: 0.419 Test Loss: 1.798 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.129154920578003
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.048 Vali Acc: 0.446 Test Loss: 2.048 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.391692876815796
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.893 Vali Acc: 0.459 Test Loss: 1.893 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.354008436203003
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.095 Vali Acc: 0.392 Test Loss: 2.095 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3680729866027832
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.962 Vali Acc: 0.500 Test Loss: 1.962 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499980).  Saving model ...
Epoch: 14 cost time: 1.137561321258545
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.037 Vali Acc: 0.405 Test Loss: 2.037 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1273705959320068
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.104 Vali Acc: 0.446 Test Loss: 2.104 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3579835891723633
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.459 Test Loss: 2.042 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.137375831604004
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.459 Test Loss: 2.015 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2838444709777832
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.459 Test Loss: 2.023 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1134932041168213
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.459 Test Loss: 2.008 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2191479206085205
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.459 Test Loss: 1.990 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1650757789611816
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.459 Test Loss: 2.004 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2521612644195557
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.459 Test Loss: 2.013 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.350999116897583
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.459 Test Loss: 2.019 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 818748
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7930593490600586
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.303 Vali Acc: 0.405 Test Loss: 1.303 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.9690666198730469
Epoch: 2, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.371 Vali Acc: 0.378 Test Loss: 1.371 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0098505020141602
Epoch: 3, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0511415004730225
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.469 Vali Acc: 0.324 Test Loss: 1.469 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.001044511795044
Epoch: 5, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.368 Vali Acc: 0.432 Test Loss: 1.368 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.0157997608184814
Epoch: 6, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.440 Vali Acc: 0.419 Test Loss: 1.440 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.988030195236206
Epoch: 7, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.813 Vali Acc: 0.392 Test Loss: 1.813 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9961099624633789
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.641 Vali Acc: 0.419 Test Loss: 1.641 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9872961044311523
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.711 Vali Acc: 0.446 Test Loss: 1.711 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445929).  Saving model ...
Epoch: 10 cost time: 1.0964632034301758
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.016 Vali Acc: 0.378 Test Loss: 2.016 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.984609842300415
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.144 Vali Acc: 0.365 Test Loss: 2.144 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0154201984405518
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.818 Vali Acc: 0.432 Test Loss: 1.818 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1263675689697266
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.419 Test Loss: 1.794 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0264692306518555
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.848 Vali Acc: 0.432 Test Loss: 1.848 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0992708206176758
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.446 Test Loss: 1.830 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1208970546722412
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.432 Test Loss: 1.860 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1569383144378662
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.901 Vali Acc: 0.405 Test Loss: 1.901 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9958286285400391
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.432 Test Loss: 1.924 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1511826515197754
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.405 Test Loss: 1.911 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 818748
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0804669857025146
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.387 Vali Acc: 0.324 Test Loss: 1.387 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.1410737037658691
Epoch: 2, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.592 Vali Acc: 0.338 Test Loss: 1.592 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337822).  Saving model ...
Epoch: 3 cost time: 1.107274055480957
Epoch: 3, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
Validation loss decreased (-0.337822 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.1407949924468994
Epoch: 4, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 1.0957496166229248
Epoch: 5, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1530706882476807
Epoch: 6, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.536 Vali Acc: 0.514 Test Loss: 1.536 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1476857662200928
Epoch: 7, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.756 Vali Acc: 0.459 Test Loss: 1.756 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.122868537902832
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.978 Vali Acc: 0.446 Test Loss: 1.978 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2199788093566895
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.853 Vali Acc: 0.459 Test Loss: 1.853 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1374146938323975
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.820 Vali Acc: 0.486 Test Loss: 1.820 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1304712295532227
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.158 Vali Acc: 0.378 Test Loss: 2.158 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0755832195281982
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.145 Vali Acc: 0.486 Test Loss: 2.145 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1805567741394043
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.074 Vali Acc: 0.486 Test Loss: 2.074 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1073033809661865
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.045 Vali Acc: 0.473 Test Loss: 2.045 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 687676
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.099497079849243
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.403 Vali Acc: 0.284 Test Loss: 1.403 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1091694831848145
Epoch: 2, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.547 Vali Acc: 0.365 Test Loss: 1.547 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364849).  Saving model ...
Epoch: 3 cost time: 1.136143684387207
Epoch: 3, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
Validation loss decreased (-0.364849 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.106858730316162
Epoch: 4, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.101201057434082
Epoch: 5, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.279 Vali Acc: 0.514 Test Loss: 1.279 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.2107622623443604
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.473 Vali Acc: 0.459 Test Loss: 1.473 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0624444484710693
Epoch: 7, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.828 Vali Acc: 0.432 Test Loss: 1.828 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2495710849761963
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.059 Vali Acc: 0.419 Test Loss: 2.059 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.224238395690918
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.892 Vali Acc: 0.500 Test Loss: 1.892 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3019261360168457
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.974 Vali Acc: 0.473 Test Loss: 1.974 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0887384414672852
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.027 Vali Acc: 0.486 Test Loss: 2.027 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1872375011444092
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.221 Vali Acc: 0.459 Test Loss: 2.221 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.322143793106079
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.201 Vali Acc: 0.473 Test Loss: 2.201 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1018822193145752
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.813 Vali Acc: 0.446 Test Loss: 3.813 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9292490482330322
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 2.702 Vali Acc: 0.405 Test Loss: 2.702 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 687676
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0827367305755615
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.453 Vali Acc: 0.270 Test Loss: 1.453 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9966719150543213
Epoch: 2, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.578 Vali Acc: 0.365 Test Loss: 1.578 Test Acc: 0.365
Validation loss decreased (-0.270256 --> -0.364849).  Saving model ...
Epoch: 3 cost time: 1.0441370010375977
Epoch: 3, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
Validation loss decreased (-0.364849 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.150663137435913
Epoch: 4, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.315 Vali Acc: 0.473 Test Loss: 1.315 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.0524640083312988
Epoch: 5, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.380 Vali Acc: 0.486 Test Loss: 1.380 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.0513010025024414
Epoch: 6, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.566 Vali Acc: 0.432 Test Loss: 1.566 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9911408424377441
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.847 Vali Acc: 0.378 Test Loss: 1.847 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0510778427124023
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.779 Vali Acc: 0.405 Test Loss: 1.779 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.04848051071167
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.719 Vali Acc: 0.514 Test Loss: 1.719 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513496).  Saving model ...
Epoch: 10 cost time: 1.0510971546173096
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.969 Vali Acc: 0.392 Test Loss: 1.969 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0124335289001465
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.894 Vali Acc: 0.419 Test Loss: 1.894 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.062013864517212
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.295 Vali Acc: 0.419 Test Loss: 2.295 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9676008224487305
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.051 Vali Acc: 0.459 Test Loss: 2.051 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.971916913986206
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.052 Vali Acc: 0.432 Test Loss: 2.052 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.988131046295166
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.229 Vali Acc: 0.473 Test Loss: 2.229 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0711259841918945
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.384 Vali Acc: 0.446 Test Loss: 2.384 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1248302459716797
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.657 Vali Acc: 0.338 Test Loss: 2.657 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0955877304077148
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.405 Vali Acc: 0.365 Test Loss: 2.405 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0949909687042236
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.405 Test Loss: 2.311 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 687676
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9119672775268555
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.425 Vali Acc: 0.284 Test Loss: 1.425 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0378775596618652
Epoch: 2, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.494 Vali Acc: 0.311 Test Loss: 1.494 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 0.9856240749359131
Epoch: 3, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.337 Vali Acc: 0.378 Test Loss: 1.337 Test Acc: 0.378
Validation loss decreased (-0.310796 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.9375209808349609
Epoch: 4, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.385 Vali Acc: 0.378 Test Loss: 1.385 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9428539276123047
Epoch: 5, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.360 Vali Acc: 0.432 Test Loss: 1.360 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 0.9777200222015381
Epoch: 6, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.556 Vali Acc: 0.419 Test Loss: 1.556 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.181844711303711
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.523 Vali Acc: 0.392 Test Loss: 1.523 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.028951644897461
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.774 Vali Acc: 0.432 Test Loss: 1.774 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.104435682296753
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.663 Vali Acc: 0.486 Test Loss: 1.663 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486470).  Saving model ...
Epoch: 10 cost time: 0.9681034088134766
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.835 Vali Acc: 0.432 Test Loss: 1.835 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0466513633728027
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.213 Vali Acc: 0.405 Test Loss: 2.213 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0461459159851074
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.018 Vali Acc: 0.473 Test Loss: 2.018 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1412367820739746
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.045 Vali Acc: 0.486 Test Loss: 2.045 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0243277549743652
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.051 Vali Acc: 0.486 Test Loss: 2.051 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0153825283050537
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.132 Vali Acc: 0.514 Test Loss: 2.132 Test Acc: 0.514
Validation loss decreased (-0.486470 --> -0.513492).  Saving model ...
Epoch: 16 cost time: 1.2086758613586426
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.459 Test Loss: 1.976 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0013043880462646
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.459 Test Loss: 1.967 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1179728507995605
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.011 Vali Acc: 0.459 Test Loss: 2.011 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.080533742904663
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.473 Test Loss: 1.993 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1361229419708252
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.473 Test Loss: 1.970 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1056530475616455
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.459 Test Loss: 1.971 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9721550941467285
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.473 Test Loss: 1.987 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.066080093383789
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.473 Test Loss: 2.016 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0560381412506104
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.473 Test Loss: 2.018 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0222752094268799
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.473 Test Loss: 2.018 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 687676
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3245620727539062
Epoch: 1, Steps: 10 | Train Loss: 1.534 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.1540215015411377
Epoch: 2, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.1347782611846924
Epoch: 3, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1372251510620117
Epoch: 4, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.1693122386932373
Epoch: 5, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.712 Vali Acc: 0.392 Test Loss: 1.712 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1030681133270264
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.651 Vali Acc: 0.419 Test Loss: 1.651 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1653523445129395
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.781 Vali Acc: 0.473 Test Loss: 1.781 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2226958274841309
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.666 Vali Acc: 0.581 Test Loss: 1.666 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581064).  Saving model ...
Epoch: 9 cost time: 1.1053309440612793
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.793 Vali Acc: 0.500 Test Loss: 1.793 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2580678462982178
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.363 Vali Acc: 0.432 Test Loss: 2.363 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1542167663574219
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.430 Vali Acc: 0.473 Test Loss: 2.430 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2065210342407227
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.392 Vali Acc: 0.486 Test Loss: 2.392 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.131667137145996
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.455 Vali Acc: 0.459 Test Loss: 2.455 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.156132459640503
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.220 Vali Acc: 0.554 Test Loss: 2.220 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1370198726654053
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.468 Vali Acc: 0.432 Test Loss: 2.468 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.24086594581604
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.504 Vali Acc: 0.500 Test Loss: 2.504 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2913289070129395
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.655 Vali Acc: 0.527 Test Loss: 2.655 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0092909336090088
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.809 Vali Acc: 0.486 Test Loss: 2.809 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 622140
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.938131332397461
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.282 Vali Acc: 0.419 Test Loss: 1.282 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.1728103160858154
Epoch: 2, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.2696208953857422
Epoch: 3, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.12563157081604
Epoch: 4, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.2039029598236084
Epoch: 5, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.492 Vali Acc: 0.459 Test Loss: 1.492 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.350959062576294
Epoch: 6, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.494 Vali Acc: 0.446 Test Loss: 1.494 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.164656639099121
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.663 Vali Acc: 0.459 Test Loss: 1.663 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2123911380767822
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.700 Vali Acc: 0.527 Test Loss: 1.700 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1148772239685059
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.007 Vali Acc: 0.459 Test Loss: 2.007 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1299362182617188
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.959 Vali Acc: 0.473 Test Loss: 1.959 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1344802379608154
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.138 Vali Acc: 0.473 Test Loss: 2.138 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2417340278625488
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.454 Vali Acc: 0.500 Test Loss: 2.454 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.116204023361206
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.672 Vali Acc: 0.432 Test Loss: 2.672 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1691300868988037
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.962 Vali Acc: 0.500 Test Loss: 1.962 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 622140
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.962326765060425
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.1469759941101074
Epoch: 2, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.281 Vali Acc: 0.473 Test Loss: 1.281 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.0518336296081543
Epoch: 3, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.228 Vali Acc: 0.446 Test Loss: 1.228 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2136666774749756
Epoch: 4, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1002345085144043
Epoch: 5, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.380 Vali Acc: 0.473 Test Loss: 1.380 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0921001434326172
Epoch: 6, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.524 Vali Acc: 0.459 Test Loss: 1.524 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0851280689239502
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.511 Vali Acc: 0.459 Test Loss: 1.511 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0524399280548096
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.631 Vali Acc: 0.486 Test Loss: 1.631 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0825481414794922
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.778 Vali Acc: 0.446 Test Loss: 1.778 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.165726900100708
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.750 Vali Acc: 0.486 Test Loss: 1.750 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0369207859039307
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.676 Vali Acc: 0.459 Test Loss: 1.676 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2094926834106445
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.741 Vali Acc: 0.446 Test Loss: 1.741 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1456472873687744
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.432 Test Loss: 1.814 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1831254959106445
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.432 Test Loss: 1.825 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 622140
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0350043773651123
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.352 Vali Acc: 0.419 Test Loss: 1.352 Test Acc: 0.419
Validation loss decreased (inf --> -0.418905).  Saving model ...
Epoch: 2 cost time: 1.0648202896118164
Epoch: 2, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.352 Vali Acc: 0.486 Test Loss: 1.352 Test Acc: 0.486
Validation loss decreased (-0.418905 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.0875930786132812
Epoch: 3, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
Validation loss decreased (-0.486473 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.1087455749511719
Epoch: 4, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.346 Vali Acc: 0.486 Test Loss: 1.346 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.015016794204712
Epoch: 5, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.461 Vali Acc: 0.432 Test Loss: 1.461 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.211768627166748
Epoch: 6, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.458 Vali Acc: 0.446 Test Loss: 1.458 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2858595848083496
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.454 Vali Acc: 0.486 Test Loss: 1.454 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2444736957550049
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.590 Vali Acc: 0.419 Test Loss: 1.590 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2123751640319824
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.654 Vali Acc: 0.459 Test Loss: 1.654 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.333695411682129
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.729 Vali Acc: 0.432 Test Loss: 1.729 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.13486647605896
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.996 Vali Acc: 0.419 Test Loss: 1.996 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0754022598266602
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.869 Vali Acc: 0.392 Test Loss: 1.869 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1181159019470215
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.877 Vali Acc: 0.419 Test Loss: 1.877 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 622140
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3148977756500244
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 1.3236310482025146
Epoch: 2, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 1.1377029418945312
Epoch: 3, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.312 Vali Acc: 0.473 Test Loss: 1.312 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2000091075897217
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.371 Vali Acc: 0.486 Test Loss: 1.371 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.118027925491333
Epoch: 5, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1719560623168945
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.649 Vali Acc: 0.541 Test Loss: 1.649 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540524).  Saving model ...
Epoch: 7 cost time: 1.207719087600708
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.470 Vali Acc: 0.514 Test Loss: 1.470 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3453114032745361
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.819 Vali Acc: 0.500 Test Loss: 1.819 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3817853927612305
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.958 Vali Acc: 0.541 Test Loss: 1.958 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1689722537994385
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.645 Vali Acc: 0.446 Test Loss: 2.645 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0338618755340576
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.032 Vali Acc: 0.459 Test Loss: 2.032 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0759201049804688
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.258 Vali Acc: 0.459 Test Loss: 2.258 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2339832782745361
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.473 Test Loss: 1.881 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1890318393707275
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.132 Vali Acc: 0.486 Test Loss: 2.132 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.204939365386963
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.061 Vali Acc: 0.500 Test Loss: 2.061 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.267038345336914
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.500 Test Loss: 1.895 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 589372
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.070934295654297
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.1126973628997803
Epoch: 2, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.1705703735351562
Epoch: 3, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.367 Vali Acc: 0.459 Test Loss: 1.367 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0401067733764648
Epoch: 4, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.429 Vali Acc: 0.486 Test Loss: 1.429 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1939518451690674
Epoch: 5, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.368 Vali Acc: 0.459 Test Loss: 1.368 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1054670810699463
Epoch: 6, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.548 Vali Acc: 0.459 Test Loss: 1.548 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.127500057220459
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 1.1055576801300049
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.920 Vali Acc: 0.486 Test Loss: 1.920 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1125037670135498
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.178 Vali Acc: 0.419 Test Loss: 2.178 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.211794137954712
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.950 Vali Acc: 0.500 Test Loss: 1.950 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1071062088012695
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.010 Vali Acc: 0.459 Test Loss: 2.010 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0674660205841064
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.195 Vali Acc: 0.446 Test Loss: 2.195 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1742377281188965
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.190 Vali Acc: 0.473 Test Loss: 2.190 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0397868156433105
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.110 Vali Acc: 0.432 Test Loss: 2.110 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1449167728424072
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.061 Vali Acc: 0.500 Test Loss: 2.061 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0996017456054688
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.514 Test Loss: 1.861 Test Acc: 0.514
Validation loss decreased (-0.499985 --> -0.513495).  Saving model ...
Epoch: 17 cost time: 0.968440055847168
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.514 Test Loss: 1.945 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3349051475524902
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.486 Test Loss: 2.002 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1351077556610107
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.486 Test Loss: 1.980 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1936774253845215
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.486 Test Loss: 1.958 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.152899980545044
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.500 Test Loss: 1.934 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1381990909576416
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.500 Test Loss: 1.929 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1429927349090576
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.514 Test Loss: 1.931 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9318051338195801
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.500 Test Loss: 1.918 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2360782623291016
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.500 Test Loss: 1.912 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2020893096923828
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.514 Test Loss: 1.921 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 589372
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2677001953125
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.263 Vali Acc: 0.473 Test Loss: 1.263 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 1.0773191452026367
Epoch: 2, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0222034454345703
Epoch: 3, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.378 Vali Acc: 0.405 Test Loss: 1.378 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.004697561264038
Epoch: 4, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.425 Vali Acc: 0.419 Test Loss: 1.425 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2000772953033447
Epoch: 5, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.388 Vali Acc: 0.432 Test Loss: 1.388 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.089599609375
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.426 Vali Acc: 0.405 Test Loss: 1.426 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9142026901245117
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.500 Vali Acc: 0.514 Test Loss: 1.500 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 1.1051695346832275
Epoch: 8, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.890 Vali Acc: 0.432 Test Loss: 1.890 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.006350040435791
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.315 Vali Acc: 0.392 Test Loss: 2.315 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0562260150909424
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.844 Vali Acc: 0.486 Test Loss: 1.844 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0603032112121582
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.058 Vali Acc: 0.446 Test Loss: 2.058 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.052701473236084
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.946 Vali Acc: 0.500 Test Loss: 1.946 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0627110004425049
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.997 Vali Acc: 0.473 Test Loss: 1.997 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1200742721557617
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.037 Vali Acc: 0.446 Test Loss: 2.037 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.081794261932373
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.901 Vali Acc: 0.446 Test Loss: 1.901 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0499353408813477
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.459 Test Loss: 1.869 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0772614479064941
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.432 Test Loss: 1.893 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 589372
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.094270706176758
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.267 Vali Acc: 0.473 Test Loss: 1.267 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 1.0661685466766357
Epoch: 2, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0472357273101807
Epoch: 3, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.347 Vali Acc: 0.365 Test Loss: 1.347 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0537023544311523
Epoch: 4, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.459 Vali Acc: 0.365 Test Loss: 1.459 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9763398170471191
Epoch: 5, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.355 Vali Acc: 0.351 Test Loss: 1.355 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0281245708465576
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.463 Vali Acc: 0.459 Test Loss: 1.463 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9873428344726562
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.583 Vali Acc: 0.378 Test Loss: 1.583 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1026725769042969
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.704 Vali Acc: 0.459 Test Loss: 1.704 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0512311458587646
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.663 Vali Acc: 0.419 Test Loss: 1.663 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1273744106292725
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.953 Vali Acc: 0.405 Test Loss: 1.953 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0607922077178955
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.889 Vali Acc: 0.486 Test Loss: 1.889 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486468).  Saving model ...
Epoch: 12 cost time: 1.0215940475463867
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.795 Vali Acc: 0.419 Test Loss: 1.795 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1078882217407227
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.853 Vali Acc: 0.432 Test Loss: 1.853 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.02683687210083
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.419 Test Loss: 1.752 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.015413761138916
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.788 Vali Acc: 0.419 Test Loss: 1.788 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.053072214126587
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.419 Test Loss: 1.833 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1038377285003662
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.419 Test Loss: 1.814 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1326627731323242
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.419 Test Loss: 1.833 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1228249073028564
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.405 Test Loss: 1.855 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0210435390472412
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.405 Test Loss: 1.865 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9377634525299072
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.405 Test Loss: 1.871 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 589372
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2043063640594482
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.295 Vali Acc: 0.432 Test Loss: 1.295 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.0033526420593262
Epoch: 2, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.080268144607544
Epoch: 3, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567557).  Saving model ...
Epoch: 4 cost time: 1.0401368141174316
Epoch: 4, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0899858474731445
Epoch: 5, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.351 Vali Acc: 0.459 Test Loss: 1.351 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1461570262908936
Epoch: 6, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1047658920288086
Epoch: 7, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9658045768737793
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.268 Vali Acc: 0.486 Test Loss: 1.268 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.158240795135498
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.461 Vali Acc: 0.486 Test Loss: 1.461 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0409979820251465
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.515 Vali Acc: 0.473 Test Loss: 1.515 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.118239402770996
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0576128959655762
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.447 Vali Acc: 0.486 Test Loss: 1.447 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.113818883895874
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.440 Vali Acc: 0.486 Test Loss: 1.440 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 769852
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8069822788238525
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.305 Vali Acc: 0.338 Test Loss: 1.305 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 0.97998046875
Epoch: 2, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 0.7812130451202393
Epoch: 3, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 0.9925949573516846
Epoch: 4, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1127817630767822
Epoch: 5, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.337 Vali Acc: 0.432 Test Loss: 1.337 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9609909057617188
Epoch: 6, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.250 Vali Acc: 0.527 Test Loss: 1.250 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0998563766479492
Epoch: 7, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1061339378356934
Epoch: 8, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2297372817993164
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.510 Vali Acc: 0.432 Test Loss: 1.510 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9604570865631104
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.492 Vali Acc: 0.459 Test Loss: 1.492 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0560107231140137
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.533 Vali Acc: 0.473 Test Loss: 1.533 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1766901016235352
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.561 Vali Acc: 0.486 Test Loss: 1.561 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0874431133270264
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.482 Vali Acc: 0.459 Test Loss: 1.482 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 769852
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.063184976577759
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.324 Vali Acc: 0.392 Test Loss: 1.324 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.0676651000976562
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.299 Vali Acc: 0.351 Test Loss: 1.299 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.989417552947998
Epoch: 3, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.172 Vali Acc: 0.446 Test Loss: 1.172 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.9491033554077148
Epoch: 4, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1174561977386475
Epoch: 5, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.413 Vali Acc: 0.365 Test Loss: 1.413 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1382067203521729
Epoch: 6, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.374 Vali Acc: 0.432 Test Loss: 1.374 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2547833919525146
Epoch: 7, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.352 Vali Acc: 0.432 Test Loss: 1.352 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1050677299499512
Epoch: 8, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.488 Vali Acc: 0.392 Test Loss: 1.488 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.245774745941162
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.701 Vali Acc: 0.378 Test Loss: 1.701 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9905538558959961
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.677 Vali Acc: 0.378 Test Loss: 1.677 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0671894550323486
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.841 Vali Acc: 0.338 Test Loss: 1.841 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0667250156402588
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.747 Vali Acc: 0.419 Test Loss: 1.747 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.042802333831787
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.853 Vali Acc: 0.392 Test Loss: 1.853 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 769852
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9997518062591553
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.0075328350067139
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.310 Vali Acc: 0.365 Test Loss: 1.310 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9744710922241211
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9543337821960449
Epoch: 4, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.279 Vali Acc: 0.419 Test Loss: 1.279 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9735045433044434
Epoch: 5, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.246 Vali Acc: 0.419 Test Loss: 1.246 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.199446201324463
Epoch: 6, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.9252746105194092
Epoch: 7, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.254 Vali Acc: 0.432 Test Loss: 1.254 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.921520471572876
Epoch: 8, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.082655429840088
Epoch: 9, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.411 Vali Acc: 0.432 Test Loss: 1.411 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9875466823577881
Epoch: 10, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.347 Vali Acc: 0.392 Test Loss: 1.347 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9906253814697266
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.623 Vali Acc: 0.378 Test Loss: 1.623 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0990533828735352
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.384 Vali Acc: 0.459 Test Loss: 1.384 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.060148000717163
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.729 Vali Acc: 0.378 Test Loss: 1.729 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0074236392974854
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.639 Vali Acc: 0.419 Test Loss: 1.639 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0948925018310547
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.678 Vali Acc: 0.378 Test Loss: 1.678 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.144735336303711
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.652 Vali Acc: 0.365 Test Loss: 1.652 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 769852
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.849370241165161
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0196690559387207
Epoch: 2, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.252 Vali Acc: 0.405 Test Loss: 1.252 Test Acc: 0.405
Validation loss decreased (-0.270256 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.0114457607269287
Epoch: 3, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.180938720703125
Epoch: 4, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.233 Vali Acc: 0.446 Test Loss: 1.233 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0043904781341553
Epoch: 5, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.180361032485962
Epoch: 6, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 1.1074669361114502
Epoch: 7, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.188 Vali Acc: 0.446 Test Loss: 1.188 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.095278024673462
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.317 Vali Acc: 0.486 Test Loss: 1.317 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1792354583740234
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.667 Vali Acc: 0.432 Test Loss: 1.667 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1332435607910156
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.479 Vali Acc: 0.459 Test Loss: 1.479 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2346882820129395
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499985).  Saving model ...
Epoch: 12 cost time: 1.0799336433410645
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3031573295593262
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.585 Vali Acc: 0.486 Test Loss: 1.585 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9368987083435059
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.547 Vali Acc: 0.459 Test Loss: 1.547 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0605058670043945
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.601 Vali Acc: 0.486 Test Loss: 1.601 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8786108493804932
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.500 Test Loss: 1.567 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0608372688293457
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.573 Vali Acc: 0.514 Test Loss: 1.573 Test Acc: 0.514
Validation loss decreased (-0.499985 --> -0.513498).  Saving model ...
Epoch: 18 cost time: 0.8804430961608887
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0728769302368164
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.459 Test Loss: 1.617 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9419980049133301
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.514 Test Loss: 1.604 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.071892261505127
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.500 Test Loss: 1.621 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9832735061645508
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.459 Test Loss: 1.632 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.175736904144287
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.500 Test Loss: 1.639 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9249629974365234
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.486 Test Loss: 1.668 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0372800827026367
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0001850128173828
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.500 Test Loss: 1.665 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8940565586090088
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.459 Test Loss: 1.699 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 507708
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0038154125213623
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.417 Vali Acc: 0.216 Test Loss: 1.417 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.0647590160369873
Epoch: 2, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.269 Vali Acc: 0.392 Test Loss: 1.269 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.0540392398834229
Epoch: 3, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.258 Vali Acc: 0.486 Test Loss: 1.258 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.988743782043457
Epoch: 4, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9695472717285156
Epoch: 5, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0372369289398193
Epoch: 6, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9879539012908936
Epoch: 7, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.0903925895690918
Epoch: 8, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.388 Vali Acc: 0.405 Test Loss: 1.388 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0766043663024902
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.717 Vali Acc: 0.405 Test Loss: 1.717 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0991637706756592
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.645 Vali Acc: 0.419 Test Loss: 1.645 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9320321083068848
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.510 Vali Acc: 0.432 Test Loss: 1.510 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0918004512786865
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.724 Vali Acc: 0.432 Test Loss: 1.724 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0765142440795898
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.658 Vali Acc: 0.378 Test Loss: 1.658 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.108302354812622
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.614 Vali Acc: 0.432 Test Loss: 1.614 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1099088191986084
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.432 Test Loss: 1.682 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0604760646820068
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.651 Vali Acc: 0.459 Test Loss: 1.651 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9015340805053711
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.658 Vali Acc: 0.405 Test Loss: 1.658 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 507708
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1164844036102295
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.257 Test Loss: 1.394 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0439016819000244
Epoch: 2, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.276 Vali Acc: 0.351 Test Loss: 1.276 Test Acc: 0.351
Validation loss decreased (-0.256743 --> -0.351339).  Saving model ...
Epoch: 3 cost time: 1.187434196472168
Epoch: 3, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
Validation loss decreased (-0.351339 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.1992709636688232
Epoch: 4, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0096993446350098
Epoch: 5, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1471943855285645
Epoch: 6, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.282 Vali Acc: 0.459 Test Loss: 1.282 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0589160919189453
Epoch: 7, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1624197959899902
Epoch: 8, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.498 Vali Acc: 0.378 Test Loss: 1.498 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.028898000717163
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.865 Vali Acc: 0.351 Test Loss: 1.865 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1368401050567627
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.630 Vali Acc: 0.392 Test Loss: 1.630 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1153581142425537
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.692 Vali Acc: 0.419 Test Loss: 1.692 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.165494680404663
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.843 Vali Acc: 0.419 Test Loss: 1.843 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0466811656951904
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.740 Vali Acc: 0.405 Test Loss: 1.740 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 507708
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0605993270874023
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.385 Vali Acc: 0.230 Test Loss: 1.385 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9690883159637451
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.313 Vali Acc: 0.338 Test Loss: 1.313 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.922116756439209
Epoch: 3, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9385037422180176
Epoch: 4, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9900352954864502
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8668203353881836
Epoch: 6, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.216 Vali Acc: 0.419 Test Loss: 1.216 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0454552173614502
Epoch: 7, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8785688877105713
Epoch: 8, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.319 Vali Acc: 0.378 Test Loss: 1.319 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9379932880401611
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.480 Vali Acc: 0.378 Test Loss: 1.480 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9704127311706543
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.481 Vali Acc: 0.392 Test Loss: 1.481 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9710426330566406
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.363 Vali Acc: 0.446 Test Loss: 1.363 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9196863174438477
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.515 Vali Acc: 0.446 Test Loss: 1.515 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8901934623718262
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.485 Vali Acc: 0.432 Test Loss: 1.485 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0047030448913574
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.529 Vali Acc: 0.419 Test Loss: 1.529 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 507708
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9820361137390137
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.321 Vali Acc: 0.324 Test Loss: 1.321 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.067988395690918
Epoch: 2, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.241 Vali Acc: 0.405 Test Loss: 1.241 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.1073520183563232
Epoch: 3, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.180 Vali Acc: 0.446 Test Loss: 1.180 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.0878710746765137
Epoch: 4, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.160444736480713
Epoch: 5, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3875854015350342
Epoch: 6, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.396 Vali Acc: 0.446 Test Loss: 1.396 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.185452938079834
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.574 Vali Acc: 0.432 Test Loss: 1.574 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0698096752166748
Epoch: 8, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.299 Vali Acc: 0.527 Test Loss: 1.299 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 1.235471248626709
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.315 Vali Acc: 0.541 Test Loss: 1.315 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540527).  Saving model ...
Epoch: 10 cost time: 1.0899910926818848
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.625 Vali Acc: 0.446 Test Loss: 1.625 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0082955360412598
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.461 Vali Acc: 0.500 Test Loss: 1.461 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0188536643981934
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.581 Vali Acc: 0.446 Test Loss: 1.581 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0722737312316895
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.497 Vali Acc: 0.473 Test Loss: 1.497 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1946065425872803
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.555 Vali Acc: 0.473 Test Loss: 1.555 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0535502433776855
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.663 Vali Acc: 0.486 Test Loss: 1.663 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1637654304504395
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.597 Vali Acc: 0.486 Test Loss: 1.597 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1263015270233154
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.486 Test Loss: 1.623 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0925440788269043
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.486 Test Loss: 1.672 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.073331356048584
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 376636
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8651540279388428
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.345 Vali Acc: 0.378 Test Loss: 1.345 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.9099271297454834
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 0.9556610584259033
Epoch: 3, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8398027420043945
Epoch: 4, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.212 Vali Acc: 0.459 Test Loss: 1.212 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9512689113616943
Epoch: 5, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.293 Vali Acc: 0.419 Test Loss: 1.293 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9633193016052246
Epoch: 6, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 0.957866907119751
Epoch: 7, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.544 Vali Acc: 0.446 Test Loss: 1.544 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8539555072784424
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.326 Vali Acc: 0.446 Test Loss: 1.326 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1318039894104004
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499986).  Saving model ...
Epoch: 10 cost time: 0.9894857406616211
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.679 Vali Acc: 0.459 Test Loss: 1.679 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9727725982666016
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.470 Vali Acc: 0.432 Test Loss: 1.470 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0770201683044434
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.666 Vali Acc: 0.378 Test Loss: 1.666 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.024724006652832
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.609 Vali Acc: 0.365 Test Loss: 1.609 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0189483165740967
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.419 Test Loss: 1.651 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0817904472351074
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.719 Vali Acc: 0.405 Test Loss: 1.719 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.091693639755249
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.432 Test Loss: 1.689 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9523172378540039
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.459 Test Loss: 1.684 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9315314292907715
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.473 Test Loss: 1.700 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9876976013183594
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.473 Test Loss: 1.699 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 376636
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.778280019760132
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.357 Vali Acc: 0.365 Test Loss: 1.357 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.0322351455688477
Epoch: 2, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.326 Vali Acc: 0.365 Test Loss: 1.326 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.082817792892456
Epoch: 3, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.2110204696655273
Epoch: 4, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.281 Vali Acc: 0.486 Test Loss: 1.281 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.0098729133605957
Epoch: 5, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.429 Vali Acc: 0.351 Test Loss: 1.429 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1020503044128418
Epoch: 6, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.389 Vali Acc: 0.405 Test Loss: 1.389 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0852932929992676
Epoch: 7, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.575 Vali Acc: 0.405 Test Loss: 1.575 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0943312644958496
Epoch: 8, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.548 Vali Acc: 0.392 Test Loss: 1.548 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0538334846496582
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.535 Vali Acc: 0.392 Test Loss: 1.535 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1021323204040527
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.946 Vali Acc: 0.351 Test Loss: 1.946 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.072810411453247
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.768 Vali Acc: 0.365 Test Loss: 1.768 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0554428100585938
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.838 Vali Acc: 0.297 Test Loss: 1.838 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9733242988586426
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.892 Vali Acc: 0.338 Test Loss: 1.892 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0653231143951416
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.872 Vali Acc: 0.392 Test Loss: 1.872 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 376636
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1266729831695557
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0330853462219238
Epoch: 2, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.309 Vali Acc: 0.405 Test Loss: 1.309 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.0523836612701416
Epoch: 3, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.231 Vali Acc: 0.419 Test Loss: 1.231 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.1682178974151611
Epoch: 4, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.1871635913848877
Epoch: 5, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.349 Vali Acc: 0.324 Test Loss: 1.349 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.021735668182373
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.086010217666626
Epoch: 7, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.336 Vali Acc: 0.405 Test Loss: 1.336 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.412726879119873
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.327 Vali Acc: 0.405 Test Loss: 1.327 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0183238983154297
Epoch: 9, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.368 Vali Acc: 0.392 Test Loss: 1.368 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.042978286743164
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.670 Vali Acc: 0.405 Test Loss: 1.670 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9800872802734375
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.408 Vali Acc: 0.419 Test Loss: 1.408 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9923851490020752
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.446 Vali Acc: 0.432 Test Loss: 1.446 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0670404434204102
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.591 Vali Acc: 0.378 Test Loss: 1.591 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9923274517059326
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.571 Vali Acc: 0.378 Test Loss: 1.571 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9845912456512451
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.679 Vali Acc: 0.351 Test Loss: 1.679 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9904303550720215
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.654 Vali Acc: 0.365 Test Loss: 1.654 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 376636
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8675944805145264
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
Validation loss decreased (inf --> -0.459447).  Saving model ...
Epoch: 2 cost time: 0.9842486381530762
Epoch: 2, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.09617280960083
Epoch: 3, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.202 Vali Acc: 0.392 Test Loss: 1.202 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9317395687103271
Epoch: 4, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0033321380615234
Epoch: 5, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.137712001800537
Epoch: 6, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.359 Vali Acc: 0.392 Test Loss: 1.359 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.085644006729126
Epoch: 7, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.324 Vali Acc: 0.473 Test Loss: 1.324 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0082755088806152
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0712697505950928
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.387 Vali Acc: 0.473 Test Loss: 1.387 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0945663452148438
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.470 Vali Acc: 0.432 Test Loss: 1.470 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0472290515899658
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1756653785705566
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.511 Vali Acc: 0.446 Test Loss: 1.511 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 311100
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.91243314743042
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.281 Vali Acc: 0.405 Test Loss: 1.281 Test Acc: 0.405
Validation loss decreased (inf --> -0.405393).  Saving model ...
Epoch: 2 cost time: 1.1097590923309326
Epoch: 2, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.405393 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 1.035675287246704
Epoch: 3, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.201 Vali Acc: 0.378 Test Loss: 1.201 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9848322868347168
Epoch: 4, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.8931028842926025
Epoch: 5, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0513031482696533
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.369 Vali Acc: 0.405 Test Loss: 1.369 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.038400650024414
Epoch: 7, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.306 Vali Acc: 0.527 Test Loss: 1.306 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9250833988189697
Epoch: 8, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.328 Vali Acc: 0.459 Test Loss: 1.328 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1137008666992188
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.345 Vali Acc: 0.473 Test Loss: 1.345 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9306461811065674
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.495 Vali Acc: 0.459 Test Loss: 1.495 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0040795803070068
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.459 Vali Acc: 0.446 Test Loss: 1.459 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0752508640289307
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.658 Vali Acc: 0.446 Test Loss: 1.658 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0251209735870361
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.600 Vali Acc: 0.459 Test Loss: 1.600 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1146044731140137
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.599 Vali Acc: 0.446 Test Loss: 1.599 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 311100
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.071192979812622
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 1.0480360984802246
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.0155272483825684
Epoch: 3, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0611467361450195
Epoch: 4, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.0449423789978027
Epoch: 5, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.273 Vali Acc: 0.541 Test Loss: 1.273 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 1.0159497261047363
Epoch: 6, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.458 Vali Acc: 0.365 Test Loss: 1.458 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1359896659851074
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.442 Vali Acc: 0.432 Test Loss: 1.442 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9798388481140137
Epoch: 8, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.408 Vali Acc: 0.473 Test Loss: 1.408 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0467710494995117
Epoch: 9, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.551 Vali Acc: 0.419 Test Loss: 1.551 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0982451438903809
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.693 Vali Acc: 0.405 Test Loss: 1.693 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1057798862457275
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.871 Vali Acc: 0.338 Test Loss: 1.871 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1000308990478516
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.776 Vali Acc: 0.365 Test Loss: 1.776 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0170924663543701
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.926 Vali Acc: 0.378 Test Loss: 1.926 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0391438007354736
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.866 Vali Acc: 0.351 Test Loss: 1.866 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1758034229278564
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.918 Vali Acc: 0.351 Test Loss: 1.918 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 311100
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0320022106170654
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.317 Vali Acc: 0.419 Test Loss: 1.317 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.040971279144287
Epoch: 2, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.0765047073364258
Epoch: 3, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.239 Vali Acc: 0.392 Test Loss: 1.239 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1694433689117432
Epoch: 4, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0344924926757812
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.265 Vali Acc: 0.365 Test Loss: 1.265 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0105071067810059
Epoch: 6, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.252 Vali Acc: 0.405 Test Loss: 1.252 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0646145343780518
Epoch: 7, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.347 Vali Acc: 0.432 Test Loss: 1.347 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1062419414520264
Epoch: 8, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 0.8899307250976562
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.342 Vali Acc: 0.446 Test Loss: 1.342 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.15126633644104
Epoch: 10, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.423 Vali Acc: 0.419 Test Loss: 1.423 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9629852771759033
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.445 Vali Acc: 0.405 Test Loss: 1.445 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9876208305358887
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.431 Vali Acc: 0.446 Test Loss: 1.431 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9190046787261963
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.722 Vali Acc: 0.378 Test Loss: 1.722 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9842851161956787
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.596 Vali Acc: 0.419 Test Loss: 1.596 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9060251712799072
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.739 Vali Acc: 0.405 Test Loss: 1.739 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9369683265686035
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.742 Vali Acc: 0.405 Test Loss: 1.742 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8507964611053467
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.649 Vali Acc: 0.446 Test Loss: 1.649 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7995164394378662
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.659 Vali Acc: 0.432 Test Loss: 1.659 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 311100
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0334718227386475
Epoch: 1, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.331 Vali Acc: 0.324 Test Loss: 1.331 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.0773308277130127
Epoch: 2, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.055952548980713
Epoch: 3, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.073648452758789
Epoch: 4, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.190 Vali Acc: 0.514 Test Loss: 1.190 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.060753583908081
Epoch: 5, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.123115062713623
Epoch: 6, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.437 Vali Acc: 0.446 Test Loss: 1.437 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0836548805236816
Epoch: 7, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2371644973754883
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.033848762512207
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.342 Vali Acc: 0.432 Test Loss: 1.342 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2397127151489258
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.508 Vali Acc: 0.473 Test Loss: 1.508 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1037733554840088
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.599 Vali Acc: 0.514 Test Loss: 1.599 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1529912948608398
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.545 Vali Acc: 0.486 Test Loss: 1.545 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.075294017791748
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.567 Vali Acc: 0.514 Test Loss: 1.567 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2218503952026367
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.705 Vali Acc: 0.459 Test Loss: 1.705 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 278332
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9423434734344482
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.333 Vali Acc: 0.311 Test Loss: 1.333 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9974732398986816
Epoch: 2, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
Validation loss decreased (-0.310797 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 0.9113919734954834
Epoch: 3, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.220 Vali Acc: 0.459 Test Loss: 1.220 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0389025211334229
Epoch: 4, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0030786991119385
Epoch: 5, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.321 Vali Acc: 0.392 Test Loss: 1.321 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.004159688949585
Epoch: 6, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.450 Vali Acc: 0.446 Test Loss: 1.450 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9100744724273682
Epoch: 7, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0141029357910156
Epoch: 8, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.350 Vali Acc: 0.432 Test Loss: 1.350 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9523789882659912
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.440 Vali Acc: 0.405 Test Loss: 1.440 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8508005142211914
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.573 Vali Acc: 0.514 Test Loss: 1.573 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0543603897094727
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.777 Vali Acc: 0.432 Test Loss: 1.777 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0914270877838135
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.532 Vali Acc: 0.473 Test Loss: 1.532 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 278332
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.493562936782837
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.363 Vali Acc: 0.351 Test Loss: 1.363 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.1047372817993164
Epoch: 2, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 0.9710836410522461
Epoch: 3, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1466503143310547
Epoch: 4, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.283 Vali Acc: 0.432 Test Loss: 1.283 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9368407726287842
Epoch: 5, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.418 Vali Acc: 0.351 Test Loss: 1.418 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0658631324768066
Epoch: 6, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.533 Vali Acc: 0.392 Test Loss: 1.533 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9385895729064941
Epoch: 7, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.0685820579528809
Epoch: 8, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.445 Vali Acc: 0.446 Test Loss: 1.445 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.936668872833252
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.660 Vali Acc: 0.338 Test Loss: 1.660 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9794824123382568
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.834 Vali Acc: 0.351 Test Loss: 1.834 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0906651020050049
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.831 Vali Acc: 0.405 Test Loss: 1.831 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0327861309051514
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.668 Vali Acc: 0.378 Test Loss: 1.668 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0987117290496826
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.955 Vali Acc: 0.392 Test Loss: 1.955 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0473103523254395
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.824 Vali Acc: 0.419 Test Loss: 1.824 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9710350036621094
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.856 Vali Acc: 0.378 Test Loss: 1.856 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.029402256011963
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.816 Vali Acc: 0.419 Test Loss: 1.816 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0158843994140625
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.885 Vali Acc: 0.392 Test Loss: 1.885 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 278332
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9679391384124756
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.358 Vali Acc: 0.284 Test Loss: 1.358 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9419825077056885
Epoch: 2, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.263 Vali Acc: 0.473 Test Loss: 1.263 Test Acc: 0.473
Validation loss decreased (-0.283770 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.9951262474060059
Epoch: 3, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.230 Vali Acc: 0.419 Test Loss: 1.230 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9381353855133057
Epoch: 4, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.235 Vali Acc: 0.405 Test Loss: 1.235 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9876759052276611
Epoch: 5, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.257 Vali Acc: 0.405 Test Loss: 1.257 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9423413276672363
Epoch: 6, Steps: 10 | Train Loss: 0.545 Vali Loss: 1.312 Vali Acc: 0.405 Test Loss: 1.312 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9291567802429199
Epoch: 7, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.9557662010192871
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9207358360290527
Epoch: 9, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.364 Vali Acc: 0.405 Test Loss: 1.364 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9270079135894775
Epoch: 10, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.414 Vali Acc: 0.392 Test Loss: 1.414 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0665507316589355
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.426 Vali Acc: 0.392 Test Loss: 1.426 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0818045139312744
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.445 Vali Acc: 0.446 Test Loss: 1.445 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0906779766082764
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9296650886535645
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.470 Vali Acc: 0.432 Test Loss: 1.470 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8862626552581787
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.529 Vali Acc: 0.419 Test Loss: 1.529 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9892673492431641
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.491 Vali Acc: 0.446 Test Loss: 1.491 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9035451412200928
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.576 Vali Acc: 0.432 Test Loss: 1.576 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 278332
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.123420000076294
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.0268709659576416
Epoch: 2, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.312 Vali Acc: 0.419 Test Loss: 1.312 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.297050952911377
Epoch: 3, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.176 Vali Acc: 0.473 Test Loss: 1.176 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.0749330520629883
Epoch: 4, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.112 Vali Acc: 0.432 Test Loss: 1.112 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1051642894744873
Epoch: 5, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.302 Vali Acc: 0.446 Test Loss: 1.302 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.193385362625122
Epoch: 6, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.456 Vali Acc: 0.459 Test Loss: 1.456 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.182049036026001
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.0873785018920898
Epoch: 8, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.284 Vali Acc: 0.486 Test Loss: 1.284 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1288175582885742
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.403 Vali Acc: 0.459 Test Loss: 1.403 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.015113115310669
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.530 Vali Acc: 0.432 Test Loss: 1.530 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2123186588287354
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.391 Vali Acc: 0.527 Test Loss: 1.391 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527013).  Saving model ...
Epoch: 12 cost time: 1.0573391914367676
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.506 Vali Acc: 0.473 Test Loss: 1.506 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0823948383331299
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9725947380065918
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.457 Vali Acc: 0.500 Test Loss: 1.457 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0040805339813232
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.492 Vali Acc: 0.459 Test Loss: 1.492 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0008964538574219
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8958895206451416
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.514 Test Loss: 1.506 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.084850788116455
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9312381744384766
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.541 Test Loss: 1.541 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540525).  Saving model ...
Epoch: 20 cost time: 0.949061393737793
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.486 Test Loss: 1.585 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0098378658294678
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0028142929077148
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.541 Test Loss: 1.563 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0868608951568604
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.514 Test Loss: 1.598 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.165020227432251
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.459 Test Loss: 1.632 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2074511051177979
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.527 Test Loss: 1.616 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0450751781463623
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.527 Test Loss: 1.603 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.130737066268921
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.527 Test Loss: 1.633 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0331544876098633
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.500 Test Loss: 1.651 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.183539628982544
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.486 Test Loss: 1.662 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 261948
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2618649005889893
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.304 Vali Acc: 0.365 Test Loss: 1.304 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.1375439167022705
Epoch: 2, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.333 Vali Acc: 0.405 Test Loss: 1.333 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.013120174407959
Epoch: 3, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.9622883796691895
Epoch: 4, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.127 Vali Acc: 0.486 Test Loss: 1.127 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0935699939727783
Epoch: 5, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.377 Vali Acc: 0.446 Test Loss: 1.377 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9956135749816895
Epoch: 6, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.394 Vali Acc: 0.432 Test Loss: 1.394 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0912370681762695
Epoch: 7, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.348 Vali Acc: 0.500 Test Loss: 1.348 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0255494117736816
Epoch: 8, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.322 Vali Acc: 0.446 Test Loss: 1.322 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1020972728729248
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.360 Vali Acc: 0.432 Test Loss: 1.360 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0420253276824951
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.509 Vali Acc: 0.459 Test Loss: 1.509 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9548971652984619
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9591856002807617
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.582 Vali Acc: 0.473 Test Loss: 1.582 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9875450134277344
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.516 Vali Acc: 0.446 Test Loss: 1.516 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 261948
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.959470510482788
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.307 Vali Acc: 0.351 Test Loss: 1.307 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0148324966430664
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.363 Vali Acc: 0.378 Test Loss: 1.363 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.997089147567749
Epoch: 3, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.238 Vali Acc: 0.473 Test Loss: 1.238 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.1518077850341797
Epoch: 4, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.195 Vali Acc: 0.446 Test Loss: 1.195 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0618162155151367
Epoch: 5, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.524 Vali Acc: 0.419 Test Loss: 1.524 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1457762718200684
Epoch: 6, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.389 Vali Acc: 0.392 Test Loss: 1.389 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.121931791305542
Epoch: 7, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.441 Vali Acc: 0.419 Test Loss: 1.441 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1014211177825928
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.337 Vali Acc: 0.473 Test Loss: 1.337 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0385315418243408
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1542670726776123
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.801 Vali Acc: 0.392 Test Loss: 1.801 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1281986236572266
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.673 Vali Acc: 0.405 Test Loss: 1.673 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1579623222351074
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.792 Vali Acc: 0.419 Test Loss: 1.792 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0877583026885986
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.935 Vali Acc: 0.365 Test Loss: 1.935 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 261948
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2650258541107178
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.311 Vali Acc: 0.446 Test Loss: 1.311 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 1.2254340648651123
Epoch: 2, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.023697853088379
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.213 Vali Acc: 0.378 Test Loss: 1.213 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0252025127410889
Epoch: 4, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.9769141674041748
Epoch: 5, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.386 Vali Acc: 0.392 Test Loss: 1.386 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9176976680755615
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9234347343444824
Epoch: 7, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9521405696868896
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8873388767242432
Epoch: 9, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.312 Vali Acc: 0.432 Test Loss: 1.312 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8961217403411865
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.297 Vali Acc: 0.473 Test Loss: 1.297 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 11 cost time: 1.010725736618042
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.508 Vali Acc: 0.446 Test Loss: 1.508 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9508395195007324
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.522 Vali Acc: 0.392 Test Loss: 1.522 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8913590908050537
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.450 Vali Acc: 0.446 Test Loss: 1.450 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9619781970977783
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.467 Vali Acc: 0.446 Test Loss: 1.467 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8264546394348145
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.638 Vali Acc: 0.446 Test Loss: 1.638 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9939770698547363
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.545 Vali Acc: 0.486 Test Loss: 1.545 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486471).  Saving model ...
Epoch: 17 cost time: 0.9847650527954102
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.568 Vali Acc: 0.446 Test Loss: 1.568 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.967071533203125
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.667 Vali Acc: 0.405 Test Loss: 1.667 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.148221492767334
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.610 Vali Acc: 0.405 Test Loss: 1.610 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.205756425857544
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.685 Vali Acc: 0.432 Test Loss: 1.685 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.203216314315796
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.684 Vali Acc: 0.432 Test Loss: 1.684 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1060490608215332
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.693 Vali Acc: 0.419 Test Loss: 1.693 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1557536125183105
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.419 Test Loss: 1.720 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2084102630615234
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.405 Test Loss: 1.750 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1409344673156738
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.745 Vali Acc: 0.419 Test Loss: 1.745 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1427440643310547
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.405 Test Loss: 1.751 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 261948
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8924520015716553
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.374 Vali Acc: 0.392 Test Loss: 1.374 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.9808313846588135
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
Validation loss decreased (-0.391878 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.125281572341919
Epoch: 3, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.204 Vali Acc: 0.405 Test Loss: 1.204 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.0390665531158447
Epoch: 4, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.166 Vali Acc: 0.432 Test Loss: 1.166 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432421).  Saving model ...
Epoch: 5 cost time: 0.975132942199707
Epoch: 5, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.432421 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.1117358207702637
Epoch: 6, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.250 Vali Acc: 0.459 Test Loss: 1.250 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0131142139434814
Epoch: 7, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.189 Vali Acc: 0.473 Test Loss: 1.189 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9835014343261719
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.191 Vali Acc: 0.473 Test Loss: 1.191 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0224363803863525
Epoch: 9, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.372 Vali Acc: 0.419 Test Loss: 1.372 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9892933368682861
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.316 Vali Acc: 0.446 Test Loss: 1.316 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9473659992218018
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.354 Vali Acc: 0.473 Test Loss: 1.354 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0071566104888916
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.372 Vali Acc: 0.419 Test Loss: 1.372 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.109870195388794
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.475 Vali Acc: 0.459 Test Loss: 1.475 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.014195442199707
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.444 Vali Acc: 0.392 Test Loss: 1.444 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9985661506652832
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.508 Vali Acc: 0.432 Test Loss: 1.508 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 376764
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9542031288146973
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.0898175239562988
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.276 Vali Acc: 0.405 Test Loss: 1.276 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 0.9938294887542725
Epoch: 3, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.1651206016540527
Epoch: 4, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.037126064300537
Epoch: 5, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.199 Vali Acc: 0.446 Test Loss: 1.199 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9450881481170654
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0070700645446777
Epoch: 7, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.969433069229126
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.134 Vali Acc: 0.459 Test Loss: 1.134 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0112860202789307
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.237 Vali Acc: 0.446 Test Loss: 1.237 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8888528347015381
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.187 Vali Acc: 0.459 Test Loss: 1.187 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9992623329162598
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0529675483703613
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.369 Vali Acc: 0.459 Test Loss: 1.369 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0458056926727295
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.441 Vali Acc: 0.432 Test Loss: 1.441 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2045338153839111
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.381 Vali Acc: 0.432 Test Loss: 1.381 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 376764
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7606356143951416
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.325 Vali Acc: 0.378 Test Loss: 1.325 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.9159374237060547
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 0.9273562431335449
Epoch: 3, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.216 Vali Acc: 0.392 Test Loss: 1.216 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8956379890441895
Epoch: 4, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.405393 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.940187931060791
Epoch: 5, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9628829956054688
Epoch: 6, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9724540710449219
Epoch: 7, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.194 Vali Acc: 0.419 Test Loss: 1.194 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0894627571105957
Epoch: 8, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.938361644744873
Epoch: 9, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9787099361419678
Epoch: 10, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0204546451568604
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9979968070983887
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.371 Vali Acc: 0.405 Test Loss: 1.371 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1681740283966064
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.407 Vali Acc: 0.459 Test Loss: 1.407 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0634815692901611
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.462 Vali Acc: 0.446 Test Loss: 1.462 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 376764
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8554697036743164
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.325 Vali Acc: 0.432 Test Loss: 1.325 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 0.9257640838623047
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.315 Vali Acc: 0.419 Test Loss: 1.315 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9576554298400879
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.257 Vali Acc: 0.365 Test Loss: 1.257 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8756108283996582
Epoch: 4, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9558207988739014
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9969429969787598
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9268968105316162
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8531136512756348
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.302 Vali Acc: 0.459 Test Loss: 1.302 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0573077201843262
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.338 Vali Acc: 0.432 Test Loss: 1.338 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9253242015838623
Epoch: 10, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.370 Vali Acc: 0.419 Test Loss: 1.370 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9070498943328857
Epoch: 11, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.399 Vali Acc: 0.446 Test Loss: 1.399 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9092450141906738
Epoch: 12, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.548 Vali Acc: 0.392 Test Loss: 1.548 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1041901111602783
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.574 Vali Acc: 0.432 Test Loss: 1.574 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9046332836151123
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.574 Vali Acc: 0.432 Test Loss: 1.574 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 376764
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0800087451934814
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.0208089351654053
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.285 Vali Acc: 0.486 Test Loss: 1.285 Test Acc: 0.486
Validation loss decreased (-0.297284 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.0859737396240234
Epoch: 3, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.238 Vali Acc: 0.419 Test Loss: 1.238 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0763955116271973
Epoch: 4, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0293354988098145
Epoch: 5, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0363743305206299
Epoch: 6, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.316 Vali Acc: 0.459 Test Loss: 1.316 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0625951290130615
Epoch: 7, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.0986125469207764
Epoch: 8, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2868585586547852
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.406 Vali Acc: 0.419 Test Loss: 1.406 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1498723030090332
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1549866199493408
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.326 Vali Acc: 0.473 Test Loss: 1.326 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9773378372192383
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.534 Vali Acc: 0.459 Test Loss: 1.534 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0698394775390625
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.427 Vali Acc: 0.459 Test Loss: 1.427 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0310735702514648
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.636 Vali Acc: 0.432 Test Loss: 1.636 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1804382801055908
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.509 Vali Acc: 0.473 Test Loss: 1.509 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1413474082946777
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.669 Vali Acc: 0.446 Test Loss: 1.669 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.255286693572998
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.622 Vali Acc: 0.459 Test Loss: 1.622 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 245692
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8199446201324463
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.341 Vali Acc: 0.351 Test Loss: 1.341 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9749984741210938
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.276 Vali Acc: 0.473 Test Loss: 1.276 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.9034442901611328
Epoch: 3, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.246 Vali Acc: 0.405 Test Loss: 1.246 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9907653331756592
Epoch: 4, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.9363441467285156
Epoch: 5, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1181561946868896
Epoch: 6, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0120975971221924
Epoch: 7, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0219306945800781
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9828455448150635
Epoch: 9, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.275 Vali Acc: 0.392 Test Loss: 1.275 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9560647010803223
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9264864921569824
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.285 Vali Acc: 0.473 Test Loss: 1.285 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0295190811157227
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.568 Vali Acc: 0.446 Test Loss: 1.568 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9177343845367432
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.457 Vali Acc: 0.514 Test Loss: 1.457 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513499).  Saving model ...
Epoch: 14 cost time: 1.175234317779541
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.571 Vali Acc: 0.405 Test Loss: 1.571 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9386756420135498
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.483 Vali Acc: 0.432 Test Loss: 1.483 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0579662322998047
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.627 Vali Acc: 0.419 Test Loss: 1.627 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9958102703094482
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.575 Vali Acc: 0.405 Test Loss: 1.575 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8904311656951904
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.574 Vali Acc: 0.446 Test Loss: 1.574 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0923848152160645
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.631 Vali Acc: 0.432 Test Loss: 1.631 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0607097148895264
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.641 Vali Acc: 0.446 Test Loss: 1.641 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9699397087097168
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.657 Vali Acc: 0.405 Test Loss: 1.657 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0050578117370605
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.649 Vali Acc: 0.432 Test Loss: 1.649 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.935821533203125
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.656 Vali Acc: 0.446 Test Loss: 1.656 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 245692
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.309187889099121
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.346 Vali Acc: 0.351 Test Loss: 1.346 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9969093799591064
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0518882274627686
Epoch: 3, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.282 Vali Acc: 0.324 Test Loss: 1.282 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0172061920166016
Epoch: 4, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.9448947906494141
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.215 Vali Acc: 0.419 Test Loss: 1.215 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.999199390411377
Epoch: 6, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.906364917755127
Epoch: 7, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.227 Vali Acc: 0.419 Test Loss: 1.227 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9281089305877686
Epoch: 8, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.290 Vali Acc: 0.392 Test Loss: 1.290 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9074065685272217
Epoch: 9, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.9299232959747314
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
Validation loss decreased (-0.499987 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 0.9616491794586182
Epoch: 11, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.331 Vali Acc: 0.473 Test Loss: 1.331 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9735112190246582
Epoch: 12, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.420 Vali Acc: 0.446 Test Loss: 1.420 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.003922462463379
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.03114914894104
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.524 Vali Acc: 0.419 Test Loss: 1.524 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0021522045135498
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.470 Vali Acc: 0.446 Test Loss: 1.470 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9734964370727539
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.584 Vali Acc: 0.473 Test Loss: 1.584 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1047039031982422
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.606 Vali Acc: 0.432 Test Loss: 1.606 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9374899864196777
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.693 Vali Acc: 0.473 Test Loss: 1.693 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9677464962005615
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.607 Vali Acc: 0.459 Test Loss: 1.607 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0701422691345215
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.629 Vali Acc: 0.473 Test Loss: 1.629 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 245692
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9896628856658936
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.365 Vali Acc: 0.338 Test Loss: 1.365 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0503807067871094
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.317 Vali Acc: 0.378 Test Loss: 1.317 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.9689974784851074
Epoch: 3, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.345 Vali Acc: 0.324 Test Loss: 1.345 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8558568954467773
Epoch: 4, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.279 Vali Acc: 0.378 Test Loss: 1.279 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 0.8928031921386719
Epoch: 5, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.294 Vali Acc: 0.365 Test Loss: 1.294 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9169504642486572
Epoch: 6, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.308 Vali Acc: 0.351 Test Loss: 1.308 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9724869728088379
Epoch: 7, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.324 Vali Acc: 0.419 Test Loss: 1.324 Test Acc: 0.419
Validation loss decreased (-0.378366 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 1.0015208721160889
Epoch: 8, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.368 Vali Acc: 0.378 Test Loss: 1.368 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0449740886688232
Epoch: 9, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.353 Vali Acc: 0.419 Test Loss: 1.353 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8725755214691162
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.407 Vali Acc: 0.446 Test Loss: 1.407 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445932).  Saving model ...
Epoch: 11 cost time: 0.9283344745635986
Epoch: 11, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.429 Vali Acc: 0.459 Test Loss: 1.429 Test Acc: 0.459
Validation loss decreased (-0.445932 --> -0.459445).  Saving model ...
Epoch: 12 cost time: 0.8255982398986816
Epoch: 12, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.503 Vali Acc: 0.378 Test Loss: 1.503 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8647477626800537
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.541 Vali Acc: 0.459 Test Loss: 1.541 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8678619861602783
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.659 Vali Acc: 0.405 Test Loss: 1.659 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8831088542938232
Epoch: 15, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.623 Vali Acc: 0.405 Test Loss: 1.623 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9279255867004395
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.660 Vali Acc: 0.419 Test Loss: 1.660 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9416236877441406
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.699 Vali Acc: 0.405 Test Loss: 1.699 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9841649532318115
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.707 Vali Acc: 0.419 Test Loss: 1.707 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1186232566833496
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.707 Vali Acc: 0.486 Test Loss: 1.707 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486469).  Saving model ...
Epoch: 20 cost time: 0.9060103893280029
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.782 Vali Acc: 0.432 Test Loss: 1.782 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8584656715393066
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.758 Vali Acc: 0.459 Test Loss: 1.758 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8292653560638428
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.769 Vali Acc: 0.446 Test Loss: 1.769 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9621052742004395
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.805 Vali Acc: 0.446 Test Loss: 1.805 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0279390811920166
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.798 Vali Acc: 0.473 Test Loss: 1.798 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0567371845245361
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.822 Vali Acc: 0.486 Test Loss: 1.822 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2706303596496582
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.886 Vali Acc: 0.446 Test Loss: 1.886 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0937602519989014
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.897 Vali Acc: 0.446 Test Loss: 1.897 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9777493476867676
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.883 Vali Acc: 0.500 Test Loss: 1.883 Test Acc: 0.500
Validation loss decreased (-0.486469 --> -0.499981).  Saving model ...
Epoch: 29 cost time: 0.9945595264434814
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.878 Vali Acc: 0.473 Test Loss: 1.878 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9247190952301025
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.899 Vali Acc: 0.486 Test Loss: 1.899 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9172704219818115
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 32 cost time: 0.9773297309875488
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.889 Vali Acc: 0.486 Test Loss: 1.889 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0690903663635254
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.910 Vali Acc: 0.486 Test Loss: 1.910 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0641679763793945
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.922 Vali Acc: 0.459 Test Loss: 1.922 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9784810543060303
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.934 Vali Acc: 0.486 Test Loss: 1.934 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9881913661956787
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.951 Vali Acc: 0.473 Test Loss: 1.951 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1574444770812988
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.961 Vali Acc: 0.473 Test Loss: 1.961 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.858055591583252
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1180143356323242
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.486 Test Loss: 1.976 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9223430156707764
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.991 Vali Acc: 0.486 Test Loss: 1.991 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8922834396362305
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.486 Test Loss: 2.002 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 245692
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.903327703475952
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.306 Vali Acc: 0.351 Test Loss: 1.306 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.8497858047485352
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9308466911315918
Epoch: 3, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.162 Vali Acc: 0.459 Test Loss: 1.162 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 0.7684838771820068
Epoch: 4, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.9496922492980957
Epoch: 5, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.123 Vali Acc: 0.473 Test Loss: 1.123 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 0.9160082340240479
Epoch: 6, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.155 Vali Acc: 0.473 Test Loss: 1.155 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9840378761291504
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.255 Vali Acc: 0.365 Test Loss: 1.255 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8700098991394043
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
Validation loss decreased (-0.472962 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.9586095809936523
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.0523767471313477
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.317 Vali Acc: 0.486 Test Loss: 1.317 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8702261447906494
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.364 Vali Acc: 0.432 Test Loss: 1.364 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9155945777893066
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.375 Vali Acc: 0.473 Test Loss: 1.375 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8878836631774902
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.999000072479248
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.475 Vali Acc: 0.446 Test Loss: 1.475 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0759940147399902
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9461002349853516
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.534 Vali Acc: 0.459 Test Loss: 1.534 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0300657749176025
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.546 Vali Acc: 0.486 Test Loss: 1.546 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9250671863555908
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.570 Vali Acc: 0.500 Test Loss: 1.570 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0490295886993408
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.613 Vali Acc: 0.486 Test Loss: 1.613 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 180156
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0538833141326904
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.334 Vali Acc: 0.365 Test Loss: 1.334 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 0.9283862113952637
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9227297306060791
Epoch: 3, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.209 Vali Acc: 0.432 Test Loss: 1.209 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.0080249309539795
Epoch: 4, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9286274909973145
Epoch: 5, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.161 Vali Acc: 0.446 Test Loss: 1.161 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9552721977233887
Epoch: 6, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1009294986724854
Epoch: 7, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9244177341461182
Epoch: 8, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.026426076889038
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.241 Vali Acc: 0.473 Test Loss: 1.241 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9299740791320801
Epoch: 10, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9049458503723145
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.347 Vali Acc: 0.459 Test Loss: 1.347 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8960442543029785
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.347 Vali Acc: 0.459 Test Loss: 1.347 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8745660781860352
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.378 Vali Acc: 0.473 Test Loss: 1.378 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9163401126861572
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.454 Vali Acc: 0.459 Test Loss: 1.454 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9235823154449463
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.468 Vali Acc: 0.432 Test Loss: 1.468 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8948242664337158
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.526 Vali Acc: 0.459 Test Loss: 1.526 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9240150451660156
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.529 Vali Acc: 0.446 Test Loss: 1.529 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9332141876220703
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.608 Vali Acc: 0.432 Test Loss: 1.608 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 180156
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.601547956466675
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.349 Vali Acc: 0.311 Test Loss: 1.349 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9039671421051025
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.324 Vali Acc: 0.378 Test Loss: 1.324 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0580976009368896
Epoch: 3, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.239 Vali Acc: 0.405 Test Loss: 1.239 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.8835737705230713
Epoch: 4, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.8516280651092529
Epoch: 5, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8530669212341309
Epoch: 6, Steps: 10 | Train Loss: 0.626 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.9007959365844727
Epoch: 7, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8710315227508545
Epoch: 8, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9538531303405762
Epoch: 9, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 10 cost time: 1.0418267250061035
Epoch: 10, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.289 Vali Acc: 0.446 Test Loss: 1.289 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9907572269439697
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.337 Vali Acc: 0.486 Test Loss: 1.337 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 12 cost time: 1.1560256481170654
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.9490804672241211
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.497 Vali Acc: 0.459 Test Loss: 1.497 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0329205989837646
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.506 Vali Acc: 0.486 Test Loss: 1.506 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9751462936401367
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.658 Vali Acc: 0.473 Test Loss: 1.658 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.134209156036377
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.571 Vali Acc: 0.500 Test Loss: 1.571 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9769759178161621
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.675 Vali Acc: 0.514 Test Loss: 1.675 Test Acc: 0.514
Validation loss decreased (-0.499986 --> -0.513497).  Saving model ...
Epoch: 18 cost time: 1.0045194625854492
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.671 Vali Acc: 0.446 Test Loss: 1.671 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0343382358551025
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.701 Vali Acc: 0.459 Test Loss: 1.701 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8895542621612549
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.641 Vali Acc: 0.500 Test Loss: 1.641 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.112752914428711
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.650 Vali Acc: 0.486 Test Loss: 1.650 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0026018619537354
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.038583517074585
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.688 Vali Acc: 0.514 Test Loss: 1.688 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9963102340698242
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.696 Vali Acc: 0.527 Test Loss: 1.696 Test Acc: 0.527
Validation loss decreased (-0.513497 --> -0.527010).  Saving model ...
Epoch: 25 cost time: 0.9614555835723877
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.714 Vali Acc: 0.514 Test Loss: 1.714 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9601395130157471
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.527 Test Loss: 1.713 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9542050361633301
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.745 Vali Acc: 0.500 Test Loss: 1.745 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9332489967346191
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.775 Vali Acc: 0.527 Test Loss: 1.775 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0245213508605957
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.790 Vali Acc: 0.527 Test Loss: 1.790 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9861001968383789
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0074989795684814
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.527 Test Loss: 1.810 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9898135662078857
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.500 Test Loss: 1.835 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0364508628845215
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9961321353912354
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.527 Test Loss: 1.853 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 180156
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7197985649108887
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.350 Vali Acc: 0.392 Test Loss: 1.350 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.91658616065979
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.040811538696289
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.288 Vali Acc: 0.351 Test Loss: 1.288 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9027197360992432
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.274 Vali Acc: 0.365 Test Loss: 1.274 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8359520435333252
Epoch: 5, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.291 Vali Acc: 0.419 Test Loss: 1.291 Test Acc: 0.419
Validation loss decreased (-0.391878 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9005129337310791
Epoch: 6, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.298 Vali Acc: 0.338 Test Loss: 1.298 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9680664539337158
Epoch: 7, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.348 Vali Acc: 0.378 Test Loss: 1.348 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9717628955841064
Epoch: 8, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.349 Vali Acc: 0.365 Test Loss: 1.349 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9174602031707764
Epoch: 9, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.397 Vali Acc: 0.351 Test Loss: 1.397 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0471608638763428
Epoch: 10, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.353 Vali Acc: 0.432 Test Loss: 1.353 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 11 cost time: 0.9880993366241455
Epoch: 11, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.466 Vali Acc: 0.324 Test Loss: 1.466 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0073494911193848
Epoch: 12, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.453 Vali Acc: 0.392 Test Loss: 1.453 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9806454181671143
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.632 Vali Acc: 0.392 Test Loss: 1.632 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1420166492462158
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.530 Vali Acc: 0.405 Test Loss: 1.530 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9641435146331787
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.604 Vali Acc: 0.459 Test Loss: 1.604 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459443).  Saving model ...
Epoch: 16 cost time: 1.0845160484313965
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.628 Vali Acc: 0.432 Test Loss: 1.628 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0335967540740967
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.764 Vali Acc: 0.446 Test Loss: 1.764 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9951457977294922
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.766 Vali Acc: 0.446 Test Loss: 1.766 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9740722179412842
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.902 Vali Acc: 0.419 Test Loss: 1.902 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0950522422790527
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.823 Vali Acc: 0.432 Test Loss: 1.823 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0229952335357666
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.778 Vali Acc: 0.432 Test Loss: 1.778 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0281364917755127
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.817 Vali Acc: 0.446 Test Loss: 1.817 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0702383518218994
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.836 Vali Acc: 0.432 Test Loss: 1.836 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9187347888946533
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.798 Vali Acc: 0.392 Test Loss: 1.798 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.971076488494873
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.836 Vali Acc: 0.446 Test Loss: 1.836 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 180156
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7766263484954834
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.385 Vali Acc: 0.338 Test Loss: 1.385 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8490805625915527
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9206171035766602
Epoch: 3, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.194 Vali Acc: 0.473 Test Loss: 1.194 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9941227436065674
Epoch: 4, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.175 Vali Acc: 0.446 Test Loss: 1.175 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9744570255279541
Epoch: 5, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.182 Vali Acc: 0.419 Test Loss: 1.182 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1187710762023926
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.172 Vali Acc: 0.459 Test Loss: 1.172 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0613141059875488
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.209 Vali Acc: 0.405 Test Loss: 1.209 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0069513320922852
Epoch: 8, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0036375522613525
Epoch: 9, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.9739623069763184
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.375 Vali Acc: 0.405 Test Loss: 1.375 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0211372375488281
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.497 Vali Acc: 0.432 Test Loss: 1.497 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9511260986328125
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.359 Vali Acc: 0.446 Test Loss: 1.359 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9854526519775391
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.479 Vali Acc: 0.432 Test Loss: 1.479 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0320765972137451
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.499 Vali Acc: 0.432 Test Loss: 1.499 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1205663681030273
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.512 Vali Acc: 0.446 Test Loss: 1.512 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0084576606750488
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.587 Vali Acc: 0.419 Test Loss: 1.587 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9958157539367676
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.615 Vali Acc: 0.446 Test Loss: 1.615 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9565889835357666
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.664 Vali Acc: 0.419 Test Loss: 1.664 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0907773971557617
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.655 Vali Acc: 0.432 Test Loss: 1.655 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 147388
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2326877117156982
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.0557160377502441
Epoch: 2, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.297 Vali Acc: 0.405 Test Loss: 1.297 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.9489235877990723
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.95066237449646
Epoch: 4, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9739596843719482
Epoch: 5, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.203 Vali Acc: 0.432 Test Loss: 1.203 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9710803031921387
Epoch: 6, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9594287872314453
Epoch: 7, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.197 Vali Acc: 0.432 Test Loss: 1.197 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9624197483062744
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0458617210388184
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.0180284976959229
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.346 Vali Acc: 0.459 Test Loss: 1.346 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0356407165527344
Epoch: 11, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.426 Vali Acc: 0.405 Test Loss: 1.426 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9941601753234863
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.336 Vali Acc: 0.473 Test Loss: 1.336 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.024942398071289
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.451 Vali Acc: 0.392 Test Loss: 1.451 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0534744262695312
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2006914615631104
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.482 Vali Acc: 0.419 Test Loss: 1.482 Test Acc: 0.419
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9902629852294922
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.539 Vali Acc: 0.405 Test Loss: 1.539 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1576082706451416
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.587 Vali Acc: 0.405 Test Loss: 1.587 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1729490756988525
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.621 Vali Acc: 0.405 Test Loss: 1.621 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0559484958648682
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.632 Vali Acc: 0.392 Test Loss: 1.632 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 147388
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4078128337860107
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.1155285835266113
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.025787115097046
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.1126213073730469
Epoch: 4, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.228 Vali Acc: 0.405 Test Loss: 1.228 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1536202430725098
Epoch: 5, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.225 Vali Acc: 0.432 Test Loss: 1.225 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9973437786102295
Epoch: 6, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.9628536701202393
Epoch: 7, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.0221142768859863
Epoch: 8, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.902324914932251
Epoch: 9, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.246 Vali Acc: 0.419 Test Loss: 1.246 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0413284301757812
Epoch: 10, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.451 Vali Acc: 0.405 Test Loss: 1.451 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0594942569732666
Epoch: 11, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.390 Vali Acc: 0.432 Test Loss: 1.390 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9451067447662354
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.325 Vali Acc: 0.514 Test Loss: 1.325 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513500).  Saving model ...
Epoch: 13 cost time: 0.9886317253112793
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.440 Vali Acc: 0.446 Test Loss: 1.440 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9674367904663086
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.469 Vali Acc: 0.432 Test Loss: 1.469 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0486321449279785
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.476 Vali Acc: 0.432 Test Loss: 1.476 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9956905841827393
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.529 Vali Acc: 0.514 Test Loss: 1.529 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9716081619262695
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.518 Vali Acc: 0.514 Test Loss: 1.518 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0123226642608643
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.593 Vali Acc: 0.514 Test Loss: 1.593 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0270798206329346
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.629 Vali Acc: 0.459 Test Loss: 1.629 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0589141845703125
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2130231857299805
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.679 Vali Acc: 0.514 Test Loss: 1.679 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1002037525177002
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527011).  Saving model ...
Epoch: 23 cost time: 1.050191879272461
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.644 Vali Acc: 0.500 Test Loss: 1.644 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.143082857131958
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.679 Vali Acc: 0.473 Test Loss: 1.679 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1824779510498047
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0898947715759277
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.707 Vali Acc: 0.500 Test Loss: 1.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0166709423065186
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0439207553863525
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0534696578979492
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.745 Vali Acc: 0.473 Test Loss: 1.745 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1734869480133057
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.775 Vali Acc: 0.473 Test Loss: 1.775 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9619631767272949
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.784 Vali Acc: 0.486 Test Loss: 1.784 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1227049827575684
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.809 Vali Acc: 0.486 Test Loss: 1.809 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 147388
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.757402181625366
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.391 Vali Acc: 0.297 Test Loss: 1.391 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9620959758758545
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.345 Vali Acc: 0.311 Test Loss: 1.345 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.015183687210083
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.307 Vali Acc: 0.419 Test Loss: 1.307 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.0753870010375977
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.298 Vali Acc: 0.392 Test Loss: 1.298 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0246245861053467
Epoch: 5, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.305 Vali Acc: 0.338 Test Loss: 1.305 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.016451120376587
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0575449466705322
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.315 Vali Acc: 0.365 Test Loss: 1.315 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1978952884674072
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432419).  Saving model ...
Epoch: 9 cost time: 0.8933565616607666
Epoch: 9, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.392 Vali Acc: 0.378 Test Loss: 1.392 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0146045684814453
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.466 Vali Acc: 0.378 Test Loss: 1.466 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1474289894104004
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.500 Vali Acc: 0.378 Test Loss: 1.500 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1813304424285889
Epoch: 12, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.499 Vali Acc: 0.432 Test Loss: 1.499 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.084378719329834
Epoch: 13, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.554 Vali Acc: 0.446 Test Loss: 1.554 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445930).  Saving model ...
Epoch: 14 cost time: 1.0964179039001465
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.586 Vali Acc: 0.419 Test Loss: 1.586 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9234018325805664
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.708 Vali Acc: 0.392 Test Loss: 1.708 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9849708080291748
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.694 Vali Acc: 0.446 Test Loss: 1.694 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0127379894256592
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.726 Vali Acc: 0.446 Test Loss: 1.726 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9122424125671387
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.760 Vali Acc: 0.419 Test Loss: 1.760 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9721388816833496
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.754 Vali Acc: 0.405 Test Loss: 1.754 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9829609394073486
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.785 Vali Acc: 0.405 Test Loss: 1.785 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.006164789199829
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.836 Vali Acc: 0.432 Test Loss: 1.836 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.081190586090088
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.812 Vali Acc: 0.446 Test Loss: 1.812 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1096127033233643
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.854 Vali Acc: 0.446 Test Loss: 1.854 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 147388
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0678138732910156
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9368653297424316
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.252 Vali Acc: 0.392 Test Loss: 1.252 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9909861087799072
Epoch: 3, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.219 Vali Acc: 0.446 Test Loss: 1.219 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.9924328327178955
Epoch: 4, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.246 Vali Acc: 0.419 Test Loss: 1.246 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8717923164367676
Epoch: 5, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.9709193706512451
Epoch: 6, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.217 Vali Acc: 0.419 Test Loss: 1.217 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8839311599731445
Epoch: 7, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0487377643585205
Epoch: 8, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.189 Vali Acc: 0.459 Test Loss: 1.189 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9509410858154297
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9782145023345947
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9463720321655273
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.335 Vali Acc: 0.446 Test Loss: 1.335 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.946331262588501
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.388 Vali Acc: 0.432 Test Loss: 1.388 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9684083461761475
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.572 Vali Acc: 0.446 Test Loss: 1.572 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8852329254150391
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.496 Vali Acc: 0.459 Test Loss: 1.496 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0221467018127441
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.552 Vali Acc: 0.419 Test Loss: 1.552 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 131004
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8909761905670166
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.426 Vali Acc: 0.203 Test Loss: 1.426 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.8863620758056641
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.275 Vali Acc: 0.392 Test Loss: 1.275 Test Acc: 0.392
Validation loss decreased (-0.202688 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.038686990737915
Epoch: 3, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.227 Vali Acc: 0.527 Test Loss: 1.227 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.9854323863983154
Epoch: 4, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.240 Vali Acc: 0.392 Test Loss: 1.240 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9656693935394287
Epoch: 5, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.0624513626098633
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.207 Vali Acc: 0.446 Test Loss: 1.207 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9771530628204346
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9627058506011963
Epoch: 8, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1934683322906494
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9590475559234619
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.243 Vali Acc: 0.446 Test Loss: 1.243 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1358695030212402
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.304 Vali Acc: 0.473 Test Loss: 1.304 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9652414321899414
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.374 Vali Acc: 0.432 Test Loss: 1.374 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9618058204650879
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9355828762054443
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.470 Vali Acc: 0.459 Test Loss: 1.470 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9087095260620117
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.428 Vali Acc: 0.473 Test Loss: 1.428 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 131004
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7777960300445557
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.440 Vali Acc: 0.189 Test Loss: 1.440 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.979271411895752
Epoch: 2, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.326 Vali Acc: 0.351 Test Loss: 1.326 Test Acc: 0.351
Validation loss decreased (-0.189175 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9937455654144287
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.265 Vali Acc: 0.432 Test Loss: 1.265 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.9216270446777344
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.274 Vali Acc: 0.351 Test Loss: 1.274 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9496777057647705
Epoch: 5, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.314478874206543
Epoch: 6, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.260 Vali Acc: 0.405 Test Loss: 1.260 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.139052391052246
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.277 Vali Acc: 0.419 Test Loss: 1.277 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.133157730102539
Epoch: 8, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.232 Vali Acc: 0.459 Test Loss: 1.232 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1759600639343262
Epoch: 9, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.331 Vali Acc: 0.432 Test Loss: 1.331 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0660369396209717
Epoch: 10, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0014424324035645
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.1299614906311035
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.399 Vali Acc: 0.446 Test Loss: 1.399 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2293410301208496
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.480 Vali Acc: 0.446 Test Loss: 1.480 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0585007667541504
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.550 Vali Acc: 0.514 Test Loss: 1.550 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513498).  Saving model ...
Epoch: 15 cost time: 1.2603108882904053
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.543 Vali Acc: 0.486 Test Loss: 1.543 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.070960283279419
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.565 Vali Acc: 0.446 Test Loss: 1.565 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0712065696716309
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0780904293060303
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.645 Vali Acc: 0.514 Test Loss: 1.645 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2293379306793213
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.676 Vali Acc: 0.459 Test Loss: 1.676 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1021308898925781
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.611 Vali Acc: 0.527 Test Loss: 1.611 Test Acc: 0.527
Validation loss decreased (-0.513498 --> -0.527011).  Saving model ...
Epoch: 21 cost time: 1.0239214897155762
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.629 Vali Acc: 0.514 Test Loss: 1.629 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9922811985015869
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.700 Vali Acc: 0.446 Test Loss: 1.700 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0733654499053955
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.697 Vali Acc: 0.500 Test Loss: 1.697 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0079853534698486
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.735 Vali Acc: 0.486 Test Loss: 1.735 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9126315116882324
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.732 Vali Acc: 0.541 Test Loss: 1.732 Test Acc: 0.541
Validation loss decreased (-0.527011 --> -0.540523).  Saving model ...
Epoch: 26 cost time: 0.9323768615722656
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.514 Test Loss: 1.692 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9356832504272461
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.473 Test Loss: 1.715 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9797446727752686
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.717 Vali Acc: 0.541 Test Loss: 1.717 Test Acc: 0.541
Validation loss decreased (-0.540523 --> -0.540523).  Saving model ...
Epoch: 29 cost time: 0.9983730316162109
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.746 Vali Acc: 0.541 Test Loss: 1.746 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0143072605133057
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.527 Test Loss: 1.752 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9645302295684814
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.541 Test Loss: 1.750 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.243990421295166
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.746 Vali Acc: 0.554 Test Loss: 1.746 Test Acc: 0.554
Validation loss decreased (-0.540523 --> -0.554037).  Saving model ...
Epoch: 33 cost time: 1.177523136138916
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.785 Vali Acc: 0.514 Test Loss: 1.785 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2335891723632812
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.514 Test Loss: 1.801 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2438549995422363
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.527 Test Loss: 1.804 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1216261386871338
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.825 Vali Acc: 0.514 Test Loss: 1.825 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1908652782440186
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.527 Test Loss: 1.839 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1291084289550781
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.840 Vali Acc: 0.514 Test Loss: 1.840 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9361259937286377
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.863 Vali Acc: 0.527 Test Loss: 1.863 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9650614261627197
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.486 Test Loss: 1.895 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1204028129577637
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.912 Vali Acc: 0.500 Test Loss: 1.912 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1076970100402832
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.486 Test Loss: 1.923 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 131004
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.876824140548706
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.419 Vali Acc: 0.203 Test Loss: 1.419 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.8767704963684082
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.362 Vali Acc: 0.338 Test Loss: 1.362 Test Acc: 0.338
Validation loss decreased (-0.202689 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8978190422058105
Epoch: 3, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.324 Vali Acc: 0.365 Test Loss: 1.324 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.8487005233764648
Epoch: 4, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.332 Vali Acc: 0.297 Test Loss: 1.332 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9039018154144287
Epoch: 5, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.286 Vali Acc: 0.392 Test Loss: 1.286 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.8883635997772217
Epoch: 6, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8907060623168945
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.393 Vali Acc: 0.365 Test Loss: 1.393 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.859154224395752
Epoch: 8, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.376 Vali Acc: 0.365 Test Loss: 1.376 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8815097808837891
Epoch: 9, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.402 Vali Acc: 0.405 Test Loss: 1.402 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405391).  Saving model ...
Epoch: 10 cost time: 0.9834623336791992
Epoch: 10, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.419 Vali Acc: 0.419 Test Loss: 1.419 Test Acc: 0.419
Validation loss decreased (-0.405391 --> -0.418905).  Saving model ...
Epoch: 11 cost time: 0.9573500156402588
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.455 Vali Acc: 0.405 Test Loss: 1.455 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9617903232574463
Epoch: 12, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.496 Vali Acc: 0.432 Test Loss: 1.496 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432417).  Saving model ...
Epoch: 13 cost time: 0.9594907760620117
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.575 Vali Acc: 0.432 Test Loss: 1.575 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0205602645874023
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.588 Vali Acc: 0.378 Test Loss: 1.588 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9293866157531738
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.694 Vali Acc: 0.419 Test Loss: 1.694 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9252703189849854
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.806 Vali Acc: 0.446 Test Loss: 1.806 Test Acc: 0.446
Validation loss decreased (-0.432417 --> -0.445928).  Saving model ...
Epoch: 17 cost time: 0.9466841220855713
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.773 Vali Acc: 0.446 Test Loss: 1.773 Test Acc: 0.446
Validation loss decreased (-0.445928 --> -0.445928).  Saving model ...
Epoch: 18 cost time: 0.935523271560669
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.801 Vali Acc: 0.432 Test Loss: 1.801 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0234105587005615
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.776 Vali Acc: 0.405 Test Loss: 1.776 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9353578090667725
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.784 Vali Acc: 0.432 Test Loss: 1.784 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9689621925354004
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.811 Vali Acc: 0.392 Test Loss: 1.811 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0521011352539062
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.835 Vali Acc: 0.392 Test Loss: 1.835 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9580168724060059
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.865 Vali Acc: 0.405 Test Loss: 1.865 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8830955028533936
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.912 Vali Acc: 0.419 Test Loss: 1.912 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0282857418060303
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.876 Vali Acc: 0.405 Test Loss: 1.876 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9498236179351807
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.861 Vali Acc: 0.419 Test Loss: 1.861 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8675484657287598
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.885 Vali Acc: 0.432 Test Loss: 1.885 Test Acc: 0.432
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.44594594594594594
model parameter : 131004
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8733251094818115
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.9525165557861328
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
Validation loss decreased (-0.378365 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 0.9296431541442871
Epoch: 3, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9228537082672119
Epoch: 4, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.180 Vali Acc: 0.446 Test Loss: 1.180 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.060506820678711
Epoch: 5, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0539391040802002
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9481644630432129
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9863355159759521
Epoch: 8, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.886197566986084
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9947161674499512
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.298 Vali Acc: 0.446 Test Loss: 1.298 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0087878704071045
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.424 Vali Acc: 0.473 Test Loss: 1.424 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9840073585510254
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.306 Vali Acc: 0.486 Test Loss: 1.306 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 122812
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.034045457839966
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.1295936107635498
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
Validation loss decreased (-0.337824 --> -0.540528).  Saving model ...
Epoch: 3 cost time: 0.9154567718505859
Epoch: 3, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9724717140197754
Epoch: 4, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8633522987365723
Epoch: 5, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.050577163696289
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8984041213989258
Epoch: 7, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9111623764038086
Epoch: 8, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9683394432067871
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0560362339019775
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.251 Vali Acc: 0.473 Test Loss: 1.251 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9463229179382324
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.418 Vali Acc: 0.419 Test Loss: 1.418 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0093960762023926
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 122812
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8775172233581543
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.365 Vali Acc: 0.351 Test Loss: 1.365 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9253618717193604
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.272 Vali Acc: 0.486 Test Loss: 1.272 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 0.8916082382202148
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.1220359802246094
Epoch: 4, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.9707858562469482
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.0163710117340088
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9989347457885742
Epoch: 7, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.282 Vali Acc: 0.432 Test Loss: 1.282 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0549800395965576
Epoch: 8, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.323 Vali Acc: 0.419 Test Loss: 1.323 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0527019500732422
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.195 Vali Acc: 0.527 Test Loss: 1.195 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 1.0501899719238281
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0604043006896973
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.460 Vali Acc: 0.459 Test Loss: 1.460 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0676453113555908
Epoch: 12, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.393 Vali Acc: 0.473 Test Loss: 1.393 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3179559707641602
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.504 Vali Acc: 0.446 Test Loss: 1.504 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2002129554748535
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.470 Vali Acc: 0.473 Test Loss: 1.470 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2477524280548096
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.629 Vali Acc: 0.473 Test Loss: 1.629 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1186389923095703
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.080810785293579
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.638 Vali Acc: 0.473 Test Loss: 1.638 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0404329299926758
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.571 Vali Acc: 0.541 Test Loss: 1.571 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540525).  Saving model ...
Epoch: 19 cost time: 1.0208547115325928
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9804091453552246
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.633 Vali Acc: 0.473 Test Loss: 1.633 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8762111663818359
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.602 Vali Acc: 0.514 Test Loss: 1.602 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0148272514343262
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.651 Vali Acc: 0.500 Test Loss: 1.651 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0494606494903564
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.649 Vali Acc: 0.527 Test Loss: 1.649 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9928252696990967
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.673 Vali Acc: 0.514 Test Loss: 1.673 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1040170192718506
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.712 Vali Acc: 0.500 Test Loss: 1.712 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.025886058807373
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.718 Vali Acc: 0.514 Test Loss: 1.718 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0216329097747803
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.732 Vali Acc: 0.500 Test Loss: 1.732 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9804308414459229
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 122812
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8566067218780518
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.374 Vali Acc: 0.338 Test Loss: 1.374 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.9683127403259277
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9545590877532959
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.291 Vali Acc: 0.405 Test Loss: 1.291 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9927399158477783
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.1488378047943115
Epoch: 5, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.0396578311920166
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9312188625335693
Epoch: 7, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.378 Vali Acc: 0.324 Test Loss: 1.378 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.016638994216919
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.400 Vali Acc: 0.351 Test Loss: 1.400 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0705037117004395
Epoch: 9, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.314 Vali Acc: 0.473 Test Loss: 1.314 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 10 cost time: 0.9723129272460938
Epoch: 10, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.447 Vali Acc: 0.419 Test Loss: 1.447 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9782602787017822
Epoch: 11, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.542 Vali Acc: 0.405 Test Loss: 1.542 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.107745885848999
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.531 Vali Acc: 0.446 Test Loss: 1.531 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0132415294647217
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.708 Vali Acc: 0.446 Test Loss: 1.708 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0420277118682861
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.661 Vali Acc: 0.446 Test Loss: 1.661 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9763827323913574
Epoch: 15, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.681 Vali Acc: 0.405 Test Loss: 1.681 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0157580375671387
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.679 Vali Acc: 0.378 Test Loss: 1.679 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.057955026626587
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.753 Vali Acc: 0.432 Test Loss: 1.753 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9781935214996338
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.757 Vali Acc: 0.419 Test Loss: 1.757 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9649922847747803
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.796 Vali Acc: 0.365 Test Loss: 1.796 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 122812
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8844540119171143
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.428 Vali Acc: 0.297 Test Loss: 1.428 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9814548492431641
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.0078983306884766
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.349 Vali Acc: 0.338 Test Loss: 1.349 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.154989242553711
Epoch: 4, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.282 Vali Acc: 0.405 Test Loss: 1.282 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.0223400592803955
Epoch: 5, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.8979916572570801
Epoch: 6, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.0279622077941895
Epoch: 7, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8999619483947754
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8826603889465332
Epoch: 9, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.254 Vali Acc: 0.486 Test Loss: 1.254 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8607971668243408
Epoch: 10, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 0.9476947784423828
Epoch: 11, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8607223033905029
Epoch: 12, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.345 Vali Acc: 0.473 Test Loss: 1.345 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9045207500457764
Epoch: 13, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.428 Vali Acc: 0.459 Test Loss: 1.428 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8982234001159668
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.544 Vali Acc: 0.432 Test Loss: 1.544 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9913973808288574
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0509817600250244
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.511 Vali Acc: 0.486 Test Loss: 1.511 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0585224628448486
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.541 Vali Acc: 0.486 Test Loss: 1.541 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9752488136291504
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.135237216949463
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.716 Vali Acc: 0.459 Test Loss: 1.716 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0567965507507324
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.680 Vali Acc: 0.486 Test Loss: 1.680 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 186364
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9558932781219482
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.410 Vali Acc: 0.230 Test Loss: 1.410 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9669382572174072
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.340 Vali Acc: 0.338 Test Loss: 1.340 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.9943645000457764
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.336 Vali Acc: 0.405 Test Loss: 1.336 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.0938069820404053
Epoch: 4, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.266 Vali Acc: 0.419 Test Loss: 1.266 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9541599750518799
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.220 Vali Acc: 0.432 Test Loss: 1.220 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.017453908920288
Epoch: 6, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.9754703044891357
Epoch: 7, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.212 Vali Acc: 0.432 Test Loss: 1.212 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0666794776916504
Epoch: 8, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.222 Vali Acc: 0.419 Test Loss: 1.222 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0386607646942139
Epoch: 9, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.030315637588501
Epoch: 10, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.0006954669952393
Epoch: 11, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9702749252319336
Epoch: 12, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 13 cost time: 0.9105134010314941
Epoch: 13, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.341 Vali Acc: 0.473 Test Loss: 1.341 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8149361610412598
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.414 Vali Acc: 0.541 Test Loss: 1.414 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540526).  Saving model ...
Epoch: 15 cost time: 0.8894445896148682
Epoch: 15, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8320486545562744
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.416 Vali Acc: 0.514 Test Loss: 1.416 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9295458793640137
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9979093074798584
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.591 Vali Acc: 0.486 Test Loss: 1.591 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.93902587890625
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.534 Vali Acc: 0.514 Test Loss: 1.534 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9877128601074219
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.553 Vali Acc: 0.554 Test Loss: 1.553 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554039).  Saving model ...
Epoch: 21 cost time: 0.9681355953216553
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.575 Vali Acc: 0.541 Test Loss: 1.575 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9721651077270508
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.630 Vali Acc: 0.541 Test Loss: 1.630 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0114939212799072
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.647 Vali Acc: 0.527 Test Loss: 1.647 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1017343997955322
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0028367042541504
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.667 Vali Acc: 0.541 Test Loss: 1.667 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9998962879180908
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.099334478378296
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.687 Vali Acc: 0.527 Test Loss: 1.687 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.958188533782959
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.730 Vali Acc: 0.527 Test Loss: 1.730 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0943553447723389
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.741 Vali Acc: 0.527 Test Loss: 1.741 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1013782024383545
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.732 Vali Acc: 0.514 Test Loss: 1.732 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 186364
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1514062881469727
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.374 Vali Acc: 0.270 Test Loss: 1.374 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.2499785423278809
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.313 Vali Acc: 0.419 Test Loss: 1.313 Test Acc: 0.419
Validation loss decreased (-0.270257 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0641639232635498
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2147257328033447
Epoch: 4, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.262 Vali Acc: 0.432 Test Loss: 1.262 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.016995906829834
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.1301422119140625
Epoch: 6, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.227 Vali Acc: 0.405 Test Loss: 1.227 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.235036849975586
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.208 Vali Acc: 0.459 Test Loss: 1.208 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1769671440124512
Epoch: 8, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.258 Vali Acc: 0.405 Test Loss: 1.258 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1193029880523682
Epoch: 9, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9375762939453125
Epoch: 10, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.229 Vali Acc: 0.446 Test Loss: 1.229 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9790363311767578
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0786645412445068
Epoch: 12, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.322 Vali Acc: 0.473 Test Loss: 1.322 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1150565147399902
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.377 Vali Acc: 0.432 Test Loss: 1.377 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.112752914428711
Epoch: 14, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.441 Vali Acc: 0.432 Test Loss: 1.441 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1353886127471924
Epoch: 15, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.459 Vali Acc: 0.459 Test Loss: 1.459 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 186364
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4215519428253174
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.368 Vali Acc: 0.297 Test Loss: 1.368 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.0989596843719482
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.9859659671783447
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.323 Vali Acc: 0.432 Test Loss: 1.323 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.9923186302185059
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.278 Vali Acc: 0.446 Test Loss: 1.278 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0460150241851807
Epoch: 5, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.233 Vali Acc: 0.473 Test Loss: 1.233 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.0043973922729492
Epoch: 6, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0639686584472656
Epoch: 7, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.066908359527588
Epoch: 8, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.243 Vali Acc: 0.419 Test Loss: 1.243 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.147489070892334
Epoch: 9, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9001271724700928
Epoch: 10, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.185 Vali Acc: 0.446 Test Loss: 1.185 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1267361640930176
Epoch: 11, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0579047203063965
Epoch: 12, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.030672311782837
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.238 Vali Acc: 0.459 Test Loss: 1.238 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.035008192062378
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3498497009277344
Epoch: 15, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1615419387817383
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0863945484161377
Epoch: 17, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.378 Vali Acc: 0.419 Test Loss: 1.378 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 186364
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9675753116607666
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.424 Vali Acc: 0.284 Test Loss: 1.424 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8963868618011475
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.389 Vali Acc: 0.311 Test Loss: 1.389 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.914825439453125
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.299 Vali Acc: 0.338 Test Loss: 1.299 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.9913976192474365
Epoch: 4, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9024813175201416
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.265 Vali Acc: 0.432 Test Loss: 1.265 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.9529571533203125
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.193 Vali Acc: 0.419 Test Loss: 1.193 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0013630390167236
Epoch: 7, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.0759735107421875
Epoch: 8, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.957275390625
Epoch: 9, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.201 Vali Acc: 0.486 Test Loss: 1.201 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 0.8620572090148926
Epoch: 10, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.0394611358642578
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.297 Vali Acc: 0.486 Test Loss: 1.297 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9699363708496094
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9907758235931396
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.349 Vali Acc: 0.486 Test Loss: 1.349 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0493669509887695
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.352 Vali Acc: 0.554 Test Loss: 1.352 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 15 cost time: 1.0640122890472412
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.493 Vali Acc: 0.514 Test Loss: 1.493 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0642144680023193
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.430 Vali Acc: 0.514 Test Loss: 1.430 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.094043493270874
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.558 Vali Acc: 0.486 Test Loss: 1.558 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.127143144607544
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.545 Vali Acc: 0.514 Test Loss: 1.545 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9448857307434082
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.556 Vali Acc: 0.486 Test Loss: 1.556 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9924478530883789
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.616 Vali Acc: 0.486 Test Loss: 1.616 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0930538177490234
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.644 Vali Acc: 0.473 Test Loss: 1.644 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0411975383758545
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.642 Vali Acc: 0.459 Test Loss: 1.642 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.945570707321167
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.679 Vali Acc: 0.486 Test Loss: 1.679 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0037610530853271
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.680 Vali Acc: 0.486 Test Loss: 1.680 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 120828
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.860752582550049
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9852488040924072
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.372 Vali Acc: 0.311 Test Loss: 1.372 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8948490619659424
Epoch: 3, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.290 Vali Acc: 0.338 Test Loss: 1.290 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.8264658451080322
Epoch: 4, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.337825 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8261880874633789
Epoch: 5, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8561787605285645
Epoch: 6, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8455078601837158
Epoch: 7, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.9356491565704346
Epoch: 8, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.8778839111328125
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.9373693466186523
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.179 Vali Acc: 0.527 Test Loss: 1.179 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8559606075286865
Epoch: 11, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8629114627838135
Epoch: 12, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.242 Vali Acc: 0.514 Test Loss: 1.242 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9416885375976562
Epoch: 13, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.327 Vali Acc: 0.514 Test Loss: 1.327 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9354574680328369
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9928843975067139
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.404 Vali Acc: 0.541 Test Loss: 1.404 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9821436405181885
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.388 Vali Acc: 0.514 Test Loss: 1.388 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9007105827331543
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.532 Vali Acc: 0.541 Test Loss: 1.532 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9371166229248047
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.460 Vali Acc: 0.541 Test Loss: 1.460 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.927337646484375
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.542 Vali Acc: 0.541 Test Loss: 1.542 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 120828
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8638722896575928
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8305084705352783
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.8977582454681396
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.296 Vali Acc: 0.392 Test Loss: 1.296 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8127989768981934
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.285 Vali Acc: 0.432 Test Loss: 1.285 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.8725500106811523
Epoch: 5, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.279 Vali Acc: 0.459 Test Loss: 1.279 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8836734294891357
Epoch: 6, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.218 Vali Acc: 0.432 Test Loss: 1.218 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9608597755432129
Epoch: 7, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9478335380554199
Epoch: 8, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.8241722583770752
Epoch: 9, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9156942367553711
Epoch: 10, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9593513011932373
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.218 Vali Acc: 0.527 Test Loss: 1.218 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.0461297035217285
Epoch: 12, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.907663106918335
Epoch: 13, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.339 Vali Acc: 0.473 Test Loss: 1.339 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9659364223480225
Epoch: 14, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 15 cost time: 0.9854938983917236
Epoch: 15, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.507 Vali Acc: 0.459 Test Loss: 1.507 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9338743686676025
Epoch: 16, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.375 Vali Acc: 0.514 Test Loss: 1.375 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.857576847076416
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.523 Vali Acc: 0.473 Test Loss: 1.523 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8231322765350342
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.817089319229126
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.559 Vali Acc: 0.527 Test Loss: 1.559 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8215205669403076
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8458759784698486
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.649 Vali Acc: 0.486 Test Loss: 1.649 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7804534435272217
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.610 Vali Acc: 0.473 Test Loss: 1.610 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8174641132354736
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.638 Vali Acc: 0.486 Test Loss: 1.638 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8695204257965088
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.724 Vali Acc: 0.459 Test Loss: 1.724 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 120828
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9775779247283936
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.399 Vali Acc: 0.311 Test Loss: 1.399 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8976030349731445
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.374 Vali Acc: 0.419 Test Loss: 1.374 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 0.9014561176300049
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.328 Vali Acc: 0.419 Test Loss: 1.328 Test Acc: 0.419
Validation loss decreased (-0.418905 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.902801513671875
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.315 Vali Acc: 0.365 Test Loss: 1.315 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7664511203765869
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.324 Vali Acc: 0.324 Test Loss: 1.324 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9194772243499756
Epoch: 6, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 0.8944201469421387
Epoch: 7, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.256 Vali Acc: 0.405 Test Loss: 1.256 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9362187385559082
Epoch: 8, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8368852138519287
Epoch: 9, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9115498065948486
Epoch: 10, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.250 Vali Acc: 0.405 Test Loss: 1.250 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8526055812835693
Epoch: 11, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.233 Vali Acc: 0.459 Test Loss: 1.233 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 0.9522175788879395
Epoch: 12, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.309 Vali Acc: 0.432 Test Loss: 1.309 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8929598331451416
Epoch: 13, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.331 Vali Acc: 0.446 Test Loss: 1.331 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9172227382659912
Epoch: 14, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.308 Vali Acc: 0.459 Test Loss: 1.308 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8444945812225342
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.389 Vali Acc: 0.432 Test Loss: 1.389 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0369255542755127
Epoch: 16, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.364 Vali Acc: 0.446 Test Loss: 1.364 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7760422229766846
Epoch: 17, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.514 Vali Acc: 0.432 Test Loss: 1.514 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8997366428375244
Epoch: 18, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.419 Vali Acc: 0.446 Test Loss: 1.419 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8546657562255859
Epoch: 19, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.473 Vali Acc: 0.446 Test Loss: 1.473 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9122698307037354
Epoch: 20, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499984).  Saving model ...
Epoch: 21 cost time: 0.8580915927886963
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.519 Vali Acc: 0.473 Test Loss: 1.519 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9448084831237793
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.625 Vali Acc: 0.459 Test Loss: 1.625 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8543961048126221
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.667 Vali Acc: 0.459 Test Loss: 1.667 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9093148708343506
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.727 Vali Acc: 0.446 Test Loss: 1.727 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9709374904632568
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.751 Vali Acc: 0.432 Test Loss: 1.751 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8639311790466309
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.840 Vali Acc: 0.459 Test Loss: 1.840 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8855645656585693
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.844 Vali Acc: 0.419 Test Loss: 1.844 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9303762912750244
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.987 Vali Acc: 0.419 Test Loss: 1.987 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9682161808013916
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.907 Vali Acc: 0.446 Test Loss: 1.907 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0548326969146729
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.909 Vali Acc: 0.392 Test Loss: 1.909 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 120828
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.912309169769287
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.419 Vali Acc: 0.230 Test Loss: 1.419 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9334390163421631
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.9105062484741211
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.8897466659545898
Epoch: 4, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.8999950885772705
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.9349768161773682
Epoch: 6, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.210 Vali Acc: 0.432 Test Loss: 1.210 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9714236259460449
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.9365696907043457
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9484639167785645
Epoch: 9, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9378499984741211
Epoch: 10, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.260 Vali Acc: 0.473 Test Loss: 1.260 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9342811107635498
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.237 Vali Acc: 0.541 Test Loss: 1.237 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 0.9416334629058838
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 0.9566261768341064
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.386 Vali Acc: 0.486 Test Loss: 1.386 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8674261569976807
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.373 Vali Acc: 0.541 Test Loss: 1.373 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8400790691375732
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.507 Vali Acc: 0.514 Test Loss: 1.507 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9128463268280029
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.445 Vali Acc: 0.541 Test Loss: 1.445 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9638988971710205
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.604 Vali Acc: 0.486 Test Loss: 1.604 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8507423400878906
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.600 Vali Acc: 0.514 Test Loss: 1.600 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0574724674224854
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.636 Vali Acc: 0.514 Test Loss: 1.636 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8577263355255127
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.650 Vali Acc: 0.514 Test Loss: 1.650 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9064188003540039
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.659 Vali Acc: 0.554 Test Loss: 1.659 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8719732761383057
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.670 Vali Acc: 0.541 Test Loss: 1.670 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 88060
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.799907684326172
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.418 Vali Acc: 0.284 Test Loss: 1.418 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8806867599487305
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9898302555084229
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.282 Vali Acc: 0.419 Test Loss: 1.282 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.8865196704864502
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.290 Vali Acc: 0.432 Test Loss: 1.290 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.7878806591033936
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8499240875244141
Epoch: 6, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9732513427734375
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.9875514507293701
Epoch: 8, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.9035422801971436
Epoch: 9, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9370040893554688
Epoch: 10, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8896899223327637
Epoch: 11, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.869103193283081
Epoch: 12, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 0.9124026298522949
Epoch: 13, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.347 Vali Acc: 0.432 Test Loss: 1.347 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0523488521575928
Epoch: 14, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0144264698028564
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.356 Vali Acc: 0.486 Test Loss: 1.356 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9622035026550293
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.354 Vali Acc: 0.486 Test Loss: 1.354 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9404103755950928
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9883794784545898
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.521 Vali Acc: 0.486 Test Loss: 1.521 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8710904121398926
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.568 Vali Acc: 0.419 Test Loss: 1.568 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9114406108856201
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.591 Vali Acc: 0.486 Test Loss: 1.591 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9298784732818604
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.596 Vali Acc: 0.459 Test Loss: 1.596 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8278498649597168
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.609 Vali Acc: 0.459 Test Loss: 1.609 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 88060
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.742549180984497
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.6877837181091309
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.892967700958252
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.301 Vali Acc: 0.392 Test Loss: 1.301 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8567636013031006
Epoch: 4, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9016177654266357
Epoch: 5, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.269 Vali Acc: 0.405 Test Loss: 1.269 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.918287992477417
Epoch: 6, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9131169319152832
Epoch: 7, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 0.9417705535888672
Epoch: 8, Steps: 10 | Train Loss: 0.641 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 0.8902575969696045
Epoch: 9, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8729279041290283
Epoch: 10, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.324 Vali Acc: 0.459 Test Loss: 1.324 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 11 cost time: 0.9185020923614502
Epoch: 11, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 12 cost time: 0.9355716705322266
Epoch: 12, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.340 Vali Acc: 0.459 Test Loss: 1.340 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8477506637573242
Epoch: 13, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.439 Vali Acc: 0.419 Test Loss: 1.439 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8849148750305176
Epoch: 14, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.403 Vali Acc: 0.459 Test Loss: 1.403 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9913966655731201
Epoch: 15, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9175014495849609
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.509 Vali Acc: 0.432 Test Loss: 1.509 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8994660377502441
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.565 Vali Acc: 0.459 Test Loss: 1.565 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8911314010620117
Epoch: 18, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.665 Vali Acc: 0.432 Test Loss: 1.665 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9471306800842285
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.638 Vali Acc: 0.486 Test Loss: 1.638 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0753250122070312
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.740 Vali Acc: 0.432 Test Loss: 1.740 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8558194637298584
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.736 Vali Acc: 0.446 Test Loss: 1.736 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 88060
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.765484094619751
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.883979320526123
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.369 Vali Acc: 0.284 Test Loss: 1.369 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8802683353424072
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.313 Vali Acc: 0.324 Test Loss: 1.313 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.8683249950408936
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.334 Vali Acc: 0.324 Test Loss: 1.334 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9654126167297363
Epoch: 5, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.284 Vali Acc: 0.338 Test Loss: 1.284 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 0.874579668045044
Epoch: 6, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.288 Vali Acc: 0.338 Test Loss: 1.288 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9106590747833252
Epoch: 7, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.274 Vali Acc: 0.378 Test Loss: 1.274 Test Acc: 0.378
Validation loss decreased (-0.337825 --> -0.378366).  Saving model ...
Epoch: 8 cost time: 0.9366641044616699
Epoch: 8, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.232 Vali Acc: 0.378 Test Loss: 1.232 Test Acc: 0.378
Validation loss decreased (-0.378366 --> -0.378366).  Saving model ...
Epoch: 9 cost time: 0.8766725063323975
Epoch: 9, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.219 Vali Acc: 0.405 Test Loss: 1.219 Test Acc: 0.405
Validation loss decreased (-0.378366 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 0.9079856872558594
Epoch: 10, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.250 Vali Acc: 0.392 Test Loss: 1.250 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9618148803710938
Epoch: 11, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.233 Vali Acc: 0.392 Test Loss: 1.233 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.057410717010498
Epoch: 12, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.238 Vali Acc: 0.419 Test Loss: 1.238 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 13 cost time: 1.0203883647918701
Epoch: 13, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459447).  Saving model ...
Epoch: 14 cost time: 1.0389480590820312
Epoch: 14, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.250 Vali Acc: 0.446 Test Loss: 1.250 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0834105014801025
Epoch: 15, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.330 Vali Acc: 0.419 Test Loss: 1.330 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.132749080657959
Epoch: 16, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.346 Vali Acc: 0.432 Test Loss: 1.346 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.175616979598999
Epoch: 17, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.385 Vali Acc: 0.419 Test Loss: 1.385 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0230321884155273
Epoch: 18, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.486 Vali Acc: 0.432 Test Loss: 1.486 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.126645565032959
Epoch: 19, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.500 Vali Acc: 0.486 Test Loss: 1.500 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486471).  Saving model ...
Epoch: 20 cost time: 1.0818233489990234
Epoch: 20, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.514 Vali Acc: 0.459 Test Loss: 1.514 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9448206424713135
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.648 Vali Acc: 0.446 Test Loss: 1.648 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1770894527435303
Epoch: 22, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.665 Vali Acc: 0.473 Test Loss: 1.665 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.994255781173706
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.784 Vali Acc: 0.459 Test Loss: 1.784 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9379978179931641
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.817 Vali Acc: 0.432 Test Loss: 1.817 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9861264228820801
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.844 Vali Acc: 0.405 Test Loss: 1.844 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9446792602539062
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.717 Vali Acc: 0.432 Test Loss: 1.717 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9681105613708496
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.863 Vali Acc: 0.419 Test Loss: 1.863 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0523173809051514
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.859 Vali Acc: 0.432 Test Loss: 1.859 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.939842939376831
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.848 Vali Acc: 0.446 Test Loss: 1.848 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 88060
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8299217224121094
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.875218391418457
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.310 Vali Acc: 0.419 Test Loss: 1.310 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8449671268463135
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.282 Vali Acc: 0.365 Test Loss: 1.282 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9027750492095947
Epoch: 4, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.9776575565338135
Epoch: 5, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8515481948852539
Epoch: 6, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.8624162673950195
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7910492420196533
Epoch: 8, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.182 Vali Acc: 0.541 Test Loss: 1.182 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.899256706237793
Epoch: 9, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.202 Vali Acc: 0.446 Test Loss: 1.202 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8466839790344238
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.209 Vali Acc: 0.486 Test Loss: 1.209 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8939235210418701
Epoch: 11, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.315 Vali Acc: 0.459 Test Loss: 1.315 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9625818729400635
Epoch: 12, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.226 Vali Acc: 0.581 Test Loss: 1.226 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 0.966156005859375
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.307 Vali Acc: 0.527 Test Loss: 1.307 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.084237813949585
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9203979969024658
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.402 Vali Acc: 0.486 Test Loss: 1.402 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8932669162750244
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.426 Vali Acc: 0.527 Test Loss: 1.426 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8691275119781494
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.445 Vali Acc: 0.527 Test Loss: 1.445 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.875389814376831
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.484 Vali Acc: 0.541 Test Loss: 1.484 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9059019088745117
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8825249671936035
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.561 Vali Acc: 0.486 Test Loss: 1.561 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9281995296478271
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.598 Vali Acc: 0.514 Test Loss: 1.598 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7814629077911377
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.664 Vali Acc: 0.514 Test Loss: 1.664 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 71676
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1738781929016113
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.373 Vali Acc: 0.270 Test Loss: 1.373 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.9137206077575684
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.309 Vali Acc: 0.486 Test Loss: 1.309 Test Acc: 0.486
Validation loss decreased (-0.270257 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 0.8380098342895508
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9123587608337402
Epoch: 4, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8982491493225098
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
Validation loss decreased (-0.486473 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8468577861785889
Epoch: 6, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.843029260635376
Epoch: 7, Steps: 10 | Train Loss: 0.666 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8550701141357422
Epoch: 8, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7536697387695312
Epoch: 9, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8387007713317871
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8648757934570312
Epoch: 11, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.850588321685791
Epoch: 12, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 0.9427609443664551
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.269 Vali Acc: 0.554 Test Loss: 1.269 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 0.9765613079071045
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9101846218109131
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.386 Vali Acc: 0.473 Test Loss: 1.386 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.080183982849121
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.383 Vali Acc: 0.554 Test Loss: 1.383 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.89862060546875
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8940904140472412
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.438 Vali Acc: 0.514 Test Loss: 1.438 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8950788974761963
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7746255397796631
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.491 Vali Acc: 0.527 Test Loss: 1.491 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9256582260131836
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.548 Vali Acc: 0.554 Test Loss: 1.548 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9560685157775879
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.971332311630249
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.649 Vali Acc: 0.541 Test Loss: 1.649 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 71676
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8444206714630127
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.341 Vali Acc: 0.324 Test Loss: 1.341 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.0663957595825195
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.285 Vali Acc: 0.446 Test Loss: 1.285 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.9056663513183594
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.274 Vali Acc: 0.486 Test Loss: 1.274 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9340789318084717
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.9436056613922119
Epoch: 5, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.8617620468139648
Epoch: 6, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8824059963226318
Epoch: 7, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9326064586639404
Epoch: 8, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.193 Vali Acc: 0.527 Test Loss: 1.193 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8341758251190186
Epoch: 9, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8481590747833252
Epoch: 10, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8604958057403564
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.300 Vali Acc: 0.459 Test Loss: 1.300 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.901674747467041
Epoch: 12, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9055914878845215
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9493224620819092
Epoch: 14, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.435 Vali Acc: 0.459 Test Loss: 1.435 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0173282623291016
Epoch: 15, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.462 Vali Acc: 0.419 Test Loss: 1.462 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 71676
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.164893627166748
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.370 Vali Acc: 0.284 Test Loss: 1.370 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9094903469085693
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.8513259887695312
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8392653465270996
Epoch: 4, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.8715000152587891
Epoch: 5, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.262 Vali Acc: 0.392 Test Loss: 1.262 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8739502429962158
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.261 Vali Acc: 0.432 Test Loss: 1.261 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8543078899383545
Epoch: 7, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.226 Vali Acc: 0.405 Test Loss: 1.226 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8143706321716309
Epoch: 8, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.234 Vali Acc: 0.419 Test Loss: 1.234 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8355352878570557
Epoch: 9, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.226 Vali Acc: 0.392 Test Loss: 1.226 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.861243486404419
Epoch: 10, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.212 Vali Acc: 0.446 Test Loss: 1.212 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 11 cost time: 0.9257874488830566
Epoch: 11, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.249 Vali Acc: 0.378 Test Loss: 1.249 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8590147495269775
Epoch: 12, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.260 Vali Acc: 0.392 Test Loss: 1.260 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8123509883880615
Epoch: 13, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8697552680969238
Epoch: 14, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.350 Vali Acc: 0.378 Test Loss: 1.350 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8290863037109375
Epoch: 15, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8852436542510986
Epoch: 16, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.358 Vali Acc: 0.446 Test Loss: 1.358 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8809211254119873
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.409 Vali Acc: 0.446 Test Loss: 1.409 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8282613754272461
Epoch: 18, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.479 Vali Acc: 0.432 Test Loss: 1.479 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8121151924133301
Epoch: 19, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.529 Vali Acc: 0.459 Test Loss: 1.529 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459444).  Saving model ...
Epoch: 20 cost time: 0.8845288753509521
Epoch: 20, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
Validation loss decreased (-0.459444 --> -0.472957).  Saving model ...
Epoch: 21 cost time: 0.7587628364562988
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.629 Vali Acc: 0.459 Test Loss: 1.629 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9065282344818115
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.621 Vali Acc: 0.473 Test Loss: 1.621 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8326945304870605
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.701 Vali Acc: 0.432 Test Loss: 1.701 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8012368679046631
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.722 Vali Acc: 0.473 Test Loss: 1.722 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8542206287384033
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.810 Vali Acc: 0.432 Test Loss: 1.810 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8466696739196777
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.925 Vali Acc: 0.446 Test Loss: 1.925 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9305546283721924
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.930 Vali Acc: 0.419 Test Loss: 1.930 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8015432357788086
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.923 Vali Acc: 0.432 Test Loss: 1.923 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8545529842376709
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.921 Vali Acc: 0.405 Test Loss: 1.921 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7441697120666504
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.014 Vali Acc: 0.405 Test Loss: 2.014 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 71676
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.688455581665039
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.395 Vali Acc: 0.270 Test Loss: 1.395 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8718364238739014
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.324 Vali Acc: 0.338 Test Loss: 1.324 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.93680739402771
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.274 Vali Acc: 0.378 Test Loss: 1.274 Test Acc: 0.378
Validation loss decreased (-0.337825 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 0.973651647567749
Epoch: 4, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
Validation loss decreased (-0.378366 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.9270007610321045
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.9282364845275879
Epoch: 6, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.192 Vali Acc: 0.473 Test Loss: 1.192 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8644497394561768
Epoch: 7, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9072122573852539
Epoch: 8, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.203 Vali Acc: 0.473 Test Loss: 1.203 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9197449684143066
Epoch: 9, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.193 Vali Acc: 0.541 Test Loss: 1.193 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.005357027053833
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8763408660888672
Epoch: 11, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9992904663085938
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.333 Vali Acc: 0.419 Test Loss: 1.333 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9226250648498535
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9696063995361328
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9279289245605469
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.476 Vali Acc: 0.459 Test Loss: 1.476 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9021649360656738
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9878628253936768
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.617 Vali Acc: 0.473 Test Loss: 1.617 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8875598907470703
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.600 Vali Acc: 0.554 Test Loss: 1.600 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554038).  Saving model ...
Epoch: 19 cost time: 0.8421947956085205
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.616 Vali Acc: 0.541 Test Loss: 1.616 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9305777549743652
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.670 Vali Acc: 0.514 Test Loss: 1.670 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0284972190856934
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.643 Vali Acc: 0.514 Test Loss: 1.643 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9055578708648682
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.722 Vali Acc: 0.514 Test Loss: 1.722 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.89217209815979
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.743 Vali Acc: 0.514 Test Loss: 1.743 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9132750034332275
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.759 Vali Acc: 0.514 Test Loss: 1.759 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0066380500793457
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.767 Vali Acc: 0.459 Test Loss: 1.767 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0036940574645996
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.766 Vali Acc: 0.459 Test Loss: 1.766 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9456052780151367
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.888 Vali Acc: 0.432 Test Loss: 1.888 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9335966110229492
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.804 Vali Acc: 0.473 Test Loss: 1.804 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 63484
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1992056369781494
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.036733865737915
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.332 Vali Acc: 0.378 Test Loss: 1.332 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0563232898712158
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.293 Vali Acc: 0.419 Test Loss: 1.293 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9027540683746338
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.972780704498291
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.196 Vali Acc: 0.446 Test Loss: 1.196 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9435203075408936
Epoch: 6, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.9835078716278076
Epoch: 7, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.9761223793029785
Epoch: 8, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9709022045135498
Epoch: 9, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.1053242683410645
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.232 Vali Acc: 0.459 Test Loss: 1.232 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9888339042663574
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 12 cost time: 0.8940179347991943
Epoch: 12, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.337 Vali Acc: 0.459 Test Loss: 1.337 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9358372688293457
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.309 Vali Acc: 0.486 Test Loss: 1.309 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9688804149627686
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.415 Vali Acc: 0.486 Test Loss: 1.415 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8943836688995361
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.424 Vali Acc: 0.486 Test Loss: 1.424 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9102737903594971
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.439 Vali Acc: 0.486 Test Loss: 1.439 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9344606399536133
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.476 Vali Acc: 0.473 Test Loss: 1.476 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9086389541625977
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9097633361816406
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.520 Vali Acc: 0.527 Test Loss: 1.520 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527012).  Saving model ...
Epoch: 20 cost time: 0.9028079509735107
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.518 Vali Acc: 0.500 Test Loss: 1.518 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9039125442504883
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.550 Vali Acc: 0.486 Test Loss: 1.550 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9147837162017822
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.631 Vali Acc: 0.514 Test Loss: 1.631 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9546515941619873
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9450194835662842
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.674 Vali Acc: 0.500 Test Loss: 1.674 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.912468671798706
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.652 Vali Acc: 0.473 Test Loss: 1.652 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9896955490112305
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9360294342041016
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.733 Vali Acc: 0.473 Test Loss: 1.733 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9463906288146973
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.688 Vali Acc: 0.459 Test Loss: 1.688 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9171991348266602
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.684 Vali Acc: 0.459 Test Loss: 1.684 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 63484
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7125139236450195
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.402 Vali Acc: 0.351 Test Loss: 1.402 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 0.9108052253723145
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.347 Vali Acc: 0.324 Test Loss: 1.347 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8311591148376465
Epoch: 3, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.322 Vali Acc: 0.432 Test Loss: 1.322 Test Acc: 0.432
Validation loss decreased (-0.351337 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.8459272384643555
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9059054851531982
Epoch: 5, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9114890098571777
Epoch: 6, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.258 Vali Acc: 0.378 Test Loss: 1.258 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9368195533752441
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8995401859283447
Epoch: 8, Steps: 10 | Train Loss: 0.604 Vali Loss: 1.266 Vali Acc: 0.378 Test Loss: 1.266 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8328895568847656
Epoch: 9, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.254 Vali Acc: 0.473 Test Loss: 1.254 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 10 cost time: 1.1570672988891602
Epoch: 10, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.309 Vali Acc: 0.405 Test Loss: 1.309 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0166873931884766
Epoch: 11, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.390 Vali Acc: 0.486 Test Loss: 1.390 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486473).  Saving model ...
Epoch: 12 cost time: 0.9638433456420898
Epoch: 12, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.419 Vali Acc: 0.365 Test Loss: 1.419 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.995396614074707
Epoch: 13, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.368 Vali Acc: 0.473 Test Loss: 1.368 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8792941570281982
Epoch: 14, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.504 Vali Acc: 0.378 Test Loss: 1.504 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8976995944976807
Epoch: 15, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.423 Vali Acc: 0.446 Test Loss: 1.423 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.831787109375
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.557 Vali Acc: 0.432 Test Loss: 1.557 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.854015588760376
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.530 Vali Acc: 0.459 Test Loss: 1.530 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.881481409072876
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.598 Vali Acc: 0.405 Test Loss: 1.598 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8494184017181396
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.633 Vali Acc: 0.500 Test Loss: 1.633 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499984).  Saving model ...
Epoch: 20 cost time: 0.8471057415008545
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.636 Vali Acc: 0.432 Test Loss: 1.636 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9424207210540771
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.688 Vali Acc: 0.432 Test Loss: 1.688 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8576288223266602
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.683 Vali Acc: 0.459 Test Loss: 1.683 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9196803569793701
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.770 Vali Acc: 0.392 Test Loss: 1.770 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7907443046569824
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.783 Vali Acc: 0.419 Test Loss: 1.783 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8897178173065186
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.756 Vali Acc: 0.432 Test Loss: 1.756 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9978852272033691
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.867 Vali Acc: 0.405 Test Loss: 1.867 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8487906455993652
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.850 Vali Acc: 0.405 Test Loss: 1.850 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9023396968841553
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.869 Vali Acc: 0.405 Test Loss: 1.869 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.965740442276001
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.906 Vali Acc: 0.419 Test Loss: 1.906 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 63484
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.495316505432129
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.393 Vali Acc: 0.257 Test Loss: 1.393 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.9292287826538086
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.8513126373291016
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0373318195343018
Epoch: 4, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.291 Vali Acc: 0.392 Test Loss: 1.291 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.8897740840911865
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9835710525512695
Epoch: 6, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.277 Vali Acc: 0.405 Test Loss: 1.277 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8952457904815674
Epoch: 7, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.247 Vali Acc: 0.392 Test Loss: 1.247 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8819642066955566
Epoch: 8, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.254 Vali Acc: 0.392 Test Loss: 1.254 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9934465885162354
Epoch: 9, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.196 Vali Acc: 0.365 Test Loss: 1.196 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8783836364746094
Epoch: 10, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.230 Vali Acc: 0.405 Test Loss: 1.230 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9482066631317139
Epoch: 11, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 0.9059362411499023
Epoch: 12, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.347 Vali Acc: 0.419 Test Loss: 1.347 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9877152442932129
Epoch: 13, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.249 Vali Acc: 0.405 Test Loss: 1.249 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9767255783081055
Epoch: 14, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.385 Vali Acc: 0.419 Test Loss: 1.385 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9096713066101074
Epoch: 15, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.297 Vali Acc: 0.378 Test Loss: 1.297 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9209344387054443
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.424 Vali Acc: 0.419 Test Loss: 1.424 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8271360397338867
Epoch: 17, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.351 Vali Acc: 0.446 Test Loss: 1.351 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445932).  Saving model ...
Epoch: 18 cost time: 0.8660707473754883
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.457 Vali Acc: 0.419 Test Loss: 1.457 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8802270889282227
Epoch: 19, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.527 Vali Acc: 0.419 Test Loss: 1.527 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8545074462890625
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.497 Vali Acc: 0.459 Test Loss: 1.497 Test Acc: 0.459
Validation loss decreased (-0.445932 --> -0.459444).  Saving model ...
Epoch: 21 cost time: 0.8730127811431885
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.769 Vali Acc: 0.419 Test Loss: 1.769 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8991334438323975
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.586 Vali Acc: 0.419 Test Loss: 1.586 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9079129695892334
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.839 Vali Acc: 0.392 Test Loss: 1.839 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.027536392211914
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.774 Vali Acc: 0.392 Test Loss: 1.774 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9929964542388916
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.907 Vali Acc: 0.405 Test Loss: 1.907 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8754918575286865
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.916 Vali Acc: 0.392 Test Loss: 1.916 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9157843589782715
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.931 Vali Acc: 0.405 Test Loss: 1.931 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9068679809570312
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.940 Vali Acc: 0.405 Test Loss: 1.940 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9083080291748047
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.919 Vali Acc: 0.378 Test Loss: 1.919 Test Acc: 0.378
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0467512607574463
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.977 Vali Acc: 0.378 Test Loss: 1.977 Test Acc: 0.378
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4594594594594595
model parameter : 63484
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.068053960800171
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.441 Vali Acc: 0.257 Test Loss: 1.441 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.9471638202667236
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.391 Vali Acc: 0.257 Test Loss: 1.391 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.8492765426635742
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.327 Vali Acc: 0.243 Test Loss: 1.327 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8961968421936035
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.300 Vali Acc: 0.365 Test Loss: 1.300 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.8788912296295166
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.269 Vali Acc: 0.378 Test Loss: 1.269 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 0.8754417896270752
Epoch: 6, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.260 Vali Acc: 0.338 Test Loss: 1.260 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8913276195526123
Epoch: 7, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.378366 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 0.9053826332092285
Epoch: 8, Steps: 10 | Train Loss: 0.470 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 0.7946774959564209
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8200969696044922
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 0.8374474048614502
Epoch: 11, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.747530460357666
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.308 Vali Acc: 0.514 Test Loss: 1.308 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513500).  Saving model ...
Epoch: 13 cost time: 0.7612907886505127
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.323 Vali Acc: 0.486 Test Loss: 1.323 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.876532793045044
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540526).  Saving model ...
Epoch: 15 cost time: 0.8362123966217041
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
Validation loss decreased (-0.540526 --> -0.567553).  Saving model ...
Epoch: 16 cost time: 0.8314952850341797
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8500046730041504
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.452 Vali Acc: 0.514 Test Loss: 1.452 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9078183174133301
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6966993808746338
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.572 Vali Acc: 0.527 Test Loss: 1.572 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8606970310211182
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.616 Vali Acc: 0.514 Test Loss: 1.616 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8450930118560791
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.644 Vali Acc: 0.486 Test Loss: 1.644 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0603382587432861
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.621 Vali Acc: 0.541 Test Loss: 1.621 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0394785404205322
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8875932693481445
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.647 Vali Acc: 0.541 Test Loss: 1.647 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8768086433410645
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.629 Vali Acc: 0.527 Test Loss: 1.629 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 59388
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7752866744995117
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.8999450206756592
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.376 Vali Acc: 0.230 Test Loss: 1.376 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9686272144317627
Epoch: 3, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.321 Vali Acc: 0.270 Test Loss: 1.321 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 0.9458236694335938
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.291 Vali Acc: 0.338 Test Loss: 1.291 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 0.9466769695281982
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.269 Vali Acc: 0.365 Test Loss: 1.269 Test Acc: 0.365
Validation loss decreased (-0.337825 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 0.9723625183105469
Epoch: 6, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.263 Vali Acc: 0.378 Test Loss: 1.263 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 7 cost time: 0.9626693725585938
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
Validation loss decreased (-0.378366 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.9488210678100586
Epoch: 8, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.253 Vali Acc: 0.473 Test Loss: 1.253 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9907436370849609
Epoch: 9, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.255 Vali Acc: 0.459 Test Loss: 1.255 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.959552526473999
Epoch: 10, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.291 Vali Acc: 0.486 Test Loss: 1.291 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8857486248016357
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.274 Vali Acc: 0.473 Test Loss: 1.274 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8853507041931152
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527014).  Saving model ...
Epoch: 13 cost time: 0.903855562210083
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9904096126556396
Epoch: 14, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.421 Vali Acc: 0.514 Test Loss: 1.421 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.87748122215271
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.336 Vali Acc: 0.486 Test Loss: 1.336 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7974426746368408
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554041).  Saving model ...
Epoch: 17 cost time: 0.8279168605804443
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.388 Vali Acc: 0.514 Test Loss: 1.388 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8822963237762451
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.424 Vali Acc: 0.541 Test Loss: 1.424 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8458278179168701
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.497 Vali Acc: 0.514 Test Loss: 1.497 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8281922340393066
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9866631031036377
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.576 Vali Acc: 0.459 Test Loss: 1.576 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8555257320404053
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.654 Vali Acc: 0.514 Test Loss: 1.654 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8274896144866943
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9007787704467773
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.591 Vali Acc: 0.486 Test Loss: 1.591 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9174768924713135
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9119977951049805
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.641 Vali Acc: 0.500 Test Loss: 1.641 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 59388
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.956495761871338
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.420 Vali Acc: 0.257 Test Loss: 1.420 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.848513126373291
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8316116333007812
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.855799674987793
Epoch: 4, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.315 Vali Acc: 0.378 Test Loss: 1.315 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.8915243148803711
Epoch: 5, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.300 Vali Acc: 0.378 Test Loss: 1.300 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 0.9093005657196045
Epoch: 6, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.310 Vali Acc: 0.419 Test Loss: 1.310 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 0.9294626712799072
Epoch: 7, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.274 Vali Acc: 0.392 Test Loss: 1.274 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9822349548339844
Epoch: 8, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.884497880935669
Epoch: 9, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.312 Vali Acc: 0.405 Test Loss: 1.312 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9088699817657471
Epoch: 10, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.306 Vali Acc: 0.405 Test Loss: 1.306 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9630930423736572
Epoch: 11, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.951188325881958
Epoch: 12, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.385 Vali Acc: 0.446 Test Loss: 1.385 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445932).  Saving model ...
Epoch: 13 cost time: 0.8964269161224365
Epoch: 13, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.388 Vali Acc: 0.365 Test Loss: 1.388 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8757355213165283
Epoch: 14, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.502 Vali Acc: 0.419 Test Loss: 1.502 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9715747833251953
Epoch: 15, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.434 Vali Acc: 0.432 Test Loss: 1.434 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8943772315979004
Epoch: 16, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.577 Vali Acc: 0.419 Test Loss: 1.577 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8732438087463379
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.571 Vali Acc: 0.432 Test Loss: 1.571 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9603643417358398
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.626 Vali Acc: 0.405 Test Loss: 1.626 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7616255283355713
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.681 Vali Acc: 0.405 Test Loss: 1.681 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8660283088684082
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.636 Vali Acc: 0.459 Test Loss: 1.636 Test Acc: 0.459
Validation loss decreased (-0.445932 --> -0.459443).  Saving model ...
Epoch: 21 cost time: 0.8392848968505859
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.724 Vali Acc: 0.459 Test Loss: 1.724 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7329020500183105
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.751 Vali Acc: 0.432 Test Loss: 1.751 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9178555011749268
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.781 Vali Acc: 0.473 Test Loss: 1.781 Test Acc: 0.473
Validation loss decreased (-0.459443 --> -0.472955).  Saving model ...
Epoch: 24 cost time: 0.8973305225372314
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.770 Vali Acc: 0.459 Test Loss: 1.770 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8456792831420898
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.763 Vali Acc: 0.486 Test Loss: 1.763 Test Acc: 0.486
Validation loss decreased (-0.472955 --> -0.486469).  Saving model ...
Epoch: 26 cost time: 0.7788794040679932
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.823 Vali Acc: 0.486 Test Loss: 1.823 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7546286582946777
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.837 Vali Acc: 0.473 Test Loss: 1.837 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.774486780166626
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.832 Vali Acc: 0.446 Test Loss: 1.832 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9614746570587158
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.861 Vali Acc: 0.459 Test Loss: 1.861 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9244744777679443
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.856 Vali Acc: 0.432 Test Loss: 1.856 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8932547569274902
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.845 Vali Acc: 0.446 Test Loss: 1.845 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8894402980804443
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.953 Vali Acc: 0.419 Test Loss: 1.953 Test Acc: 0.419
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8292181491851807
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.947 Vali Acc: 0.419 Test Loss: 1.947 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8277368545532227
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.934 Vali Acc: 0.419 Test Loss: 1.934 Test Acc: 0.419
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8986780643463135
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.924 Vali Acc: 0.405 Test Loss: 1.924 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 59388
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6079931259155273
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.387 Vali Acc: 0.284 Test Loss: 1.387 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8810474872589111
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.378 Vali Acc: 0.378 Test Loss: 1.378 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.9253742694854736
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8708271980285645
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.302 Vali Acc: 0.459 Test Loss: 1.302 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.0233864784240723
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.293 Vali Acc: 0.378 Test Loss: 1.293 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9336576461791992
Epoch: 6, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.286 Vali Acc: 0.405 Test Loss: 1.286 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9066095352172852
Epoch: 7, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.9293811321258545
Epoch: 8, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 0.849602222442627
Epoch: 9, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.264 Vali Acc: 0.378 Test Loss: 1.264 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8969810009002686
Epoch: 10, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.220 Vali Acc: 0.432 Test Loss: 1.220 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9262712001800537
Epoch: 11, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8437366485595703
Epoch: 12, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.261 Vali Acc: 0.419 Test Loss: 1.261 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9319639205932617
Epoch: 13, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9240550994873047
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9743711948394775
Epoch: 15, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.295 Vali Acc: 0.432 Test Loss: 1.295 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9399154186248779
Epoch: 16, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.401 Vali Acc: 0.392 Test Loss: 1.401 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9166576862335205
Epoch: 17, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.431 Vali Acc: 0.446 Test Loss: 1.431 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.823786735534668
Epoch: 18, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_ETSformer_UEA_ftM_sl400_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 59388
model size : 0.85MB
